import{r as M,a as w8,R as Q,g as At,b as Yj,c as ht,d as uq}from"./vendor-CF0Y5DJ5.js";import{u as Xj,N as dq,a as Il,b as Cp,L as Ur,_ as Xe,c as Kj,B as fq,R as hq,d as Kr}from"./router-CEKQOvjm.js";import{C as mq,L as pq,X as _8,a as xq,S as gq,b as qk,c as p_,d as vq,P as yq,M as bq,e as wq,V as D8,f as j8,U as _q,g as Dq,h as jq,i as Nq,T as Gk,j as Sq}from"./ui-V0Y0FXBm.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var N8={exports:{}},Hv={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eq=M,Tq=Symbol.for("react.element"),kq=Symbol.for("react.fragment"),Cq=Object.prototype.hasOwnProperty,Aq=Eq.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Oq={key:!0,ref:!0,__self:!0,__source:!0};function S8(e,t,r){var n,a={},i=null,s=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)Cq.call(t,n)&&!Oq.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:Tq,type:e,key:i,ref:s,props:a,_owner:Aq.current}}Hv.Fragment=kq;Hv.jsx=S8;Hv.jsxs=S8;N8.exports=Hv;var o=N8.exports,E8,Yk=w8;E8=Yk.createRoot,Yk.hydrateRoot;let Fq={data:""},Pq=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||Fq,Iq=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Rq=/\/\*[^]*?\*\/|  +/g,Xk=/\n+/g,sl=(e,t)=>{let r="",n="",a="";for(let i in e){let s=e[i];i[0]=="@"?i[1]=="i"?r=i+" "+s+";":n+=i[1]=="f"?sl(s,i):i+"{"+sl(s,i[1]=="k"?"":t)+"}":typeof s=="object"?n+=sl(s,t?t.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,l):l?l+" "+c:c)):i):s!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=sl.p?sl.p(i,s):i+":"+s+";")}return r+(t&&a?t+"{"+a+"}":a)+n},ro={},T8=e=>{if(typeof e=="object"){let t="";for(let r in e)t+=r+T8(e[r]);return t}return e},Mq=(e,t,r,n,a)=>{let i=T8(e),s=ro[i]||(ro[i]=(c=>{let u=0,d=11;for(;u<c.length;)d=101*d+c.charCodeAt(u++)>>>0;return"go"+d})(i));if(!ro[s]){let c=i!==e?e:(u=>{let d,f,h=[{}];for(;d=Iq.exec(u.replace(Rq,""));)d[4]?h.shift():d[3]?(f=d[3].replace(Xk," ").trim(),h.unshift(h[0][f]=h[0][f]||{})):h[0][d[1]]=d[2].replace(Xk," ").trim();return h[0]})(e);ro[s]=sl(a?{["@keyframes "+s]:c}:c,r?"":"."+s)}let l=r&&ro.g?ro.g:null;return r&&(ro.g=ro[s]),((c,u,d,f)=>{f?u.data=u.data.replace(f,c):u.data.indexOf(c)===-1&&(u.data=d?c+u.data:u.data+c)})(ro[s],t,n,l),s},Uq=(e,t,r)=>e.reduce((n,a,i)=>{let s=t[i];if(s&&s.call){let l=s(r),c=l&&l.props&&l.props.className||/^go/.test(l)&&l;s=c?"."+c:l&&typeof l=="object"?l.props?"":sl(l,""):l===!1?"":l}return n+a+(s??"")},"");function Vv(e){let t=this||{},r=e.call?e(t.p):e;return Mq(r.unshift?r.raw?Uq(r,[].slice.call(arguments,1),t.p):r.reduce((n,a)=>Object.assign(n,a&&a.call?a(t.p):a),{}):r,Pq(t.target),t.g,t.o,t.k)}let k8,x_,g_;Vv.bind({g:1});let ko=Vv.bind({k:1});function $q(e,t,r,n){sl.p=t,k8=e,x_=r,g_=n}function Rl(e,t){let r=this||{};return function(){let n=arguments;function a(i,s){let l=Object.assign({},i),c=l.className||a.className;r.p=Object.assign({theme:x_&&x_()},l),r.o=/ *go\d+/.test(c),l.className=Vv.apply(r,n)+(c?" "+c:"");let u=e;return e[0]&&(u=l.as||e,delete l.as),g_&&u[0]&&g_(l),k8(u,l)}return a}}var Lq=e=>typeof e=="function",z0=(e,t)=>Lq(e)?e(t):e,Bq=(()=>{let e=0;return()=>(++e).toString()})(),C8=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),Wq=20,Zj="default",A8=(e,t)=>{let{toastLimit:r}=e.settings;switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,r)};case 1:return{...e,toasts:e.toasts.map(s=>s.id===t.toast.id?{...s,...t.toast}:s)};case 2:let{toast:n}=t;return A8(e,{type:e.toasts.find(s=>s.id===n.id)?1:0,toast:n});case 3:let{toastId:a}=t;return{...e,toasts:e.toasts.map(s=>s.id===a||a===void 0?{...s,dismissed:!0,visible:!1}:s)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(s=>s.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let i=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(s=>({...s,pauseDuration:s.pauseDuration+i}))}}},S0=[],O8={toasts:[],pausedAt:void 0,settings:{toastLimit:Wq}},Fs={},F8=(e,t=Zj)=>{Fs[t]=A8(Fs[t]||O8,e),S0.forEach(([r,n])=>{r===t&&n(Fs[t])})},P8=e=>Object.keys(Fs).forEach(t=>F8(e,t)),zq=e=>Object.keys(Fs).find(t=>Fs[t].toasts.some(r=>r.id===e)),qv=(e=Zj)=>t=>{F8(t,e)},Hq={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Vq=(e={},t=Zj)=>{let[r,n]=M.useState(Fs[t]||O8),a=M.useRef(Fs[t]);M.useEffect(()=>(a.current!==Fs[t]&&n(Fs[t]),S0.push([t,n]),()=>{let s=S0.findIndex(([l])=>l===t);s>-1&&S0.splice(s,1)}),[t]);let i=r.toasts.map(s=>{var l,c,u;return{...e,...e[s.type],...s,removeDelay:s.removeDelay||((l=e[s.type])==null?void 0:l.removeDelay)||(e==null?void 0:e.removeDelay),duration:s.duration||((c=e[s.type])==null?void 0:c.duration)||(e==null?void 0:e.duration)||Hq[s.type],style:{...e.style,...(u=e[s.type])==null?void 0:u.style,...s.style}}});return{...r,toasts:i}},qq=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:(r==null?void 0:r.id)||Bq()}),Ap=e=>(t,r)=>{let n=qq(t,e,r);return qv(n.toasterId||zq(n.id))({type:2,toast:n}),n.id},on=(e,t)=>Ap("blank")(e,t);on.error=Ap("error");on.success=Ap("success");on.loading=Ap("loading");on.custom=Ap("custom");on.dismiss=(e,t)=>{let r={type:3,toastId:e};t?qv(t)(r):P8(r)};on.dismissAll=e=>on.dismiss(void 0,e);on.remove=(e,t)=>{let r={type:4,toastId:e};t?qv(t)(r):P8(r)};on.removeAll=e=>on.remove(void 0,e);on.promise=(e,t,r)=>{let n=on.loading(t.loading,{...r,...r==null?void 0:r.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let i=t.success?z0(t.success,a):void 0;return i?on.success(i,{id:n,...r,...r==null?void 0:r.success}):on.dismiss(n),a}).catch(a=>{let i=t.error?z0(t.error,a):void 0;i?on.error(i,{id:n,...r,...r==null?void 0:r.error}):on.dismiss(n)}),e};var Gq=1e3,Yq=(e,t="default")=>{let{toasts:r,pausedAt:n}=Vq(e,t),a=M.useRef(new Map).current,i=M.useCallback((f,h=Gq)=>{if(a.has(f))return;let m=setTimeout(()=>{a.delete(f),s({type:4,toastId:f})},h);a.set(f,m)},[]);M.useEffect(()=>{if(n)return;let f=Date.now(),h=r.map(m=>{if(m.duration===1/0)return;let x=(m.duration||0)+m.pauseDuration-(f-m.createdAt);if(x<0){m.visible&&on.dismiss(m.id);return}return setTimeout(()=>on.dismiss(m.id,t),x)});return()=>{h.forEach(m=>m&&clearTimeout(m))}},[r,n,t]);let s=M.useCallback(qv(t),[t]),l=M.useCallback(()=>{s({type:5,time:Date.now()})},[s]),c=M.useCallback((f,h)=>{s({type:1,toast:{id:f,height:h}})},[s]),u=M.useCallback(()=>{n&&s({type:6,time:Date.now()})},[n,s]),d=M.useCallback((f,h)=>{let{reverseOrder:m=!1,gutter:x=8,defaultPosition:p}=h||{},g=r.filter(b=>(b.position||p)===(f.position||p)&&b.height),v=g.findIndex(b=>b.id===f.id),y=g.filter((b,w)=>w<v&&b.visible).length;return g.filter(b=>b.visible).slice(...m?[y+1]:[0,y]).reduce((b,w)=>b+(w.height||0)+x,0)},[r]);return M.useEffect(()=>{r.forEach(f=>{if(f.dismissed)i(f.id,f.removeDelay);else{let h=a.get(f.id);h&&(clearTimeout(h),a.delete(f.id))}})},[r,i]),{toasts:r,handlers:{updateHeight:c,startPause:l,endPause:u,calculateOffset:d}}},Xq=ko`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Kq=ko`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Zq=ko`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Jq=Rl("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Xq} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Kq} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Zq} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Qq=ko`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,eG=Rl("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${Qq} 1s linear infinite;
`,tG=ko`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,rG=ko`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,nG=Rl("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${tG} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${rG} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,aG=Rl("div")`
  position: absolute;
`,iG=Rl("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,sG=ko`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,oG=Rl("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${sG} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,lG=({toast:e})=>{let{icon:t,type:r,iconTheme:n}=e;return t!==void 0?typeof t=="string"?M.createElement(oG,null,t):t:r==="blank"?null:M.createElement(iG,null,M.createElement(eG,{...n}),r!=="loading"&&M.createElement(aG,null,r==="error"?M.createElement(Jq,{...n}):M.createElement(nG,{...n})))},cG=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,uG=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,dG="0%{opacity:0;} 100%{opacity:1;}",fG="0%{opacity:1;} 100%{opacity:0;}",hG=Rl("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,mG=Rl("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,pG=(e,t)=>{let r=e.includes("top")?1:-1,[n,a]=C8()?[dG,fG]:[cG(r),uG(r)];return{animation:t?`${ko(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${ko(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},xG=M.memo(({toast:e,position:t,style:r,children:n})=>{let a=e.height?pG(e.position||t||"top-center",e.visible):{opacity:0},i=M.createElement(lG,{toast:e}),s=M.createElement(mG,{...e.ariaProps},z0(e.message,e));return M.createElement(hG,{className:e.className,style:{...a,...r,...e.style}},typeof n=="function"?n({icon:i,message:s}):M.createElement(M.Fragment,null,i,s))});$q(M.createElement);var gG=({id:e,className:t,style:r,onHeightUpdate:n,children:a})=>{let i=M.useCallback(s=>{if(s){let l=()=>{let c=s.getBoundingClientRect().height;n(e,c)};l(),new MutationObserver(l).observe(s,{subtree:!0,childList:!0,characterData:!0})}},[e,n]);return M.createElement("div",{ref:i,className:t,style:r},a)},vG=(e,t)=>{let r=e.includes("top"),n=r?{top:0}:{bottom:0},a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:C8()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...n,...a}},yG=Vv`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Ox=16,bG=({reverseOrder:e,position:t="top-center",toastOptions:r,gutter:n,children:a,toasterId:i,containerStyle:s,containerClassName:l})=>{let{toasts:c,handlers:u}=Yq(r,i);return M.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:Ox,left:Ox,right:Ox,bottom:Ox,pointerEvents:"none",...s},className:l,onMouseEnter:u.startPause,onMouseLeave:u.endPause},c.map(d=>{let f=d.position||t,h=u.calculateOffset(d,{reverseOrder:e,gutter:n,defaultPosition:t}),m=vG(f,h);return M.createElement(gG,{id:d.id,key:d.id,onHeightUpdate:u.updateHeight,className:d.visible?yG:"",style:m},d.type==="custom"?z0(d.message,d):a?a(d):M.createElement(xG,{toast:d,position:f}))}))},Ue=on;const wG="modulepreload",_G=function(e){return"/"+e},Kk={},Zu=function(t,r,n){return!r||r.length===0?t():(document.getElementsByTagName("link"),Promise.all(r.map(a=>{if(a=_G(a),a in Kk)return;Kk[a]=!0;const i=a.endsWith(".css"),s=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${s}`))return;const l=document.createElement("link");if(l.rel=i?"stylesheet":wG,i||(l.as="script",l.crossOrigin=""),l.href=a,document.head.appendChild(l),i)return new Promise((c,u)=>{l.addEventListener("load",c),l.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>t()).catch(a=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=a,window.dispatchEvent(i),!i.defaultPrevented)throw a}))};function I8(e,t){return function(){return e.apply(t,arguments)}}const{toString:DG}=Object.prototype,{getPrototypeOf:Jj}=Object,{iterator:Gv,toStringTag:R8}=Symbol,Yv=(e=>t=>{const r=DG.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),xs=e=>(e=e.toLowerCase(),t=>Yv(t)===e),Xv=e=>t=>typeof t===e,{isArray:rf}=Array,qh=Xv("undefined");function Op(e){return e!==null&&!qh(e)&&e.constructor!==null&&!qh(e.constructor)&&Ca(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const M8=xs("ArrayBuffer");function jG(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&M8(e.buffer),t}const NG=Xv("string"),Ca=Xv("function"),U8=Xv("number"),Fp=e=>e!==null&&typeof e=="object",SG=e=>e===!0||e===!1,E0=e=>{if(Yv(e)!=="object")return!1;const t=Jj(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(R8 in e)&&!(Gv in e)},EG=e=>{if(!Fp(e)||Op(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},TG=xs("Date"),kG=xs("File"),CG=xs("Blob"),AG=xs("FileList"),OG=e=>Fp(e)&&Ca(e.pipe),FG=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Ca(e.append)&&((t=Yv(e))==="formdata"||t==="object"&&Ca(e.toString)&&e.toString()==="[object FormData]"))},PG=xs("URLSearchParams"),[IG,RG,MG,UG]=["ReadableStream","Request","Response","Headers"].map(xs),$G=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Pp(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),rf(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{if(Op(e))return;const i=r?Object.getOwnPropertyNames(e):Object.keys(e),s=i.length;let l;for(n=0;n<s;n++)l=i[n],t.call(null,e[l],l,e)}}function $8(e,t){if(Op(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const yc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,L8=e=>!qh(e)&&e!==yc;function v_(){const{caseless:e}=L8(this)&&this||{},t={},r=(n,a)=>{const i=e&&$8(t,a)||a;E0(t[i])&&E0(n)?t[i]=v_(t[i],n):E0(n)?t[i]=v_({},n):rf(n)?t[i]=n.slice():t[i]=n};for(let n=0,a=arguments.length;n<a;n++)arguments[n]&&Pp(arguments[n],r);return t}const LG=(e,t,r,{allOwnKeys:n}={})=>(Pp(t,(a,i)=>{r&&Ca(a)?e[i]=I8(a,r):e[i]=a},{allOwnKeys:n}),e),BG=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),WG=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},zG=(e,t,r,n)=>{let a,i,s;const l={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),i=a.length;i-- >0;)s=a[i],(!n||n(s,e,t))&&!l[s]&&(t[s]=e[s],l[s]=!0);e=r!==!1&&Jj(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},HG=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},VG=e=>{if(!e)return null;if(rf(e))return e;let t=e.length;if(!U8(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},qG=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Jj(Uint8Array)),GG=(e,t)=>{const n=(e&&e[Gv]).call(e);let a;for(;(a=n.next())&&!a.done;){const i=a.value;t.call(e,i[0],i[1])}},YG=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},XG=xs("HTMLFormElement"),KG=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),Zk=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),ZG=xs("RegExp"),B8=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};Pp(r,(a,i)=>{let s;(s=t(a,i,e))!==!1&&(n[i]=s||a)}),Object.defineProperties(e,n)},JG=e=>{B8(e,(t,r)=>{if(Ca(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(Ca(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},QG=(e,t)=>{const r={},n=a=>{a.forEach(i=>{r[i]=!0})};return rf(e)?n(e):n(String(e).split(t)),r},eY=()=>{},tY=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function rY(e){return!!(e&&Ca(e.append)&&e[R8]==="FormData"&&e[Gv])}const nY=e=>{const t=new Array(10),r=(n,a)=>{if(Fp(n)){if(t.indexOf(n)>=0)return;if(Op(n))return n;if(!("toJSON"in n)){t[a]=n;const i=rf(n)?[]:{};return Pp(n,(s,l)=>{const c=r(s,a+1);!qh(c)&&(i[l]=c)}),t[a]=void 0,i}}return n};return r(e,0)},aY=xs("AsyncFunction"),iY=e=>e&&(Fp(e)||Ca(e))&&Ca(e.then)&&Ca(e.catch),W8=((e,t)=>e?setImmediate:t?((r,n)=>(yc.addEventListener("message",({source:a,data:i})=>{a===yc&&i===r&&n.length&&n.shift()()},!1),a=>{n.push(a),yc.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Ca(yc.postMessage)),sY=typeof queueMicrotask<"u"?queueMicrotask.bind(yc):typeof process<"u"&&process.nextTick||W8,oY=e=>e!=null&&Ca(e[Gv]),Ne={isArray:rf,isArrayBuffer:M8,isBuffer:Op,isFormData:FG,isArrayBufferView:jG,isString:NG,isNumber:U8,isBoolean:SG,isObject:Fp,isPlainObject:E0,isEmptyObject:EG,isReadableStream:IG,isRequest:RG,isResponse:MG,isHeaders:UG,isUndefined:qh,isDate:TG,isFile:kG,isBlob:CG,isRegExp:ZG,isFunction:Ca,isStream:OG,isURLSearchParams:PG,isTypedArray:qG,isFileList:AG,forEach:Pp,merge:v_,extend:LG,trim:$G,stripBOM:BG,inherits:WG,toFlatObject:zG,kindOf:Yv,kindOfTest:xs,endsWith:HG,toArray:VG,forEachEntry:GG,matchAll:YG,isHTMLForm:XG,hasOwnProperty:Zk,hasOwnProp:Zk,reduceDescriptors:B8,freezeMethods:JG,toObjectSet:QG,toCamelCase:KG,noop:eY,toFiniteNumber:tY,findKey:$8,global:yc,isContextDefined:L8,isSpecCompliantForm:rY,toJSONObject:nY,isAsyncFn:aY,isThenable:iY,setImmediate:W8,asap:sY,isIterable:oY};function _t(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}Ne.inherits(_t,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ne.toJSONObject(this.config),code:this.code,status:this.status}}});const z8=_t.prototype,H8={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{H8[e]={value:e}});Object.defineProperties(_t,H8);Object.defineProperty(z8,"isAxiosError",{value:!0});_t.from=(e,t,r,n,a,i)=>{const s=Object.create(z8);return Ne.toFlatObject(e,s,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),_t.call(s,e.message,t,r,n,a),s.cause=e,s.name=e.name,i&&Object.assign(s,i),s};const lY=null;function y_(e){return Ne.isPlainObject(e)||Ne.isArray(e)}function V8(e){return Ne.endsWith(e,"[]")?e.slice(0,-2):e}function Jk(e,t,r){return e?e.concat(t).map(function(a,i){return a=V8(a),!r&&i?"["+a+"]":a}).join(r?".":""):t}function cY(e){return Ne.isArray(e)&&!e.some(y_)}const uY=Ne.toFlatObject(Ne,{},null,function(t){return/^is[A-Z]/.test(t)});function Kv(e,t,r){if(!Ne.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=Ne.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,g){return!Ne.isUndefined(g[p])});const n=r.metaTokens,a=r.visitor||d,i=r.dots,s=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&Ne.isSpecCompliantForm(t);if(!Ne.isFunction(a))throw new TypeError("visitor must be a function");function u(x){if(x===null)return"";if(Ne.isDate(x))return x.toISOString();if(Ne.isBoolean(x))return x.toString();if(!c&&Ne.isBlob(x))throw new _t("Blob is not supported. Use a Buffer instead.");return Ne.isArrayBuffer(x)||Ne.isTypedArray(x)?c&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function d(x,p,g){let v=x;if(x&&!g&&typeof x=="object"){if(Ne.endsWith(p,"{}"))p=n?p:p.slice(0,-2),x=JSON.stringify(x);else if(Ne.isArray(x)&&cY(x)||(Ne.isFileList(x)||Ne.endsWith(p,"[]"))&&(v=Ne.toArray(x)))return p=V8(p),v.forEach(function(b,w){!(Ne.isUndefined(b)||b===null)&&t.append(s===!0?Jk([p],w,i):s===null?p:p+"[]",u(b))}),!1}return y_(x)?!0:(t.append(Jk(g,p,i),u(x)),!1)}const f=[],h=Object.assign(uY,{defaultVisitor:d,convertValue:u,isVisitable:y_});function m(x,p){if(!Ne.isUndefined(x)){if(f.indexOf(x)!==-1)throw Error("Circular reference detected in "+p.join("."));f.push(x),Ne.forEach(x,function(v,y){(!(Ne.isUndefined(v)||v===null)&&a.call(t,v,Ne.isString(y)?y.trim():y,p,h))===!0&&m(v,p?p.concat(y):[y])}),f.pop()}}if(!Ne.isObject(e))throw new TypeError("data must be an object");return m(e),t}function Qk(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Qj(e,t){this._pairs=[],e&&Kv(e,this,t)}const q8=Qj.prototype;q8.append=function(t,r){this._pairs.push([t,r])};q8.toString=function(t){const r=t?function(n){return t.call(this,n,Qk)}:Qk;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function dY(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function G8(e,t,r){if(!t)return e;const n=r&&r.encode||dY;Ne.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let i;if(a?i=a(t,r):i=Ne.isURLSearchParams(t)?t.toString():new Qj(t,r).toString(n),i){const s=e.indexOf("#");s!==-1&&(e=e.slice(0,s)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class eC{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Ne.forEach(this.handlers,function(n){n!==null&&t(n)})}}const Y8={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},fY=typeof URLSearchParams<"u"?URLSearchParams:Qj,hY=typeof FormData<"u"?FormData:null,mY=typeof Blob<"u"?Blob:null,pY={isBrowser:!0,classes:{URLSearchParams:fY,FormData:hY,Blob:mY},protocols:["http","https","file","blob","url","data"]},eN=typeof window<"u"&&typeof document<"u",b_=typeof navigator=="object"&&navigator||void 0,xY=eN&&(!b_||["ReactNative","NativeScript","NS"].indexOf(b_.product)<0),gY=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",vY=eN&&window.location.href||"http://localhost",yY=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:eN,hasStandardBrowserEnv:xY,hasStandardBrowserWebWorkerEnv:gY,navigator:b_,origin:vY},Symbol.toStringTag,{value:"Module"})),Jn={...yY,...pY};function bY(e,t){return Kv(e,new Jn.classes.URLSearchParams,{visitor:function(r,n,a,i){return Jn.isNode&&Ne.isBuffer(r)?(this.append(n,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function wY(e){return Ne.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function _Y(e){const t={},r=Object.keys(e);let n;const a=r.length;let i;for(n=0;n<a;n++)i=r[n],t[i]=e[i];return t}function X8(e){function t(r,n,a,i){let s=r[i++];if(s==="__proto__")return!0;const l=Number.isFinite(+s),c=i>=r.length;return s=!s&&Ne.isArray(a)?a.length:s,c?(Ne.hasOwnProp(a,s)?a[s]=[a[s],n]:a[s]=n,!l):((!a[s]||!Ne.isObject(a[s]))&&(a[s]=[]),t(r,n,a[s],i)&&Ne.isArray(a[s])&&(a[s]=_Y(a[s])),!l)}if(Ne.isFormData(e)&&Ne.isFunction(e.entries)){const r={};return Ne.forEachEntry(e,(n,a)=>{t(wY(n),a,r,0)}),r}return null}function DY(e,t,r){if(Ne.isString(e))try{return(t||JSON.parse)(e),Ne.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const Ip={transitional:Y8,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,i=Ne.isObject(t);if(i&&Ne.isHTMLForm(t)&&(t=new FormData(t)),Ne.isFormData(t))return a?JSON.stringify(X8(t)):t;if(Ne.isArrayBuffer(t)||Ne.isBuffer(t)||Ne.isStream(t)||Ne.isFile(t)||Ne.isBlob(t)||Ne.isReadableStream(t))return t;if(Ne.isArrayBufferView(t))return t.buffer;if(Ne.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return bY(t,this.formSerializer).toString();if((l=Ne.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Kv(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||a?(r.setContentType("application/json",!1),DY(t)):t}],transformResponse:[function(t){const r=this.transitional||Ip.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(Ne.isResponse(t)||Ne.isReadableStream(t))return t;if(t&&Ne.isString(t)&&(n&&!this.responseType||a)){const s=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t)}catch(l){if(s)throw l.name==="SyntaxError"?_t.from(l,_t.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Jn.classes.FormData,Blob:Jn.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ne.forEach(["delete","get","head","post","put","patch"],e=>{Ip.headers[e]={}});const jY=Ne.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),NY=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(s){a=s.indexOf(":"),r=s.substring(0,a).trim().toLowerCase(),n=s.substring(a+1).trim(),!(!r||t[r]&&jY[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},tC=Symbol("internals");function qf(e){return e&&String(e).trim().toLowerCase()}function T0(e){return e===!1||e==null?e:Ne.isArray(e)?e.map(T0):String(e)}function SY(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const EY=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function $1(e,t,r,n,a){if(Ne.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!Ne.isString(t)){if(Ne.isString(n))return t.indexOf(n)!==-1;if(Ne.isRegExp(n))return n.test(t)}}function TY(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function kY(e,t){const r=Ne.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,i,s){return this[n].call(this,t,a,i,s)},configurable:!0})})}let Aa=class{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function i(l,c,u){const d=qf(c);if(!d)throw new Error("header name must be a non-empty string");const f=Ne.findKey(a,d);(!f||a[f]===void 0||u===!0||u===void 0&&a[f]!==!1)&&(a[f||c]=T0(l))}const s=(l,c)=>Ne.forEach(l,(u,d)=>i(u,d,c));if(Ne.isPlainObject(t)||t instanceof this.constructor)s(t,r);else if(Ne.isString(t)&&(t=t.trim())&&!EY(t))s(NY(t),r);else if(Ne.isObject(t)&&Ne.isIterable(t)){let l={},c,u;for(const d of t){if(!Ne.isArray(d))throw TypeError("Object iterator must return a key-value pair");l[u=d[0]]=(c=l[u])?Ne.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}s(l,r)}else t!=null&&i(r,t,n);return this}get(t,r){if(t=qf(t),t){const n=Ne.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return SY(a);if(Ne.isFunction(r))return r.call(this,a,n);if(Ne.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=qf(t),t){const n=Ne.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||$1(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function i(s){if(s=qf(s),s){const l=Ne.findKey(n,s);l&&(!r||$1(n,n[l],l,r))&&(delete n[l],a=!0)}}return Ne.isArray(t)?t.forEach(i):i(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const i=r[n];(!t||$1(this,this[i],i,t,!0))&&(delete this[i],a=!0)}return a}normalize(t){const r=this,n={};return Ne.forEach(this,(a,i)=>{const s=Ne.findKey(n,i);if(s){r[s]=T0(a),delete r[i];return}const l=t?TY(i):String(i).trim();l!==i&&delete r[i],r[l]=T0(a),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return Ne.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&Ne.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[tC]=this[tC]={accessors:{}}).accessors,a=this.prototype;function i(s){const l=qf(s);n[l]||(kY(a,s),n[l]=!0)}return Ne.isArray(t)?t.forEach(i):i(t),this}};Aa.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ne.reduceDescriptors(Aa.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});Ne.freezeMethods(Aa);function L1(e,t){const r=this||Ip,n=t||r,a=Aa.from(n.headers);let i=n.data;return Ne.forEach(e,function(l){i=l.call(r,i,a.normalize(),t?t.status:void 0)}),a.normalize(),i}function K8(e){return!!(e&&e.__CANCEL__)}function nf(e,t,r){_t.call(this,e??"canceled",_t.ERR_CANCELED,t,r),this.name="CanceledError"}Ne.inherits(nf,_t,{__CANCEL__:!0});function Z8(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new _t("Request failed with status code "+r.status,[_t.ERR_BAD_REQUEST,_t.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function CY(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function AY(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,i=0,s;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),d=n[i];s||(s=u),r[a]=c,n[a]=u;let f=i,h=0;for(;f!==a;)h+=r[f++],f=f%e;if(a=(a+1)%e,a===i&&(i=(i+1)%e),u-s<t)return;const m=d&&u-d;return m?Math.round(h*1e3/m):void 0}}function OY(e,t){let r=0,n=1e3/t,a,i;const s=(u,d=Date.now())=>{r=d,a=null,i&&(clearTimeout(i),i=null),e(...u)};return[(...u)=>{const d=Date.now(),f=d-r;f>=n?s(u,d):(a=u,i||(i=setTimeout(()=>{i=null,s(a)},n-f)))},()=>a&&s(a)]}const H0=(e,t,r=3)=>{let n=0;const a=AY(50,250);return OY(i=>{const s=i.loaded,l=i.lengthComputable?i.total:void 0,c=s-n,u=a(c),d=s<=l;n=s;const f={loaded:s,total:l,progress:l?s/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&d?(l-s)/u:void 0,event:i,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(f)},r)},rC=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},nC=e=>(...t)=>Ne.asap(()=>e(...t)),FY=Jn.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Jn.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Jn.origin),Jn.navigator&&/(msie|trident)/i.test(Jn.navigator.userAgent)):()=>!0,PY=Jn.hasStandardBrowserEnv?{write(e,t,r,n,a,i){const s=[e+"="+encodeURIComponent(t)];Ne.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),Ne.isString(n)&&s.push("path="+n),Ne.isString(a)&&s.push("domain="+a),i===!0&&s.push("secure"),document.cookie=s.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function IY(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function RY(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function J8(e,t,r){let n=!IY(t);return e&&(n||r==!1)?RY(e,t):t}const aC=e=>e instanceof Aa?{...e}:e;function Rc(e,t){t=t||{};const r={};function n(u,d,f,h){return Ne.isPlainObject(u)&&Ne.isPlainObject(d)?Ne.merge.call({caseless:h},u,d):Ne.isPlainObject(d)?Ne.merge({},d):Ne.isArray(d)?d.slice():d}function a(u,d,f,h){if(Ne.isUndefined(d)){if(!Ne.isUndefined(u))return n(void 0,u,f,h)}else return n(u,d,f,h)}function i(u,d){if(!Ne.isUndefined(d))return n(void 0,d)}function s(u,d){if(Ne.isUndefined(d)){if(!Ne.isUndefined(u))return n(void 0,u)}else return n(void 0,d)}function l(u,d,f){if(f in t)return n(u,d);if(f in e)return n(void 0,u)}const c={url:i,method:i,data:i,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:l,headers:(u,d,f)=>a(aC(u),aC(d),f,!0)};return Ne.forEach(Object.keys({...e,...t}),function(d){const f=c[d]||a,h=f(e[d],t[d],d);Ne.isUndefined(h)&&f!==l||(r[d]=h)}),r}const Q8=e=>{const t=Rc({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:i,headers:s,auth:l}=t;t.headers=s=Aa.from(s),t.url=G8(J8(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&s.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(Ne.isFormData(r)){if(Jn.hasStandardBrowserEnv||Jn.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if((c=s.getContentType())!==!1){const[u,...d]=c?c.split(";").map(f=>f.trim()).filter(Boolean):[];s.setContentType([u||"multipart/form-data",...d].join("; "))}}if(Jn.hasStandardBrowserEnv&&(n&&Ne.isFunction(n)&&(n=n(t)),n||n!==!1&&FY(t.url))){const u=a&&i&&PY.read(i);u&&s.set(a,u)}return t},MY=typeof XMLHttpRequest<"u",UY=MY&&function(e){return new Promise(function(r,n){const a=Q8(e);let i=a.data;const s=Aa.from(a.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=a,d,f,h,m,x;function p(){m&&m(),x&&x(),a.cancelToken&&a.cancelToken.unsubscribe(d),a.signal&&a.signal.removeEventListener("abort",d)}let g=new XMLHttpRequest;g.open(a.method.toUpperCase(),a.url,!0),g.timeout=a.timeout;function v(){if(!g)return;const b=Aa.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),_={data:!l||l==="text"||l==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:b,config:e,request:g};Z8(function(j){r(j),p()},function(j){n(j),p()},_),g=null}"onloadend"in g?g.onloadend=v:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(v)},g.onabort=function(){g&&(n(new _t("Request aborted",_t.ECONNABORTED,e,g)),g=null)},g.onerror=function(){n(new _t("Network Error",_t.ERR_NETWORK,e,g)),g=null},g.ontimeout=function(){let w=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const _=a.transitional||Y8;a.timeoutErrorMessage&&(w=a.timeoutErrorMessage),n(new _t(w,_.clarifyTimeoutError?_t.ETIMEDOUT:_t.ECONNABORTED,e,g)),g=null},i===void 0&&s.setContentType(null),"setRequestHeader"in g&&Ne.forEach(s.toJSON(),function(w,_){g.setRequestHeader(_,w)}),Ne.isUndefined(a.withCredentials)||(g.withCredentials=!!a.withCredentials),l&&l!=="json"&&(g.responseType=a.responseType),u&&([h,x]=H0(u,!0),g.addEventListener("progress",h)),c&&g.upload&&([f,m]=H0(c),g.upload.addEventListener("progress",f),g.upload.addEventListener("loadend",m)),(a.cancelToken||a.signal)&&(d=b=>{g&&(n(!b||b.type?new nf(null,e,g):b),g.abort(),g=null)},a.cancelToken&&a.cancelToken.subscribe(d),a.signal&&(a.signal.aborted?d():a.signal.addEventListener("abort",d)));const y=CY(a.url);if(y&&Jn.protocols.indexOf(y)===-1){n(new _t("Unsupported protocol "+y+":",_t.ERR_BAD_REQUEST,e));return}g.send(i||null)})},$Y=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const i=function(u){if(!a){a=!0,l();const d=u instanceof Error?u:this.reason;n.abort(d instanceof _t?d:new nf(d instanceof Error?d.message:d))}};let s=t&&setTimeout(()=>{s=null,i(new _t(`timeout ${t} of ms exceeded`,_t.ETIMEDOUT))},t);const l=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),e=null)};e.forEach(u=>u.addEventListener("abort",i));const{signal:c}=n;return c.unsubscribe=()=>Ne.asap(l),c}},LY=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},BY=async function*(e,t){for await(const r of WY(e))yield*LY(r,t)},WY=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},iC=(e,t,r,n)=>{const a=BY(e,t);let i=0,s,l=c=>{s||(s=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await a.next();if(u){l(),c.close();return}let f=d.byteLength;if(r){let h=i+=f;r(h)}c.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(c){return l(c),a.return()}},{highWaterMark:2})},Zv=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",eI=Zv&&typeof ReadableStream=="function",zY=Zv&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),tI=(e,...t)=>{try{return!!e(...t)}catch{return!1}},HY=eI&&tI(()=>{let e=!1;const t=new Request(Jn.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),sC=64*1024,w_=eI&&tI(()=>Ne.isReadableStream(new Response("").body)),V0={stream:w_&&(e=>e.body)};Zv&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!V0[t]&&(V0[t]=Ne.isFunction(e[t])?r=>r[t]():(r,n)=>{throw new _t(`Response type '${t}' is not supported`,_t.ERR_NOT_SUPPORT,n)})})})(new Response);const VY=async e=>{if(e==null)return 0;if(Ne.isBlob(e))return e.size;if(Ne.isSpecCompliantForm(e))return(await new Request(Jn.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(Ne.isArrayBufferView(e)||Ne.isArrayBuffer(e))return e.byteLength;if(Ne.isURLSearchParams(e)&&(e=e+""),Ne.isString(e))return(await zY(e)).byteLength},qY=async(e,t)=>{const r=Ne.toFiniteNumber(e.getContentLength());return r??VY(t)},GY=Zv&&(async e=>{let{url:t,method:r,data:n,signal:a,cancelToken:i,timeout:s,onDownloadProgress:l,onUploadProgress:c,responseType:u,headers:d,withCredentials:f="same-origin",fetchOptions:h}=Q8(e);u=u?(u+"").toLowerCase():"text";let m=$Y([a,i&&i.toAbortSignal()],s),x;const p=m&&m.unsubscribe&&(()=>{m.unsubscribe()});let g;try{if(c&&HY&&r!=="get"&&r!=="head"&&(g=await qY(d,n))!==0){let _=new Request(t,{method:"POST",body:n,duplex:"half"}),D;if(Ne.isFormData(n)&&(D=_.headers.get("content-type"))&&d.setContentType(D),_.body){const[j,N]=rC(g,H0(nC(c)));n=iC(_.body,sC,j,N)}}Ne.isString(f)||(f=f?"include":"omit");const v="credentials"in Request.prototype;x=new Request(t,{...h,signal:m,method:r.toUpperCase(),headers:d.normalize().toJSON(),body:n,duplex:"half",credentials:v?f:void 0});let y=await fetch(x,h);const b=w_&&(u==="stream"||u==="response");if(w_&&(l||b&&p)){const _={};["status","statusText","headers"].forEach(S=>{_[S]=y[S]});const D=Ne.toFiniteNumber(y.headers.get("content-length")),[j,N]=l&&rC(D,H0(nC(l),!0))||[];y=new Response(iC(y.body,sC,j,()=>{N&&N(),p&&p()}),_)}u=u||"text";let w=await V0[Ne.findKey(V0,u)||"text"](y,e);return!b&&p&&p(),await new Promise((_,D)=>{Z8(_,D,{data:w,headers:Aa.from(y.headers),status:y.status,statusText:y.statusText,config:e,request:x})})}catch(v){throw p&&p(),v&&v.name==="TypeError"&&/Load failed|fetch/i.test(v.message)?Object.assign(new _t("Network Error",_t.ERR_NETWORK,e,x),{cause:v.cause||v}):_t.from(v,v&&v.code,e,x)}}),__={http:lY,xhr:UY,fetch:GY};Ne.forEach(__,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const oC=e=>`- ${e}`,YY=e=>Ne.isFunction(e)||e===null||e===!1,rI={getAdapter:e=>{e=Ne.isArray(e)?e:[e];const{length:t}=e;let r,n;const a={};for(let i=0;i<t;i++){r=e[i];let s;if(n=r,!YY(r)&&(n=__[(s=String(r)).toLowerCase()],n===void 0))throw new _t(`Unknown adapter '${s}'`);if(n)break;a[s||"#"+i]=n}if(!n){const i=Object.entries(a).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let s=t?i.length>1?`since :
`+i.map(oC).join(`
`):" "+oC(i[0]):"as no adapter specified";throw new _t("There is no suitable adapter to dispatch the request "+s,"ERR_NOT_SUPPORT")}return n},adapters:__};function B1(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new nf(null,e)}function lC(e){return B1(e),e.headers=Aa.from(e.headers),e.data=L1.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),rI.getAdapter(e.adapter||Ip.adapter)(e).then(function(n){return B1(e),n.data=L1.call(e,e.transformResponse,n),n.headers=Aa.from(n.headers),n},function(n){return K8(n)||(B1(e),n&&n.response&&(n.response.data=L1.call(e,e.transformResponse,n.response),n.response.headers=Aa.from(n.response.headers))),Promise.reject(n)})}const nI="1.11.0",Jv={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Jv[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const cC={};Jv.transitional=function(t,r,n){function a(i,s){return"[Axios v"+nI+"] Transitional option '"+i+"'"+s+(n?". "+n:"")}return(i,s,l)=>{if(t===!1)throw new _t(a(s," has been removed"+(r?" in "+r:"")),_t.ERR_DEPRECATED);return r&&!cC[s]&&(cC[s]=!0,console.warn(a(s," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,s,l):!0}};Jv.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function XY(e,t,r){if(typeof e!="object")throw new _t("options must be an object",_t.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const i=n[a],s=t[i];if(s){const l=e[i],c=l===void 0||s(l,i,e);if(c!==!0)throw new _t("option "+i+" must be "+c,_t.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new _t("Unknown option "+i,_t.ERR_BAD_OPTION)}}const k0={assertOptions:XY,validators:Jv},Ss=k0.validators;let Nc=class{constructor(t){this.defaults=t||{},this.interceptors={request:new eC,response:new eC}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const i=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Rc(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:i}=r;n!==void 0&&k0.assertOptions(n,{silentJSONParsing:Ss.transitional(Ss.boolean),forcedJSONParsing:Ss.transitional(Ss.boolean),clarifyTimeoutError:Ss.transitional(Ss.boolean)},!1),a!=null&&(Ne.isFunction(a)?r.paramsSerializer={serialize:a}:k0.assertOptions(a,{encode:Ss.function,serialize:Ss.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),k0.assertOptions(r,{baseUrl:Ss.spelling("baseURL"),withXsrfToken:Ss.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let s=i&&Ne.merge(i.common,i[r.method]);i&&Ne.forEach(["delete","get","head","post","put","patch","common"],x=>{delete i[x]}),r.headers=Aa.concat(s,i);const l=[];let c=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(r)===!1||(c=c&&p.synchronous,l.unshift(p.fulfilled,p.rejected))});const u=[];this.interceptors.response.forEach(function(p){u.push(p.fulfilled,p.rejected)});let d,f=0,h;if(!c){const x=[lC.bind(this),void 0];for(x.unshift(...l),x.push(...u),h=x.length,d=Promise.resolve(r);f<h;)d=d.then(x[f++],x[f++]);return d}h=l.length;let m=r;for(f=0;f<h;){const x=l[f++],p=l[f++];try{m=x(m)}catch(g){p.call(this,g);break}}try{d=lC.call(this,m)}catch(x){return Promise.reject(x)}for(f=0,h=u.length;f<h;)d=d.then(u[f++],u[f++]);return d}getUri(t){t=Rc(this.defaults,t);const r=J8(t.baseURL,t.url,t.allowAbsoluteUrls);return G8(r,t.params,t.paramsSerializer)}};Ne.forEach(["delete","get","head","options"],function(t){Nc.prototype[t]=function(r,n){return this.request(Rc(n||{},{method:t,url:r,data:(n||{}).data}))}});Ne.forEach(["post","put","patch"],function(t){function r(n){return function(i,s,l){return this.request(Rc(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:s}))}}Nc.prototype[t]=r(),Nc.prototype[t+"Form"]=r(!0)});let KY=class aI{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const n=this;this.promise.then(a=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](a);n._listeners=null}),this.promise.then=a=>{let i;const s=new Promise(l=>{n.subscribe(l),i=l}).then(a);return s.cancel=function(){n.unsubscribe(i)},s},t(function(i,s,l){n.reason||(n.reason=new nf(i,s,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new aI(function(a){t=a}),cancel:t}}};function ZY(e){return function(r){return e.apply(null,r)}}function JY(e){return Ne.isObject(e)&&e.isAxiosError===!0}const D_={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(D_).forEach(([e,t])=>{D_[t]=e});function iI(e){const t=new Nc(e),r=I8(Nc.prototype.request,t);return Ne.extend(r,Nc.prototype,t,{allOwnKeys:!0}),Ne.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return iI(Rc(e,a))},r}const Wr=iI(Ip);Wr.Axios=Nc;Wr.CanceledError=nf;Wr.CancelToken=KY;Wr.isCancel=K8;Wr.VERSION=nI;Wr.toFormData=Kv;Wr.AxiosError=_t;Wr.Cancel=Wr.CanceledError;Wr.all=function(t){return Promise.all(t)};Wr.spread=ZY;Wr.isAxiosError=JY;Wr.mergeConfig=Rc;Wr.AxiosHeaders=Aa;Wr.formToJSON=e=>X8(Ne.isHTMLForm(e)?new FormData(e):e);Wr.getAdapter=rI.getAdapter;Wr.HttpStatusCode=D_;Wr.default=Wr;const{Axios:eJe,AxiosError:tJe,CanceledError:rJe,isCancel:nJe,CancelToken:aJe,VERSION:iJe,all:sJe,Cancel:oJe,isAxiosError:lJe,spread:cJe,toFormData:uJe,AxiosHeaders:dJe,HttpStatusCode:fJe,formToJSON:hJe,getAdapter:mJe,mergeConfig:pJe}=Wr,QY="https://hibiz-tr-rocket-dev-05c28b6796db.herokuapp.com/";class eX{constructor(){this.client=Wr.create({baseURL:QY,timeout:1e4,headers:{"Content-Type":"application/json"}}),this.client.interceptors.request.use(t=>{const r=this.getToken();return r&&(t.headers.Authorization=`Bearer ${r}`),t},t=>Promise.reject(t)),this.client.interceptors.response.use(t=>t,t=>{var r;return((r=t.response)==null?void 0:r.status)===401&&(this.removeToken(),window.location.href="/login"),Promise.reject(t)})}getToken(){return localStorage.getItem("access_token")}setToken(t){localStorage.setItem("access_token",t)}removeToken(){localStorage.removeItem("access_token"),localStorage.removeItem("user_profile")}getCurrentUser(){const t=localStorage.getItem("user_profile");return t?JSON.parse(t):null}setCurrentUser(t){localStorage.setItem("user_profile",JSON.stringify(t))}async login(t,r){var n,a;try{const i=await this.client.post("/api/v1/auth/login",{email:t,password:r}),{access_token:s,user:l}=i.data;return this.setToken(s),this.setCurrentUser(l),{user:l,error:null}}catch(i){return{user:null,error:{message:((a=(n=i.response)==null?void 0:n.data)==null?void 0:a.detail)||i.message||"Login failed"}}}}async register(t,r,n={}){var a,i;try{const s=await this.client.post("/api/v1/auth/register",{email:t,password:r,first_name:n.firstName||"",last_name:n.lastName||"",role:n.role||"sales_rep"}),{access_token:l,user:c}=s.data;return this.setToken(l),this.setCurrentUser(c),{user:c,error:null}}catch(s){return{user:null,error:{message:((i=(a=s.response)==null?void 0:a.data)==null?void 0:i.detail)||"Registration failed"}}}}async logout(){return this.removeToken(),{error:null}}async microsoftLogin(){try{const{microsoftAuthService:t}=await Zu(()=>import("./microsoftAuthService-A9zGodYa.js"),__vite__mapDeps([])),{token:r,user:n}=await t.initiateMicrosoftLogin();return this.setToken(r),this.setCurrentUser(n),{user:n,error:null}}catch(t){return console.error("Microsoft login error:",t),{user:null,error:{message:t.message||"Microsoft login failed"}}}}async microsoftSilentLogin(t,r){try{const{microsoftAuthService:n}=await Zu(()=>import("./microsoftAuthService-A9zGodYa.js"),__vite__mapDeps([])),{token:a,user:i}=await n.silentSSOLogin(t,r);return this.setToken(a),this.setCurrentUser(i),{user:i,error:null}}catch(n){return console.error("Silent SSO error:",n),{user:null,error:{message:n.message||"Silent SSO failed"}}}}async get(t){try{return{data:(await this.client.get(t)).data,error:null}}catch(r){return{data:null,error:this.handleError(r)}}}async post(t,r,n={}){try{return{data:(await this.client.post(t,r,n)).data,error:null}}catch(a){return{data:null,error:this.handleError(a)}}}async put(t,r){try{return{data:(await this.client.put(t,r)).data,error:null}}catch(n){return{data:null,error:this.handleError(n)}}}async patch(t,r){try{return{data:(await this.client.patch(t,r)).data,error:null}}catch(n){return{data:null,error:this.handleError(n)}}}async delete(t){try{return{data:(await this.client.delete(t)).data,error:null}}catch(r){return{data:null,error:this.handleError(r)}}}handleError(t){var r,n,a,i;if(t.response){let s="An error occurred";return t.response.status===422&&((r=t.response.data)!=null&&r.detail)?Array.isArray(t.response.data.detail)?s=t.response.data.detail.map(l=>{const c=l.loc?l.loc.join("."):"";return c?`${c}: ${l.msg}`:l.msg}).join(", "):s=t.response.data.detail:(n=t.response.data)!=null&&n.detail?s=t.response.data.detail:(a=t.response.data)!=null&&a.message&&(s=t.response.data.message),{message:s,status:t.response.status,detail:((i=t.response.data)==null?void 0:i.detail)||null}}else return t.request?{message:"No response from server. Please check your connection."}:{message:t.message||"An unexpected error occurred"}}}const be=new eX,pc={_cachedPermissions:null,_permissionsByCategory:null,_userRole:null,async fetchUserPermissions(){try{const{data:e,error:t}=await be.get("/api/v1/auth/me/permissions");return t?(console.error(" Error fetching permissions:",t),null):(this._cachedPermissions=e.permissions||[],this._permissionsByCategory=e.permissions_by_category||{},this._userRole=e.role,e)}catch(e){return console.error(" Failed to fetch user permissions:",e),null}},async getPermissions(){return await this.fetchUserPermissions(),this._cachedPermissions||[]},clearCache(){this._cachedPermissions=null,this._permissionsByCategory=null,this._userRole=null},async hasPermissionAsync(e){return(await this.getPermissions()).includes(e)},hasPermissionSync(e){return this._cachedPermissions?this._cachedPermissions.includes(e):(console.warn("Permissions not loaded yet. Call fetchUserPermissions first."),!1)},staticPermissions:{dashboard:{view_personal:["admin","sales_manager","sales_rep","user"],view_team:["admin","sales_manager"],view_company:["admin"],export_reports:["admin","sales_manager"]},contacts:{view_own:["admin","sales_manager","sales_rep","user"],view_team:["admin","sales_manager"],view_all:["admin"],create:["admin","sales_manager","sales_rep"],edit_own:["admin","sales_manager","sales_rep"],edit_team:["admin","sales_manager"],edit_all:["admin"],delete_own:["admin","sales_manager","sales_rep"],delete_team:["admin","sales_manager"],delete_all:["admin"],import_export:["admin","sales_manager"],merge_duplicates:["admin","sales_manager"]},deals:{view_own:["admin","sales_manager","sales_rep","user"],view_team:["admin","sales_manager"],view_all:["admin"],create:["admin","sales_manager","sales_rep"],edit_own:["admin","sales_manager","sales_rep"],edit_team:["admin","sales_manager"],edit_all:["admin"],delete_own:["admin","sales_manager","sales_rep"],delete_team:["admin","sales_manager"],delete_all:["admin"],move_pipeline_stages:["admin","sales_manager","sales_rep"]},activities:{view_own:["admin","sales_manager","sales_rep","user"],view_team:["admin","sales_manager"],view_all:["admin"],create:["admin","sales_manager","sales_rep"],edit_own:["admin","sales_manager","sales_rep"],edit_team:["admin","sales_manager"],delete_own:["admin","sales_manager","sales_rep"],delete_team:["admin","sales_manager"]},analytics:{view_personal:["admin","sales_manager","sales_rep"],view_team:["admin","sales_manager"],view_company:["admin"],export_reports:["admin","sales_manager"]},settings:{user_management:["admin","sales_manager"],permissions:["admin"],system_config:["admin"],integrations:["admin","sales_manager"],custom_fields:["admin","sales_manager"],email_templates:["admin","sales_manager"],view_own_profile:["admin","sales_manager","sales_rep","user"],edit_own_profile:["admin","sales_manager","sales_rep","user"]}},hasPermission(e,t,r){if(this._cachedPermissions){const n=`${t}.${r}`;return this._cachedPermissions.includes(n)}return!this.staticPermissions[t]||!this.staticPermissions[t][r]?!1:this.staticPermissions[t][r].includes(e)},canViewData(e,t,r,n=[]){switch(e){case"admin":return!0;case"sales_manager":return t===r||n.includes(t);case"sales_rep":case"user":return t===r;default:return!1}},canEditData(e,t,r,n=[]){switch(e){case"admin":return!0;case"sales_manager":return t===r||n.includes(t);case"sales_rep":return t===r;case"user":return t===r;default:return!1}},getAllowedNavigation(e){return{dashboard:this.hasPermission(e,"dashboard","view_personal"),contacts:this.hasPermission(e,"contacts","view_own"),deals:this.hasPermission(e,"deals","view_own"),activities:this.hasPermission(e,"activities","view_own"),analytics:this.hasPermission(e,"analytics","view_personal"),settings:this.hasPermission(e,"settings","view_own_profile")}},getAllowedSettingsSections(e){return{"user-management":this.hasPermission(e,"settings","user_management"),permissions:this.hasPermission(e,"settings","permissions"),integrations:this.hasPermission(e,"settings","integrations"),"custom-fields":this.hasPermission(e,"settings","custom_fields"),"email-templates":this.hasPermission(e,"settings","email_templates"),"system-config":this.hasPermission(e,"settings","system_config")}},getRoleLevel(e){return{user:1,sales_rep:2,sales_manager:3,admin:4}[e]||0},canManageRole(e,t){return this.getRoleLevel(e)>this.getRoleLevel(t)}},sI=M.createContext({}),Vt=()=>{const e=M.useContext(sI);if(!e)throw new Error("useAuth must be used within AuthProvider");return e},tX=({children:e})=>{const[t,r]=M.useState(null),[n,a]=M.useState(null),[i,s]=M.useState(!0),[l,c]=M.useState(""),[u,d]=M.useState([]);M.useEffect(()=>{(async()=>{const S=be.getToken(),E=be.getCurrentUser();S&&E&&(r(E),a(E),await f()),s(!1)})()},[]);const f=async()=>{try{const N=await pc.fetchUserPermissions();if(N){const S=N.permissions||[];d(S)}else console.warn(" No permissions data received")}catch(N){console.error(" Failed to load permissions:",N)}},j={user:t,userProfile:n,loading:i,authError:l,permissions:u,signIn:async(N,S)=>{try{c(""),s(!0);const{user:E,error:A}=await be.login(N,S);if(A)return c(A.message),{error:A};if(E)return r(E),a(E),await f(),{user:E,userProfile:E}}catch{const A="Sign in failed. Please try again.";return c(A),{error:{message:A}}}finally{s(!1)}},signUp:async(N,S,E={})=>{try{c(""),s(!0);const{user:A,error:T}=await be.register(N,S,E);if(T)return c(T.message),{error:T};if(A)return r(A),a(A),await f(),{user:A,userProfile:A}}catch{const T="Sign up failed. Please try again.";return c(T),{error:{message:T}}}finally{s(!1)}},signInWithMicrosoft:async()=>{try{c(""),s(!0);const{user:N,error:S}=await be.microsoftLogin();if(S)return c(S.message),{error:S};if(N)return r(N),a(N),await f(),{user:N,userProfile:N}}catch(N){const S=N.message||"Microsoft sign-in failed. Please try again.";return c(S),{error:{message:S}}}finally{s(!1)}},attemptSilentSSO:async()=>{try{const{microsoftAuthService:N}=await Zu(()=>import("./microsoftAuthService-A9zGodYa.js"),__vite__mapDeps([]));return N.shouldAttemptSharePointSSO()?{user:null,error:null}:{user:null,error:null}}catch(N){return console.error("Silent SSO error:",N),{user:null,error:null}}},signOut:async()=>{try{await be.logout(),r(null),a(null),d([]),c(""),pc.clearCache()}catch(N){console.error("Sign out error:",N)}},getUserProfile:async N=>{const S=be.getCurrentUser();return S&&S.id===N?S:null},updateUserProfile:async(N,S)=>{try{const{data:E,error:A}=await be.patch(`/users/${N}`,S);return A?{data:null,error:A}:(be.setCurrentUser(E),r(E),a(E),{data:E,error:null})}catch{return{data:null,error:{message:"Failed to update profile"}}}},clearAuthError:()=>c(""),hasPermission:N=>u.includes(N),hasAnyPermission:N=>N.some(S=>u.includes(S)),loadUserPermissions:f,refreshPermissions:async()=>(await f(),u)};return o.jsx(sI.Provider,{value:j,children:e})},oI=M.createContext({theme:"light",toggleTheme:()=>{}}),rX=({children:e})=>{const t=()=>{try{const i=localStorage.getItem("theme");if(i)return i;if(typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches)return"dark"}catch{}return"light"},[r,n]=M.useState(t);M.useEffect(()=>{const i=window.document.documentElement;r==="dark"?i.classList.add("dark"):i.classList.remove("dark");try{i.setAttribute("data-theme",r),localStorage.setItem("theme",r)}catch{}},[r]);const a=()=>n(i=>i==="light"?"dark":"light");return o.jsx(oI.Provider,{value:{theme:r,toggleTheme:a},children:e})},nX=()=>{const{pathname:e}=Xj();return M.useEffect(()=>{window.scrollTo(0,0)},[e]),null};function Y({name:e,size:t=24,color:r="currentColor",className:n="",strokeWidth:a=2,...i}){var l;const s=(l=pq)==null?void 0:l[e];return s?o.jsx(s,{size:t,color:r,strokeWidth:a,className:n,...i}):o.jsx(mq,{size:t,color:"gray",strokeWidth:a,className:n,...i})}let aX=class extends Q.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,r){}render(){var t,r;return(t=this.state)!=null&&t.hasError?o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-neutral-50",children:o.jsxs("div",{className:"text-center p-8 max-w-md",children:[o.jsx("div",{className:"flex justify-center items-center mb-2",children:o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"42px",height:"42px",viewBox:"0 0 32 33",fill:"none",children:[o.jsx("path",{d:"M16 28.5C22.6274 28.5 28 23.1274 28 16.5C28 9.87258 22.6274 4.5 16 4.5C9.37258 4.5 4 9.87258 4 16.5C4 23.1274 9.37258 28.5 16 28.5Z",stroke:"#343330","stroke-width":"2","stroke-miterlimit":"10"}),o.jsx("path",{d:"M11.5 15.5C12.3284 15.5 13 14.8284 13 14C13 13.1716 12.3284 12.5 11.5 12.5C10.6716 12.5 10 13.1716 10 14C10 14.8284 10.6716 15.5 11.5 15.5Z",fill:"#343330"}),o.jsx("path",{d:"M20.5 15.5C21.3284 15.5 22 14.8284 22 14C22 13.1716 21.3284 12.5 20.5 12.5C19.6716 12.5 19 13.1716 19 14C19 14.8284 19.6716 15.5 20.5 15.5Z",fill:"#343330"}),o.jsx("path",{d:"M21 22.5C19.9625 20.7062 18.2213 19.5 16 19.5C13.7787 19.5 12.0375 20.7062 11 22.5",stroke:"#343330","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})]})}),o.jsxs("div",{className:"flex flex-col gap-1 text-center",children:[o.jsx("h1",{className:"text-2xl font-medium text-neutral-800",children:"Something went wrong"}),o.jsx("p",{className:"text-neutral-600 text-base w-8/12 mx-auto",children:"We encountered an unexpected error while processing your request."})]}),o.jsx("div",{className:"flex justify-center items-center mt-6",children:o.jsxs("button",{onClick:()=>{window.location.href="/"},className:"bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded flex items-center gap-2 transition-colors duration-200 shadow-sm",children:[o.jsx(Y,{name:"ArrowLeft",size:18,color:"#fff"}),"Back"]})})]})}):(r=this.props)==null?void 0:r.children}};const _a=({children:e,requiredRoles:t=[],requiredPermission:r=null,requiredPermissions:n=[]})=>{const{user:a,loading:i,hasPermission:s,hasAnyPermission:l,permissions:c}=Vt();return i?o.jsx("div",{className:"flex items-center justify-center min-h-screen",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):a?t.length>0&&!t.includes(a.role)?o.jsx("div",{className:"flex items-center justify-center min-h-screen",children:o.jsxs("div",{className:"text-center p-8",children:[o.jsx(Y,{name:"Lock",size:64,className:"text-text-tertiary mx-auto mb-4"}),o.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:"Access Denied"}),o.jsx("p",{className:"text-text-secondary",children:"You don't have permission to access this page."}),o.jsxs("p",{className:"text-text-tertiary text-sm mt-2",children:["Required roles: ",t.join(", ")]})]})}):r&&!s(r)?o.jsx("div",{className:"flex items-center justify-center min-h-screen",children:o.jsxs("div",{className:"text-center p-8",children:[o.jsx(Y,{name:"Shield",size:64,className:"text-text-tertiary mx-auto mb-4"}),o.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:"Insufficient Permissions"}),o.jsx("p",{className:"text-text-secondary",children:"You don't have permission to perform this action."}),o.jsxs("p",{className:"text-text-tertiary text-sm mt-2",children:["Required permission: ",r]})]})}):n&&n.length>0&&!l(n)?o.jsx("div",{className:"flex items-center justify-center min-h-screen",children:o.jsxs("div",{className:"text-center p-8",children:[o.jsx(Y,{name:"Shield",size:64,className:"text-text-tertiary mx-auto mb-4"}),o.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:"Insufficient Permissions"}),o.jsx("p",{className:"text-text-secondary",children:"You don't have permission to access this page."}),o.jsxs("p",{className:"text-text-tertiary text-sm mt-2",children:["Required one of: ",n.join(", ")]})]})}):e:o.jsx(dq,{to:"/login",replace:!0})},uC=()=>{const[e,t]=M.useState(""),[r,n]=M.useState(""),[a,i]=M.useState(!1),[s,l]=M.useState(!1),[c,u]=M.useState(!1),{signIn:d,authError:f,clearAuthError:h}=Vt(),m=Il(),[x]=Cp(),p=async v=>{v==null||v.preventDefault(),i(!0),h();const{user:y,error:b}=await d(e,r);y&&!b&&m("/sales-dashboard"),i(!1)},g=async()=>{l(!0),h();try{const v="https://hibiz-tr-rocket-dev-05c28b6796db.herokuapp.com/".replace(/\/$/,""),y=await fetch(`${v}/api/v1/auth/microsoft/login`);if(!y.ok)throw new Error("Failed to get Microsoft login URL");const{auth_url:b}=await y.json();window.location.href=b}catch{l(!1)}};return M.useEffect(()=>{if(x.get("auto")==="microsoft"){const y=async()=>{try{const b="https://hibiz-tr-rocket-dev-05c28b6796db.herokuapp.com/".replace(/\/$/,""),w=await fetch(`${b}/api/v1/auth/microsoft/login`);if(!w.ok)throw new Error("Failed to get Microsoft login URL");const{auth_url:_}=await w.json();window.location.href=_}catch{u(!1)}};u(!0),y()}},[x]),o.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary-50 to-blue-50 py-6 xs:py-12 px-3 xs:px-4 sm:px-6 lg:px-8",children:[c&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:o.jsx("div",{className:"bg-white rounded-2xl shadow-2xl p-6 xs:p-8 max-w-md w-full mx-4",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 xs:h-16 xs:w-16 border-b-4 border-primary mx-auto mb-4"}),o.jsx("h2",{className:"text-xl xs:text-2xl font-bold text-text-primary mb-2",children:"Signing you in..."}),o.jsx("p",{className:"text-sm xs:text-base text-text-secondary",children:"Connecting with Microsoft to authenticate your account"})]})})}),o.jsxs("div",{className:"max-w-md w-full",children:[o.jsxs("div",{className:"bg-white rounded-xl xs:rounded-2xl shadow-xl p-6 xs:p-8",children:[o.jsxs("div",{className:"text-center mb-6 xs:mb-8",children:[o.jsx("div",{className:"w-14 h-14 xs:w-16 xs:h-16 bg-primary rounded-lg xs:rounded-xl flex items-center justify-center mx-auto mb-3 xs:mb-4",children:o.jsx(Y,{name:"BarChart3",size:24,className:"xs:w-7 xs:h-7 text-white"})}),o.jsx("h2",{className:"text-2xl xs:text-3xl font-bold text-text-primary",children:"Welcome back"}),o.jsx("p",{className:"text-sm xs:text-base text-text-secondary mt-1 xs:mt-2",children:"Sign in to your SalesFlow account"})]}),o.jsxs("form",{className:"space-y-4 xs:space-y-6",onSubmit:p,children:[f&&o.jsxs("div",{className:"bg-error-50 border border-error-200 text-error rounded-lg p-3 xs:p-4 flex items-start space-x-2",children:[o.jsx(Y,{name:"AlertCircle",size:16,className:"text-error flex-shrink-0 mt-0.5"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-xs xs:text-sm break-words",children:f}),o.jsx("button",{type:"button",onClick:()=>{var y;const v=f;(y=navigator.clipboard)==null||y.writeText(v)},className:"text-xs text-error-600 hover:text-error-700 underline mt-1",children:"Copy error message"})]}),o.jsx("button",{type:"button",onClick:h,className:"text-error hover:text-error-600 flex-shrink-0 min-h-touch min-w-touch flex items-center justify-center -m-1","aria-label":"Close error message",children:o.jsx(Y,{name:"X",size:16})})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-text-primary mb-2",children:"Email address"}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"input-field pl-10",placeholder:"Enter your email",value:e,onChange:v=>{var y;return t((y=v==null?void 0:v.target)==null?void 0:y.value)}}),o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(Y,{name:"Mail",size:18,className:"text-text-tertiary"})})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-text-primary mb-2",children:"Password"}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"input-field pl-10",placeholder:"Enter your password",value:r,onChange:v=>{var y;return n((y=v==null?void 0:v.target)==null?void 0:y.value)}}),o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(Y,{name:"Lock",size:18,className:"text-text-tertiary"})})]})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 text-primary focus:ring-primary border-border rounded"}),o.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-text-secondary",children:"Remember me"})]}),o.jsx("div",{className:"text-sm",children:o.jsx(Ur,{to:"/forgot-password",className:"font-medium text-primary hover:text-primary-600",children:"Forgot your password?"})})]}),o.jsx("div",{children:o.jsx("button",{type:"submit",disabled:a,className:"btn-primary w-full flex justify-center items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed min-h-touch",children:a?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),o.jsx("span",{className:"text-sm xs:text-base",children:"Signing in..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(Y,{name:"LogIn",size:18}),o.jsx("span",{className:"text-sm xs:text-base",children:"Sign in"})]})})})]}),o.jsx("div",{className:"mt-5 xs:mt-6",children:o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-0 flex items-center",children:o.jsx("div",{className:"w-full border-t border-border"})}),o.jsx("div",{className:"relative flex justify-center text-xs xs:text-sm",children:o.jsx("span",{className:"px-2 bg-white text-text-secondary",children:"Or continue with"})})]})}),o.jsx("div",{className:"mt-5 xs:mt-6",children:o.jsx("button",{type:"button",onClick:g,disabled:a||s,className:"w-full flex items-center justify-center px-4 py-3 min-h-touch border border-gray-300 rounded-lg shadow-sm bg-white text-xs xs:text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition-colors duration-150 disabled:opacity-50 disabled:cursor-not-allowed",children:s?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 xs:h-5 xs:w-5 border-b-2 border-gray-700 mr-2 xs:mr-3"}),o.jsx("span",{children:"Signing in with Microsoft..."})]}):o.jsxs(o.Fragment,{children:[o.jsxs("svg",{className:"w-4 h-4 xs:w-5 xs:h-5 mr-2 xs:mr-3 flex-shrink-0",viewBox:"0 0 21 21",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[o.jsx("rect",{x:"1",y:"1",width:"9",height:"9",fill:"#F25022"}),o.jsx("rect",{x:"1",y:"11",width:"9",height:"9",fill:"#00A4EF"}),o.jsx("rect",{x:"11",y:"1",width:"9",height:"9",fill:"#7FBA00"}),o.jsx("rect",{x:"11",y:"11",width:"9",height:"9",fill:"#FFB900"})]}),o.jsx("span",{children:"Sign in with Microsoft"})]})})})]}),o.jsx("div",{className:"mt-8 text-center",children:o.jsx("p",{className:"text-xs text-text-tertiary",children:" 2025 SalesFlow Pro. Built with React & Supabase."})})]})]})},iX=()=>{const[e,t]=M.useState(""),[r,n]=M.useState(!1),[a,i]=M.useState(!1),[s,l]=M.useState(""),c=async u=>{var d,f;u.preventDefault(),l(""),i(!1),n(!0);try{await be.post("/api/v1/auth/forgot-password",{email:e.trim()}),i(!0),t("")}catch(h){console.error("Forgot password error:",h),l(((f=(d=h.response)==null?void 0:d.data)==null?void 0:f.detail)||"Failed to send reset link. Please try again.")}finally{n(!1)}};return o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary-50 to-blue-50 py-12 px-4 sm:px-6 lg:px-8",children:o.jsx("div",{className:"max-w-md w-full",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"w-16 h-16 bg-primary rounded-xl flex items-center justify-center mx-auto mb-4",children:o.jsx(Y,{name:"Lock",size:28,className:"text-white"})}),o.jsx("h2",{className:"text-3xl font-bold text-text-primary",children:"Forgot Password?"}),o.jsx("p",{className:"text-text-secondary mt-2",children:"No worries, we'll send you reset instructions"})]}),a?o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-xl mb-4",children:o.jsx(Y,{name:"Mail",size:28,className:"text-green-600"})}),o.jsx("h3",{className:"text-xl font-semibold text-text-primary mb-2",children:"Check Your Email"}),o.jsx("p",{className:"text-text-secondary mb-4",children:"If an account exists with the email you provided, you will receive a password reset link shortly."}),o.jsx("p",{className:"text-sm text-text-tertiary mb-6",children:"Didn't receive the email? Check your spam folder or try again."}),o.jsxs("button",{onClick:()=>i(!1),className:"btn-secondary w-full flex justify-center items-center space-x-2 mb-3",children:[o.jsx(Y,{name:"ArrowLeft",size:18}),o.jsx("span",{children:"Send Another Link"})]}),o.jsx(Ur,{to:"/login",className:"block text-center text-primary hover:text-primary-600 font-medium transition-colors duration-150",children:"Back to Login"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("form",{onSubmit:c,className:"space-y-6",children:[s&&o.jsxs("div",{className:"bg-error-50 border border-error-200 text-error px-4 py-3 rounded-lg flex items-start space-x-3",children:[o.jsx(Y,{name:"AlertCircle",size:20,className:"flex-shrink-0 mt-0.5"}),o.jsx("span",{className:"text-sm",children:s})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-text-secondary mb-2",children:"Email Address"}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(Y,{name:"Mail",size:20,className:"text-text-tertiary"})}),o.jsx("input",{id:"email",type:"email",value:e,onChange:u=>t(u.target.value),placeholder:"Enter your email",required:!0,className:"w-full pl-10 pr-4 py-3 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all duration-150 outline-none text-text-primary placeholder-text-tertiary",disabled:r})]}),o.jsx("p",{className:"mt-2 text-sm text-text-tertiary",children:"Enter the email address associated with your account"})]}),o.jsx("button",{type:"submit",disabled:r||!e.trim(),className:"btn-primary w-full flex justify-center items-center space-x-2",children:r?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}),o.jsx("span",{children:"Sending..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(Y,{name:"Mail",size:18}),o.jsx("span",{children:"Send Reset Link"})]})})]}),o.jsx("div",{className:"mt-6 text-center",children:o.jsxs(Ur,{to:"/login",className:"inline-flex items-center space-x-2 text-primary hover:text-primary-600 font-medium transition-colors duration-150",children:[o.jsx(Y,{name:"ArrowLeft",size:16}),o.jsx("span",{children:"Back to Login"})]})})]})]})})})},sX=()=>{const[e]=Cp(),t=Il(),[r,n]=M.useState(""),[a,i]=M.useState(""),[s,l]=M.useState(""),[c,u]=M.useState(!1),[d,f]=M.useState(!1),[h,m]=M.useState(!1),[x,p]=M.useState(!1),[g,v]=M.useState("");M.useEffect(()=>{const w=e.get("token");w?n(w):v("Invalid reset link. Please request a new password reset.")},[e]);const y=()=>a.length<5?(v("Password must be at least 5 characters long"),!1):a!==s?(v("Passwords do not match"),!1):!0,b=async w=>{var _,D;if(w.preventDefault(),v(""),!!y()){m(!0);try{await be.post("/api/v1/auth/reset-password",{token:r,new_password:a}),p(!0),setTimeout(()=>{t("/login")},3e3)}catch(j){console.error("Reset password error:",j),v(((D=(_=j.response)==null?void 0:_.data)==null?void 0:D.detail)||"Failed to reset password. The link may be expired or invalid.")}finally{m(!1)}}};return!r&&!h?o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary-50 to-blue-50 py-12 px-4 sm:px-6 lg:px-8",children:o.jsx("div",{className:"max-w-md w-full",children:o.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"w-16 h-16 bg-error-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:o.jsx(Y,{name:"AlertCircle",size:28,className:"text-error"})}),o.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-3",children:"Invalid Reset Link"}),o.jsx("p",{className:"text-text-secondary mb-6",children:"This password reset link is invalid or has expired."}),o.jsxs(Ur,{to:"/forgot-password",className:"btn-primary w-full flex justify-center items-center space-x-2 mb-3",children:[o.jsx(Y,{name:"Mail",size:18}),o.jsx("span",{children:"Request New Link"})]}),o.jsx(Ur,{to:"/login",className:"block text-center text-primary hover:text-primary-600 font-medium transition-colors duration-150",children:"Back to Login"})]})})})}):o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary-50 to-blue-50 py-12 px-4 sm:px-6 lg:px-8",children:o.jsx("div",{className:"max-w-md w-full",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"w-16 h-16 bg-primary rounded-xl flex items-center justify-center mx-auto mb-4",children:o.jsx(Y,{name:"Key",size:28,className:"text-white"})}),o.jsx("h2",{className:"text-3xl font-bold text-text-primary",children:"Reset Password"}),o.jsx("p",{className:"text-text-secondary mt-2",children:"Enter your new password below"})]}),x?o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-xl mb-4",children:o.jsx(Y,{name:"CheckCircle",size:28,className:"text-green-600"})}),o.jsx("h3",{className:"text-xl font-semibold text-text-primary mb-2",children:"Password Reset Successful!"}),o.jsx("p",{className:"text-text-secondary mb-4",children:"Your password has been successfully reset. You can now log in with your new password."}),o.jsx("p",{className:"text-sm text-text-tertiary mb-6",children:"Redirecting to login page in 3 seconds..."}),o.jsxs(Ur,{to:"/login",className:"btn-primary w-full flex justify-center items-center space-x-2",children:[o.jsx(Y,{name:"LogIn",size:18}),o.jsx("span",{children:"Go to Login"})]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("form",{onSubmit:b,className:"space-y-6",children:[g&&o.jsxs("div",{className:"bg-error-50 border border-error-200 text-error px-4 py-3 rounded-lg flex items-start space-x-3",children:[o.jsx(Y,{name:"AlertCircle",size:20,className:"flex-shrink-0 mt-0.5"}),o.jsx("span",{className:"text-sm",children:g})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-text-secondary mb-2",children:"New Password"}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(Y,{name:"Lock",size:20,className:"text-text-tertiary"})}),o.jsx("input",{id:"password",type:c?"text":"password",value:a,onChange:w=>i(w.target.value),placeholder:"Enter new password",required:!0,minLength:5,className:"w-full pl-10 pr-12 py-3 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all duration-150 outline-none text-text-primary placeholder-text-tertiary",disabled:h}),o.jsx("button",{type:"button",onClick:()=>u(!c),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:o.jsx(Y,{name:c?"EyeOff":"Eye",size:20,className:"text-text-tertiary hover:text-text-secondary"})})]}),o.jsx("p",{className:"mt-2 text-sm text-text-tertiary",children:"Must be at least 5 characters long"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-text-secondary mb-2",children:"Confirm Password"}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(Y,{name:"Lock",size:20,className:"text-text-tertiary"})}),o.jsx("input",{id:"confirmPassword",type:d?"text":"password",value:s,onChange:w=>l(w.target.value),placeholder:"Confirm new password",required:!0,minLength:5,className:"w-full pl-10 pr-12 py-3 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all duration-150 outline-none text-text-primary placeholder-text-tertiary",disabled:h}),o.jsx("button",{type:"button",onClick:()=>f(!d),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:o.jsx(Y,{name:d?"EyeOff":"Eye",size:20,className:"text-text-tertiary hover:text-text-secondary"})})]})]}),a&&s&&o.jsxs("div",{className:`flex items-center space-x-2 text-sm ${a===s?"text-green-600":"text-error"}`,children:[o.jsx(Y,{name:a===s?"CheckCircle":"XCircle",size:16}),o.jsx("span",{children:a===s?"Passwords match":"Passwords do not match"})]}),o.jsx("button",{type:"submit",disabled:h||!a||!s,className:"btn-primary w-full flex justify-center items-center space-x-2",children:h?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}),o.jsx("span",{children:"Resetting Password..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(Y,{name:"Key",size:18}),o.jsx("span",{children:"Reset Password"})]})})]}),o.jsx("div",{className:"mt-6 text-center",children:o.jsxs(Ur,{to:"/login",className:"inline-flex items-center space-x-2 text-primary hover:text-primary-600 font-medium transition-colors duration-150",children:[o.jsx(Y,{name:"ArrowLeft",size:16}),o.jsx("span",{children:"Back to Login"})]})})]})]})})})},oX=()=>{const[e]=Cp(),t=Il(),{loadUserPermissions:r}=Vt(),[n,a]=M.useState("processing"),[i,s]=M.useState("");return M.useEffect(()=>{(async()=>{try{const c=e.get("token"),u=e.get("user"),d=e.get("error");if(d){a("error"),s(decodeURIComponent(d)),console.error(" Microsoft callback error:",d),setTimeout(()=>{t("/login")},3e3);return}if(!c||!u){a("error"),s("Missing authentication data. Please try again."),console.error(" Missing token or user data in callback"),setTimeout(()=>{t("/login")},3e3);return}const f=JSON.parse(decodeURIComponent(u));be.setToken(c),be.setCurrentUser(f),await r(),a("success"),t("/sales-dashboard",{replace:!0})}catch(c){console.error(" Error processing Microsoft callback:",c),a("error"),s("Failed to process authentication. Please try again."),setTimeout(()=>{t("/login")},3e3)}})()},[e,t,r]),o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary-50 to-blue-50",children:o.jsx("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8",children:o.jsxs("div",{className:"text-center",children:[n==="processing"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-primary mx-auto mb-4"}),o.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Completing sign in..."}),o.jsx("p",{className:"text-text-secondary",children:"Please wait while we set up your session"})]}),n==="success"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),o.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Sign in successful!"}),o.jsx("p",{className:"text-text-secondary",children:"Redirecting to your dashboard..."})]}),n==="error"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"w-16 h-16 bg-error-100 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx("svg",{className:"w-8 h-8 text-error",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),o.jsx("h2",{className:"text-2xl font-bold text-error mb-2",children:"Sign in failed"}),o.jsx("p",{className:"text-text-secondary mb-4",children:i||"An error occurred during authentication"}),o.jsx("p",{className:"text-sm text-text-tertiary",children:"Redirecting to login page..."})]})]})})})};function q0(e,t){return q0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},q0(e,t)}function tN(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,q0(e,t)}function Co(e){"@babel/helpers - typeof";return Co=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Co(e)}function lX(e,t){if(Co(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Co(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lI(e){var t=lX(e,"string");return Co(t)=="symbol"?t:t+""}function xc(e,t,r){return(t=lI(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Jt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dC(Object(r),!0).forEach(function(n){xc(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Da(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var fC=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),hC=function(){return Math.random().toString(36).substring(7).split("").join(".")},mC={INIT:"@@redux/INIT"+hC(),REPLACE:"@@redux/REPLACE"+hC()};function cX(e){if(typeof e!="object"||e===null)return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function cI(e,t,r){var n;if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Da(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Da(1));return r(cI)(e,t)}if(typeof e!="function")throw new Error(Da(2));var a=e,i=t,s=[],l=s,c=!1;function u(){l===s&&(l=s.slice())}function d(){if(c)throw new Error(Da(3));return i}function f(p){if(typeof p!="function")throw new Error(Da(4));if(c)throw new Error(Da(5));var g=!0;return u(),l.push(p),function(){if(g){if(c)throw new Error(Da(6));g=!1,u();var y=l.indexOf(p);l.splice(y,1),s=null}}}function h(p){if(!cX(p))throw new Error(Da(7));if(typeof p.type>"u")throw new Error(Da(8));if(c)throw new Error(Da(9));try{c=!0,i=a(i,p)}finally{c=!1}for(var g=s=l,v=0;v<g.length;v++){var y=g[v];y()}return p}function m(p){if(typeof p!="function")throw new Error(Da(10));a=p,h({type:mC.REPLACE})}function x(){var p,g=f;return p={subscribe:function(y){if(typeof y!="object"||y===null)throw new Error(Da(11));function b(){y.next&&y.next(d())}b();var w=g(b);return{unsubscribe:w}}},p[fC]=function(){return this},p}return h({type:mC.INIT}),n={dispatch:h,subscribe:f,getState:d,replaceReducer:m},n[fC]=x,n}function pC(e,t){return function(){return t(e.apply(this,arguments))}}function xC(e,t){if(typeof e=="function")return pC(e,t);if(typeof e!="object"||e===null)throw new Error(Da(16));var r={};for(var n in e){var a=e[n];typeof a=="function"&&(r[n]=pC(a,t))}return r}function uI(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.length===0?function(n){return n}:t.length===1?t[0]:t.reduce(function(n,a){return function(){return n(a.apply(void 0,arguments))}})}function uX(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(n){return function(){var a=n.apply(void 0,arguments),i=function(){throw new Error(Da(15))},s={getState:a.getState,dispatch:function(){return i.apply(void 0,arguments)}},l=t.map(function(c){return c(s)});return i=uI.apply(void 0,l)(a.dispatch),Jt(Jt({},a),{},{dispatch:i})}}}var dI={exports:{}},dX="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",fX=dX,hX=fX;function fI(){}function hI(){}hI.resetWarningCache=fI;var mX=function(){function e(n,a,i,s,l,c){if(c!==hX){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:hI,resetWarningCache:fI};return r.PropTypes=r,r};dI.exports=mX();var pX=dI.exports;const ke=At(pX);var mI=Q.createContext(null);function xX(e){e()}var pI=xX,gX=function(t){return pI=t},vX=function(){return pI};function yX(){var e=vX(),t=null,r=null;return{clear:function(){t=null,r=null},notify:function(){e(function(){for(var a=t;a;)a.callback(),a=a.next})},get:function(){for(var a=[],i=t;i;)a.push(i),i=i.next;return a},subscribe:function(a){var i=!0,s=r={callback:a,next:null,prev:r};return s.prev?s.prev.next=s:t=s,function(){!i||t===null||(i=!1,s.next?s.next.prev=s.prev:r=s.prev,s.prev?s.prev.next=s.next:t=s.next)}}}}var gC={notify:function(){},get:function(){return[]}};function xI(e,t){var r,n=gC;function a(f){return c(),n.subscribe(f)}function i(){n.notify()}function s(){d.onStateChange&&d.onStateChange()}function l(){return!!r}function c(){r||(r=t?t.addNestedSub(s):e.subscribe(s),n=yX())}function u(){r&&(r(),r=void 0,n.clear(),n=gC)}var d={addNestedSub:a,notifyNestedSubs:i,handleChangeWrapper:s,isSubscribed:l,trySubscribe:c,tryUnsubscribe:u,getListeners:function(){return n}};return d}var gI=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?M.useLayoutEffect:M.useEffect;function bX(e){var t=e.store,r=e.context,n=e.children,a=M.useMemo(function(){var l=xI(t);return{store:t,subscription:l}},[t]),i=M.useMemo(function(){return t.getState()},[t]);gI(function(){var l=a.subscription;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),i!==t.getState()&&l.notifyNestedSubs(),function(){l.tryUnsubscribe(),l.onStateChange=null}},[a,i]);var s=r||mI;return Q.createElement(s.Provider,{value:a},n)}function _l(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var vI={exports:{}},tr={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sn=typeof Symbol=="function"&&Symbol.for,rN=Sn?Symbol.for("react.element"):60103,nN=Sn?Symbol.for("react.portal"):60106,Qv=Sn?Symbol.for("react.fragment"):60107,ey=Sn?Symbol.for("react.strict_mode"):60108,ty=Sn?Symbol.for("react.profiler"):60114,ry=Sn?Symbol.for("react.provider"):60109,ny=Sn?Symbol.for("react.context"):60110,aN=Sn?Symbol.for("react.async_mode"):60111,ay=Sn?Symbol.for("react.concurrent_mode"):60111,iy=Sn?Symbol.for("react.forward_ref"):60112,sy=Sn?Symbol.for("react.suspense"):60113,wX=Sn?Symbol.for("react.suspense_list"):60120,oy=Sn?Symbol.for("react.memo"):60115,ly=Sn?Symbol.for("react.lazy"):60116,_X=Sn?Symbol.for("react.block"):60121,DX=Sn?Symbol.for("react.fundamental"):60117,jX=Sn?Symbol.for("react.responder"):60118,NX=Sn?Symbol.for("react.scope"):60119;function ui(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case rN:switch(e=e.type,e){case aN:case ay:case Qv:case ty:case ey:case sy:return e;default:switch(e=e&&e.$$typeof,e){case ny:case iy:case ly:case oy:case ry:return e;default:return t}}case nN:return t}}}function yI(e){return ui(e)===ay}tr.AsyncMode=aN;tr.ConcurrentMode=ay;tr.ContextConsumer=ny;tr.ContextProvider=ry;tr.Element=rN;tr.ForwardRef=iy;tr.Fragment=Qv;tr.Lazy=ly;tr.Memo=oy;tr.Portal=nN;tr.Profiler=ty;tr.StrictMode=ey;tr.Suspense=sy;tr.isAsyncMode=function(e){return yI(e)||ui(e)===aN};tr.isConcurrentMode=yI;tr.isContextConsumer=function(e){return ui(e)===ny};tr.isContextProvider=function(e){return ui(e)===ry};tr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===rN};tr.isForwardRef=function(e){return ui(e)===iy};tr.isFragment=function(e){return ui(e)===Qv};tr.isLazy=function(e){return ui(e)===ly};tr.isMemo=function(e){return ui(e)===oy};tr.isPortal=function(e){return ui(e)===nN};tr.isProfiler=function(e){return ui(e)===ty};tr.isStrictMode=function(e){return ui(e)===ey};tr.isSuspense=function(e){return ui(e)===sy};tr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Qv||e===ay||e===ty||e===ey||e===sy||e===wX||typeof e=="object"&&e!==null&&(e.$$typeof===ly||e.$$typeof===oy||e.$$typeof===ry||e.$$typeof===ny||e.$$typeof===iy||e.$$typeof===DX||e.$$typeof===jX||e.$$typeof===NX||e.$$typeof===_X)};tr.typeOf=ui;vI.exports=tr;var SX=vI.exports,iN=SX,EX={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},TX={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},kX={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},bI={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},sN={};sN[iN.ForwardRef]=kX;sN[iN.Memo]=bI;function vC(e){return iN.isMemo(e)?bI:sN[e.$$typeof]||EX}var CX=Object.defineProperty,AX=Object.getOwnPropertyNames,yC=Object.getOwnPropertySymbols,OX=Object.getOwnPropertyDescriptor,FX=Object.getPrototypeOf,bC=Object.prototype;function wI(e,t,r){if(typeof t!="string"){if(bC){var n=FX(t);n&&n!==bC&&wI(e,n,r)}var a=AX(t);yC&&(a=a.concat(yC(t)));for(var i=vC(e),s=vC(t),l=0;l<a.length;++l){var c=a[l];if(!TX[c]&&!(r&&r[c])&&!(s&&s[c])&&!(i&&i[c])){var u=OX(t,c);try{CX(e,c,u)}catch{}}}}return e}var PX=wI;const wC=At(PX);var _I={exports:{}},cr={};/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cy=60103,uy=60106,Rp=60107,Mp=60108,Up=60114,$p=60109,Lp=60110,Bp=60112,Wp=60113,oN=60120,zp=60115,Hp=60116,DI=60121,jI=60122,NI=60117,SI=60129,EI=60131;if(typeof Symbol=="function"&&Symbol.for){var An=Symbol.for;cy=An("react.element"),uy=An("react.portal"),Rp=An("react.fragment"),Mp=An("react.strict_mode"),Up=An("react.profiler"),$p=An("react.provider"),Lp=An("react.context"),Bp=An("react.forward_ref"),Wp=An("react.suspense"),oN=An("react.suspense_list"),zp=An("react.memo"),Hp=An("react.lazy"),DI=An("react.block"),jI=An("react.server.block"),NI=An("react.fundamental"),SI=An("react.debug_trace_mode"),EI=An("react.legacy_hidden")}function gs(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case cy:switch(e=e.type,e){case Rp:case Up:case Mp:case Wp:case oN:return e;default:switch(e=e&&e.$$typeof,e){case Lp:case Bp:case Hp:case zp:case $p:return e;default:return t}}case uy:return t}}}var IX=$p,RX=cy,MX=Bp,UX=Rp,$X=Hp,LX=zp,BX=uy,WX=Up,zX=Mp,HX=Wp;cr.ContextConsumer=Lp;cr.ContextProvider=IX;cr.Element=RX;cr.ForwardRef=MX;cr.Fragment=UX;cr.Lazy=$X;cr.Memo=LX;cr.Portal=BX;cr.Profiler=WX;cr.StrictMode=zX;cr.Suspense=HX;cr.isAsyncMode=function(){return!1};cr.isConcurrentMode=function(){return!1};cr.isContextConsumer=function(e){return gs(e)===Lp};cr.isContextProvider=function(e){return gs(e)===$p};cr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===cy};cr.isForwardRef=function(e){return gs(e)===Bp};cr.isFragment=function(e){return gs(e)===Rp};cr.isLazy=function(e){return gs(e)===Hp};cr.isMemo=function(e){return gs(e)===zp};cr.isPortal=function(e){return gs(e)===uy};cr.isProfiler=function(e){return gs(e)===Up};cr.isStrictMode=function(e){return gs(e)===Mp};cr.isSuspense=function(e){return gs(e)===Wp};cr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Rp||e===Up||e===SI||e===Mp||e===Wp||e===oN||e===EI||typeof e=="object"&&e!==null&&(e.$$typeof===Hp||e.$$typeof===zp||e.$$typeof===$p||e.$$typeof===Lp||e.$$typeof===Bp||e.$$typeof===NI||e.$$typeof===DI||e[0]===jI)};cr.typeOf=gs;_I.exports=cr;var VX=_I.exports,qX=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],GX=["reactReduxForwardedRef"],YX=[],XX=[null,null];function KX(e,t){var r=e[1];return[t.payload,r+1]}function _C(e,t,r){gI(function(){return e.apply(void 0,t)},r)}function ZX(e,t,r,n,a,i,s){e.current=n,t.current=a,r.current=!1,i.current&&(i.current=null,s())}function JX(e,t,r,n,a,i,s,l,c,u){if(e){var d=!1,f=null,h=function(){if(!d){var p=t.getState(),g,v;try{g=n(p,a.current)}catch(y){v=y,f=y}v||(f=null),g===i.current?s.current||c():(i.current=g,l.current=g,s.current=!0,u({type:"STORE_UPDATED",payload:{error:v}}))}};r.onStateChange=h,r.trySubscribe(),h();var m=function(){if(d=!0,r.tryUnsubscribe(),r.onStateChange=null,f)throw f};return m}}var QX=function(){return[null,0]};function eK(e,t){t===void 0&&(t={});var r=t,n=r.getDisplayName,a=n===void 0?function(b){return"ConnectAdvanced("+b+")"}:n,i=r.methodName,s=i===void 0?"connectAdvanced":i,l=r.renderCountProp,c=l===void 0?void 0:l,u=r.shouldHandleStateChanges,d=u===void 0?!0:u,f=r.storeKey,h=f===void 0?"store":f;r.withRef;var m=r.forwardRef,x=m===void 0?!1:m,p=r.context,g=p===void 0?mI:p,v=_l(r,qX),y=g;return function(w){var _=w.displayName||w.name||"Component",D=a(_),j=Xe({},v,{getDisplayName:a,methodName:s,renderCountProp:c,shouldHandleStateChanges:d,storeKey:h,displayName:D,wrappedComponentName:_,WrappedComponent:w}),N=v.pure;function S(O){return e(O.dispatch,j)}var E=N?M.useMemo:function(O){return O()};function A(O){var V=M.useMemo(function(){var ce=O.reactReduxForwardedRef,J=_l(O,GX);return[O.context,ce,J]},[O]),W=V[0],B=V[1],P=V[2],F=M.useMemo(function(){return W&&W.Consumer&&VX.isContextConsumer(Q.createElement(W.Consumer,null))?W:y},[W,y]),I=M.useContext(F),R=!!O.store&&!!O.store.getState&&!!O.store.dispatch;I&&I.store;var C=R?O.store:I.store,k=M.useMemo(function(){return S(C)},[C]),z=M.useMemo(function(){if(!d)return XX;var ce=xI(C,R?null:I.subscription),J=ce.notifyNestedSubs.bind(ce);return[ce,J]},[C,R,I]),q=z[0],K=z[1],se=M.useMemo(function(){return R?I:Xe({},I,{subscription:q})},[R,I,q]),ie=M.useReducer(KX,YX,QX),ee=ie[0],ae=ee[0],pe=ie[1];if(ae&&ae.error)throw ae.error;var H=M.useRef(),ne=M.useRef(P),U=M.useRef(),le=M.useRef(!1),re=E(function(){return U.current&&P===ne.current?U.current:k(C.getState(),P)},[C,ae,P]);_C(ZX,[ne,H,le,P,re,U,K]),_C(JX,[d,C,q,k,ne,H,le,U,K,pe],[C,q,k]);var X=M.useMemo(function(){return Q.createElement(w,Xe({},re,{ref:B}))},[B,w,re]),G=M.useMemo(function(){return d?Q.createElement(F.Provider,{value:se},X):X},[F,X,se]);return G}var T=N?Q.memo(A):A;if(T.WrappedComponent=w,T.displayName=A.displayName=D,x){var L=Q.forwardRef(function(V,W){return Q.createElement(T,Xe({},V,{reactReduxForwardedRef:W}))});return L.displayName=D,L.WrappedComponent=w,wC(L,w)}return wC(T,w)}}function DC(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function W1(e,t){if(DC(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var a=0;a<r.length;a++)if(!Object.prototype.hasOwnProperty.call(t,r[a])||!DC(e[r[a]],t[r[a]]))return!1;return!0}function tK(e,t){var r={},n=function(s){var l=e[s];typeof l=="function"&&(r[s]=function(){return t(l.apply(void 0,arguments))})};for(var a in e)n(a);return r}function lN(e){return function(r,n){var a=e(r,n);function i(){return a}return i.dependsOnOwnProps=!1,i}}function jC(e){return e.dependsOnOwnProps!==null&&e.dependsOnOwnProps!==void 0?!!e.dependsOnOwnProps:e.length!==1}function TI(e,t){return function(n,a){a.displayName;var i=function(l,c){return i.dependsOnOwnProps?i.mapToProps(l,c):i.mapToProps(l)};return i.dependsOnOwnProps=!0,i.mapToProps=function(l,c){i.mapToProps=e,i.dependsOnOwnProps=jC(e);var u=i(l,c);return typeof u=="function"&&(i.mapToProps=u,i.dependsOnOwnProps=jC(u),u=i(l,c)),u},i}}function rK(e){return typeof e=="function"?TI(e):void 0}function nK(e){return e?void 0:lN(function(t){return{dispatch:t}})}function aK(e){return e&&typeof e=="object"?lN(function(t){return tK(e,t)}):void 0}const iK=[rK,nK,aK];function sK(e){return typeof e=="function"?TI(e):void 0}function oK(e){return e?void 0:lN(function(){return{}})}const lK=[sK,oK];function cK(e,t,r){return Xe({},r,e,t)}function uK(e){return function(r,n){n.displayName;var a=n.pure,i=n.areMergedPropsEqual,s=!1,l;return function(u,d,f){var h=e(u,d,f);return s?(!a||!i(h,l))&&(l=h):(s=!0,l=h),l}}}function dK(e){return typeof e=="function"?uK(e):void 0}function fK(e){return e?void 0:function(){return cK}}const hK=[dK,fK];var mK=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function pK(e,t,r,n){return function(i,s){return r(e(i,s),t(n,s),s)}}function xK(e,t,r,n,a){var i=a.areStatesEqual,s=a.areOwnPropsEqual,l=a.areStatePropsEqual,c=!1,u,d,f,h,m;function x(b,w){return u=b,d=w,f=e(u,d),h=t(n,d),m=r(f,h,d),c=!0,m}function p(){return f=e(u,d),t.dependsOnOwnProps&&(h=t(n,d)),m=r(f,h,d),m}function g(){return e.dependsOnOwnProps&&(f=e(u,d)),t.dependsOnOwnProps&&(h=t(n,d)),m=r(f,h,d),m}function v(){var b=e(u,d),w=!l(b,f);return f=b,w&&(m=r(f,h,d)),m}function y(b,w){var _=!s(w,d),D=!i(b,u,w,d);return u=b,d=w,_&&D?p():_?g():D?v():m}return function(w,_){return c?y(w,_):x(w,_)}}function gK(e,t){var r=t.initMapStateToProps,n=t.initMapDispatchToProps,a=t.initMergeProps,i=_l(t,mK),s=r(e,i),l=n(e,i),c=a(e,i),u=i.pure?xK:pK;return u(s,l,c,e,i)}var vK=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];function z1(e,t,r){for(var n=t.length-1;n>=0;n--){var a=t[n](e);if(a)return a}return function(i,s){throw new Error("Invalid value of type "+typeof e+" for "+r+" argument when connecting component "+s.wrappedComponentName+".")}}function yK(e,t){return e===t}function bK(e){var t=e===void 0?{}:e,r=t.connectHOC,n=r===void 0?eK:r,a=t.mapStateToPropsFactories,i=a===void 0?lK:a,s=t.mapDispatchToPropsFactories,l=s===void 0?iK:s,c=t.mergePropsFactories,u=c===void 0?hK:c,d=t.selectorFactory,f=d===void 0?gK:d;return function(m,x,p,g){g===void 0&&(g={});var v=g,y=v.pure,b=y===void 0?!0:y,w=v.areStatesEqual,_=w===void 0?yK:w,D=v.areOwnPropsEqual,j=D===void 0?W1:D,N=v.areStatePropsEqual,S=N===void 0?W1:N,E=v.areMergedPropsEqual,A=E===void 0?W1:E,T=_l(v,vK),L=z1(m,i,"mapStateToProps"),O=z1(x,l,"mapDispatchToProps"),V=z1(p,u,"mergeProps");return n(f,Xe({methodName:"connect",getDisplayName:function(B){return"Connect("+B+")"},shouldHandleStateChanges:!!m,initMapStateToProps:L,initMapDispatchToProps:O,initMergeProps:V,pure:b,areStatesEqual:_,areOwnPropsEqual:j,areStatePropsEqual:S,areMergedPropsEqual:A},T))}}const kI=bK();gX(w8.unstable_batchedUpdates);function wK(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function CI(e,t){var r=M.useState(function(){return{inputs:t,result:e()}})[0],n=M.useRef(!0),a=M.useRef(r),i=n.current||!!(t&&a.current.inputs&&wK(t,a.current.inputs)),s=i?a.current:{inputs:t,result:e()};return M.useEffect(function(){n.current=!1,a.current=s},[s]),s.result}function _K(e,t){return CI(function(){return e},t)}var Lt=CI,st=_K,DK="Invariant failed";function Dl(e,t){throw new Error(DK)}var ns=function(t){var r=t.top,n=t.right,a=t.bottom,i=t.left,s=n-i,l=a-r,c={top:r,right:n,bottom:a,left:i,width:s,height:l,x:i,y:r,center:{x:(n+i)/2,y:(a+r)/2}};return c},cN=function(t,r){return{top:t.top-r.top,left:t.left-r.left,bottom:t.bottom+r.bottom,right:t.right+r.right}},NC=function(t,r){return{top:t.top+r.top,left:t.left+r.left,bottom:t.bottom-r.bottom,right:t.right-r.right}},jK=function(t,r){return{top:t.top+r.y,left:t.left+r.x,bottom:t.bottom+r.y,right:t.right+r.x}},H1={top:0,right:0,bottom:0,left:0},uN=function(t){var r=t.borderBox,n=t.margin,a=n===void 0?H1:n,i=t.border,s=i===void 0?H1:i,l=t.padding,c=l===void 0?H1:l,u=ns(cN(r,a)),d=ns(NC(r,s)),f=ns(NC(d,c));return{marginBox:u,borderBox:ns(r),paddingBox:d,contentBox:f,margin:a,border:s,padding:c}},mi=function(t){var r=t.slice(0,-2),n=t.slice(-2);if(n!=="px")return 0;var a=Number(r);return isNaN(a)&&Dl(),a},NK=function(){return{x:window.pageXOffset,y:window.pageYOffset}},G0=function(t,r){var n=t.borderBox,a=t.border,i=t.margin,s=t.padding,l=jK(n,r);return uN({borderBox:l,border:a,margin:i,padding:s})},Y0=function(t,r){return r===void 0&&(r=NK()),G0(t,r)},AI=function(t,r){var n={top:mi(r.marginTop),right:mi(r.marginRight),bottom:mi(r.marginBottom),left:mi(r.marginLeft)},a={top:mi(r.paddingTop),right:mi(r.paddingRight),bottom:mi(r.paddingBottom),left:mi(r.paddingLeft)},i={top:mi(r.borderTopWidth),right:mi(r.borderRightWidth),bottom:mi(r.borderBottomWidth),left:mi(r.borderLeftWidth)};return uN({borderBox:t,margin:n,padding:a,border:i})},OI=function(t){var r=t.getBoundingClientRect(),n=window.getComputedStyle(t);return AI(r,n)},SC=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function SK(e,t){return!!(e===t||SC(e)&&SC(t))}function EK(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!SK(e[r],t[r]))return!1;return!0}function _n(e,t){t===void 0&&(t=EK);var r,n=[],a,i=!1;function s(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];return i&&r===this&&t(l,n)||(a=e.apply(this,l),i=!0,r=this,n=l),a}return s}var Gh=function(t){var r=[],n=null,a=function(){for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];r=l,!n&&(n=requestAnimationFrame(function(){n=null,t.apply(void 0,r)}))};return a.cancel=function(){n&&(cancelAnimationFrame(n),n=null)},a};function FI(e,t){}FI.bind(null,"warn");FI.bind(null,"error");function pl(){}function TK(e,t){return Xe({},e,{},t)}function Fi(e,t,r){var n=t.map(function(a){var i=TK(r,a.options);return e.addEventListener(a.eventName,a.fn,i),function(){e.removeEventListener(a.eventName,a.fn,i)}});return function(){n.forEach(function(i){i()})}}var kK="Invariant failed";function X0(e){this.message=e}X0.prototype.toString=function(){return this.message};function He(e,t){throw new X0(kK)}var CK=function(e){tN(t,e);function t(){for(var n,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=e.call.apply(e,[this].concat(i))||this,n.callbacks=null,n.unbind=pl,n.onWindowError=function(l){var c=n.getCallbacks();c.isDragging()&&c.tryAbort();var u=l.error;u instanceof X0&&l.preventDefault()},n.getCallbacks=function(){if(!n.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return n.callbacks},n.setCallbacks=function(l){n.callbacks=l},n}var r=t.prototype;return r.componentDidMount=function(){this.unbind=Fi(window,[{eventName:"error",fn:this.onWindowError}])},r.componentDidCatch=function(a){if(a instanceof X0){this.setState({});return}throw a},r.componentWillUnmount=function(){this.unbind()},r.render=function(){return this.props.children(this.setCallbacks)},t}(Q.Component),AK=`
  Press space bar to start a drag.
  When dragging you can use the arrow keys to move the item around and escape to cancel.
  Some screen readers may require you to be in focus mode or to use your pass through key
`,K0=function(t){return t+1},OK=function(t){return`
  You have lifted an item in position `+K0(t.source.index)+`
`},PI=function(t,r){var n=t.droppableId===r.droppableId,a=K0(t.index),i=K0(r.index);return n?`
      You have moved the item from position `+a+`
      to position `+i+`
    `:`
    You have moved the item from position `+a+`
    in list `+t.droppableId+`
    to list `+r.droppableId+`
    in position `+i+`
  `},II=function(t,r,n){var a=r.droppableId===n.droppableId;return a?`
      The item `+t+`
      has been combined with `+n.draggableId:`
      The item `+t+`
      in list `+r.droppableId+`
      has been combined with `+n.draggableId+`
      in list `+n.droppableId+`
    `},FK=function(t){var r=t.destination;if(r)return PI(t.source,r);var n=t.combine;return n?II(t.draggableId,t.source,n):"You are over an area that cannot be dropped on"},EC=function(t){return`
  The item has returned to its starting position
  of `+K0(t.index)+`
`},PK=function(t){if(t.reason==="CANCEL")return`
      Movement cancelled.
      `+EC(t.source)+`
    `;var r=t.destination,n=t.combine;return r?`
      You have dropped the item.
      `+PI(t.source,r)+`
    `:n?`
      You have dropped the item.
      `+II(t.draggableId,t.source,n)+`
    `:`
    The item has been dropped while not over a drop area.
    `+EC(t.source)+`
  `},C0={dragHandleUsageInstructions:AK,onDragStart:OK,onDragUpdate:FK,onDragEnd:PK},Dn={x:0,y:0},Rn=function(t,r){return{x:t.x+r.x,y:t.y+r.y}},Qa=function(t,r){return{x:t.x-r.x,y:t.y-r.y}},xl=function(t,r){return t.x===r.x&&t.y===r.y},af=function(t){return{x:t.x!==0?-t.x:0,y:t.y!==0?-t.y:0}},Mc=function(t,r,n){var a;return n===void 0&&(n=0),a={},a[t]=r,a[t==="x"?"y":"x"]=n,a},Yh=function(t,r){return Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2))},TC=function(t,r){return Math.min.apply(Math,r.map(function(n){return Yh(t,n)}))},RI=function(t){return function(r){return{x:t(r.x),y:t(r.y)}}},IK=function(e,t){var r=ns({top:Math.max(t.top,e.top),right:Math.min(t.right,e.right),bottom:Math.min(t.bottom,e.bottom),left:Math.max(t.left,e.left)});return r.width<=0||r.height<=0?null:r},Vp=function(t,r){return{top:t.top+r.y,left:t.left+r.x,bottom:t.bottom+r.y,right:t.right+r.x}},kC=function(t){return[{x:t.left,y:t.top},{x:t.right,y:t.top},{x:t.left,y:t.bottom},{x:t.right,y:t.bottom}]},RK={top:0,right:0,bottom:0,left:0},MK=function(t,r){return r?Vp(t,r.scroll.diff.displacement):t},UK=function(t,r,n){if(n&&n.increasedBy){var a;return Xe({},t,(a={},a[r.end]=t[r.end]+n.increasedBy[r.line],a))}return t},$K=function(t,r){return r&&r.shouldClipSubject?IK(r.pageMarginBox,t):ns(t)},dd=function(e){var t=e.page,r=e.withPlaceholder,n=e.axis,a=e.frame,i=MK(t.marginBox,a),s=UK(i,n,r),l=$K(s,a);return{page:t,withPlaceholder:r,active:l}},dN=function(e,t){e.frame||He();var r=e.frame,n=Qa(t,r.scroll.initial),a=af(n),i=Xe({},r,{scroll:{initial:r.scroll.initial,current:t,diff:{value:n,displacement:a},max:r.scroll.max}}),s=dd({page:e.subject.page,withPlaceholder:e.subject.withPlaceholder,axis:e.axis,frame:i}),l=Xe({},e,{frame:i,subject:s});return l};function Z0(e){return Object.values?Object.values(e):Object.keys(e).map(function(t){return e[t]})}function fN(e,t){if(e.findIndex)return e.findIndex(t);for(var r=0;r<e.length;r++)if(t(e[r]))return r;return-1}function Ml(e,t){if(e.find)return e.find(t);var r=fN(e,t);if(r!==-1)return e[r]}function MI(e){return Array.prototype.slice.call(e)}var UI=_n(function(e){return e.reduce(function(t,r){return t[r.descriptor.id]=r,t},{})}),$I=_n(function(e){return e.reduce(function(t,r){return t[r.descriptor.id]=r,t},{})}),dy=_n(function(e){return Z0(e)}),LK=_n(function(e){return Z0(e)}),sf=_n(function(e,t){var r=LK(t).filter(function(n){return e===n.descriptor.droppableId}).sort(function(n,a){return n.descriptor.index-a.descriptor.index});return r});function hN(e){return e.at&&e.at.type==="REORDER"?e.at.destination:null}function fy(e){return e.at&&e.at.type==="COMBINE"?e.at.combine:null}var hy=_n(function(e,t){return t.filter(function(r){return r.descriptor.id!==e.descriptor.id})}),BK=function(e){var t=e.isMovingForward,r=e.draggable,n=e.destination,a=e.insideDestination,i=e.previousImpact;if(!n.isCombineEnabled)return null;var s=hN(i);if(!s)return null;function l(p){var g={type:"COMBINE",combine:{draggableId:p,droppableId:n.descriptor.id}};return Xe({},i,{at:g})}var c=i.displaced.all,u=c.length?c[0]:null;if(t)return u?l(u):null;var d=hy(r,a);if(!u){if(!d.length)return null;var f=d[d.length-1];return l(f.descriptor.id)}var h=fN(d,function(p){return p.descriptor.id===u});h===-1&&He();var m=h-1;if(m<0)return null;var x=d[m];return l(x.descriptor.id)},of=function(e,t){return e.descriptor.droppableId===t.descriptor.id},LI={point:Dn,value:0},Xh={invisible:{},visible:{},all:[]},WK={displaced:Xh,displacedBy:LI,at:null},Ri=function(e,t){return function(r){return e<=r&&r<=t}},BI=function(e){var t=Ri(e.top,e.bottom),r=Ri(e.left,e.right);return function(n){var a=t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right);if(a)return!0;var i=t(n.top)||t(n.bottom),s=r(n.left)||r(n.right),l=i&&s;if(l)return!0;var c=n.top<e.top&&n.bottom>e.bottom,u=n.left<e.left&&n.right>e.right,d=c&&u;if(d)return!0;var f=c&&s||u&&i;return f}},zK=function(e){var t=Ri(e.top,e.bottom),r=Ri(e.left,e.right);return function(n){var a=t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right);return a}},mN={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},WI={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"},HK=function(e){return function(t){var r=Ri(t.top,t.bottom),n=Ri(t.left,t.right);return function(a){return e===mN?r(a.top)&&r(a.bottom):n(a.left)&&n(a.right)}}},VK=function(t,r){var n=r.frame?r.frame.scroll.diff.displacement:Dn;return Vp(t,n)},qK=function(t,r,n){return r.subject.active?n(r.subject.active)(t):!1},GK=function(t,r,n){return n(r)(t)},pN=function(t){var r=t.target,n=t.destination,a=t.viewport,i=t.withDroppableDisplacement,s=t.isVisibleThroughFrameFn,l=i?VK(r,n):r;return qK(l,n,s)&&GK(l,a,s)},YK=function(t){return pN(Xe({},t,{isVisibleThroughFrameFn:BI}))},zI=function(t){return pN(Xe({},t,{isVisibleThroughFrameFn:zK}))},XK=function(t){return pN(Xe({},t,{isVisibleThroughFrameFn:HK(t.destination.axis)}))},KK=function(t,r,n){if(typeof n=="boolean")return n;if(!r)return!0;var a=r.invisible,i=r.visible;if(a[t])return!1;var s=i[t];return s?s.shouldAnimate:!0};function ZK(e,t){var r=e.page.marginBox,n={top:t.point.y,right:0,bottom:0,left:t.point.x};return ns(cN(r,n))}function Kh(e){var t=e.afterDragging,r=e.destination,n=e.displacedBy,a=e.viewport,i=e.forceShouldAnimate,s=e.last;return t.reduce(function(c,u){var d=ZK(u,n),f=u.descriptor.id;c.all.push(f);var h=YK({target:d,destination:r,viewport:a,withDroppableDisplacement:!0});if(!h)return c.invisible[u.descriptor.id]=!0,c;var m=KK(f,s,i),x={draggableId:f,shouldAnimate:m};return c.visible[f]=x,c},{all:[],visible:{},invisible:{}})}function JK(e,t){if(!e.length)return 0;var r=e[e.length-1].descriptor.index;return t.inHomeList?r:r+1}function CC(e){var t=e.insideDestination,r=e.inHomeList,n=e.displacedBy,a=e.destination,i=JK(t,{inHomeList:r});return{displaced:Xh,displacedBy:n,at:{type:"REORDER",destination:{droppableId:a.descriptor.id,index:i}}}}function J0(e){var t=e.draggable,r=e.insideDestination,n=e.destination,a=e.viewport,i=e.displacedBy,s=e.last,l=e.index,c=e.forceShouldAnimate,u=of(t,n);if(l==null)return CC({insideDestination:r,inHomeList:u,displacedBy:i,destination:n});var d=Ml(r,function(p){return p.descriptor.index===l});if(!d)return CC({insideDestination:r,inHomeList:u,displacedBy:i,destination:n});var f=hy(t,r),h=r.indexOf(d),m=f.slice(h),x=Kh({afterDragging:m,destination:n,displacedBy:i,last:s,viewport:a.frame,forceShouldAnimate:c});return{displaced:x,displacedBy:i,at:{type:"REORDER",destination:{droppableId:n.descriptor.id,index:l}}}}function jl(e,t){return!!t.effected[e]}var QK=function(e){var t=e.isMovingForward,r=e.destination,n=e.draggables,a=e.combine,i=e.afterCritical;if(!r.isCombineEnabled)return null;var s=a.draggableId,l=n[s],c=l.descriptor.index,u=jl(s,i);return u?t?c:c-1:t?c+1:c},eZ=function(e){var t=e.isMovingForward,r=e.isInHomeList,n=e.insideDestination,a=e.location;if(!n.length)return null;var i=a.index,s=t?i+1:i-1,l=n[0].descriptor.index,c=n[n.length-1].descriptor.index,u=r?c:c+1;return s<l||s>u?null:s},tZ=function(e){var t=e.isMovingForward,r=e.isInHomeList,n=e.draggable,a=e.draggables,i=e.destination,s=e.insideDestination,l=e.previousImpact,c=e.viewport,u=e.afterCritical,d=l.at;if(d||He(),d.type==="REORDER"){var f=eZ({isMovingForward:t,isInHomeList:r,location:d.destination,insideDestination:s});return f==null?null:J0({draggable:n,insideDestination:s,destination:i,viewport:c,last:l.displaced,displacedBy:l.displacedBy,index:f})}var h=QK({isMovingForward:t,destination:i,displaced:l.displaced,draggables:a,combine:d.combine,afterCritical:u});return h==null?null:J0({draggable:n,insideDestination:s,destination:i,viewport:c,last:l.displaced,displacedBy:l.displacedBy,index:h})},rZ=function(e){var t=e.displaced,r=e.afterCritical,n=e.combineWith,a=e.displacedBy,i=!!(t.visible[n]||t.invisible[n]);return jl(n,r)?i?Dn:af(a.point):i?a.point:Dn},nZ=function(e){var t=e.afterCritical,r=e.impact,n=e.draggables,a=fy(r);a||He();var i=a.draggableId,s=n[i].page.borderBox.center,l=rZ({displaced:r.displaced,afterCritical:t,combineWith:i,displacedBy:r.displacedBy});return Rn(s,l)},HI=function(t,r){return r.margin[t.start]+r.borderBox[t.size]/2},aZ=function(t,r){return r.margin[t.end]+r.borderBox[t.size]/2},xN=function(t,r,n){return r[t.crossAxisStart]+n.margin[t.crossAxisStart]+n.borderBox[t.crossAxisSize]/2},AC=function(t){var r=t.axis,n=t.moveRelativeTo,a=t.isMoving;return Mc(r.line,n.marginBox[r.end]+HI(r,a),xN(r,n.marginBox,a))},OC=function(t){var r=t.axis,n=t.moveRelativeTo,a=t.isMoving;return Mc(r.line,n.marginBox[r.start]-aZ(r,a),xN(r,n.marginBox,a))},iZ=function(t){var r=t.axis,n=t.moveInto,a=t.isMoving;return Mc(r.line,n.contentBox[r.start]+HI(r,a),xN(r,n.contentBox,a))},sZ=function(e){var t=e.impact,r=e.draggable,n=e.draggables,a=e.droppable,i=e.afterCritical,s=sf(a.descriptor.id,n),l=r.page,c=a.axis;if(!s.length)return iZ({axis:c,moveInto:a.page,isMoving:l});var u=t.displaced,d=t.displacedBy,f=u.all[0];if(f){var h=n[f];if(jl(f,i))return OC({axis:c,moveRelativeTo:h.page,isMoving:l});var m=G0(h.page,d.point);return OC({axis:c,moveRelativeTo:m,isMoving:l})}var x=s[s.length-1];if(x.descriptor.id===r.descriptor.id)return l.borderBox.center;if(jl(x.descriptor.id,i)){var p=G0(x.page,af(i.displacedBy.point));return AC({axis:c,moveRelativeTo:p,isMoving:l})}return AC({axis:c,moveRelativeTo:x.page,isMoving:l})},j_=function(e,t){var r=e.frame;return r?Rn(t,r.scroll.diff.displacement):t},oZ=function(t){var r=t.impact,n=t.draggable,a=t.droppable,i=t.draggables,s=t.afterCritical,l=n.page.borderBox.center,c=r.at;return!a||!c?l:c.type==="REORDER"?sZ({impact:r,draggable:n,draggables:i,droppable:a,afterCritical:s}):nZ({impact:r,draggables:i,afterCritical:s})},my=function(e){var t=oZ(e),r=e.droppable,n=r?j_(r,t):t;return n},VI=function(e,t){var r=Qa(t,e.scroll.initial),n=af(r),a=ns({top:t.y,bottom:t.y+e.frame.height,left:t.x,right:t.x+e.frame.width}),i={frame:a,scroll:{initial:e.scroll.initial,max:e.scroll.max,current:t,diff:{value:r,displacement:n}}};return i};function FC(e,t){return e.map(function(r){return t[r]})}function lZ(e,t){for(var r=0;r<t.length;r++){var n=t[r].visible[e];if(n)return n}return null}var cZ=function(e){var t=e.impact,r=e.viewport,n=e.destination,a=e.draggables,i=e.maxScrollChange,s=VI(r,Rn(r.scroll.current,i)),l=n.frame?dN(n,Rn(n.frame.scroll.current,i)):n,c=t.displaced,u=Kh({afterDragging:FC(c.all,a),destination:n,displacedBy:t.displacedBy,viewport:s.frame,last:c,forceShouldAnimate:!1}),d=Kh({afterDragging:FC(c.all,a),destination:l,displacedBy:t.displacedBy,viewport:r.frame,last:c,forceShouldAnimate:!1}),f={},h={},m=[c,u,d];c.all.forEach(function(p){var g=lZ(p,m);if(g){h[p]=g;return}f[p]=!0});var x=Xe({},t,{displaced:{all:c.all,invisible:f,visible:h}});return x},uZ=function(e,t){return Rn(e.scroll.diff.displacement,t)},gN=function(e){var t=e.pageBorderBoxCenter,r=e.draggable,n=e.viewport,a=uZ(n,t),i=Qa(a,r.page.borderBox.center);return Rn(r.client.borderBox.center,i)},qI=function(e){var t=e.draggable,r=e.destination,n=e.newPageBorderBoxCenter,a=e.viewport,i=e.withDroppableDisplacement,s=e.onlyOnMainAxis,l=s===void 0?!1:s,c=Qa(n,t.page.borderBox.center),u=Vp(t.page.borderBox,c),d={target:u,destination:r,withDroppableDisplacement:i,viewport:a};return l?XK(d):zI(d)},dZ=function(e){var t=e.isMovingForward,r=e.draggable,n=e.destination,a=e.draggables,i=e.previousImpact,s=e.viewport,l=e.previousPageBorderBoxCenter,c=e.previousClientSelection,u=e.afterCritical;if(!n.isEnabled)return null;var d=sf(n.descriptor.id,a),f=of(r,n),h=BK({isMovingForward:t,draggable:r,destination:n,insideDestination:d,previousImpact:i})||tZ({isMovingForward:t,isInHomeList:f,draggable:r,draggables:a,destination:n,insideDestination:d,previousImpact:i,viewport:s,afterCritical:u});if(!h)return null;var m=my({impact:h,draggable:r,droppable:n,draggables:a,afterCritical:u}),x=qI({draggable:r,destination:n,newPageBorderBoxCenter:m,viewport:s.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0});if(x){var p=gN({pageBorderBoxCenter:m,draggable:r,viewport:s});return{clientSelection:p,impact:h,scrollJumpRequest:null}}var g=Qa(m,l),v=cZ({impact:h,viewport:s,destination:n,draggables:a,maxScrollChange:g});return{clientSelection:c,impact:v,scrollJumpRequest:g}},fa=function(t){var r=t.subject.active;return r||He(),r},fZ=function(e){var t=e.isMovingForward,r=e.pageBorderBoxCenter,n=e.source,a=e.droppables,i=e.viewport,s=n.subject.active;if(!s)return null;var l=n.axis,c=Ri(s[l.start],s[l.end]),u=dy(a).filter(function(f){return f!==n}).filter(function(f){return f.isEnabled}).filter(function(f){return!!f.subject.active}).filter(function(f){return BI(i.frame)(fa(f))}).filter(function(f){var h=fa(f);return t?s[l.crossAxisEnd]<h[l.crossAxisEnd]:h[l.crossAxisStart]<s[l.crossAxisStart]}).filter(function(f){var h=fa(f),m=Ri(h[l.start],h[l.end]);return c(h[l.start])||c(h[l.end])||m(s[l.start])||m(s[l.end])}).sort(function(f,h){var m=fa(f)[l.crossAxisStart],x=fa(h)[l.crossAxisStart];return t?m-x:x-m}).filter(function(f,h,m){return fa(f)[l.crossAxisStart]===fa(m[0])[l.crossAxisStart]});if(!u.length)return null;if(u.length===1)return u[0];var d=u.filter(function(f){var h=Ri(fa(f)[l.start],fa(f)[l.end]);return h(r[l.line])});return d.length===1?d[0]:d.length>1?d.sort(function(f,h){return fa(f)[l.start]-fa(h)[l.start]})[0]:u.sort(function(f,h){var m=TC(r,kC(fa(f))),x=TC(r,kC(fa(h)));return m!==x?m-x:fa(f)[l.start]-fa(h)[l.start]})[0]},PC=function(t,r){var n=t.page.borderBox.center;return jl(t.descriptor.id,r)?Qa(n,r.displacedBy.point):n},hZ=function(t,r){var n=t.page.borderBox;return jl(t.descriptor.id,r)?Vp(n,af(r.displacedBy.point)):n},mZ=function(e){var t=e.pageBorderBoxCenter,r=e.viewport,n=e.destination,a=e.insideDestination,i=e.afterCritical,s=a.filter(function(l){return zI({target:hZ(l,i),destination:n,viewport:r.frame,withDroppableDisplacement:!0})}).sort(function(l,c){var u=Yh(t,j_(n,PC(l,i))),d=Yh(t,j_(n,PC(c,i)));return u<d?-1:d<u?1:l.descriptor.index-c.descriptor.index});return s[0]||null},qp=_n(function(t,r){var n=r[t.line];return{value:n,point:Mc(t.line,n)}}),pZ=function(t,r,n){var a=t.axis;if(t.descriptor.mode==="virtual")return Mc(a.line,r[a.line]);var i=t.subject.page.contentBox[a.size],s=sf(t.descriptor.id,n),l=s.reduce(function(d,f){return d+f.client.marginBox[a.size]},0),c=l+r[a.line],u=c-i;return u<=0?null:Mc(a.line,u)},GI=function(t,r){return Xe({},t,{scroll:Xe({},t.scroll,{max:r})})},YI=function(t,r,n){var a=t.frame;of(r,t)&&He(),t.subject.withPlaceholder&&He();var i=qp(t.axis,r.displaceBy).point,s=pZ(t,i,n),l={placeholderSize:i,increasedBy:s,oldFrameMaxScroll:t.frame?t.frame.scroll.max:null};if(!a){var c=dd({page:t.subject.page,withPlaceholder:l,axis:t.axis,frame:t.frame});return Xe({},t,{subject:c})}var u=s?Rn(a.scroll.max,s):a.scroll.max,d=GI(a,u),f=dd({page:t.subject.page,withPlaceholder:l,axis:t.axis,frame:d});return Xe({},t,{subject:f,frame:d})},xZ=function(t){var r=t.subject.withPlaceholder;r||He();var n=t.frame;if(!n){var a=dd({page:t.subject.page,axis:t.axis,frame:null,withPlaceholder:null});return Xe({},t,{subject:a})}var i=r.oldFrameMaxScroll;i||He();var s=GI(n,i),l=dd({page:t.subject.page,axis:t.axis,frame:s,withPlaceholder:null});return Xe({},t,{subject:l,frame:s})},gZ=function(e){var t=e.previousPageBorderBoxCenter,r=e.moveRelativeTo,n=e.insideDestination,a=e.draggable,i=e.draggables,s=e.destination,l=e.viewport,c=e.afterCritical;if(!r){if(n.length)return null;var u={displaced:Xh,displacedBy:LI,at:{type:"REORDER",destination:{droppableId:s.descriptor.id,index:0}}},d=my({impact:u,draggable:a,droppable:s,draggables:i,afterCritical:c}),f=of(a,s)?s:YI(s,a,i),h=qI({draggable:a,destination:f,newPageBorderBoxCenter:d,viewport:l.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0});return h?u:null}var m=t[s.axis.line]<=r.page.borderBox.center[s.axis.line],x=function(){var g=r.descriptor.index;return r.descriptor.id===a.descriptor.id||m?g:g+1}(),p=qp(s.axis,a.displaceBy);return J0({draggable:a,insideDestination:n,destination:s,viewport:l,displacedBy:p,last:Xh,index:x})},vZ=function(e){var t=e.isMovingForward,r=e.previousPageBorderBoxCenter,n=e.draggable,a=e.isOver,i=e.draggables,s=e.droppables,l=e.viewport,c=e.afterCritical,u=fZ({isMovingForward:t,pageBorderBoxCenter:r,source:a,droppables:s,viewport:l});if(!u)return null;var d=sf(u.descriptor.id,i),f=mZ({pageBorderBoxCenter:r,viewport:l,destination:u,insideDestination:d,afterCritical:c}),h=gZ({previousPageBorderBoxCenter:r,destination:u,draggable:n,draggables:i,moveRelativeTo:f,insideDestination:d,viewport:l,afterCritical:c});if(!h)return null;var m=my({impact:h,draggable:n,droppable:u,draggables:i,afterCritical:c}),x=gN({pageBorderBoxCenter:m,draggable:n,viewport:l});return{clientSelection:x,impact:h,scrollJumpRequest:null}},ti=function(e){var t=e.at;return t?t.type==="REORDER"?t.destination.droppableId:t.combine.droppableId:null},yZ=function(t,r){var n=ti(t);return n?r[n]:null},bZ=function(e){var t=e.state,r=e.type,n=yZ(t.impact,t.dimensions.droppables),a=!!n,i=t.dimensions.droppables[t.critical.droppable.id],s=n||i,l=s.axis.direction,c=l==="vertical"&&(r==="MOVE_UP"||r==="MOVE_DOWN")||l==="horizontal"&&(r==="MOVE_LEFT"||r==="MOVE_RIGHT");if(c&&!a)return null;var u=r==="MOVE_DOWN"||r==="MOVE_RIGHT",d=t.dimensions.draggables[t.critical.draggable.id],f=t.current.page.borderBoxCenter,h=t.dimensions,m=h.draggables,x=h.droppables;return c?dZ({isMovingForward:u,previousPageBorderBoxCenter:f,draggable:d,destination:s,draggables:m,viewport:t.viewport,previousClientSelection:t.current.client.selection,previousImpact:t.impact,afterCritical:t.afterCritical}):vZ({isMovingForward:u,previousPageBorderBoxCenter:f,draggable:d,isOver:s,draggables:m,droppables:x,viewport:t.viewport,afterCritical:t.afterCritical})};function uc(e){return e.phase==="DRAGGING"||e.phase==="COLLECTING"}function XI(e){var t=Ri(e.top,e.bottom),r=Ri(e.left,e.right);return function(a){return t(a.y)&&r(a.x)}}function wZ(e,t){return e.left<t.right&&e.right>t.left&&e.top<t.bottom&&e.bottom>t.top}function _Z(e){var t=e.pageBorderBox,r=e.draggable,n=e.candidates,a=r.page.borderBox.center,i=n.map(function(s){var l=s.axis,c=Mc(s.axis.line,t.center[l.line],s.page.borderBox.center[l.crossAxisLine]);return{id:s.descriptor.id,distance:Yh(a,c)}}).sort(function(s,l){return l.distance-s.distance});return i[0]?i[0].id:null}function DZ(e){var t=e.pageBorderBox,r=e.draggable,n=e.droppables,a=dy(n).filter(function(i){if(!i.isEnabled)return!1;var s=i.subject.active;if(!s||!wZ(t,s))return!1;if(XI(s)(t.center))return!0;var l=i.axis,c=s.center[l.crossAxisLine],u=t[l.crossAxisStart],d=t[l.crossAxisEnd],f=Ri(s[l.crossAxisStart],s[l.crossAxisEnd]),h=f(u),m=f(d);return!h&&!m?!0:h?u<c:d>c});return a.length?a.length===1?a[0].descriptor.id:_Z({pageBorderBox:t,draggable:r,candidates:a}):null}var KI=function(t,r){return ns(Vp(t,r))},jZ=function(e,t){var r=e.frame;return r?KI(t,r.scroll.diff.value):t};function ZI(e){var t=e.displaced,r=e.id;return!!(t.visible[r]||t.invisible[r])}function NZ(e){var t=e.draggable,r=e.closest,n=e.inHomeList;return r?n&&r.descriptor.index>t.descriptor.index?r.descriptor.index-1:r.descriptor.index:null}var SZ=function(e){var t=e.pageBorderBoxWithDroppableScroll,r=e.draggable,n=e.destination,a=e.insideDestination,i=e.last,s=e.viewport,l=e.afterCritical,c=n.axis,u=qp(n.axis,r.displaceBy),d=u.value,f=t[c.start],h=t[c.end],m=hy(r,a),x=Ml(m,function(g){var v=g.descriptor.id,y=g.page.borderBox.center[c.line],b=jl(v,l),w=ZI({displaced:i,id:v});return b?w?h<=y:f<y-d:w?h<=y+d:f<y}),p=NZ({draggable:r,closest:x,inHomeList:of(r,n)});return J0({draggable:r,insideDestination:a,destination:n,viewport:s,last:i,displacedBy:u,index:p})},EZ=4,TZ=function(e){var t=e.draggable,r=e.pageBorderBoxWithDroppableScroll,n=e.previousImpact,a=e.destination,i=e.insideDestination,s=e.afterCritical;if(!a.isCombineEnabled)return null;var l=a.axis,c=qp(a.axis,t.displaceBy),u=c.value,d=r[l.start],f=r[l.end],h=hy(t,i),m=Ml(h,function(p){var g=p.descriptor.id,v=p.page.borderBox,y=v[l.size],b=y/EZ,w=jl(g,s),_=ZI({displaced:n.displaced,id:g});return w?_?f>v[l.start]+b&&f<v[l.end]-b:d>v[l.start]-u+b&&d<v[l.end]-u-b:_?f>v[l.start]+u+b&&f<v[l.end]+u-b:d>v[l.start]+b&&d<v[l.end]-b});if(!m)return null;var x={displacedBy:c,displaced:n.displaced,at:{type:"COMBINE",combine:{draggableId:m.descriptor.id,droppableId:a.descriptor.id}}};return x},JI=function(e){var t=e.pageOffset,r=e.draggable,n=e.draggables,a=e.droppables,i=e.previousImpact,s=e.viewport,l=e.afterCritical,c=KI(r.page.borderBox,t),u=DZ({pageBorderBox:c,draggable:r,droppables:a});if(!u)return WK;var d=a[u],f=sf(d.descriptor.id,n),h=jZ(d,c);return TZ({pageBorderBoxWithDroppableScroll:h,draggable:r,previousImpact:i,destination:d,insideDestination:f,afterCritical:l})||SZ({pageBorderBoxWithDroppableScroll:h,draggable:r,destination:d,insideDestination:f,last:i.displaced,viewport:s,afterCritical:l})},vN=function(e,t){var r;return Xe({},e,(r={},r[t.descriptor.id]=t,r))},kZ=function(t){var r=t.previousImpact,n=t.impact,a=t.droppables,i=ti(r),s=ti(n);if(!i||i===s)return a;var l=a[i];if(!l.subject.withPlaceholder)return a;var c=xZ(l);return vN(a,c)},CZ=function(e){var t=e.draggable,r=e.draggables,n=e.droppables,a=e.previousImpact,i=e.impact,s=kZ({previousImpact:a,impact:i,droppables:n}),l=ti(i);if(!l)return s;var c=n[l];if(of(t,c)||c.subject.withPlaceholder)return s;var u=YI(c,t,r);return vN(s,u)},Sh=function(e){var t=e.state,r=e.clientSelection,n=e.dimensions,a=e.viewport,i=e.impact,s=e.scrollJumpRequest,l=a||t.viewport,c=n||t.dimensions,u=r||t.current.client.selection,d=Qa(u,t.initial.client.selection),f={offset:d,selection:u,borderBoxCenter:Rn(t.initial.client.borderBoxCenter,d)},h={selection:Rn(f.selection,l.scroll.current),borderBoxCenter:Rn(f.borderBoxCenter,l.scroll.current),offset:Rn(f.offset,l.scroll.diff.value)},m={client:f,page:h};if(t.phase==="COLLECTING")return Xe({phase:"COLLECTING"},t,{dimensions:c,viewport:l,current:m});var x=c.draggables[t.critical.draggable.id],p=i||JI({pageOffset:h.offset,draggable:x,draggables:c.draggables,droppables:c.droppables,previousImpact:t.impact,viewport:l,afterCritical:t.afterCritical}),g=CZ({draggable:x,impact:p,previousImpact:t.impact,draggables:c.draggables,droppables:c.droppables}),v=Xe({},t,{current:m,dimensions:{draggables:c.draggables,droppables:g},impact:p,viewport:l,scrollJumpRequest:s||null,forceShouldAnimate:s?!1:null});return v};function AZ(e,t){return e.map(function(r){return t[r]})}var QI=function(e){var t=e.impact,r=e.viewport,n=e.draggables,a=e.destination,i=e.forceShouldAnimate,s=t.displaced,l=AZ(s.all,n),c=Kh({afterDragging:l,destination:a,displacedBy:t.displacedBy,viewport:r.frame,forceShouldAnimate:i,last:s});return Xe({},t,{displaced:c})},eR=function(e){var t=e.impact,r=e.draggable,n=e.droppable,a=e.draggables,i=e.viewport,s=e.afterCritical,l=my({impact:t,draggable:r,draggables:a,droppable:n,afterCritical:s});return gN({pageBorderBoxCenter:l,draggable:r,viewport:i})},tR=function(e){var t=e.state,r=e.dimensions,n=e.viewport;t.movementMode!=="SNAP"&&He();var a=t.impact,i=n||t.viewport,s=r||t.dimensions,l=s.draggables,c=s.droppables,u=l[t.critical.draggable.id],d=ti(a);d||He();var f=c[d],h=QI({impact:a,viewport:i,destination:f,draggables:l}),m=eR({impact:h,draggable:u,droppable:f,draggables:l,viewport:i,afterCritical:t.afterCritical});return Sh({impact:h,clientSelection:m,state:t,dimensions:s,viewport:i})},OZ=function(e){return{index:e.index,droppableId:e.droppableId}},rR=function(e){var t=e.draggable,r=e.home,n=e.draggables,a=e.viewport,i=qp(r.axis,t.displaceBy),s=sf(r.descriptor.id,n),l=s.indexOf(t);l===-1&&He();var c=s.slice(l+1),u=c.reduce(function(m,x){return m[x.descriptor.id]=!0,m},{}),d={inVirtualList:r.descriptor.mode==="virtual",displacedBy:i,effected:u},f=Kh({afterDragging:c,destination:r,displacedBy:i,last:null,viewport:a.frame,forceShouldAnimate:!1}),h={displaced:f,displacedBy:i,at:{type:"REORDER",destination:OZ(t.descriptor)}};return{impact:h,afterCritical:d}},FZ=function(e,t){return{draggables:e.draggables,droppables:vN(e.droppables,t)}},PZ=function(e){var t=e.draggable,r=e.offset,n=e.initialWindowScroll,a=G0(t.client,r),i=Y0(a,n),s=Xe({},t,{placeholder:Xe({},t.placeholder,{client:a}),client:a,page:i});return s},IZ=function(e){var t=e.frame;return t||He(),t},RZ=function(e){var t=e.additions,r=e.updatedDroppables,n=e.viewport,a=n.scroll.diff.value;return t.map(function(i){var s=i.descriptor.droppableId,l=r[s],c=IZ(l),u=c.scroll.diff.value,d=Rn(a,u),f=PZ({draggable:i,offset:d,initialWindowScroll:n.scroll.initial});return f})},MZ=function(e){var t=e.state,r=e.published,n=r.modified.map(function(b){var w=t.dimensions.droppables[b.droppableId],_=dN(w,b.scroll);return _}),a=Xe({},t.dimensions.droppables,{},UI(n)),i=$I(RZ({additions:r.additions,updatedDroppables:a,viewport:t.viewport})),s=Xe({},t.dimensions.draggables,{},i);r.removals.forEach(function(b){delete s[b]});var l={droppables:a,draggables:s},c=ti(t.impact),u=c?l.droppables[c]:null,d=l.draggables[t.critical.draggable.id],f=l.droppables[t.critical.droppable.id],h=rR({draggable:d,home:f,draggables:s,viewport:t.viewport}),m=h.impact,x=h.afterCritical,p=u&&u.isCombineEnabled?t.impact:m,g=JI({pageOffset:t.current.page.offset,draggable:l.draggables[t.critical.draggable.id],draggables:l.draggables,droppables:l.droppables,previousImpact:p,viewport:t.viewport,afterCritical:x}),v=Xe({phase:"DRAGGING"},t,{phase:"DRAGGING",impact:g,onLiftImpact:m,dimensions:l,afterCritical:x,forceShouldAnimate:!1});if(t.phase==="COLLECTING")return v;var y=Xe({phase:"DROP_PENDING"},v,{phase:"DROP_PENDING",reason:t.reason,isWaiting:!1});return y},N_=function(t){return t.movementMode==="SNAP"},V1=function(t,r,n){var a=FZ(t.dimensions,r);return!N_(t)||n?Sh({state:t,dimensions:a}):tR({state:t,dimensions:a})};function q1(e){return e.isDragging&&e.movementMode==="SNAP"?Xe({phase:"DRAGGING"},e,{scrollJumpRequest:null}):e}var IC={phase:"IDLE",completed:null,shouldFlush:!1},UZ=function(e,t){if(e===void 0&&(e=IC),t.type==="FLUSH")return Xe({},IC,{shouldFlush:!0});if(t.type==="INITIAL_PUBLISH"){e.phase!=="IDLE"&&He();var r=t.payload,n=r.critical,a=r.clientSelection,i=r.viewport,s=r.dimensions,l=r.movementMode,c=s.draggables[n.draggable.id],u=s.droppables[n.droppable.id],d={selection:a,borderBoxCenter:c.client.borderBox.center,offset:Dn},f={client:d,page:{selection:Rn(d.selection,i.scroll.initial),borderBoxCenter:Rn(d.selection,i.scroll.initial),offset:Rn(d.selection,i.scroll.diff.value)}},h=dy(s.droppables).every(function(pe){return!pe.isFixedOnPage}),m=rR({draggable:c,home:u,draggables:s.draggables,viewport:i}),x=m.impact,p=m.afterCritical,g={phase:"DRAGGING",isDragging:!0,critical:n,movementMode:l,dimensions:s,initial:f,current:f,isWindowScrollAllowed:h,impact:x,afterCritical:p,onLiftImpact:x,viewport:i,scrollJumpRequest:null,forceShouldAnimate:null};return g}if(t.type==="COLLECTION_STARTING"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&He();var v=Xe({phase:"COLLECTING"},e,{phase:"COLLECTING"});return v}if(t.type==="PUBLISH_WHILE_DRAGGING")return e.phase==="COLLECTING"||e.phase==="DROP_PENDING"||He(),MZ({state:e,published:t.payload});if(t.type==="MOVE"){if(e.phase==="DROP_PENDING")return e;uc(e)||He();var y=t.payload.client;return xl(y,e.current.client.selection)?e:Sh({state:e,clientSelection:y,impact:N_(e)?e.impact:null})}if(t.type==="UPDATE_DROPPABLE_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="COLLECTING")return q1(e);uc(e)||He();var b=t.payload,w=b.id,_=b.newScroll,D=e.dimensions.droppables[w];if(!D)return e;var j=dN(D,_);return V1(e,j,!1)}if(t.type==="UPDATE_DROPPABLE_IS_ENABLED"){if(e.phase==="DROP_PENDING")return e;uc(e)||He();var N=t.payload,S=N.id,E=N.isEnabled,A=e.dimensions.droppables[S];A||He(),A.isEnabled===E&&He();var T=Xe({},A,{isEnabled:E});return V1(e,T,!0)}if(t.type==="UPDATE_DROPPABLE_IS_COMBINE_ENABLED"){if(e.phase==="DROP_PENDING")return e;uc(e)||He();var L=t.payload,O=L.id,V=L.isCombineEnabled,W=e.dimensions.droppables[O];W||He(),W.isCombineEnabled===V&&He();var B=Xe({},W,{isCombineEnabled:V});return V1(e,B,!0)}if(t.type==="MOVE_BY_WINDOW_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="DROP_ANIMATING")return e;uc(e)||He(),e.isWindowScrollAllowed||He();var P=t.payload.newScroll;if(xl(e.viewport.scroll.current,P))return q1(e);var F=VI(e.viewport,P);return N_(e)?tR({state:e,viewport:F}):Sh({state:e,viewport:F})}if(t.type==="UPDATE_VIEWPORT_MAX_SCROLL"){if(!uc(e))return e;var I=t.payload.maxScroll;if(xl(I,e.viewport.scroll.max))return e;var R=Xe({},e.viewport,{scroll:Xe({},e.viewport.scroll,{max:I})});return Xe({phase:"DRAGGING"},e,{viewport:R})}if(t.type==="MOVE_UP"||t.type==="MOVE_DOWN"||t.type==="MOVE_LEFT"||t.type==="MOVE_RIGHT"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&He();var C=bZ({state:e,type:t.type});return C?Sh({state:e,impact:C.impact,clientSelection:C.clientSelection,scrollJumpRequest:C.scrollJumpRequest}):e}if(t.type==="DROP_PENDING"){var k=t.payload.reason;e.phase!=="COLLECTING"&&He();var z=Xe({phase:"DROP_PENDING"},e,{phase:"DROP_PENDING",isWaiting:!0,reason:k});return z}if(t.type==="DROP_ANIMATE"){var q=t.payload,K=q.completed,se=q.dropDuration,ie=q.newHomeClientOffset;e.phase==="DRAGGING"||e.phase==="DROP_PENDING"||He();var ee={phase:"DROP_ANIMATING",completed:K,dropDuration:se,newHomeClientOffset:ie,dimensions:e.dimensions};return ee}if(t.type==="DROP_COMPLETE"){var ae=t.payload.completed;return{phase:"IDLE",completed:ae,shouldFlush:!1}}return e},$Z=function(t){return{type:"BEFORE_INITIAL_CAPTURE",payload:t}},LZ=function(t){return{type:"LIFT",payload:t}},BZ=function(t){return{type:"INITIAL_PUBLISH",payload:t}},WZ=function(t){return{type:"PUBLISH_WHILE_DRAGGING",payload:t}},zZ=function(){return{type:"COLLECTION_STARTING",payload:null}},HZ=function(t){return{type:"UPDATE_DROPPABLE_SCROLL",payload:t}},VZ=function(t){return{type:"UPDATE_DROPPABLE_IS_ENABLED",payload:t}},qZ=function(t){return{type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:t}},nR=function(t){return{type:"MOVE",payload:t}},GZ=function(t){return{type:"MOVE_BY_WINDOW_SCROLL",payload:t}},YZ=function(t){return{type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:t}},XZ=function(){return{type:"MOVE_UP",payload:null}},KZ=function(){return{type:"MOVE_DOWN",payload:null}},ZZ=function(){return{type:"MOVE_RIGHT",payload:null}},JZ=function(){return{type:"MOVE_LEFT",payload:null}},yN=function(){return{type:"FLUSH",payload:null}},QZ=function(t){return{type:"DROP_ANIMATE",payload:t}},bN=function(t){return{type:"DROP_COMPLETE",payload:t}},aR=function(t){return{type:"DROP",payload:t}},eJ=function(t){return{type:"DROP_PENDING",payload:t}},iR=function(){return{type:"DROP_ANIMATION_FINISHED",payload:null}},tJ=function(e){return function(t){var r=t.getState,n=t.dispatch;return function(a){return function(i){if(i.type!=="LIFT"){a(i);return}var s=i.payload,l=s.id,c=s.clientSelection,u=s.movementMode,d=r();d.phase==="DROP_ANIMATING"&&n(bN({completed:d.completed})),r().phase!=="IDLE"&&He(),n(yN()),n($Z({draggableId:l,movementMode:u}));var f={shouldPublishImmediately:u==="SNAP"},h={draggableId:l,scrollOptions:f},m=e.startPublishing(h),x=m.critical,p=m.dimensions,g=m.viewport;n(BZ({critical:x,dimensions:p,clientSelection:c,movementMode:u,viewport:g}))}}}},rJ=function(e){return function(){return function(t){return function(r){r.type==="INITIAL_PUBLISH"&&e.dragging(),r.type==="DROP_ANIMATE"&&e.dropping(r.payload.completed.result.reason),(r.type==="FLUSH"||r.type==="DROP_COMPLETE")&&e.resting(),t(r)}}}},wN={outOfTheWay:"cubic-bezier(0.2, 0, 0, 1)",drop:"cubic-bezier(.2,1,.1,1)"},Zh={opacity:{drop:0,combining:.7},scale:{drop:.75}},_N={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},nc=_N.outOfTheWay+"s "+wN.outOfTheWay,Eh={fluid:"opacity "+nc,snap:"transform "+nc+", opacity "+nc,drop:function(t){var r=t+"s "+wN.drop;return"transform "+r+", opacity "+r},outOfTheWay:"transform "+nc,placeholder:"height "+nc+", width "+nc+", margin "+nc},RC=function(t){return xl(t,Dn)?null:"translate("+t.x+"px, "+t.y+"px)"},S_={moveTo:RC,drop:function(t,r){var n=RC(t);return n?r?n+" scale("+Zh.scale.drop+")":n:null}},E_=_N.minDropTime,sR=_N.maxDropTime,nJ=sR-E_,MC=1500,aJ=.6,iJ=function(e){var t=e.current,r=e.destination,n=e.reason,a=Yh(t,r);if(a<=0)return E_;if(a>=MC)return sR;var i=a/MC,s=E_+nJ*i,l=n==="CANCEL"?s*aJ:s;return Number(l.toFixed(2))},sJ=function(e){var t=e.impact,r=e.draggable,n=e.dimensions,a=e.viewport,i=e.afterCritical,s=n.draggables,l=n.droppables,c=ti(t),u=c?l[c]:null,d=l[r.descriptor.droppableId],f=eR({impact:t,draggable:r,draggables:s,afterCritical:i,droppable:u||d,viewport:a}),h=Qa(f,r.client.borderBox.center);return h},oJ=function(e){var t=e.draggables,r=e.reason,n=e.lastImpact,a=e.home,i=e.viewport,s=e.onLiftImpact;if(!n.at||r!=="DROP"){var l=QI({draggables:t,impact:s,destination:a,viewport:i,forceShouldAnimate:!0});return{impact:l,didDropInsideDroppable:!1}}if(n.at.type==="REORDER")return{impact:n,didDropInsideDroppable:!0};var c=Xe({},n,{displaced:Xh});return{impact:c,didDropInsideDroppable:!0}},lJ=function(e){var t=e.getState,r=e.dispatch;return function(n){return function(a){if(a.type!=="DROP"){n(a);return}var i=t(),s=a.payload.reason;if(i.phase==="COLLECTING"){r(eJ({reason:s}));return}if(i.phase!=="IDLE"){var l=i.phase==="DROP_PENDING"&&i.isWaiting;l&&He(),i.phase==="DRAGGING"||i.phase==="DROP_PENDING"||He();var c=i.critical,u=i.dimensions,d=u.draggables[i.critical.draggable.id],f=oJ({reason:s,lastImpact:i.impact,afterCritical:i.afterCritical,onLiftImpact:i.onLiftImpact,home:i.dimensions.droppables[i.critical.droppable.id],viewport:i.viewport,draggables:i.dimensions.draggables}),h=f.impact,m=f.didDropInsideDroppable,x=m?hN(h):null,p=m?fy(h):null,g={index:c.draggable.index,droppableId:c.droppable.id},v={draggableId:d.descriptor.id,type:d.descriptor.type,source:g,reason:s,mode:i.movementMode,destination:x,combine:p},y=sJ({impact:h,draggable:d,dimensions:u,viewport:i.viewport,afterCritical:i.afterCritical}),b={critical:i.critical,afterCritical:i.afterCritical,result:v,impact:h},w=!xl(i.current.client.offset,y)||!!v.combine;if(!w){r(bN({completed:b}));return}var _=iJ({current:i.current.client.offset,destination:y,reason:s}),D={newHomeClientOffset:y,dropDuration:_,completed:b};r(QZ(D))}}}},oR=function(){return{x:window.pageXOffset,y:window.pageYOffset}};function cJ(e){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(r){r.target!==window&&r.target!==window.document||e()}}}function uJ(e){var t=e.onWindowScroll;function r(){t(oR())}var n=Gh(r),a=cJ(n),i=pl;function s(){return i!==pl}function l(){s()&&He(),i=Fi(window,[a])}function c(){s()||He(),n.cancel(),i(),i=pl}return{start:l,stop:c,isActive:s}}var dJ=function(t){return t.type==="DROP_COMPLETE"||t.type==="DROP_ANIMATE"||t.type==="FLUSH"},fJ=function(e){var t=uJ({onWindowScroll:function(n){e.dispatch(GZ({newScroll:n}))}});return function(r){return function(n){!t.isActive()&&n.type==="INITIAL_PUBLISH"&&t.start(),t.isActive()&&dJ(n)&&t.stop(),r(n)}}},hJ=function(e){var t=!1,r=!1,n=setTimeout(function(){r=!0}),a=function(s){t||r||(t=!0,e(s),clearTimeout(n))};return a.wasCalled=function(){return t},a},mJ=function(){var e=[],t=function(i){var s=fN(e,function(u){return u.timerId===i});s===-1&&He();var l=e.splice(s,1),c=l[0];c.callback()},r=function(i){var s=setTimeout(function(){return t(s)}),l={timerId:s,callback:i};e.push(l)},n=function(){if(e.length){var i=[].concat(e);e.length=0,i.forEach(function(s){clearTimeout(s.timerId),s.callback()})}};return{add:r,flush:n}},pJ=function(t,r){return t==null&&r==null?!0:t==null||r==null?!1:t.droppableId===r.droppableId&&t.index===r.index},xJ=function(t,r){return t==null&&r==null?!0:t==null||r==null?!1:t.draggableId===r.draggableId&&t.droppableId===r.droppableId},gJ=function(t,r){if(t===r)return!0;var n=t.draggable.id===r.draggable.id&&t.draggable.droppableId===r.draggable.droppableId&&t.draggable.type===r.draggable.type&&t.draggable.index===r.draggable.index,a=t.droppable.id===r.droppable.id&&t.droppable.type===r.droppable.type;return n&&a},Gf=function(t,r){r()},Fx=function(t,r){return{draggableId:t.draggable.id,type:t.droppable.type,source:{droppableId:t.droppable.id,index:t.draggable.index},mode:r}},G1=function(t,r,n,a){if(!t){n(a(r));return}var i=hJ(n),s={announce:i};t(r,s),i.wasCalled()||n(a(r))},vJ=function(e,t){var r=mJ(),n=null,a=function(h,m){n&&He(),Gf("onBeforeCapture",function(){var x=e().onBeforeCapture;if(x){var p={draggableId:h,mode:m};x(p)}})},i=function(h,m){n&&He(),Gf("onBeforeDragStart",function(){var x=e().onBeforeDragStart;x&&x(Fx(h,m))})},s=function(h,m){n&&He();var x=Fx(h,m);n={mode:m,lastCritical:h,lastLocation:x.source,lastCombine:null},r.add(function(){Gf("onDragStart",function(){return G1(e().onDragStart,x,t,C0.onDragStart)})})},l=function(h,m){var x=hN(m),p=fy(m);n||He();var g=!gJ(h,n.lastCritical);g&&(n.lastCritical=h);var v=!pJ(n.lastLocation,x);v&&(n.lastLocation=x);var y=!xJ(n.lastCombine,p);if(y&&(n.lastCombine=p),!(!g&&!v&&!y)){var b=Xe({},Fx(h,n.mode),{combine:p,destination:x});r.add(function(){Gf("onDragUpdate",function(){return G1(e().onDragUpdate,b,t,C0.onDragUpdate)})})}},c=function(){n||He(),r.flush()},u=function(h){n||He(),n=null,Gf("onDragEnd",function(){return G1(e().onDragEnd,h,t,C0.onDragEnd)})},d=function(){if(n){var h=Xe({},Fx(n.lastCritical,n.mode),{combine:null,destination:null,reason:"CANCEL"});u(h)}};return{beforeCapture:a,beforeStart:i,start:s,update:l,flush:c,drop:u,abort:d}},yJ=function(e,t){var r=vJ(e,t);return function(n){return function(a){return function(i){if(i.type==="BEFORE_INITIAL_CAPTURE"){r.beforeCapture(i.payload.draggableId,i.payload.movementMode);return}if(i.type==="INITIAL_PUBLISH"){var s=i.payload.critical;r.beforeStart(s,i.payload.movementMode),a(i),r.start(s,i.payload.movementMode);return}if(i.type==="DROP_COMPLETE"){var l=i.payload.completed.result;r.flush(),a(i),r.drop(l);return}if(a(i),i.type==="FLUSH"){r.abort();return}var c=n.getState();c.phase==="DRAGGING"&&r.update(c.critical,c.impact)}}}},bJ=function(e){return function(t){return function(r){if(r.type!=="DROP_ANIMATION_FINISHED"){t(r);return}var n=e.getState();n.phase!=="DROP_ANIMATING"&&He(),e.dispatch(bN({completed:n.completed}))}}},wJ=function(e){var t=null,r=null;function n(){r&&(cancelAnimationFrame(r),r=null),t&&(t(),t=null)}return function(a){return function(i){if((i.type==="FLUSH"||i.type==="DROP_COMPLETE"||i.type==="DROP_ANIMATION_FINISHED")&&n(),a(i),i.type==="DROP_ANIMATE"){var s={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){var c=e.getState();c.phase==="DROP_ANIMATING"&&e.dispatch(iR())}};r=requestAnimationFrame(function(){r=null,t=Fi(window,[s])})}}}},_J=function(e){return function(){return function(t){return function(r){(r.type==="DROP_COMPLETE"||r.type==="FLUSH"||r.type==="DROP_ANIMATE")&&e.stopPublishing(),t(r)}}}},DJ=function(e){var t=!1;return function(){return function(r){return function(n){if(n.type==="INITIAL_PUBLISH"){t=!0,e.tryRecordFocus(n.payload.critical.draggable.id),r(n),e.tryRestoreFocusRecorded();return}if(r(n),!!t){if(n.type==="FLUSH"){t=!1,e.tryRestoreFocusRecorded();return}if(n.type==="DROP_COMPLETE"){t=!1;var a=n.payload.completed.result;a.combine&&e.tryShiftRecord(a.draggableId,a.combine.draggableId),e.tryRestoreFocusRecorded()}}}}}},jJ=function(t){return t.type==="DROP_COMPLETE"||t.type==="DROP_ANIMATE"||t.type==="FLUSH"},NJ=function(e){return function(t){return function(r){return function(n){if(jJ(n)){e.stop(),r(n);return}if(n.type==="INITIAL_PUBLISH"){r(n);var a=t.getState();a.phase!=="DRAGGING"&&He(),e.start(a);return}r(n),e.scroll(t.getState())}}}},SJ=function(e){return function(t){return function(r){if(t(r),r.type==="PUBLISH_WHILE_DRAGGING"){var n=e.getState();n.phase==="DROP_PENDING"&&(n.isWaiting||e.dispatch(aR({reason:n.reason})))}}}},EJ=uI,TJ=function(e){var t=e.dimensionMarshal,r=e.focusMarshal,n=e.styleMarshal,a=e.getResponders,i=e.announce,s=e.autoScroller;return cI(UZ,EJ(uX(rJ(n),_J(t),tJ(t),lJ,bJ,wJ,SJ,NJ(s),fJ,DJ(r),yJ(a,i))))},Y1=function(){return{additions:{},removals:{},modified:{}}};function kJ(e){var t=e.registry,r=e.callbacks,n=Y1(),a=null,i=function(){a||(r.collectionStarting(),a=requestAnimationFrame(function(){a=null;var d=n,f=d.additions,h=d.removals,m=d.modified,x=Object.keys(f).map(function(v){return t.draggable.getById(v).getDimension(Dn)}).sort(function(v,y){return v.descriptor.index-y.descriptor.index}),p=Object.keys(m).map(function(v){var y=t.droppable.getById(v),b=y.callbacks.getScrollWhileDragging();return{droppableId:v,scroll:b}}),g={additions:x,removals:Object.keys(h),modified:p};n=Y1(),r.publish(g)}))},s=function(d){var f=d.descriptor.id;n.additions[f]=d,n.modified[d.descriptor.droppableId]=!0,n.removals[f]&&delete n.removals[f],i()},l=function(d){var f=d.descriptor;n.removals[f.id]=!0,n.modified[f.droppableId]=!0,n.additions[f.id]&&delete n.additions[f.id],i()},c=function(){a&&(cancelAnimationFrame(a),a=null,n=Y1())};return{add:s,remove:l,stop:c}}var lR=function(e){var t=e.scrollHeight,r=e.scrollWidth,n=e.height,a=e.width,i=Qa({x:r,y:t},{x:a,y:n}),s={x:Math.max(0,i.x),y:Math.max(0,i.y)};return s},cR=function(){var e=document.documentElement;return e||He(),e},uR=function(){var e=cR(),t=lR({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,width:e.clientWidth,height:e.clientHeight});return t},CJ=function(){var e=oR(),t=uR(),r=e.y,n=e.x,a=cR(),i=a.clientWidth,s=a.clientHeight,l=n+i,c=r+s,u=ns({top:r,left:n,right:l,bottom:c}),d={frame:u,scroll:{initial:e,current:e,max:t,diff:{value:Dn,displacement:Dn}}};return d},AJ=function(e){var t=e.critical,r=e.scrollOptions,n=e.registry,a=CJ(),i=a.scroll.current,s=t.droppable,l=n.droppable.getAllByType(s.type).map(function(f){return f.callbacks.getDimensionAndWatchScroll(i,r)}),c=n.draggable.getAllByType(t.draggable.type).map(function(f){return f.getDimension(i)}),u={draggables:$I(c),droppables:UI(l)},d={dimensions:u,critical:t,viewport:a};return d};function UC(e,t,r){if(r.descriptor.id===t.id||r.descriptor.type!==t.type)return!1;var n=e.droppable.getById(r.descriptor.droppableId);return n.descriptor.mode==="virtual"}var OJ=function(e,t){var r=null,n=kJ({callbacks:{publish:t.publishWhileDragging,collectionStarting:t.collectionStarting},registry:e}),a=function(m,x){e.droppable.exists(m)||He(),r&&t.updateDroppableIsEnabled({id:m,isEnabled:x})},i=function(m,x){r&&(e.droppable.exists(m)||He(),t.updateDroppableIsCombineEnabled({id:m,isCombineEnabled:x}))},s=function(m,x){r&&(e.droppable.exists(m)||He(),t.updateDroppableScroll({id:m,newScroll:x}))},l=function(m,x){r&&e.droppable.getById(m).callbacks.scroll(x)},c=function(){if(r){n.stop();var m=r.critical.droppable;e.droppable.getAllByType(m.type).forEach(function(x){return x.callbacks.dragStopped()}),r.unsubscribe(),r=null}},u=function(m){r||He();var x=r.critical.draggable;m.type==="ADDITION"&&UC(e,x,m.value)&&n.add(m.value),m.type==="REMOVAL"&&UC(e,x,m.value)&&n.remove(m.value)},d=function(m){r&&He();var x=e.draggable.getById(m.draggableId),p=e.droppable.getById(x.descriptor.droppableId),g={draggable:x.descriptor,droppable:p.descriptor},v=e.subscribe(u);return r={critical:g,unsubscribe:v},AJ({critical:g,registry:e,scrollOptions:m.scrollOptions})},f={updateDroppableIsEnabled:a,updateDroppableIsCombineEnabled:i,scrollDroppable:l,updateDroppableScroll:s,startPublishing:d,stopPublishing:c};return f},dR=function(e,t){return e.phase==="IDLE"?!0:e.phase!=="DROP_ANIMATING"||e.completed.result.draggableId===t?!1:e.completed.result.reason==="DROP"},FJ=function(e){window.scrollBy(e.x,e.y)},PJ=_n(function(e){return dy(e).filter(function(t){return!(!t.isEnabled||!t.frame)})}),IJ=function(t,r){var n=Ml(PJ(r),function(a){return a.frame||He(),XI(a.frame.pageMarginBox)(t)});return n},RJ=function(e){var t=e.center,r=e.destination,n=e.droppables;if(r){var a=n[r];return a.frame?a:null}var i=IJ(t,n);return i},gl={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:function(t){return Math.pow(t,2)},durationDampening:{stopDampeningAt:1200,accelerateAt:360}},MJ=function(e,t){var r=e[t.size]*gl.startFromPercentage,n=e[t.size]*gl.maxScrollAtPercentage,a={startScrollingFrom:r,maxScrollValueAt:n};return a},fR=function(e){var t=e.startOfRange,r=e.endOfRange,n=e.current,a=r-t;if(a===0)return 0;var i=n-t,s=i/a;return s},DN=1,UJ=function(e,t){if(e>t.startScrollingFrom)return 0;if(e<=t.maxScrollValueAt)return gl.maxPixelScroll;if(e===t.startScrollingFrom)return DN;var r=fR({startOfRange:t.maxScrollValueAt,endOfRange:t.startScrollingFrom,current:e}),n=1-r,a=gl.maxPixelScroll*gl.ease(n);return Math.ceil(a)},$C=gl.durationDampening.accelerateAt,LC=gl.durationDampening.stopDampeningAt,$J=function(e,t){var r=t,n=LC,a=Date.now(),i=a-r;if(i>=LC)return e;if(i<$C)return DN;var s=fR({startOfRange:$C,endOfRange:n,current:i}),l=e*gl.ease(s);return Math.ceil(l)},BC=function(e){var t=e.distanceToEdge,r=e.thresholds,n=e.dragStartTime,a=e.shouldUseTimeDampening,i=UJ(t,r);return i===0?0:a?Math.max($J(i,n),DN):i},WC=function(e){var t=e.container,r=e.distanceToEdges,n=e.dragStartTime,a=e.axis,i=e.shouldUseTimeDampening,s=MJ(t,a),l=r[a.end]<r[a.start];return l?BC({distanceToEdge:r[a.end],thresholds:s,dragStartTime:n,shouldUseTimeDampening:i}):-1*BC({distanceToEdge:r[a.start],thresholds:s,dragStartTime:n,shouldUseTimeDampening:i})},LJ=function(e){var t=e.container,r=e.subject,n=e.proposedScroll,a=r.height>t.height,i=r.width>t.width;return!i&&!a?n:i&&a?null:{x:i?0:n.x,y:a?0:n.y}},BJ=RI(function(e){return e===0?0:e}),hR=function(e){var t=e.dragStartTime,r=e.container,n=e.subject,a=e.center,i=e.shouldUseTimeDampening,s={top:a.y-r.top,right:r.right-a.x,bottom:r.bottom-a.y,left:a.x-r.left},l=WC({container:r,distanceToEdges:s,dragStartTime:t,axis:mN,shouldUseTimeDampening:i}),c=WC({container:r,distanceToEdges:s,dragStartTime:t,axis:WI,shouldUseTimeDampening:i}),u=BJ({x:c,y:l});if(xl(u,Dn))return null;var d=LJ({container:r,subject:n,proposedScroll:u});return d?xl(d,Dn)?null:d:null},WJ=RI(function(e){return e===0?0:e>0?1:-1}),jN=function(){var e=function(r,n){return r<0?r:r>n?r-n:0};return function(t){var r=t.current,n=t.max,a=t.change,i=Rn(r,a),s={x:e(i.x,n.x),y:e(i.y,n.y)};return xl(s,Dn)?null:s}}(),mR=function(t){var r=t.max,n=t.current,a=t.change,i={x:Math.max(n.x,r.x),y:Math.max(n.y,r.y)},s=WJ(a),l=jN({max:i,current:n,change:s});return!l||s.x!==0&&l.x===0||s.y!==0&&l.y===0},NN=function(t,r){return mR({current:t.scroll.current,max:t.scroll.max,change:r})},zJ=function(t,r){if(!NN(t,r))return null;var n=t.scroll.max,a=t.scroll.current;return jN({current:a,max:n,change:r})},SN=function(t,r){var n=t.frame;return n?mR({current:n.scroll.current,max:n.scroll.max,change:r}):!1},HJ=function(t,r){var n=t.frame;return!n||!SN(t,r)?null:jN({current:n.scroll.current,max:n.scroll.max,change:r})},VJ=function(e){var t=e.viewport,r=e.subject,n=e.center,a=e.dragStartTime,i=e.shouldUseTimeDampening,s=hR({dragStartTime:a,container:t.frame,subject:r,center:n,shouldUseTimeDampening:i});return s&&NN(t,s)?s:null},qJ=function(e){var t=e.droppable,r=e.subject,n=e.center,a=e.dragStartTime,i=e.shouldUseTimeDampening,s=t.frame;if(!s)return null;var l=hR({dragStartTime:a,container:s.pageMarginBox,subject:r,center:n,shouldUseTimeDampening:i});return l&&SN(t,l)?l:null},zC=function(e){var t=e.state,r=e.dragStartTime,n=e.shouldUseTimeDampening,a=e.scrollWindow,i=e.scrollDroppable,s=t.current.page.borderBoxCenter,l=t.dimensions.draggables[t.critical.draggable.id],c=l.page.marginBox;if(t.isWindowScrollAllowed){var u=t.viewport,d=VJ({dragStartTime:r,viewport:u,subject:c,center:s,shouldUseTimeDampening:n});if(d){a(d);return}}var f=RJ({center:s,destination:ti(t.impact),droppables:t.dimensions.droppables});if(f){var h=qJ({dragStartTime:r,droppable:f,subject:c,center:s,shouldUseTimeDampening:n});h&&i(f.descriptor.id,h)}},GJ=function(e){var t=e.scrollWindow,r=e.scrollDroppable,n=Gh(t),a=Gh(r),i=null,s=function(d){i||He();var f=i,h=f.shouldUseTimeDampening,m=f.dragStartTime;zC({state:d,scrollWindow:n,scrollDroppable:a,dragStartTime:m,shouldUseTimeDampening:h})},l=function(d){i&&He();var f=Date.now(),h=!1,m=function(){h=!0};zC({state:d,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:m,scrollDroppable:m}),i={dragStartTime:f,shouldUseTimeDampening:h},h&&s(d)},c=function(){i&&(n.cancel(),a.cancel(),i=null)};return{start:l,stop:c,scroll:s}},YJ=function(e){var t=e.move,r=e.scrollDroppable,n=e.scrollWindow,a=function(u,d){var f=Rn(u.current.client.selection,d);t({client:f})},i=function(u,d){if(!SN(u,d))return d;var f=HJ(u,d);if(!f)return r(u.descriptor.id,d),null;var h=Qa(d,f);r(u.descriptor.id,h);var m=Qa(d,h);return m},s=function(u,d,f){if(!u||!NN(d,f))return f;var h=zJ(d,f);if(!h)return n(f),null;var m=Qa(f,h);n(m);var x=Qa(f,m);return x},l=function(u){var d=u.scrollJumpRequest;if(d){var f=ti(u.impact);f||He();var h=i(u.dimensions.droppables[f],d);if(h){var m=u.viewport,x=s(u.isWindowScrollAllowed,m,h);x&&a(u,x)}}};return l},XJ=function(e){var t=e.scrollDroppable,r=e.scrollWindow,n=e.move,a=GJ({scrollWindow:r,scrollDroppable:t}),i=YJ({move:n,scrollWindow:r,scrollDroppable:t}),s=function(u){if(u.phase==="DRAGGING"){if(u.movementMode==="FLUID"){a.scroll(u);return}u.scrollJumpRequest&&i(u)}},l={scroll:s,start:a.start,stop:a.stop};return l},fd="data-rbd",hd=function(){var e=fd+"-drag-handle";return{base:e,draggableId:e+"-draggable-id",contextId:e+"-context-id"}}(),T_=function(){var e=fd+"-draggable";return{base:e,contextId:e+"-context-id",id:e+"-id"}}(),KJ=function(){var e=fd+"-droppable";return{base:e,contextId:e+"-context-id",id:e+"-id"}}(),HC={contextId:fd+"-scroll-container-context-id"},ZJ=function(t){return function(r){return"["+r+'="'+t+'"]'}},Yf=function(t,r){return t.map(function(n){var a=n.styles[r];return a?n.selector+" { "+a+" }":""}).join(" ")},JJ="pointer-events: none;",QJ=function(e){var t=ZJ(e),r=function(){var l=`
      cursor: -webkit-grab;
      cursor: grab;
    `;return{selector:t(hd.contextId),styles:{always:`
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: rgba(0,0,0,0);
          touch-action: manipulation;
        `,resting:l,dragging:JJ,dropAnimating:l}}}(),n=function(){var l=`
      transition: `+Eh.outOfTheWay+`;
    `;return{selector:t(T_.contextId),styles:{dragging:l,dropAnimating:l,userCancel:l}}}(),a={selector:t(KJ.contextId),styles:{always:"overflow-anchor: none;"}},i={selector:"body",styles:{dragging:`
        cursor: grabbing;
        cursor: -webkit-grabbing;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        overflow-anchor: none;
      `}},s=[n,r,a,i];return{always:Yf(s,"always"),resting:Yf(s,"resting"),dragging:Yf(s,"dragging"),dropAnimating:Yf(s,"dropAnimating"),userCancel:Yf(s,"userCancel")}},ri=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?M.useLayoutEffect:M.useEffect,X1=function(){var t=document.querySelector("head");return t||He(),t},VC=function(t){var r=document.createElement("style");return t&&r.setAttribute("nonce",t),r.type="text/css",r};function eQ(e,t){var r=Lt(function(){return QJ(e)},[e]),n=M.useRef(null),a=M.useRef(null),i=st(_n(function(f){var h=a.current;h||He(),h.textContent=f}),[]),s=st(function(f){var h=n.current;h||He(),h.textContent=f},[]);ri(function(){!n.current&&!a.current||He();var f=VC(t),h=VC(t);return n.current=f,a.current=h,f.setAttribute(fd+"-always",e),h.setAttribute(fd+"-dynamic",e),X1().appendChild(f),X1().appendChild(h),s(r.always),i(r.resting),function(){var m=function(p){var g=p.current;g||He(),X1().removeChild(g),p.current=null};m(n),m(a)}},[t,s,i,r.always,r.resting,e]);var l=st(function(){return i(r.dragging)},[i,r.dragging]),c=st(function(f){if(f==="DROP"){i(r.dropAnimating);return}i(r.userCancel)},[i,r.dropAnimating,r.userCancel]),u=st(function(){a.current&&i(r.resting)},[i,r.resting]),d=Lt(function(){return{dragging:l,dropping:c,resting:u}},[l,c,u]);return d}var pR=function(e){return e&&e.ownerDocument?e.ownerDocument.defaultView:window};function py(e){return e instanceof pR(e).HTMLElement}function tQ(e,t){var r="["+hd.contextId+'="'+e+'"]',n=MI(document.querySelectorAll(r));if(!n.length)return null;var a=Ml(n,function(i){return i.getAttribute(hd.draggableId)===t});return!a||!py(a)?null:a}function rQ(e){var t=M.useRef({}),r=M.useRef(null),n=M.useRef(null),a=M.useRef(!1),i=st(function(h,m){var x={id:h,focus:m};return t.current[h]=x,function(){var g=t.current,v=g[h];v!==x&&delete g[h]}},[]),s=st(function(h){var m=tQ(e,h);m&&m!==document.activeElement&&m.focus()},[e]),l=st(function(h,m){r.current===h&&(r.current=m)},[]),c=st(function(){n.current||a.current&&(n.current=requestAnimationFrame(function(){n.current=null;var h=r.current;h&&s(h)}))},[s]),u=st(function(h){r.current=null;var m=document.activeElement;m&&m.getAttribute(hd.draggableId)===h&&(r.current=h)},[]);ri(function(){return a.current=!0,function(){a.current=!1;var h=n.current;h&&cancelAnimationFrame(h)}},[]);var d=Lt(function(){return{register:i,tryRecordFocus:u,tryRestoreFocusRecorded:c,tryShiftRecord:l}},[i,u,c,l]);return d}function nQ(){var e={draggables:{},droppables:{}},t=[];function r(f){return t.push(f),function(){var m=t.indexOf(f);m!==-1&&t.splice(m,1)}}function n(f){t.length&&t.forEach(function(h){return h(f)})}function a(f){return e.draggables[f]||null}function i(f){var h=a(f);return h||He(),h}var s={register:function(h){e.draggables[h.descriptor.id]=h,n({type:"ADDITION",value:h})},update:function(h,m){var x=e.draggables[m.descriptor.id];x&&x.uniqueId===h.uniqueId&&(delete e.draggables[m.descriptor.id],e.draggables[h.descriptor.id]=h)},unregister:function(h){var m=h.descriptor.id,x=a(m);x&&h.uniqueId===x.uniqueId&&(delete e.draggables[m],n({type:"REMOVAL",value:h}))},getById:i,findById:a,exists:function(h){return!!a(h)},getAllByType:function(h){return Z0(e.draggables).filter(function(m){return m.descriptor.type===h})}};function l(f){return e.droppables[f]||null}function c(f){var h=l(f);return h||He(),h}var u={register:function(h){e.droppables[h.descriptor.id]=h},unregister:function(h){var m=l(h.descriptor.id);m&&h.uniqueId===m.uniqueId&&delete e.droppables[h.descriptor.id]},getById:c,findById:l,exists:function(h){return!!l(h)},getAllByType:function(h){return Z0(e.droppables).filter(function(m){return m.descriptor.type===h})}};function d(){e.draggables={},e.droppables={},t.length=0}return{draggable:s,droppable:u,subscribe:r,clean:d}}function aQ(){var e=Lt(nQ,[]);return M.useEffect(function(){return function(){requestAnimationFrame(e.clean)}},[e]),e}var EN=Q.createContext(null),Q0=function(){var e=document.body;return e||He(),e},iQ={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},sQ=function(t){return"rbd-announcement-"+t};function oQ(e){var t=Lt(function(){return sQ(e)},[e]),r=M.useRef(null);M.useEffect(function(){var i=document.createElement("div");return r.current=i,i.id=t,i.setAttribute("aria-live","assertive"),i.setAttribute("aria-atomic","true"),Xe(i.style,iQ),Q0().appendChild(i),function(){setTimeout(function(){var c=Q0();c.contains(i)&&c.removeChild(i),i===r.current&&(r.current=null)})}},[t]);var n=st(function(a){var i=r.current;if(i){i.textContent=a;return}},[]);return n}var lQ=0,cQ={separator:"::"};function TN(e,t){return t===void 0&&(t=cQ),Lt(function(){return""+e+t.separator+lQ++},[t.separator,e])}function uQ(e){var t=e.contextId,r=e.uniqueId;return"rbd-hidden-text-"+t+"-"+r}function dQ(e){var t=e.contextId,r=e.text,n=TN("hidden-text",{separator:"-"}),a=Lt(function(){return uQ({contextId:t,uniqueId:n})},[n,t]);return M.useEffect(function(){var s=document.createElement("div");return s.id=a,s.textContent=r,s.style.display="none",Q0().appendChild(s),function(){var c=Q0();c.contains(s)&&c.removeChild(s)}},[a,r]),a}var xy=Q.createContext(null);function xR(e){var t=M.useRef(e);return M.useEffect(function(){t.current=e}),t}function fQ(){var e=null;function t(){return!!e}function r(s){return s===e}function n(s){e&&He();var l={abandon:s};return e=l,l}function a(){e||He(),e=null}function i(){e&&(e.abandon(),a())}return{isClaimed:t,isActive:r,claim:n,release:a,tryAbandon:i}}var hQ=9,mQ=13,kN=27,gR=32,pQ=33,xQ=34,gQ=35,vQ=36,yQ=37,bQ=38,wQ=39,_Q=40,Px,DQ=(Px={},Px[mQ]=!0,Px[hQ]=!0,Px),vR=function(e){DQ[e.keyCode]&&e.preventDefault()},gy=function(){var e="visibilitychange";if(typeof document>"u")return e;var t=[e,"ms"+e,"webkit"+e,"moz"+e,"o"+e],r=Ml(t,function(n){return"on"+n in document});return r||e}(),yR=0,qC=5;function jQ(e,t){return Math.abs(t.x-e.x)>=qC||Math.abs(t.y-e.y)>=qC}var GC={type:"IDLE"};function NQ(e){var t=e.cancel,r=e.completed,n=e.getPhase,a=e.setPhase;return[{eventName:"mousemove",fn:function(s){var l=s.button,c=s.clientX,u=s.clientY;if(l===yR){var d={x:c,y:u},f=n();if(f.type==="DRAGGING"){s.preventDefault(),f.actions.move(d);return}f.type!=="PENDING"&&He();var h=f.point;if(jQ(h,d)){s.preventDefault();var m=f.actions.fluidLift(d);a({type:"DRAGGING",actions:m})}}}},{eventName:"mouseup",fn:function(s){var l=n();if(l.type!=="DRAGGING"){t();return}s.preventDefault(),l.actions.drop({shouldBlockNextClick:!0}),r()}},{eventName:"mousedown",fn:function(s){n().type==="DRAGGING"&&s.preventDefault(),t()}},{eventName:"keydown",fn:function(s){var l=n();if(l.type==="PENDING"){t();return}if(s.keyCode===kN){s.preventDefault(),t();return}vR(s)}},{eventName:"resize",fn:t},{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(){n().type==="PENDING"&&t()}},{eventName:"webkitmouseforcedown",fn:function(s){var l=n();if(l.type==="IDLE"&&He(),l.actions.shouldRespectForcePress()){t();return}s.preventDefault()}},{eventName:gy,fn:t}]}function SQ(e){var t=M.useRef(GC),r=M.useRef(pl),n=Lt(function(){return{eventName:"mousedown",fn:function(f){if(!f.defaultPrevented&&f.button===yR&&!(f.ctrlKey||f.metaKey||f.shiftKey||f.altKey)){var h=e.findClosestDraggableId(f);if(h){var m=e.tryGetLock(h,s,{sourceEvent:f});if(m){f.preventDefault();var x={x:f.clientX,y:f.clientY};r.current(),u(m,x)}}}}}},[e]),a=Lt(function(){return{eventName:"webkitmouseforcewillbegin",fn:function(f){if(!f.defaultPrevented){var h=e.findClosestDraggableId(f);if(h){var m=e.findOptionsForDraggable(h);m&&(m.shouldRespectForcePress||e.canGetLock(h)&&f.preventDefault())}}}}},[e]),i=st(function(){var f={passive:!1,capture:!0};r.current=Fi(window,[a,n],f)},[a,n]),s=st(function(){var d=t.current;d.type!=="IDLE"&&(t.current=GC,r.current(),i())},[i]),l=st(function(){var d=t.current;s(),d.type==="DRAGGING"&&d.actions.cancel({shouldBlockNextClick:!0}),d.type==="PENDING"&&d.actions.abort()},[s]),c=st(function(){var f={capture:!0,passive:!1},h=NQ({cancel:l,completed:s,getPhase:function(){return t.current},setPhase:function(x){t.current=x}});r.current=Fi(window,h,f)},[l,s]),u=st(function(f,h){t.current.type!=="IDLE"&&He(),t.current={type:"PENDING",point:h,actions:f},c()},[c]);ri(function(){return i(),function(){r.current()}},[i])}var wu;function EQ(){}var TQ=(wu={},wu[xQ]=!0,wu[pQ]=!0,wu[vQ]=!0,wu[gQ]=!0,wu);function kQ(e,t){function r(){t(),e.cancel()}function n(){t(),e.drop()}return[{eventName:"keydown",fn:function(i){if(i.keyCode===kN){i.preventDefault(),r();return}if(i.keyCode===gR){i.preventDefault(),n();return}if(i.keyCode===_Q){i.preventDefault(),e.moveDown();return}if(i.keyCode===bQ){i.preventDefault(),e.moveUp();return}if(i.keyCode===wQ){i.preventDefault(),e.moveRight();return}if(i.keyCode===yQ){i.preventDefault(),e.moveLeft();return}if(TQ[i.keyCode]){i.preventDefault();return}vR(i)}},{eventName:"mousedown",fn:r},{eventName:"mouseup",fn:r},{eventName:"click",fn:r},{eventName:"touchstart",fn:r},{eventName:"resize",fn:r},{eventName:"wheel",fn:r,options:{passive:!0}},{eventName:gy,fn:r}]}function CQ(e){var t=M.useRef(EQ),r=Lt(function(){return{eventName:"keydown",fn:function(i){if(i.defaultPrevented||i.keyCode!==gR)return;var s=e.findClosestDraggableId(i);if(!s)return;var l=e.tryGetLock(s,d,{sourceEvent:i});if(!l)return;i.preventDefault();var c=!0,u=l.snapLift();t.current();function d(){c||He(),c=!1,t.current(),n()}t.current=Fi(window,kQ(u,d),{capture:!0,passive:!1})}}},[e]),n=st(function(){var i={passive:!1,capture:!0};t.current=Fi(window,[r],i)},[r]);ri(function(){return n(),function(){t.current()}},[n])}var K1={type:"IDLE"},AQ=120,OQ=.15;function FQ(e){var t=e.cancel,r=e.getPhase;return[{eventName:"orientationchange",fn:t},{eventName:"resize",fn:t},{eventName:"contextmenu",fn:function(a){a.preventDefault()}},{eventName:"keydown",fn:function(a){if(r().type!=="DRAGGING"){t();return}a.keyCode===kN&&a.preventDefault(),t()}},{eventName:gy,fn:t}]}function PQ(e){var t=e.cancel,r=e.completed,n=e.getPhase;return[{eventName:"touchmove",options:{capture:!1},fn:function(i){var s=n();if(s.type!=="DRAGGING"){t();return}s.hasMoved=!0;var l=i.touches[0],c=l.clientX,u=l.clientY,d={x:c,y:u};i.preventDefault(),s.actions.move(d)}},{eventName:"touchend",fn:function(i){var s=n();if(s.type!=="DRAGGING"){t();return}i.preventDefault(),s.actions.drop({shouldBlockNextClick:!0}),r()}},{eventName:"touchcancel",fn:function(i){if(n().type!=="DRAGGING"){t();return}i.preventDefault(),t()}},{eventName:"touchforcechange",fn:function(i){var s=n();s.type==="IDLE"&&He();var l=i.touches[0];if(l){var c=l.force>=OQ;if(c){var u=s.actions.shouldRespectForcePress();if(s.type==="PENDING"){u&&t();return}if(u){if(s.hasMoved){i.preventDefault();return}t();return}i.preventDefault()}}}},{eventName:gy,fn:t}]}function IQ(e){var t=M.useRef(K1),r=M.useRef(pl),n=st(function(){return t.current},[]),a=st(function(m){t.current=m},[]),i=Lt(function(){return{eventName:"touchstart",fn:function(m){if(!m.defaultPrevented){var x=e.findClosestDraggableId(m);if(x){var p=e.tryGetLock(x,l,{sourceEvent:m});if(p){var g=m.touches[0],v=g.clientX,y=g.clientY,b={x:v,y};r.current(),f(p,b)}}}}}},[e]),s=st(function(){var m={capture:!0,passive:!1};r.current=Fi(window,[i],m)},[i]),l=st(function(){var h=t.current;h.type!=="IDLE"&&(h.type==="PENDING"&&clearTimeout(h.longPressTimerId),a(K1),r.current(),s())},[s,a]),c=st(function(){var h=t.current;l(),h.type==="DRAGGING"&&h.actions.cancel({shouldBlockNextClick:!0}),h.type==="PENDING"&&h.actions.abort()},[l]),u=st(function(){var m={capture:!0,passive:!1},x={cancel:c,completed:l,getPhase:n},p=Fi(window,PQ(x),m),g=Fi(window,FQ(x),m);r.current=function(){p(),g()}},[c,n,l]),d=st(function(){var m=n();m.type!=="PENDING"&&He();var x=m.actions.fluidLift(m.point);a({type:"DRAGGING",actions:x,hasMoved:!1})},[n,a]),f=st(function(m,x){n().type!=="IDLE"&&He();var p=setTimeout(d,AQ);a({type:"PENDING",point:x,actions:m,longPressTimerId:p}),u()},[u,n,a,d]);ri(function(){return s(),function(){r.current();var x=n();x.type==="PENDING"&&(clearTimeout(x.longPressTimerId),a(K1))}},[n,s,a]),ri(function(){var m=Fi(window,[{eventName:"touchmove",fn:function(){},options:{capture:!1,passive:!1}}]);return m},[])}var RQ={input:!0,button:!0,textarea:!0,select:!0,option:!0,optgroup:!0,video:!0,audio:!0};function bR(e,t){if(t==null)return!1;var r=!!RQ[t.tagName.toLowerCase()];if(r)return!0;var n=t.getAttribute("contenteditable");return n==="true"||n===""?!0:t===e?!1:bR(e,t.parentElement)}function MQ(e,t){var r=t.target;return py(r)?bR(e,r):!1}var UQ=function(e){return ns(e.getBoundingClientRect()).center};function $Q(e){return e instanceof pR(e).Element}var LQ=function(){var e="matches";if(typeof document>"u")return e;var t=[e,"msMatchesSelector","webkitMatchesSelector"],r=Ml(t,function(n){return n in Element.prototype});return r||e}();function wR(e,t){return e==null?null:e[LQ](t)?e:wR(e.parentElement,t)}function BQ(e,t){return e.closest?e.closest(t):wR(e,t)}function WQ(e){return"["+hd.contextId+'="'+e+'"]'}function zQ(e,t){var r=t.target;if(!$Q(r))return null;var n=WQ(e),a=BQ(r,n);return!a||!py(a)?null:a}function HQ(e,t){var r=zQ(e,t);return r?r.getAttribute(hd.draggableId):null}function VQ(e,t){var r="["+T_.contextId+'="'+e+'"]',n=MI(document.querySelectorAll(r)),a=Ml(n,function(i){return i.getAttribute(T_.id)===t});return!a||!py(a)?null:a}function qQ(e){e.preventDefault()}function Ix(e){var t=e.expected,r=e.phase,n=e.isLockActive;return e.shouldWarn,!(!n()||t!==r)}function _R(e){var t=e.lockAPI,r=e.store,n=e.registry,a=e.draggableId;if(t.isClaimed())return!1;var i=n.draggable.findById(a);return!(!i||!i.options.isEnabled||!dR(r.getState(),a))}function GQ(e){var t=e.lockAPI,r=e.contextId,n=e.store,a=e.registry,i=e.draggableId,s=e.forceSensorStop,l=e.sourceEvent,c=_R({lockAPI:t,store:n,registry:a,draggableId:i});if(!c)return null;var u=a.draggable.getById(i),d=VQ(r,u.descriptor.id);if(!d||l&&!u.options.canDragInteractiveElements&&MQ(d,l))return null;var f=t.claim(s||pl),h="PRE_DRAG";function m(){return u.options.shouldRespectForcePress}function x(){return t.isActive(f)}function p(D,j){Ix({expected:D,phase:h,isLockActive:x,shouldWarn:!0})&&n.dispatch(j())}var g=p.bind(null,"DRAGGING");function v(D){function j(){t.release(),h="COMPLETED"}h!=="PRE_DRAG"&&(j(),h!=="PRE_DRAG"&&He()),n.dispatch(LZ(D.liftActionArgs)),h="DRAGGING";function N(S,E){if(E===void 0&&(E={shouldBlockNextClick:!1}),D.cleanup(),E.shouldBlockNextClick){var A=Fi(window,[{eventName:"click",fn:qQ,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(A)}j(),n.dispatch(aR({reason:S}))}return Xe({isActive:function(){return Ix({expected:"DRAGGING",phase:h,isLockActive:x,shouldWarn:!1})},shouldRespectForcePress:m,drop:function(E){return N("DROP",E)},cancel:function(E){return N("CANCEL",E)}},D.actions)}function y(D){var j=Gh(function(S){g(function(){return nR({client:S})})}),N=v({liftActionArgs:{id:i,clientSelection:D,movementMode:"FLUID"},cleanup:function(){return j.cancel()},actions:{move:j}});return Xe({},N,{move:j})}function b(){var D={moveUp:function(){return g(XZ)},moveRight:function(){return g(ZZ)},moveDown:function(){return g(KZ)},moveLeft:function(){return g(JZ)}};return v({liftActionArgs:{id:i,clientSelection:UQ(d),movementMode:"SNAP"},cleanup:pl,actions:D})}function w(){var D=Ix({expected:"PRE_DRAG",phase:h,isLockActive:x,shouldWarn:!0});D&&t.release()}var _={isActive:function(){return Ix({expected:"PRE_DRAG",phase:h,isLockActive:x,shouldWarn:!1})},shouldRespectForcePress:m,fluidLift:y,snapLift:b,abort:w};return _}var YQ=[SQ,CQ,IQ];function XQ(e){var t=e.contextId,r=e.store,n=e.registry,a=e.customSensors,i=e.enableDefaultSensors,s=[].concat(i?YQ:[],a||[]),l=M.useState(function(){return fQ()})[0],c=st(function(y,b){y.isDragging&&!b.isDragging&&l.tryAbandon()},[l]);ri(function(){var y=r.getState(),b=r.subscribe(function(){var w=r.getState();c(y,w),y=w});return b},[l,r,c]),ri(function(){return l.tryAbandon},[l.tryAbandon]);for(var u=st(function(v){return _R({lockAPI:l,registry:n,store:r,draggableId:v})},[l,n,r]),d=st(function(v,y,b){return GQ({lockAPI:l,registry:n,contextId:t,store:r,draggableId:v,forceSensorStop:y,sourceEvent:b&&b.sourceEvent?b.sourceEvent:null})},[t,l,n,r]),f=st(function(v){return HQ(t,v)},[t]),h=st(function(v){var y=n.draggable.findById(v);return y?y.options:null},[n.draggable]),m=st(function(){l.isClaimed()&&(l.tryAbandon(),r.getState().phase!=="IDLE"&&r.dispatch(yN()))},[l,r]),x=st(l.isClaimed,[l]),p=Lt(function(){return{canGetLock:u,tryGetLock:d,findClosestDraggableId:f,findOptionsForDraggable:h,tryReleaseLock:m,isLockClaimed:x}},[u,d,f,h,m,x]),g=0;g<s.length;g++)s[g](p)}var KQ=function(t){return{onBeforeCapture:t.onBeforeCapture,onBeforeDragStart:t.onBeforeDragStart,onDragStart:t.onDragStart,onDragEnd:t.onDragEnd,onDragUpdate:t.onDragUpdate}};function Xf(e){return e.current||He(),e.current}function ZQ(e){var t=e.contextId,r=e.setCallbacks,n=e.sensors,a=e.nonce,i=e.dragHandleUsageInstructions,s=M.useRef(null),l=xR(e),c=st(function(){return KQ(l.current)},[l]),u=oQ(t),d=dQ({contextId:t,text:i}),f=eQ(t,a),h=st(function(S){Xf(s).dispatch(S)},[]),m=Lt(function(){return xC({publishWhileDragging:WZ,updateDroppableScroll:HZ,updateDroppableIsEnabled:VZ,updateDroppableIsCombineEnabled:qZ,collectionStarting:zZ},h)},[h]),x=aQ(),p=Lt(function(){return OJ(x,m)},[x,m]),g=Lt(function(){return XJ(Xe({scrollWindow:FJ,scrollDroppable:p.scrollDroppable},xC({move:nR},h)))},[p.scrollDroppable,h]),v=rQ(t),y=Lt(function(){return TJ({announce:u,autoScroller:g,dimensionMarshal:p,focusMarshal:v,getResponders:c,styleMarshal:f})},[u,g,p,v,c,f]);s.current=y;var b=st(function(){var S=Xf(s),E=S.getState();E.phase!=="IDLE"&&S.dispatch(yN())},[]),w=st(function(){var S=Xf(s).getState();return S.isDragging||S.phase==="DROP_ANIMATING"},[]),_=Lt(function(){return{isDragging:w,tryAbort:b}},[w,b]);r(_);var D=st(function(S){return dR(Xf(s).getState(),S)},[]),j=st(function(){return uc(Xf(s).getState())},[]),N=Lt(function(){return{marshal:p,focus:v,contextId:t,canLift:D,isMovementAllowed:j,dragHandleUsageInstructionsId:d,registry:x}},[t,p,d,v,D,j,x]);return XQ({contextId:t,store:y,registry:x,customSensors:n,enableDefaultSensors:e.enableDefaultSensors!==!1}),M.useEffect(function(){return b},[b]),Q.createElement(xy.Provider,{value:N},Q.createElement(bX,{context:EN,store:y},e.children))}var JQ=0;function QQ(){return Lt(function(){return""+JQ++},[])}function eee(e){var t=QQ(),r=e.dragHandleUsageInstructions||C0.dragHandleUsageInstructions;return Q.createElement(CK,null,function(n){return Q.createElement(ZQ,{nonce:e.nonce,contextId:t,setCallbacks:n,dragHandleUsageInstructions:r,enableDefaultSensors:e.enableDefaultSensors,sensors:e.sensors,onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragUpdate:e.onDragUpdate,onDragEnd:e.onDragEnd},e.children)})}var DR=function(t){return function(r){return t===r}},tee=DR("scroll"),ree=DR("auto"),YC=function(t,r){return r(t.overflowX)||r(t.overflowY)},nee=function(t){var r=window.getComputedStyle(t),n={overflowX:r.overflowX,overflowY:r.overflowY};return YC(n,tee)||YC(n,ree)},aee=function(){return!1},iee=function e(t){return t==null?null:t===document.body?aee()?t:null:t===document.documentElement?null:nee(t)?t:e(t.parentElement)},k_=function(e){return{x:e.scrollLeft,y:e.scrollTop}},see=function e(t){if(!t)return!1;var r=window.getComputedStyle(t);return r.position==="fixed"?!0:e(t.parentElement)},oee=function(e){var t=iee(e),r=see(e);return{closestScrollable:t,isFixedOnPage:r}},lee=function(e){var t=e.descriptor,r=e.isEnabled,n=e.isCombineEnabled,a=e.isFixedOnPage,i=e.direction,s=e.client,l=e.page,c=e.closest,u=function(){if(!c)return null;var m=c.scrollSize,x=c.client,p=lR({scrollHeight:m.scrollHeight,scrollWidth:m.scrollWidth,height:x.paddingBox.height,width:x.paddingBox.width});return{pageMarginBox:c.page.marginBox,frameClient:x,scrollSize:m,shouldClipSubject:c.shouldClipSubject,scroll:{initial:c.scroll,current:c.scroll,max:p,diff:{value:Dn,displacement:Dn}}}}(),d=i==="vertical"?mN:WI,f=dd({page:l,withPlaceholder:null,axis:d,frame:u}),h={descriptor:t,isCombineEnabled:n,isFixedOnPage:a,axis:d,isEnabled:r,client:s,page:l,frame:u,subject:f};return h},cee=function(t,r){var n=OI(t);if(!r||t!==r)return n;var a=n.paddingBox.top-r.scrollTop,i=n.paddingBox.left-r.scrollLeft,s=a+r.scrollHeight,l=i+r.scrollWidth,c={top:a,right:l,bottom:s,left:i},u=cN(c,n.border),d=uN({borderBox:u,margin:n.margin,border:n.border,padding:n.padding});return d},uee=function(e){var t=e.ref,r=e.descriptor,n=e.env,a=e.windowScroll,i=e.direction,s=e.isDropDisabled,l=e.isCombineEnabled,c=e.shouldClipSubject,u=n.closestScrollable,d=cee(t,u),f=Y0(d,a),h=function(){if(!u)return null;var x=OI(u),p={scrollHeight:u.scrollHeight,scrollWidth:u.scrollWidth};return{client:x,page:Y0(x,a),scroll:k_(u),scrollSize:p,shouldClipSubject:c}}(),m=lee({descriptor:r,isEnabled:!s,isCombineEnabled:l,isFixedOnPage:n.isFixedOnPage,direction:i,client:d,page:f,closest:h});return m},dee={passive:!1},fee={passive:!0},XC=function(e){return e.shouldPublishImmediately?dee:fee};function eg(e){var t=M.useContext(e);return t||He(),t}var Rx=function(t){return t&&t.env.closestScrollable||null};function hee(e){var t=M.useRef(null),r=eg(xy),n=TN("droppable"),a=r.registry,i=r.marshal,s=xR(e),l=Lt(function(){return{id:e.droppableId,type:e.type,mode:e.mode}},[e.droppableId,e.mode,e.type]),c=M.useRef(l),u=Lt(function(){return _n(function(w,_){t.current||He();var D={x:w,y:_};i.updateDroppableScroll(l.id,D)})},[l.id,i]),d=st(function(){var w=t.current;return!w||!w.env.closestScrollable?Dn:k_(w.env.closestScrollable)},[]),f=st(function(){var w=d();u(w.x,w.y)},[d,u]),h=Lt(function(){return Gh(f)},[f]),m=st(function(){var w=t.current,_=Rx(w);w&&_||He();var D=w.scrollOptions;if(D.shouldPublishImmediately){f();return}h()},[h,f]),x=st(function(w,_){t.current&&He();var D=s.current,j=D.getDroppableRef();j||He();var N=oee(j),S={ref:j,descriptor:l,env:N,scrollOptions:_};t.current=S;var E=uee({ref:j,descriptor:l,env:N,windowScroll:w,direction:D.direction,isDropDisabled:D.isDropDisabled,isCombineEnabled:D.isCombineEnabled,shouldClipSubject:!D.ignoreContainerClipping}),A=N.closestScrollable;return A&&(A.setAttribute(HC.contextId,r.contextId),A.addEventListener("scroll",m,XC(S.scrollOptions))),E},[r.contextId,l,m,s]),p=st(function(){var w=t.current,_=Rx(w);return w&&_||He(),k_(_)},[]),g=st(function(){var w=t.current;w||He();var _=Rx(w);t.current=null,_&&(h.cancel(),_.removeAttribute(HC.contextId),_.removeEventListener("scroll",m,XC(w.scrollOptions)))},[m,h]),v=st(function(w){var _=t.current;_||He();var D=Rx(_);D||He(),D.scrollTop+=w.y,D.scrollLeft+=w.x},[]),y=Lt(function(){return{getDimensionAndWatchScroll:x,getScrollWhileDragging:p,dragStopped:g,scroll:v}},[g,x,p,v]),b=Lt(function(){return{uniqueId:n,descriptor:l,callbacks:y}},[y,l,n]);ri(function(){return c.current=b.descriptor,a.droppable.register(b),function(){t.current&&g(),a.droppable.unregister(b)}},[y,l,g,b,i,a.droppable]),ri(function(){t.current&&i.updateDroppableIsEnabled(c.current.id,!e.isDropDisabled)},[e.isDropDisabled,i]),ri(function(){t.current&&i.updateDroppableIsCombineEnabled(c.current.id,e.isCombineEnabled)},[e.isCombineEnabled,i])}function Z1(){}var KC={width:0,height:0,margin:RK},mee=function(t){var r=t.isAnimatingOpenOnMount,n=t.placeholder,a=t.animate;return r||a==="close"?KC:{height:n.client.borderBox.height,width:n.client.borderBox.width,margin:n.client.margin}},pee=function(t){var r=t.isAnimatingOpenOnMount,n=t.placeholder,a=t.animate,i=mee({isAnimatingOpenOnMount:r,placeholder:n,animate:a});return{display:n.display,boxSizing:"border-box",width:i.width,height:i.height,marginTop:i.margin.top,marginRight:i.margin.right,marginBottom:i.margin.bottom,marginLeft:i.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:a!=="none"?Eh.placeholder:null}};function xee(e){var t=M.useRef(null),r=st(function(){t.current&&(clearTimeout(t.current),t.current=null)},[]),n=e.animate,a=e.onTransitionEnd,i=e.onClose,s=e.contextId,l=M.useState(e.animate==="open"),c=l[0],u=l[1];M.useEffect(function(){return c?n!=="open"?(r(),u(!1),Z1):t.current?Z1:(t.current=setTimeout(function(){t.current=null,u(!1)}),r):Z1},[n,c,r]);var d=st(function(h){h.propertyName==="height"&&(a(),n==="close"&&i())},[n,i,a]),f=pee({isAnimatingOpenOnMount:c,animate:e.animate,placeholder:e.placeholder});return Q.createElement(e.placeholder.tagName,{style:f,"data-rbd-placeholder-context-id":s,onTransitionEnd:d,ref:e.innerRef})}var gee=Q.memo(xee),CN=Q.createContext(null),vee=function(e){tN(t,e);function t(){for(var n,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=e.call.apply(e,[this].concat(i))||this,n.state={isVisible:!!n.props.on,data:n.props.on,animate:n.props.shouldAnimate&&n.props.on?"open":"none"},n.onClose=function(){n.state.animate==="close"&&n.setState({isVisible:!1})},n}t.getDerivedStateFromProps=function(a,i){return a.shouldAnimate?a.on?{isVisible:!0,data:a.on,animate:"open"}:i.isVisible?{isVisible:!0,data:i.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:!!a.on,data:a.on,animate:"none"}};var r=t.prototype;return r.render=function(){if(!this.state.isVisible)return null;var a={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(a)},t}(Q.PureComponent),ZC={dragging:5e3,dropAnimating:4500},yee=function(t,r){return r?Eh.drop(r.duration):t?Eh.snap:Eh.fluid},bee=function(t,r){return t?r?Zh.opacity.drop:Zh.opacity.combining:null},wee=function(t){return t.forceShouldAnimate!=null?t.forceShouldAnimate:t.mode==="SNAP"};function _ee(e){var t=e.dimension,r=t.client,n=e.offset,a=e.combineWith,i=e.dropping,s=!!a,l=wee(e),c=!!i,u=c?S_.drop(n,s):S_.moveTo(n),d={position:"fixed",top:r.marginBox.top,left:r.marginBox.left,boxSizing:"border-box",width:r.borderBox.width,height:r.borderBox.height,transition:yee(l,i),transform:u,opacity:bee(s,c),zIndex:c?ZC.dropAnimating:ZC.dragging,pointerEvents:"none"};return d}function Dee(e){return{transform:S_.moveTo(e.offset),transition:e.shouldAnimateDisplacement?null:"none"}}function jee(e){return e.type==="DRAGGING"?_ee(e):Dee(e)}function Nee(e,t,r){r===void 0&&(r=Dn);var n=window.getComputedStyle(t),a=t.getBoundingClientRect(),i=AI(a,n),s=Y0(i,r),l={client:i,tagName:t.tagName.toLowerCase(),display:n.display},c={x:i.marginBox.width,y:i.marginBox.height},u={descriptor:e,placeholder:l,displaceBy:c,client:i,page:s};return u}function See(e){var t=TN("draggable"),r=e.descriptor,n=e.registry,a=e.getDraggableRef,i=e.canDragInteractiveElements,s=e.shouldRespectForcePress,l=e.isEnabled,c=Lt(function(){return{canDragInteractiveElements:i,shouldRespectForcePress:s,isEnabled:l}},[i,l,s]),u=st(function(m){var x=a();return x||He(),Nee(r,x,m)},[r,a]),d=Lt(function(){return{uniqueId:t,descriptor:r,options:c,getDimension:u}},[r,u,c,t]),f=M.useRef(d),h=M.useRef(!0);ri(function(){return n.draggable.register(f.current),function(){return n.draggable.unregister(f.current)}},[n.draggable]),ri(function(){if(h.current){h.current=!1;return}var m=f.current;f.current=d,n.draggable.update(d,m)},[d,n.draggable])}function Eee(e){e.preventDefault()}function Tee(e){var t=M.useRef(null),r=st(function(S){t.current=S},[]),n=st(function(){return t.current},[]),a=eg(xy),i=a.contextId,s=a.dragHandleUsageInstructionsId,l=a.registry,c=eg(CN),u=c.type,d=c.droppableId,f=Lt(function(){return{id:e.draggableId,index:e.index,type:u,droppableId:d}},[e.draggableId,e.index,u,d]),h=e.children,m=e.draggableId,x=e.isEnabled,p=e.shouldRespectForcePress,g=e.canDragInteractiveElements,v=e.isClone,y=e.mapped,b=e.dropAnimationFinished;if(!v){var w=Lt(function(){return{descriptor:f,registry:l,getDraggableRef:n,canDragInteractiveElements:g,shouldRespectForcePress:p,isEnabled:x}},[f,l,n,g,p,x]);See(w)}var _=Lt(function(){return x?{tabIndex:0,role:"button","aria-describedby":s,"data-rbd-drag-handle-draggable-id":m,"data-rbd-drag-handle-context-id":i,draggable:!1,onDragStart:Eee}:null},[i,s,m,x]),D=st(function(S){y.type==="DRAGGING"&&y.dropping&&S.propertyName==="transform"&&b()},[b,y]),j=Lt(function(){var S=jee(y),E=y.type==="DRAGGING"&&y.dropping?D:null,A={innerRef:r,draggableProps:{"data-rbd-draggable-context-id":i,"data-rbd-draggable-id":m,style:S,onTransitionEnd:E},dragHandleProps:_};return A},[i,_,m,y,D,r]),N=Lt(function(){return{draggableId:f.id,type:f.type,source:{index:f.index,droppableId:f.droppableId}}},[f.droppableId,f.id,f.index,f.type]);return h(j,y.snapshot,N)}var jR=function(e,t){return e===t},NR=function(e){var t=e.combine,r=e.destination;return r?r.droppableId:t?t.droppableId:null},kee=function(t){return t.combine?t.combine.draggableId:null},Cee=function(t){return t.at&&t.at.type==="COMBINE"?t.at.combine.draggableId:null};function Aee(){var e=_n(function(a,i){return{x:a,y:i}}),t=_n(function(a,i,s,l,c){return{isDragging:!0,isClone:i,isDropAnimating:!!c,dropAnimation:c,mode:a,draggingOver:s,combineWith:l,combineTargetFor:null}}),r=_n(function(a,i,s,l,c,u,d){return{mapped:{type:"DRAGGING",dropping:null,draggingOver:c,combineWith:u,mode:i,offset:a,dimension:s,forceShouldAnimate:d,snapshot:t(i,l,c,u,null)}}}),n=function(i,s){if(i.isDragging){if(i.critical.draggable.id!==s.draggableId)return null;var l=i.current.client.offset,c=i.dimensions.draggables[s.draggableId],u=ti(i.impact),d=Cee(i.impact),f=i.forceShouldAnimate;return r(e(l.x,l.y),i.movementMode,c,s.isClone,u,d,f)}if(i.phase==="DROP_ANIMATING"){var h=i.completed;if(h.result.draggableId!==s.draggableId)return null;var m=s.isClone,x=i.dimensions.draggables[s.draggableId],p=h.result,g=p.mode,v=NR(p),y=kee(p),b=i.dropDuration,w={duration:b,curve:wN.drop,moveTo:i.newHomeClientOffset,opacity:y?Zh.opacity.drop:null,scale:y?Zh.scale.drop:null};return{mapped:{type:"DRAGGING",offset:i.newHomeClientOffset,dimension:x,dropping:w,draggingOver:v,combineWith:y,mode:g,forceShouldAnimate:null,snapshot:t(g,m,v,y,w)}}}return null};return n}function SR(e){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:e,combineWith:null}}var Oee={mapped:{type:"SECONDARY",offset:Dn,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:SR(null)}};function Fee(){var e=_n(function(s,l){return{x:s,y:l}}),t=_n(SR),r=_n(function(s,l,c){return l===void 0&&(l=null),{mapped:{type:"SECONDARY",offset:s,combineTargetFor:l,shouldAnimateDisplacement:c,snapshot:t(l)}}}),n=function(l){return l?r(Dn,l,!0):null},a=function(l,c,u,d){var f=u.displaced.visible[l],h=!!(d.inVirtualList&&d.effected[l]),m=fy(u),x=m&&m.draggableId===l?c:null;if(!f){if(!h)return n(x);if(u.displaced.invisible[l])return null;var p=af(d.displacedBy.point),g=e(p.x,p.y);return r(g,x,!0)}if(h)return n(x);var v=u.displacedBy.point,y=e(v.x,v.y);return r(y,x,f.shouldAnimate)},i=function(l,c){if(l.isDragging)return l.critical.draggable.id===c.draggableId?null:a(c.draggableId,l.critical.draggable.id,l.impact,l.afterCritical);if(l.phase==="DROP_ANIMATING"){var u=l.completed;return u.result.draggableId===c.draggableId?null:a(c.draggableId,u.result.draggableId,u.impact,u.afterCritical)}return null};return i}var Pee=function(){var t=Aee(),r=Fee(),n=function(i,s){return t(i,s)||r(i,s)||Oee};return n},Iee={dropAnimationFinished:iR},Ree=kI(Pee,Iee,null,{context:EN,pure:!0,areStatePropsEqual:jR})(Tee);function ER(e){var t=eg(CN),r=t.isUsingCloneFor;return r===e.draggableId&&!e.isClone?null:Q.createElement(Ree,e)}function Mee(e){var t=typeof e.isDragDisabled=="boolean"?!e.isDragDisabled:!0,r=!!e.disableInteractiveElementBlocking,n=!!e.shouldRespectForcePress;return Q.createElement(ER,Xe({},e,{isClone:!1,isEnabled:t,canDragInteractiveElements:r,shouldRespectForcePress:n}))}function Uee(e){var t=M.useContext(xy);t||He();var r=t.contextId,n=t.isMovementAllowed,a=M.useRef(null),i=M.useRef(null),s=e.children,l=e.droppableId,c=e.type,u=e.mode,d=e.direction,f=e.ignoreContainerClipping,h=e.isDropDisabled,m=e.isCombineEnabled,x=e.snapshot,p=e.useClone,g=e.updateViewportMaxScroll,v=e.getContainerForClone,y=st(function(){return a.current},[]),b=st(function(A){a.current=A},[]);st(function(){return i.current},[]);var w=st(function(A){i.current=A},[]),_=st(function(){n()&&g({maxScroll:uR()})},[n,g]);hee({droppableId:l,type:c,mode:u,direction:d,isDropDisabled:h,isCombineEnabled:m,ignoreContainerClipping:f,getDroppableRef:y});var D=Q.createElement(vee,{on:e.placeholder,shouldAnimate:e.shouldAnimatePlaceholder},function(A){var T=A.onClose,L=A.data,O=A.animate;return Q.createElement(gee,{placeholder:L,onClose:T,innerRef:w,animate:O,contextId:r,onTransitionEnd:_})}),j=Lt(function(){return{innerRef:b,placeholder:D,droppableProps:{"data-rbd-droppable-id":l,"data-rbd-droppable-context-id":r}}},[r,l,D,b]),N=p?p.dragging.draggableId:null,S=Lt(function(){return{droppableId:l,type:c,isUsingCloneFor:N}},[l,N,c]);function E(){if(!p)return null;var A=p.dragging,T=p.render,L=Q.createElement(ER,{draggableId:A.draggableId,index:A.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},function(O,V){return T(O,V,A)});return Yj.createPortal(L,v())}return Q.createElement(CN.Provider,{value:S},s(j,x),E())}var J1=function(t,r){return t===r.droppable.type},JC=function(t,r){return r.draggables[t.draggable.id]},$ee=function(){var t={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},r=Xe({},t,{shouldAnimatePlaceholder:!1}),n=_n(function(s){return{draggableId:s.id,type:s.type,source:{index:s.index,droppableId:s.droppableId}}}),a=_n(function(s,l,c,u,d,f){var h=d.descriptor.id,m=d.descriptor.droppableId===s;if(m){var x=f?{render:f,dragging:n(d.descriptor)}:null,p={isDraggingOver:c,draggingOverWith:c?h:null,draggingFromThisWith:h,isUsingPlaceholder:!0};return{placeholder:d.placeholder,shouldAnimatePlaceholder:!1,snapshot:p,useClone:x}}if(!l)return r;if(!u)return t;var g={isDraggingOver:c,draggingOverWith:h,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:d.placeholder,shouldAnimatePlaceholder:!0,snapshot:g,useClone:null}}),i=function(l,c){var u=c.droppableId,d=c.type,f=!c.isDropDisabled,h=c.renderClone;if(l.isDragging){var m=l.critical;if(!J1(d,m))return r;var x=JC(m,l.dimensions),p=ti(l.impact)===u;return a(u,f,p,p,x,h)}if(l.phase==="DROP_ANIMATING"){var g=l.completed;if(!J1(d,g.critical))return r;var v=JC(g.critical,l.dimensions);return a(u,f,NR(g.result)===u,ti(g.impact)===u,v,h)}if(l.phase==="IDLE"&&l.completed&&!l.shouldFlush){var y=l.completed;if(!J1(d,y.critical))return r;var b=ti(y.impact)===u,w=!!(y.impact.at&&y.impact.at.type==="COMBINE"),_=y.critical.droppable.id===u;return b?w?t:r:_?t:r}return r};return i},Lee={updateViewportMaxScroll:YZ};function Bee(){return document.body||He(),document.body}var Wee={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:Bee},TR=kI($ee,Lee,null,{context:EN,pure:!0,areStatePropsEqual:jR})(Uee);TR.defaultProps=Wee;function kR(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=kR(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function vt(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=kR(e))&&(n&&(n+=" "),n+=t);return n}var zee=Array.isArray,sa=zee,Hee=typeof ht=="object"&&ht&&ht.Object===Object&&ht,CR=Hee,Vee=CR,qee=typeof self=="object"&&self&&self.Object===Object&&self,Gee=Vee||qee||Function("return this")(),vs=Gee,Yee=vs,Xee=Yee.Symbol,lf=Xee,QC=lf,AR=Object.prototype,Kee=AR.hasOwnProperty,Zee=AR.toString,Kf=QC?QC.toStringTag:void 0;function Jee(e){var t=Kee.call(e,Kf),r=e[Kf];try{e[Kf]=void 0;var n=!0}catch{}var a=Zee.call(e);return n&&(t?e[Kf]=r:delete e[Kf]),a}var Qee=Jee,ete=Object.prototype,tte=ete.toString;function rte(e){return tte.call(e)}var nte=rte,eA=lf,ate=Qee,ite=nte,ste="[object Null]",ote="[object Undefined]",tA=eA?eA.toStringTag:void 0;function lte(e){return e==null?e===void 0?ote:ste:tA&&tA in Object(e)?ate(e):ite(e)}var Wo=lte;function cte(e){return e!=null&&typeof e=="object"}var ys=cte,ute=Wo,dte=ys,fte="[object Symbol]";function hte(e){return typeof e=="symbol"||dte(e)&&ute(e)==fte}var cf=hte,mte=sa,pte=cf,xte=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,gte=/^\w*$/;function vte(e,t){if(mte(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||pte(e)?!0:gte.test(e)||!xte.test(e)||t!=null&&e in Object(t)}var AN=vte;function yte(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Hi=yte;const uf=At(Hi);var bte=Wo,wte=Hi,_te="[object AsyncFunction]",Dte="[object Function]",jte="[object GeneratorFunction]",Nte="[object Proxy]";function Ste(e){if(!wte(e))return!1;var t=bte(e);return t==Dte||t==jte||t==_te||t==Nte}var vy=Ste;const mt=At(vy);var Ete=vs,Tte=Ete["__core-js_shared__"],kte=Tte,Q1=kte,rA=function(){var e=/[^.]+$/.exec(Q1&&Q1.keys&&Q1.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Cte(e){return!!rA&&rA in e}var Ate=Cte,Ote=Function.prototype,Fte=Ote.toString;function Pte(e){if(e!=null){try{return Fte.call(e)}catch{}try{return e+""}catch{}}return""}var OR=Pte,Ite=vy,Rte=Ate,Mte=Hi,Ute=OR,$te=/[\\^$.*+?()[\]{}|]/g,Lte=/^\[object .+?Constructor\]$/,Bte=Function.prototype,Wte=Object.prototype,zte=Bte.toString,Hte=Wte.hasOwnProperty,Vte=RegExp("^"+zte.call(Hte).replace($te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function qte(e){if(!Mte(e)||Rte(e))return!1;var t=Ite(e)?Vte:Lte;return t.test(Ute(e))}var Gte=qte;function Yte(e,t){return e==null?void 0:e[t]}var Xte=Yte,Kte=Gte,Zte=Xte;function Jte(e,t){var r=Zte(e,t);return Kte(r)?r:void 0}var iu=Jte,Qte=iu,ere=Qte(Object,"create"),yy=ere,nA=yy;function tre(){this.__data__=nA?nA(null):{},this.size=0}var rre=tre;function nre(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var are=nre,ire=yy,sre="__lodash_hash_undefined__",ore=Object.prototype,lre=ore.hasOwnProperty;function cre(e){var t=this.__data__;if(ire){var r=t[e];return r===sre?void 0:r}return lre.call(t,e)?t[e]:void 0}var ure=cre,dre=yy,fre=Object.prototype,hre=fre.hasOwnProperty;function mre(e){var t=this.__data__;return dre?t[e]!==void 0:hre.call(t,e)}var pre=mre,xre=yy,gre="__lodash_hash_undefined__";function vre(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=xre&&t===void 0?gre:t,this}var yre=vre,bre=rre,wre=are,_re=ure,Dre=pre,jre=yre;function df(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}df.prototype.clear=bre;df.prototype.delete=wre;df.prototype.get=_re;df.prototype.has=Dre;df.prototype.set=jre;var Nre=df;function Sre(){this.__data__=[],this.size=0}var Ere=Sre;function Tre(e,t){return e===t||e!==e&&t!==t}var Gp=Tre,kre=Gp;function Cre(e,t){for(var r=e.length;r--;)if(kre(e[r][0],t))return r;return-1}var by=Cre,Are=by,Ore=Array.prototype,Fre=Ore.splice;function Pre(e){var t=this.__data__,r=Are(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():Fre.call(t,r,1),--this.size,!0}var Ire=Pre,Rre=by;function Mre(e){var t=this.__data__,r=Rre(t,e);return r<0?void 0:t[r][1]}var Ure=Mre,$re=by;function Lre(e){return $re(this.__data__,e)>-1}var Bre=Lre,Wre=by;function zre(e,t){var r=this.__data__,n=Wre(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var Hre=zre,Vre=Ere,qre=Ire,Gre=Ure,Yre=Bre,Xre=Hre;function ff(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ff.prototype.clear=Vre;ff.prototype.delete=qre;ff.prototype.get=Gre;ff.prototype.has=Yre;ff.prototype.set=Xre;var wy=ff,Kre=iu,Zre=vs,Jre=Kre(Zre,"Map"),ON=Jre,aA=Nre,Qre=wy,ene=ON;function tne(){this.size=0,this.__data__={hash:new aA,map:new(ene||Qre),string:new aA}}var rne=tne;function nne(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var ane=nne,ine=ane;function sne(e,t){var r=e.__data__;return ine(t)?r[typeof t=="string"?"string":"hash"]:r.map}var _y=sne,one=_y;function lne(e){var t=one(this,e).delete(e);return this.size-=t?1:0,t}var cne=lne,une=_y;function dne(e){return une(this,e).get(e)}var fne=dne,hne=_y;function mne(e){return hne(this,e).has(e)}var pne=mne,xne=_y;function gne(e,t){var r=xne(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var vne=gne,yne=rne,bne=cne,wne=fne,_ne=pne,Dne=vne;function hf(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}hf.prototype.clear=yne;hf.prototype.delete=bne;hf.prototype.get=wne;hf.prototype.has=_ne;hf.prototype.set=Dne;var FN=hf,FR=FN,jne="Expected a function";function PN(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(jne);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],i=r.cache;if(i.has(a))return i.get(a);var s=e.apply(this,n);return r.cache=i.set(a,s)||i,s};return r.cache=new(PN.Cache||FR),r}PN.Cache=FR;var PR=PN;const Nne=At(PR);var Sne=PR,Ene=500;function Tne(e){var t=Sne(e,function(n){return r.size===Ene&&r.clear(),n}),r=t.cache;return t}var kne=Tne,Cne=kne,Ane=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,One=/\\(\\)?/g,Fne=Cne(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Ane,function(r,n,a,i){t.push(a?i.replace(One,"$1"):n||r)}),t}),Pne=Fne;function Ine(e,t){for(var r=-1,n=e==null?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var Dy=Ine,iA=lf,Rne=Dy,Mne=sa,Une=cf,sA=iA?iA.prototype:void 0,oA=sA?sA.toString:void 0;function IR(e){if(typeof e=="string")return e;if(Mne(e))return Rne(e,IR)+"";if(Une(e))return oA?oA.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var $ne=IR,Lne=$ne;function Bne(e){return e==null?"":Lne(e)}var RR=Bne,Wne=sa,zne=AN,Hne=Pne,Vne=RR;function qne(e,t){return Wne(e)?e:zne(e,t)?[e]:Hne(Vne(e))}var jy=qne,Gne=cf;function Yne(e){if(typeof e=="string"||Gne(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var Yp=Yne,Xne=jy,Kne=Yp;function Zne(e,t){t=Xne(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[Kne(t[r++])];return r&&r==n?e:void 0}var Ny=Zne,Jne=Ny;function Qne(e,t,r){var n=e==null?void 0:Jne(e,t);return n===void 0?r:n}var MR=Qne;const ni=At(MR);function eae(e){return e==null}var tae=eae;const yt=At(tae);var rae=Wo,nae=sa,aae=ys,iae="[object String]";function sae(e){return typeof e=="string"||!nae(e)&&aae(e)&&rae(e)==iae}var oae=sae;const Nl=At(oae);var UR={exports:{}},rr={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IN=Symbol.for("react.element"),RN=Symbol.for("react.portal"),Sy=Symbol.for("react.fragment"),Ey=Symbol.for("react.strict_mode"),Ty=Symbol.for("react.profiler"),ky=Symbol.for("react.provider"),Cy=Symbol.for("react.context"),lae=Symbol.for("react.server_context"),Ay=Symbol.for("react.forward_ref"),Oy=Symbol.for("react.suspense"),Fy=Symbol.for("react.suspense_list"),Py=Symbol.for("react.memo"),Iy=Symbol.for("react.lazy"),cae=Symbol.for("react.offscreen"),$R;$R=Symbol.for("react.module.reference");function Vi(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case IN:switch(e=e.type,e){case Sy:case Ty:case Ey:case Oy:case Fy:return e;default:switch(e=e&&e.$$typeof,e){case lae:case Cy:case Ay:case Iy:case Py:case ky:return e;default:return t}}case RN:return t}}}rr.ContextConsumer=Cy;rr.ContextProvider=ky;rr.Element=IN;rr.ForwardRef=Ay;rr.Fragment=Sy;rr.Lazy=Iy;rr.Memo=Py;rr.Portal=RN;rr.Profiler=Ty;rr.StrictMode=Ey;rr.Suspense=Oy;rr.SuspenseList=Fy;rr.isAsyncMode=function(){return!1};rr.isConcurrentMode=function(){return!1};rr.isContextConsumer=function(e){return Vi(e)===Cy};rr.isContextProvider=function(e){return Vi(e)===ky};rr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===IN};rr.isForwardRef=function(e){return Vi(e)===Ay};rr.isFragment=function(e){return Vi(e)===Sy};rr.isLazy=function(e){return Vi(e)===Iy};rr.isMemo=function(e){return Vi(e)===Py};rr.isPortal=function(e){return Vi(e)===RN};rr.isProfiler=function(e){return Vi(e)===Ty};rr.isStrictMode=function(e){return Vi(e)===Ey};rr.isSuspense=function(e){return Vi(e)===Oy};rr.isSuspenseList=function(e){return Vi(e)===Fy};rr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Sy||e===Ty||e===Ey||e===Oy||e===Fy||e===cae||typeof e=="object"&&e!==null&&(e.$$typeof===Iy||e.$$typeof===Py||e.$$typeof===ky||e.$$typeof===Cy||e.$$typeof===Ay||e.$$typeof===$R||e.getModuleId!==void 0)};rr.typeOf=Vi;UR.exports=rr;var uae=UR.exports,dae=Wo,fae=ys,hae="[object Number]";function mae(e){return typeof e=="number"||fae(e)&&dae(e)==hae}var LR=mae;const BR=At(LR);var pae=LR;function xae(e){return pae(e)&&e!=+e}var gae=xae;const Xp=At(gae);var ga=function(t){return t===0?0:t>0?1:-1},bc=function(t){return Nl(t)&&t.indexOf("%")===t.length-1},Be=function(t){return BR(t)&&!Xp(t)},vae=function(t){return yt(t)},cn=function(t){return Be(t)||Nl(t)},yae=0,mf=function(t){var r=++yae;return"".concat(t||"").concat(r)},va=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Be(t)&&!Nl(t))return n;var i;if(bc(t)){var s=t.indexOf("%");i=r*parseFloat(t.slice(0,s))/100}else i=+t;return Xp(i)&&(i=n),a&&i>r&&(i=r),i},ol=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},bae=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},a=0;a<r;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1},Ar=function(t,r){return Be(t)&&Be(r)?function(n){return t+n*(r-t)}:function(){return r}};function tg(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):ni(n,t))===r})}var wae=function(t,r){return Be(t)&&Be(r)?t-r:Nl(t)&&Nl(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function Ju(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function C_(e){"@babel/helpers - typeof";return C_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C_(e)}var _ae=["viewBox","children"],Dae=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],lA=["points","pathLength"],ew={svg:_ae,polygon:lA,polyline:lA},MN=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],rg=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(M.isValidElement(t)&&(n=t.props),!uf(n))return null;var a={};return Object.keys(n).forEach(function(i){MN.includes(i)&&(a[i]=r||function(s){return n[i](n,s)})}),a},jae=function(t,r,n){return function(a){return t(r,n,a),null}},Sl=function(t,r,n){if(!uf(t)||C_(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(i){var s=t[i];MN.includes(i)&&typeof s=="function"&&(a||(a={}),a[i]=jae(s,r,n))}),a},Nae=["children"],Sae=["children"];function cA(e,t){if(e==null)return{};var r=Eae(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Eae(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function A_(e){"@babel/helpers - typeof";return A_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A_(e)}var uA={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},wo=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},dA=null,tw=null,UN=function e(t){if(t===dA&&Array.isArray(tw))return tw;var r=[];return M.Children.forEach(t,function(n){yt(n)||(uae.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),tw=r,dA=t,r};function Oa(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(a){return wo(a)}):n=[wo(t)],UN(e).forEach(function(a){var i=ni(a,"type.displayName")||ni(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}function Ya(e,t){var r=Oa(e,t);return r&&r[0]}var fA=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,a=r.height;return!(!Be(n)||n<=0||!Be(a)||a<=0)},Tae=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],kae=function(t){return t&&t.type&&Nl(t.type)&&Tae.indexOf(t.type)>=0},Cae=function(t){return t&&A_(t)==="object"&&"clipDot"in t},Aae=function(t,r,n,a){var i,s=(i=ew==null?void 0:ew[a])!==null&&i!==void 0?i:[];return r.startsWith("data-")||!mt(t)&&(a&&s.includes(r)||Dae.includes(r))||n&&MN.includes(r)},ut=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(M.isValidElement(t)&&(a=t.props),!uf(a))return null;var i={};return Object.keys(a).forEach(function(s){var l;Aae((l=a)===null||l===void 0?void 0:l[s],s,r,n)&&(i[s]=a[s])}),i},O_=function e(t,r){if(t===r)return!0;var n=M.Children.count(t);if(n!==M.Children.count(r))return!1;if(n===0)return!0;if(n===1)return hA(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var i=t[a],s=r[a];if(Array.isArray(i)||Array.isArray(s)){if(!e(i,s))return!1}else if(!hA(i,s))return!1}return!0},hA=function(t,r){if(yt(t)&&yt(r))return!0;if(!yt(t)&&!yt(r)){var n=t.props||{},a=n.children,i=cA(n,Nae),s=r.props||{},l=s.children,c=cA(s,Sae);return a&&l?Ju(i,c)&&O_(a,l):!a&&!l?Ju(i,c):!1}return!1},mA=function(t,r){var n=[],a={};return UN(t).forEach(function(i,s){if(kae(i))n.push(i);else if(i){var l=wo(i.type),c=r[l]||{},u=c.handler,d=c.once;if(u&&(!d||!a[l])){var f=u(i,l,s);n.push(f),a[l]=!0}}}),n},Oae=function(t){var r=t&&t.type;return r&&uA[r]?uA[r]:null},Fae=function(t,r){return UN(r).indexOf(t)},Pae=["children","width","height","viewBox","className","style","title","desc"];function F_(){return F_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},F_.apply(this,arguments)}function Iae(e,t){if(e==null)return{};var r=Rae(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Rae(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function P_(e){var t=e.children,r=e.width,n=e.height,a=e.viewBox,i=e.className,s=e.style,l=e.title,c=e.desc,u=Iae(e,Pae),d=a||{width:r,height:n,x:0,y:0},f=vt("recharts-surface",i);return Q.createElement("svg",F_({},ut(u,!0,"svg"),{className:f,width:r,height:n,style:s,viewBox:"".concat(d.x," ").concat(d.y," ").concat(d.width," ").concat(d.height)}),Q.createElement("title",null,l),Q.createElement("desc",null,c),t)}var Mae=["children","className"];function I_(){return I_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},I_.apply(this,arguments)}function Uae(e,t){if(e==null)return{};var r=$ae(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function $ae(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Rt=Q.forwardRef(function(e,t){var r=e.children,n=e.className,a=Uae(e,Mae),i=vt("recharts-layer",n);return Q.createElement("g",I_({className:i},ut(a,!0),{ref:t}),r)}),os=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function Lae(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(a);++n<a;)i[n]=e[n+t];return i}var $N=Lae,Bae=$N;function Wae(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:Bae(e,t,r)}var zae=Wae,Hae="\\ud800-\\udfff",Vae="\\u0300-\\u036f",qae="\\ufe20-\\ufe2f",Gae="\\u20d0-\\u20ff",Yae=Vae+qae+Gae,Xae="\\ufe0e\\ufe0f",Kae="\\u200d",Zae=RegExp("["+Kae+Hae+Yae+Xae+"]");function Jae(e){return Zae.test(e)}var WR=Jae;function Qae(e){return e.split("")}var eie=Qae,zR="\\ud800-\\udfff",tie="\\u0300-\\u036f",rie="\\ufe20-\\ufe2f",nie="\\u20d0-\\u20ff",aie=tie+rie+nie,iie="\\ufe0e\\ufe0f",sie="["+zR+"]",R_="["+aie+"]",M_="\\ud83c[\\udffb-\\udfff]",oie="(?:"+R_+"|"+M_+")",HR="[^"+zR+"]",VR="(?:\\ud83c[\\udde6-\\uddff]){2}",qR="[\\ud800-\\udbff][\\udc00-\\udfff]",lie="\\u200d",GR=oie+"?",YR="["+iie+"]?",cie="(?:"+lie+"(?:"+[HR,VR,qR].join("|")+")"+YR+GR+")*",uie=YR+GR+cie,die="(?:"+[HR+R_+"?",R_,VR,qR,sie].join("|")+")",fie=RegExp(M_+"(?="+M_+")|"+die+uie,"g");function hie(e){return e.match(fie)||[]}var mie=hie,pie=eie,xie=WR,gie=mie;function vie(e){return xie(e)?gie(e):pie(e)}var yie=vie,bie=zae,wie=WR,_ie=yie,Die=RR;function jie(e){return function(t){t=Die(t);var r=wie(t)?_ie(t):void 0,n=r?r[0]:t.charAt(0),a=r?bie(r,1).join(""):t.slice(1);return n[e]()+a}}var Nie=jie,Sie=Nie,Eie=Sie("toUpperCase"),Tie=Eie;const Ry=At(Tie);function fr(e){return function(){return e}}const XR=Math.cos,ng=Math.sin,bs=Math.sqrt,ag=Math.PI,My=2*ag,U_=Math.PI,$_=2*U_,dc=1e-6,kie=$_-dc;function KR(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function Cie(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return KR;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class Aie{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?KR:Cie(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,s){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,l=this._y1,c=n-t,u=a-r,d=s-t,f=l-r,h=d*d+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>dc)if(!(Math.abs(f*c-u*d)>dc)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let m=n-s,x=a-l,p=c*c+u*u,g=m*m+x*x,v=Math.sqrt(p),y=Math.sqrt(h),b=i*Math.tan((U_-Math.acos((p+h-g)/(2*v*y)))/2),w=b/y,_=b/v;Math.abs(w-1)>dc&&this._append`L${t+w*d},${r+w*f}`,this._append`A${i},${i},0,0,${+(f*m>d*x)},${this._x1=t+_*c},${this._y1=r+_*u}`}}arc(t,r,n,a,i,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),c=n*Math.sin(a),u=t+l,d=r+c,f=1^s,h=s?a-i:i-a;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>dc||Math.abs(this._y1-d)>dc)&&this._append`L${u},${d}`,n&&(h<0&&(h=h%$_+$_),h>kie?this._append`A${n},${n},0,1,${f},${t-l},${r-c}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:h>dc&&this._append`A${n},${n},0,${+(h>=U_)},${f},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function LN(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new Aie(t)}function BN(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ZR(e){this._context=e}ZR.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Uy(e){return new ZR(e)}function JR(e){return e[0]}function QR(e){return e[1]}function eM(e,t){var r=fr(!0),n=null,a=Uy,i=null,s=LN(l);e=typeof e=="function"?e:e===void 0?JR:fr(e),t=typeof t=="function"?t:t===void 0?QR:fr(t);function l(c){var u,d=(c=BN(c)).length,f,h=!1,m;for(n==null&&(i=a(m=s())),u=0;u<=d;++u)!(u<d&&r(f=c[u],u,c))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(f,u,c),+t(f,u,c));if(m)return i=null,m+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:fr(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:fr(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:fr(!!c),l):r},l.curve=function(c){return arguments.length?(a=c,n!=null&&(i=a(n)),l):a},l.context=function(c){return arguments.length?(c==null?n=i=null:i=a(n=c),l):n},l}function Mx(e,t,r){var n=null,a=fr(!0),i=null,s=Uy,l=null,c=LN(u);e=typeof e=="function"?e:e===void 0?JR:fr(+e),t=typeof t=="function"?t:fr(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?QR:fr(+r);function u(f){var h,m,x,p=(f=BN(f)).length,g,v=!1,y,b=new Array(p),w=new Array(p);for(i==null&&(l=s(y=c())),h=0;h<=p;++h){if(!(h<p&&a(g=f[h],h,f))===v)if(v=!v)m=h,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),x=h-1;x>=m;--x)l.point(b[x],w[x]);l.lineEnd(),l.areaEnd()}v&&(b[h]=+e(g,h,f),w[h]=+t(g,h,f),l.point(n?+n(g,h,f):b[h],r?+r(g,h,f):w[h]))}if(y)return l=null,y+""||null}function d(){return eM().defined(a).curve(s).context(i)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:fr(+f),n=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:fr(+f),u):e},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:fr(+f),u):n},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:fr(+f),r=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:fr(+f),u):t},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:fr(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(t)},u.defined=function(f){return arguments.length?(a=typeof f=="function"?f:fr(!!f),u):a},u.curve=function(f){return arguments.length?(s=f,i!=null&&(l=s(i)),u):s},u.context=function(f){return arguments.length?(f==null?i=l=null:l=s(i=f),u):i},u}class tM{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function Oie(e){return new tM(e,!0)}function Fie(e){return new tM(e,!1)}const WN={draw(e,t){const r=bs(t/ag);e.moveTo(r,0),e.arc(0,0,r,0,My)}},Pie={draw(e,t){const r=bs(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},rM=bs(1/3),Iie=rM*2,Rie={draw(e,t){const r=bs(t/Iie),n=r*rM;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},Mie={draw(e,t){const r=bs(t),n=-r/2;e.rect(n,n,r,r)}},Uie=.8908130915292852,nM=ng(ag/10)/ng(7*ag/10),$ie=ng(My/10)*nM,Lie=-XR(My/10)*nM,Bie={draw(e,t){const r=bs(t*Uie),n=$ie*r,a=Lie*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const s=My*i/5,l=XR(s),c=ng(s);e.lineTo(c*r,-l*r),e.lineTo(l*n-c*a,c*n+l*a)}e.closePath()}},rw=bs(3),Wie={draw(e,t){const r=-bs(t/(rw*3));e.moveTo(0,r*2),e.lineTo(-rw*r,-r),e.lineTo(rw*r,-r),e.closePath()}},pi=-.5,xi=bs(3)/2,L_=1/bs(12),zie=(L_/2+1)*3,Hie={draw(e,t){const r=bs(t/zie),n=r/2,a=r*L_,i=n,s=r*L_+r,l=-i,c=s;e.moveTo(n,a),e.lineTo(i,s),e.lineTo(l,c),e.lineTo(pi*n-xi*a,xi*n+pi*a),e.lineTo(pi*i-xi*s,xi*i+pi*s),e.lineTo(pi*l-xi*c,xi*l+pi*c),e.lineTo(pi*n+xi*a,pi*a-xi*n),e.lineTo(pi*i+xi*s,pi*s-xi*i),e.lineTo(pi*l+xi*c,pi*c-xi*l),e.closePath()}};function Vie(e,t){let r=null,n=LN(a);e=typeof e=="function"?e:fr(e||WN),t=typeof t=="function"?t:fr(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:fr(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:fr(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function ig(){}function sg(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function aM(e){this._context=e}aM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:sg(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:sg(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function qie(e){return new aM(e)}function iM(e){this._context=e}iM.prototype={areaStart:ig,areaEnd:ig,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:sg(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Gie(e){return new iM(e)}function sM(e){this._context=e}sM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:sg(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Yie(e){return new sM(e)}function oM(e){this._context=e}oM.prototype={areaStart:ig,areaEnd:ig,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Xie(e){return new oM(e)}function pA(e){return e<0?-1:1}function xA(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),s=(r-e._y1)/(a||n<0&&-0),l=(i*a+s*n)/(n+a);return(pA(i)+pA(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(l))||0}function gA(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function nw(e,t,r){var n=e._x0,a=e._y0,i=e._x1,s=e._y1,l=(i-n)/3;e._context.bezierCurveTo(n+l,a+l*t,i-l,s-l*r,i,s)}function og(e){this._context=e}og.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:nw(this,this._t0,gA(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,nw(this,gA(this,r=xA(this,e,t)),r);break;default:nw(this,this._t0,r=xA(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function lM(e){this._context=new cM(e)}(lM.prototype=Object.create(og.prototype)).point=function(e,t){og.prototype.point.call(this,t,e)};function cM(e){this._context=e}cM.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function Kie(e){return new og(e)}function Zie(e){return new lM(e)}function uM(e){this._context=e}uM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=vA(e),a=vA(t),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function vA(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,s[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,s[t]-=n*s[t-1];for(a[r-1]=s[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(s[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function Jie(e){return new uM(e)}function $y(e,t){this._context=e,this._t=t}$y.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function Qie(e){return new $y(e,.5)}function ese(e){return new $y(e,0)}function tse(e){return new $y(e,1)}function md(e,t){if((s=e.length)>1)for(var r=1,n,a,i=e[t[0]],s,l=i.length;r<s;++r)for(a=i,i=e[t[r]],n=0;n<l;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function B_(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function rse(e,t){return e[t]}function nse(e){const t=[];return t.key=e,t}function ase(){var e=fr([]),t=B_,r=md,n=rse;function a(i){var s=Array.from(e.apply(this,arguments),nse),l,c=s.length,u=-1,d;for(const f of i)for(l=0,++u;l<c;++l)(s[l][u]=[0,+n(f,s[l].key,u,i)]).data=f;for(l=0,d=BN(t(s));l<c;++l)s[d[l]].index=l;return r(s,d),s}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:fr(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:fr(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?B_:typeof i=="function"?i:fr(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??md,a):r},a}function ise(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=e[r][a][1]||0;if(s)for(r=0;r<n;++r)e[r][a][1]/=s}md(e,t)}}function sse(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var s=0,l=0;s<a;++s)l+=e[s][r][1]||0;n[r][1]+=n[r][0]=-l/2}md(e,t)}}function ose(e,t){if(!(!((s=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var l=0,c=0,u=0;l<s;++l){for(var d=e[t[l]],f=d[n][1]||0,h=d[n-1][1]||0,m=(f-h)/2,x=0;x<l;++x){var p=e[t[x]],g=p[n][1]||0,v=p[n-1][1]||0;m+=g-v}c+=f,u+=m*f}a[n-1][1]+=a[n-1][0]=r,c&&(r-=u/c)}a[n-1][1]+=a[n-1][0]=r,md(e,t)}}function Jh(e){"@babel/helpers - typeof";return Jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jh(e)}var lse=["type","size","sizeType"];function W_(){return W_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},W_.apply(this,arguments)}function yA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yA(Object(r),!0).forEach(function(n){cse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cse(e,t,r){return t=use(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function use(e){var t=dse(e,"string");return Jh(t)=="symbol"?t:t+""}function dse(e,t){if(Jh(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Jh(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fse(e,t){if(e==null)return{};var r=hse(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function hse(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var dM={symbolCircle:WN,symbolCross:Pie,symbolDiamond:Rie,symbolSquare:Mie,symbolStar:Bie,symbolTriangle:Wie,symbolWye:Hie},mse=Math.PI/180,pse=function(t){var r="symbol".concat(Ry(t));return dM[r]||WN},xse=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*mse;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},gse=function(t,r){dM["symbol".concat(Ry(t))]=r},zN=function(t){var r=t.type,n=r===void 0?"circle":r,a=t.size,i=a===void 0?64:a,s=t.sizeType,l=s===void 0?"area":s,c=fse(t,lse),u=bA(bA({},c),{},{type:n,size:i,sizeType:l}),d=function(){var g=pse(n),v=Vie().type(g).size(xse(i,l,n));return v()},f=u.className,h=u.cx,m=u.cy,x=ut(u,!0);return h===+h&&m===+m&&i===+i?Q.createElement("path",W_({},x,{className:vt("recharts-symbols",f),transform:"translate(".concat(h,", ").concat(m,")"),d:d()})):null};zN.registerSymbol=gse;function pd(e){"@babel/helpers - typeof";return pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pd(e)}function z_(){return z_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},z_.apply(this,arguments)}function wA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function vse(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wA(Object(r),!0).forEach(function(n){Qh(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bse(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hM(n.key),n)}}function wse(e,t,r){return t&&bse(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _se(e,t,r){return t=lg(t),Dse(e,fM()?Reflect.construct(t,r||[],lg(e).constructor):t.apply(e,r))}function Dse(e,t){if(t&&(pd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jse(e)}function jse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fM(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fM=function(){return!!e})()}function lg(e){return lg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lg(e)}function Nse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&H_(e,t)}function H_(e,t){return H_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},H_(e,t)}function Qh(e,t,r){return t=hM(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hM(e){var t=Sse(e,"string");return pd(t)=="symbol"?t:t+""}function Sse(e,t){if(pd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(pd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var gi=32,HN=function(e){function t(){return yse(this,t),_se(this,t,arguments)}return Nse(t,e),wse(t,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,i=gi/2,s=gi/6,l=gi/3,c=n.inactive?a:n.color;if(n.type==="plainline")return Q.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:i,x2:gi,y2:i,className:"recharts-legend-icon"});if(n.type==="line")return Q.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(i,"h").concat(l,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*l,",").concat(i,`
            H`).concat(gi,"M").concat(2*l,",").concat(i,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(l,",").concat(i),className:"recharts-legend-icon"});if(n.type==="rect")return Q.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(gi/8,"h").concat(gi,"v").concat(gi*3/4,"h").concat(-gi,"z"),className:"recharts-legend-icon"});if(Q.isValidElement(n.legendIcon)){var u=vse({},n);return delete u.legendIcon,Q.cloneElement(n.legendIcon,u)}return Q.createElement(zN,{fill:c,cx:i,cy:i,size:gi,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,i=a.payload,s=a.iconSize,l=a.layout,c=a.formatter,u=a.inactiveColor,d={x:0,y:0,width:gi,height:gi},f={display:l==="horizontal"?"inline-block":"block",marginRight:10},h={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(m,x){var p=m.formatter||c,g=vt(Qh(Qh({"recharts-legend-item":!0},"legend-item-".concat(x),!0),"inactive",m.inactive));if(m.type==="none")return null;var v=mt(m.value)?null:m.value;os(!mt(m.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var y=m.inactive?u:m.color;return Q.createElement("li",z_({className:g,style:f,key:"legend-item-".concat(x)},Sl(n.props,m,x)),Q.createElement(P_,{width:s,height:s,viewBox:d,style:h},n.renderIcon(m)),Q.createElement("span",{className:"recharts-legend-item-text",style:{color:y}},p?p(v,m,x):v))})}},{key:"render",value:function(){var n=this.props,a=n.payload,i=n.layout,s=n.align;if(!a||!a.length)return null;var l={padding:0,margin:0,textAlign:i==="horizontal"?s:"left"};return Q.createElement("ul",{className:"recharts-default-legend",style:l},this.renderItems())}}])}(M.PureComponent);Qh(HN,"displayName","Legend");Qh(HN,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var Ese=wy;function Tse(){this.__data__=new Ese,this.size=0}var kse=Tse;function Cse(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var Ase=Cse;function Ose(e){return this.__data__.get(e)}var Fse=Ose;function Pse(e){return this.__data__.has(e)}var Ise=Pse,Rse=wy,Mse=ON,Use=FN,$se=200;function Lse(e,t){var r=this.__data__;if(r instanceof Rse){var n=r.__data__;if(!Mse||n.length<$se-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Use(n)}return r.set(e,t),this.size=r.size,this}var Bse=Lse,Wse=wy,zse=kse,Hse=Ase,Vse=Fse,qse=Ise,Gse=Bse;function pf(e){var t=this.__data__=new Wse(e);this.size=t.size}pf.prototype.clear=zse;pf.prototype.delete=Hse;pf.prototype.get=Vse;pf.prototype.has=qse;pf.prototype.set=Gse;var VN=pf,Yse="__lodash_hash_undefined__";function Xse(e){return this.__data__.set(e,Yse),this}var Kse=Xse;function Zse(e){return this.__data__.has(e)}var Jse=Zse,Qse=FN,eoe=Kse,toe=Jse;function cg(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new Qse;++t<r;)this.add(e[t])}cg.prototype.add=cg.prototype.push=eoe;cg.prototype.has=toe;var mM=cg;function roe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var pM=roe;function noe(e,t){return e.has(t)}var xM=noe,aoe=mM,ioe=pM,soe=xM,ooe=1,loe=2;function coe(e,t,r,n,a,i){var s=r&ooe,l=e.length,c=t.length;if(l!=c&&!(s&&c>l))return!1;var u=i.get(e),d=i.get(t);if(u&&d)return u==t&&d==e;var f=-1,h=!0,m=r&loe?new aoe:void 0;for(i.set(e,t),i.set(t,e);++f<l;){var x=e[f],p=t[f];if(n)var g=s?n(p,x,f,t,e,i):n(x,p,f,e,t,i);if(g!==void 0){if(g)continue;h=!1;break}if(m){if(!ioe(t,function(v,y){if(!soe(m,y)&&(x===v||a(x,v,r,n,i)))return m.push(y)})){h=!1;break}}else if(!(x===p||a(x,p,r,n,i))){h=!1;break}}return i.delete(e),i.delete(t),h}var gM=coe,uoe=vs,doe=uoe.Uint8Array,vM=doe;function foe(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r}var hoe=foe;function moe(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var qN=moe,_A=lf,DA=vM,poe=Gp,xoe=gM,goe=hoe,voe=qN,yoe=1,boe=2,woe="[object Boolean]",_oe="[object Date]",Doe="[object Error]",joe="[object Map]",Noe="[object Number]",Soe="[object RegExp]",Eoe="[object Set]",Toe="[object String]",koe="[object Symbol]",Coe="[object ArrayBuffer]",Aoe="[object DataView]",jA=_A?_A.prototype:void 0,aw=jA?jA.valueOf:void 0;function Ooe(e,t,r,n,a,i,s){switch(r){case Aoe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Coe:return!(e.byteLength!=t.byteLength||!i(new DA(e),new DA(t)));case woe:case _oe:case Noe:return poe(+e,+t);case Doe:return e.name==t.name&&e.message==t.message;case Soe:case Toe:return e==t+"";case joe:var l=goe;case Eoe:var c=n&yoe;if(l||(l=voe),e.size!=t.size&&!c)return!1;var u=s.get(e);if(u)return u==t;n|=boe,s.set(e,t);var d=xoe(l(e),l(t),n,a,i,s);return s.delete(e),d;case koe:if(aw)return aw.call(e)==aw.call(t)}return!1}var Foe=Ooe;function Poe(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var GN=Poe,Ioe=GN,Roe=sa;function Moe(e,t,r){var n=t(e);return Roe(e)?n:Ioe(n,r(e))}var yM=Moe;function Uoe(e,t){for(var r=-1,n=e==null?0:e.length,a=0,i=[];++r<n;){var s=e[r];t(s,r,e)&&(i[a++]=s)}return i}var $oe=Uoe;function Loe(){return[]}var bM=Loe,Boe=$oe,Woe=bM,zoe=Object.prototype,Hoe=zoe.propertyIsEnumerable,NA=Object.getOwnPropertySymbols,Voe=NA?function(e){return e==null?[]:(e=Object(e),Boe(NA(e),function(t){return Hoe.call(e,t)}))}:Woe,YN=Voe;function qoe(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var Goe=qoe,Yoe=Wo,Xoe=ys,Koe="[object Arguments]";function Zoe(e){return Xoe(e)&&Yoe(e)==Koe}var Joe=Zoe,SA=Joe,Qoe=ys,wM=Object.prototype,ele=wM.hasOwnProperty,tle=wM.propertyIsEnumerable,rle=SA(function(){return arguments}())?SA:function(e){return Qoe(e)&&ele.call(e,"callee")&&!tle.call(e,"callee")},XN=rle,ug={exports:{}};function nle(){return!1}var ale=nle;ug.exports;(function(e,t){var r=vs,n=ale,a=t&&!t.nodeType&&t,i=a&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===a,l=s?r.Buffer:void 0,c=l?l.isBuffer:void 0,u=c||n;e.exports=u})(ug,ug.exports);var Ly=ug.exports,ile=9007199254740991,sle=/^(?:0|[1-9]\d*)$/;function ole(e,t){var r=typeof e;return t=t??ile,!!t&&(r=="number"||r!="symbol"&&sle.test(e))&&e>-1&&e%1==0&&e<t}var KN=ole,lle=9007199254740991;function cle(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=lle}var ZN=cle,ule=Wo,dle=ZN,fle=ys,hle="[object Arguments]",mle="[object Array]",ple="[object Boolean]",xle="[object Date]",gle="[object Error]",vle="[object Function]",yle="[object Map]",ble="[object Number]",wle="[object Object]",_le="[object RegExp]",Dle="[object Set]",jle="[object String]",Nle="[object WeakMap]",Sle="[object ArrayBuffer]",Ele="[object DataView]",Tle="[object Float32Array]",kle="[object Float64Array]",Cle="[object Int8Array]",Ale="[object Int16Array]",Ole="[object Int32Array]",Fle="[object Uint8Array]",Ple="[object Uint8ClampedArray]",Ile="[object Uint16Array]",Rle="[object Uint32Array]",gr={};gr[Tle]=gr[kle]=gr[Cle]=gr[Ale]=gr[Ole]=gr[Fle]=gr[Ple]=gr[Ile]=gr[Rle]=!0;gr[hle]=gr[mle]=gr[Sle]=gr[ple]=gr[Ele]=gr[xle]=gr[gle]=gr[vle]=gr[yle]=gr[ble]=gr[wle]=gr[_le]=gr[Dle]=gr[jle]=gr[Nle]=!1;function Mle(e){return fle(e)&&dle(e.length)&&!!gr[ule(e)]}var Ule=Mle;function $le(e){return function(t){return e(t)}}var By=$le,dg={exports:{}};dg.exports;(function(e,t){var r=CR,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,s=i&&r.process,l=function(){try{var c=a&&a.require&&a.require("util").types;return c||s&&s.binding&&s.binding("util")}catch{}}();e.exports=l})(dg,dg.exports);var JN=dg.exports,Lle=Ule,Ble=By,EA=JN,TA=EA&&EA.isTypedArray,Wle=TA?Ble(TA):Lle,QN=Wle,zle=Goe,Hle=XN,Vle=sa,qle=Ly,Gle=KN,Yle=QN,Xle=Object.prototype,Kle=Xle.hasOwnProperty;function Zle(e,t){var r=Vle(e),n=!r&&Hle(e),a=!r&&!n&&qle(e),i=!r&&!n&&!a&&Yle(e),s=r||n||a||i,l=s?zle(e.length,String):[],c=l.length;for(var u in e)(t||Kle.call(e,u))&&!(s&&(u=="length"||a&&(u=="offset"||u=="parent")||i&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||Gle(u,c)))&&l.push(u);return l}var _M=Zle,Jle=Object.prototype;function Qle(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||Jle;return e===r}var eS=Qle;function ece(e,t){return function(r){return e(t(r))}}var DM=ece,tce=DM,rce=tce(Object.keys,Object),nce=rce,ace=eS,ice=nce,sce=Object.prototype,oce=sce.hasOwnProperty;function lce(e){if(!ace(e))return ice(e);var t=[];for(var r in Object(e))oce.call(e,r)&&r!="constructor"&&t.push(r);return t}var cce=lce,uce=vy,dce=ZN;function fce(e){return e!=null&&dce(e.length)&&!uce(e)}var xf=fce,hce=_M,mce=cce,pce=xf;function xce(e){return pce(e)?hce(e):mce(e)}var gf=xce,gce=yM,vce=YN,yce=gf;function bce(e){return gce(e,yce,vce)}var jM=bce,kA=jM,wce=1,_ce=Object.prototype,Dce=_ce.hasOwnProperty;function jce(e,t,r,n,a,i){var s=r&wce,l=kA(e),c=l.length,u=kA(t),d=u.length;if(c!=d&&!s)return!1;for(var f=c;f--;){var h=l[f];if(!(s?h in t:Dce.call(t,h)))return!1}var m=i.get(e),x=i.get(t);if(m&&x)return m==t&&x==e;var p=!0;i.set(e,t),i.set(t,e);for(var g=s;++f<c;){h=l[f];var v=e[h],y=t[h];if(n)var b=s?n(y,v,h,t,e,i):n(v,y,h,e,t,i);if(!(b===void 0?v===y||a(v,y,r,n,i):b)){p=!1;break}g||(g=h=="constructor")}if(p&&!g){var w=e.constructor,_=t.constructor;w!=_&&"constructor"in e&&"constructor"in t&&!(typeof w=="function"&&w instanceof w&&typeof _=="function"&&_ instanceof _)&&(p=!1)}return i.delete(e),i.delete(t),p}var Nce=jce,Sce=iu,Ece=vs,Tce=Sce(Ece,"DataView"),kce=Tce,Cce=iu,Ace=vs,Oce=Cce(Ace,"Promise"),Fce=Oce,Pce=iu,Ice=vs,Rce=Pce(Ice,"Set"),NM=Rce,Mce=iu,Uce=vs,$ce=Mce(Uce,"WeakMap"),Lce=$ce,V_=kce,q_=ON,G_=Fce,Y_=NM,X_=Lce,SM=Wo,vf=OR,CA="[object Map]",Bce="[object Object]",AA="[object Promise]",OA="[object Set]",FA="[object WeakMap]",PA="[object DataView]",Wce=vf(V_),zce=vf(q_),Hce=vf(G_),Vce=vf(Y_),qce=vf(X_),fc=SM;(V_&&fc(new V_(new ArrayBuffer(1)))!=PA||q_&&fc(new q_)!=CA||G_&&fc(G_.resolve())!=AA||Y_&&fc(new Y_)!=OA||X_&&fc(new X_)!=FA)&&(fc=function(e){var t=SM(e),r=t==Bce?e.constructor:void 0,n=r?vf(r):"";if(n)switch(n){case Wce:return PA;case zce:return CA;case Hce:return AA;case Vce:return OA;case qce:return FA}return t});var Wy=fc,iw=VN,Gce=gM,Yce=Foe,Xce=Nce,IA=Wy,RA=sa,MA=Ly,Kce=QN,Zce=1,UA="[object Arguments]",$A="[object Array]",Ux="[object Object]",Jce=Object.prototype,LA=Jce.hasOwnProperty;function Qce(e,t,r,n,a,i){var s=RA(e),l=RA(t),c=s?$A:IA(e),u=l?$A:IA(t);c=c==UA?Ux:c,u=u==UA?Ux:u;var d=c==Ux,f=u==Ux,h=c==u;if(h&&MA(e)){if(!MA(t))return!1;s=!0,d=!1}if(h&&!d)return i||(i=new iw),s||Kce(e)?Gce(e,t,r,n,a,i):Yce(e,t,c,r,n,a,i);if(!(r&Zce)){var m=d&&LA.call(e,"__wrapped__"),x=f&&LA.call(t,"__wrapped__");if(m||x){var p=m?e.value():e,g=x?t.value():t;return i||(i=new iw),a(p,g,r,n,i)}}return h?(i||(i=new iw),Xce(e,t,r,n,a,i)):!1}var eue=Qce,tue=eue,BA=ys;function EM(e,t,r,n,a){return e===t?!0:e==null||t==null||!BA(e)&&!BA(t)?e!==e&&t!==t:tue(e,t,r,n,EM,a)}var tS=EM,rue=VN,nue=tS,aue=1,iue=2;function sue(e,t,r,n){var a=r.length,i=a,s=!n;if(e==null)return!i;for(e=Object(e);a--;){var l=r[a];if(s&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++a<i;){l=r[a];var c=l[0],u=e[c],d=l[1];if(s&&l[2]){if(u===void 0&&!(c in e))return!1}else{var f=new rue;if(n)var h=n(u,d,c,e,t,f);if(!(h===void 0?nue(d,u,aue|iue,n,f):h))return!1}}return!0}var oue=sue,lue=Hi;function cue(e){return e===e&&!lue(e)}var TM=cue,uue=TM,due=gf;function fue(e){for(var t=due(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,uue(a)]}return t}var hue=fue;function mue(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var kM=mue,pue=oue,xue=hue,gue=kM;function vue(e){var t=xue(e);return t.length==1&&t[0][2]?gue(t[0][0],t[0][1]):function(r){return r===e||pue(r,e,t)}}var yue=vue;function bue(e,t){return e!=null&&t in Object(e)}var wue=bue,_ue=jy,Due=XN,jue=sa,Nue=KN,Sue=ZN,Eue=Yp;function Tue(e,t,r){t=_ue(t,e);for(var n=-1,a=t.length,i=!1;++n<a;){var s=Eue(t[n]);if(!(i=e!=null&&r(e,s)))break;e=e[s]}return i||++n!=a?i:(a=e==null?0:e.length,!!a&&Sue(a)&&Nue(s,a)&&(jue(e)||Due(e)))}var kue=Tue,Cue=wue,Aue=kue;function Oue(e,t){return e!=null&&Aue(e,t,Cue)}var Fue=Oue,Pue=tS,Iue=MR,Rue=Fue,Mue=AN,Uue=TM,$ue=kM,Lue=Yp,Bue=1,Wue=2;function zue(e,t){return Mue(e)&&Uue(t)?$ue(Lue(e),t):function(r){var n=Iue(r,e);return n===void 0&&n===t?Rue(r,e):Pue(t,n,Bue|Wue)}}var Hue=zue;function Vue(e){return e}var yf=Vue;function que(e){return function(t){return t==null?void 0:t[e]}}var Gue=que,Yue=Ny;function Xue(e){return function(t){return Yue(t,e)}}var Kue=Xue,Zue=Gue,Jue=Kue,Que=AN,ede=Yp;function tde(e){return Que(e)?Zue(ede(e)):Jue(e)}var rde=tde,nde=yue,ade=Hue,ide=yf,sde=sa,ode=rde;function lde(e){return typeof e=="function"?e:e==null?ide:typeof e=="object"?sde(e)?ade(e[0],e[1]):nde(e):ode(e)}var ws=lde;function cde(e,t,r,n){for(var a=e.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1}var CM=cde;function ude(e){return e!==e}var dde=ude;function fde(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}var hde=fde,mde=CM,pde=dde,xde=hde;function gde(e,t,r){return t===t?xde(e,t,r):mde(e,pde,r)}var vde=gde,yde=vde;function bde(e,t){var r=e==null?0:e.length;return!!r&&yde(e,t,0)>-1}var wde=bde;function _de(e,t,r){for(var n=-1,a=e==null?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}var Dde=_de;function jde(){}var Nde=jde,sw=NM,Sde=Nde,Ede=qN,Tde=1/0,kde=sw&&1/Ede(new sw([,-0]))[1]==Tde?function(e){return new sw(e)}:Sde,Cde=kde,Ade=mM,Ode=wde,Fde=Dde,Pde=xM,Ide=Cde,Rde=qN,Mde=200;function Ude(e,t,r){var n=-1,a=Ode,i=e.length,s=!0,l=[],c=l;if(r)s=!1,a=Fde;else if(i>=Mde){var u=t?null:Ide(e);if(u)return Rde(u);s=!1,a=Pde,c=new Ade}else c=t?[]:l;e:for(;++n<i;){var d=e[n],f=t?t(d):d;if(d=r||d!==0?d:0,s&&f===f){for(var h=c.length;h--;)if(c[h]===f)continue e;t&&c.push(f),l.push(d)}else a(c,f,r)||(c!==l&&c.push(f),l.push(d))}return l}var $de=Ude,Lde=ws,Bde=$de;function Wde(e,t){return e&&e.length?Bde(e,Lde(t)):[]}var zde=Wde;const WA=At(zde);function AM(e,t,r){return t===!0?WA(e,r):mt(t)?WA(e,t):e}function xd(e){"@babel/helpers - typeof";return xd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xd(e)}var Hde=["ref"];function zA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function no(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zA(Object(r),!0).forEach(function(n){zy(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Vde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FM(n.key),n)}}function qde(e,t,r){return t&&HA(e.prototype,t),r&&HA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gde(e,t,r){return t=fg(t),Yde(e,OM()?Reflect.construct(t,r||[],fg(e).constructor):t.apply(e,r))}function Yde(e,t){if(t&&(xd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xde(e)}function Xde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OM(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(OM=function(){return!!e})()}function fg(e){return fg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fg(e)}function Kde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&K_(e,t)}function K_(e,t){return K_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},K_(e,t)}function zy(e,t,r){return t=FM(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FM(e){var t=Zde(e,"string");return xd(t)=="symbol"?t:t+""}function Zde(e,t){if(xd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(xd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Jde(e,t){if(e==null)return{};var r=Qde(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Qde(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function efe(e){return e.value}function tfe(e,t){if(Q.isValidElement(e))return Q.cloneElement(e,t);if(typeof e=="function")return Q.createElement(e,t);t.ref;var r=Jde(t,Hde);return Q.createElement(HN,r)}var VA=1,vl=function(e){function t(){var r;Vde(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=Gde(this,t,[].concat(a)),zy(r,"lastBoundingBox",{width:-1,height:-1}),r}return Kde(t,e),qde(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>VA||Math.abs(a.height-this.lastBoundingBox.height)>VA)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?no({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,i=a.layout,s=a.align,l=a.verticalAlign,c=a.margin,u=a.chartWidth,d=a.chartHeight,f,h;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(s==="center"&&i==="vertical"){var m=this.getBBoxSnapshot();f={left:((u||0)-m.width)/2}}else f=s==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(l==="middle"){var x=this.getBBoxSnapshot();h={top:((d||0)-x.height)/2}}else h=l==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return no(no({},f),h)}},{key:"render",value:function(){var n=this,a=this.props,i=a.content,s=a.width,l=a.height,c=a.wrapperStyle,u=a.payloadUniqBy,d=a.payload,f=no(no({position:"absolute",width:s||"auto",height:l||"auto"},this.getDefaultPosition(c)),c);return Q.createElement("div",{className:"recharts-legend-wrapper",style:f,ref:function(m){n.wrapperNode=m}},tfe(i,no(no({},this.props),{},{payload:AM(d,u,efe)})))}}],[{key:"getWithHeight",value:function(n,a){var i=no(no({},this.defaultProps),n.props),s=i.layout;return s==="vertical"&&Be(n.props.height)?{height:n.props.height}:s==="horizontal"?{width:n.props.width||a}:null}}])}(M.PureComponent);zy(vl,"displayName","Legend");zy(vl,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var qA=lf,rfe=XN,nfe=sa,GA=qA?qA.isConcatSpreadable:void 0;function afe(e){return nfe(e)||rfe(e)||!!(GA&&e&&e[GA])}var ife=afe,sfe=GN,ofe=ife;function PM(e,t,r,n,a){var i=-1,s=e.length;for(r||(r=ofe),a||(a=[]);++i<s;){var l=e[i];t>0&&r(l)?t>1?PM(l,t-1,r,n,a):sfe(a,l):n||(a[a.length]=l)}return a}var rS=PM;function lfe(e){return function(t,r,n){for(var a=-1,i=Object(t),s=n(t),l=s.length;l--;){var c=s[e?l:++a];if(r(i[c],c,i)===!1)break}return t}}var cfe=lfe,ufe=cfe,dfe=ufe(),ffe=dfe,hfe=ffe,mfe=gf;function pfe(e,t){return e&&hfe(e,t,mfe)}var nS=pfe,xfe=xf;function gfe(e,t){return function(r,n){if(r==null)return r;if(!xfe(r))return e(r,n);for(var a=r.length,i=t?a:-1,s=Object(r);(t?i--:++i<a)&&n(s[i],i,s)!==!1;);return r}}var vfe=gfe,yfe=nS,bfe=vfe,wfe=bfe(yfe),aS=wfe,_fe=aS,Dfe=xf;function jfe(e,t){var r=-1,n=Dfe(e)?Array(e.length):[];return _fe(e,function(a,i,s){n[++r]=t(a,i,s)}),n}var IM=jfe;function Nfe(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var Sfe=Nfe,YA=cf;function Efe(e,t){if(e!==t){var r=e!==void 0,n=e===null,a=e===e,i=YA(e),s=t!==void 0,l=t===null,c=t===t,u=YA(t);if(!l&&!u&&!i&&e>t||i&&s&&c&&!l&&!u||n&&s&&c||!r&&c||!a)return 1;if(!n&&!i&&!u&&e<t||u&&r&&a&&!n&&!i||l&&r&&a||!s&&a||!c)return-1}return 0}var Tfe=Efe,kfe=Tfe;function Cfe(e,t,r){for(var n=-1,a=e.criteria,i=t.criteria,s=a.length,l=r.length;++n<s;){var c=kfe(a[n],i[n]);if(c){if(n>=l)return c;var u=r[n];return c*(u=="desc"?-1:1)}}return e.index-t.index}var Afe=Cfe,ow=Dy,Ofe=Ny,Ffe=ws,Pfe=IM,Ife=Sfe,Rfe=By,Mfe=Afe,Ufe=yf,$fe=sa;function Lfe(e,t,r){t.length?t=ow(t,function(i){return $fe(i)?function(s){return Ofe(s,i.length===1?i[0]:i)}:i}):t=[Ufe];var n=-1;t=ow(t,Rfe(Ffe));var a=Pfe(e,function(i,s,l){var c=ow(t,function(u){return u(i)});return{criteria:c,index:++n,value:i}});return Ife(a,function(i,s){return Mfe(i,s,r)})}var Bfe=Lfe;function Wfe(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var zfe=Wfe,Hfe=zfe,XA=Math.max;function Vfe(e,t,r){return t=XA(t===void 0?e.length-1:t,0),function(){for(var n=arguments,a=-1,i=XA(n.length-t,0),s=Array(i);++a<i;)s[a]=n[t+a];a=-1;for(var l=Array(t+1);++a<t;)l[a]=n[a];return l[t]=r(s),Hfe(e,this,l)}}var RM=Vfe;function qfe(e){return function(){return e}}var Gfe=qfe,Yfe=iu,Xfe=function(){try{var e=Yfe(Object,"defineProperty");return e({},"",{}),e}catch{}}(),MM=Xfe,Kfe=Gfe,KA=MM,Zfe=yf,Jfe=KA?function(e,t){return KA(e,"toString",{configurable:!0,enumerable:!1,value:Kfe(t),writable:!0})}:Zfe,Qfe=Jfe,ehe=800,the=16,rhe=Date.now;function nhe(e){var t=0,r=0;return function(){var n=rhe(),a=the-(n-r);if(r=n,a>0){if(++t>=ehe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var ahe=nhe,ihe=Qfe,she=ahe,ohe=she(ihe),UM=ohe,lhe=yf,che=RM,uhe=UM;function dhe(e,t){return uhe(che(e,t,lhe),e+"")}var $M=dhe,fhe=Gp,hhe=xf,mhe=KN,phe=Hi;function xhe(e,t,r){if(!phe(r))return!1;var n=typeof t;return(n=="number"?hhe(r)&&mhe(t,r.length):n=="string"&&t in r)?fhe(r[t],e):!1}var bf=xhe,ghe=rS,vhe=Bfe,yhe=$M,ZA=bf,bhe=yhe(function(e,t){if(e==null)return[];var r=t.length;return r>1&&ZA(e,t[0],t[1])?t=[]:r>2&&ZA(t[0],t[1],t[2])&&(t=[t[0]]),vhe(e,ghe(t,1),[])}),whe=bhe;const Hy=At(whe);function em(e){"@babel/helpers - typeof";return em=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},em(e)}function Z_(){return Z_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Z_.apply(this,arguments)}function _he(e,t){return She(e)||Nhe(e,t)||jhe(e,t)||Dhe()}function Dhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jhe(e,t){if(e){if(typeof e=="string")return JA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JA(e,t)}}function JA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Nhe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function She(e){if(Array.isArray(e))return e}function QA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function lw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QA(Object(r),!0).forEach(function(n){Ehe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ehe(e,t,r){return t=The(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function The(e){var t=khe(e,"string");return em(t)=="symbol"?t:t+""}function khe(e,t){if(em(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(em(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Che(e){return Array.isArray(e)&&cn(e[0])&&cn(e[1])?e.join(" ~ "):e}var Ahe=function(t){var r=t.separator,n=r===void 0?" : ":r,a=t.contentStyle,i=a===void 0?{}:a,s=t.itemStyle,l=s===void 0?{}:s,c=t.labelStyle,u=c===void 0?{}:c,d=t.payload,f=t.formatter,h=t.itemSorter,m=t.wrapperClassName,x=t.labelClassName,p=t.label,g=t.labelFormatter,v=t.accessibilityLayer,y=v===void 0?!1:v,b=function(){if(d&&d.length){var T={padding:0,margin:0},L=(h?Hy(d,h):d).map(function(O,V){if(O.type==="none")return null;var W=lw({display:"block",paddingTop:4,paddingBottom:4,color:O.color||"#000"},l),B=O.formatter||f||Che,P=O.value,F=O.name,I=P,R=F;if(B&&I!=null&&R!=null){var C=B(P,F,O,V,d);if(Array.isArray(C)){var k=_he(C,2);I=k[0],R=k[1]}else I=C}return Q.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(V),style:W},cn(R)?Q.createElement("span",{className:"recharts-tooltip-item-name"},R):null,cn(R)?Q.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,Q.createElement("span",{className:"recharts-tooltip-item-value"},I),Q.createElement("span",{className:"recharts-tooltip-item-unit"},O.unit||""))});return Q.createElement("ul",{className:"recharts-tooltip-item-list",style:T},L)}return null},w=lw({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),_=lw({margin:0},u),D=!yt(p),j=D?p:"",N=vt("recharts-default-tooltip",m),S=vt("recharts-tooltip-label",x);D&&g&&d!==void 0&&d!==null&&(j=g(p,d));var E=y?{role:"status","aria-live":"assertive"}:{};return Q.createElement("div",Z_({className:N,style:w},E),Q.createElement("p",{className:S,style:_},Q.isValidElement(j)?j:"".concat(j)),b())};function tm(e){"@babel/helpers - typeof";return tm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tm(e)}function $x(e,t,r){return t=Ohe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ohe(e){var t=Fhe(e,"string");return tm(t)=="symbol"?t:t+""}function Fhe(e,t){if(tm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(tm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zf="recharts-tooltip-wrapper",Phe={visibility:"hidden"};function Ihe(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return vt(Zf,$x($x($x($x({},"".concat(Zf,"-right"),Be(r)&&t&&Be(t.x)&&r>=t.x),"".concat(Zf,"-left"),Be(r)&&t&&Be(t.x)&&r<t.x),"".concat(Zf,"-bottom"),Be(n)&&t&&Be(t.y)&&n>=t.y),"".concat(Zf,"-top"),Be(n)&&t&&Be(t.y)&&n<t.y))}function e3(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,a=e.offsetTopLeft,i=e.position,s=e.reverseDirection,l=e.tooltipDimension,c=e.viewBox,u=e.viewBoxDimension;if(i&&Be(i[n]))return i[n];var d=r[n]-l-a,f=r[n]+a;if(t[n])return s[n]?d:f;if(s[n]){var h=d,m=c[n];return h<m?Math.max(f,c[n]):Math.max(d,c[n])}var x=f+l,p=c[n]+u;return x>p?Math.max(d,c[n]):Math.max(f,c[n])}function Rhe(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function Mhe(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,a=e.position,i=e.reverseDirection,s=e.tooltipBox,l=e.useTranslate3d,c=e.viewBox,u,d,f;return s.height>0&&s.width>0&&r?(d=e3({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.width,viewBox:c,viewBoxDimension:c.width}),f=e3({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.height,viewBox:c,viewBoxDimension:c.height}),u=Rhe({translateX:d,translateY:f,useTranslate3d:l})):u=Phe,{cssProperties:u,cssClasses:Ihe({translateX:d,translateY:f,coordinate:r})}}function gd(e){"@babel/helpers - typeof";return gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gd(e)}function t3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function r3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t3(Object(r),!0).forEach(function(n){Q_(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Uhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $he(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BM(n.key),n)}}function Lhe(e,t,r){return t&&$he(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bhe(e,t,r){return t=hg(t),Whe(e,LM()?Reflect.construct(t,r||[],hg(e).constructor):t.apply(e,r))}function Whe(e,t){if(t&&(gd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zhe(e)}function zhe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LM(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(LM=function(){return!!e})()}function hg(e){return hg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hg(e)}function Hhe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&J_(e,t)}function J_(e,t){return J_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},J_(e,t)}function Q_(e,t,r){return t=BM(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BM(e){var t=Vhe(e,"string");return gd(t)=="symbol"?t:t+""}function Vhe(e,t){if(gd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(gd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var n3=1,qhe=function(e){function t(){var r;Uhe(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=Bhe(this,t,[].concat(a)),Q_(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),Q_(r,"handleKeyDown",function(s){if(s.key==="Escape"){var l,c,u,d;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(l=(c=r.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&l!==void 0?l:0,y:(u=(d=r.props.coordinate)===null||d===void 0?void 0:d.y)!==null&&u!==void 0?u:0}})}}),r}return Hhe(t,e),Lhe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>n3||Math.abs(n.height-this.state.lastBoundingBox.height)>n3)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,i=a.active,s=a.allowEscapeViewBox,l=a.animationDuration,c=a.animationEasing,u=a.children,d=a.coordinate,f=a.hasPayload,h=a.isAnimationActive,m=a.offset,x=a.position,p=a.reverseDirection,g=a.useTranslate3d,v=a.viewBox,y=a.wrapperStyle,b=Mhe({allowEscapeViewBox:s,coordinate:d,offsetTopLeft:m,position:x,reverseDirection:p,tooltipBox:this.state.lastBoundingBox,useTranslate3d:g,viewBox:v}),w=b.cssClasses,_=b.cssProperties,D=r3(r3({transition:h&&i?"transform ".concat(l,"ms ").concat(c):void 0},_),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&f?"visible":"hidden",position:"absolute",top:0,left:0},y);return Q.createElement("div",{tabIndex:-1,className:w,style:D,ref:function(N){n.wrapperNode=N}},u)}}])}(M.PureComponent),Ghe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Ul={isSsr:Ghe()};function vd(e){"@babel/helpers - typeof";return vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vd(e)}function a3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function i3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a3(Object(r),!0).forEach(function(n){iS(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Yhe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xhe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zM(n.key),n)}}function Khe(e,t,r){return t&&Xhe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zhe(e,t,r){return t=mg(t),Jhe(e,WM()?Reflect.construct(t,r||[],mg(e).constructor):t.apply(e,r))}function Jhe(e,t){if(t&&(vd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qhe(e)}function Qhe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WM(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(WM=function(){return!!e})()}function mg(e){return mg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mg(e)}function eme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eD(e,t)}function eD(e,t){return eD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},eD(e,t)}function iS(e,t,r){return t=zM(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zM(e){var t=tme(e,"string");return vd(t)=="symbol"?t:t+""}function tme(e,t){if(vd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(vd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function rme(e){return e.dataKey}function nme(e,t){return Q.isValidElement(e)?Q.cloneElement(e,t):typeof e=="function"?Q.createElement(e,t):Q.createElement(Ahe,t)}var Rr=function(e){function t(){return Yhe(this,t),Zhe(this,t,arguments)}return eme(t,e),Khe(t,[{key:"render",value:function(){var n=this,a=this.props,i=a.active,s=a.allowEscapeViewBox,l=a.animationDuration,c=a.animationEasing,u=a.content,d=a.coordinate,f=a.filterNull,h=a.isAnimationActive,m=a.offset,x=a.payload,p=a.payloadUniqBy,g=a.position,v=a.reverseDirection,y=a.useTranslate3d,b=a.viewBox,w=a.wrapperStyle,_=x??[];f&&_.length&&(_=AM(x.filter(function(j){return j.value!=null&&(j.hide!==!0||n.props.includeHidden)}),p,rme));var D=_.length>0;return Q.createElement(qhe,{allowEscapeViewBox:s,animationDuration:l,animationEasing:c,isAnimationActive:h,active:i,coordinate:d,hasPayload:D,offset:m,position:g,reverseDirection:v,useTranslate3d:y,viewBox:b,wrapperStyle:w},nme(u,i3(i3({},this.props),{},{payload:_})))}}])}(M.PureComponent);iS(Rr,"displayName","Tooltip");iS(Rr,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Ul.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var ame=vs,ime=function(){return ame.Date.now()},sme=ime,ome=/\s/;function lme(e){for(var t=e.length;t--&&ome.test(e.charAt(t)););return t}var cme=lme,ume=cme,dme=/^\s+/;function fme(e){return e&&e.slice(0,ume(e)+1).replace(dme,"")}var hme=fme,mme=hme,s3=Hi,pme=cf,o3=NaN,xme=/^[-+]0x[0-9a-f]+$/i,gme=/^0b[01]+$/i,vme=/^0o[0-7]+$/i,yme=parseInt;function bme(e){if(typeof e=="number")return e;if(pme(e))return o3;if(s3(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=s3(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=mme(e);var r=gme.test(e);return r||vme.test(e)?yme(e.slice(2),r?2:8):xme.test(e)?o3:+e}var HM=bme,wme=Hi,cw=sme,l3=HM,_me="Expected a function",Dme=Math.max,jme=Math.min;function Nme(e,t,r){var n,a,i,s,l,c,u=0,d=!1,f=!1,h=!0;if(typeof e!="function")throw new TypeError(_me);t=l3(t)||0,wme(r)&&(d=!!r.leading,f="maxWait"in r,i=f?Dme(l3(r.maxWait)||0,t):i,h="trailing"in r?!!r.trailing:h);function m(D){var j=n,N=a;return n=a=void 0,u=D,s=e.apply(N,j),s}function x(D){return u=D,l=setTimeout(v,t),d?m(D):s}function p(D){var j=D-c,N=D-u,S=t-j;return f?jme(S,i-N):S}function g(D){var j=D-c,N=D-u;return c===void 0||j>=t||j<0||f&&N>=i}function v(){var D=cw();if(g(D))return y(D);l=setTimeout(v,p(D))}function y(D){return l=void 0,h&&n?m(D):(n=a=void 0,s)}function b(){l!==void 0&&clearTimeout(l),u=0,n=c=a=l=void 0}function w(){return l===void 0?s:y(cw())}function _(){var D=cw(),j=g(D);if(n=arguments,a=this,c=D,j){if(l===void 0)return x(c);if(f)return clearTimeout(l),l=setTimeout(v,t),m(c)}return l===void 0&&(l=setTimeout(v,t)),s}return _.cancel=b,_.flush=w,_}var Sme=Nme,Eme=Sme,Tme=Hi,kme="Expected a function";function Cme(e,t,r){var n=!0,a=!0;if(typeof e!="function")throw new TypeError(kme);return Tme(r)&&(n="leading"in r?!!r.leading:n,a="trailing"in r?!!r.trailing:a),Eme(e,t,{leading:n,maxWait:t,trailing:a})}var Ame=Cme;const VM=At(Ame);function rm(e){"@babel/helpers - typeof";return rm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rm(e)}function c3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Lx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c3(Object(r),!0).forEach(function(n){Ome(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ome(e,t,r){return t=Fme(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fme(e){var t=Pme(e,"string");return rm(t)=="symbol"?t:t+""}function Pme(e,t){if(rm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(rm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ime(e,t){return $me(e)||Ume(e,t)||Mme(e,t)||Rme()}function Rme(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mme(e,t){if(e){if(typeof e=="string")return u3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u3(e,t)}}function u3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ume(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function $me(e){if(Array.isArray(e))return e}var pa=M.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,a=n===void 0?{width:-1,height:-1}:n,i=e.width,s=i===void 0?"100%":i,l=e.height,c=l===void 0?"100%":l,u=e.minWidth,d=u===void 0?0:u,f=e.minHeight,h=e.maxHeight,m=e.children,x=e.debounce,p=x===void 0?0:x,g=e.id,v=e.className,y=e.onResize,b=e.style,w=b===void 0?{}:b,_=M.useRef(null),D=M.useRef();D.current=y,M.useImperativeHandle(t,function(){return Object.defineProperty(_.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),_.current},configurable:!0})});var j=M.useState({containerWidth:a.width,containerHeight:a.height}),N=Ime(j,2),S=N[0],E=N[1],A=M.useCallback(function(L,O){E(function(V){var W=Math.round(L),B=Math.round(O);return V.containerWidth===W&&V.containerHeight===B?V:{containerWidth:W,containerHeight:B}})},[]);M.useEffect(function(){var L=function(F){var I,R=F[0].contentRect,C=R.width,k=R.height;A(C,k),(I=D.current)===null||I===void 0||I.call(D,C,k)};p>0&&(L=VM(L,p,{trailing:!0,leading:!1}));var O=new ResizeObserver(L),V=_.current.getBoundingClientRect(),W=V.width,B=V.height;return A(W,B),O.observe(_.current),function(){O.disconnect()}},[A,p]);var T=M.useMemo(function(){var L=S.containerWidth,O=S.containerHeight;if(L<0||O<0)return null;os(bc(s)||bc(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,s,c),os(!r||r>0,"The aspect(%s) must be greater than zero.",r);var V=bc(s)?L:s,W=bc(c)?O:c;r&&r>0&&(V?W=V/r:W&&(V=W*r),h&&W>h&&(W=h)),os(V>0||W>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,V,W,s,c,d,f,r);var B=!Array.isArray(m)&&wo(m.type).endsWith("Chart");return Q.Children.map(m,function(P){return Q.isValidElement(P)?M.cloneElement(P,Lx({width:V,height:W},B?{style:Lx({height:"100%",width:"100%",maxHeight:W,maxWidth:V},P.props.style)}:{})):P})},[r,m,c,h,f,d,S,s]);return Q.createElement("div",{id:g?"".concat(g):void 0,className:vt("recharts-responsive-container",v),style:Lx(Lx({},w),{},{width:s,height:c,minWidth:d,minHeight:f,maxHeight:h}),ref:_},T)}),Ao=function(t){return null};Ao.displayName="Cell";function nm(e){"@babel/helpers - typeof";return nm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nm(e)}function d3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d3(Object(r),!0).forEach(function(n){Lme(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Lme(e,t,r){return t=Bme(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bme(e){var t=Wme(e,"string");return nm(t)=="symbol"?t:t+""}function Wme(e,t){if(nm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(nm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _u={widthCache:{},cacheCount:0},zme=2e3,Hme={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},f3="recharts_measurement_span";function Vme(e){var t=tD({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var Th=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Ul.isSsr)return{width:0,height:0};var n=Vme(r),a=JSON.stringify({text:t,copyStyle:n});if(_u.widthCache[a])return _u.widthCache[a];try{var i=document.getElementById(f3);i||(i=document.createElement("span"),i.setAttribute("id",f3),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var s=tD(tD({},Hme),n);Object.assign(i.style,s),i.textContent="".concat(t);var l=i.getBoundingClientRect(),c={width:l.width,height:l.height};return _u.widthCache[a]=c,++_u.cacheCount>zme&&(_u.cacheCount=0,_u.widthCache={}),c}catch{return{width:0,height:0}}},qme=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function am(e){"@babel/helpers - typeof";return am=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},am(e)}function pg(e,t){return Kme(e)||Xme(e,t)||Yme(e,t)||Gme()}function Gme(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yme(e,t){if(e){if(typeof e=="string")return h3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h3(e,t)}}function h3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Xme(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function Kme(e){if(Array.isArray(e))return e}function Zme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m3(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qme(n.key),n)}}function Jme(e,t,r){return t&&m3(e.prototype,t),r&&m3(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qme(e){var t=epe(e,"string");return am(t)=="symbol"?t:t+""}function epe(e,t){if(am(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(am(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var p3=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,x3=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,tpe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,rpe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,qM={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},npe=Object.keys(qM),Bu="NaN";function ape(e,t){return e*qM[t]}var Bx=function(){function e(t,r){Zme(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!tpe.test(r)&&(this.num=NaN,this.unit=""),npe.includes(r)&&(this.num=ape(t,r),this.unit="px")}return Jme(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,a=(n=rpe.exec(r))!==null&&n!==void 0?n:[],i=pg(a,3),s=i[1],l=i[2];return new e(parseFloat(s),l??"")}}])}();function GM(e){if(e.includes(Bu))return Bu;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=p3.exec(t))!==null&&r!==void 0?r:[],a=pg(n,4),i=a[1],s=a[2],l=a[3],c=Bx.parse(i??""),u=Bx.parse(l??""),d=s==="*"?c.multiply(u):c.divide(u);if(d.isNaN())return Bu;t=t.replace(p3,d.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,h=(f=x3.exec(t))!==null&&f!==void 0?f:[],m=pg(h,4),x=m[1],p=m[2],g=m[3],v=Bx.parse(x??""),y=Bx.parse(g??""),b=p==="+"?v.add(y):v.subtract(y);if(b.isNaN())return Bu;t=t.replace(x3,b.toString())}return t}var g3=/\(([^()]*)\)/;function ipe(e){for(var t=e;t.includes("(");){var r=g3.exec(t),n=pg(r,2),a=n[1];t=t.replace(g3,GM(a))}return t}function spe(e){var t=e.replace(/\s+/g,"");return t=ipe(t),t=GM(t),t}function ope(e){try{return spe(e)}catch{return Bu}}function uw(e){var t=ope(e.slice(5,-1));return t===Bu?"":t}var lpe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],cpe=["dx","dy","angle","className","breakAll"];function rD(){return rD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rD.apply(this,arguments)}function v3(e,t){if(e==null)return{};var r=upe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function upe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function y3(e,t){return mpe(e)||hpe(e,t)||fpe(e,t)||dpe()}function dpe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fpe(e,t){if(e){if(typeof e=="string")return b3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b3(e,t)}}function b3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hpe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function mpe(e){if(Array.isArray(e))return e}var YM=/[ \f\n\r\t\v\u2028\u2029]+/,XM=function(t){var r=t.children,n=t.breakAll,a=t.style;try{var i=[];yt(r)||(n?i=r.toString().split(""):i=r.toString().split(YM));var s=i.map(function(c){return{word:c,width:Th(c,a).width}}),l=n?0:Th("",a).width;return{wordsWithComputedWidth:s,spaceWidth:l}}catch{return null}},ppe=function(t,r,n,a,i){var s=t.maxLines,l=t.children,c=t.style,u=t.breakAll,d=Be(s),f=l,h=function(){var V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return V.reduce(function(W,B){var P=B.word,F=B.width,I=W[W.length-1];if(I&&(a==null||i||I.width+F+n<Number(a)))I.words.push(P),I.width+=F+n;else{var R={words:[P],width:F};W.push(R)}return W},[])},m=h(r),x=function(V){return V.reduce(function(W,B){return W.width>B.width?W:B})};if(!d)return m;for(var p="",g=function(V){var W=f.slice(0,V),B=XM({breakAll:u,style:c,children:W+p}).wordsWithComputedWidth,P=h(B),F=P.length>s||x(P).width>Number(a);return[F,P]},v=0,y=f.length-1,b=0,w;v<=y&&b<=f.length-1;){var _=Math.floor((v+y)/2),D=_-1,j=g(D),N=y3(j,2),S=N[0],E=N[1],A=g(_),T=y3(A,1),L=T[0];if(!S&&!L&&(v=_+1),S&&L&&(y=_-1),!S&&L){w=E;break}b++}return w||m},w3=function(t){var r=yt(t)?[]:t.toString().split(YM);return[{words:r}]},xpe=function(t){var r=t.width,n=t.scaleToFit,a=t.children,i=t.style,s=t.breakAll,l=t.maxLines;if((r||n)&&!Ul.isSsr){var c,u,d=XM({breakAll:s,children:a,style:i});if(d){var f=d.wordsWithComputedWidth,h=d.spaceWidth;c=f,u=h}else return w3(a);return ppe({breakAll:s,children:a,maxLines:l,style:i},c,u,r,n)}return w3(a)},_3="#808080",Uc=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,s=t.lineHeight,l=s===void 0?"1em":s,c=t.capHeight,u=c===void 0?"0.71em":c,d=t.scaleToFit,f=d===void 0?!1:d,h=t.textAnchor,m=h===void 0?"start":h,x=t.verticalAnchor,p=x===void 0?"end":x,g=t.fill,v=g===void 0?_3:g,y=v3(t,lpe),b=M.useMemo(function(){return xpe({breakAll:y.breakAll,children:y.children,maxLines:y.maxLines,scaleToFit:f,style:y.style,width:y.width})},[y.breakAll,y.children,y.maxLines,f,y.style,y.width]),w=y.dx,_=y.dy,D=y.angle,j=y.className,N=y.breakAll,S=v3(y,cpe);if(!cn(n)||!cn(i))return null;var E=n+(Be(w)?w:0),A=i+(Be(_)?_:0),T;switch(p){case"start":T=uw("calc(".concat(u,")"));break;case"middle":T=uw("calc(".concat((b.length-1)/2," * -").concat(l," + (").concat(u," / 2))"));break;default:T=uw("calc(".concat(b.length-1," * -").concat(l,")"));break}var L=[];if(f){var O=b[0].width,V=y.width;L.push("scale(".concat((Be(V)?V/O:1)/O,")"))}return D&&L.push("rotate(".concat(D,", ").concat(E,", ").concat(A,")")),L.length&&(S.transform=L.join(" ")),Q.createElement("text",rD({},ut(S,!0),{x:E,y:A,className:vt("recharts-text",j),textAnchor:m,fill:v.includes("url")?_3:v}),b.map(function(W,B){var P=W.words.join(N?"":" ");return Q.createElement("tspan",{x:E,dy:B===0?T:l,key:"".concat(P,"-").concat(B)},P)}))};function yl(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function gpe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function sS(e){let t,r,n;e.length!==2?(t=yl,r=(l,c)=>yl(e(l),c),n=(l,c)=>e(l)-c):(t=e===yl||e===gpe?e:vpe,r=e,n=e);function a(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<0?u=f+1:d=f}while(u<d)}return u}function i(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<=0?u=f+1:d=f}while(u<d)}return u}function s(l,c,u=0,d=l.length){const f=a(l,c,u,d-1);return f>u&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:a,center:s,right:i}}function vpe(){return 0}function KM(e){return e===null?NaN:+e}function*ype(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const bpe=sS(yl),Kp=bpe.right;sS(KM).center;class D3 extends Map{constructor(t,r=Dpe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(j3(this,t))}has(t){return super.has(j3(this,t))}set(t,r){return super.set(wpe(this,t),r)}delete(t){return super.delete(_pe(this,t))}}function j3({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function wpe({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function _pe({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function Dpe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function jpe(e=yl){if(e===yl)return ZM;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function ZM(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const Npe=Math.sqrt(50),Spe=Math.sqrt(10),Epe=Math.sqrt(2);function xg(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=Npe?10:i>=Spe?5:i>=Epe?2:1;let l,c,u;return a<0?(u=Math.pow(10,-a)/s,l=Math.round(e*u),c=Math.round(t*u),l/u<e&&++l,c/u>t&&--c,u=-u):(u=Math.pow(10,a)*s,l=Math.round(e/u),c=Math.round(t/u),l*u<e&&++l,c*u>t&&--c),c<l&&.5<=r&&r<2?xg(e,t,r*2):[l,c,u]}function nD(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,s]=n?xg(t,e,r):xg(e,t,r);if(!(i>=a))return[];const l=i-a+1,c=new Array(l);if(n)if(s<0)for(let u=0;u<l;++u)c[u]=(i-u)/-s;else for(let u=0;u<l;++u)c[u]=(i-u)*s;else if(s<0)for(let u=0;u<l;++u)c[u]=(a+u)/-s;else for(let u=0;u<l;++u)c[u]=(a+u)*s;return c}function aD(e,t,r){return t=+t,e=+e,r=+r,xg(e,t,r)[2]}function iD(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?aD(t,e,r):aD(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function N3(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function S3(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function JM(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?ZM:jpe(a);n>r;){if(n-r>600){const c=n-r+1,u=t-r+1,d=Math.log(c),f=.5*Math.exp(2*d/3),h=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),m=Math.max(r,Math.floor(t-u*f/c+h)),x=Math.min(n,Math.floor(t+(c-u)*f/c+h));JM(e,t,m,x,a)}const i=e[t];let s=r,l=n;for(Jf(e,r,t),a(e[n],i)>0&&Jf(e,r,n);s<l;){for(Jf(e,s,l),++s,--l;a(e[s],i)<0;)++s;for(;a(e[l],i)>0;)--l}a(e[r],i)===0?Jf(e,r,l):(++l,Jf(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function Jf(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function Tpe(e,t,r){if(e=Float64Array.from(ype(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return S3(e);if(t>=1)return N3(e);var n,a=(n-1)*t,i=Math.floor(a),s=N3(JM(e,i).subarray(0,i+1)),l=S3(e.subarray(i+1));return s+(l-s)*(a-i)}}function kpe(e,t,r=KM){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),s=+r(e[i],i,e),l=+r(e[i+1],i+1,e);return s+(l-s)*(a-i)}}function Cpe(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function qi(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function zo(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const sD=Symbol("implicit");function oS(){var e=new D3,t=[],r=[],n=sD;function a(i){let s=e.get(i);if(s===void 0){if(n!==sD)return n;e.set(i,s=t.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new D3;for(const s of i)e.has(s)||e.set(s,t.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return oS(t,r).unknown(n)},qi.apply(a,arguments),a}function im(){var e=oS().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,s,l=!1,c=0,u=0,d=.5;delete e.unknown;function f(){var h=t().length,m=a<n,x=m?a:n,p=m?n:a;i=(p-x)/Math.max(1,h-c+u*2),l&&(i=Math.floor(i)),x+=(p-x-i*(h-c))*d,s=i*(1-c),l&&(x=Math.round(x),s=Math.round(s));var g=Cpe(h).map(function(v){return x+i*v});return r(m?g.reverse():g)}return e.domain=function(h){return arguments.length?(t(h),f()):t()},e.range=function(h){return arguments.length?([n,a]=h,n=+n,a=+a,f()):[n,a]},e.rangeRound=function(h){return[n,a]=h,n=+n,a=+a,l=!0,f()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(h){return arguments.length?(l=!!h,f()):l},e.padding=function(h){return arguments.length?(c=Math.min(1,u=+h),f()):c},e.paddingInner=function(h){return arguments.length?(c=Math.min(1,h),f()):c},e.paddingOuter=function(h){return arguments.length?(u=+h,f()):u},e.align=function(h){return arguments.length?(d=Math.max(0,Math.min(1,h)),f()):d},e.copy=function(){return im(t(),[n,a]).round(l).paddingInner(c).paddingOuter(u).align(d)},qi.apply(f(),arguments)}function QM(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return QM(t())},e}function kh(){return QM(im.apply(null,arguments).paddingInner(1))}function lS(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function eU(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Zp(){}var sm=.7,gg=1/sm,Qu="\\s*([+-]?\\d+)\\s*",om="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Rs="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ape=/^#([0-9a-f]{3,8})$/,Ope=new RegExp(`^rgb\\(${Qu},${Qu},${Qu}\\)$`),Fpe=new RegExp(`^rgb\\(${Rs},${Rs},${Rs}\\)$`),Ppe=new RegExp(`^rgba\\(${Qu},${Qu},${Qu},${om}\\)$`),Ipe=new RegExp(`^rgba\\(${Rs},${Rs},${Rs},${om}\\)$`),Rpe=new RegExp(`^hsl\\(${om},${Rs},${Rs}\\)$`),Mpe=new RegExp(`^hsla\\(${om},${Rs},${Rs},${om}\\)$`),E3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};lS(Zp,lm,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:T3,formatHex:T3,formatHex8:Upe,formatHsl:$pe,formatRgb:k3,toString:k3});function T3(){return this.rgb().formatHex()}function Upe(){return this.rgb().formatHex8()}function $pe(){return tU(this).formatHsl()}function k3(){return this.rgb().formatRgb()}function lm(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=Ape.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?C3(t):r===3?new ka(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Wx(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Wx(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Ope.exec(e))?new ka(t[1],t[2],t[3],1):(t=Fpe.exec(e))?new ka(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Ppe.exec(e))?Wx(t[1],t[2],t[3],t[4]):(t=Ipe.exec(e))?Wx(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Rpe.exec(e))?F3(t[1],t[2]/100,t[3]/100,1):(t=Mpe.exec(e))?F3(t[1],t[2]/100,t[3]/100,t[4]):E3.hasOwnProperty(e)?C3(E3[e]):e==="transparent"?new ka(NaN,NaN,NaN,0):null}function C3(e){return new ka(e>>16&255,e>>8&255,e&255,1)}function Wx(e,t,r,n){return n<=0&&(e=t=r=NaN),new ka(e,t,r,n)}function Lpe(e){return e instanceof Zp||(e=lm(e)),e?(e=e.rgb(),new ka(e.r,e.g,e.b,e.opacity)):new ka}function oD(e,t,r,n){return arguments.length===1?Lpe(e):new ka(e,t,r,n??1)}function ka(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}lS(ka,oD,eU(Zp,{brighter(e){return e=e==null?gg:Math.pow(gg,e),new ka(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?sm:Math.pow(sm,e),new ka(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ka(Sc(this.r),Sc(this.g),Sc(this.b),vg(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:A3,formatHex:A3,formatHex8:Bpe,formatRgb:O3,toString:O3}));function A3(){return`#${wc(this.r)}${wc(this.g)}${wc(this.b)}`}function Bpe(){return`#${wc(this.r)}${wc(this.g)}${wc(this.b)}${wc((isNaN(this.opacity)?1:this.opacity)*255)}`}function O3(){const e=vg(this.opacity);return`${e===1?"rgb(":"rgba("}${Sc(this.r)}, ${Sc(this.g)}, ${Sc(this.b)}${e===1?")":`, ${e})`}`}function vg(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Sc(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function wc(e){return e=Sc(e),(e<16?"0":"")+e.toString(16)}function F3(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new ts(e,t,r,n)}function tU(e){if(e instanceof ts)return new ts(e.h,e.s,e.l,e.opacity);if(e instanceof Zp||(e=lm(e)),!e)return new ts;if(e instanceof ts)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,l=i-a,c=(i+a)/2;return l?(t===i?s=(r-n)/l+(r<n)*6:r===i?s=(n-t)/l+2:s=(t-r)/l+4,l/=c<.5?i+a:2-i-a,s*=60):l=c>0&&c<1?0:s,new ts(s,l,c,e.opacity)}function Wpe(e,t,r,n){return arguments.length===1?tU(e):new ts(e,t,r,n??1)}function ts(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}lS(ts,Wpe,eU(Zp,{brighter(e){return e=e==null?gg:Math.pow(gg,e),new ts(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?sm:Math.pow(sm,e),new ts(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new ka(dw(e>=240?e-240:e+120,a,n),dw(e,a,n),dw(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new ts(P3(this.h),zx(this.s),zx(this.l),vg(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=vg(this.opacity);return`${e===1?"hsl(":"hsla("}${P3(this.h)}, ${zx(this.s)*100}%, ${zx(this.l)*100}%${e===1?")":`, ${e})`}`}}));function P3(e){return e=(e||0)%360,e<0?e+360:e}function zx(e){return Math.max(0,Math.min(1,e||0))}function dw(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const cS=e=>()=>e;function zpe(e,t){return function(r){return e+r*t}}function Hpe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function Vpe(e){return(e=+e)==1?rU:function(t,r){return r-t?Hpe(t,r,e):cS(isNaN(t)?r:t)}}function rU(e,t){var r=t-e;return r?zpe(e,r):cS(isNaN(e)?t:e)}const I3=function e(t){var r=Vpe(t);function n(a,i){var s=r((a=oD(a)).r,(i=oD(i)).r),l=r(a.g,i.g),c=r(a.b,i.b),u=rU(a.opacity,i.opacity);return function(d){return a.r=s(d),a.g=l(d),a.b=c(d),a.opacity=u(d),a+""}}return n.gamma=e,n}(1);function qpe(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function Gpe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Ype(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=wf(e[s],t[s]);for(;s<r;++s)i[s]=t[s];return function(l){for(s=0;s<n;++s)i[s]=a[s](l);return i}}function Xpe(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function yg(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function Kpe(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=wf(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var lD=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,fw=new RegExp(lD.source,"g");function Zpe(e){return function(){return e}}function Jpe(e){return function(t){return e(t)+""}}function Qpe(e,t){var r=lD.lastIndex=fw.lastIndex=0,n,a,i,s=-1,l=[],c=[];for(e=e+"",t=t+"";(n=lD.exec(e))&&(a=fw.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),l[s]?l[s]+=i:l[++s]=i),(n=n[0])===(a=a[0])?l[s]?l[s]+=a:l[++s]=a:(l[++s]=null,c.push({i:s,x:yg(n,a)})),r=fw.lastIndex;return r<t.length&&(i=t.slice(r),l[s]?l[s]+=i:l[++s]=i),l.length<2?c[0]?Jpe(c[0].x):Zpe(t):(t=c.length,function(u){for(var d=0,f;d<t;++d)l[(f=c[d]).i]=f.x(u);return l.join("")})}function wf(e,t){var r=typeof t,n;return t==null||r==="boolean"?cS(t):(r==="number"?yg:r==="string"?(n=lm(t))?(t=n,I3):Qpe:t instanceof lm?I3:t instanceof Date?Xpe:Gpe(t)?qpe:Array.isArray(t)?Ype:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Kpe:yg)(e,t)}function uS(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function exe(e,t){t===void 0&&(t=e,e=wf);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(s){var l=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[l](s-l)}}function txe(e){return function(){return e}}function bg(e){return+e}var R3=[0,1];function ya(e){return e}function cD(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:txe(isNaN(t)?NaN:.5)}function rxe(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function nxe(e,t,r){var n=e[0],a=e[1],i=t[0],s=t[1];return a<n?(n=cD(a,n),i=r(s,i)):(n=cD(n,a),i=r(i,s)),function(l){return i(n(l))}}function axe(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)a[s]=cD(e[s],e[s+1]),i[s]=r(t[s],t[s+1]);return function(l){var c=Kp(e,l,1,n)-1;return i[c](a[c](l))}}function Jp(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Vy(){var e=R3,t=R3,r=wf,n,a,i,s=ya,l,c,u;function d(){var h=Math.min(e.length,t.length);return s!==ya&&(s=rxe(e[0],e[h-1])),l=h>2?axe:nxe,c=u=null,f}function f(h){return h==null||isNaN(h=+h)?i:(c||(c=l(e.map(n),t,r)))(n(s(h)))}return f.invert=function(h){return s(a((u||(u=l(t,e.map(n),yg)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,bg),d()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),d()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),r=uS,d()},f.clamp=function(h){return arguments.length?(s=h?!0:ya,d()):s!==ya},f.interpolate=function(h){return arguments.length?(r=h,d()):r},f.unknown=function(h){return arguments.length?(i=h,f):i},function(h,m){return n=h,a=m,d()}}function dS(){return Vy()(ya,ya)}function ixe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function wg(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function yd(e){return e=wg(Math.abs(e)),e?e[1]:NaN}function sxe(e,t){return function(r,n){for(var a=r.length,i=[],s=0,l=e[0],c=0;a>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),i.push(r.substring(a-=l,a+l)),!((c+=l+1)>n));)l=e[s=(s+1)%e.length];return i.reverse().join(t)}}function oxe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var lxe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function cm(e){if(!(t=lxe.exec(e)))throw new Error("invalid format: "+e);var t;return new fS({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}cm.prototype=fS.prototype;function fS(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}fS.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function cxe(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var nU;function uxe(e,t){var r=wg(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(nU=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+wg(e,Math.max(0,t+i-1))[0]}function M3(e,t){var r=wg(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const U3={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:ixe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>M3(e*100,t),r:M3,s:uxe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function $3(e){return e}var L3=Array.prototype.map,B3=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function dxe(e){var t=e.grouping===void 0||e.thousands===void 0?$3:sxe(L3.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?$3:oxe(L3.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(f){f=cm(f);var h=f.fill,m=f.align,x=f.sign,p=f.symbol,g=f.zero,v=f.width,y=f.comma,b=f.precision,w=f.trim,_=f.type;_==="n"?(y=!0,_="g"):U3[_]||(b===void 0&&(b=12),w=!0,_="g"),(g||h==="0"&&m==="=")&&(g=!0,h="0",m="=");var D=p==="$"?r:p==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",j=p==="$"?n:/[%p]/.test(_)?s:"",N=U3[_],S=/[defgprs%]/.test(_);b=b===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function E(A){var T=D,L=j,O,V,W;if(_==="c")L=N(A)+L,A="";else{A=+A;var B=A<0||1/A<0;if(A=isNaN(A)?c:N(Math.abs(A),b),w&&(A=cxe(A)),B&&+A==0&&x!=="+"&&(B=!1),T=(B?x==="("?x:l:x==="-"||x==="("?"":x)+T,L=(_==="s"?B3[8+nU/3]:"")+L+(B&&x==="("?")":""),S){for(O=-1,V=A.length;++O<V;)if(W=A.charCodeAt(O),48>W||W>57){L=(W===46?a+A.slice(O+1):A.slice(O))+L,A=A.slice(0,O);break}}}y&&!g&&(A=t(A,1/0));var P=T.length+A.length+L.length,F=P<v?new Array(v-P+1).join(h):"";switch(y&&g&&(A=t(F+A,F.length?v-L.length:1/0),F=""),m){case"<":A=T+A+L+F;break;case"=":A=T+F+A+L;break;case"^":A=F.slice(0,P=F.length>>1)+T+A+L+F.slice(P);break;default:A=F+T+A+L;break}return i(A)}return E.toString=function(){return f+""},E}function d(f,h){var m=u((f=cm(f),f.type="f",f)),x=Math.max(-8,Math.min(8,Math.floor(yd(h)/3)))*3,p=Math.pow(10,-x),g=B3[8+x/3];return function(v){return m(p*v)+g}}return{format:u,formatPrefix:d}}var Hx,hS,aU;fxe({thousands:",",grouping:[3],currency:["$",""]});function fxe(e){return Hx=dxe(e),hS=Hx.format,aU=Hx.formatPrefix,Hx}function hxe(e){return Math.max(0,-yd(Math.abs(e)))}function mxe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(yd(t)/3)))*3-yd(Math.abs(e)))}function pxe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,yd(t)-yd(e))+1}function iU(e,t,r,n){var a=iD(e,t,r),i;switch(n=cm(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=mxe(a,s))&&(n.precision=i),aU(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=pxe(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=hxe(a))&&(n.precision=i-(n.type==="%")*2);break}}return hS(n)}function $l(e){var t=e.domain;return e.ticks=function(r){var n=t();return nD(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return iU(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,s=n[a],l=n[i],c,u,d=10;for(l<s&&(u=s,s=l,l=u,u=a,a=i,i=u);d-- >0;){if(u=aD(s,l,r),u===c)return n[a]=s,n[i]=l,t(n);if(u>0)s=Math.floor(s/u)*u,l=Math.ceil(l/u)*u;else if(u<0)s=Math.ceil(s*u)/u,l=Math.floor(l*u)/u;else break;c=u}return e},e}function _g(){var e=dS();return e.copy=function(){return Jp(e,_g())},qi.apply(e,arguments),$l(e)}function sU(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,bg),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return sU(e).unknown(t)},e=arguments.length?Array.from(e,bg):[0,1],$l(r)}function oU(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),e[r]=t.floor(a),e[n]=t.ceil(i),e}function W3(e){return Math.log(e)}function z3(e){return Math.exp(e)}function xxe(e){return-Math.log(-e)}function gxe(e){return-Math.exp(-e)}function vxe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function yxe(e){return e===10?vxe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function bxe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function H3(e){return(t,r)=>-e(-t,r)}function mS(e){const t=e(W3,z3),r=t.domain;let n=10,a,i;function s(){return a=bxe(n),i=yxe(n),r()[0]<0?(a=H3(a),i=H3(i),e(xxe,gxe)):e(W3,z3),t}return t.base=function(l){return arguments.length?(n=+l,s()):n},t.domain=function(l){return arguments.length?(r(l),s()):r()},t.ticks=l=>{const c=r();let u=c[0],d=c[c.length-1];const f=d<u;f&&([u,d]=[d,u]);let h=a(u),m=a(d),x,p;const g=l==null?10:+l;let v=[];if(!(n%1)&&m-h<g){if(h=Math.floor(h),m=Math.ceil(m),u>0){for(;h<=m;++h)for(x=1;x<n;++x)if(p=h<0?x/i(-h):x*i(h),!(p<u)){if(p>d)break;v.push(p)}}else for(;h<=m;++h)for(x=n-1;x>=1;--x)if(p=h>0?x/i(-h):x*i(h),!(p<u)){if(p>d)break;v.push(p)}v.length*2<g&&(v=nD(u,d,g))}else v=nD(h,m,Math.min(m-h,g)).map(i);return f?v.reverse():v},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=cm(c)).precision==null&&(c.trim=!0),c=hS(c)),l===1/0)return c;const u=Math.max(1,n*l/t.ticks().length);return d=>{let f=d/i(Math.round(a(d)));return f*n<n-.5&&(f*=n),f<=u?c(d):""}},t.nice=()=>r(oU(r(),{floor:l=>i(Math.floor(a(l))),ceil:l=>i(Math.ceil(a(l)))})),t}function lU(){const e=mS(Vy()).domain([1,10]);return e.copy=()=>Jp(e,lU()).base(e.base()),qi.apply(e,arguments),e}function V3(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function q3(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function pS(e){var t=1,r=e(V3(t),q3(t));return r.constant=function(n){return arguments.length?e(V3(t=+n),q3(t)):t},$l(r)}function cU(){var e=pS(Vy());return e.copy=function(){return Jp(e,cU()).constant(e.constant())},qi.apply(e,arguments)}function G3(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function wxe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function _xe(e){return e<0?-e*e:e*e}function xS(e){var t=e(ya,ya),r=1;function n(){return r===1?e(ya,ya):r===.5?e(wxe,_xe):e(G3(r),G3(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},$l(t)}function gS(){var e=xS(Vy());return e.copy=function(){return Jp(e,gS()).exponent(e.exponent())},qi.apply(e,arguments),e}function Dxe(){return gS.apply(null,arguments).exponent(.5)}function Y3(e){return Math.sign(e)*e*e}function jxe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function uU(){var e=dS(),t=[0,1],r=!1,n;function a(i){var s=jxe(e(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return e.invert(Y3(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,bg)).map(Y3)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return uU(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},qi.apply(a,arguments),$l(a)}function dU(){var e=[],t=[],r=[],n;function a(){var s=0,l=Math.max(1,t.length);for(r=new Array(l-1);++s<l;)r[s-1]=kpe(e,s/l);return i}function i(s){return s==null||isNaN(s=+s)?n:t[Kp(r,s)]}return i.invertExtent=function(s){var l=t.indexOf(s);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let l of s)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(yl),a()},i.range=function(s){return arguments.length?(t=Array.from(s),a()):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return dU().domain(e).range(t).unknown(n)},qi.apply(i,arguments)}function fU(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function s(c){return c!=null&&c<=c?a[Kp(n,c,0,r)]:i}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return s}return s.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},s.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,l()):a.slice()},s.invertExtent=function(c){var u=a.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},s.unknown=function(c){return arguments.length&&(i=c),s},s.thresholds=function(){return n.slice()},s.copy=function(){return fU().domain([e,t]).range(a).unknown(i)},qi.apply($l(s),arguments)}function hU(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[Kp(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var s=t.indexOf(i);return[e[s-1],e[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return hU().domain(e).range(t).unknown(r)},qi.apply(a,arguments)}const hw=new Date,mw=new Date;function hn(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const s=a(i),l=a.ceil(i);return i-s<l-i?s:l},a.offset=(i,s)=>(t(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,l)=>{const c=[];if(i=a.ceil(i),l=l==null?1:Math.floor(l),!(i<s)||!(l>0))return c;let u;do c.push(u=new Date(+i)),t(i,l),e(i);while(u<i&&i<s);return c},a.filter=i=>hn(s=>{if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},(s,l)=>{if(s>=s)if(l<0)for(;++l<=0;)for(;t(s,-1),!i(s););else for(;--l>=0;)for(;t(s,1),!i(s););}),r&&(a.count=(i,s)=>(hw.setTime(+i),mw.setTime(+s),e(hw),e(mw),Math.floor(r(hw,mw))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const Dg=hn(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Dg.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?hn(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Dg);Dg.range;const po=1e3,Pi=po*60,xo=Pi*60,Oo=xo*24,vS=Oo*7,X3=Oo*30,pw=Oo*365,_c=hn(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*po)},(e,t)=>(t-e)/po,e=>e.getUTCSeconds());_c.range;const yS=hn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*po)},(e,t)=>{e.setTime(+e+t*Pi)},(e,t)=>(t-e)/Pi,e=>e.getMinutes());yS.range;const bS=hn(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Pi)},(e,t)=>(t-e)/Pi,e=>e.getUTCMinutes());bS.range;const wS=hn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*po-e.getMinutes()*Pi)},(e,t)=>{e.setTime(+e+t*xo)},(e,t)=>(t-e)/xo,e=>e.getHours());wS.range;const _S=hn(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*xo)},(e,t)=>(t-e)/xo,e=>e.getUTCHours());_S.range;const Qp=hn(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Pi)/Oo,e=>e.getDate()-1);Qp.range;const qy=hn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Oo,e=>e.getUTCDate()-1);qy.range;const mU=hn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Oo,e=>Math.floor(e/Oo));mU.range;function su(e){return hn(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Pi)/vS)}const Gy=su(0),jg=su(1),Nxe=su(2),Sxe=su(3),bd=su(4),Exe=su(5),Txe=su(6);Gy.range;jg.range;Nxe.range;Sxe.range;bd.range;Exe.range;Txe.range;function ou(e){return hn(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/vS)}const Yy=ou(0),Ng=ou(1),kxe=ou(2),Cxe=ou(3),wd=ou(4),Axe=ou(5),Oxe=ou(6);Yy.range;Ng.range;kxe.range;Cxe.range;wd.range;Axe.range;Oxe.range;const DS=hn(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());DS.range;const jS=hn(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());jS.range;const Fo=hn(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Fo.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:hn(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Fo.range;const Po=hn(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Po.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:hn(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Po.range;function pU(e,t,r,n,a,i){const s=[[_c,1,po],[_c,5,5*po],[_c,15,15*po],[_c,30,30*po],[i,1,Pi],[i,5,5*Pi],[i,15,15*Pi],[i,30,30*Pi],[a,1,xo],[a,3,3*xo],[a,6,6*xo],[a,12,12*xo],[n,1,Oo],[n,2,2*Oo],[r,1,vS],[t,1,X3],[t,3,3*X3],[e,1,pw]];function l(u,d,f){const h=d<u;h&&([u,d]=[d,u]);const m=f&&typeof f.range=="function"?f:c(u,d,f),x=m?m.range(u,+d+1):[];return h?x.reverse():x}function c(u,d,f){const h=Math.abs(d-u)/f,m=sS(([,,g])=>g).right(s,h);if(m===s.length)return e.every(iD(u/pw,d/pw,f));if(m===0)return Dg.every(Math.max(iD(u,d,f),1));const[x,p]=s[h/s[m-1][2]<s[m][2]/h?m-1:m];return x.every(p)}return[l,c]}const[Fxe,Pxe]=pU(Po,jS,Yy,mU,_S,bS),[Ixe,Rxe]=pU(Fo,DS,Gy,Qp,wS,yS);function xw(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function gw(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Qf(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function Mxe(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,l=e.months,c=e.shortMonths,u=eh(a),d=th(a),f=eh(i),h=th(i),m=eh(s),x=th(s),p=eh(l),g=th(l),v=eh(c),y=th(c),b={a:B,A:P,b:F,B:I,c:null,d:t4,e:t4,f:s0e,g:x0e,G:v0e,H:n0e,I:a0e,j:i0e,L:xU,m:o0e,M:l0e,p:R,q:C,Q:a4,s:i4,S:c0e,u:u0e,U:d0e,V:f0e,w:h0e,W:m0e,x:null,X:null,y:p0e,Y:g0e,Z:y0e,"%":n4},w={a:k,A:z,b:q,B:K,c:null,d:r4,e:r4,f:D0e,g:F0e,G:I0e,H:b0e,I:w0e,j:_0e,L:vU,m:j0e,M:N0e,p:se,q:ie,Q:a4,s:i4,S:S0e,u:E0e,U:T0e,V:k0e,w:C0e,W:A0e,x:null,X:null,y:O0e,Y:P0e,Z:R0e,"%":n4},_={a:E,A,b:T,B:L,c:O,d:Q3,e:Q3,f:Qxe,g:J3,G:Z3,H:e4,I:e4,j:Xxe,L:Jxe,m:Yxe,M:Kxe,p:S,q:Gxe,Q:t0e,s:r0e,S:Zxe,u:Wxe,U:zxe,V:Hxe,w:Bxe,W:Vxe,x:V,X:W,y:J3,Y:Z3,Z:qxe,"%":e0e};b.x=D(r,b),b.X=D(n,b),b.c=D(t,b),w.x=D(r,w),w.X=D(n,w),w.c=D(t,w);function D(ee,ae){return function(pe){var H=[],ne=-1,U=0,le=ee.length,re,X,G;for(pe instanceof Date||(pe=new Date(+pe));++ne<le;)ee.charCodeAt(ne)===37&&(H.push(ee.slice(U,ne)),(X=K3[re=ee.charAt(++ne)])!=null?re=ee.charAt(++ne):X=re==="e"?" ":"0",(G=ae[re])&&(re=G(pe,X)),H.push(re),U=ne+1);return H.push(ee.slice(U,ne)),H.join("")}}function j(ee,ae){return function(pe){var H=Qf(1900,void 0,1),ne=N(H,ee,pe+="",0),U,le;if(ne!=pe.length)return null;if("Q"in H)return new Date(H.Q);if("s"in H)return new Date(H.s*1e3+("L"in H?H.L:0));if(ae&&!("Z"in H)&&(H.Z=0),"p"in H&&(H.H=H.H%12+H.p*12),H.m===void 0&&(H.m="q"in H?H.q:0),"V"in H){if(H.V<1||H.V>53)return null;"w"in H||(H.w=1),"Z"in H?(U=gw(Qf(H.y,0,1)),le=U.getUTCDay(),U=le>4||le===0?Ng.ceil(U):Ng(U),U=qy.offset(U,(H.V-1)*7),H.y=U.getUTCFullYear(),H.m=U.getUTCMonth(),H.d=U.getUTCDate()+(H.w+6)%7):(U=xw(Qf(H.y,0,1)),le=U.getDay(),U=le>4||le===0?jg.ceil(U):jg(U),U=Qp.offset(U,(H.V-1)*7),H.y=U.getFullYear(),H.m=U.getMonth(),H.d=U.getDate()+(H.w+6)%7)}else("W"in H||"U"in H)&&("w"in H||(H.w="u"in H?H.u%7:"W"in H?1:0),le="Z"in H?gw(Qf(H.y,0,1)).getUTCDay():xw(Qf(H.y,0,1)).getDay(),H.m=0,H.d="W"in H?(H.w+6)%7+H.W*7-(le+5)%7:H.w+H.U*7-(le+6)%7);return"Z"in H?(H.H+=H.Z/100|0,H.M+=H.Z%100,gw(H)):xw(H)}}function N(ee,ae,pe,H){for(var ne=0,U=ae.length,le=pe.length,re,X;ne<U;){if(H>=le)return-1;if(re=ae.charCodeAt(ne++),re===37){if(re=ae.charAt(ne++),X=_[re in K3?ae.charAt(ne++):re],!X||(H=X(ee,pe,H))<0)return-1}else if(re!=pe.charCodeAt(H++))return-1}return H}function S(ee,ae,pe){var H=u.exec(ae.slice(pe));return H?(ee.p=d.get(H[0].toLowerCase()),pe+H[0].length):-1}function E(ee,ae,pe){var H=m.exec(ae.slice(pe));return H?(ee.w=x.get(H[0].toLowerCase()),pe+H[0].length):-1}function A(ee,ae,pe){var H=f.exec(ae.slice(pe));return H?(ee.w=h.get(H[0].toLowerCase()),pe+H[0].length):-1}function T(ee,ae,pe){var H=v.exec(ae.slice(pe));return H?(ee.m=y.get(H[0].toLowerCase()),pe+H[0].length):-1}function L(ee,ae,pe){var H=p.exec(ae.slice(pe));return H?(ee.m=g.get(H[0].toLowerCase()),pe+H[0].length):-1}function O(ee,ae,pe){return N(ee,t,ae,pe)}function V(ee,ae,pe){return N(ee,r,ae,pe)}function W(ee,ae,pe){return N(ee,n,ae,pe)}function B(ee){return s[ee.getDay()]}function P(ee){return i[ee.getDay()]}function F(ee){return c[ee.getMonth()]}function I(ee){return l[ee.getMonth()]}function R(ee){return a[+(ee.getHours()>=12)]}function C(ee){return 1+~~(ee.getMonth()/3)}function k(ee){return s[ee.getUTCDay()]}function z(ee){return i[ee.getUTCDay()]}function q(ee){return c[ee.getUTCMonth()]}function K(ee){return l[ee.getUTCMonth()]}function se(ee){return a[+(ee.getUTCHours()>=12)]}function ie(ee){return 1+~~(ee.getUTCMonth()/3)}return{format:function(ee){var ae=D(ee+="",b);return ae.toString=function(){return ee},ae},parse:function(ee){var ae=j(ee+="",!1);return ae.toString=function(){return ee},ae},utcFormat:function(ee){var ae=D(ee+="",w);return ae.toString=function(){return ee},ae},utcParse:function(ee){var ae=j(ee+="",!0);return ae.toString=function(){return ee},ae}}}var K3={"-":"",_:" ",0:"0"},En=/^\s*\d+/,Uxe=/^%/,$xe=/[\\^$*+?|[\]().{}]/g;function Ht(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function Lxe(e){return e.replace($xe,"\\$&")}function eh(e){return new RegExp("^(?:"+e.map(Lxe).join("|")+")","i")}function th(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function Bxe(e,t,r){var n=En.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function Wxe(e,t,r){var n=En.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function zxe(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function Hxe(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function Vxe(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function Z3(e,t,r){var n=En.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function J3(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function qxe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function Gxe(e,t,r){var n=En.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function Yxe(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function Q3(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function Xxe(e,t,r){var n=En.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function e4(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function Kxe(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function Zxe(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function Jxe(e,t,r){var n=En.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function Qxe(e,t,r){var n=En.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function e0e(e,t,r){var n=Uxe.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function t0e(e,t,r){var n=En.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function r0e(e,t,r){var n=En.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function t4(e,t){return Ht(e.getDate(),t,2)}function n0e(e,t){return Ht(e.getHours(),t,2)}function a0e(e,t){return Ht(e.getHours()%12||12,t,2)}function i0e(e,t){return Ht(1+Qp.count(Fo(e),e),t,3)}function xU(e,t){return Ht(e.getMilliseconds(),t,3)}function s0e(e,t){return xU(e,t)+"000"}function o0e(e,t){return Ht(e.getMonth()+1,t,2)}function l0e(e,t){return Ht(e.getMinutes(),t,2)}function c0e(e,t){return Ht(e.getSeconds(),t,2)}function u0e(e){var t=e.getDay();return t===0?7:t}function d0e(e,t){return Ht(Gy.count(Fo(e)-1,e),t,2)}function gU(e){var t=e.getDay();return t>=4||t===0?bd(e):bd.ceil(e)}function f0e(e,t){return e=gU(e),Ht(bd.count(Fo(e),e)+(Fo(e).getDay()===4),t,2)}function h0e(e){return e.getDay()}function m0e(e,t){return Ht(jg.count(Fo(e)-1,e),t,2)}function p0e(e,t){return Ht(e.getFullYear()%100,t,2)}function x0e(e,t){return e=gU(e),Ht(e.getFullYear()%100,t,2)}function g0e(e,t){return Ht(e.getFullYear()%1e4,t,4)}function v0e(e,t){var r=e.getDay();return e=r>=4||r===0?bd(e):bd.ceil(e),Ht(e.getFullYear()%1e4,t,4)}function y0e(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ht(t/60|0,"0",2)+Ht(t%60,"0",2)}function r4(e,t){return Ht(e.getUTCDate(),t,2)}function b0e(e,t){return Ht(e.getUTCHours(),t,2)}function w0e(e,t){return Ht(e.getUTCHours()%12||12,t,2)}function _0e(e,t){return Ht(1+qy.count(Po(e),e),t,3)}function vU(e,t){return Ht(e.getUTCMilliseconds(),t,3)}function D0e(e,t){return vU(e,t)+"000"}function j0e(e,t){return Ht(e.getUTCMonth()+1,t,2)}function N0e(e,t){return Ht(e.getUTCMinutes(),t,2)}function S0e(e,t){return Ht(e.getUTCSeconds(),t,2)}function E0e(e){var t=e.getUTCDay();return t===0?7:t}function T0e(e,t){return Ht(Yy.count(Po(e)-1,e),t,2)}function yU(e){var t=e.getUTCDay();return t>=4||t===0?wd(e):wd.ceil(e)}function k0e(e,t){return e=yU(e),Ht(wd.count(Po(e),e)+(Po(e).getUTCDay()===4),t,2)}function C0e(e){return e.getUTCDay()}function A0e(e,t){return Ht(Ng.count(Po(e)-1,e),t,2)}function O0e(e,t){return Ht(e.getUTCFullYear()%100,t,2)}function F0e(e,t){return e=yU(e),Ht(e.getUTCFullYear()%100,t,2)}function P0e(e,t){return Ht(e.getUTCFullYear()%1e4,t,4)}function I0e(e,t){var r=e.getUTCDay();return e=r>=4||r===0?wd(e):wd.ceil(e),Ht(e.getUTCFullYear()%1e4,t,4)}function R0e(){return"+0000"}function n4(){return"%"}function a4(e){return+e}function i4(e){return Math.floor(+e/1e3)}var Du,bU,wU;M0e({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function M0e(e){return Du=Mxe(e),bU=Du.format,Du.parse,wU=Du.utcFormat,Du.utcParse,Du}function U0e(e){return new Date(e)}function $0e(e){return e instanceof Date?+e:+new Date(+e)}function NS(e,t,r,n,a,i,s,l,c,u){var d=dS(),f=d.invert,h=d.domain,m=u(".%L"),x=u(":%S"),p=u("%I:%M"),g=u("%I %p"),v=u("%a %d"),y=u("%b %d"),b=u("%B"),w=u("%Y");function _(D){return(c(D)<D?m:l(D)<D?x:s(D)<D?p:i(D)<D?g:n(D)<D?a(D)<D?v:y:r(D)<D?b:w)(D)}return d.invert=function(D){return new Date(f(D))},d.domain=function(D){return arguments.length?h(Array.from(D,$0e)):h().map(U0e)},d.ticks=function(D){var j=h();return e(j[0],j[j.length-1],D??10)},d.tickFormat=function(D,j){return j==null?_:u(j)},d.nice=function(D){var j=h();return(!D||typeof D.range!="function")&&(D=t(j[0],j[j.length-1],D??10)),D?h(oU(j,D)):d},d.copy=function(){return Jp(d,NS(e,t,r,n,a,i,s,l,c,u))},d}function L0e(){return qi.apply(NS(Ixe,Rxe,Fo,DS,Gy,Qp,wS,yS,_c,bU).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function B0e(){return qi.apply(NS(Fxe,Pxe,Po,jS,Yy,qy,_S,bS,_c,wU).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Xy(){var e=0,t=1,r,n,a,i,s=ya,l=!1,c;function u(f){return f==null||isNaN(f=+f)?c:s(a===0?.5:(f=(i(f)-r)*a,l?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(f){return arguments.length?(l=!!f,u):l},u.interpolator=function(f){return arguments.length?(s=f,u):s};function d(f){return function(h){var m,x;return arguments.length?([m,x]=h,s=f(m,x),u):[s(0),s(1)]}}return u.range=d(wf),u.rangeRound=d(uS),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return i=f,r=f(e),n=f(t),a=r===n?0:1/(n-r),u}}function Ll(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function _U(){var e=$l(Xy()(ya));return e.copy=function(){return Ll(e,_U())},zo.apply(e,arguments)}function DU(){var e=mS(Xy()).domain([1,10]);return e.copy=function(){return Ll(e,DU()).base(e.base())},zo.apply(e,arguments)}function jU(){var e=pS(Xy());return e.copy=function(){return Ll(e,jU()).constant(e.constant())},zo.apply(e,arguments)}function SS(){var e=xS(Xy());return e.copy=function(){return Ll(e,SS()).exponent(e.exponent())},zo.apply(e,arguments)}function W0e(){return SS.apply(null,arguments).exponent(.5)}function NU(){var e=[],t=ya;function r(n){if(n!=null&&!isNaN(n=+n))return t((Kp(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(yl),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>Tpe(e,i/n))},r.copy=function(){return NU(t).domain(e)},zo.apply(r,arguments)}function Ky(){var e=0,t=.5,r=1,n=1,a,i,s,l,c,u=ya,d,f=!1,h;function m(p){return isNaN(p=+p)?h:(p=.5+((p=+d(p))-i)*(n*p<n*i?l:c),u(f?Math.max(0,Math.min(1,p)):p))}m.domain=function(p){return arguments.length?([e,t,r]=p,a=d(e=+e),i=d(t=+t),s=d(r=+r),l=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,m):[e,t,r]},m.clamp=function(p){return arguments.length?(f=!!p,m):f},m.interpolator=function(p){return arguments.length?(u=p,m):u};function x(p){return function(g){var v,y,b;return arguments.length?([v,y,b]=g,u=exe(p,[v,y,b]),m):[u(0),u(.5),u(1)]}}return m.range=x(wf),m.rangeRound=x(uS),m.unknown=function(p){return arguments.length?(h=p,m):h},function(p){return d=p,a=p(e),i=p(t),s=p(r),l=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,m}}function SU(){var e=$l(Ky()(ya));return e.copy=function(){return Ll(e,SU())},zo.apply(e,arguments)}function EU(){var e=mS(Ky()).domain([.1,1,10]);return e.copy=function(){return Ll(e,EU()).base(e.base())},zo.apply(e,arguments)}function TU(){var e=pS(Ky());return e.copy=function(){return Ll(e,TU()).constant(e.constant())},zo.apply(e,arguments)}function ES(){var e=xS(Ky());return e.copy=function(){return Ll(e,ES()).exponent(e.exponent())},zo.apply(e,arguments)}function z0e(){return ES.apply(null,arguments).exponent(.5)}const s4=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:im,scaleDiverging:SU,scaleDivergingLog:EU,scaleDivergingPow:ES,scaleDivergingSqrt:z0e,scaleDivergingSymlog:TU,scaleIdentity:sU,scaleImplicit:sD,scaleLinear:_g,scaleLog:lU,scaleOrdinal:oS,scalePoint:kh,scalePow:gS,scaleQuantile:dU,scaleQuantize:fU,scaleRadial:uU,scaleSequential:_U,scaleSequentialLog:DU,scaleSequentialPow:SS,scaleSequentialQuantile:NU,scaleSequentialSqrt:W0e,scaleSequentialSymlog:jU,scaleSqrt:Dxe,scaleSymlog:cU,scaleThreshold:hU,scaleTime:L0e,scaleUtc:B0e,tickFormat:iU},Symbol.toStringTag,{value:"Module"}));var H0e=cf;function V0e(e,t,r){for(var n=-1,a=e.length;++n<a;){var i=e[n],s=t(i);if(s!=null&&(l===void 0?s===s&&!H0e(s):r(s,l)))var l=s,c=i}return c}var Zy=V0e;function q0e(e,t){return e>t}var kU=q0e,G0e=Zy,Y0e=kU,X0e=yf;function K0e(e){return e&&e.length?G0e(e,X0e,Y0e):void 0}var Z0e=K0e;const Jy=At(Z0e);function J0e(e,t){return e<t}var CU=J0e,Q0e=Zy,ege=CU,tge=yf;function rge(e){return e&&e.length?Q0e(e,tge,ege):void 0}var nge=rge;const Qy=At(nge);var age=Dy,ige=ws,sge=IM,oge=sa;function lge(e,t){var r=oge(e)?age:sge;return r(e,ige(t))}var cge=lge,uge=rS,dge=cge;function fge(e,t){return uge(dge(e,t),1)}var hge=fge;const mge=At(hge);var pge=tS;function xge(e,t){return pge(e,t)}var gge=xge;const lu=At(gge);var _f=1e9,vge={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},kS,Tr=!0,Li="[DecimalError] ",Ec=Li+"Invalid argument: ",TS=Li+"Exponent out of range: ",Df=Math.floor,hc=Math.pow,yge=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ka,xn=1e7,vr=7,AU=9007199254740991,Sg=Df(AU/vr),Qe={};Qe.absoluteValue=Qe.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Qe.comparedTo=Qe.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};Qe.decimalPlaces=Qe.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*vr;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Qe.dividedBy=Qe.div=function(e){return _o(this,new this.constructor(e))};Qe.dividedToIntegerBy=Qe.idiv=function(e){var t=this,r=t.constructor;return or(_o(t,new r(e),0,1),r.precision)};Qe.equals=Qe.eq=function(e){return!this.cmp(e)};Qe.exponent=function(){return tn(this)};Qe.greaterThan=Qe.gt=function(e){return this.cmp(e)>0};Qe.greaterThanOrEqualTo=Qe.gte=function(e){return this.cmp(e)>=0};Qe.isInteger=Qe.isint=function(){return this.e>this.d.length-2};Qe.isNegative=Qe.isneg=function(){return this.s<0};Qe.isPositive=Qe.ispos=function(){return this.s>0};Qe.isZero=function(){return this.s===0};Qe.lessThan=Qe.lt=function(e){return this.cmp(e)<0};Qe.lessThanOrEqualTo=Qe.lte=function(e){return this.cmp(e)<1};Qe.logarithm=Qe.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Ka))throw Error(Li+"NaN");if(r.s<1)throw Error(Li+(r.s?"NaN":"-Infinity"));return r.eq(Ka)?new n(0):(Tr=!1,t=_o(um(r,i),um(e,i),i),Tr=!0,or(t,a))};Qe.minus=Qe.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?PU(t,e):OU(t,(e.s=-e.s,e))};Qe.modulo=Qe.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(Li+"NaN");return r.s?(Tr=!1,t=_o(r,e,0,1).times(e),Tr=!0,r.minus(t)):or(new n(r),a)};Qe.naturalExponential=Qe.exp=function(){return FU(this)};Qe.naturalLogarithm=Qe.ln=function(){return um(this)};Qe.negated=Qe.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Qe.plus=Qe.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?OU(t,e):PU(t,(e.s=-e.s,e))};Qe.precision=Qe.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Ec+e);if(t=tn(a)+1,n=a.d.length-1,r=n*vr+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Qe.squareRoot=Qe.sqrt=function(){var e,t,r,n,a,i,s,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(Li+"NaN")}for(e=tn(l),Tr=!1,a=Math.sqrt(+l),a==0||a==1/0?(t=Ps(l.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=Df((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(a.toString()),r=c.precision,a=s=r+3;;)if(i=n,n=i.plus(_o(l,i,s+2)).times(.5),Ps(i.d).slice(0,s)===(t=Ps(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),a==s&&t=="4999"){if(or(i,r+1,0),i.times(i).eq(l)){n=i;break}}else if(t!="9999")break;s+=4}return Tr=!0,or(n,r)};Qe.times=Qe.mul=function(e){var t,r,n,a,i,s,l,c,u,d=this,f=d.constructor,h=d.d,m=(e=new f(e)).d;if(!d.s||!e.s)return new f(0);for(e.s*=d.s,r=d.e+e.e,c=h.length,u=m.length,c<u&&(i=h,h=m,m=i,s=c,c=u,u=s),i=[],s=c+u,n=s;n--;)i.push(0);for(n=u;--n>=0;){for(t=0,a=c+n;a>n;)l=i[a]+m[n]*h[a-n-1]+t,i[a--]=l%xn|0,t=l/xn|0;i[a]=(i[a]+t)%xn|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,Tr?or(e,f.precision):e};Qe.toDecimalPlaces=Qe.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(zs(e,0,_f),t===void 0?t=n.rounding:zs(t,0,8),or(r,e+tn(r)+1,t))};Qe.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=$c(n,!0):(zs(e,0,_f),t===void 0?t=a.rounding:zs(t,0,8),n=or(new a(n),e+1,t),r=$c(n,!0,e+1)),r};Qe.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?$c(a):(zs(e,0,_f),t===void 0?t=i.rounding:zs(t,0,8),n=or(new i(a),e+tn(a)+1,t),r=$c(n.abs(),!1,e+tn(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};Qe.toInteger=Qe.toint=function(){var e=this,t=e.constructor;return or(new t(e),tn(e)+1,t.rounding)};Qe.toNumber=function(){return+this};Qe.toPower=Qe.pow=function(e){var t,r,n,a,i,s,l=this,c=l.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(Ka);if(l=new c(l),!l.s){if(e.s<1)throw Error(Li+"Infinity");return l}if(l.eq(Ka))return l;if(n=c.precision,e.eq(Ka))return or(l,n);if(t=e.e,r=e.d.length-1,s=t>=r,i=l.s,s){if((r=d<0?-d:d)<=AU){for(a=new c(Ka),t=Math.ceil(n/vr+4),Tr=!1;r%2&&(a=a.times(l),l4(a.d,t)),r=Df(r/2),r!==0;)l=l.times(l),l4(l.d,t);return Tr=!0,e.s<0?new c(Ka).div(a):or(a,n)}}else if(i<0)throw Error(Li+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,Tr=!1,a=e.times(um(l,n+u)),Tr=!0,a=FU(a),a.s=i,a};Qe.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=tn(a),n=$c(a,r<=i.toExpNeg||r>=i.toExpPos)):(zs(e,1,_f),t===void 0?t=i.rounding:zs(t,0,8),a=or(new i(a),e,t),r=tn(a),n=$c(a,e<=r||r<=i.toExpNeg,e)),n};Qe.toSignificantDigits=Qe.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(zs(e,1,_f),t===void 0?t=n.rounding:zs(t,0,8)),or(new n(r),e,t)};Qe.toString=Qe.valueOf=Qe.val=Qe.toJSON=Qe[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=tn(e),r=e.constructor;return $c(e,t<=r.toExpNeg||t>=r.toExpPos)};function OU(e,t){var r,n,a,i,s,l,c,u,d=e.constructor,f=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),Tr?or(t,f):t;if(c=e.d,u=t.d,s=e.e,a=t.e,c=c.slice(),i=s-a,i){for(i<0?(n=c,i=-i,l=u.length):(n=u,a=s,l=c.length),s=Math.ceil(f/vr),l=s>l?s+1:l+1,i>l&&(i=l,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(l=c.length,i=u.length,l-i<0&&(i=l,n=u,u=c,c=n),r=0;i;)r=(c[--i]=c[i]+u[i]+r)/xn|0,c[i]%=xn;for(r&&(c.unshift(r),++a),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=a,Tr?or(t,f):t}function zs(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Ec+e)}function Ps(e){var t,r,n,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,t=1;t<a;t++)n=e[t]+"",r=vr-n.length,r&&(i+=al(r)),i+=n;s=e[t],n=s+"",r=vr-n.length,r&&(i+=al(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var _o=function(){function e(n,a){var i,s=0,l=n.length;for(n=n.slice();l--;)i=n[l]*a+s,n[l]=i%xn|0,s=i/xn|0;return s&&n.unshift(s),n}function t(n,a,i,s){var l,c;if(i!=s)c=i>s?1:-1;else for(l=c=0;l<i;l++)if(n[l]!=a[l]){c=n[l]>a[l]?1:-1;break}return c}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*xn+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var l,c,u,d,f,h,m,x,p,g,v,y,b,w,_,D,j,N,S=n.constructor,E=n.s==a.s?1:-1,A=n.d,T=a.d;if(!n.s)return new S(n);if(!a.s)throw Error(Li+"Division by zero");for(c=n.e-a.e,j=T.length,_=A.length,m=new S(E),x=m.d=[],u=0;T[u]==(A[u]||0);)++u;if(T[u]>(A[u]||0)&&--c,i==null?y=i=S.precision:s?y=i+(tn(n)-tn(a))+1:y=i,y<0)return new S(0);if(y=y/vr+2|0,u=0,j==1)for(d=0,T=T[0],y++;(u<_||d)&&y--;u++)b=d*xn+(A[u]||0),x[u]=b/T|0,d=b%T|0;else{for(d=xn/(T[0]+1)|0,d>1&&(T=e(T,d),A=e(A,d),j=T.length,_=A.length),w=j,p=A.slice(0,j),g=p.length;g<j;)p[g++]=0;N=T.slice(),N.unshift(0),D=T[0],T[1]>=xn/2&&++D;do d=0,l=t(T,p,j,g),l<0?(v=p[0],j!=g&&(v=v*xn+(p[1]||0)),d=v/D|0,d>1?(d>=xn&&(d=xn-1),f=e(T,d),h=f.length,g=p.length,l=t(f,p,h,g),l==1&&(d--,r(f,j<h?N:T,h))):(d==0&&(l=d=1),f=T.slice()),h=f.length,h<g&&f.unshift(0),r(p,f,g),l==-1&&(g=p.length,l=t(T,p,j,g),l<1&&(d++,r(p,j<g?N:T,g))),g=p.length):l===0&&(d++,p=[0]),x[u++]=d,l&&p[0]?p[g++]=A[w]||0:(p=[A[w]],g=1);while((w++<_||p[0]!==void 0)&&y--)}return x[0]||x.shift(),m.e=c,or(m,s?i+tn(m)+1:i)}}();function FU(e,t){var r,n,a,i,s,l,c=0,u=0,d=e.constructor,f=d.precision;if(tn(e)>16)throw Error(TS+tn(e));if(!e.s)return new d(Ka);for(Tr=!1,l=f,s=new d(.03125);e.abs().gte(.1);)e=e.times(s),u+=5;for(n=Math.log(hc(2,u))/Math.LN10*2+5|0,l+=n,r=a=i=new d(Ka),d.precision=l;;){if(a=or(a.times(e),l),r=r.times(++c),s=i.plus(_o(a,r,l)),Ps(s.d).slice(0,l)===Ps(i.d).slice(0,l)){for(;u--;)i=or(i.times(i),l);return d.precision=f,t==null?(Tr=!0,or(i,f)):i}i=s}}function tn(e){for(var t=e.e*vr,r=e.d[0];r>=10;r/=10)t++;return t}function vw(e,t,r){if(t>e.LN10.sd())throw Tr=!0,r&&(e.precision=r),Error(Li+"LN10 precision limit exceeded");return or(new e(e.LN10),t)}function al(e){for(var t="";e--;)t+="0";return t}function um(e,t){var r,n,a,i,s,l,c,u,d,f=1,h=10,m=e,x=m.d,p=m.constructor,g=p.precision;if(m.s<1)throw Error(Li+(m.s?"NaN":"-Infinity"));if(m.eq(Ka))return new p(0);if(t==null?(Tr=!1,u=g):u=t,m.eq(10))return t==null&&(Tr=!0),vw(p,u);if(u+=h,p.precision=u,r=Ps(x),n=r.charAt(0),i=tn(m),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)m=m.times(e),r=Ps(m.d),n=r.charAt(0),f++;i=tn(m),n>1?(m=new p("0."+r),i++):m=new p(n+"."+r.slice(1))}else return c=vw(p,u+2,g).times(i+""),m=um(new p(n+"."+r.slice(1)),u-h).plus(c),p.precision=g,t==null?(Tr=!0,or(m,g)):m;for(l=s=m=_o(m.minus(Ka),m.plus(Ka),u),d=or(m.times(m),u),a=3;;){if(s=or(s.times(d),u),c=l.plus(_o(s,new p(a),u)),Ps(c.d).slice(0,u)===Ps(l.d).slice(0,u))return l=l.times(2),i!==0&&(l=l.plus(vw(p,u+2,g).times(i+""))),l=_o(l,new p(f),u),p.precision=g,t==null?(Tr=!0,or(l,g)):l;l=c,a+=2}}function o4(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=Df(r/vr),e.d=[],n=(r+1)%vr,r<0&&(n+=vr),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=vr;n<a;)e.d.push(+t.slice(n,n+=vr));t=t.slice(n),n=vr-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),Tr&&(e.e>Sg||e.e<-Sg))throw Error(TS+r)}else e.s=0,e.e=0,e.d=[0];return e}function or(e,t,r){var n,a,i,s,l,c,u,d,f=e.d;for(s=1,i=f[0];i>=10;i/=10)s++;if(n=t-s,n<0)n+=vr,a=t,u=f[d=0];else{if(d=Math.ceil((n+1)/vr),i=f.length,d>=i)return e;for(u=i=f[d],s=1;i>=10;i/=10)s++;n%=vr,a=n-vr+s}if(r!==void 0&&(i=hc(10,s-a-1),l=u/i%10|0,c=t<0||f[d+1]!==void 0||u%i,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?a>0?u/hc(10,s-a):0:f[d-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(i=tn(e),f.length=1,t=t-i-1,f[0]=hc(10,(vr-t%vr)%vr),e.e=Df(-t/vr)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=d,i=1,d--):(f.length=d+1,i=hc(10,vr-n),f[d]=a>0?(u/hc(10,s-a)%hc(10,a)|0)*i:0),c)for(;;)if(d==0){(f[0]+=i)==xn&&(f[0]=1,++e.e);break}else{if(f[d]+=i,f[d]!=xn)break;f[d--]=0,i=1}for(n=f.length;f[--n]===0;)f.pop();if(Tr&&(e.e>Sg||e.e<-Sg))throw Error(TS+tn(e));return e}function PU(e,t){var r,n,a,i,s,l,c,u,d,f,h=e.constructor,m=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),Tr?or(t,m):t;if(c=e.d,f=t.d,n=t.e,u=e.e,c=c.slice(),s=u-n,s){for(d=s<0,d?(r=c,s=-s,l=f.length):(r=f,n=u,l=c.length),a=Math.max(Math.ceil(m/vr),l)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=c.length,l=f.length,d=a<l,d&&(l=a),a=0;a<l;a++)if(c[a]!=f[a]){d=c[a]<f[a];break}s=0}for(d&&(r=c,c=f,f=r,t.s=-t.s),l=c.length,a=f.length-l;a>0;--a)c[l++]=0;for(a=f.length;a>s;){if(c[--a]<f[a]){for(i=a;i&&c[--i]===0;)c[i]=xn-1;--c[i],c[a]+=xn}c[a]-=f[a]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,Tr?or(t,m):t):new h(0)}function $c(e,t,r){var n,a=tn(e),i=Ps(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+al(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+al(-a-1)+i,r&&(n=r-s)>0&&(i+=al(n))):a>=s?(i+=al(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+al(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=al(n))),e.s<0?"-"+i:i}function l4(e,t){if(e.length>t)return e.length=t,!0}function IU(e){var t,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Ec+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return o4(s,i.toString())}else if(typeof i!="string")throw Error(Ec+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,yge.test(i))o4(s,i);else throw Error(Ec+i)}if(a.prototype=Qe,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=IU,a.config=a.set=bge,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function bge(e){if(!e||typeof e!="object")throw Error(Li+"Object expected");var t,r,n,a=["precision",1,_f,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(Df(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Ec+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Ec+r+": "+n);return this}var kS=IU(vge);Ka=new kS(1);const ar=kS;function wge(e){return Nge(e)||jge(e)||Dge(e)||_ge()}function _ge(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dge(e,t){if(e){if(typeof e=="string")return uD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uD(e,t)}}function jge(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function Nge(e){if(Array.isArray(e))return uD(e)}function uD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Sge=function(t){return t},RU={},MU=function(t){return t===RU},c4=function(t){return function r(){return arguments.length===0||arguments.length===1&&MU(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},Ege=function e(t,r){return t===1?r:c4(function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var s=a.filter(function(l){return l!==RU}).length;return s>=t?r.apply(void 0,a):e(t-s,c4(function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];var d=a.map(function(f){return MU(f)?c.shift():f});return r.apply(void 0,wge(d).concat(c))}))})},eb=function(t){return Ege(t.length,t)},dD=function(t,r){for(var n=[],a=t;a<r;++a)n[a-t]=a;return n},Tge=eb(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),kge=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return Sge;var a=r.reverse(),i=a[0],s=a.slice(1);return function(){return s.reduce(function(l,c){return c(l)},i.apply(void 0,arguments))}},fD=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},UU=function(t){var r=null,n=null;return function(){for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r&&i.every(function(l,c){return l===r[c]})||(r=i,n=t.apply(void 0,i)),n}};function Cge(e){var t;return e===0?t=1:t=Math.floor(new ar(e).abs().log(10).toNumber())+1,t}function Age(e,t,r){for(var n=new ar(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}var Oge=eb(function(e,t,r){var n=+e,a=+t;return n+r*(a-n)}),Fge=eb(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),Pge=eb(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const tb={rangeStep:Age,getDigitCount:Cge,interpolateNumber:Oge,uninterpolateNumber:Fge,uninterpolateTruncation:Pge};function hD(e){return Mge(e)||Rge(e)||$U(e)||Ige()}function Ige(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rge(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function Mge(e){if(Array.isArray(e))return mD(e)}function dm(e,t){return Lge(e)||$ge(e,t)||$U(e,t)||Uge()}function Uge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $U(e,t){if(e){if(typeof e=="string")return mD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mD(e,t)}}function mD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $ge(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,a=!1,i=void 0;try{for(var s=e[Symbol.iterator](),l;!(n=(l=s.next()).done)&&(r.push(l.value),!(t&&r.length===t));n=!0);}catch(c){a=!0,i=c}finally{try{!n&&s.return!=null&&s.return()}finally{if(a)throw i}}return r}}function Lge(e){if(Array.isArray(e))return e}function LU(e){var t=dm(e,2),r=t[0],n=t[1],a=r,i=n;return r>n&&(a=n,i=r),[a,i]}function BU(e,t,r){if(e.lte(0))return new ar(0);var n=tb.getDigitCount(e.toNumber()),a=new ar(10).pow(n),i=e.div(a),s=n!==1?.05:.1,l=new ar(Math.ceil(i.div(s).toNumber())).add(r).mul(s),c=l.mul(a);return t?c:new ar(Math.ceil(c))}function Bge(e,t,r){var n=1,a=new ar(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new ar(10).pow(tb.getDigitCount(e)-1),a=new ar(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new ar(Math.floor(e)))}else e===0?a=new ar(Math.floor((t-1)/2)):r||(a=new ar(Math.floor(e)));var s=Math.floor((t-1)/2),l=kge(Tge(function(c){return a.add(new ar(c-s).mul(n)).toNumber()}),dD);return l(0,t)}function WU(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new ar(0),tickMin:new ar(0),tickMax:new ar(0)};var i=BU(new ar(t).sub(e).div(r-1),n,a),s;e<=0&&t>=0?s=new ar(0):(s=new ar(e).add(t).div(2),s=s.sub(new ar(s).mod(i)));var l=Math.ceil(s.sub(e).div(i).toNumber()),c=Math.ceil(new ar(t).sub(s).div(i).toNumber()),u=l+c+1;return u>r?WU(e,t,r,n,a+1):(u<r&&(c=t>0?c+(r-u):c,l=t>0?l:l+(r-u)),{step:i,tickMin:s.sub(new ar(l).mul(i)),tickMax:s.add(new ar(c).mul(i))})}function Wge(e){var t=dm(e,2),r=t[0],n=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=Math.max(a,2),l=LU([r,n]),c=dm(l,2),u=c[0],d=c[1];if(u===-1/0||d===1/0){var f=d===1/0?[u].concat(hD(dD(0,a-1).map(function(){return 1/0}))):[].concat(hD(dD(0,a-1).map(function(){return-1/0})),[d]);return r>n?fD(f):f}if(u===d)return Bge(u,a,i);var h=WU(u,d,s,i),m=h.step,x=h.tickMin,p=h.tickMax,g=tb.rangeStep(x,p.add(new ar(.1).mul(m)),m);return r>n?fD(g):g}function zge(e,t){var r=dm(e,2),n=r[0],a=r[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=LU([n,a]),l=dm(s,2),c=l[0],u=l[1];if(c===-1/0||u===1/0)return[n,a];if(c===u)return[c];var d=Math.max(t,2),f=BU(new ar(u).sub(c).div(d-1),i,0),h=[].concat(hD(tb.rangeStep(new ar(c),new ar(u).sub(new ar(.99).mul(f)),f)),[u]);return n>a?fD(h):h}var Hge=UU(Wge),Vge=UU(zge),qge=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function _d(e){"@babel/helpers - typeof";return _d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_d(e)}function Eg(){return Eg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Eg.apply(this,arguments)}function Gge(e,t){return Zge(e)||Kge(e,t)||Xge(e,t)||Yge()}function Yge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xge(e,t){if(e){if(typeof e=="string")return u4(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u4(e,t)}}function u4(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Kge(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function Zge(e){if(Array.isArray(e))return e}function Jge(e,t){if(e==null)return{};var r=Qge(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Qge(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function eve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tve(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VU(n.key),n)}}function rve(e,t,r){return t&&tve(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function nve(e,t,r){return t=Tg(t),ave(e,zU()?Reflect.construct(t,r||[],Tg(e).constructor):t.apply(e,r))}function ave(e,t){if(t&&(_d(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ive(e)}function ive(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zU(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zU=function(){return!!e})()}function Tg(e){return Tg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Tg(e)}function sve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pD(e,t)}function pD(e,t){return pD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},pD(e,t)}function HU(e,t,r){return t=VU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VU(e){var t=ove(e,"string");return _d(t)=="symbol"?t:t+""}function ove(e,t){if(_d(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(_d(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ex=function(e){function t(){return eve(this,t),nve(this,t,arguments)}return sve(t,e),rve(t,[{key:"render",value:function(){var n=this.props,a=n.offset,i=n.layout,s=n.width,l=n.dataKey,c=n.data,u=n.dataPointFormatter,d=n.xAxis,f=n.yAxis,h=Jge(n,qge),m=ut(h,!1);this.props.direction==="x"&&d.type!=="number"&&Dl();var x=c.map(function(p){var g=u(p,l),v=g.x,y=g.y,b=g.value,w=g.errorVal;if(!w)return null;var _=[],D,j;if(Array.isArray(w)){var N=Gge(w,2);D=N[0],j=N[1]}else D=j=w;if(i==="vertical"){var S=d.scale,E=y+a,A=E+s,T=E-s,L=S(b-D),O=S(b+j);_.push({x1:O,y1:A,x2:O,y2:T}),_.push({x1:L,y1:E,x2:O,y2:E}),_.push({x1:L,y1:A,x2:L,y2:T})}else if(i==="horizontal"){var V=f.scale,W=v+a,B=W-s,P=W+s,F=V(b-D),I=V(b+j);_.push({x1:B,y1:I,x2:P,y2:I}),_.push({x1:W,y1:F,x2:W,y2:I}),_.push({x1:B,y1:F,x2:P,y2:F})}return Q.createElement(Rt,Eg({className:"recharts-errorBar",key:"bar-".concat(_.map(function(R){return"".concat(R.x1,"-").concat(R.x2,"-").concat(R.y1,"-").concat(R.y2)}))},m),_.map(function(R){return Q.createElement("line",Eg({},R,{key:"line-".concat(R.x1,"-").concat(R.x2,"-").concat(R.y1,"-").concat(R.y2)}))}))});return Q.createElement(Rt,{className:"recharts-errorBars"},x)}}])}(Q.Component);HU(ex,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});HU(ex,"displayName","ErrorBar");function fm(e){"@babel/helpers - typeof";return fm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fm(e)}function d4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ac(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d4(Object(r),!0).forEach(function(n){lve(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lve(e,t,r){return t=cve(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cve(e){var t=uve(e,"string");return fm(t)=="symbol"?t:t+""}function uve(e,t){if(fm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(fm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qU=function(t){var r=t.children,n=t.formattedGraphicalItems,a=t.legendWidth,i=t.legendContent,s=Ya(r,vl);if(!s)return null;var l=vl.defaultProps,c=l!==void 0?ac(ac({},l),s.props):{},u;return s.props&&s.props.payload?u=s.props&&s.props.payload:i==="children"?u=(n||[]).reduce(function(d,f){var h=f.item,m=f.props,x=m.sectors||m.data||[];return d.concat(x.map(function(p){return{type:s.props.iconType||h.props.legendType,value:p.name,color:p.fill,payload:p}}))},[]):u=(n||[]).map(function(d){var f=d.item,h=f.type.defaultProps,m=h!==void 0?ac(ac({},h),f.props):{},x=m.dataKey,p=m.name,g=m.legendType,v=m.hide;return{inactive:v,dataKey:x,type:c.iconType||g||"square",color:CS(f),value:p||x,payload:m}}),ac(ac(ac({},c),vl.getWithHeight(s,a)),{},{payload:u,item:s})};function hm(e){"@babel/helpers - typeof";return hm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hm(e)}function f4(e){return mve(e)||hve(e)||fve(e)||dve()}function dve(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fve(e,t){if(e){if(typeof e=="string")return xD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xD(e,t)}}function hve(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mve(e){if(Array.isArray(e))return xD(e)}function xD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function h4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h4(Object(r),!0).forEach(function(n){ed(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ed(e,t,r){return t=pve(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pve(e){var t=xve(e,"string");return hm(t)=="symbol"?t:t+""}function xve(e,t){if(hm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(hm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Or(e,t,r){return yt(e)||yt(t)?r:cn(t)?ni(e,t,r):mt(t)?t(e):r}function Ch(e,t,r,n){var a=mge(e,function(l){return Or(l,t)});if(r==="number"){var i=a.filter(function(l){return Be(l)||parseFloat(l)});return i.length?[Qy(i),Jy(i)]:[1/0,-1/0]}var s=n?a.filter(function(l){return!yt(l)}):a;return s.map(function(l){return cn(l)||l instanceof Date?l:""})}var gve=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,s=-1,l=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(l<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var c=i.range,u=0;u<l;u++){var d=u>0?a[u-1].coordinate:a[l-1].coordinate,f=a[u].coordinate,h=u>=l-1?a[0].coordinate:a[u+1].coordinate,m=void 0;if(ga(f-d)!==ga(h-f)){var x=[];if(ga(h-f)===ga(c[1]-c[0])){m=h;var p=f+c[1]-c[0];x[0]=Math.min(p,(p+d)/2),x[1]=Math.max(p,(p+d)/2)}else{m=d;var g=h+c[1]-c[0];x[0]=Math.min(f,(g+f)/2),x[1]=Math.max(f,(g+f)/2)}var v=[Math.min(f,(m+f)/2),Math.max(f,(m+f)/2)];if(t>v[0]&&t<=v[1]||t>=x[0]&&t<=x[1]){s=a[u].index;break}}else{var y=Math.min(d,h),b=Math.max(d,h);if(t>(y+f)/2&&t<=(b+f)/2){s=a[u].index;break}}}else for(var w=0;w<l;w++)if(w===0&&t<=(n[w].coordinate+n[w+1].coordinate)/2||w>0&&w<l-1&&t>(n[w].coordinate+n[w-1].coordinate)/2&&t<=(n[w].coordinate+n[w+1].coordinate)/2||w===l-1&&t>(n[w].coordinate+n[w-1].coordinate)/2){s=n[w].index;break}return s},CS=function(t){var r,n=t,a=n.type.displayName,i=(r=t.type)!==null&&r!==void 0&&r.defaultProps?Pr(Pr({},t.type.defaultProps),t.props):t.props,s=i.stroke,l=i.fill,c;switch(a){case"Line":c=s;break;case"Area":case"Radar":c=s&&s!=="none"?s:l;break;default:c=l;break}return c},vve=function(t){var r=t.barSize,n=t.totalSize,a=t.stackGroups,i=a===void 0?{}:a;if(!i)return{};for(var s={},l=Object.keys(i),c=0,u=l.length;c<u;c++)for(var d=i[l[c]].stackGroups,f=Object.keys(d),h=0,m=f.length;h<m;h++){var x=d[f[h]],p=x.items,g=x.cateAxisId,v=p.filter(function(j){return wo(j.type).indexOf("Bar")>=0});if(v&&v.length){var y=v[0].type.defaultProps,b=y!==void 0?Pr(Pr({},y),v[0].props):v[0].props,w=b.barSize,_=b[g];s[_]||(s[_]=[]);var D=yt(w)?r:w;s[_].push({item:v[0],stackList:v.slice(1),barSize:yt(D)?void 0:va(D,n,0)})}}return s},yve=function(t){var r=t.barGap,n=t.barCategoryGap,a=t.bandSize,i=t.sizeList,s=i===void 0?[]:i,l=t.maxBarSize,c=s.length;if(c<1)return null;var u=va(r,a,0,!0),d,f=[];if(s[0].barSize===+s[0].barSize){var h=!1,m=a/c,x=s.reduce(function(w,_){return w+_.barSize||0},0);x+=(c-1)*u,x>=a&&(x-=(c-1)*u,u=0),x>=a&&m>0&&(h=!0,m*=.9,x=c*m);var p=(a-x)/2>>0,g={offset:p-u,size:0};d=s.reduce(function(w,_){var D={item:_.item,position:{offset:g.offset+g.size+u,size:h?m:_.barSize}},j=[].concat(f4(w),[D]);return g=j[j.length-1].position,_.stackList&&_.stackList.length&&_.stackList.forEach(function(N){j.push({item:N,position:g})}),j},f)}else{var v=va(n,a,0,!0);a-2*v-(c-1)*u<=0&&(u=0);var y=(a-2*v-(c-1)*u)/c;y>1&&(y>>=0);var b=l===+l?Math.min(y,l):y;d=s.reduce(function(w,_,D){var j=[].concat(f4(w),[{item:_.item,position:{offset:v+(y+u)*D+(y-b)/2,size:b}}]);return _.stackList&&_.stackList.length&&_.stackList.forEach(function(N){j.push({item:N,position:j[j.length-1].position})}),j},f)}return d},bve=function(t,r,n,a){var i=n.children,s=n.width,l=n.margin,c=s-(l.left||0)-(l.right||0),u=qU({children:i,legendWidth:c});if(u){var d=a||{},f=d.width,h=d.height,m=u.align,x=u.verticalAlign,p=u.layout;if((p==="vertical"||p==="horizontal"&&x==="middle")&&m!=="center"&&Be(t[m]))return Pr(Pr({},t),{},ed({},m,t[m]+(f||0)));if((p==="horizontal"||p==="vertical"&&m==="center")&&x!=="middle"&&Be(t[x]))return Pr(Pr({},t),{},ed({},x,t[x]+(h||0)))}return t},wve=function(t,r,n){return yt(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},GU=function(t,r,n,a,i){var s=r.props.children,l=Oa(s,ex).filter(function(u){return wve(a,i,u.props.direction)});if(l&&l.length){var c=l.map(function(u){return u.props.dataKey});return t.reduce(function(u,d){var f=Or(d,n);if(yt(f))return u;var h=Array.isArray(f)?[Qy(f),Jy(f)]:[f,f],m=c.reduce(function(x,p){var g=Or(d,p,0),v=h[0]-Math.abs(Array.isArray(g)?g[0]:g),y=h[1]+Math.abs(Array.isArray(g)?g[1]:g);return[Math.min(v,x[0]),Math.max(y,x[1])]},[1/0,-1/0]);return[Math.min(m[0],u[0]),Math.max(m[1],u[1])]},[1/0,-1/0])}return null},_ve=function(t,r,n,a,i){var s=r.map(function(l){return GU(t,l,n,i,a)}).filter(function(l){return!yt(l)});return s&&s.length?s.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]):null},YU=function(t,r,n,a,i){var s=r.map(function(c){var u=c.props.dataKey;return n==="number"&&u&&GU(t,c,u,a)||Ch(t,u,n,i)});if(n==="number")return s.reduce(function(c,u){return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]);var l={};return s.reduce(function(c,u){for(var d=0,f=u.length;d<f;d++)l[u[d]]||(l[u[d]]=!0,c.push(u[d]));return c},[])},XU=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},KU=function(t,r,n,a){if(a)return t.map(function(c){return c.coordinate});var i,s,l=t.map(function(c){return c.coordinate===r&&(i=!0),c.coordinate===n&&(s=!0),c.coordinate});return i||l.push(r),s||l.push(n),l},go=function(t,r,n){if(!t)return null;var a=t.scale,i=t.duplicateDomain,s=t.type,l=t.range,c=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,u=(r||n)&&s==="category"&&a.bandwidth?a.bandwidth()/c:0;if(u=t.axisType==="angleAxis"&&(l==null?void 0:l.length)>=2?ga(l[0]-l[1])*2*u:u,r&&(t.ticks||t.niceTicks)){var d=(t.ticks||t.niceTicks).map(function(f){var h=i?i.indexOf(f):f;return{coordinate:a(h)+u,value:f,offset:u}});return d.filter(function(f){return!Xp(f.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(f,h){return{coordinate:a(f)+u,value:f,index:h,offset:u}}):a.ticks&&!n?a.ticks(t.tickCount).map(function(f){return{coordinate:a(f)+u,value:f,offset:u}}):a.domain().map(function(f,h){return{coordinate:a(f)+u,value:i?i[f]:f,index:h,offset:u}})},yw=new WeakMap,Vx=function(t,r){if(typeof r!="function")return t;yw.has(t)||yw.set(t,new WeakMap);var n=yw.get(t);if(n.has(r))return n.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,a),a},ZU=function(t,r,n){var a=t.scale,i=t.type,s=t.layout,l=t.axisType;if(a==="auto")return s==="radial"&&l==="radiusAxis"?{scale:im(),realScaleType:"band"}:s==="radial"&&l==="angleAxis"?{scale:_g(),realScaleType:"linear"}:i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:kh(),realScaleType:"point"}:i==="category"?{scale:im(),realScaleType:"band"}:{scale:_g(),realScaleType:"linear"};if(Nl(a)){var c="scale".concat(Ry(a));return{scale:(s4[c]||kh)(),realScaleType:s4[c]?c:"point"}}return mt(a)?{scale:a}:{scale:kh(),realScaleType:"point"}},m4=1e-4,JU=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,a=t.range(),i=Math.min(a[0],a[1])-m4,s=Math.max(a[0],a[1])+m4,l=t(r[0]),c=t(r[n-1]);(l<i||l>s||c<i||c>s)&&t.domain([r[0],r[n-1]])}},Dve=function(t,r){if(!t)return null;for(var n=0,a=t.length;n<a;n++)if(t[n].item===r)return t[n].position;return null},jve=function(t,r){if(!r||r.length!==2||!Be(r[0])||!Be(r[1]))return t;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),i=[t[0],t[1]];return(!Be(t[0])||t[0]<n)&&(i[0]=n),(!Be(t[1])||t[1]>a)&&(i[1]=a),i[0]>a&&(i[0]=a),i[1]<n&&(i[1]=n),i},Nve=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,s=0,l=0;l<r;++l){var c=Xp(t[l][n][1])?t[l][n][0]:t[l][n][1];c>=0?(t[l][n][0]=i,t[l][n][1]=i+c,i=t[l][n][1]):(t[l][n][0]=s,t[l][n][1]=s+c,s=t[l][n][1])}},Sve=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,s=0;s<r;++s){var l=Xp(t[s][n][1])?t[s][n][0]:t[s][n][1];l>=0?(t[s][n][0]=i,t[s][n][1]=i+l,i=t[s][n][1]):(t[s][n][0]=0,t[s][n][1]=0)}},Eve={sign:Nve,expand:ise,none:md,silhouette:sse,wiggle:ose,positive:Sve},Tve=function(t,r,n){var a=r.map(function(l){return l.props.dataKey}),i=Eve[n],s=ase().keys(a).value(function(l,c){return+Or(l,c,0)}).order(B_).offset(i);return s(t)},kve=function(t,r,n,a,i,s){if(!t)return null;var l=s?r.reverse():r,c={},u=l.reduce(function(f,h){var m,x=(m=h.type)!==null&&m!==void 0&&m.defaultProps?Pr(Pr({},h.type.defaultProps),h.props):h.props,p=x.stackId,g=x.hide;if(g)return f;var v=x[n],y=f[v]||{hasStack:!1,stackGroups:{}};if(cn(p)){var b=y.stackGroups[p]||{numericAxisId:n,cateAxisId:a,items:[]};b.items.push(h),y.hasStack=!0,y.stackGroups[p]=b}else y.stackGroups[mf("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[h]};return Pr(Pr({},f),{},ed({},v,y))},c),d={};return Object.keys(u).reduce(function(f,h){var m=u[h];if(m.hasStack){var x={};m.stackGroups=Object.keys(m.stackGroups).reduce(function(p,g){var v=m.stackGroups[g];return Pr(Pr({},p),{},ed({},g,{numericAxisId:n,cateAxisId:a,items:v.items,stackedData:Tve(t,v.items,i)}))},x)}return Pr(Pr({},f),{},ed({},h,m))},d)},QU=function(t,r){var n=r.realScaleType,a=r.type,i=r.tickCount,s=r.originalDomain,l=r.allowDecimals,c=n||r.scale;if(c!=="auto"&&c!=="linear")return null;if(i&&a==="number"&&s&&(s[0]==="auto"||s[1]==="auto")){var u=t.domain();if(!u.length)return null;var d=Hge(u,i,l);return t.domain([Qy(d),Jy(d)]),{niceTicks:d}}if(i&&a==="number"){var f=t.domain(),h=Vge(f,i,l);return{niceTicks:h}}return null};function p4(e){var t=e.axis,r=e.ticks,n=e.bandSize,a=e.entry,i=e.index,s=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!yt(a[t.dataKey])){var l=tg(r,"value",a[t.dataKey]);if(l)return l.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var c=Or(a,yt(s)?t.dataKey:s);return yt(c)?null:t.scale(c)}var x4=function(t){var r=t.axis,n=t.ticks,a=t.offset,i=t.bandSize,s=t.entry,l=t.index;if(r.type==="category")return n[l]?n[l].coordinate+a:null;var c=Or(s,r.dataKey,r.domain[l]);return yt(c)?null:r.scale(c)-i/2+a},Cve=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]);return a<=0&&i>=0?0:i<0?i:a}return n[0]},Ave=function(t,r){var n,a=(n=t.type)!==null&&n!==void 0&&n.defaultProps?Pr(Pr({},t.type.defaultProps),t.props):t.props,i=a.stackId;if(cn(i)){var s=r[i];if(s){var l=s.items.indexOf(t);return l>=0?s.stackedData[l]:null}}return null},Ove=function(t){return t.reduce(function(r,n){return[Qy(n.concat([r[0]]).filter(Be)),Jy(n.concat([r[1]]).filter(Be))]},[1/0,-1/0])},e$=function(t,r,n){return Object.keys(t).reduce(function(a,i){var s=t[i],l=s.stackedData,c=l.reduce(function(u,d){var f=Ove(d.slice(r,n+1));return[Math.min(u[0],f[0]),Math.max(u[1],f[1])]},[1/0,-1/0]);return[Math.min(c[0],a[0]),Math.max(c[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},g4=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,v4=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,gD=function(t,r,n){if(mt(t))return t(r,n);if(!Array.isArray(t))return r;var a=[];if(Be(t[0]))a[0]=n?t[0]:Math.min(t[0],r[0]);else if(g4.test(t[0])){var i=+g4.exec(t[0])[1];a[0]=r[0]-i}else mt(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(Be(t[1]))a[1]=n?t[1]:Math.max(t[1],r[1]);else if(v4.test(t[1])){var s=+v4.exec(t[1])[1];a[1]=r[1]+s}else mt(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},kg=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&r&&r.length>=2){for(var i=Hy(r,function(f){return f.coordinate}),s=1/0,l=1,c=i.length;l<c;l++){var u=i[l],d=i[l-1];s=Math.min((u.coordinate||0)-(d.coordinate||0),s)}return s===1/0?0:s}return n?void 0:0},y4=function(t,r,n){return!t||!t.length||lu(t,ni(n,"type.defaultProps.domain"))?r:t},t$=function(t,r){var n=t.type.defaultProps?Pr(Pr({},t.type.defaultProps),t.props):t.props,a=n.dataKey,i=n.name,s=n.unit,l=n.formatter,c=n.tooltipType,u=n.chartType,d=n.hide;return Pr(Pr({},ut(t,!1)),{},{dataKey:a,unit:s,formatter:l,name:i||a,color:CS(t),value:Or(r,a),type:c,payload:r,chartType:u,hide:d})};function mm(e){"@babel/helpers - typeof";return mm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mm(e)}function b4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b4(Object(r),!0).forEach(function(n){r$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function r$(e,t,r){return t=Fve(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fve(e){var t=Pve(e,"string");return mm(t)=="symbol"?t:t+""}function Pve(e,t){if(mm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(mm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ive(e,t){return $ve(e)||Uve(e,t)||Mve(e,t)||Rve()}function Rve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mve(e,t){if(e){if(typeof e=="string")return w4(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w4(e,t)}}function w4(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Uve(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function $ve(e){if(Array.isArray(e))return e}var Cg=Math.PI/180,Lve=function(t){return t*180/Math.PI},hr=function(t,r,n,a){return{x:t+Math.cos(-Cg*a)*n,y:r+Math.sin(-Cg*a)*n}},n$=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},Bve=function(t,r,n,a,i){var s=t.width,l=t.height,c=t.startAngle,u=t.endAngle,d=va(t.cx,s,s/2),f=va(t.cy,l,l/2),h=n$(s,l,n),m=va(t.innerRadius,h,0),x=va(t.outerRadius,h,h*.8),p=Object.keys(r);return p.reduce(function(g,v){var y=r[v],b=y.domain,w=y.reversed,_;if(yt(y.range))a==="angleAxis"?_=[c,u]:a==="radiusAxis"&&(_=[m,x]),w&&(_=[_[1],_[0]]);else{_=y.range;var D=_,j=Ive(D,2);c=j[0],u=j[1]}var N=ZU(y,i),S=N.realScaleType,E=N.scale;E.domain(b).range(_),JU(E);var A=QU(E,fo(fo({},y),{},{realScaleType:S})),T=fo(fo(fo({},y),A),{},{range:_,radius:x,realScaleType:S,scale:E,cx:d,cy:f,innerRadius:m,outerRadius:x,startAngle:c,endAngle:u});return fo(fo({},g),{},r$({},v,T))},{})},Wve=function(t,r){var n=t.x,a=t.y,i=r.x,s=r.y;return Math.sqrt(Math.pow(n-i,2)+Math.pow(a-s,2))},zve=function(t,r){var n=t.x,a=t.y,i=r.cx,s=r.cy,l=Wve({x:n,y:a},{x:i,y:s});if(l<=0)return{radius:l};var c=(n-i)/l,u=Math.acos(c);return a>s&&(u=2*Math.PI-u),{radius:l,angle:Lve(u),angleInRadian:u}},Hve=function(t){var r=t.startAngle,n=t.endAngle,a=Math.floor(r/360),i=Math.floor(n/360),s=Math.min(a,i);return{startAngle:r-s*360,endAngle:n-s*360}},Vve=function(t,r){var n=r.startAngle,a=r.endAngle,i=Math.floor(n/360),s=Math.floor(a/360),l=Math.min(i,s);return t+l*360},_4=function(t,r){var n=t.x,a=t.y,i=zve({x:n,y:a},r),s=i.radius,l=i.angle,c=r.innerRadius,u=r.outerRadius;if(s<c||s>u)return!1;if(s===0)return!0;var d=Hve(r),f=d.startAngle,h=d.endAngle,m=l,x;if(f<=h){for(;m>h;)m-=360;for(;m<f;)m+=360;x=m>=f&&m<=h}else{for(;m>f;)m-=360;for(;m<h;)m+=360;x=m>=h&&m<=f}return x?fo(fo({},r),{},{radius:s,angle:Vve(m,r)}):null},a$=function(t){return!M.isValidElement(t)&&!mt(t)&&typeof t!="boolean"?t.className:""};function pm(e){"@babel/helpers - typeof";return pm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pm(e)}var qve=["offset"];function Gve(e){return Zve(e)||Kve(e)||Xve(e)||Yve()}function Yve(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xve(e,t){if(e){if(typeof e=="string")return vD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vD(e,t)}}function Kve(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Zve(e){if(Array.isArray(e))return vD(e)}function vD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Jve(e,t){if(e==null)return{};var r=Qve(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Qve(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function D4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function an(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?D4(Object(r),!0).forEach(function(n){eye(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eye(e,t,r){return t=tye(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tye(e){var t=rye(e,"string");return pm(t)=="symbol"?t:t+""}function rye(e,t){if(pm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(pm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xm(){return xm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xm.apply(this,arguments)}var nye=function(t){var r=t.value,n=t.formatter,a=yt(t.children)?r:t.children;return mt(n)?n(a):a},aye=function(t,r){var n=ga(r-t),a=Math.min(Math.abs(r-t),360);return n*a},iye=function(t,r,n){var a=t.position,i=t.viewBox,s=t.offset,l=t.className,c=i,u=c.cx,d=c.cy,f=c.innerRadius,h=c.outerRadius,m=c.startAngle,x=c.endAngle,p=c.clockWise,g=(f+h)/2,v=aye(m,x),y=v>=0?1:-1,b,w;a==="insideStart"?(b=m+y*s,w=p):a==="insideEnd"?(b=x-y*s,w=!p):a==="end"&&(b=x+y*s,w=p),w=v<=0?w:!w;var _=hr(u,d,g,b),D=hr(u,d,g,b+(w?1:-1)*359),j="M".concat(_.x,",").concat(_.y,`
    A`).concat(g,",").concat(g,",0,1,").concat(w?0:1,`,
    `).concat(D.x,",").concat(D.y),N=yt(t.id)?mf("recharts-radial-line-"):t.id;return Q.createElement("text",xm({},n,{dominantBaseline:"central",className:vt("recharts-radial-bar-label",l)}),Q.createElement("defs",null,Q.createElement("path",{id:N,d:j})),Q.createElement("textPath",{xlinkHref:"#".concat(N)},r))},sye=function(t){var r=t.viewBox,n=t.offset,a=t.position,i=r,s=i.cx,l=i.cy,c=i.innerRadius,u=i.outerRadius,d=i.startAngle,f=i.endAngle,h=(d+f)/2;if(a==="outside"){var m=hr(s,l,u+n,h),x=m.x,p=m.y;return{x,y:p,textAnchor:x>=s?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:s,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:s,y:l,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:s,y:l,textAnchor:"middle",verticalAnchor:"end"};var g=(c+u)/2,v=hr(s,l,g,h),y=v.x,b=v.y;return{x:y,y:b,textAnchor:"middle",verticalAnchor:"middle"}},oye=function(t){var r=t.viewBox,n=t.parentViewBox,a=t.offset,i=t.position,s=r,l=s.x,c=s.y,u=s.width,d=s.height,f=d>=0?1:-1,h=f*a,m=f>0?"end":"start",x=f>0?"start":"end",p=u>=0?1:-1,g=p*a,v=p>0?"end":"start",y=p>0?"start":"end";if(i==="top"){var b={x:l+u/2,y:c-f*a,textAnchor:"middle",verticalAnchor:m};return an(an({},b),n?{height:Math.max(c-n.y,0),width:u}:{})}if(i==="bottom"){var w={x:l+u/2,y:c+d+h,textAnchor:"middle",verticalAnchor:x};return an(an({},w),n?{height:Math.max(n.y+n.height-(c+d),0),width:u}:{})}if(i==="left"){var _={x:l-g,y:c+d/2,textAnchor:v,verticalAnchor:"middle"};return an(an({},_),n?{width:Math.max(_.x-n.x,0),height:d}:{})}if(i==="right"){var D={x:l+u+g,y:c+d/2,textAnchor:y,verticalAnchor:"middle"};return an(an({},D),n?{width:Math.max(n.x+n.width-D.x,0),height:d}:{})}var j=n?{width:u,height:d}:{};return i==="insideLeft"?an({x:l+g,y:c+d/2,textAnchor:y,verticalAnchor:"middle"},j):i==="insideRight"?an({x:l+u-g,y:c+d/2,textAnchor:v,verticalAnchor:"middle"},j):i==="insideTop"?an({x:l+u/2,y:c+h,textAnchor:"middle",verticalAnchor:x},j):i==="insideBottom"?an({x:l+u/2,y:c+d-h,textAnchor:"middle",verticalAnchor:m},j):i==="insideTopLeft"?an({x:l+g,y:c+h,textAnchor:y,verticalAnchor:x},j):i==="insideTopRight"?an({x:l+u-g,y:c+h,textAnchor:v,verticalAnchor:x},j):i==="insideBottomLeft"?an({x:l+g,y:c+d-h,textAnchor:y,verticalAnchor:m},j):i==="insideBottomRight"?an({x:l+u-g,y:c+d-h,textAnchor:v,verticalAnchor:m},j):uf(i)&&(Be(i.x)||bc(i.x))&&(Be(i.y)||bc(i.y))?an({x:l+va(i.x,u),y:c+va(i.y,d),textAnchor:"end",verticalAnchor:"end"},j):an({x:l+u/2,y:c+d/2,textAnchor:"middle",verticalAnchor:"middle"},j)},lye=function(t){return"cx"in t&&Be(t.cx)};function vn(e){var t=e.offset,r=t===void 0?5:t,n=Jve(e,qve),a=an({offset:r},n),i=a.viewBox,s=a.position,l=a.value,c=a.children,u=a.content,d=a.className,f=d===void 0?"":d,h=a.textBreakAll;if(!i||yt(l)&&yt(c)&&!M.isValidElement(u)&&!mt(u))return null;if(M.isValidElement(u))return M.cloneElement(u,a);var m;if(mt(u)){if(m=M.createElement(u,a),M.isValidElement(m))return m}else m=nye(a);var x=lye(i),p=ut(a,!0);if(x&&(s==="insideStart"||s==="insideEnd"||s==="end"))return iye(a,m,p);var g=x?sye(a):oye(a);return Q.createElement(Uc,xm({className:vt("recharts-label",f)},p,g,{breakAll:h}),m)}vn.displayName="Label";var i$=function(t){var r=t.cx,n=t.cy,a=t.angle,i=t.startAngle,s=t.endAngle,l=t.r,c=t.radius,u=t.innerRadius,d=t.outerRadius,f=t.x,h=t.y,m=t.top,x=t.left,p=t.width,g=t.height,v=t.clockWise,y=t.labelViewBox;if(y)return y;if(Be(p)&&Be(g)){if(Be(f)&&Be(h))return{x:f,y:h,width:p,height:g};if(Be(m)&&Be(x))return{x:m,y:x,width:p,height:g}}return Be(f)&&Be(h)?{x:f,y:h,width:0,height:0}:Be(r)&&Be(n)?{cx:r,cy:n,startAngle:i||a||0,endAngle:s||a||0,innerRadius:u||0,outerRadius:d||c||l||0,clockWise:v}:t.viewBox?t.viewBox:{}},cye=function(t,r){return t?t===!0?Q.createElement(vn,{key:"label-implicit",viewBox:r}):cn(t)?Q.createElement(vn,{key:"label-implicit",viewBox:r,value:t}):M.isValidElement(t)?t.type===vn?M.cloneElement(t,{key:"label-implicit",viewBox:r}):Q.createElement(vn,{key:"label-implicit",content:t,viewBox:r}):mt(t)?Q.createElement(vn,{key:"label-implicit",content:t,viewBox:r}):uf(t)?Q.createElement(vn,xm({viewBox:r},t,{key:"label-implicit"})):null:null},uye=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var a=t.children,i=i$(t),s=Oa(a,vn).map(function(c,u){return M.cloneElement(c,{viewBox:r||i,key:"label-".concat(u)})});if(!n)return s;var l=cye(t.label,r||i);return[l].concat(Gve(s))};vn.parseViewBox=i$;vn.renderCallByParent=uye;function dye(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var s$=dye;const fye=At(s$);function gm(e){"@babel/helpers - typeof";return gm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gm(e)}var hye=["valueAccessor"],mye=["data","dataKey","clockWise","id","textBreakAll"];function pye(e){return yye(e)||vye(e)||gye(e)||xye()}function xye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gye(e,t){if(e){if(typeof e=="string")return yD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yD(e,t)}}function vye(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yye(e){if(Array.isArray(e))return yD(e)}function yD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ag(){return Ag=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ag.apply(this,arguments)}function j4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function N4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j4(Object(r),!0).forEach(function(n){bye(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bye(e,t,r){return t=wye(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wye(e){var t=_ye(e,"string");return gm(t)=="symbol"?t:t+""}function _ye(e,t){if(gm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(gm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function S4(e,t){if(e==null)return{};var r=Dye(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Dye(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var jye=function(t){return Array.isArray(t.value)?fye(t.value):t.value};function ls(e){var t=e.valueAccessor,r=t===void 0?jye:t,n=S4(e,hye),a=n.data,i=n.dataKey,s=n.clockWise,l=n.id,c=n.textBreakAll,u=S4(n,mye);return!a||!a.length?null:Q.createElement(Rt,{className:"recharts-label-list"},a.map(function(d,f){var h=yt(i)?r(d,f):Or(d&&d.payload,i),m=yt(l)?{}:{id:"".concat(l,"-").concat(f)};return Q.createElement(vn,Ag({},ut(d,!0),u,m,{parentViewBox:d.parentViewBox,value:h,textBreakAll:c,viewBox:vn.parseViewBox(yt(s)?d:N4(N4({},d),{},{clockWise:s})),key:"label-".concat(f),index:f}))}))}ls.displayName="LabelList";function Nye(e,t){return e?e===!0?Q.createElement(ls,{key:"labelList-implicit",data:t}):Q.isValidElement(e)||mt(e)?Q.createElement(ls,{key:"labelList-implicit",data:t,content:e}):uf(e)?Q.createElement(ls,Ag({data:t},e,{key:"labelList-implicit"})):null:null}function Sye(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,a=Oa(n,ls).map(function(s,l){return M.cloneElement(s,{data:t,key:"labelList-".concat(l)})});if(!r)return a;var i=Nye(e.label,t);return[i].concat(pye(a))}ls.renderCallByParent=Sye;function vm(e){"@babel/helpers - typeof";return vm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vm(e)}function bD(){return bD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bD.apply(this,arguments)}function E4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function T4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E4(Object(r),!0).forEach(function(n){Eye(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Eye(e,t,r){return t=Tye(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tye(e){var t=kye(e,"string");return vm(t)=="symbol"?t:t+""}function kye(e,t){if(vm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(vm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cye=function(t,r){var n=ga(r-t),a=Math.min(Math.abs(r-t),359.999);return n*a},qx=function(t){var r=t.cx,n=t.cy,a=t.radius,i=t.angle,s=t.sign,l=t.isExternal,c=t.cornerRadius,u=t.cornerIsExternal,d=c*(l?1:-1)+a,f=Math.asin(c/d)/Cg,h=u?i:i+s*f,m=hr(r,n,d,h),x=hr(r,n,a,h),p=u?i-s*f:i,g=hr(r,n,d*Math.cos(f*Cg),p);return{center:m,circleTangency:x,lineTangency:g,theta:f}},o$=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,s=t.startAngle,l=t.endAngle,c=Cye(s,l),u=s+c,d=hr(r,n,i,s),f=hr(r,n,i,u),h="M ".concat(d.x,",").concat(d.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(s>u),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(a>0){var m=hr(r,n,a,s),x=hr(r,n,a,u);h+="L ".concat(x.x,",").concat(x.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(s<=u),`,
            `).concat(m.x,",").concat(m.y," Z")}else h+="L ".concat(r,",").concat(n," Z");return h},Aye=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,s=t.cornerRadius,l=t.forceCornerRadius,c=t.cornerIsExternal,u=t.startAngle,d=t.endAngle,f=ga(d-u),h=qx({cx:r,cy:n,radius:i,angle:u,sign:f,cornerRadius:s,cornerIsExternal:c}),m=h.circleTangency,x=h.lineTangency,p=h.theta,g=qx({cx:r,cy:n,radius:i,angle:d,sign:-f,cornerRadius:s,cornerIsExternal:c}),v=g.circleTangency,y=g.lineTangency,b=g.theta,w=c?Math.abs(u-d):Math.abs(u-d)-p-b;if(w<0)return l?"M ".concat(x.x,",").concat(x.y,`
        a`).concat(s,",").concat(s,",0,0,1,").concat(s*2,`,0
        a`).concat(s,",").concat(s,",0,0,1,").concat(-s*2,`,0
      `):o$({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:u,endAngle:d});var _="M ".concat(x.x,",").concat(x.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(f<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(w>180),",").concat(+(f<0),",").concat(v.x,",").concat(v.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(f<0),",").concat(y.x,",").concat(y.y,`
  `);if(a>0){var D=qx({cx:r,cy:n,radius:a,angle:u,sign:f,isExternal:!0,cornerRadius:s,cornerIsExternal:c}),j=D.circleTangency,N=D.lineTangency,S=D.theta,E=qx({cx:r,cy:n,radius:a,angle:d,sign:-f,isExternal:!0,cornerRadius:s,cornerIsExternal:c}),A=E.circleTangency,T=E.lineTangency,L=E.theta,O=c?Math.abs(u-d):Math.abs(u-d)-S-L;if(O<0&&s===0)return"".concat(_,"L").concat(r,",").concat(n,"Z");_+="L".concat(T.x,",").concat(T.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(f<0),",").concat(A.x,",").concat(A.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(O>180),",").concat(+(f>0),",").concat(j.x,",").concat(j.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(f<0),",").concat(N.x,",").concat(N.y,"Z")}else _+="L".concat(r,",").concat(n,"Z");return _},Oye={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},l$=function(t){var r=T4(T4({},Oye),t),n=r.cx,a=r.cy,i=r.innerRadius,s=r.outerRadius,l=r.cornerRadius,c=r.forceCornerRadius,u=r.cornerIsExternal,d=r.startAngle,f=r.endAngle,h=r.className;if(s<i||d===f)return null;var m=vt("recharts-sector",h),x=s-i,p=va(l,x,0,!0),g;return p>0&&Math.abs(d-f)<360?g=Aye({cx:n,cy:a,innerRadius:i,outerRadius:s,cornerRadius:Math.min(p,x/2),forceCornerRadius:c,cornerIsExternal:u,startAngle:d,endAngle:f}):g=o$({cx:n,cy:a,innerRadius:i,outerRadius:s,startAngle:d,endAngle:f}),Q.createElement("path",bD({},ut(r,!0),{className:m,d:g,role:"img"}))};function ym(e){"@babel/helpers - typeof";return ym=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ym(e)}function wD(){return wD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wD.apply(this,arguments)}function k4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function C4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k4(Object(r),!0).forEach(function(n){Fye(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Fye(e,t,r){return t=Pye(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pye(e){var t=Iye(e,"string");return ym(t)=="symbol"?t:t+""}function Iye(e,t){if(ym(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ym(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var A4={curveBasisClosed:Gie,curveBasisOpen:Yie,curveBasis:qie,curveBumpX:Oie,curveBumpY:Fie,curveLinearClosed:Xie,curveLinear:Uy,curveMonotoneX:Kie,curveMonotoneY:Zie,curveNatural:Jie,curveStep:Qie,curveStepAfter:tse,curveStepBefore:ese},Gx=function(t){return t.x===+t.x&&t.y===+t.y},rh=function(t){return t.x},nh=function(t){return t.y},Rye=function(t,r){if(mt(t))return t;var n="curve".concat(Ry(t));return(n==="curveMonotone"||n==="curveBump")&&r?A4["".concat(n).concat(r==="vertical"?"Y":"X")]:A4[n]||Uy},Mye=function(t){var r=t.type,n=r===void 0?"linear":r,a=t.points,i=a===void 0?[]:a,s=t.baseLine,l=t.layout,c=t.connectNulls,u=c===void 0?!1:c,d=Rye(n,l),f=u?i.filter(function(p){return Gx(p)}):i,h;if(Array.isArray(s)){var m=u?s.filter(function(p){return Gx(p)}):s,x=f.map(function(p,g){return C4(C4({},p),{},{base:m[g]})});return l==="vertical"?h=Mx().y(nh).x1(rh).x0(function(p){return p.base.x}):h=Mx().x(rh).y1(nh).y0(function(p){return p.base.y}),h.defined(Gx).curve(d),h(x)}return l==="vertical"&&Be(s)?h=Mx().y(nh).x1(rh).x0(s):Be(s)?h=Mx().x(rh).y1(nh).y0(s):h=eM().x(rh).y(nh),h.defined(Gx).curve(d),h(f)},Og=function(t){var r=t.className,n=t.points,a=t.path,i=t.pathRef;if((!n||!n.length)&&!a)return null;var s=n&&n.length?Mye(t):a;return M.createElement("path",wD({},ut(t,!1),rg(t),{className:vt("recharts-curve",r),d:s,ref:i}))},Uye=Object.getOwnPropertyNames,$ye=Object.getOwnPropertySymbols,Lye=Object.prototype.hasOwnProperty;function O4(e,t){return function(n,a,i){return e(n,a,i)&&t(n,a,i)}}function Yx(e){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,a);var i=a.cache,s=i.get(r),l=i.get(n);if(s&&l)return s===n&&l===r;i.set(r,n),i.set(n,r);var c=e(r,n,a);return i.delete(r),i.delete(n),c}}function F4(e){return Uye(e).concat($ye(e))}var Bye=Object.hasOwn||function(e,t){return Lye.call(e,t)};function cu(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var Wye="__v",zye="__o",Hye="_owner",P4=Object.getOwnPropertyDescriptor,I4=Object.keys;function Vye(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function qye(e,t){return cu(e.getTime(),t.getTime())}function Gye(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function Yye(e,t){return e===t}function R4(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),i=e.entries(),s,l,c=0;(s=i.next())&&!s.done;){for(var u=t.entries(),d=!1,f=0;(l=u.next())&&!l.done;){if(a[f]){f++;continue}var h=s.value,m=l.value;if(r.equals(h[0],m[0],c,f,e,t,r)&&r.equals(h[1],m[1],h[0],m[0],e,t,r)){d=a[f]=!0;break}f++}if(!d)return!1;c++}return!0}var Xye=cu;function Kye(e,t,r){var n=I4(e),a=n.length;if(I4(t).length!==a)return!1;for(;a-- >0;)if(!c$(e,t,r,n[a]))return!1;return!0}function ah(e,t,r){var n=F4(e),a=n.length;if(F4(t).length!==a)return!1;for(var i,s,l;a-- >0;)if(i=n[a],!c$(e,t,r,i)||(s=P4(e,i),l=P4(t,i),(s||l)&&(!s||!l||s.configurable!==l.configurable||s.enumerable!==l.enumerable||s.writable!==l.writable)))return!1;return!0}function Zye(e,t){return cu(e.valueOf(),t.valueOf())}function Jye(e,t){return e.source===t.source&&e.flags===t.flags}function M4(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),i=e.values(),s,l;(s=i.next())&&!s.done;){for(var c=t.values(),u=!1,d=0;(l=c.next())&&!l.done;){if(!a[d]&&r.equals(s.value,l.value,s.value,l.value,e,t,r)){u=a[d]=!0;break}d++}if(!u)return!1}return!0}function Qye(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function ebe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function c$(e,t,r,n){return(n===Hye||n===zye||n===Wye)&&(e.$$typeof||t.$$typeof)?!0:Bye(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var tbe="[object Arguments]",rbe="[object Boolean]",nbe="[object Date]",abe="[object Error]",ibe="[object Map]",sbe="[object Number]",obe="[object Object]",lbe="[object RegExp]",cbe="[object Set]",ube="[object String]",dbe="[object URL]",fbe=Array.isArray,U4=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,$4=Object.assign,hbe=Object.prototype.toString.call.bind(Object.prototype.toString);function mbe(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,a=e.areFunctionsEqual,i=e.areMapsEqual,s=e.areNumbersEqual,l=e.areObjectsEqual,c=e.arePrimitiveWrappersEqual,u=e.areRegExpsEqual,d=e.areSetsEqual,f=e.areTypedArraysEqual,h=e.areUrlsEqual;return function(x,p,g){if(x===p)return!0;if(x==null||p==null)return!1;var v=typeof x;if(v!==typeof p)return!1;if(v!=="object")return v==="number"?s(x,p,g):v==="function"?a(x,p,g):!1;var y=x.constructor;if(y!==p.constructor)return!1;if(y===Object)return l(x,p,g);if(fbe(x))return t(x,p,g);if(U4!=null&&U4(x))return f(x,p,g);if(y===Date)return r(x,p,g);if(y===RegExp)return u(x,p,g);if(y===Map)return i(x,p,g);if(y===Set)return d(x,p,g);var b=hbe(x);return b===nbe?r(x,p,g):b===lbe?u(x,p,g):b===ibe?i(x,p,g):b===cbe?d(x,p,g):b===obe?typeof x.then!="function"&&typeof p.then!="function"&&l(x,p,g):b===dbe?h(x,p,g):b===abe?n(x,p,g):b===tbe?l(x,p,g):b===rbe||b===sbe||b===ube?c(x,p,g):!1}}function pbe(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,a={areArraysEqual:n?ah:Vye,areDatesEqual:qye,areErrorsEqual:Gye,areFunctionsEqual:Yye,areMapsEqual:n?O4(R4,ah):R4,areNumbersEqual:Xye,areObjectsEqual:n?ah:Kye,arePrimitiveWrappersEqual:Zye,areRegExpsEqual:Jye,areSetsEqual:n?O4(M4,ah):M4,areTypedArraysEqual:n?ah:Qye,areUrlsEqual:ebe};if(r&&(a=$4({},a,r(a))),t){var i=Yx(a.areArraysEqual),s=Yx(a.areMapsEqual),l=Yx(a.areObjectsEqual),c=Yx(a.areSetsEqual);a=$4({},a,{areArraysEqual:i,areMapsEqual:s,areObjectsEqual:l,areSetsEqual:c})}return a}function xbe(e){return function(t,r,n,a,i,s,l){return e(t,r,l)}}function gbe(e){var t=e.circular,r=e.comparator,n=e.createState,a=e.equals,i=e.strict;if(n)return function(c,u){var d=n(),f=d.cache,h=f===void 0?t?new WeakMap:void 0:f,m=d.meta;return r(c,u,{cache:h,equals:a,meta:m,strict:i})};if(t)return function(c,u){return r(c,u,{cache:new WeakMap,equals:a,meta:void 0,strict:i})};var s={cache:void 0,equals:a,meta:void 0,strict:i};return function(c,u){return r(c,u,s)}}var vbe=Bl();Bl({strict:!0});Bl({circular:!0});Bl({circular:!0,strict:!0});Bl({createInternalComparator:function(){return cu}});Bl({strict:!0,createInternalComparator:function(){return cu}});Bl({circular:!0,createInternalComparator:function(){return cu}});Bl({circular:!0,createInternalComparator:function(){return cu},strict:!0});function Bl(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,a=e.createState,i=e.strict,s=i===void 0?!1:i,l=pbe(e),c=mbe(l),u=n?n(c):xbe(c);return gbe({circular:r,comparator:c,createState:a,equals:u,strict:s})}function ybe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function L4(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function a(i){r<0&&(r=i),i-r>t?(e(i),r=-1):ybe(a)};requestAnimationFrame(n)}function _D(e){"@babel/helpers - typeof";return _D=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_D(e)}function bbe(e){return jbe(e)||Dbe(e)||_be(e)||wbe()}function wbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _be(e,t){if(e){if(typeof e=="string")return B4(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return B4(e,t)}}function B4(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Dbe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function jbe(e){if(Array.isArray(e))return e}function Nbe(){var e={},t=function(){return null},r=!1,n=function a(i){if(!r){if(Array.isArray(i)){if(!i.length)return;var s=i,l=bbe(s),c=l[0],u=l.slice(1);if(typeof c=="number"){L4(a.bind(null,u),c);return}a(c),L4(a.bind(null,u));return}_D(i)==="object"&&(e=i,t(e)),typeof i=="function"&&i()}};return{stop:function(){r=!0},start:function(i){r=!1,n(i)},subscribe:function(i){return t=i,function(){t=function(){return null}}}}}function bm(e){"@babel/helpers - typeof";return bm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bm(e)}function W4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function z4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?W4(Object(r),!0).forEach(function(n){u$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function u$(e,t,r){return t=Sbe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sbe(e){var t=Ebe(e,"string");return bm(t)==="symbol"?t:String(t)}function Ebe(e,t){if(bm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(bm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tbe=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,a){return n.filter(function(i){return a.includes(i)})})},kbe=function(t){return t},Cbe=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},Ah=function(t,r){return Object.keys(r).reduce(function(n,a){return z4(z4({},n),{},u$({},a,t(a,r[a])))},{})},H4=function(t,r,n){return t.map(function(a){return"".concat(Cbe(a)," ").concat(r,"ms ").concat(n)}).join(",")};function Abe(e,t){return Pbe(e)||Fbe(e,t)||d$(e,t)||Obe()}function Obe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fbe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function Pbe(e){if(Array.isArray(e))return e}function Ibe(e){return Ube(e)||Mbe(e)||d$(e)||Rbe()}function Rbe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function d$(e,t){if(e){if(typeof e=="string")return DD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DD(e,t)}}function Mbe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ube(e){if(Array.isArray(e))return DD(e)}function DD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Fg=1e-4,f$=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},h$=function(t,r){return t.map(function(n,a){return n*Math.pow(r,a)}).reduce(function(n,a){return n+a})},V4=function(t,r){return function(n){var a=f$(t,r);return h$(a,n)}},$be=function(t,r){return function(n){var a=f$(t,r),i=[].concat(Ibe(a.map(function(s,l){return s*l}).slice(1)),[0]);return h$(i,n)}},q4=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],i=r[1],s=r[2],l=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,i=0,s=1,l=1;break;case"ease":a=.25,i=.1,s=.25,l=1;break;case"ease-in":a=.42,i=0,s=1,l=1;break;case"ease-out":a=.42,i=0,s=.58,l=1;break;case"ease-in-out":a=0,i=0,s=.58,l=1;break;default:{var c=r[0].split("(");if(c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4){var u=c[1].split(")")[0].split(",").map(function(g){return parseFloat(g)}),d=Abe(u,4);a=d[0],i=d[1],s=d[2],l=d[3]}}}var f=V4(a,s),h=V4(i,l),m=$be(a,s),x=function(v){return v>1?1:v<0?0:v},p=function(v){for(var y=v>1?1:v,b=y,w=0;w<8;++w){var _=f(b)-y,D=m(b);if(Math.abs(_-y)<Fg||D<Fg)return h(b);b=x(b-_/D)}return h(b)};return p.isStepper=!1,p},Lbe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,a=t.damping,i=a===void 0?8:a,s=t.dt,l=s===void 0?17:s,c=function(d,f,h){var m=-(d-f)*n,x=h*i,p=h+(m-x)*l/1e3,g=h*l/1e3+d;return Math.abs(g-f)<Fg&&Math.abs(p)<Fg?[f,0]:[g,p]};return c.isStepper=!0,c.dt=l,c},Bbe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return q4(a);case"spring":return Lbe();default:if(a.split("(")[0]==="cubic-bezier")return q4(a)}return typeof a=="function"?a:null};function wm(e){"@babel/helpers - typeof";return wm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wm(e)}function G4(e){return Hbe(e)||zbe(e)||m$(e)||Wbe()}function Wbe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zbe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Hbe(e){if(Array.isArray(e))return ND(e)}function Y4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Fn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Y4(Object(r),!0).forEach(function(n){jD(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jD(e,t,r){return t=Vbe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vbe(e){var t=qbe(e,"string");return wm(t)==="symbol"?t:String(t)}function qbe(e,t){if(wm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(wm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gbe(e,t){return Kbe(e)||Xbe(e,t)||m$(e,t)||Ybe()}function Ybe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function m$(e,t){if(e){if(typeof e=="string")return ND(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ND(e,t)}}function ND(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Xbe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function Kbe(e){if(Array.isArray(e))return e}var Pg=function(t,r,n){return t+(r-t)*n},SD=function(t){var r=t.from,n=t.to;return r!==n},Zbe=function e(t,r,n){var a=Ah(function(i,s){if(SD(s)){var l=t(s.from,s.to,s.velocity),c=Gbe(l,2),u=c[0],d=c[1];return Fn(Fn({},s),{},{from:u,velocity:d})}return s},r);return n<1?Ah(function(i,s){return SD(s)?Fn(Fn({},s),{},{velocity:Pg(s.velocity,a[i].velocity,n),from:Pg(s.from,a[i].from,n)}):s},r):e(t,a,n-1)};const Jbe=function(e,t,r,n,a){var i=Tbe(e,t),s=i.reduce(function(g,v){return Fn(Fn({},g),{},jD({},v,[e[v],t[v]]))},{}),l=i.reduce(function(g,v){return Fn(Fn({},g),{},jD({},v,{from:e[v],velocity:0,to:t[v]}))},{}),c=-1,u,d,f=function(){return null},h=function(){return Ah(function(v,y){return y.from},l)},m=function(){return!Object.values(l).filter(SD).length},x=function(v){u||(u=v);var y=v-u,b=y/r.dt;l=Zbe(r,l,b),a(Fn(Fn(Fn({},e),t),h())),u=v,m()||(c=requestAnimationFrame(f))},p=function(v){d||(d=v);var y=(v-d)/n,b=Ah(function(_,D){return Pg.apply(void 0,G4(D).concat([r(y)]))},s);if(a(Fn(Fn(Fn({},e),t),b)),y<1)c=requestAnimationFrame(f);else{var w=Ah(function(_,D){return Pg.apply(void 0,G4(D).concat([r(1)]))},s);a(Fn(Fn(Fn({},e),t),w))}};return f=r.isStepper?x:p,function(){return requestAnimationFrame(f),function(){cancelAnimationFrame(c)}}};function Dd(e){"@babel/helpers - typeof";return Dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dd(e)}var Qbe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function e1e(e,t){if(e==null)return{};var r=t1e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function t1e(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function bw(e){return i1e(e)||a1e(e)||n1e(e)||r1e()}function r1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n1e(e,t){if(e){if(typeof e=="string")return ED(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ED(e,t)}}function a1e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function i1e(e){if(Array.isArray(e))return ED(e)}function ED(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function X4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ki(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X4(Object(r),!0).forEach(function(n){bh(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bh(e,t,r){return t=p$(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o1e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p$(n.key),n)}}function l1e(e,t,r){return t&&o1e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function p$(e){var t=c1e(e,"string");return Dd(t)==="symbol"?t:String(t)}function c1e(e,t){if(Dd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Dd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function u1e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TD(e,t)}function TD(e,t){return TD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},TD(e,t)}function d1e(e){var t=f1e();return function(){var n=Ig(e),a;if(t){var i=Ig(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return kD(this,a)}}function kD(e,t){if(t&&(Dd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CD(e)}function CD(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f1e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ig(e){return Ig=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ig(e)}var ds=function(e){u1e(r,e);var t=d1e(r);function r(n,a){var i;s1e(this,r),i=t.call(this,n,a);var s=i.props,l=s.isActive,c=s.attributeName,u=s.from,d=s.to,f=s.steps,h=s.children,m=s.duration;if(i.handleStyleChange=i.handleStyleChange.bind(CD(i)),i.changeStyle=i.changeStyle.bind(CD(i)),!l||m<=0)return i.state={style:{}},typeof h=="function"&&(i.state={style:d}),kD(i);if(f&&f.length)i.state={style:f[0].style};else if(u){if(typeof h=="function")return i.state={style:u},kD(i);i.state={style:c?bh({},c,u):u}}else i.state={style:{}};return i}return l1e(r,[{key:"componentDidMount",value:function(){var a=this.props,i=a.isActive,s=a.canBegin;this.mounted=!0,!(!i||!s)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var i=this.props,s=i.isActive,l=i.canBegin,c=i.attributeName,u=i.shouldReAnimate,d=i.to,f=i.from,h=this.state.style;if(l){if(!s){var m={style:c?bh({},c,d):d};this.state&&h&&(c&&h[c]!==d||!c&&h!==d)&&this.setState(m);return}if(!(vbe(a.to,d)&&a.canBegin&&a.isActive)){var x=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var p=x||u?f:a.to;if(this.state&&h){var g={style:c?bh({},c,p):p};(c&&h[c]!==p||!c&&h!==p)&&this.setState(g)}this.runAnimation(Ki(Ki({},this.props),{},{from:p,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var i=this,s=a.from,l=a.to,c=a.duration,u=a.easing,d=a.begin,f=a.onAnimationEnd,h=a.onAnimationStart,m=Jbe(s,l,Bbe(u),c,this.changeStyle),x=function(){i.stopJSAnimation=m()};this.manager.start([h,d,x,c,f])}},{key:"runStepAnimation",value:function(a){var i=this,s=a.steps,l=a.begin,c=a.onAnimationStart,u=s[0],d=u.style,f=u.duration,h=f===void 0?0:f,m=function(p,g,v){if(v===0)return p;var y=g.duration,b=g.easing,w=b===void 0?"ease":b,_=g.style,D=g.properties,j=g.onAnimationEnd,N=v>0?s[v-1]:g,S=D||Object.keys(_);if(typeof w=="function"||w==="spring")return[].concat(bw(p),[i.runJSAnimation.bind(i,{from:N.style,to:_,duration:y,easing:w}),y]);var E=H4(S,y,w),A=Ki(Ki(Ki({},N.style),_),{},{transition:E});return[].concat(bw(p),[A,y,j]).filter(kbe)};return this.manager.start([c].concat(bw(s.reduce(m,[d,Math.max(h,l)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=Nbe());var i=a.begin,s=a.duration,l=a.attributeName,c=a.to,u=a.easing,d=a.onAnimationStart,f=a.onAnimationEnd,h=a.steps,m=a.children,x=this.manager;if(this.unSubscribe=x.subscribe(this.handleStyleChange),typeof u=="function"||typeof m=="function"||u==="spring"){this.runJSAnimation(a);return}if(h.length>1){this.runStepAnimation(a);return}var p=l?bh({},l,c):c,g=H4(Object.keys(p),s,u);x.start([d,i,Ki(Ki({},p),{},{transition:g}),s,f])}},{key:"render",value:function(){var a=this.props,i=a.children;a.begin;var s=a.duration;a.attributeName,a.easing;var l=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var c=e1e(a,Qbe),u=M.Children.count(i),d=this.state.style;if(typeof i=="function")return i(d);if(!l||u===0||s<=0)return i;var f=function(m){var x=m.props,p=x.style,g=p===void 0?{}:p,v=x.className,y=M.cloneElement(m,Ki(Ki({},c),{},{style:Ki(Ki({},g),d),className:v}));return y};return u===1?f(M.Children.only(i)):Q.createElement("div",null,M.Children.map(i,function(h){return f(h)}))}}]),r}(M.PureComponent);ds.displayName="Animate";ds.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};ds.propTypes={from:ke.oneOfType([ke.object,ke.string]),to:ke.oneOfType([ke.object,ke.string]),attributeName:ke.string,duration:ke.number,begin:ke.number,easing:ke.oneOfType([ke.string,ke.func]),steps:ke.arrayOf(ke.shape({duration:ke.number.isRequired,style:ke.object.isRequired,easing:ke.oneOfType([ke.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),ke.func]),properties:ke.arrayOf("string"),onAnimationEnd:ke.func})),children:ke.oneOfType([ke.node,ke.func]),isActive:ke.bool,canBegin:ke.bool,onAnimationEnd:ke.func,shouldReAnimate:ke.bool,onAnimationStart:ke.func,onAnimationReStart:ke.func};function h1e(e,t){return e.classList?e.classList.contains(t):(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")!==-1}function m1e(e,t){e.classList?e.classList.add(t):h1e(e,t)||(typeof e.className=="string"?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))}function K4(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function p1e(e,t){e.classList?e.classList.remove(t):typeof e.className=="string"?e.className=K4(e.className,t):e.setAttribute("class",K4(e.className&&e.className.baseVal||"",t))}function x1e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _m(e){"@babel/helpers - typeof";return _m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_m(e)}function Rg(){return Rg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rg.apply(this,arguments)}function g1e(e,t){return w1e(e)||b1e(e,t)||y1e(e,t)||v1e()}function v1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function y1e(e,t){if(e){if(typeof e=="string")return Z4(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Z4(e,t)}}function Z4(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function b1e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function w1e(e){if(Array.isArray(e))return e}function J4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Q4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?J4(Object(r),!0).forEach(function(n){_1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _1e(e,t,r){return t=D1e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D1e(e){var t=j1e(e,"string");return _m(t)=="symbol"?t:t+""}function j1e(e,t){if(_m(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(_m(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eO=function(t,r,n,a,i){var s=Math.min(Math.abs(n)/2,Math.abs(a)/2),l=a>=0?1:-1,c=n>=0?1:-1,u=a>=0&&n>=0||a<0&&n<0?1:0,d;if(s>0&&i instanceof Array){for(var f=[0,0,0,0],h=0,m=4;h<m;h++)f[h]=i[h]>s?s:i[h];d="M".concat(t,",").concat(r+l*f[0]),f[0]>0&&(d+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(u,",").concat(t+c*f[0],",").concat(r)),d+="L ".concat(t+n-c*f[1],",").concat(r),f[1]>0&&(d+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(u,`,
        `).concat(t+n,",").concat(r+l*f[1])),d+="L ".concat(t+n,",").concat(r+a-l*f[2]),f[2]>0&&(d+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(u,`,
        `).concat(t+n-c*f[2],",").concat(r+a)),d+="L ".concat(t+c*f[3],",").concat(r+a),f[3]>0&&(d+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(u,`,
        `).concat(t,",").concat(r+a-l*f[3])),d+="Z"}else if(s>0&&i===+i&&i>0){var x=Math.min(s,i);d="M ".concat(t,",").concat(r+l*x,`
            A `).concat(x,",").concat(x,",0,0,").concat(u,",").concat(t+c*x,",").concat(r,`
            L `).concat(t+n-c*x,",").concat(r,`
            A `).concat(x,",").concat(x,",0,0,").concat(u,",").concat(t+n,",").concat(r+l*x,`
            L `).concat(t+n,",").concat(r+a-l*x,`
            A `).concat(x,",").concat(x,",0,0,").concat(u,",").concat(t+n-c*x,",").concat(r+a,`
            L `).concat(t+c*x,",").concat(r+a,`
            A `).concat(x,",").concat(x,",0,0,").concat(u,",").concat(t,",").concat(r+a-l*x," Z")}else d="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return d},N1e=function(t,r){if(!t||!r)return!1;var n=t.x,a=t.y,i=r.x,s=r.y,l=r.width,c=r.height;if(Math.abs(l)>0&&Math.abs(c)>0){var u=Math.min(i,i+l),d=Math.max(i,i+l),f=Math.min(s,s+c),h=Math.max(s,s+c);return n>=u&&n<=d&&a>=f&&a<=h}return!1},S1e={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},AS=function(t){var r=Q4(Q4({},S1e),t),n=M.useRef(),a=M.useState(-1),i=g1e(a,2),s=i[0],l=i[1];M.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var w=n.current.getTotalLength();w&&l(w)}catch{}},[]);var c=r.x,u=r.y,d=r.width,f=r.height,h=r.radius,m=r.className,x=r.animationEasing,p=r.animationDuration,g=r.animationBegin,v=r.isAnimationActive,y=r.isUpdateAnimationActive;if(c!==+c||u!==+u||d!==+d||f!==+f||d===0||f===0)return null;var b=vt("recharts-rectangle",m);return y?Q.createElement(ds,{canBegin:s>0,from:{width:d,height:f,x:c,y:u},to:{width:d,height:f,x:c,y:u},duration:p,animationEasing:x,isActive:y},function(w){var _=w.width,D=w.height,j=w.x,N=w.y;return Q.createElement(ds,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:g,duration:p,isActive:v,easing:x},Q.createElement("path",Rg({},ut(r,!0),{className:b,d:eO(j,N,_,D,h),ref:n})))}):Q.createElement("path",Rg({},ut(r,!0),{className:b,d:eO(c,u,d,f,h)}))},E1e=["points","className","baseLinePoints","connectNulls"];function Wu(){return Wu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wu.apply(this,arguments)}function T1e(e,t){if(e==null)return{};var r=k1e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function k1e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function tO(e){return F1e(e)||O1e(e)||A1e(e)||C1e()}function C1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function A1e(e,t){if(e){if(typeof e=="string")return AD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AD(e,t)}}function O1e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function F1e(e){if(Array.isArray(e))return AD(e)}function AD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var rO=function(t){return t&&t.x===+t.x&&t.y===+t.y},P1e=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(function(n){rO(n)?r[r.length-1].push(n):r[r.length-1].length>0&&r.push([])}),rO(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},Oh=function(t,r){var n=P1e(t);r&&(n=[n.reduce(function(i,s){return[].concat(tO(i),tO(s))},[])]);var a=n.map(function(i){return i.reduce(function(s,l,c){return"".concat(s).concat(c===0?"M":"L").concat(l.x,",").concat(l.y)},"")}).join("");return n.length===1?"".concat(a,"Z"):a},I1e=function(t,r,n){var a=Oh(t,n);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat(Oh(r.reverse(),n).slice(1))},R1e=function(t){var r=t.points,n=t.className,a=t.baseLinePoints,i=t.connectNulls,s=T1e(t,E1e);if(!r||!r.length)return null;var l=vt("recharts-polygon",n);if(a&&a.length){var c=s.stroke&&s.stroke!=="none",u=I1e(r,a,i);return Q.createElement("g",{className:l},Q.createElement("path",Wu({},ut(s,!0),{fill:u.slice(-1)==="Z"?s.fill:"none",stroke:"none",d:u})),c?Q.createElement("path",Wu({},ut(s,!0),{fill:"none",d:Oh(r,i)})):null,c?Q.createElement("path",Wu({},ut(s,!0),{fill:"none",d:Oh(a,i)})):null)}var d=Oh(r,i);return Q.createElement("path",Wu({},ut(s,!0),{fill:d.slice(-1)==="Z"?s.fill:"none",className:l,d}))};function OD(){return OD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},OD.apply(this,arguments)}var rb=function(t){var r=t.cx,n=t.cy,a=t.r,i=t.className,s=vt("recharts-dot",i);return r===+r&&n===+n&&a===+a?M.createElement("circle",OD({},ut(t,!1),rg(t),{className:s,cx:r,cy:n,r:a})):null};function Dm(e){"@babel/helpers - typeof";return Dm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dm(e)}var M1e=["x","y","top","left","width","height","className"];function FD(){return FD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},FD.apply(this,arguments)}function nO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function U1e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nO(Object(r),!0).forEach(function(n){$1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $1e(e,t,r){return t=L1e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L1e(e){var t=B1e(e,"string");return Dm(t)=="symbol"?t:t+""}function B1e(e,t){if(Dm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Dm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function W1e(e,t){if(e==null)return{};var r=z1e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function z1e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var H1e=function(t,r,n,a,i,s){return"M".concat(t,",").concat(i,"v").concat(a,"M").concat(s,",").concat(r,"h").concat(n)},V1e=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,s=t.top,l=s===void 0?0:s,c=t.left,u=c===void 0?0:c,d=t.width,f=d===void 0?0:d,h=t.height,m=h===void 0?0:h,x=t.className,p=W1e(t,M1e),g=U1e({x:n,y:i,top:l,left:u,width:f,height:m},p);return!Be(n)||!Be(i)||!Be(f)||!Be(m)||!Be(l)||!Be(u)?null:Q.createElement("path",FD({},ut(g,!0),{className:vt("recharts-cross",x),d:H1e(n,i,f,m,l,u)}))},q1e=Zy,G1e=kU,Y1e=ws;function X1e(e,t){return e&&e.length?q1e(e,Y1e(t),G1e):void 0}var K1e=X1e;const Z1e=At(K1e);var J1e=Zy,Q1e=ws,ewe=CU;function twe(e,t){return e&&e.length?J1e(e,Q1e(t),ewe):void 0}var rwe=twe;const nwe=At(rwe);var awe=["cx","cy","angle","ticks","axisLine"],iwe=["ticks","tick","angle","tickFormatter","stroke"];function jd(e){"@babel/helpers - typeof";return jd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jd(e)}function Fh(){return Fh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fh.apply(this,arguments)}function aO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ic(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aO(Object(r),!0).forEach(function(n){nb(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iO(e,t){if(e==null)return{};var r=swe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function swe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function owe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g$(n.key),n)}}function lwe(e,t,r){return t&&sO(e.prototype,t),r&&sO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cwe(e,t,r){return t=Mg(t),uwe(e,x$()?Reflect.construct(t,r||[],Mg(e).constructor):t.apply(e,r))}function uwe(e,t){if(t&&(jd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dwe(e)}function dwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(x$=function(){return!!e})()}function Mg(e){return Mg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mg(e)}function fwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PD(e,t)}function PD(e,t){return PD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},PD(e,t)}function nb(e,t,r){return t=g$(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g$(e){var t=hwe(e,"string");return jd(t)=="symbol"?t:t+""}function hwe(e,t){if(jd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(jd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ab=function(e){function t(){return owe(this,t),cwe(this,t,arguments)}return fwe(t,e),lwe(t,[{key:"getTickValueCoord",value:function(n){var a=n.coordinate,i=this.props,s=i.angle,l=i.cx,c=i.cy;return hr(l,c,a,s)}},{key:"getTickTextAnchor",value:function(){var n=this.props.orientation,a;switch(n){case"left":a="end";break;case"right":a="start";break;default:a="middle";break}return a}},{key:"getViewBox",value:function(){var n=this.props,a=n.cx,i=n.cy,s=n.angle,l=n.ticks,c=Z1e(l,function(d){return d.coordinate||0}),u=nwe(l,function(d){return d.coordinate||0});return{cx:a,cy:i,startAngle:s,endAngle:s,innerRadius:u.coordinate||0,outerRadius:c.coordinate||0}}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,i=n.cy,s=n.angle,l=n.ticks,c=n.axisLine,u=iO(n,awe),d=l.reduce(function(x,p){return[Math.min(x[0],p.coordinate),Math.max(x[1],p.coordinate)]},[1/0,-1/0]),f=hr(a,i,d[0],s),h=hr(a,i,d[1],s),m=ic(ic(ic({},ut(u,!1)),{},{fill:"none"},ut(c,!1)),{},{x1:f.x,y1:f.y,x2:h.x,y2:h.y});return Q.createElement("line",Fh({className:"recharts-polar-radius-axis-line"},m))}},{key:"renderTicks",value:function(){var n=this,a=this.props,i=a.ticks,s=a.tick,l=a.angle,c=a.tickFormatter,u=a.stroke,d=iO(a,iwe),f=this.getTickTextAnchor(),h=ut(d,!1),m=ut(s,!1),x=i.map(function(p,g){var v=n.getTickValueCoord(p),y=ic(ic(ic(ic({textAnchor:f,transform:"rotate(".concat(90-l,", ").concat(v.x,", ").concat(v.y,")")},h),{},{stroke:"none",fill:u},m),{},{index:g},v),{},{payload:p});return Q.createElement(Rt,Fh({className:vt("recharts-polar-radius-axis-tick",a$(s)),key:"tick-".concat(p.coordinate)},Sl(n.props,p,g)),t.renderTickItem(s,y,c?c(p.value,g):p.value))});return Q.createElement(Rt,{className:"recharts-polar-radius-axis-ticks"},x)}},{key:"render",value:function(){var n=this.props,a=n.ticks,i=n.axisLine,s=n.tick;return!a||!a.length?null:Q.createElement(Rt,{className:vt("recharts-polar-radius-axis",this.props.className)},i&&this.renderAxisLine(),s&&this.renderTicks(),vn.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(n,a,i){var s;return Q.isValidElement(n)?s=Q.cloneElement(n,a):mt(n)?s=n(a):s=Q.createElement(Uc,Fh({},a,{className:"recharts-polar-radius-axis-tick-value"}),i),s}}])}(M.PureComponent);nb(ab,"displayName","PolarRadiusAxis");nb(ab,"axisType","radiusAxis");nb(ab,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function Nd(e){"@babel/helpers - typeof";return Nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nd(e)}function gc(){return gc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gc.apply(this,arguments)}function oO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function sc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oO(Object(r),!0).forEach(function(n){ib(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y$(n.key),n)}}function pwe(e,t,r){return t&&lO(e.prototype,t),r&&lO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xwe(e,t,r){return t=Ug(t),gwe(e,v$()?Reflect.construct(t,r||[],Ug(e).constructor):t.apply(e,r))}function gwe(e,t){if(t&&(Nd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vwe(e)}function vwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v$=function(){return!!e})()}function Ug(e){return Ug=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ug(e)}function ywe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ID(e,t)}function ID(e,t){return ID=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},ID(e,t)}function ib(e,t,r){return t=y$(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y$(e){var t=bwe(e,"string");return Nd(t)=="symbol"?t:t+""}function bwe(e,t){if(Nd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Nd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var wwe=Math.PI/180,cO=1e-5,sb=function(e){function t(){return mwe(this,t),xwe(this,t,arguments)}return ywe(t,e),pwe(t,[{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.cx,s=a.cy,l=a.radius,c=a.orientation,u=a.tickSize,d=u||8,f=hr(i,s,l,n.coordinate),h=hr(i,s,l+(c==="inner"?-1:1)*d,n.coordinate);return{x1:f.x,y1:f.y,x2:h.x,y2:h.y}}},{key:"getTickTextAnchor",value:function(n){var a=this.props.orientation,i=Math.cos(-n.coordinate*wwe),s;return i>cO?s=a==="outer"?"start":"end":i<-cO?s=a==="outer"?"end":"start":s="middle",s}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,i=n.cy,s=n.radius,l=n.axisLine,c=n.axisLineType,u=sc(sc({},ut(this.props,!1)),{},{fill:"none"},ut(l,!1));if(c==="circle")return Q.createElement(rb,gc({className:"recharts-polar-angle-axis-line"},u,{cx:a,cy:i,r:s}));var d=this.props.ticks,f=d.map(function(h){return hr(a,i,s,h.coordinate)});return Q.createElement(R1e,gc({className:"recharts-polar-angle-axis-line"},u,{points:f}))}},{key:"renderTicks",value:function(){var n=this,a=this.props,i=a.ticks,s=a.tick,l=a.tickLine,c=a.tickFormatter,u=a.stroke,d=ut(this.props,!1),f=ut(s,!1),h=sc(sc({},d),{},{fill:"none"},ut(l,!1)),m=i.map(function(x,p){var g=n.getTickLineCoord(x),v=n.getTickTextAnchor(x),y=sc(sc(sc({textAnchor:v},d),{},{stroke:"none",fill:u},f),{},{index:p,payload:x,x:g.x2,y:g.y2});return Q.createElement(Rt,gc({className:vt("recharts-polar-angle-axis-tick",a$(s)),key:"tick-".concat(x.coordinate)},Sl(n.props,x,p)),l&&Q.createElement("line",gc({className:"recharts-polar-angle-axis-tick-line"},h,g)),s&&t.renderTickItem(s,y,c?c(x.value,p):x.value))});return Q.createElement(Rt,{className:"recharts-polar-angle-axis-ticks"},m)}},{key:"render",value:function(){var n=this.props,a=n.ticks,i=n.radius,s=n.axisLine;return i<=0||!a||!a.length?null:Q.createElement(Rt,{className:vt("recharts-polar-angle-axis",this.props.className)},s&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(n,a,i){var s;return Q.isValidElement(n)?s=Q.cloneElement(n,a):mt(n)?s=n(a):s=Q.createElement(Uc,gc({},a,{className:"recharts-polar-angle-axis-tick-value"}),i),s}}])}(M.PureComponent);ib(sb,"displayName","PolarAngleAxis");ib(sb,"axisType","angleAxis");ib(sb,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var _we=DM,Dwe=_we(Object.getPrototypeOf,Object),ob=Dwe,jwe=Wo,Nwe=ob,Swe=ys,Ewe="[object Object]",Twe=Function.prototype,kwe=Object.prototype,b$=Twe.toString,Cwe=kwe.hasOwnProperty,Awe=b$.call(Object);function Owe(e){if(!Swe(e)||jwe(e)!=Ewe)return!1;var t=Nwe(e);if(t===null)return!0;var r=Cwe.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&b$.call(r)==Awe}var w$=Owe;const Fwe=At(w$);var Pwe=Wo,Iwe=ys,Rwe="[object Boolean]";function Mwe(e){return e===!0||e===!1||Iwe(e)&&Pwe(e)==Rwe}var Uwe=Mwe;const $we=At(Uwe);function jm(e){"@babel/helpers - typeof";return jm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jm(e)}function $g(){return $g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$g.apply(this,arguments)}function Lwe(e,t){return Hwe(e)||zwe(e,t)||Wwe(e,t)||Bwe()}function Bwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wwe(e,t){if(e){if(typeof e=="string")return uO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uO(e,t)}}function uO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zwe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function Hwe(e){if(Array.isArray(e))return e}function dO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dO(Object(r),!0).forEach(function(n){Vwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Vwe(e,t,r){return t=qwe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qwe(e){var t=Gwe(e,"string");return jm(t)=="symbol"?t:t+""}function Gwe(e,t){if(jm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(jm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hO=function(t,r,n,a,i){var s=n-a,l;return l="M ".concat(t,",").concat(r),l+="L ".concat(t+n,",").concat(r),l+="L ".concat(t+n-s/2,",").concat(r+i),l+="L ".concat(t+n-s/2-a,",").concat(r+i),l+="L ".concat(t,",").concat(r," Z"),l},Ywe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Xwe=function(t){var r=fO(fO({},Ywe),t),n=M.useRef(),a=M.useState(-1),i=Lwe(a,2),s=i[0],l=i[1];M.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var b=n.current.getTotalLength();b&&l(b)}catch{}},[]);var c=r.x,u=r.y,d=r.upperWidth,f=r.lowerWidth,h=r.height,m=r.className,x=r.animationEasing,p=r.animationDuration,g=r.animationBegin,v=r.isUpdateAnimationActive;if(c!==+c||u!==+u||d!==+d||f!==+f||h!==+h||d===0&&f===0||h===0)return null;var y=vt("recharts-trapezoid",m);return v?Q.createElement(ds,{canBegin:s>0,from:{upperWidth:0,lowerWidth:0,height:h,x:c,y:u},to:{upperWidth:d,lowerWidth:f,height:h,x:c,y:u},duration:p,animationEasing:x,isActive:v},function(b){var w=b.upperWidth,_=b.lowerWidth,D=b.height,j=b.x,N=b.y;return Q.createElement(ds,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:g,duration:p,easing:x},Q.createElement("path",$g({},ut(r,!0),{className:y,d:hO(j,N,w,_,D),ref:n})))}):Q.createElement("g",null,Q.createElement("path",$g({},ut(r,!0),{className:y,d:hO(c,u,d,f,h)})))},Kwe=["option","shapeType","propTransformer","activeClassName","isActive"];function Nm(e){"@babel/helpers - typeof";return Nm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nm(e)}function Zwe(e,t){if(e==null)return{};var r=Jwe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Jwe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function mO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Lg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mO(Object(r),!0).forEach(function(n){Qwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Qwe(e,t,r){return t=e2e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function e2e(e){var t=t2e(e,"string");return Nm(t)=="symbol"?t:t+""}function t2e(e,t){if(Nm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Nm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function r2e(e,t){return Lg(Lg({},t),e)}function n2e(e,t){return e==="symbols"}function pO(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return Q.createElement(AS,r);case"trapezoid":return Q.createElement(Xwe,r);case"sector":return Q.createElement(l$,r);case"symbols":if(n2e(t))return Q.createElement(zN,r);break;default:return null}}function _$(e){return M.isValidElement(e)?e.props:e}function OS(e){var t=e.option,r=e.shapeType,n=e.propTransformer,a=n===void 0?r2e:n,i=e.activeClassName,s=i===void 0?"recharts-active-shape":i,l=e.isActive,c=Zwe(e,Kwe),u;if(M.isValidElement(t))u=M.cloneElement(t,Lg(Lg({},c),_$(t)));else if(mt(t))u=t(c);else if(Fwe(t)&&!$we(t)){var d=a(t,c);u=Q.createElement(pO,{shapeType:r,elementProps:d})}else{var f=c;u=Q.createElement(pO,{shapeType:r,elementProps:f})}return l?Q.createElement(Rt,{className:s},u):u}function lb(e,t){return t!=null&&"trapezoids"in e.props}function cb(e,t){return t!=null&&"sectors"in e.props}function Sm(e,t){return t!=null&&"points"in e.props}function a2e(e,t){var r,n,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,i=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return a&&i}function i2e(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function s2e(e,t){var r=e.x===t.x,n=e.y===t.y,a=e.z===t.z;return r&&n&&a}function o2e(e,t){var r;return lb(e,t)?r=a2e:cb(e,t)?r=i2e:Sm(e,t)&&(r=s2e),r}function l2e(e,t){var r;return lb(e,t)?r="trapezoids":cb(e,t)?r="sectors":Sm(e,t)&&(r="points"),r}function c2e(e,t){if(lb(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(cb(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return Sm(e,t)?t.payload:{}}function u2e(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,a=l2e(r,t),i=c2e(r,t),s=n.filter(function(c,u){var d=lu(i,c),f=r.props[a].filter(function(x){var p=o2e(r,t);return p(x,t)}),h=r.props[a].indexOf(f[f.length-1]),m=u===h;return d&&m}),l=n.indexOf(s[s.length-1]);return l}var A0;function Sd(e){"@babel/helpers - typeof";return Sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sd(e)}function zu(){return zu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zu.apply(this,arguments)}function xO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function dr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xO(Object(r),!0).forEach(function(n){Ai(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function d2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,j$(n.key),n)}}function f2e(e,t,r){return t&&gO(e.prototype,t),r&&gO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function h2e(e,t,r){return t=Bg(t),m2e(e,D$()?Reflect.construct(t,r||[],Bg(e).constructor):t.apply(e,r))}function m2e(e,t){if(t&&(Sd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return p2e(e)}function p2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(D$=function(){return!!e})()}function Bg(e){return Bg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bg(e)}function x2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RD(e,t)}function RD(e,t){return RD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},RD(e,t)}function Ai(e,t,r){return t=j$(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function j$(e){var t=g2e(e,"string");return Sd(t)=="symbol"?t:t+""}function g2e(e,t){if(Sd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Sd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Bi=function(e){function t(r){var n;return d2e(this,t),n=h2e(this,t,[r]),Ai(n,"pieRef",null),Ai(n,"sectorRefs",[]),Ai(n,"id",mf("recharts-pie-")),Ai(n,"handleAnimationEnd",function(){var a=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),mt(a)&&a()}),Ai(n,"handleAnimationStart",function(){var a=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),mt(a)&&a()}),n.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},n}return x2e(t,e),f2e(t,[{key:"isActiveIndex",value:function(n){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(n)!==-1:n===a}},{key:"hasActiveIndex",value:function(){var n=this.props.activeIndex;return Array.isArray(n)?n.length!==0:n||n===0}},{key:"renderLabels",value:function(n){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var i=this.props,s=i.label,l=i.labelLine,c=i.dataKey,u=i.valueKey,d=ut(this.props,!1),f=ut(s,!1),h=ut(l,!1),m=s&&s.offsetRadius||20,x=n.map(function(p,g){var v=(p.startAngle+p.endAngle)/2,y=hr(p.cx,p.cy,p.outerRadius+m,v),b=dr(dr(dr(dr({},d),p),{},{stroke:"none"},f),{},{index:g,textAnchor:t.getTextAnchor(y.x,p.cx)},y),w=dr(dr(dr(dr({},d),p),{},{fill:"none",stroke:p.fill},h),{},{index:g,points:[hr(p.cx,p.cy,p.outerRadius,v),y]}),_=c;return yt(c)&&yt(u)?_="value":yt(c)&&(_=u),Q.createElement(Rt,{key:"label-".concat(p.startAngle,"-").concat(p.endAngle,"-").concat(p.midAngle,"-").concat(g)},l&&t.renderLabelLineItem(l,w,"line"),t.renderLabelItem(s,b,Or(p,_)))});return Q.createElement(Rt,{className:"recharts-pie-labels"},x)}},{key:"renderSectorsStatically",value:function(n){var a=this,i=this.props,s=i.activeShape,l=i.blendStroke,c=i.inactiveShape;return n.map(function(u,d){if((u==null?void 0:u.startAngle)===0&&(u==null?void 0:u.endAngle)===0&&n.length!==1)return null;var f=a.isActiveIndex(d),h=c&&a.hasActiveIndex()?c:null,m=f?s:h,x=dr(dr({},u),{},{stroke:l?u.fill:u.stroke,tabIndex:-1});return Q.createElement(Rt,zu({ref:function(g){g&&!a.sectorRefs.includes(g)&&a.sectorRefs.push(g)},tabIndex:-1,className:"recharts-pie-sector"},Sl(a.props,u,d),{key:"sector-".concat(u==null?void 0:u.startAngle,"-").concat(u==null?void 0:u.endAngle,"-").concat(u.midAngle,"-").concat(d)}),Q.createElement(OS,zu({option:m,isActive:f,shapeType:"sector"},x)))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,a=this.props,i=a.sectors,s=a.isAnimationActive,l=a.animationBegin,c=a.animationDuration,u=a.animationEasing,d=a.animationId,f=this.state,h=f.prevSectors,m=f.prevIsAnimationActive;return Q.createElement(ds,{begin:l,duration:c,isActive:s,easing:u,from:{t:0},to:{t:1},key:"pie-".concat(d,"-").concat(m),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(x){var p=x.t,g=[],v=i&&i[0],y=v.startAngle;return i.forEach(function(b,w){var _=h&&h[w],D=w>0?ni(b,"paddingAngle",0):0;if(_){var j=Ar(_.endAngle-_.startAngle,b.endAngle-b.startAngle),N=dr(dr({},b),{},{startAngle:y+D,endAngle:y+j(p)+D});g.push(N),y=N.endAngle}else{var S=b.endAngle,E=b.startAngle,A=Ar(0,S-E),T=A(p),L=dr(dr({},b),{},{startAngle:y+D,endAngle:y+T+D});g.push(L),y=L.endAngle}}),Q.createElement(Rt,null,n.renderSectorsStatically(g))})}},{key:"attachKeyboardHandlers",value:function(n){var a=this;n.onkeydown=function(i){if(!i.altKey)switch(i.key){case"ArrowLeft":{var s=++a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[s].focus(),a.setState({sectorToFocus:s});break}case"ArrowRight":{var l=--a.state.sectorToFocus<0?a.sectorRefs.length-1:a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[l].focus(),a.setState({sectorToFocus:l});break}case"Escape":{a.sectorRefs[a.state.sectorToFocus].blur(),a.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var n=this.props,a=n.sectors,i=n.isAnimationActive,s=this.state.prevSectors;return i&&a&&a.length&&(!s||!lu(s,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var n=this,a=this.props,i=a.hide,s=a.sectors,l=a.className,c=a.label,u=a.cx,d=a.cy,f=a.innerRadius,h=a.outerRadius,m=a.isAnimationActive,x=this.state.isAnimationFinished;if(i||!s||!s.length||!Be(u)||!Be(d)||!Be(f)||!Be(h))return null;var p=vt("recharts-pie",l);return Q.createElement(Rt,{tabIndex:this.props.rootTabIndex,className:p,ref:function(v){n.pieRef=v}},this.renderSectors(),c&&this.renderLabels(s),vn.renderCallByParent(this.props,null,!1),(!m||x)&&ls.renderCallByParent(this.props,s,!1))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return a.prevIsAnimationActive!==n.isAnimationActive?{prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:[],isAnimationFinished:!0}:n.isAnimationActive&&n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:a.curSectors,isAnimationFinished:!0}:n.sectors!==a.curSectors?{curSectors:n.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(n,a){return n>a?"start":n<a?"end":"middle"}},{key:"renderLabelLineItem",value:function(n,a,i){if(Q.isValidElement(n))return Q.cloneElement(n,a);if(mt(n))return n(a);var s=vt("recharts-pie-label-line",typeof n!="boolean"?n.className:"");return Q.createElement(Og,zu({},a,{key:i,type:"linear",className:s}))}},{key:"renderLabelItem",value:function(n,a,i){if(Q.isValidElement(n))return Q.cloneElement(n,a);var s=i;if(mt(n)&&(s=n(a),Q.isValidElement(s)))return s;var l=vt("recharts-pie-label-text",typeof n!="boolean"&&!mt(n)?n.className:"");return Q.createElement(Uc,zu({},a,{alignmentBaseline:"middle",className:l}),s)}}])}(M.PureComponent);A0=Bi;Ai(Bi,"displayName","Pie");Ai(Bi,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!Ul.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Ai(Bi,"parseDeltaAngle",function(e,t){var r=ga(t-e),n=Math.min(Math.abs(t-e),360);return r*n});Ai(Bi,"getRealPieData",function(e){var t=e.data,r=e.children,n=ut(e,!1),a=Oa(r,Ao);return t&&t.length?t.map(function(i,s){return dr(dr(dr({payload:i},n),i),a&&a[s]&&a[s].props)}):a&&a.length?a.map(function(i){return dr(dr({},n),i.props)}):[]});Ai(Bi,"parseCoordinateOfPie",function(e,t){var r=t.top,n=t.left,a=t.width,i=t.height,s=n$(a,i),l=n+va(e.cx,a,a/2),c=r+va(e.cy,i,i/2),u=va(e.innerRadius,s,0),d=va(e.outerRadius,s,s*.8),f=e.maxRadius||Math.sqrt(a*a+i*i)/2;return{cx:l,cy:c,innerRadius:u,outerRadius:d,maxRadius:f}});Ai(Bi,"getComposedData",function(e){var t=e.item,r=e.offset,n=t.type.defaultProps!==void 0?dr(dr({},t.type.defaultProps),t.props):t.props,a=A0.getRealPieData(n);if(!a||!a.length)return null;var i=n.cornerRadius,s=n.startAngle,l=n.endAngle,c=n.paddingAngle,u=n.dataKey,d=n.nameKey,f=n.valueKey,h=n.tooltipType,m=Math.abs(n.minAngle),x=A0.parseCoordinateOfPie(n,r),p=A0.parseDeltaAngle(s,l),g=Math.abs(p),v=u;yt(u)&&yt(f)?(os(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),v="value"):yt(u)&&(os(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),v=f);var y=a.filter(function(N){return Or(N,v,0)!==0}).length,b=(g>=360?y:y-1)*c,w=g-y*m-b,_=a.reduce(function(N,S){var E=Or(S,v,0);return N+(Be(E)?E:0)},0),D;if(_>0){var j;D=a.map(function(N,S){var E=Or(N,v,0),A=Or(N,d,S),T=(Be(E)?E:0)/_,L;S?L=j.endAngle+ga(p)*c*(E!==0?1:0):L=s;var O=L+ga(p)*((E!==0?m:0)+T*w),V=(L+O)/2,W=(x.innerRadius+x.outerRadius)/2,B=[{name:A,value:E,payload:N,dataKey:v,type:h}],P=hr(x.cx,x.cy,W,V);return j=dr(dr(dr({percent:T,cornerRadius:i,name:A,tooltipPayload:B,midAngle:V,middleRadius:W,tooltipPosition:P},N),x),{},{value:Or(N,v),startAngle:L,endAngle:O,payload:N,paddingAngle:ga(p)*c}),j})}return dr(dr({},x),{},{sectors:D,data:a})});var v2e=Math.ceil,y2e=Math.max;function b2e(e,t,r,n){for(var a=-1,i=y2e(v2e((t-e)/(r||1)),0),s=Array(i);i--;)s[n?i:++a]=e,e+=r;return s}var w2e=b2e,_2e=HM,vO=1/0,D2e=17976931348623157e292;function j2e(e){if(!e)return e===0?e:0;if(e=_2e(e),e===vO||e===-vO){var t=e<0?-1:1;return t*D2e}return e===e?e:0}var N$=j2e,N2e=w2e,S2e=bf,ww=N$;function E2e(e){return function(t,r,n){return n&&typeof n!="number"&&S2e(t,r,n)&&(r=n=void 0),t=ww(t),r===void 0?(r=t,t=0):r=ww(r),n=n===void 0?t<r?1:-1:ww(n),N2e(t,r,n,e)}}var T2e=E2e,k2e=T2e,C2e=k2e(),A2e=C2e;const Em=At(A2e);function Tm(e){"@babel/helpers - typeof";return Tm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tm(e)}function yO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yO(Object(r),!0).forEach(function(n){S$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function S$(e,t,r){return t=O2e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O2e(e){var t=F2e(e,"string");return Tm(t)=="symbol"?t:t+""}function F2e(e,t){if(Tm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Tm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var P2e=["Webkit","Moz","O","ms"],I2e=function(t,r){var n=t.replace(/(\w)/,function(i){return i.toUpperCase()}),a=P2e.reduce(function(i,s){return bO(bO({},i),{},S$({},s+n,r))},{});return a[t]=r,a};function Ed(e){"@babel/helpers - typeof";return Ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ed(e)}function Wg(){return Wg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wg.apply(this,arguments)}function wO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _w(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wO(Object(r),!0).forEach(function(n){Ga(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function R2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _O(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,T$(n.key),n)}}function M2e(e,t,r){return t&&_O(e.prototype,t),r&&_O(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function U2e(e,t,r){return t=zg(t),$2e(e,E$()?Reflect.construct(t,r||[],zg(e).constructor):t.apply(e,r))}function $2e(e,t){if(t&&(Ed(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return L2e(e)}function L2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(E$=function(){return!!e})()}function zg(e){return zg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zg(e)}function B2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MD(e,t)}function MD(e,t){return MD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},MD(e,t)}function Ga(e,t,r){return t=T$(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T$(e){var t=W2e(e,"string");return Ed(t)=="symbol"?t:t+""}function W2e(e,t){if(Ed(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ed(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var z2e=function(t){var r=t.data,n=t.startIndex,a=t.endIndex,i=t.x,s=t.width,l=t.travellerWidth;if(!r||!r.length)return{};var c=r.length,u=kh().domain(Em(0,c)).range([i,i+s-l]),d=u.domain().map(function(f){return u(f)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:u(n),endX:u(a),scale:u,scaleValues:d}},DO=function(t){return t.changedTouches&&!!t.changedTouches.length},Td=function(e){function t(r){var n;return R2e(this,t),n=U2e(this,t,[r]),Ga(n,"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),Ga(n,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),Ga(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,i=a.endIndex,s=a.onDragEnd,l=a.startIndex;s==null||s({endIndex:i,startIndex:l})}),n.detachDragEndListener()}),Ga(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),Ga(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),Ga(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),Ga(n,"handleSlideDragStart",function(a){var i=DO(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return B2e(t,e),M2e(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,i=n.endX,s=this.state.scaleValues,l=this.props,c=l.gap,u=l.data,d=u.length-1,f=Math.min(a,i),h=Math.max(a,i),m=t.getIndexInRange(s,f),x=t.getIndexInRange(s,h);return{startIndex:m-m%c,endIndex:x===d?d:x-x%c}}},{key:"getTextOfTick",value:function(n){var a=this.props,i=a.data,s=a.tickFormatter,l=a.dataKey,c=Or(i[n],l,n);return mt(s)?s(c,n):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,i=a.slideMoveStartX,s=a.startX,l=a.endX,c=this.props,u=c.x,d=c.width,f=c.travellerWidth,h=c.startIndex,m=c.endIndex,x=c.onChange,p=n.pageX-i;p>0?p=Math.min(p,u+d-f-l,u+d-f-s):p<0&&(p=Math.max(p,u-s,u-l));var g=this.getIndex({startX:s+p,endX:l+p});(g.startIndex!==h||g.endIndex!==m)&&x&&x(g),this.setState({startX:s+p,endX:l+p,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var i=DO(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,i=a.brushMoveStartX,s=a.movingTravellerId,l=a.endX,c=a.startX,u=this.state[s],d=this.props,f=d.x,h=d.width,m=d.travellerWidth,x=d.onChange,p=d.gap,g=d.data,v={startX:this.state.startX,endX:this.state.endX},y=n.pageX-i;y>0?y=Math.min(y,f+h-m-u):y<0&&(y=Math.max(y,f-u)),v[s]=u+y;var b=this.getIndex(v),w=b.startIndex,_=b.endIndex,D=function(){var N=g.length-1;return s==="startX"&&(l>c?w%p===0:_%p===0)||l<c&&_===N||s==="endX"&&(l>c?_%p===0:w%p===0)||l>c&&_===N};this.setState(Ga(Ga({},s,u+y),"brushMoveStartX",n.pageX),function(){x&&D()&&x(b)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var i=this,s=this.state,l=s.scaleValues,c=s.startX,u=s.endX,d=this.state[a],f=l.indexOf(d);if(f!==-1){var h=f+n;if(!(h===-1||h>=l.length)){var m=l[h];a==="startX"&&m>=u||a==="endX"&&m<=c||this.setState(Ga({},a,m),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,i=n.y,s=n.width,l=n.height,c=n.fill,u=n.stroke;return Q.createElement("rect",{stroke:u,fill:c,x:a,y:i,width:s,height:l})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,i=n.y,s=n.width,l=n.height,c=n.data,u=n.children,d=n.padding,f=M.Children.only(u);return f?Q.cloneElement(f,{x:a,y:i,width:s,height:l,margin:d,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(n,a){var i,s,l=this,c=this.props,u=c.y,d=c.travellerWidth,f=c.height,h=c.traveller,m=c.ariaLabel,x=c.data,p=c.startIndex,g=c.endIndex,v=Math.max(n,this.props.x),y=_w(_w({},ut(this.props,!1)),{},{x:v,y:u,width:d,height:f}),b=m||"Min value: ".concat((i=x[p])===null||i===void 0?void 0:i.name,", Max value: ").concat((s=x[g])===null||s===void 0?void 0:s.name);return Q.createElement(Rt,{tabIndex:0,role:"slider","aria-label":b,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(_){["ArrowLeft","ArrowRight"].includes(_.key)&&(_.preventDefault(),_.stopPropagation(),l.handleTravellerMoveKeyboard(_.key==="ArrowRight"?1:-1,a))},onFocus:function(){l.setState({isTravellerFocused:!0})},onBlur:function(){l.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(h,y))}},{key:"renderSlide",value:function(n,a){var i=this.props,s=i.y,l=i.height,c=i.stroke,u=i.travellerWidth,d=Math.min(n,a)+u,f=Math.max(Math.abs(a-n)-u,0);return Q.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:d,y:s,width:f,height:l})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,i=n.endIndex,s=n.y,l=n.height,c=n.travellerWidth,u=n.stroke,d=this.state,f=d.startX,h=d.endX,m=5,x={pointerEvents:"none",fill:u};return Q.createElement(Rt,{className:"recharts-brush-texts"},Q.createElement(Uc,Wg({textAnchor:"end",verticalAnchor:"middle",x:Math.min(f,h)-m,y:s+l/2},x),this.getTextOfTick(a)),Q.createElement(Uc,Wg({textAnchor:"start",verticalAnchor:"middle",x:Math.max(f,h)+c+m,y:s+l/2},x),this.getTextOfTick(i)))}},{key:"render",value:function(){var n=this.props,a=n.data,i=n.className,s=n.children,l=n.x,c=n.y,u=n.width,d=n.height,f=n.alwaysShowText,h=this.state,m=h.startX,x=h.endX,p=h.isTextActive,g=h.isSlideMoving,v=h.isTravellerMoving,y=h.isTravellerFocused;if(!a||!a.length||!Be(l)||!Be(c)||!Be(u)||!Be(d)||u<=0||d<=0)return null;var b=vt("recharts-brush",i),w=Q.Children.count(s)===1,_=I2e("userSelect","none");return Q.createElement(Rt,{className:b,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:_},this.renderBackground(),w&&this.renderPanorama(),this.renderSlide(m,x),this.renderTravellerLayer(m,"startX"),this.renderTravellerLayer(x,"endX"),(p||g||v||y||f)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,i=n.y,s=n.width,l=n.height,c=n.stroke,u=Math.floor(i+l/2)-1;return Q.createElement(Q.Fragment,null,Q.createElement("rect",{x:a,y:i,width:s,height:l,fill:c,stroke:"none"}),Q.createElement("line",{x1:a+1,y1:u,x2:a+s-1,y2:u,fill:"none",stroke:"#fff"}),Q.createElement("line",{x1:a+1,y1:u+2,x2:a+s-1,y2:u+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var i;return Q.isValidElement(n)?i=Q.cloneElement(n,a):mt(n)?i=n(a):i=t.renderDefaultTraveller(a),i}},{key:"getDerivedStateFromProps",value:function(n,a){var i=n.data,s=n.width,l=n.x,c=n.travellerWidth,u=n.updateId,d=n.startIndex,f=n.endIndex;if(i!==a.prevData||u!==a.prevUpdateId)return _w({prevData:i,prevTravellerWidth:c,prevUpdateId:u,prevX:l,prevWidth:s},i&&i.length?z2e({data:i,width:s,x:l,travellerWidth:c,startIndex:d,endIndex:f}):{scale:null,scaleValues:null});if(a.scale&&(s!==a.prevWidth||l!==a.prevX||c!==a.prevTravellerWidth)){a.scale.range([l,l+s-c]);var h=a.scale.domain().map(function(m){return a.scale(m)});return{prevData:i,prevTravellerWidth:c,prevUpdateId:u,prevX:l,prevWidth:s,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:h}}return null}},{key:"getIndexInRange",value:function(n,a){for(var i=n.length,s=0,l=i-1;l-s>1;){var c=Math.floor((s+l)/2);n[c]>a?l=c:s=c}return a>=n[l]?l:s}}])}(M.PureComponent);Ga(Td,"displayName","Brush");Ga(Td,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var H2e=aS;function V2e(e,t){var r;return H2e(e,function(n,a,i){return r=t(n,a,i),!r}),!!r}var q2e=V2e,G2e=pM,Y2e=ws,X2e=q2e,K2e=sa,Z2e=bf;function J2e(e,t,r){var n=K2e(e)?G2e:X2e;return r&&Z2e(e,t,r)&&(t=void 0),n(e,Y2e(t))}var Q2e=J2e;const e_e=At(Q2e);var Ms=function(t,r){var n=t.alwaysShow,a=t.ifOverflow;return n&&(a="extendDomain"),a===r},jO=MM;function t_e(e,t,r){t=="__proto__"&&jO?jO(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var FS=t_e,r_e=FS,n_e=nS,a_e=ws;function i_e(e,t){var r={};return t=a_e(t),n_e(e,function(n,a,i){r_e(r,a,t(n,a,i))}),r}var s_e=i_e;const k$=At(s_e);function o_e(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var l_e=o_e,c_e=aS;function u_e(e,t){var r=!0;return c_e(e,function(n,a,i){return r=!!t(n,a,i),r}),r}var d_e=u_e,f_e=l_e,h_e=d_e,m_e=ws,p_e=sa,x_e=bf;function g_e(e,t,r){var n=p_e(e)?f_e:h_e;return r&&x_e(e,t,r)&&(t=void 0),n(e,m_e(t))}var v_e=g_e;const C$=At(v_e);var y_e=["x","y"];function km(e){"@babel/helpers - typeof";return km=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},km(e)}function UD(){return UD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},UD.apply(this,arguments)}function NO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ih(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NO(Object(r),!0).forEach(function(n){b_e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function b_e(e,t,r){return t=w_e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w_e(e){var t=__e(e,"string");return km(t)=="symbol"?t:t+""}function __e(e,t){if(km(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(km(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function D_e(e,t){if(e==null)return{};var r=j_e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function j_e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function N_e(e,t){var r=e.x,n=e.y,a=D_e(e,y_e),i="".concat(r),s=parseInt(i,10),l="".concat(n),c=parseInt(l,10),u="".concat(t.height||a.height),d=parseInt(u,10),f="".concat(t.width||a.width),h=parseInt(f,10);return ih(ih(ih(ih(ih({},t),a),s?{x:s}:{}),c?{y:c}:{}),{},{height:d,width:h,name:t.name,radius:t.radius})}function SO(e){return Q.createElement(OS,UD({shapeType:"rectangle",propTransformer:N_e,activeClassName:"recharts-active-bar"},e))}var S_e=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,a){if(typeof t=="number")return t;var i=Be(n)||vae(n);return i?t(n,a):(i||Dl(),r)}},E_e=["value","background"],A$;function kd(e){"@babel/helpers - typeof";return kd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kd(e)}function T_e(e,t){if(e==null)return{};var r=k_e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function k_e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Hg(){return Hg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Hg.apply(this,arguments)}function EO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Jr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EO(Object(r),!0).forEach(function(n){ll(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function C_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,F$(n.key),n)}}function A_e(e,t,r){return t&&TO(e.prototype,t),r&&TO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function O_e(e,t,r){return t=Vg(t),F_e(e,O$()?Reflect.construct(t,r||[],Vg(e).constructor):t.apply(e,r))}function F_e(e,t){if(t&&(kd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return P_e(e)}function P_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(O$=function(){return!!e})()}function Vg(e){return Vg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vg(e)}function I_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$D(e,t)}function $D(e,t){return $D=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},$D(e,t)}function ll(e,t,r){return t=F$(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F$(e){var t=R_e(e,"string");return kd(t)=="symbol"?t:t+""}function R_e(e,t){if(kd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(kd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ai=function(e){function t(){var r;C_e(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=O_e(this,t,[].concat(a)),ll(r,"state",{isAnimationFinished:!1}),ll(r,"id",mf("recharts-bar-")),ll(r,"handleAnimationEnd",function(){var s=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),s&&s()}),ll(r,"handleAnimationStart",function(){var s=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),s&&s()}),r}return I_e(t,e),A_e(t,[{key:"renderRectanglesStatically",value:function(n){var a=this,i=this.props,s=i.shape,l=i.dataKey,c=i.activeIndex,u=i.activeBar,d=ut(this.props,!1);return n&&n.map(function(f,h){var m=h===c,x=m?u:s,p=Jr(Jr(Jr({},d),f),{},{isActive:m,option:x,index:h,dataKey:l,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return Q.createElement(Rt,Hg({className:"recharts-bar-rectangle"},Sl(a.props,f,h),{key:"rectangle-".concat(f==null?void 0:f.x,"-").concat(f==null?void 0:f.y,"-").concat(f==null?void 0:f.value,"-").concat(h)}),Q.createElement(SO,p))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,a=this.props,i=a.data,s=a.layout,l=a.isAnimationActive,c=a.animationBegin,u=a.animationDuration,d=a.animationEasing,f=a.animationId,h=this.state.prevData;return Q.createElement(ds,{begin:c,duration:u,isActive:l,easing:d,from:{t:0},to:{t:1},key:"bar-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(m){var x=m.t,p=i.map(function(g,v){var y=h&&h[v];if(y){var b=Ar(y.x,g.x),w=Ar(y.y,g.y),_=Ar(y.width,g.width),D=Ar(y.height,g.height);return Jr(Jr({},g),{},{x:b(x),y:w(x),width:_(x),height:D(x)})}if(s==="horizontal"){var j=Ar(0,g.height),N=j(x);return Jr(Jr({},g),{},{y:g.y+g.height-N,height:N})}var S=Ar(0,g.width),E=S(x);return Jr(Jr({},g),{},{width:E})});return Q.createElement(Rt,null,n.renderRectanglesStatically(p))})}},{key:"renderRectangles",value:function(){var n=this.props,a=n.data,i=n.isAnimationActive,s=this.state.prevData;return i&&a&&a.length&&(!s||!lu(s,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var n=this,a=this.props,i=a.data,s=a.dataKey,l=a.activeIndex,c=ut(this.props.background,!1);return i.map(function(u,d){u.value;var f=u.background,h=T_e(u,E_e);if(!f)return null;var m=Jr(Jr(Jr(Jr(Jr({},h),{},{fill:"#eee"},f),c),Sl(n.props,u,d)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:s,index:d,className:"recharts-bar-background-rectangle"});return Q.createElement(SO,Hg({key:"background-bar-".concat(d),option:n.props.background,isActive:d===l},m))})}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,s=i.data,l=i.xAxis,c=i.yAxis,u=i.layout,d=i.children,f=Oa(d,ex);if(!f)return null;var h=u==="vertical"?s[0].height/2:s[0].width/2,m=function(g,v){var y=Array.isArray(g.value)?g.value[1]:g.value;return{x:g.x,y:g.y,value:y,errorVal:Or(g,v)}},x={clipPath:n?"url(#clipPath-".concat(a,")"):null};return Q.createElement(Rt,x,f.map(function(p){return Q.cloneElement(p,{key:"error-bar-".concat(a,"-").concat(p.props.dataKey),data:s,xAxis:l,yAxis:c,layout:u,offset:h,dataPointFormatter:m})}))}},{key:"render",value:function(){var n=this.props,a=n.hide,i=n.data,s=n.className,l=n.xAxis,c=n.yAxis,u=n.left,d=n.top,f=n.width,h=n.height,m=n.isAnimationActive,x=n.background,p=n.id;if(a||!i||!i.length)return null;var g=this.state.isAnimationFinished,v=vt("recharts-bar",s),y=l&&l.allowDataOverflow,b=c&&c.allowDataOverflow,w=y||b,_=yt(p)?this.id:p;return Q.createElement(Rt,{className:v},y||b?Q.createElement("defs",null,Q.createElement("clipPath",{id:"clipPath-".concat(_)},Q.createElement("rect",{x:y?u:u-f/2,y:b?d:d-h/2,width:y?f:f*2,height:b?h:h*2}))):null,Q.createElement(Rt,{className:"recharts-bar-rectangles",clipPath:w?"url(#clipPath-".concat(_,")"):null},x?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(w,_),(!m||g)&&ls.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(M.PureComponent);A$=ai;ll(ai,"displayName","Bar");ll(ai,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Ul.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});ll(ai,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,a=e.bandSize,i=e.xAxis,s=e.yAxis,l=e.xAxisTicks,c=e.yAxisTicks,u=e.stackedData,d=e.dataStartIndex,f=e.displayedData,h=e.offset,m=Dve(n,r);if(!m)return null;var x=t.layout,p=r.type.defaultProps,g=p!==void 0?Jr(Jr({},p),r.props):r.props,v=g.dataKey,y=g.children,b=g.minPointSize,w=x==="horizontal"?s:i,_=u?w.scale.domain():null,D=Cve({numericAxis:w}),j=Oa(y,Ao),N=f.map(function(S,E){var A,T,L,O,V,W;u?A=jve(u[d+E],_):(A=Or(S,v),Array.isArray(A)||(A=[D,A]));var B=S_e(b,A$.defaultProps.minPointSize)(A[1],E);if(x==="horizontal"){var P,F=[s.scale(A[0]),s.scale(A[1])],I=F[0],R=F[1];T=x4({axis:i,ticks:l,bandSize:a,offset:m.offset,entry:S,index:E}),L=(P=R??I)!==null&&P!==void 0?P:void 0,O=m.size;var C=I-R;if(V=Number.isNaN(C)?0:C,W={x:T,y:s.y,width:O,height:s.height},Math.abs(B)>0&&Math.abs(V)<Math.abs(B)){var k=ga(V||B)*(Math.abs(B)-Math.abs(V));L-=k,V+=k}}else{var z=[i.scale(A[0]),i.scale(A[1])],q=z[0],K=z[1];if(T=q,L=x4({axis:s,ticks:c,bandSize:a,offset:m.offset,entry:S,index:E}),O=K-q,V=m.size,W={x:i.x,y:L,width:i.width,height:V},Math.abs(B)>0&&Math.abs(O)<Math.abs(B)){var se=ga(O||B)*(Math.abs(B)-Math.abs(O));O+=se}}return Jr(Jr(Jr({},S),{},{x:T,y:L,width:O,height:V,value:u?A:A[1],payload:S,background:W},j&&j[E]&&j[E].props),{},{tooltipPayload:[t$(r,S)],tooltipPosition:{x:T+O/2,y:L+V/2}})});return Jr({data:N,layout:x},h)});function Cm(e){"@babel/helpers - typeof";return Cm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cm(e)}function M_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P$(n.key),n)}}function U_e(e,t,r){return t&&kO(e.prototype,t),r&&kO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ji(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CO(Object(r),!0).forEach(function(n){ub(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ub(e,t,r){return t=P$(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P$(e){var t=$_e(e,"string");return Cm(t)=="symbol"?t:t+""}function $_e(e,t){if(Cm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Cm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var I$=function(t,r,n,a,i){var s=t.width,l=t.height,c=t.layout,u=t.children,d=Object.keys(r),f={left:n.left,leftMirror:n.left,right:s-n.right,rightMirror:s-n.right,top:n.top,topMirror:n.top,bottom:l-n.bottom,bottomMirror:l-n.bottom},h=!!Ya(u,ai);return d.reduce(function(m,x){var p=r[x],g=p.orientation,v=p.domain,y=p.padding,b=y===void 0?{}:y,w=p.mirror,_=p.reversed,D="".concat(g).concat(w?"Mirror":""),j,N,S,E,A;if(p.type==="number"&&(p.padding==="gap"||p.padding==="no-gap")){var T=v[1]-v[0],L=1/0,O=p.categoricalDomain.sort(wae);if(O.forEach(function(z,q){q>0&&(L=Math.min((z||0)-(O[q-1]||0),L))}),Number.isFinite(L)){var V=L/T,W=p.layout==="vertical"?n.height:n.width;if(p.padding==="gap"&&(j=V*W/2),p.padding==="no-gap"){var B=va(t.barCategoryGap,V*W),P=V*W/2;j=P-B-(P-B)/W*B}}}a==="xAxis"?N=[n.left+(b.left||0)+(j||0),n.left+n.width-(b.right||0)-(j||0)]:a==="yAxis"?N=c==="horizontal"?[n.top+n.height-(b.bottom||0),n.top+(b.top||0)]:[n.top+(b.top||0)+(j||0),n.top+n.height-(b.bottom||0)-(j||0)]:N=p.range,_&&(N=[N[1],N[0]]);var F=ZU(p,i,h),I=F.scale,R=F.realScaleType;I.domain(v).range(N),JU(I);var C=QU(I,Ji(Ji({},p),{},{realScaleType:R}));a==="xAxis"?(A=g==="top"&&!w||g==="bottom"&&w,S=n.left,E=f[D]-A*p.height):a==="yAxis"&&(A=g==="left"&&!w||g==="right"&&w,S=f[D]-A*p.width,E=n.top);var k=Ji(Ji(Ji({},p),C),{},{realScaleType:R,x:S,y:E,scale:I,width:a==="xAxis"?n.width:p.width,height:a==="yAxis"?n.height:p.height});return k.bandSize=kg(k,C),!p.hide&&a==="xAxis"?f[D]+=(A?-1:1)*k.height:p.hide||(f[D]+=(A?-1:1)*k.width),Ji(Ji({},m),{},ub({},x,k))},{})},R$=function(t,r){var n=t.x,a=t.y,i=r.x,s=r.y;return{x:Math.min(n,i),y:Math.min(a,s),width:Math.abs(i-n),height:Math.abs(s-a)}},L_e=function(t){var r=t.x1,n=t.y1,a=t.x2,i=t.y2;return R$({x:r,y:n},{x:a,y:i})},M$=function(){function e(t){M_e(this,e),this.scale=t}return U_e(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,i=n.position;if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+s}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(r)+l}default:return this.scale(r)}if(a){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+c}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),a=n[0],i=n[n.length-1];return a<=i?r>=a&&r<=i:r>=i&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}])}();ub(M$,"EPS",1e-4);var PS=function(t){var r=Object.keys(t).reduce(function(n,a){return Ji(Ji({},n),{},ub({},a,M$.create(t[a])))},{});return Ji(Ji({},r),{},{apply:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.bandAware,l=i.position;return k$(a,function(c,u){return r[u].apply(c,{bandAware:s,position:l})})},isInRange:function(a){return C$(a,function(i,s){return r[s].isInRange(i)})}})};function B_e(e){return(e%180+180)%180}var W_e=function(t){var r=t.width,n=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=B_e(a),s=i*Math.PI/180,l=Math.atan(n/r),c=s>l&&s<Math.PI-l?n/Math.sin(s):r/Math.cos(s);return Math.abs(c)},z_e=ws,H_e=xf,V_e=gf;function q_e(e){return function(t,r,n){var a=Object(t);if(!H_e(t)){var i=z_e(r);t=V_e(t),r=function(l){return i(a[l],l,a)}}var s=e(t,r,n);return s>-1?a[i?t[s]:s]:void 0}}var G_e=q_e,Y_e=N$;function X_e(e){var t=Y_e(e),r=t%1;return t===t?r?t-r:t:0}var U$=X_e,K_e=CM,Z_e=ws,J_e=U$,Q_e=Math.max;function eDe(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=r==null?0:J_e(r);return a<0&&(a=Q_e(n+a,0)),K_e(e,Z_e(t),a)}var $$=eDe;const tDe=At($$);var rDe=G_e,nDe=$$,aDe=rDe(nDe),iDe=aDe;const sDe=At(iDe);var oDe=Nne(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),IS=M.createContext(void 0),RS=M.createContext(void 0),L$=M.createContext(void 0),B$=M.createContext({}),W$=M.createContext(void 0),z$=M.createContext(0),H$=M.createContext(0),AO=function(t){var r=t.state,n=r.xAxisMap,a=r.yAxisMap,i=r.offset,s=t.clipPathId,l=t.children,c=t.width,u=t.height,d=oDe(i);return Q.createElement(IS.Provider,{value:n},Q.createElement(RS.Provider,{value:a},Q.createElement(B$.Provider,{value:i},Q.createElement(L$.Provider,{value:d},Q.createElement(W$.Provider,{value:s},Q.createElement(z$.Provider,{value:u},Q.createElement(H$.Provider,{value:c},l)))))))},lDe=function(){return M.useContext(W$)},V$=function(t){var r=M.useContext(IS);r==null&&Dl();var n=r[t];return n==null&&Dl(),n},cDe=function(){var t=M.useContext(IS);return ol(t)},uDe=function(){var t=M.useContext(RS),r=sDe(t,function(n){return C$(n.domain,Number.isFinite)});return r||ol(t)},q$=function(t){var r=M.useContext(RS);r==null&&Dl();var n=r[t];return n==null&&Dl(),n},dDe=function(){var t=M.useContext(L$);return t},fDe=function(){return M.useContext(B$)},MS=function(){return M.useContext(H$)},US=function(){return M.useContext(z$)};function Cd(e){"@babel/helpers - typeof";return Cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cd(e)}function hDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mDe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Y$(n.key),n)}}function pDe(e,t,r){return t&&mDe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function xDe(e,t,r){return t=qg(t),gDe(e,G$()?Reflect.construct(t,r||[],qg(e).constructor):t.apply(e,r))}function gDe(e,t){if(t&&(Cd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vDe(e)}function vDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function G$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(G$=function(){return!!e})()}function qg(e){return qg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qg(e)}function yDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LD(e,t)}function LD(e,t){return LD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},LD(e,t)}function OO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function FO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?OO(Object(r),!0).forEach(function(n){$S(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $S(e,t,r){return t=Y$(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Y$(e){var t=bDe(e,"string");return Cd(t)=="symbol"?t:t+""}function bDe(e,t){if(Cd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Cd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function wDe(e,t){return NDe(e)||jDe(e,t)||DDe(e,t)||_De()}function _De(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DDe(e,t){if(e){if(typeof e=="string")return PO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PO(e,t)}}function PO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function NDe(e){if(Array.isArray(e))return e}function BD(){return BD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},BD.apply(this,arguments)}var SDe=function(t,r){var n;return Q.isValidElement(t)?n=Q.cloneElement(t,r):mt(t)?n=t(r):n=Q.createElement("line",BD({},r,{className:"recharts-reference-line-line"})),n},EDe=function(t,r,n,a,i,s,l,c,u){var d=i.x,f=i.y,h=i.width,m=i.height;if(n){var x=u.y,p=t.y.apply(x,{position:s});if(Ms(u,"discard")&&!t.y.isInRange(p))return null;var g=[{x:d+h,y:p},{x:d,y:p}];return c==="left"?g.reverse():g}if(r){var v=u.x,y=t.x.apply(v,{position:s});if(Ms(u,"discard")&&!t.x.isInRange(y))return null;var b=[{x:y,y:f+m},{x:y,y:f}];return l==="top"?b.reverse():b}if(a){var w=u.segment,_=w.map(function(D){return t.apply(D,{position:s})});return Ms(u,"discard")&&e_e(_,function(D){return!t.isInRange(D)})?null:_}return null};function TDe(e){var t=e.x,r=e.y,n=e.segment,a=e.xAxisId,i=e.yAxisId,s=e.shape,l=e.className,c=e.alwaysShow,u=lDe(),d=V$(a),f=q$(i),h=dDe();if(!u||!h)return null;os(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var m=PS({x:d.scale,y:f.scale}),x=cn(t),p=cn(r),g=n&&n.length===2,v=EDe(m,x,p,g,h,e.position,d.orientation,f.orientation,e);if(!v)return null;var y=wDe(v,2),b=y[0],w=b.x,_=b.y,D=y[1],j=D.x,N=D.y,S=Ms(e,"hidden")?"url(#".concat(u,")"):void 0,E=FO(FO({clipPath:S},ut(e,!0)),{},{x1:w,y1:_,x2:j,y2:N});return Q.createElement(Rt,{className:vt("recharts-reference-line",l)},SDe(s,E),vn.renderCallByParent(e,L_e({x1:w,y1:_,x2:j,y2:N})))}var LS=function(e){function t(){return hDe(this,t),xDe(this,t,arguments)}return yDe(t,e),pDe(t,[{key:"render",value:function(){return Q.createElement(TDe,this.props)}}])}(Q.Component);$S(LS,"displayName","ReferenceLine");$S(LS,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function WD(){return WD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},WD.apply(this,arguments)}function Ad(e){"@babel/helpers - typeof";return Ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ad(e)}function IO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function RO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IO(Object(r),!0).forEach(function(n){db(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CDe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,K$(n.key),n)}}function ADe(e,t,r){return t&&CDe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ODe(e,t,r){return t=Gg(t),FDe(e,X$()?Reflect.construct(t,r||[],Gg(e).constructor):t.apply(e,r))}function FDe(e,t){if(t&&(Ad(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PDe(e)}function PDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function X$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(X$=function(){return!!e})()}function Gg(e){return Gg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gg(e)}function IDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zD(e,t)}function zD(e,t){return zD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},zD(e,t)}function db(e,t,r){return t=K$(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K$(e){var t=RDe(e,"string");return Ad(t)=="symbol"?t:t+""}function RDe(e,t){if(Ad(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ad(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var MDe=function(t){var r=t.x,n=t.y,a=t.xAxis,i=t.yAxis,s=PS({x:a.scale,y:i.scale}),l=s.apply({x:r,y:n},{bandAware:!0});return Ms(t,"discard")&&!s.isInRange(l)?null:l},fb=function(e){function t(){return kDe(this,t),ODe(this,t,arguments)}return IDe(t,e),ADe(t,[{key:"render",value:function(){var n=this.props,a=n.x,i=n.y,s=n.r,l=n.alwaysShow,c=n.clipPathId,u=cn(a),d=cn(i);if(os(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!u||!d)return null;var f=MDe(this.props);if(!f)return null;var h=f.x,m=f.y,x=this.props,p=x.shape,g=x.className,v=Ms(this.props,"hidden")?"url(#".concat(c,")"):void 0,y=RO(RO({clipPath:v},ut(this.props,!0)),{},{cx:h,cy:m});return Q.createElement(Rt,{className:vt("recharts-reference-dot",g)},t.renderDot(p,y),vn.renderCallByParent(this.props,{x:h-s,y:m-s,width:2*s,height:2*s}))}}])}(Q.Component);db(fb,"displayName","ReferenceDot");db(fb,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});db(fb,"renderDot",function(e,t){var r;return Q.isValidElement(e)?r=Q.cloneElement(e,t):mt(e)?r=e(t):r=Q.createElement(rb,WD({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function HD(){return HD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},HD.apply(this,arguments)}function Od(e){"@babel/helpers - typeof";return Od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Od(e)}function MO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function UO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?MO(Object(r),!0).forEach(function(n){hb(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):MO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function UDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $De(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,J$(n.key),n)}}function LDe(e,t,r){return t&&$De(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function BDe(e,t,r){return t=Yg(t),WDe(e,Z$()?Reflect.construct(t,r||[],Yg(e).constructor):t.apply(e,r))}function WDe(e,t){if(t&&(Od(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zDe(e)}function zDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Z$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Z$=function(){return!!e})()}function Yg(e){return Yg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Yg(e)}function HDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&VD(e,t)}function VD(e,t){return VD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},VD(e,t)}function hb(e,t,r){return t=J$(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J$(e){var t=VDe(e,"string");return Od(t)=="symbol"?t:t+""}function VDe(e,t){if(Od(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Od(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var qDe=function(t,r,n,a,i){var s=i.x1,l=i.x2,c=i.y1,u=i.y2,d=i.xAxis,f=i.yAxis;if(!d||!f)return null;var h=PS({x:d.scale,y:f.scale}),m={x:t?h.x.apply(s,{position:"start"}):h.x.rangeMin,y:n?h.y.apply(c,{position:"start"}):h.y.rangeMin},x={x:r?h.x.apply(l,{position:"end"}):h.x.rangeMax,y:a?h.y.apply(u,{position:"end"}):h.y.rangeMax};return Ms(i,"discard")&&(!h.isInRange(m)||!h.isInRange(x))?null:R$(m,x)},mb=function(e){function t(){return UDe(this,t),BDe(this,t,arguments)}return HDe(t,e),LDe(t,[{key:"render",value:function(){var n=this.props,a=n.x1,i=n.x2,s=n.y1,l=n.y2,c=n.className,u=n.alwaysShow,d=n.clipPathId;os(u===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=cn(a),h=cn(i),m=cn(s),x=cn(l),p=this.props.shape;if(!f&&!h&&!m&&!x&&!p)return null;var g=qDe(f,h,m,x,this.props);if(!g&&!p)return null;var v=Ms(this.props,"hidden")?"url(#".concat(d,")"):void 0;return Q.createElement(Rt,{className:vt("recharts-reference-area",c)},t.renderRect(p,UO(UO({clipPath:v},ut(this.props,!0)),g)),vn.renderCallByParent(this.props,g))}}])}(Q.Component);hb(mb,"displayName","ReferenceArea");hb(mb,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});hb(mb,"renderRect",function(e,t){var r;return Q.isValidElement(e)?r=Q.cloneElement(e,t):mt(e)?r=e(t):r=Q.createElement(AS,HD({},t,{className:"recharts-reference-area-rect"})),r});function Q$(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function GDe(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return W_e(n,r)}function YDe(e,t,r){var n=r==="width",a=e.x,i=e.y,s=e.width,l=e.height;return t===1?{start:n?a:i,end:n?a+s:i+l}:{start:n?a+s:i+l,end:n?a:i}}function Xg(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function XDe(e,t){return Q$(e,t+1)}function KDe(e,t,r,n,a){for(var i=(n||[]).slice(),s=t.start,l=t.end,c=0,u=1,d=s,f=function(){var x=n==null?void 0:n[c];if(x===void 0)return{v:Q$(n,u)};var p=c,g,v=function(){return g===void 0&&(g=r(x,p)),g},y=x.coordinate,b=c===0||Xg(e,y,v,d,l);b||(c=0,d=s,u+=1),b&&(d=y+e*(v()/2+a),c+=u)},h;u<=i.length;)if(h=f(),h)return h.v;return[]}function Am(e){"@babel/helpers - typeof";return Am=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Am(e)}function $O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$O(Object(r),!0).forEach(function(n){ZDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$O(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZDe(e,t,r){return t=JDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JDe(e){var t=QDe(e,"string");return Am(t)=="symbol"?t:t+""}function QDe(e,t){if(Am(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Am(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eje(e,t,r,n,a){for(var i=(n||[]).slice(),s=i.length,l=t.start,c=t.end,u=function(h){var m=i[h],x,p=function(){return x===void 0&&(x=r(m,h)),x};if(h===s-1){var g=e*(m.coordinate+e*p()/2-c);i[h]=m=qn(qn({},m),{},{tickCoord:g>0?m.coordinate-g*e:m.coordinate})}else i[h]=m=qn(qn({},m),{},{tickCoord:m.coordinate});var v=Xg(e,m.tickCoord,p,l,c);v&&(c=m.tickCoord-e*(p()/2+a),i[h]=qn(qn({},m),{},{isShow:!0}))},d=s-1;d>=0;d--)u(d);return i}function tje(e,t,r,n,a,i){var s=(n||[]).slice(),l=s.length,c=t.start,u=t.end;if(i){var d=n[l-1],f=r(d,l-1),h=e*(d.coordinate+e*f/2-u);s[l-1]=d=qn(qn({},d),{},{tickCoord:h>0?d.coordinate-h*e:d.coordinate});var m=Xg(e,d.tickCoord,function(){return f},c,u);m&&(u=d.tickCoord-e*(f/2+a),s[l-1]=qn(qn({},d),{},{isShow:!0}))}for(var x=i?l-1:l,p=function(y){var b=s[y],w,_=function(){return w===void 0&&(w=r(b,y)),w};if(y===0){var D=e*(b.coordinate-e*_()/2-c);s[y]=b=qn(qn({},b),{},{tickCoord:D<0?b.coordinate-D*e:b.coordinate})}else s[y]=b=qn(qn({},b),{},{tickCoord:b.coordinate});var j=Xg(e,b.tickCoord,_,c,u);j&&(c=b.tickCoord+e*(_()/2+a),s[y]=qn(qn({},b),{},{isShow:!0}))},g=0;g<x;g++)p(g);return s}function BS(e,t,r){var n=e.tick,a=e.ticks,i=e.viewBox,s=e.minTickGap,l=e.orientation,c=e.interval,u=e.tickFormatter,d=e.unit,f=e.angle;if(!a||!a.length||!n)return[];if(Be(c)||Ul.isSsr)return XDe(a,typeof c=="number"&&Be(c)?c:0);var h=[],m=l==="top"||l==="bottom"?"width":"height",x=d&&m==="width"?Th(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},p=function(b,w){var _=mt(u)?u(b.value,w):b.value;return m==="width"?GDe(Th(_,{fontSize:t,letterSpacing:r}),x,f):Th(_,{fontSize:t,letterSpacing:r})[m]},g=a.length>=2?ga(a[1].coordinate-a[0].coordinate):1,v=YDe(i,g,m);return c==="equidistantPreserveStart"?KDe(g,v,p,a,s):(c==="preserveStart"||c==="preserveStartEnd"?h=tje(g,v,p,a,s,c==="preserveStartEnd"):h=eje(g,v,p,a,s),h.filter(function(y){return y.isShow}))}var rje=["viewBox"],nje=["viewBox"],aje=["ticks"];function Fd(e){"@babel/helpers - typeof";return Fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fd(e)}function Hu(){return Hu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Hu.apply(this,arguments)}function LO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function rn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LO(Object(r),!0).forEach(function(n){WS(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Dw(e,t){if(e==null)return{};var r=ije(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ije(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function sje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tL(n.key),n)}}function oje(e,t,r){return t&&BO(e.prototype,t),r&&BO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lje(e,t,r){return t=Kg(t),cje(e,eL()?Reflect.construct(t,r||[],Kg(e).constructor):t.apply(e,r))}function cje(e,t){if(t&&(Fd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uje(e)}function uje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eL(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(eL=function(){return!!e})()}function Kg(e){return Kg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Kg(e)}function dje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qD(e,t)}function qD(e,t){return qD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},qD(e,t)}function WS(e,t,r){return t=tL(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tL(e){var t=fje(e,"string");return Fd(t)=="symbol"?t:t+""}function fje(e,t){if(Fd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Fd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var jf=function(e){function t(r){var n;return sje(this,t),n=lje(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return dje(t,e),oje(t,[{key:"shouldComponentUpdate",value:function(n,a){var i=n.viewBox,s=Dw(n,rje),l=this.props,c=l.viewBox,u=Dw(l,nje);return!Ju(i,c)||!Ju(s,u)||!Ju(a,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var a=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.x,s=a.y,l=a.width,c=a.height,u=a.orientation,d=a.tickSize,f=a.mirror,h=a.tickMargin,m,x,p,g,v,y,b=f?-1:1,w=n.tickSize||d,_=Be(n.tickCoord)?n.tickCoord:n.coordinate;switch(u){case"top":m=x=n.coordinate,g=s+ +!f*c,p=g-b*w,y=p-b*h,v=_;break;case"left":p=g=n.coordinate,x=i+ +!f*l,m=x-b*w,v=m-b*h,y=_;break;case"right":p=g=n.coordinate,x=i+ +f*l,m=x+b*w,v=m+b*h,y=_;break;default:m=x=n.coordinate,g=s+ +f*c,p=g+b*w,y=p+b*h,v=_;break}return{line:{x1:m,y1:p,x2:x,y2:g},tick:{x:v,y}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,s;switch(a){case"left":s=i?"start":"end";break;case"right":s=i?"end":"start";break;default:s="middle";break}return s}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,s="end";switch(a){case"left":case"right":s="middle";break;case"top":s=i?"start":"end";break;default:s=i?"end":"start";break}return s}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.x,i=n.y,s=n.width,l=n.height,c=n.orientation,u=n.mirror,d=n.axisLine,f=rn(rn(rn({},ut(this.props,!1)),ut(d,!1)),{},{fill:"none"});if(c==="top"||c==="bottom"){var h=+(c==="top"&&!u||c==="bottom"&&u);f=rn(rn({},f),{},{x1:a,y1:i+h*l,x2:a+s,y2:i+h*l})}else{var m=+(c==="left"&&!u||c==="right"&&u);f=rn(rn({},f),{},{x1:a+m*s,y1:i,x2:a+m*s,y2:i+l})}return Q.createElement("line",Hu({},f,{className:vt("recharts-cartesian-axis-line",ni(d,"className"))}))}},{key:"renderTicks",value:function(n,a,i){var s=this,l=this.props,c=l.tickLine,u=l.stroke,d=l.tick,f=l.tickFormatter,h=l.unit,m=BS(rn(rn({},this.props),{},{ticks:n}),a,i),x=this.getTickTextAnchor(),p=this.getTickVerticalAnchor(),g=ut(this.props,!1),v=ut(d,!1),y=rn(rn({},g),{},{fill:"none"},ut(c,!1)),b=m.map(function(w,_){var D=s.getTickLineCoord(w),j=D.line,N=D.tick,S=rn(rn(rn(rn({textAnchor:x,verticalAnchor:p},g),{},{stroke:"none",fill:u},v),N),{},{index:_,payload:w,visibleTicksCount:m.length,tickFormatter:f});return Q.createElement(Rt,Hu({className:"recharts-cartesian-axis-tick",key:"tick-".concat(w.value,"-").concat(w.coordinate,"-").concat(w.tickCoord)},Sl(s.props,w,_)),c&&Q.createElement("line",Hu({},y,j,{className:vt("recharts-cartesian-axis-tick-line",ni(c,"className"))})),d&&t.renderTickItem(d,S,"".concat(mt(f)?f(w.value,_):w.value).concat(h||"")))});return Q.createElement("g",{className:"recharts-cartesian-axis-ticks"},b)}},{key:"render",value:function(){var n=this,a=this.props,i=a.axisLine,s=a.width,l=a.height,c=a.ticksGenerator,u=a.className,d=a.hide;if(d)return null;var f=this.props,h=f.ticks,m=Dw(f,aje),x=h;return mt(c)&&(x=h&&h.length>0?c(this.props):c(m)),s<=0||l<=0||!x||!x.length?null:Q.createElement(Rt,{className:vt("recharts-cartesian-axis",u),ref:function(g){n.layerReference=g}},i&&this.renderAxisLine(),this.renderTicks(x,this.state.fontSize,this.state.letterSpacing),vn.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,a,i){var s,l=vt(a.className,"recharts-cartesian-axis-tick-value");return Q.isValidElement(n)?s=Q.cloneElement(n,rn(rn({},a),{},{className:l})):mt(n)?s=n(rn(rn({},a),{},{className:l})):s=Q.createElement(Uc,Hu({},a,{className:"recharts-cartesian-axis-tick-value"}),i),s}}])}(M.Component);WS(jf,"displayName","CartesianAxis");WS(jf,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var hje=["x1","y1","x2","y2","key"],mje=["offset"];function Lc(e){"@babel/helpers - typeof";return Lc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lc(e)}function WO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Kn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WO(Object(r),!0).forEach(function(n){pje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pje(e,t,r){return t=xje(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xje(e){var t=gje(e,"string");return Lc(t)=="symbol"?t:t+""}function gje(e,t){if(Lc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Lc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dc(){return Dc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dc.apply(this,arguments)}function zO(e,t){if(e==null)return{};var r=vje(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function vje(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var yje=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,a=t.x,i=t.y,s=t.width,l=t.height,c=t.ry;return Q.createElement("rect",{x:a,y:i,ry:c,width:s,height:l,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function rL(e,t){var r;if(Q.isValidElement(e))r=Q.cloneElement(e,t);else if(mt(e))r=e(t);else{var n=t.x1,a=t.y1,i=t.x2,s=t.y2,l=t.key,c=zO(t,hje),u=ut(c,!1);u.offset;var d=zO(u,mje);r=Q.createElement("line",Dc({},d,{x1:n,y1:a,x2:i,y2:s,fill:"none",key:l}))}return r}function bje(e){var t=e.x,r=e.width,n=e.horizontal,a=n===void 0?!0:n,i=e.horizontalPoints;if(!a||!i||!i.length)return null;var s=i.map(function(l,c){var u=Kn(Kn({},e),{},{x1:t,y1:l,x2:t+r,y2:l,key:"line-".concat(c),index:c});return rL(a,u)});return Q.createElement("g",{className:"recharts-cartesian-grid-horizontal"},s)}function wje(e){var t=e.y,r=e.height,n=e.vertical,a=n===void 0?!0:n,i=e.verticalPoints;if(!a||!i||!i.length)return null;var s=i.map(function(l,c){var u=Kn(Kn({},e),{},{x1:l,y1:t,x2:l,y2:t+r,key:"line-".concat(c),index:c});return rL(a,u)});return Q.createElement("g",{className:"recharts-cartesian-grid-vertical"},s)}function _je(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,a=e.y,i=e.width,s=e.height,l=e.horizontalPoints,c=e.horizontal,u=c===void 0?!0:c;if(!u||!t||!t.length)return null;var d=l.map(function(h){return Math.round(h+a-a)}).sort(function(h,m){return h-m});a!==d[0]&&d.unshift(0);var f=d.map(function(h,m){var x=!d[m+1],p=x?a+s-h:d[m+1]-h;if(p<=0)return null;var g=m%t.length;return Q.createElement("rect",{key:"react-".concat(m),y:h,x:n,height:p,width:i,stroke:"none",fill:t[g],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return Q.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},f)}function Dje(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,a=e.fillOpacity,i=e.x,s=e.y,l=e.width,c=e.height,u=e.verticalPoints;if(!r||!n||!n.length)return null;var d=u.map(function(h){return Math.round(h+i-i)}).sort(function(h,m){return h-m});i!==d[0]&&d.unshift(0);var f=d.map(function(h,m){var x=!d[m+1],p=x?i+l-h:d[m+1]-h;if(p<=0)return null;var g=m%n.length;return Q.createElement("rect",{key:"react-".concat(m),x:h,y:s,width:p,height:c,stroke:"none",fill:n[g],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return Q.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},f)}var jje=function(t,r){var n=t.xAxis,a=t.width,i=t.height,s=t.offset;return KU(BS(Kn(Kn(Kn({},jf.defaultProps),n),{},{ticks:go(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),s.left,s.left+s.width,r)},Nje=function(t,r){var n=t.yAxis,a=t.width,i=t.height,s=t.offset;return KU(BS(Kn(Kn(Kn({},jf.defaultProps),n),{},{ticks:go(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),s.top,s.top+s.height,r)},ju={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function rs(e){var t,r,n,a,i,s,l=MS(),c=US(),u=fDe(),d=Kn(Kn({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:ju.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:ju.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:ju.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:ju.horizontalFill,vertical:(i=e.vertical)!==null&&i!==void 0?i:ju.vertical,verticalFill:(s=e.verticalFill)!==null&&s!==void 0?s:ju.verticalFill,x:Be(e.x)?e.x:u.left,y:Be(e.y)?e.y:u.top,width:Be(e.width)?e.width:u.width,height:Be(e.height)?e.height:u.height}),f=d.x,h=d.y,m=d.width,x=d.height,p=d.syncWithTicks,g=d.horizontalValues,v=d.verticalValues,y=cDe(),b=uDe();if(!Be(m)||m<=0||!Be(x)||x<=0||!Be(f)||f!==+f||!Be(h)||h!==+h)return null;var w=d.verticalCoordinatesGenerator||jje,_=d.horizontalCoordinatesGenerator||Nje,D=d.horizontalPoints,j=d.verticalPoints;if((!D||!D.length)&&mt(_)){var N=g&&g.length,S=_({yAxis:b?Kn(Kn({},b),{},{ticks:N?g:b.ticks}):void 0,width:l,height:c,offset:u},N?!0:p);os(Array.isArray(S),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Lc(S),"]")),Array.isArray(S)&&(D=S)}if((!j||!j.length)&&mt(w)){var E=v&&v.length,A=w({xAxis:y?Kn(Kn({},y),{},{ticks:E?v:y.ticks}):void 0,width:l,height:c,offset:u},E?!0:p);os(Array.isArray(A),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Lc(A),"]")),Array.isArray(A)&&(j=A)}return Q.createElement("g",{className:"recharts-cartesian-grid"},Q.createElement(yje,{fill:d.fill,fillOpacity:d.fillOpacity,x:d.x,y:d.y,width:d.width,height:d.height,ry:d.ry}),Q.createElement(bje,Dc({},d,{offset:u,horizontalPoints:D,xAxis:y,yAxis:b})),Q.createElement(wje,Dc({},d,{offset:u,verticalPoints:j,xAxis:y,yAxis:b})),Q.createElement(_je,Dc({},d,{horizontalPoints:D})),Q.createElement(Dje,Dc({},d,{verticalPoints:j})))}rs.displayName="CartesianGrid";var Sje=["type","layout","connectNulls","ref"],Eje=["key"];function Pd(e){"@babel/helpers - typeof";return Pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pd(e)}function HO(e,t){if(e==null)return{};var r=Tje(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Tje(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Ph(){return Ph=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ph.apply(this,arguments)}function VO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VO(Object(r),!0).forEach(function(n){Qi(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Nu(e){return Oje(e)||Aje(e)||Cje(e)||kje()}function kje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cje(e,t){if(e){if(typeof e=="string")return GD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GD(e,t)}}function Aje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Oje(e){if(Array.isArray(e))return GD(e)}function GD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Fje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qO(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aL(n.key),n)}}function Pje(e,t,r){return t&&qO(e.prototype,t),r&&qO(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ije(e,t,r){return t=Zg(t),Rje(e,nL()?Reflect.construct(t,r||[],Zg(e).constructor):t.apply(e,r))}function Rje(e,t){if(t&&(Pd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mje(e)}function Mje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nL(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nL=function(){return!!e})()}function Zg(e){return Zg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zg(e)}function Uje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YD(e,t)}function YD(e,t){return YD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},YD(e,t)}function Qi(e,t,r){return t=aL(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aL(e){var t=$je(e,"string");return Pd(t)=="symbol"?t:t+""}function $je(e,t){if(Pd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Pd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Gn=function(e){function t(){var r;Fje(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=Ije(this,t,[].concat(a)),Qi(r,"state",{isAnimationFinished:!0,totalLength:0}),Qi(r,"generateSimpleStrokeDasharray",function(s,l){return"".concat(l,"px ").concat(s-l,"px")}),Qi(r,"getStrokeDasharray",function(s,l,c){var u=c.reduce(function(v,y){return v+y});if(!u)return r.generateSimpleStrokeDasharray(l,s);for(var d=Math.floor(s/u),f=s%u,h=l-s,m=[],x=0,p=0;x<c.length;p+=c[x],++x)if(p+c[x]>f){m=[].concat(Nu(c.slice(0,x)),[f-p]);break}var g=m.length%2===0?[0,h]:[h];return[].concat(Nu(t.repeat(c,d)),Nu(m),g).map(function(v){return"".concat(v,"px")}).join(", ")}),Qi(r,"id",mf("recharts-line-")),Qi(r,"pathRef",function(s){r.mainCurve=s}),Qi(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),Qi(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return Uje(t,e),Pje(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,s=i.points,l=i.xAxis,c=i.yAxis,u=i.layout,d=i.children,f=Oa(d,ex);if(!f)return null;var h=function(p,g){return{x:p.x,y:p.y,value:p.value,errorVal:Or(p.payload,g)}},m={clipPath:n?"url(#clipPath-".concat(a,")"):null};return Q.createElement(Rt,m,f.map(function(x){return Q.cloneElement(x,{key:"bar-".concat(x.props.dataKey),data:s,xAxis:l,yAxis:c,layout:u,dataPointFormatter:h})}))}},{key:"renderDots",value:function(n,a,i){var s=this.props.isAnimationActive;if(s&&!this.state.isAnimationFinished)return null;var l=this.props,c=l.dot,u=l.points,d=l.dataKey,f=ut(this.props,!1),h=ut(c,!0),m=u.map(function(p,g){var v=qa(qa(qa({key:"dot-".concat(g),r:3},f),h),{},{index:g,cx:p.x,cy:p.y,value:p.value,dataKey:d,payload:p.payload,points:u});return t.renderDotItem(c,v)}),x={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return Q.createElement(Rt,Ph({className:"recharts-line-dots",key:"dots"},x),m)}},{key:"renderCurveStatically",value:function(n,a,i,s){var l=this.props,c=l.type,u=l.layout,d=l.connectNulls;l.ref;var f=HO(l,Sje),h=qa(qa(qa({},ut(f,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(i,")"):null,points:n},s),{},{type:c,layout:u,connectNulls:d});return Q.createElement(Og,Ph({},h,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,a){var i=this,s=this.props,l=s.points,c=s.strokeDasharray,u=s.isAnimationActive,d=s.animationBegin,f=s.animationDuration,h=s.animationEasing,m=s.animationId,x=s.animateNewValues,p=s.width,g=s.height,v=this.state,y=v.prevPoints,b=v.totalLength;return Q.createElement(ds,{begin:d,duration:f,isActive:u,easing:h,from:{t:0},to:{t:1},key:"line-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(w){var _=w.t;if(y){var D=y.length/l.length,j=l.map(function(T,L){var O=Math.floor(L*D);if(y[O]){var V=y[O],W=Ar(V.x,T.x),B=Ar(V.y,T.y);return qa(qa({},T),{},{x:W(_),y:B(_)})}if(x){var P=Ar(p*2,T.x),F=Ar(g/2,T.y);return qa(qa({},T),{},{x:P(_),y:F(_)})}return qa(qa({},T),{},{x:T.x,y:T.y})});return i.renderCurveStatically(j,n,a)}var N=Ar(0,b),S=N(_),E;if(c){var A="".concat(c).split(/[,\s]+/gim).map(function(T){return parseFloat(T)});E=i.getStrokeDasharray(S,b,A)}else E=i.generateSimpleStrokeDasharray(b,S);return i.renderCurveStatically(l,n,a,{strokeDasharray:E})})}},{key:"renderCurve",value:function(n,a){var i=this.props,s=i.points,l=i.isAnimationActive,c=this.state,u=c.prevPoints,d=c.totalLength;return l&&s&&s.length&&(!u&&d>0||!lu(u,s))?this.renderCurveWithAnimation(n,a):this.renderCurveStatically(s,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,s=a.dot,l=a.points,c=a.className,u=a.xAxis,d=a.yAxis,f=a.top,h=a.left,m=a.width,x=a.height,p=a.isAnimationActive,g=a.id;if(i||!l||!l.length)return null;var v=this.state.isAnimationFinished,y=l.length===1,b=vt("recharts-line",c),w=u&&u.allowDataOverflow,_=d&&d.allowDataOverflow,D=w||_,j=yt(g)?this.id:g,N=(n=ut(s,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},S=N.r,E=S===void 0?3:S,A=N.strokeWidth,T=A===void 0?2:A,L=Cae(s)?s:{},O=L.clipDot,V=O===void 0?!0:O,W=E*2+T;return Q.createElement(Rt,{className:b},w||_?Q.createElement("defs",null,Q.createElement("clipPath",{id:"clipPath-".concat(j)},Q.createElement("rect",{x:w?h:h-m/2,y:_?f:f-x/2,width:w?m:m*2,height:_?x:x*2})),!V&&Q.createElement("clipPath",{id:"clipPath-dots-".concat(j)},Q.createElement("rect",{x:h-W/2,y:f-W/2,width:m+W,height:x+W}))):null,!y&&this.renderCurve(D,j),this.renderErrorBar(D,j),(y||s)&&this.renderDots(D,V,j),(!p||v)&&ls.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,a){for(var i=n.length%2!==0?[].concat(Nu(n),[0]):n,s=[],l=0;l<a;++l)s=[].concat(Nu(s),Nu(i));return s}},{key:"renderDotItem",value:function(n,a){var i;if(Q.isValidElement(n))i=Q.cloneElement(n,a);else if(mt(n))i=n(a);else{var s=a.key,l=HO(a,Eje),c=vt("recharts-line-dot",typeof n!="boolean"?n.className:"");i=Q.createElement(rb,Ph({key:s},l,{className:c}))}return i}}])}(M.PureComponent);Qi(Gn,"displayName","Line");Qi(Gn,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Ul.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Qi(Gn,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,a=e.xAxisTicks,i=e.yAxisTicks,s=e.dataKey,l=e.bandSize,c=e.displayedData,u=e.offset,d=t.layout,f=c.map(function(h,m){var x=Or(h,s);return d==="horizontal"?{x:p4({axis:r,ticks:a,bandSize:l,entry:h,index:m}),y:yt(x)?null:n.scale(x),value:x,payload:h}:{x:yt(x)?null:r.scale(x),y:p4({axis:n,ticks:i,bandSize:l,entry:h,index:m}),value:x,payload:h}});return qa({points:f,layout:d},u)});function Id(e){"@babel/helpers - typeof";return Id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Id(e)}function Lje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bje(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oL(n.key),n)}}function Wje(e,t,r){return t&&Bje(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function zje(e,t,r){return t=Jg(t),Hje(e,iL()?Reflect.construct(t,r||[],Jg(e).constructor):t.apply(e,r))}function Hje(e,t){if(t&&(Id(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vje(e)}function Vje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iL(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(iL=function(){return!!e})()}function Jg(e){return Jg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Jg(e)}function qje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XD(e,t)}function XD(e,t){return XD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},XD(e,t)}function sL(e,t,r){return t=oL(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oL(e){var t=Gje(e,"string");return Id(t)=="symbol"?t:t+""}function Gje(e,t){if(Id(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Id(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function KD(){return KD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},KD.apply(this,arguments)}function Yje(e){var t=e.xAxisId,r=MS(),n=US(),a=V$(t);return a==null?null:M.createElement(jf,KD({},a,{className:vt("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(s){return go(s,!0)}}))}var Ea=function(e){function t(){return Lje(this,t),zje(this,t,arguments)}return qje(t,e),Wje(t,[{key:"render",value:function(){return M.createElement(Yje,this.props)}}])}(M.Component);sL(Ea,"displayName","XAxis");sL(Ea,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Rd(e){"@babel/helpers - typeof";return Rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rd(e)}function Xje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kje(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uL(n.key),n)}}function Zje(e,t,r){return t&&Kje(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jje(e,t,r){return t=Qg(t),Qje(e,lL()?Reflect.construct(t,r||[],Qg(e).constructor):t.apply(e,r))}function Qje(e,t){if(t&&(Rd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eNe(e)}function eNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lL(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lL=function(){return!!e})()}function Qg(e){return Qg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qg(e)}function tNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZD(e,t)}function ZD(e,t){return ZD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},ZD(e,t)}function cL(e,t,r){return t=uL(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uL(e){var t=rNe(e,"string");return Rd(t)=="symbol"?t:t+""}function rNe(e,t){if(Rd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Rd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function JD(){return JD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},JD.apply(this,arguments)}var nNe=function(t){var r=t.yAxisId,n=MS(),a=US(),i=q$(r);return i==null?null:M.createElement(jf,JD({},i,{className:vt("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(l){return go(l,!0)}}))},Ta=function(e){function t(){return Xje(this,t),Jje(this,t,arguments)}return tNe(t,e),Zje(t,[{key:"render",value:function(){return M.createElement(nNe,this.props)}}])}(M.Component);cL(Ta,"displayName","YAxis");cL(Ta,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function GO(e){return oNe(e)||sNe(e)||iNe(e)||aNe()}function aNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iNe(e,t){if(e){if(typeof e=="string")return QD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QD(e,t)}}function sNe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function oNe(e){if(Array.isArray(e))return QD(e)}function QD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ej=function(t,r,n,a,i){var s=Oa(t,LS),l=Oa(t,fb),c=[].concat(GO(s),GO(l)),u=Oa(t,mb),d="".concat(a,"Id"),f=a[0],h=r;if(c.length&&(h=c.reduce(function(p,g){if(g.props[d]===n&&Ms(g.props,"extendDomain")&&Be(g.props[f])){var v=g.props[f];return[Math.min(p[0],v),Math.max(p[1],v)]}return p},h)),u.length){var m="".concat(f,"1"),x="".concat(f,"2");h=u.reduce(function(p,g){if(g.props[d]===n&&Ms(g.props,"extendDomain")&&Be(g.props[m])&&Be(g.props[x])){var v=g.props[m],y=g.props[x];return[Math.min(p[0],v,y),Math.max(p[1],v,y)]}return p},h)}return i&&i.length&&(h=i.reduce(function(p,g){return Be(g)?[Math.min(p[0],g),Math.max(p[1],g)]:p},h)),h},dL={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function i(c,u,d,f,h){if(typeof d!="function")throw new TypeError("The listener must be a function");var m=new a(d,f||c,h),x=r?r+u:u;return c._events[x]?c._events[x].fn?c._events[x]=[c._events[x],m]:c._events[x].push(m):(c._events[x]=m,c._eventsCount++),c}function s(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)t.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,m=f.length,x=new Array(m);h<m;h++)x[h]=f[h].fn;return x},l.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},l.prototype.emit=function(u,d,f,h,m,x){var p=r?r+u:u;if(!this._events[p])return!1;var g=this._events[p],v=arguments.length,y,b;if(g.fn){switch(g.once&&this.removeListener(u,g.fn,void 0,!0),v){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,d),!0;case 3:return g.fn.call(g.context,d,f),!0;case 4:return g.fn.call(g.context,d,f,h),!0;case 5:return g.fn.call(g.context,d,f,h,m),!0;case 6:return g.fn.call(g.context,d,f,h,m,x),!0}for(b=1,y=new Array(v-1);b<v;b++)y[b-1]=arguments[b];g.fn.apply(g.context,y)}else{var w=g.length,_;for(b=0;b<w;b++)switch(g[b].once&&this.removeListener(u,g[b].fn,void 0,!0),v){case 1:g[b].fn.call(g[b].context);break;case 2:g[b].fn.call(g[b].context,d);break;case 3:g[b].fn.call(g[b].context,d,f);break;case 4:g[b].fn.call(g[b].context,d,f,h);break;default:if(!y)for(_=1,y=new Array(v-1);_<v;_++)y[_-1]=arguments[_];g[b].fn.apply(g[b].context,y)}}return!0},l.prototype.on=function(u,d,f){return i(this,u,d,f,!1)},l.prototype.once=function(u,d,f){return i(this,u,d,f,!0)},l.prototype.removeListener=function(u,d,f,h){var m=r?r+u:u;if(!this._events[m])return this;if(!d)return s(this,m),this;var x=this._events[m];if(x.fn)x.fn===d&&(!h||x.once)&&(!f||x.context===f)&&s(this,m);else{for(var p=0,g=[],v=x.length;p<v;p++)(x[p].fn!==d||h&&!x[p].once||f&&x[p].context!==f)&&g.push(x[p]);g.length?this._events[m]=g.length===1?g[0]:g:s(this,m)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&s(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(dL);var lNe=dL.exports;const cNe=At(lNe);var jw=new cNe,Nw="recharts.syncMouseEvents";function Om(e){"@babel/helpers - typeof";return Om=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Om(e)}function uNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dNe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fL(n.key),n)}}function fNe(e,t,r){return t&&dNe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sw(e,t,r){return t=fL(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fL(e){var t=hNe(e,"string");return Om(t)=="symbol"?t:t+""}function hNe(e,t){if(Om(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Om(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var mNe=function(){function e(){uNe(this,e),Sw(this,"activeIndex",0),Sw(this,"coordinateList",[]),Sw(this,"layout","horizontal")}return fNe(e,[{key:"setDetails",value:function(r){var n,a=r.coordinateList,i=a===void 0?null:a,s=r.container,l=s===void 0?null:s,c=r.layout,u=c===void 0?null:c,d=r.offset,f=d===void 0?null:d,h=r.mouseHandlerCallback,m=h===void 0?null:h;this.coordinateList=(n=i??this.coordinateList)!==null&&n!==void 0?n:[],this.container=l??this.container,this.layout=u??this.layout,this.offset=f??this.offset,this.mouseHandlerCallback=m??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),i=a.x,s=a.y,l=a.height,c=this.coordinateList[this.activeIndex].coordinate,u=((r=window)===null||r===void 0?void 0:r.scrollX)||0,d=((n=window)===null||n===void 0?void 0:n.scrollY)||0,f=i+c+u,h=s+this.offset.top+l/2+d;this.mouseHandlerCallback({pageX:f,pageY:h})}}}])}();function pNe(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],a=e==null?void 0:e[1];if(n&&a&&Be(n)&&Be(a))return!0}return!1}function xNe(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function hL(e){var t=e.cx,r=e.cy,n=e.radius,a=e.startAngle,i=e.endAngle,s=hr(t,r,n,a),l=hr(t,r,n,i);return{points:[s,l],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function gNe(e,t,r){var n,a,i,s;if(e==="horizontal")n=t.x,i=n,a=r.top,s=r.top+r.height;else if(e==="vertical")a=t.y,s=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var l=t.cx,c=t.cy,u=t.innerRadius,d=t.outerRadius,f=t.angle,h=hr(l,c,u,f),m=hr(l,c,d,f);n=h.x,a=h.y,i=m.x,s=m.y}else return hL(t);return[{x:n,y:a},{x:i,y:s}]}function Fm(e){"@babel/helpers - typeof";return Fm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fm(e)}function YO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Xx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YO(Object(r),!0).forEach(function(n){vNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vNe(e,t,r){return t=yNe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yNe(e){var t=bNe(e,"string");return Fm(t)=="symbol"?t:t+""}function bNe(e,t){if(Fm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Fm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wNe(e){var t,r,n=e.element,a=e.tooltipEventType,i=e.isActive,s=e.activeCoordinate,l=e.activePayload,c=e.offset,u=e.activeTooltipIndex,d=e.tooltipAxisBandSize,f=e.layout,h=e.chartName,m=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!m||!i||!s||h!=="ScatterChart"&&a!=="axis")return null;var x,p=Og;if(h==="ScatterChart")x=s,p=V1e;else if(h==="BarChart")x=xNe(f,s,c,d),p=AS;else if(f==="radial"){var g=hL(s),v=g.cx,y=g.cy,b=g.radius,w=g.startAngle,_=g.endAngle;x={cx:v,cy:y,startAngle:w,endAngle:_,innerRadius:b,outerRadius:b},p=l$}else x={points:gNe(f,s,c)},p=Og;var D=Xx(Xx(Xx(Xx({stroke:"#ccc",pointerEvents:"none"},c),x),ut(m,!1)),{},{payload:l,payloadIndex:u,className:vt("recharts-tooltip-cursor",m.className)});return M.isValidElement(m)?M.cloneElement(m,D):M.createElement(p,D)}var _Ne=["item"],DNe=["children","className","width","height","style","compact","title","desc"];function Md(e){"@babel/helpers - typeof";return Md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Md(e)}function Vu(){return Vu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vu.apply(this,arguments)}function XO(e,t){return SNe(e)||NNe(e,t)||pL(e,t)||jNe()}function jNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NNe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function SNe(e){if(Array.isArray(e))return e}function KO(e,t){if(e==null)return{};var r=ENe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ENe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function TNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kNe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xL(n.key),n)}}function CNe(e,t,r){return t&&kNe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ANe(e,t,r){return t=ev(t),ONe(e,mL()?Reflect.construct(t,r||[],ev(e).constructor):t.apply(e,r))}function ONe(e,t){if(t&&(Md(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FNe(e)}function FNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mL(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mL=function(){return!!e})()}function ev(e){return ev=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ev(e)}function PNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tj(e,t)}function tj(e,t){return tj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},tj(e,t)}function Ud(e){return MNe(e)||RNe(e)||pL(e)||INe()}function INe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pL(e,t){if(e){if(typeof e=="string")return rj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rj(e,t)}}function RNe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function MNe(e){if(Array.isArray(e))return rj(e)}function rj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ZO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ee(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZO(Object(r),!0).forEach(function(n){ft(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ft(e,t,r){return t=xL(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xL(e){var t=UNe(e,"string");return Md(t)=="symbol"?t:t+""}function UNe(e,t){if(Md(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Md(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $Ne={xAxis:["bottom","top"],yAxis:["left","right"]},LNe={width:"100%",height:"100%"},gL={x:0,y:0};function Kx(e){return e}var BNe=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},WNe=function(t,r,n,a){var i=r.find(function(d){return d&&d.index===n});if(i){if(t==="horizontal")return{x:i.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:i.coordinate};if(t==="centric"){var s=i.coordinate,l=a.radius;return Ee(Ee(Ee({},a),hr(a.cx,a.cy,l,s)),{},{angle:s,radius:l})}var c=i.coordinate,u=a.angle;return Ee(Ee(Ee({},a),hr(a.cx,a.cy,c,u)),{},{angle:u,radius:c})}return gL},pb=function(t,r){var n=r.graphicalItems,a=r.dataStartIndex,i=r.dataEndIndex,s=(n??[]).reduce(function(l,c){var u=c.props.data;return u&&u.length?[].concat(Ud(l),Ud(u)):l},[]);return s.length>0?s:t&&t.length&&Be(a)&&Be(i)?t.slice(a,i+1):[]};function vL(e){return e==="number"?[0,"auto"]:void 0}var nj=function(t,r,n,a){var i=t.graphicalItems,s=t.tooltipAxis,l=pb(r,t);return n<0||!i||!i.length||n>=l.length?null:i.reduce(function(c,u){var d,f=(d=u.props.data)!==null&&d!==void 0?d:r;f&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(f=f.slice(t.dataStartIndex,t.dataEndIndex+1));var h;if(s.dataKey&&!s.allowDuplicatedCategory){var m=f===void 0?l:f;h=tg(m,s.dataKey,a)}else h=f&&f[n]||l[n];return h?[].concat(Ud(c),[t$(u,h)]):c},[])},JO=function(t,r,n,a){var i=a||{x:t.chartX,y:t.chartY},s=BNe(i,n),l=t.orderedTooltipTicks,c=t.tooltipAxis,u=t.tooltipTicks,d=gve(s,l,u,c);if(d>=0&&u){var f=u[d]&&u[d].value,h=nj(t,r,d,f),m=WNe(n,l,d,i);return{activeTooltipIndex:d,activeLabel:f,activePayload:h,activeCoordinate:m}}return null},zNe=function(t,r){var n=r.axes,a=r.graphicalItems,i=r.axisType,s=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,d=t.layout,f=t.children,h=t.stackOffset,m=XU(d,i);return n.reduce(function(x,p){var g,v=p.type.defaultProps!==void 0?Ee(Ee({},p.type.defaultProps),p.props):p.props,y=v.type,b=v.dataKey,w=v.allowDataOverflow,_=v.allowDuplicatedCategory,D=v.scale,j=v.ticks,N=v.includeHidden,S=v[s];if(x[S])return x;var E=pb(t.data,{graphicalItems:a.filter(function(C){var k,z=s in C.props?C.props[s]:(k=C.type.defaultProps)===null||k===void 0?void 0:k[s];return z===S}),dataStartIndex:c,dataEndIndex:u}),A=E.length,T,L,O;pNe(v.domain,w,y)&&(T=gD(v.domain,null,w),m&&(y==="number"||D!=="auto")&&(O=Ch(E,b,"category")));var V=vL(y);if(!T||T.length===0){var W,B=(W=v.domain)!==null&&W!==void 0?W:V;if(b){if(T=Ch(E,b,y),y==="category"&&m){var P=bae(T);_&&P?(L=T,T=Em(0,A)):_||(T=y4(B,T,p).reduce(function(C,k){return C.indexOf(k)>=0?C:[].concat(Ud(C),[k])},[]))}else if(y==="category")_?T=T.filter(function(C){return C!==""&&!yt(C)}):T=y4(B,T,p).reduce(function(C,k){return C.indexOf(k)>=0||k===""||yt(k)?C:[].concat(Ud(C),[k])},[]);else if(y==="number"){var F=_ve(E,a.filter(function(C){var k,z,q=s in C.props?C.props[s]:(k=C.type.defaultProps)===null||k===void 0?void 0:k[s],K="hide"in C.props?C.props.hide:(z=C.type.defaultProps)===null||z===void 0?void 0:z.hide;return q===S&&(N||!K)}),b,i,d);F&&(T=F)}m&&(y==="number"||D!=="auto")&&(O=Ch(E,b,"category"))}else m?T=Em(0,A):l&&l[S]&&l[S].hasStack&&y==="number"?T=h==="expand"?[0,1]:e$(l[S].stackGroups,c,u):T=YU(E,a.filter(function(C){var k=s in C.props?C.props[s]:C.type.defaultProps[s],z="hide"in C.props?C.props.hide:C.type.defaultProps.hide;return k===S&&(N||!z)}),y,d,!0);if(y==="number")T=ej(f,T,S,i,j),B&&(T=gD(B,T,w));else if(y==="category"&&B){var I=B,R=T.every(function(C){return I.indexOf(C)>=0});R&&(T=I)}}return Ee(Ee({},x),{},ft({},S,Ee(Ee({},v),{},{axisType:i,domain:T,categoricalDomain:O,duplicateDomain:L,originalDomain:(g=v.domain)!==null&&g!==void 0?g:V,isCategorical:m,layout:d})))},{})},HNe=function(t,r){var n=r.graphicalItems,a=r.Axis,i=r.axisType,s=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,d=t.layout,f=t.children,h=pb(t.data,{graphicalItems:n,dataStartIndex:c,dataEndIndex:u}),m=h.length,x=XU(d,i),p=-1;return n.reduce(function(g,v){var y=v.type.defaultProps!==void 0?Ee(Ee({},v.type.defaultProps),v.props):v.props,b=y[s],w=vL("number");if(!g[b]){p++;var _;return x?_=Em(0,m):l&&l[b]&&l[b].hasStack?(_=e$(l[b].stackGroups,c,u),_=ej(f,_,b,i)):(_=gD(w,YU(h,n.filter(function(D){var j,N,S=s in D.props?D.props[s]:(j=D.type.defaultProps)===null||j===void 0?void 0:j[s],E="hide"in D.props?D.props.hide:(N=D.type.defaultProps)===null||N===void 0?void 0:N.hide;return S===b&&!E}),"number",d),a.defaultProps.allowDataOverflow),_=ej(f,_,b,i)),Ee(Ee({},g),{},ft({},b,Ee(Ee({axisType:i},a.defaultProps),{},{hide:!0,orientation:ni($Ne,"".concat(i,".").concat(p%2),null),domain:_,originalDomain:w,isCategorical:x,layout:d})))}return g},{})},VNe=function(t,r){var n=r.axisType,a=n===void 0?"xAxis":n,i=r.AxisComp,s=r.graphicalItems,l=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,d=t.children,f="".concat(a,"Id"),h=Oa(d,i),m={};return h&&h.length?m=zNe(t,{axes:h,graphicalItems:s,axisType:a,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:u}):s&&s.length&&(m=HNe(t,{Axis:i,graphicalItems:s,axisType:a,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:u})),m},qNe=function(t){var r=ol(t),n=go(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:Hy(n,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:kg(r,n)}},QO=function(t){var r=t.children,n=t.defaultShowTooltip,a=Ya(r,Td),i=0,s=0;return t.data&&t.data.length!==0&&(s=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(i=a.props.startIndex),a.props.endIndex>=0&&(s=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:s,activeTooltipIndex:-1,isTooltipActive:!!n}},GNe=function(t){return!t||!t.length?!1:t.some(function(r){var n=wo(r&&r.type);return n&&n.indexOf("Bar")>=0})},eF=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},YNe=function(t,r){var n=t.props,a=t.graphicalItems,i=t.xAxisMap,s=i===void 0?{}:i,l=t.yAxisMap,c=l===void 0?{}:l,u=n.width,d=n.height,f=n.children,h=n.margin||{},m=Ya(f,Td),x=Ya(f,vl),p=Object.keys(c).reduce(function(_,D){var j=c[D],N=j.orientation;return!j.mirror&&!j.hide?Ee(Ee({},_),{},ft({},N,_[N]+j.width)):_},{left:h.left||0,right:h.right||0}),g=Object.keys(s).reduce(function(_,D){var j=s[D],N=j.orientation;return!j.mirror&&!j.hide?Ee(Ee({},_),{},ft({},N,ni(_,"".concat(N))+j.height)):_},{top:h.top||0,bottom:h.bottom||0}),v=Ee(Ee({},g),p),y=v.bottom;m&&(v.bottom+=m.props.height||Td.defaultProps.height),x&&r&&(v=bve(v,a,n,r));var b=u-v.left-v.right,w=d-v.top-v.bottom;return Ee(Ee({brushBottom:y},v),{},{width:Math.max(b,0),height:Math.max(w,0)})},XNe=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},xb=function(t){var r=t.chartName,n=t.GraphicalChild,a=t.defaultTooltipEventType,i=a===void 0?"axis":a,s=t.validateTooltipEventTypes,l=s===void 0?["axis"]:s,c=t.axisComponents,u=t.legendContent,d=t.formatAxisMap,f=t.defaultProps,h=function(v,y){var b=y.graphicalItems,w=y.stackGroups,_=y.offset,D=y.updateId,j=y.dataStartIndex,N=y.dataEndIndex,S=v.barSize,E=v.layout,A=v.barGap,T=v.barCategoryGap,L=v.maxBarSize,O=eF(E),V=O.numericAxisName,W=O.cateAxisName,B=GNe(b),P=[];return b.forEach(function(F,I){var R=pb(v.data,{graphicalItems:[F],dataStartIndex:j,dataEndIndex:N}),C=F.type.defaultProps!==void 0?Ee(Ee({},F.type.defaultProps),F.props):F.props,k=C.dataKey,z=C.maxBarSize,q=C["".concat(V,"Id")],K=C["".concat(W,"Id")],se={},ie=c.reduce(function(ue,me){var te=y["".concat(me.axisType,"Map")],oe=C["".concat(me.axisType,"Id")];te&&te[oe]||me.axisType==="zAxis"||Dl();var ge=te[oe];return Ee(Ee({},ue),{},ft(ft({},me.axisType,ge),"".concat(me.axisType,"Ticks"),go(ge)))},se),ee=ie[W],ae=ie["".concat(W,"Ticks")],pe=w&&w[q]&&w[q].hasStack&&Ave(F,w[q].stackGroups),H=wo(F.type).indexOf("Bar")>=0,ne=kg(ee,ae),U=[],le=B&&vve({barSize:S,stackGroups:w,totalSize:XNe(ie,W)});if(H){var re,X,G=yt(z)?L:z,ce=(re=(X=kg(ee,ae,!0))!==null&&X!==void 0?X:G)!==null&&re!==void 0?re:0;U=yve({barGap:A,barCategoryGap:T,bandSize:ce!==ne?ce:ne,sizeList:le[K],maxBarSize:G}),ce!==ne&&(U=U.map(function(ue){return Ee(Ee({},ue),{},{position:Ee(Ee({},ue.position),{},{offset:ue.position.offset-ce/2})})}))}var J=F&&F.type&&F.type.getComposedData;J&&P.push({props:Ee(Ee({},J(Ee(Ee({},ie),{},{displayedData:R,props:v,dataKey:k,item:F,bandSize:ne,barPosition:U,offset:_,stackedData:pe,layout:E,dataStartIndex:j,dataEndIndex:N}))),{},ft(ft(ft({key:F.key||"item-".concat(I)},V,ie[V]),W,ie[W]),"animationId",D)),childIndex:Fae(F,v.children),item:F})}),P},m=function(v,y){var b=v.props,w=v.dataStartIndex,_=v.dataEndIndex,D=v.updateId;if(!fA({props:b}))return null;var j=b.children,N=b.layout,S=b.stackOffset,E=b.data,A=b.reverseStackOrder,T=eF(N),L=T.numericAxisName,O=T.cateAxisName,V=Oa(j,n),W=kve(E,V,"".concat(L,"Id"),"".concat(O,"Id"),S,A),B=c.reduce(function(C,k){var z="".concat(k.axisType,"Map");return Ee(Ee({},C),{},ft({},z,VNe(b,Ee(Ee({},k),{},{graphicalItems:V,stackGroups:k.axisType===L&&W,dataStartIndex:w,dataEndIndex:_}))))},{}),P=YNe(Ee(Ee({},B),{},{props:b,graphicalItems:V}),y==null?void 0:y.legendBBox);Object.keys(B).forEach(function(C){B[C]=d(b,B[C],P,C.replace("Map",""),r)});var F=B["".concat(O,"Map")],I=qNe(F),R=h(b,Ee(Ee({},B),{},{dataStartIndex:w,dataEndIndex:_,updateId:D,graphicalItems:V,stackGroups:W,offset:P}));return Ee(Ee({formattedGraphicalItems:R,graphicalItems:V,offset:P,stackGroups:W},I),B)},x=function(g){function v(y){var b,w,_;return TNe(this,v),_=ANe(this,v,[y]),ft(_,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),ft(_,"accessibilityManager",new mNe),ft(_,"handleLegendBBoxUpdate",function(D){if(D){var j=_.state,N=j.dataStartIndex,S=j.dataEndIndex,E=j.updateId;_.setState(Ee({legendBBox:D},m({props:_.props,dataStartIndex:N,dataEndIndex:S,updateId:E},Ee(Ee({},_.state),{},{legendBBox:D}))))}}),ft(_,"handleReceiveSyncEvent",function(D,j,N){if(_.props.syncId===D){if(N===_.eventEmitterSymbol&&typeof _.props.syncMethod!="function")return;_.applySyncEvent(j)}}),ft(_,"handleBrushChange",function(D){var j=D.startIndex,N=D.endIndex;if(j!==_.state.dataStartIndex||N!==_.state.dataEndIndex){var S=_.state.updateId;_.setState(function(){return Ee({dataStartIndex:j,dataEndIndex:N},m({props:_.props,dataStartIndex:j,dataEndIndex:N,updateId:S},_.state))}),_.triggerSyncEvent({dataStartIndex:j,dataEndIndex:N})}}),ft(_,"handleMouseEnter",function(D){var j=_.getMouseInfo(D);if(j){var N=Ee(Ee({},j),{},{isTooltipActive:!0});_.setState(N),_.triggerSyncEvent(N);var S=_.props.onMouseEnter;mt(S)&&S(N,D)}}),ft(_,"triggeredAfterMouseMove",function(D){var j=_.getMouseInfo(D),N=j?Ee(Ee({},j),{},{isTooltipActive:!0}):{isTooltipActive:!1};_.setState(N),_.triggerSyncEvent(N);var S=_.props.onMouseMove;mt(S)&&S(N,D)}),ft(_,"handleItemMouseEnter",function(D){_.setState(function(){return{isTooltipActive:!0,activeItem:D,activePayload:D.tooltipPayload,activeCoordinate:D.tooltipPosition||{x:D.cx,y:D.cy}}})}),ft(_,"handleItemMouseLeave",function(){_.setState(function(){return{isTooltipActive:!1}})}),ft(_,"handleMouseMove",function(D){D.persist(),_.throttleTriggeredAfterMouseMove(D)}),ft(_,"handleMouseLeave",function(D){_.throttleTriggeredAfterMouseMove.cancel();var j={isTooltipActive:!1};_.setState(j),_.triggerSyncEvent(j);var N=_.props.onMouseLeave;mt(N)&&N(j,D)}),ft(_,"handleOuterEvent",function(D){var j=Oae(D),N=ni(_.props,"".concat(j));if(j&&mt(N)){var S,E;/.*touch.*/i.test(j)?E=_.getMouseInfo(D.changedTouches[0]):E=_.getMouseInfo(D),N((S=E)!==null&&S!==void 0?S:{},D)}}),ft(_,"handleClick",function(D){var j=_.getMouseInfo(D);if(j){var N=Ee(Ee({},j),{},{isTooltipActive:!0});_.setState(N),_.triggerSyncEvent(N);var S=_.props.onClick;mt(S)&&S(N,D)}}),ft(_,"handleMouseDown",function(D){var j=_.props.onMouseDown;if(mt(j)){var N=_.getMouseInfo(D);j(N,D)}}),ft(_,"handleMouseUp",function(D){var j=_.props.onMouseUp;if(mt(j)){var N=_.getMouseInfo(D);j(N,D)}}),ft(_,"handleTouchMove",function(D){D.changedTouches!=null&&D.changedTouches.length>0&&_.throttleTriggeredAfterMouseMove(D.changedTouches[0])}),ft(_,"handleTouchStart",function(D){D.changedTouches!=null&&D.changedTouches.length>0&&_.handleMouseDown(D.changedTouches[0])}),ft(_,"handleTouchEnd",function(D){D.changedTouches!=null&&D.changedTouches.length>0&&_.handleMouseUp(D.changedTouches[0])}),ft(_,"handleDoubleClick",function(D){var j=_.props.onDoubleClick;if(mt(j)){var N=_.getMouseInfo(D);j(N,D)}}),ft(_,"handleContextMenu",function(D){var j=_.props.onContextMenu;if(mt(j)){var N=_.getMouseInfo(D);j(N,D)}}),ft(_,"triggerSyncEvent",function(D){_.props.syncId!==void 0&&jw.emit(Nw,_.props.syncId,D,_.eventEmitterSymbol)}),ft(_,"applySyncEvent",function(D){var j=_.props,N=j.layout,S=j.syncMethod,E=_.state.updateId,A=D.dataStartIndex,T=D.dataEndIndex;if(D.dataStartIndex!==void 0||D.dataEndIndex!==void 0)_.setState(Ee({dataStartIndex:A,dataEndIndex:T},m({props:_.props,dataStartIndex:A,dataEndIndex:T,updateId:E},_.state)));else if(D.activeTooltipIndex!==void 0){var L=D.chartX,O=D.chartY,V=D.activeTooltipIndex,W=_.state,B=W.offset,P=W.tooltipTicks;if(!B)return;if(typeof S=="function")V=S(P,D);else if(S==="value"){V=-1;for(var F=0;F<P.length;F++)if(P[F].value===D.activeLabel){V=F;break}}var I=Ee(Ee({},B),{},{x:B.left,y:B.top}),R=Math.min(L,I.x+I.width),C=Math.min(O,I.y+I.height),k=P[V]&&P[V].value,z=nj(_.state,_.props.data,V),q=P[V]?{x:N==="horizontal"?P[V].coordinate:R,y:N==="horizontal"?C:P[V].coordinate}:gL;_.setState(Ee(Ee({},D),{},{activeLabel:k,activeCoordinate:q,activePayload:z,activeTooltipIndex:V}))}else _.setState(D)}),ft(_,"renderCursor",function(D){var j,N=_.state,S=N.isTooltipActive,E=N.activeCoordinate,A=N.activePayload,T=N.offset,L=N.activeTooltipIndex,O=N.tooltipAxisBandSize,V=_.getTooltipEventType(),W=(j=D.props.active)!==null&&j!==void 0?j:S,B=_.props.layout,P=D.key||"_recharts-cursor";return Q.createElement(wNe,{key:P,activeCoordinate:E,activePayload:A,activeTooltipIndex:L,chartName:r,element:D,isActive:W,layout:B,offset:T,tooltipAxisBandSize:O,tooltipEventType:V})}),ft(_,"renderPolarAxis",function(D,j,N){var S=ni(D,"type.axisType"),E=ni(_.state,"".concat(S,"Map")),A=D.type.defaultProps,T=A!==void 0?Ee(Ee({},A),D.props):D.props,L=E&&E[T["".concat(S,"Id")]];return M.cloneElement(D,Ee(Ee({},L),{},{className:vt(S,L.className),key:D.key||"".concat(j,"-").concat(N),ticks:go(L,!0)}))}),ft(_,"renderPolarGrid",function(D){var j=D.props,N=j.radialLines,S=j.polarAngles,E=j.polarRadius,A=_.state,T=A.radiusAxisMap,L=A.angleAxisMap,O=ol(T),V=ol(L),W=V.cx,B=V.cy,P=V.innerRadius,F=V.outerRadius;return M.cloneElement(D,{polarAngles:Array.isArray(S)?S:go(V,!0).map(function(I){return I.coordinate}),polarRadius:Array.isArray(E)?E:go(O,!0).map(function(I){return I.coordinate}),cx:W,cy:B,innerRadius:P,outerRadius:F,key:D.key||"polar-grid",radialLines:N})}),ft(_,"renderLegend",function(){var D=_.state.formattedGraphicalItems,j=_.props,N=j.children,S=j.width,E=j.height,A=_.props.margin||{},T=S-(A.left||0)-(A.right||0),L=qU({children:N,formattedGraphicalItems:D,legendWidth:T,legendContent:u});if(!L)return null;var O=L.item,V=KO(L,_Ne);return M.cloneElement(O,Ee(Ee({},V),{},{chartWidth:S,chartHeight:E,margin:A,onBBoxUpdate:_.handleLegendBBoxUpdate}))}),ft(_,"renderTooltip",function(){var D,j=_.props,N=j.children,S=j.accessibilityLayer,E=Ya(N,Rr);if(!E)return null;var A=_.state,T=A.isTooltipActive,L=A.activeCoordinate,O=A.activePayload,V=A.activeLabel,W=A.offset,B=(D=E.props.active)!==null&&D!==void 0?D:T;return M.cloneElement(E,{viewBox:Ee(Ee({},W),{},{x:W.left,y:W.top}),active:B,label:V,payload:B?O:[],coordinate:L,accessibilityLayer:S})}),ft(_,"renderBrush",function(D){var j=_.props,N=j.margin,S=j.data,E=_.state,A=E.offset,T=E.dataStartIndex,L=E.dataEndIndex,O=E.updateId;return M.cloneElement(D,{key:D.key||"_recharts-brush",onChange:Vx(_.handleBrushChange,D.props.onChange),data:S,x:Be(D.props.x)?D.props.x:A.left,y:Be(D.props.y)?D.props.y:A.top+A.height+A.brushBottom-(N.bottom||0),width:Be(D.props.width)?D.props.width:A.width,startIndex:T,endIndex:L,updateId:"brush-".concat(O)})}),ft(_,"renderReferenceElement",function(D,j,N){if(!D)return null;var S=_,E=S.clipPathId,A=_.state,T=A.xAxisMap,L=A.yAxisMap,O=A.offset,V=D.type.defaultProps||{},W=D.props,B=W.xAxisId,P=B===void 0?V.xAxisId:B,F=W.yAxisId,I=F===void 0?V.yAxisId:F;return M.cloneElement(D,{key:D.key||"".concat(j,"-").concat(N),xAxis:T[P],yAxis:L[I],viewBox:{x:O.left,y:O.top,width:O.width,height:O.height},clipPathId:E})}),ft(_,"renderActivePoints",function(D){var j=D.item,N=D.activePoint,S=D.basePoint,E=D.childIndex,A=D.isRange,T=[],L=j.props.key,O=j.item.type.defaultProps!==void 0?Ee(Ee({},j.item.type.defaultProps),j.item.props):j.item.props,V=O.activeDot,W=O.dataKey,B=Ee(Ee({index:E,dataKey:W,cx:N.x,cy:N.y,r:4,fill:CS(j.item),strokeWidth:2,stroke:"#fff",payload:N.payload,value:N.value},ut(V,!1)),rg(V));return T.push(v.renderActiveDot(V,B,"".concat(L,"-activePoint-").concat(E))),S?T.push(v.renderActiveDot(V,Ee(Ee({},B),{},{cx:S.x,cy:S.y}),"".concat(L,"-basePoint-").concat(E))):A&&T.push(null),T}),ft(_,"renderGraphicChild",function(D,j,N){var S=_.filterFormatItem(D,j,N);if(!S)return null;var E=_.getTooltipEventType(),A=_.state,T=A.isTooltipActive,L=A.tooltipAxis,O=A.activeTooltipIndex,V=A.activeLabel,W=_.props.children,B=Ya(W,Rr),P=S.props,F=P.points,I=P.isRange,R=P.baseLine,C=S.item.type.defaultProps!==void 0?Ee(Ee({},S.item.type.defaultProps),S.item.props):S.item.props,k=C.activeDot,z=C.hide,q=C.activeBar,K=C.activeShape,se=!!(!z&&T&&B&&(k||q||K)),ie={};E!=="axis"&&B&&B.props.trigger==="click"?ie={onClick:Vx(_.handleItemMouseEnter,D.props.onClick)}:E!=="axis"&&(ie={onMouseLeave:Vx(_.handleItemMouseLeave,D.props.onMouseLeave),onMouseEnter:Vx(_.handleItemMouseEnter,D.props.onMouseEnter)});var ee=M.cloneElement(D,Ee(Ee({},S.props),ie));function ae(me){return typeof L.dataKey=="function"?L.dataKey(me.payload):null}if(se)if(O>=0){var pe,H;if(L.dataKey&&!L.allowDuplicatedCategory){var ne=typeof L.dataKey=="function"?ae:"payload.".concat(L.dataKey.toString());pe=tg(F,ne,V),H=I&&R&&tg(R,ne,V)}else pe=F==null?void 0:F[O],H=I&&R&&R[O];if(K||q){var U=D.props.activeIndex!==void 0?D.props.activeIndex:O;return[M.cloneElement(D,Ee(Ee(Ee({},S.props),ie),{},{activeIndex:U})),null,null]}if(!yt(pe))return[ee].concat(Ud(_.renderActivePoints({item:S,activePoint:pe,basePoint:H,childIndex:O,isRange:I})))}else{var le,re=(le=_.getItemByXY(_.state.activeCoordinate))!==null&&le!==void 0?le:{graphicalItem:ee},X=re.graphicalItem,G=X.item,ce=G===void 0?D:G,J=X.childIndex,ue=Ee(Ee(Ee({},S.props),ie),{},{activeIndex:J});return[M.cloneElement(ce,ue),null,null]}return I?[ee,null,null]:[ee,null]}),ft(_,"renderCustomized",function(D,j,N){return M.cloneElement(D,Ee(Ee({key:"recharts-customized-".concat(N)},_.props),_.state))}),ft(_,"renderMap",{CartesianGrid:{handler:Kx,once:!0},ReferenceArea:{handler:_.renderReferenceElement},ReferenceLine:{handler:Kx},ReferenceDot:{handler:_.renderReferenceElement},XAxis:{handler:Kx},YAxis:{handler:Kx},Brush:{handler:_.renderBrush,once:!0},Bar:{handler:_.renderGraphicChild},Line:{handler:_.renderGraphicChild},Area:{handler:_.renderGraphicChild},Radar:{handler:_.renderGraphicChild},RadialBar:{handler:_.renderGraphicChild},Scatter:{handler:_.renderGraphicChild},Pie:{handler:_.renderGraphicChild},Funnel:{handler:_.renderGraphicChild},Tooltip:{handler:_.renderCursor,once:!0},PolarGrid:{handler:_.renderPolarGrid,once:!0},PolarAngleAxis:{handler:_.renderPolarAxis},PolarRadiusAxis:{handler:_.renderPolarAxis},Customized:{handler:_.renderCustomized}}),_.clipPathId="".concat((b=y.id)!==null&&b!==void 0?b:mf("recharts"),"-clip"),_.throttleTriggeredAfterMouseMove=VM(_.triggeredAfterMouseMove,(w=y.throttleDelay)!==null&&w!==void 0?w:1e3/60),_.state={},_}return PNe(v,g),CNe(v,[{key:"componentDidMount",value:function(){var b,w;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(b=this.props.margin.left)!==null&&b!==void 0?b:0,top:(w=this.props.margin.top)!==null&&w!==void 0?w:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var b=this.props,w=b.children,_=b.data,D=b.height,j=b.layout,N=Ya(w,Rr);if(N){var S=N.props.defaultIndex;if(!(typeof S!="number"||S<0||S>this.state.tooltipTicks.length-1)){var E=this.state.tooltipTicks[S]&&this.state.tooltipTicks[S].value,A=nj(this.state,_,S,E),T=this.state.tooltipTicks[S].coordinate,L=(this.state.offset.top+D)/2,O=j==="horizontal",V=O?{x:T,y:L}:{y:T,x:L},W=this.state.formattedGraphicalItems.find(function(P){var F=P.item;return F.type.name==="Scatter"});W&&(V=Ee(Ee({},V),W.props.points[S].tooltipPosition),A=W.props.points[S].tooltipPayload);var B={activeTooltipIndex:S,isTooltipActive:!0,activeLabel:E,activePayload:A,activeCoordinate:V};this.setState(B),this.renderCursor(N),this.accessibilityManager.setIndex(S)}}}},{key:"getSnapshotBeforeUpdate",value:function(b,w){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==w.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==b.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==b.margin){var _,D;this.accessibilityManager.setDetails({offset:{left:(_=this.props.margin.left)!==null&&_!==void 0?_:0,top:(D=this.props.margin.top)!==null&&D!==void 0?D:0}})}return null}},{key:"componentDidUpdate",value:function(b){O_([Ya(b.children,Rr)],[Ya(this.props.children,Rr)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var b=Ya(this.props.children,Rr);if(b&&typeof b.props.shared=="boolean"){var w=b.props.shared?"axis":"item";return l.indexOf(w)>=0?w:i}return i}},{key:"getMouseInfo",value:function(b){if(!this.container)return null;var w=this.container,_=w.getBoundingClientRect(),D=qme(_),j={chartX:Math.round(b.pageX-D.left),chartY:Math.round(b.pageY-D.top)},N=_.width/w.offsetWidth||1,S=this.inRange(j.chartX,j.chartY,N);if(!S)return null;var E=this.state,A=E.xAxisMap,T=E.yAxisMap,L=this.getTooltipEventType(),O=JO(this.state,this.props.data,this.props.layout,S);if(L!=="axis"&&A&&T){var V=ol(A).scale,W=ol(T).scale,B=V&&V.invert?V.invert(j.chartX):null,P=W&&W.invert?W.invert(j.chartY):null;return Ee(Ee({},j),{},{xValue:B,yValue:P},O)}return O?Ee(Ee({},j),O):null}},{key:"inRange",value:function(b,w){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,D=this.props.layout,j=b/_,N=w/_;if(D==="horizontal"||D==="vertical"){var S=this.state.offset,E=j>=S.left&&j<=S.left+S.width&&N>=S.top&&N<=S.top+S.height;return E?{x:j,y:N}:null}var A=this.state,T=A.angleAxisMap,L=A.radiusAxisMap;if(T&&L){var O=ol(T);return _4({x:j,y:N},O)}return null}},{key:"parseEventsOfWrapper",value:function(){var b=this.props.children,w=this.getTooltipEventType(),_=Ya(b,Rr),D={};_&&w==="axis"&&(_.props.trigger==="click"?D={onClick:this.handleClick}:D={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var j=rg(this.props,this.handleOuterEvent);return Ee(Ee({},j),D)}},{key:"addListener",value:function(){jw.on(Nw,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){jw.removeListener(Nw,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(b,w,_){for(var D=this.state.formattedGraphicalItems,j=0,N=D.length;j<N;j++){var S=D[j];if(S.item===b||S.props.key===b.key||w===wo(S.item.type)&&_===S.childIndex)return S}return null}},{key:"renderClipPath",value:function(){var b=this.clipPathId,w=this.state.offset,_=w.left,D=w.top,j=w.height,N=w.width;return Q.createElement("defs",null,Q.createElement("clipPath",{id:b},Q.createElement("rect",{x:_,y:D,height:j,width:N})))}},{key:"getXScales",value:function(){var b=this.state.xAxisMap;return b?Object.entries(b).reduce(function(w,_){var D=XO(_,2),j=D[0],N=D[1];return Ee(Ee({},w),{},ft({},j,N.scale))},{}):null}},{key:"getYScales",value:function(){var b=this.state.yAxisMap;return b?Object.entries(b).reduce(function(w,_){var D=XO(_,2),j=D[0],N=D[1];return Ee(Ee({},w),{},ft({},j,N.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(b){var w;return(w=this.state.xAxisMap)===null||w===void 0||(w=w[b])===null||w===void 0?void 0:w.scale}},{key:"getYScaleByAxisId",value:function(b){var w;return(w=this.state.yAxisMap)===null||w===void 0||(w=w[b])===null||w===void 0?void 0:w.scale}},{key:"getItemByXY",value:function(b){var w=this.state,_=w.formattedGraphicalItems,D=w.activeItem;if(_&&_.length)for(var j=0,N=_.length;j<N;j++){var S=_[j],E=S.props,A=S.item,T=A.type.defaultProps!==void 0?Ee(Ee({},A.type.defaultProps),A.props):A.props,L=wo(A.type);if(L==="Bar"){var O=(E.data||[]).find(function(P){return N1e(b,P)});if(O)return{graphicalItem:S,payload:O}}else if(L==="RadialBar"){var V=(E.data||[]).find(function(P){return _4(b,P)});if(V)return{graphicalItem:S,payload:V}}else if(lb(S,D)||cb(S,D)||Sm(S,D)){var W=u2e({graphicalItem:S,activeTooltipItem:D,itemData:T.data}),B=T.activeIndex===void 0?W:T.activeIndex;return{graphicalItem:Ee(Ee({},S),{},{childIndex:B}),payload:Sm(S,D)?T.data[W]:S.props.data[W]}}}return null}},{key:"render",value:function(){var b=this;if(!fA(this))return null;var w=this.props,_=w.children,D=w.className,j=w.width,N=w.height,S=w.style,E=w.compact,A=w.title,T=w.desc,L=KO(w,DNe),O=ut(L,!1);if(E)return Q.createElement(AO,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Q.createElement(P_,Vu({},O,{width:j,height:N,title:A,desc:T}),this.renderClipPath(),mA(_,this.renderMap)));if(this.props.accessibilityLayer){var V,W;O.tabIndex=(V=this.props.tabIndex)!==null&&V!==void 0?V:0,O.role=(W=this.props.role)!==null&&W!==void 0?W:"application",O.onKeyDown=function(P){b.accessibilityManager.keyboardEvent(P)},O.onFocus=function(){b.accessibilityManager.focus()}}var B=this.parseEventsOfWrapper();return Q.createElement(AO,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Q.createElement("div",Vu({className:vt("recharts-wrapper",D),style:Ee({position:"relative",cursor:"default",width:j,height:N},S)},B,{ref:function(F){b.container=F}}),Q.createElement(P_,Vu({},O,{width:j,height:N,title:A,desc:T,style:LNe}),this.renderClipPath(),mA(_,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(M.Component);ft(x,"displayName",r),ft(x,"defaultProps",Ee({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},f)),ft(x,"getDerivedStateFromProps",function(g,v){var y=g.dataKey,b=g.data,w=g.children,_=g.width,D=g.height,j=g.layout,N=g.stackOffset,S=g.margin,E=v.dataStartIndex,A=v.dataEndIndex;if(v.updateId===void 0){var T=QO(g);return Ee(Ee(Ee({},T),{},{updateId:0},m(Ee(Ee({props:g},T),{},{updateId:0}),v)),{},{prevDataKey:y,prevData:b,prevWidth:_,prevHeight:D,prevLayout:j,prevStackOffset:N,prevMargin:S,prevChildren:w})}if(y!==v.prevDataKey||b!==v.prevData||_!==v.prevWidth||D!==v.prevHeight||j!==v.prevLayout||N!==v.prevStackOffset||!Ju(S,v.prevMargin)){var L=QO(g),O={chartX:v.chartX,chartY:v.chartY,isTooltipActive:v.isTooltipActive},V=Ee(Ee({},JO(v,b,j)),{},{updateId:v.updateId+1}),W=Ee(Ee(Ee({},L),O),V);return Ee(Ee(Ee({},W),m(Ee({props:g},W),v)),{},{prevDataKey:y,prevData:b,prevWidth:_,prevHeight:D,prevLayout:j,prevStackOffset:N,prevMargin:S,prevChildren:w})}if(!O_(w,v.prevChildren)){var B,P,F,I,R=Ya(w,Td),C=R&&(B=(P=R.props)===null||P===void 0?void 0:P.startIndex)!==null&&B!==void 0?B:E,k=R&&(F=(I=R.props)===null||I===void 0?void 0:I.endIndex)!==null&&F!==void 0?F:A,z=C!==E||k!==A,q=!yt(b),K=q&&!z?v.updateId:v.updateId+1;return Ee(Ee({updateId:K},m(Ee(Ee({props:g},v),{},{updateId:K,dataStartIndex:C,dataEndIndex:k}),v)),{},{prevChildren:w,dataStartIndex:C,dataEndIndex:k})}return null}),ft(x,"renderActiveDot",function(g,v,y){var b;return M.isValidElement(g)?b=M.cloneElement(g,v):mt(g)?b=g(v):b=Q.createElement(rb,v),Q.createElement(Rt,{className:"recharts-active-dot",key:y},b)});var p=M.forwardRef(function(v,y){return Q.createElement(x,Vu({},v,{ref:y}))});return p.displayName=x.displayName,p},tv=xb({chartName:"LineChart",GraphicalChild:Gn,axisComponents:[{axisType:"xAxis",AxisComp:Ea},{axisType:"yAxis",AxisComp:Ta}],formatAxisMap:I$}),td=xb({chartName:"BarChart",GraphicalChild:ai,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:Ea},{axisType:"yAxis",AxisComp:Ta}],formatAxisMap:I$}),rv=xb({chartName:"PieChart",GraphicalChild:Bi,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:sb},{axisType:"radiusAxis",AxisComp:ab}],formatAxisMap:Bve,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});function KNe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e}var yL=KNe,ZNe=FS,JNe=Gp,QNe=Object.prototype,eSe=QNe.hasOwnProperty;function tSe(e,t,r){var n=e[t];(!(eSe.call(e,t)&&JNe(n,r))||r===void 0&&!(t in e))&&ZNe(e,t,r)}var bL=tSe,rSe=bL,nSe=FS;function aSe(e,t,r,n){var a=!r;r||(r={});for(var i=-1,s=t.length;++i<s;){var l=t[i],c=n?n(r[l],e[l],l,r,e):void 0;c===void 0&&(c=e[l]),a?nSe(r,l,c):rSe(r,l,c)}return r}var tx=aSe,iSe=tx,sSe=gf;function oSe(e,t){return e&&iSe(t,sSe(t),e)}var lSe=oSe;function cSe(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var uSe=cSe,dSe=Hi,fSe=eS,hSe=uSe,mSe=Object.prototype,pSe=mSe.hasOwnProperty;function xSe(e){if(!dSe(e))return hSe(e);var t=fSe(e),r=[];for(var n in e)n=="constructor"&&(t||!pSe.call(e,n))||r.push(n);return r}var gSe=xSe,vSe=_M,ySe=gSe,bSe=xf;function wSe(e){return bSe(e)?vSe(e,!0):ySe(e)}var gb=wSe,_Se=tx,DSe=gb;function jSe(e,t){return e&&_Se(t,DSe(t),e)}var NSe=jSe,nv={exports:{}};nv.exports;(function(e,t){var r=vs,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,s=i?r.Buffer:void 0,l=s?s.allocUnsafe:void 0;function c(u,d){if(d)return u.slice();var f=u.length,h=l?l(f):new u.constructor(f);return u.copy(h),h}e.exports=c})(nv,nv.exports);var SSe=nv.exports;function ESe(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var TSe=ESe,kSe=tx,CSe=YN;function ASe(e,t){return kSe(e,CSe(e),t)}var OSe=ASe,FSe=GN,PSe=ob,ISe=YN,RSe=bM,MSe=Object.getOwnPropertySymbols,USe=MSe?function(e){for(var t=[];e;)FSe(t,ISe(e)),e=PSe(e);return t}:RSe,wL=USe,$Se=tx,LSe=wL;function BSe(e,t){return $Se(e,LSe(e),t)}var WSe=BSe,zSe=yM,HSe=wL,VSe=gb;function qSe(e){return zSe(e,VSe,HSe)}var _L=qSe,GSe=Object.prototype,YSe=GSe.hasOwnProperty;function XSe(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&YSe.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var KSe=XSe,tF=vM;function ZSe(e){var t=new e.constructor(e.byteLength);return new tF(t).set(new tF(e)),t}var zS=ZSe,JSe=zS;function QSe(e,t){var r=t?JSe(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var eEe=QSe,tEe=/\w*$/;function rEe(e){var t=new e.constructor(e.source,tEe.exec(e));return t.lastIndex=e.lastIndex,t}var nEe=rEe,rF=lf,nF=rF?rF.prototype:void 0,aF=nF?nF.valueOf:void 0;function aEe(e){return aF?Object(aF.call(e)):{}}var iEe=aEe,sEe=zS;function oEe(e,t){var r=t?sEe(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var lEe=oEe,cEe=zS,uEe=eEe,dEe=nEe,fEe=iEe,hEe=lEe,mEe="[object Boolean]",pEe="[object Date]",xEe="[object Map]",gEe="[object Number]",vEe="[object RegExp]",yEe="[object Set]",bEe="[object String]",wEe="[object Symbol]",_Ee="[object ArrayBuffer]",DEe="[object DataView]",jEe="[object Float32Array]",NEe="[object Float64Array]",SEe="[object Int8Array]",EEe="[object Int16Array]",TEe="[object Int32Array]",kEe="[object Uint8Array]",CEe="[object Uint8ClampedArray]",AEe="[object Uint16Array]",OEe="[object Uint32Array]";function FEe(e,t,r){var n=e.constructor;switch(t){case _Ee:return cEe(e);case mEe:case pEe:return new n(+e);case DEe:return uEe(e,r);case jEe:case NEe:case SEe:case EEe:case TEe:case kEe:case CEe:case AEe:case OEe:return hEe(e,r);case xEe:return new n;case gEe:case bEe:return new n(e);case vEe:return dEe(e);case yEe:return new n;case wEe:return fEe(e)}}var PEe=FEe,IEe=Hi,iF=Object.create,REe=function(){function e(){}return function(t){if(!IEe(t))return{};if(iF)return iF(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),DL=REe,MEe=DL,UEe=ob,$Ee=eS;function LEe(e){return typeof e.constructor=="function"&&!$Ee(e)?MEe(UEe(e)):{}}var BEe=LEe,WEe=Wy,zEe=ys,HEe="[object Map]";function VEe(e){return zEe(e)&&WEe(e)==HEe}var qEe=VEe,GEe=qEe,YEe=By,sF=JN,oF=sF&&sF.isMap,XEe=oF?YEe(oF):GEe,KEe=XEe,ZEe=Wy,JEe=ys,QEe="[object Set]";function eTe(e){return JEe(e)&&ZEe(e)==QEe}var tTe=eTe,rTe=tTe,nTe=By,lF=JN,cF=lF&&lF.isSet,aTe=cF?nTe(cF):rTe,iTe=aTe,sTe=VN,oTe=yL,lTe=bL,cTe=lSe,uTe=NSe,dTe=SSe,fTe=TSe,hTe=OSe,mTe=WSe,pTe=jM,xTe=_L,gTe=Wy,vTe=KSe,yTe=PEe,bTe=BEe,wTe=sa,_Te=Ly,DTe=KEe,jTe=Hi,NTe=iTe,STe=gf,ETe=gb,TTe=1,kTe=2,CTe=4,jL="[object Arguments]",ATe="[object Array]",OTe="[object Boolean]",FTe="[object Date]",PTe="[object Error]",NL="[object Function]",ITe="[object GeneratorFunction]",RTe="[object Map]",MTe="[object Number]",SL="[object Object]",UTe="[object RegExp]",$Te="[object Set]",LTe="[object String]",BTe="[object Symbol]",WTe="[object WeakMap]",zTe="[object ArrayBuffer]",HTe="[object DataView]",VTe="[object Float32Array]",qTe="[object Float64Array]",GTe="[object Int8Array]",YTe="[object Int16Array]",XTe="[object Int32Array]",KTe="[object Uint8Array]",ZTe="[object Uint8ClampedArray]",JTe="[object Uint16Array]",QTe="[object Uint32Array]",ur={};ur[jL]=ur[ATe]=ur[zTe]=ur[HTe]=ur[OTe]=ur[FTe]=ur[VTe]=ur[qTe]=ur[GTe]=ur[YTe]=ur[XTe]=ur[RTe]=ur[MTe]=ur[SL]=ur[UTe]=ur[$Te]=ur[LTe]=ur[BTe]=ur[KTe]=ur[ZTe]=ur[JTe]=ur[QTe]=!0;ur[PTe]=ur[NL]=ur[WTe]=!1;function O0(e,t,r,n,a,i){var s,l=t&TTe,c=t&kTe,u=t&CTe;if(r&&(s=a?r(e,n,a,i):r(e)),s!==void 0)return s;if(!jTe(e))return e;var d=wTe(e);if(d){if(s=vTe(e),!l)return fTe(e,s)}else{var f=gTe(e),h=f==NL||f==ITe;if(_Te(e))return dTe(e,l);if(f==SL||f==jL||h&&!a){if(s=c||h?{}:bTe(e),!l)return c?mTe(e,uTe(s,e)):hTe(e,cTe(s,e))}else{if(!ur[f])return a?e:{};s=yTe(e,f,l)}}i||(i=new sTe);var m=i.get(e);if(m)return m;i.set(e,s),NTe(e)?e.forEach(function(g){s.add(O0(g,t,r,g,e,i))}):DTe(e)&&e.forEach(function(g,v){s.set(v,O0(g,t,r,v,e,i))});var x=u?c?xTe:pTe:c?ETe:STe,p=d?void 0:x(e);return oTe(p||e,function(g,v){p&&(v=g,g=e[v]),lTe(s,v,O0(g,t,r,v,e,i))}),s}var eke=O0,tke=Ny,rke=$N;function nke(e,t){return t.length<2?e:tke(e,rke(t,0,-1))}var ake=nke,ike=jy,ske=s$,oke=ake,lke=Yp;function cke(e,t){return t=ike(t,e),e=oke(e,t),e==null||delete e[lke(ske(t))]}var uke=cke,dke=w$;function fke(e){return dke(e)?void 0:e}var hke=fke,mke=rS;function pke(e){var t=e==null?0:e.length;return t?mke(e,1):[]}var xke=pke,gke=xke,vke=RM,yke=UM;function bke(e){return yke(vke(e,void 0,gke),e+"")}var wke=bke,_ke=Dy,Dke=eke,jke=uke,Nke=jy,Ske=tx,Eke=hke,Tke=wke,kke=_L,Cke=1,Ake=2,Oke=4,Fke=Tke(function(e,t){var r={};if(e==null)return r;var n=!1;t=_ke(t,function(i){return i=Nke(i,e),n||(n=i.length>1),i}),Ske(e,kke(e),r),n&&(r=Dke(r,Cke|Ake|Oke,Eke));for(var a=t.length;a--;)jke(r,t[a]);return r}),Pke=Fke;const EL=At(Pke);function Pm(e){"@babel/helpers - typeof";return Pm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pm(e)}function aj(){return aj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},aj.apply(this,arguments)}function uF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ew(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uF(Object(r),!0).forEach(function(n){Ike(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ike(e,t,r){return t=Rke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rke(e){var t=Mke(e,"string");return Pm(t)=="symbol"?t:t+""}function Mke(e,t){if(Pm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Pm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Uke(e,t){var r="".concat(t.x||e.x),n=parseInt(r,10),a="".concat(t.y||e.y),i=parseInt(a,10),s="".concat((t==null?void 0:t.height)||(e==null?void 0:e.height)),l=parseInt(s,10);return Ew(Ew(Ew({},t),_$(e)),{},{height:l,x:n,y:i})}function $ke(e){return Q.createElement(OS,aj({shapeType:"trapezoid",propTransformer:Uke},e))}var ij;function dF(e,t){return zke(e)||Wke(e,t)||Bke(e,t)||Lke()}function Lke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bke(e,t){if(e){if(typeof e=="string")return fF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fF(e,t)}}function fF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Wke(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function zke(e){if(Array.isArray(e))return e}function $d(e){"@babel/helpers - typeof";return $d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$d(e)}function av(){return av=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},av.apply(this,arguments)}function hF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function sn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hF(Object(r),!0).forEach(function(n){Do(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Hke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kL(n.key),n)}}function Vke(e,t,r){return t&&mF(e.prototype,t),r&&mF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qke(e,t,r){return t=iv(t),Gke(e,TL()?Reflect.construct(t,r||[],iv(e).constructor):t.apply(e,r))}function Gke(e,t){if(t&&($d(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yke(e)}function Yke(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TL(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(TL=function(){return!!e})()}function iv(e){return iv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},iv(e)}function Xke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sj(e,t)}function sj(e,t){return sj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},sj(e,t)}function Do(e,t,r){return t=kL(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kL(e){var t=Kke(e,"string");return $d(t)=="symbol"?t:t+""}function Kke(e,t){if($d(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if($d(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Wl=function(e){function t(){var r;Hke(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=qke(this,t,[].concat(a)),Do(r,"state",{isAnimationFinished:!1}),Do(r,"handleAnimationEnd",function(){var s=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),mt(s)&&s()}),Do(r,"handleAnimationStart",function(){var s=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),mt(s)&&s()}),r}return Xke(t,e),Vke(t,[{key:"isActiveIndex",value:function(n){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(n)!==-1:n===a}},{key:"renderTrapezoidsStatically",value:function(n){var a=this,i=this.props,s=i.shape,l=i.activeShape;return n.map(function(c,u){var d=a.isActiveIndex(u)?l:s,f=sn(sn({},c),{},{isActive:a.isActiveIndex(u),stroke:c.stroke});return Q.createElement(Rt,av({className:"recharts-funnel-trapezoid"},Sl(a.props,c,u),{key:"trapezoid-".concat(c==null?void 0:c.x,"-").concat(c==null?void 0:c.y,"-").concat(c==null?void 0:c.name,"-").concat(c==null?void 0:c.value),role:"img"}),Q.createElement($ke,av({option:d},f)))})}},{key:"renderTrapezoidsWithAnimation",value:function(){var n=this,a=this.props,i=a.trapezoids,s=a.isAnimationActive,l=a.animationBegin,c=a.animationDuration,u=a.animationEasing,d=a.animationId,f=this.state.prevTrapezoids;return Q.createElement(ds,{begin:l,duration:c,isActive:s,easing:u,from:{t:0},to:{t:1},key:"funnel-".concat(d),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(h){var m=h.t,x=i.map(function(p,g){var v=f&&f[g];if(v){var y=Ar(v.x,p.x),b=Ar(v.y,p.y),w=Ar(v.upperWidth,p.upperWidth),_=Ar(v.lowerWidth,p.lowerWidth),D=Ar(v.height,p.height);return sn(sn({},p),{},{x:y(m),y:b(m),upperWidth:w(m),lowerWidth:_(m),height:D(m)})}var j=Ar(p.x+p.upperWidth/2,p.x),N=Ar(p.y+p.height/2,p.y),S=Ar(0,p.upperWidth),E=Ar(0,p.lowerWidth),A=Ar(0,p.height);return sn(sn({},p),{},{x:j(m),y:N(m),upperWidth:S(m),lowerWidth:E(m),height:A(m)})});return Q.createElement(Rt,null,n.renderTrapezoidsStatically(x))})}},{key:"renderTrapezoids",value:function(){var n=this.props,a=n.trapezoids,i=n.isAnimationActive,s=this.state.prevTrapezoids;return i&&a&&a.length&&(!s||!lu(s,a))?this.renderTrapezoidsWithAnimation():this.renderTrapezoidsStatically(a)}},{key:"render",value:function(){var n=this.props,a=n.hide,i=n.trapezoids,s=n.className,l=n.isAnimationActive,c=this.state.isAnimationFinished;if(a||!i||!i.length)return null;var u=vt("recharts-trapezoids",s);return Q.createElement(Rt,{className:u},this.renderTrapezoids(),(!l||c)&&ls.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curTrapezoids:n.trapezoids,prevTrapezoids:a.curTrapezoids}:n.trapezoids!==a.curTrapezoids?{curTrapezoids:n.trapezoids}:null}}])}(M.PureComponent);ij=Wl;Do(Wl,"displayName","Funnel");Do(Wl,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",labelLine:!0,hide:!1,isAnimationActive:!Ul.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",lastShapeType:"triangle"});Do(Wl,"getRealFunnelData",function(e){var t=e.props,r=t.data,n=t.children,a=ut(e.props,!1),i=Oa(n,Ao);return r&&r.length?r.map(function(s,l){return sn(sn(sn({payload:s},a),s),i&&i[l]&&i[l].props)}):i&&i.length?i.map(function(s){return sn(sn({},a),s.props)}):[]});Do(Wl,"getRealWidthHeight",function(e,t){var r=e.props.width,n=t.width,a=t.height,i=t.left,s=t.right,l=t.top,c=t.bottom,u=a,d=n;return BR(r)?d=r:Nl(r)&&(d=d*parseFloat(r)/100),{realWidth:d-i-s-50,realHeight:u-c-l,offsetX:(n-d)/2,offsetY:(a-u)/2}});Do(Wl,"getComposedData",function(e){var t=e.item,r=e.offset,n=ij.getRealFunnelData(t),a=t.props,i=a.dataKey,s=a.nameKey,l=a.tooltipType,c=a.lastShapeType,u=a.reversed,d=r.left,f=r.top,h=ij.getRealWidthHeight(t,r),m=h.realHeight,x=h.realWidth,p=h.offsetX,g=h.offsetY,v=Math.max.apply(null,n.map(function(D){return Or(D,i,0)})),y=n.length,b=m/y,w={x:r.left,y:r.top,width:r.width,height:r.height},_=n.map(function(D,j){var N=Or(D,i,0),S=Or(D,s,j),E=N,A;if(j!==y-1){if(A=Or(n[j+1],i,0),A instanceof Array){var T=A,L=dF(T,1);A=L[0]}}else if(N instanceof Array&&N.length===2){var O=dF(N,2);E=O[0],A=O[1]}else c==="rectangle"?A=E:A=0;var V=(v-E)*x/(2*v)+f+25+p,W=b*j+d+g,B=E/v*x,P=A/v*x,F=[{name:S,value:E,payload:D,dataKey:i,type:l}],I={x:V+B/2,y:W+b/2};return sn(sn({x:V,y:W,width:Math.max(B,P),upperWidth:B,lowerWidth:P,height:b,name:S,val:E,tooltipPayload:F,tooltipPosition:I},EL(D,"width")),{},{payload:D,parentViewBox:w,labelViewBox:{x:V+(B-P)/4,y:W,width:Math.abs(B-P)/2+Math.min(B,P),height:b}})});return u&&(_=_.map(function(D,j){var N=D.y-j*b+(y-1-j)*b;return sn(sn({},D),{},{upperWidth:D.lowerWidth,lowerWidth:D.upperWidth,x:D.x-(D.lowerWidth-D.upperWidth)/2,y:D.y-j*b+(y-1-j)*b,tooltipPosition:sn(sn({},D.tooltipPosition),{},{y:N+b/2}),labelViewBox:sn(sn({},D.labelViewBox),{},{y:N})})})),{trapezoids:_,data:n}});var Zke=xb({chartName:"FunnelChart",GraphicalChild:Wl,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",axisComponents:[],defaultProps:{layout:"centric"}});const Jke=()=>{const{theme:e,toggleTheme:t}=M.useContext(oI);return o.jsx("button",{onClick:t,className:"p-2 text-text-secondary hover:text-text-primary transition-colors duration-150 ease-smooth",title:e==="light"?"Switch to Dark Mode":"Switch to Light Mode",children:o.jsx(Y,{name:e==="light"?"Moon":"Sun",size:20})})},ii=()=>{const{signOut:e,user:t,userProfile:r,hasPermission:n,refreshPermissions:a,permissions:i}=Vt(),s=Il(),[l,c]=M.useState(!1),[u,d]=M.useState(!1),f=Xj(),h=[{label:"Dashboard",path:"/sales-dashboard",icon:"BarChart3",tooltip:"Pipeline overview and metrics",requiredPermission:"dashboard.view_stats"},{label:"Campaigns",path:"/campaign-management",icon:"Megaphone",tooltip:"Marketing campaign management",requiredPermission:"campaigns.view_own"},{label:"Contacts",path:"/contact-management",icon:"Users",tooltip:"Customer relationship management",requiredPermission:"contacts.view_own"},{label:"Deals",path:"/deal-management",icon:"Target",tooltip:"Manage deal lifecycle and opportunities",requiredPermission:"deals.view_own"},{label:"Companies",path:"/company-management",icon:"Building2",tooltip:"Company management and relationships",requiredPermission:"companies.view_own"},{label:"Analytics",path:"/pipeline-analytics",icon:"TrendingUp",tooltip:"Performance insights and analysis",requiredPermission:"analytics.view_personal"},{label:"Activity",path:"/activity-timeline",icon:"Clock",tooltip:"Interaction timeline and history",requiredPermission:"activities.view_own"}],m=[{label:"Settings",path:"/settings-administration",icon:"Settings",requiredPermission:"settings.view_profile"},{label:"Logout",action:"logout",icon:"LogOut"}],x=h.filter(D=>D.requiredPermission?n(D.requiredPermission):!0),p=m.filter(D=>D.requiredPermission?n(D.requiredPermission):!0),g=D=>f.pathname===D,v=()=>{c(!l)},y=()=>{d(!u)},b=()=>{d(!1),c(!1)},w=async()=>{try{c(!1),d(!1),await e(),Ue.success("Logged out successfully!"),s("/login")}catch{Ue.error("Failed to logout. Please try again.")}},_=D=>{D.action==="logout"?w():b()};return o.jsxs(o.Fragment,{children:[o.jsx("header",{className:"fixed top-0 left-0 right-0 bg-surface border-b border-border z-1000",children:o.jsx("div",{className:"px-2 xs:px-3 sm:px-4 py-2 sm:py-2.5",children:o.jsxs("div",{className:"flex items-center justify-between gap-1 xs:gap-2",children:[o.jsx("div",{className:"flex items-center flex-shrink-0 min-w-0",children:o.jsxs(Ur,{to:"/sales-dashboard",className:"flex items-center space-x-1.5 xs:space-x-2 min-w-0",onClick:b,children:[o.jsx("div",{className:"w-7 h-7 xs:w-8 xs:h-8 bg-primary rounded-lg flex items-center justify-center flex-shrink-0",children:o.jsxs("svg",{width:"18",height:"18",className:"xs:w-5 xs:h-5",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[o.jsx("path",{d:"M3 13L12 4L21 13",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),o.jsx("path",{d:"M9 21V13H15V21",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),o.jsx("span",{className:"text-base xs:text-lg font-semibold text-text-primary font-heading whitespace-nowrap hidden xs:inline",children:"SalesForce Lite"}),o.jsx("span",{className:"text-base font-semibold text-text-primary font-heading whitespace-nowrap xs:hidden",children:"SF"})]})}),o.jsx("nav",{className:"hidden lg:flex items-center space-x-1",children:x==null?void 0:x.map(D=>o.jsxs(Ur,{to:D==null?void 0:D.path,onClick:b,className:`px-3 py-2 rounded-lg text-sm font-medium transition-all duration-150 ease-smooth flex items-center space-x-2 ${g(D==null?void 0:D.path)?"bg-primary-50 text-primary border border-primary-100":"text-text-secondary hover:text-primary"}`,title:D==null?void 0:D.tooltip,children:[o.jsx(Y,{name:D==null?void 0:D.icon,size:16}),o.jsx("span",{children:D==null?void 0:D.label})]},D==null?void 0:D.path))}),o.jsxs("div",{className:"flex items-center space-x-1 xs:space-x-2 flex-shrink-0",children:[o.jsx("div",{className:"hidden xs:block",children:o.jsx(Jke,{})}),o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:v,className:"flex items-center space-x-1.5 xs:space-x-2 p-1.5 xs:p-2 rounded-lg hover:bg-surface-hover transition-colors duration-150 ease-smooth min-h-touch",children:[o.jsx("div",{className:"w-8 h-8 xs:w-8 xs:h-8 bg-primary-100 rounded-full flex items-center justify-center flex-shrink-0",children:o.jsx(Y,{name:"User",size:16,className:"text-primary"})}),o.jsxs("div",{className:"hidden sm:block text-left max-w-[120px] md:max-w-[150px]",children:[o.jsx("div",{className:"text-xs sm:text-sm font-medium text-text-primary truncate",children:(r==null?void 0:r.full_name)||(r==null?void 0:r.first_name)||(t==null?void 0:t.email)||"User"}),o.jsx("div",{className:"text-xs text-text-secondary truncate",children:(r==null?void 0:r.role)==="admin"?"Administrator":(r==null?void 0:r.role)==="sales_manager"?"Sales Manager":(r==null?void 0:r.role)==="sales_rep"?"Sales Rep":"User"})]}),o.jsx(Y,{name:"ChevronDown",size:14,className:"text-text-secondary flex-shrink-0 hidden xs:block"})]}),l&&o.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-surface rounded-lg shadow-lg border border-border z-1100",children:o.jsx("div",{className:"py-2",children:p==null?void 0:p.map(D=>D.action==="logout"?o.jsxs("div",{onClick:w,className:"w-full text-left flex items-center space-x-3 px-4 py-2 text-sm text-text-secondary hover:text-primary ",children:[o.jsx(Y,{name:D==null?void 0:D.icon,size:16}),o.jsx("span",{children:D==null?void 0:D.label})]},D.label):o.jsxs(Ur,{to:D==null?void 0:D.path,onClick:()=>_(D),className:"flex items-center space-x-3 px-4 py-2 text-sm text-text-secondary hover:text-primary ",children:[o.jsx(Y,{name:D==null?void 0:D.icon,size:16}),o.jsx("span",{children:D==null?void 0:D.label})]},D==null?void 0:D.path))})})]}),o.jsx("button",{onClick:y,className:"lg:hidden p-2 min-h-touch min-w-touch flex items-center justify-center text-text-secondary hover:text-text-primary transition-colors duration-150 ease-smooth","aria-label":"Toggle mobile menu",children:o.jsx(Y,{name:u?"X":"Menu",size:20})})]})]})})}),u&&o.jsxs("div",{className:"fixed inset-0 z-1200 lg:hidden",children:[o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:y,role:"button",tabIndex:0,onKeyDown:D=>D.key==="Escape"&&y(),"aria-label":"Close menu"}),o.jsx("div",{className:"fixed left-0 top-0 bottom-0 w-[280px] xs:w-80 max-w-[85vw] bg-surface shadow-xl overflow-y-auto",children:o.jsxs("div",{className:"p-4 xs:p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-8",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-8 h-8 bg-primary rounded-lg flex items-center justify-center",children:o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[o.jsx("path",{d:"M3 13L12 4L21 13",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),o.jsx("path",{d:"M9 21V13H15V21",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),o.jsx("span",{className:"text-xl font-semibold text-text-primary font-heading",children:"SalesForce Lite"})]}),o.jsx("button",{onClick:y,className:"p-2 text-text-secondary hover:text-text-primary transition-colors duration-150 ease-smooth",children:o.jsx(Y,{name:"X",size:20})})]}),o.jsxs("nav",{className:"space-y-1.5",children:[x==null?void 0:x.map(D=>o.jsxs(Ur,{to:D==null?void 0:D.path,onClick:b,className:`flex items-center space-x-3 px-3 xs:px-4 py-3 min-h-touch rounded-lg text-sm xs:text-base font-medium transition-all duration-150 ease-smooth ${g(D==null?void 0:D.path)?"bg-primary-50 text-primary border border-primary-100":"text-text-secondary hover:text-text-primary hover:bg-surface-hover"}`,children:[o.jsx(Y,{name:D==null?void 0:D.icon,size:20,className:"flex-shrink-0"}),o.jsx("span",{className:"truncate",children:D==null?void 0:D.label})]},D==null?void 0:D.path)),o.jsx("div",{className:"border-t border-border my-4"}),p==null?void 0:p.map(D=>D.action==="logout"?o.jsxs("button",{onClick:w,className:"w-full flex items-center space-x-3 px-3 xs:px-4 py-3 min-h-touch rounded-lg text-sm xs:text-base font-medium text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-smooth",children:[o.jsx(Y,{name:D==null?void 0:D.icon,size:20,className:"flex-shrink-0"}),o.jsx("span",{className:"truncate",children:D==null?void 0:D.label})]},D.label):o.jsxs(Ur,{to:D==null?void 0:D.path,onClick:()=>_(D),className:"flex items-center space-x-3 px-3 xs:px-4 py-3 min-h-touch rounded-lg text-sm xs:text-base font-medium text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-smooth",children:[o.jsx(Y,{name:D==null?void 0:D.icon,size:20,className:"flex-shrink-0"}),o.jsx("span",{className:"truncate",children:D==null?void 0:D.label})]},D==null?void 0:D.path))]})]})})]}),l&&o.jsx("div",{className:"fixed inset-0 z-1050",onClick:()=>c(!1)})]})},Hs=()=>{const e=Xj(),t={"/sales-dashboard":{label:"Dashboard",parent:null},"/deal-management":{label:"Deal Management",parent:"/sales-dashboard"},"/contact-management":{label:"Contact Management",parent:"/sales-dashboard"},"/pipeline-analytics":{label:"Pipeline Analytics",parent:"/sales-dashboard"},"/activity-timeline":{label:"Activity Timeline",parent:"/sales-dashboard"},"/settings-administration":{label:"Settings & Administration",parent:"/sales-dashboard"},"/login":{label:"Login",parent:null}},n=(()=>{var l,c,u;const a=e.pathname,i=[];if(!(t!=null&&t[a]))return i;let s=a;for(;s&&(t!=null&&t[s]);)i==null||i.unshift({label:(l=t==null?void 0:t[s])==null?void 0:l.label,path:s,isActive:s===a}),s=(c=t==null?void 0:t[s])==null?void 0:c.parent;return(i==null?void 0:i.length)>0&&((u=i==null?void 0:i[0])==null?void 0:u.path)!=="/sales-dashboard"&&a!=="/sales-dashboard"&&(i==null||i.unshift({label:"Dashboard",path:"/sales-dashboard",isActive:!1})),i})();return e.pathname==="/login"||(n==null?void 0:n.length)<=1?null:o.jsxs("nav",{className:"flex items-center space-x-2 text-sm mb-6","aria-label":"Breadcrumb",children:[o.jsx(Y,{name:"Home",size:16,className:"text-text-tertiary"}),n==null?void 0:n.map((a,i)=>o.jsxs(Q.Fragment,{children:[i>0&&o.jsx(Y,{name:"ChevronRight",size:14,className:"text-text-tertiary"}),a!=null&&a.isActive?o.jsx("span",{className:"text-text-primary font-medium","aria-current":"page",children:a==null?void 0:a.label}):o.jsx(Ur,{to:a==null?void 0:a.path,className:"text-text-secondary hover:text-primary transition-colors duration-150 ease-smooth",children:a==null?void 0:a.label})]},a==null?void 0:a.path))]})};class Qke{constructor(){this.config=null,this.loaded=!1}async loadConfiguration(){try{const{data:t,error:r}=await be.get("/api/v1/system-config/current");if(r)throw r;return this.config=t,this.loaded=!0,t}catch(t){return console.error("Failed to load system configuration:",t),this.config={general:{currency:"USD",time_format:"12",date_format:"MM/DD/YYYY",company_name:"Your Company"}},this.loaded=!0,this.config}}async getConfig(){return this.loaded||await this.loadConfiguration(),this.config}getCurrency(){var t,r;return((r=(t=this.config)==null?void 0:t.general)==null?void 0:r.currency)||"USD"}getTimeFormat(){var t,r;return((r=(t=this.config)==null?void 0:t.general)==null?void 0:r.time_format)||"12"}getDateFormat(){var t,r;return((r=(t=this.config)==null?void 0:t.general)==null?void 0:r.date_format)||"MM/DD/YYYY"}getCompanyName(){var t,r;return((r=(t=this.config)==null?void 0:t.general)==null?void 0:r.company_name)||"Your Company"}formatCurrency(t){const r=this.getCurrency();return new Intl.NumberFormat("en-US",{style:"currency",currency:r}).format(t)}formatDate(t){const r=this.getDateFormat(),n=new Date(t);switch(r){case"DD/MM/YYYY":return`${n.getDate().toString().padStart(2,"0")}/${(n.getMonth()+1).toString().padStart(2,"0")}/${n.getFullYear()}`;case"YYYY-MM-DD":return`${n.getFullYear()}-${(n.getMonth()+1).toString().padStart(2,"0")}-${n.getDate().toString().padStart(2,"0")}`;case"DD-MM-YYYY":return`${n.getDate().toString().padStart(2,"0")}-${(n.getMonth()+1).toString().padStart(2,"0")}-${n.getFullYear()}`;default:return`${(n.getMonth()+1).toString().padStart(2,"0")}/${n.getDate().toString().padStart(2,"0")}/${n.getFullYear()}`}}formatTime(t){const r=this.getTimeFormat(),n=new Date(t);return r==="24"?n.toLocaleTimeString("en-US",{hour12:!1}):n.toLocaleTimeString("en-US",{hour12:!0})}}const Gr=new Qke,Ct={async getUserContacts(){const{data:e,error:t}=await be.get("/api/v1/contacts");if(t)throw console.error("[contactsService] Error fetching contacts:",t),t;return e||[]},async getContactsForActivityFilters(){const{data:e,error:t}=await be.get("/api/v1/contacts/activity-filters");if(t)throw console.error("[contactsService] Error fetching contacts for activity filters:",t),t;return e||[]},async getContactById(e){const{data:t,error:r}=await be.get(`/api/v1/contacts/${e}`);if(r){if(r.status===404)return null;throw r}return t},async createContact(e){const t={first_name:e.first_name,last_name:e.last_name,email:e.email||null,phone:e.phone||null,mobile:e.mobile||null,position:e.position||null,status:e.status||"active",notes:e.notes||null,social_linkedin:e.social_linkedin||null,social_twitter:e.social_twitter||null,company_id:e.company_id||null,custom_fields:e.custom_fields||void 0},{data:r,error:n}=await be.post("/api/v1/contacts",t);if(n)throw n;return r},async updateContact(e,t){const r={first_name:t.first_name,last_name:t.last_name,email:t.email||null,phone:t.phone||null,mobile:t.mobile||null,position:t.position||null,status:t.status||null,notes:t.notes||null,social_linkedin:t.social_linkedin||null,social_twitter:t.social_twitter||null,company_id:t.company_id||null,custom_fields:t.custom_fields||void 0};Object.keys(r).forEach(i=>{r[i]===void 0&&delete r[i]});const{data:n,error:a}=await be.put(`/api/v1/contacts/${e}`,r);if(a)throw a;return n},async deleteContact(e){const{data:t,error:r}=await be.delete(`/api/v1/contacts/${e}`);if(r)throw r;return!0},async deleteContacts(e){try{return await Promise.all(e.map(t=>this.deleteContact(t))),!0}catch(t){throw t}},async searchContacts(e){const{data:t,error:r}=await be.get(`/api/v1/contacts?search=${encodeURIComponent(e)}`);if(r)throw r;return t||[]},async filterContacts(e){const t=new URLSearchParams;e!=null&&e.status&&e.status.length>0&&t.append("status",e.status.join(",")),e!=null&&e.companies&&e.companies.length>0&&t.append("companies",e.companies.join(",")),e!=null&&e.leadSources&&e.leadSources.length>0&&t.append("lead_sources",e.leadSources.join(",")),e!=null&&e.dateRange&&(t.append("date_start",e.dateRange.start),t.append("date_end",e.dateRange.end));const r=t.toString(),n=r?`/api/v1/contacts?${r}`:"/api/v1/contacts",{data:a,error:i}=await be.get(n);if(i)throw i;return a||[]},async getContactStats(){const{data:e,error:t}=await be.get("/api/v1/contacts/stats");if(t){const r=await this.getUserContacts(),n={total:r.length||0,active:r.filter(a=>a.status==="active").length||0,prospects:r.filter(a=>a.status==="prospect").length||0,customers:r.filter(a=>a.status==="customer").length||0,leadSources:{}};return r.forEach(a=>{const i=a.lead_source||"unknown";n.leadSources[i]=(n.leadSources[i]||0)+1}),n}return e},subscribeToContacts(e){return{unsubscribe:()=>{}}},async importContacts(e){const{data:t,error:r}=await be.post("/api/v1/contacts/import",e);if(r)throw console.error("Import API error:",r),r;return t!=null&&t.errors&&t.errors.length>0&&console.error("Import errors from backend:",t.errors),t},async mergeContacts(e,t,r){const{data:n,error:a}=await be.post(`/api/v1/contacts/${e}/merge`,{duplicate_id:t,merged_data:r});if(a)throw a;return n}},gt={async getUserDeals(e={}){try{const t=new URLSearchParams;e.dateRange&&t.append("date_range",e.dateRange),e.probabilityRange&&t.append("probability_range",e.probabilityRange),e.ownerId&&t.append("owner_id",e.ownerId),e.stage&&t.append("stage",e.stage);const r=t.toString(),n=r?`/api/v1/deals?${r}`:"/api/v1/deals",{data:a,error:i}=await be.get(n);if(i)throw i;return a||[]}catch(t){throw console.error("Error fetching user deals:",t),t}},async getPipelineDeals(e={}){try{const t=new URLSearchParams;e.dateRange&&t.append("date_range",e.dateRange),e.probabilityRange&&t.append("probability_range",e.probabilityRange),e.ownerId&&t.append("owner_id",e.ownerId);const r=t.toString(),n=r?`/api/v1/deals/pipeline?${r}`:"/api/v1/deals/pipeline",{data:a,error:i}=await be.get(n);if(i)throw i;return a}catch(t){throw console.error("Error fetching pipeline deals:",t),t}},async getDealById(e){try{const{data:t,error:r}=await be.get(`/api/v1/deals/${e}`);if(r){if(r.status===404)return null;throw r}return t}catch(t){throw console.error("Error fetching deal:",t),t}},async createDeal(e){try{const t={name:e.name,value:e.value||null,stage:e.stage||"lead",probability:e.probability||0,expected_close_date:e.expected_close_date||null,description:e.description||null,source:e.source||null,next_action:e.next_action||null,company_id:e.company_id||null,contact_id:e.contact_id||null},{data:r,error:n}=await be.post("/api/v1/deals",t);if(n)throw console.error("API returned error:",n),n;return r}catch(t){throw console.error("Error creating deal:",t),t}},async updateDeal(e,t){try{const{data:r,error:n}=await be.put(`/api/v1/deals/${e}`,t);if(n)throw console.error("API returned error:",n),console.error("Error details:",JSON.stringify(n,null,2)),n;return r}catch(r){throw console.error("Error updating deal:",r),r}},async deleteDeal(e){try{const{data:t,error:r}=await be.delete(`/api/v1/deals/${e}`);if(r)throw r;return!0}catch(t){throw console.error("Error deleting deal:",t),t}},async deleteDeals(e){try{return await Promise.all(e.map(t=>this.deleteDeal(t))),!0}catch(t){throw t}},async updateDealStage(e,t){try{const r={stage:t};return(t==="closed_won"||t==="closed_lost")&&(r.actual_close_date=new Date().toISOString()),await this.updateDeal(e,r)}catch(r){throw console.error("Error updating deal stage:",r),r}},async moveDeal(e,t){return await this.updateDealStage(e,t)},async getDealsByStage(e){try{const{data:t,error:r}=await be.get(`/api/v1/deals?stage=${encodeURIComponent(e)}`);if(r)throw r;return t||[]}catch(t){throw console.error("Error fetching deals by stage:",t),t}},async searchDeals(e){try{const{data:t,error:r}=await be.get(`/api/v1/deals?search=${encodeURIComponent(e)}`);if(r)throw r;return t||[]}catch(t){throw console.error("Error searching deals:",t),t}},async filterDeals(e){try{const t=new URLSearchParams;e!=null&&e.stage&&e.stage.length>0&&t.append("stage",e.stage.join(",")),e!=null&&e.owner&&e.owner.length>0&&t.append("owner",e.owner.join(",")),e!=null&&e.valueRange&&(e.valueRange.min!==void 0&&t.append("min_value",e.valueRange.min),e.valueRange.max!==void 0&&t.append("max_value",e.valueRange.max)),e!=null&&e.dateRange&&(t.append("date_start",e.dateRange.start),t.append("date_end",e.dateRange.end));const r=t.toString(),n=r?`/api/v1/deals?${r}`:"/api/v1/deals",{data:a,error:i}=await be.get(n);if(i)throw i;return a||[]}catch(t){throw console.error("Error filtering deals:",t),t}},async getDealStats(){try{const{data:e,error:t}=await be.get("/api/v1/deals/stats/overview");if(t){const r=await this.getUserDeals(),n=r.reduce((l,c)=>l+(c.value||0),0),a=r.filter(l=>l.stage==="closed_won"),i=r.filter(l=>l.stage==="closed_lost"),s=r.filter(l=>!["closed_won","closed_lost"].includes(l.stage));return{total_deals:r.length,active_deals:s.length,won_deals:a.length,lost_deals:i.length,total_value:n,won_value:a.reduce((l,c)=>l+(c.value||0),0),pipeline_value:s.reduce((l,c)=>l+(c.value||0),0),conversion_rate:a.length+i.length>0?Math.round(a.length/(a.length+i.length)*100*100)/100:0}}return e}catch(e){throw console.error("Error fetching deal stats:",e),e}},async getPipelineMetrics(){try{const e=await this.getPipelineDeals(),t={stages:{},totalValue:0,totalDeals:0};return Object.keys(e).forEach(r=>{const n=e[r],a=n.deals.reduce((i,s)=>i+(s.value||0),0);t.stages[r]={count:n.deals.length,value:a,title:n.title},t.totalValue+=a,t.totalDeals+=n.deals.length}),t}catch(e){throw console.error("Error fetching pipeline metrics:",e),e}},async cloneDeal(e){try{const t=await this.getDealById(e);if(!t)throw new Error("Deal not found");const r={name:`${t.name} (Copy)`,value:t.value,stage:"lead",probability:0,description:t.description,source:t.source,company_id:t.company_id,contact_id:t.contact_id};return await this.createDeal(r)}catch(t){throw console.error("Error cloning deal:",t),t}},subscribeToDeals(e){return{unsubscribe:()=>{}}},async getRevenueData(e={}){try{const t=new URLSearchParams;e.dateRange&&t.append("date_range",e.dateRange),e.ownerId&&t.append("owner_id",e.ownerId);const r=t.toString(),n=r?`/api/v1/deals/analytics/revenue?${r}`:"/api/v1/deals/analytics/revenue",{data:a,error:i}=await be.get(n);if(i){const s=await this.getUserDeals(),l=new Date,c=[];for(let u=11;u>=0;u--){const d=new Date(l.getFullYear(),l.getMonth()-u,1),f=d.toLocaleDateString("en-US",{month:"short"}),h=s.filter(v=>{if(v.actual_close_date){const y=new Date(v.actual_close_date);return y.getMonth()===d.getMonth()&&y.getFullYear()===d.getFullYear()}return!1}),m=h.filter(v=>v.stage==="closed_won"),x=m.reduce((v,y)=>v+(y.value||0),0),p=x>0?x*1.1:Math.random()*5e4+3e4,g=p*.9;c.push({month:f,actual:x,forecast:Math.round(p),target:Math.round(g),actualDealsCount:m.length,totalDealsCount:h.length})}return c}return a}catch(t){throw console.error("Error fetching revenue data:",t),t}},async getPerformanceMetrics(e={}){try{const t=new URLSearchParams;e.dateRange&&t.append("date_range",e.dateRange),e.ownerId&&t.append("owner_id",e.ownerId);const r=t.toString(),n=r?`/api/v1/deals/analytics/performance?${r}`:"/api/v1/deals/analytics/performance",{data:a,error:i}=await be.get(n);if(i){const s=await this.getUserDeals(),l=s.filter(x=>x.stage==="closed_won"),c=s.filter(x=>x.stage==="closed_lost"),u=l.length+c.length,d=l.reduce((x,p)=>x+(p.value||0),0),f=Math.max(d*1.3,5e5),h=l.length>0?d/l.length:0,m=u>0?l.length/u*100:0;return{achieved:d,quota:f,quota:f,percentage:Math.round(d/f*100),avgDealSize:Math.round(h),conversionRate:m,dealsWon:l.length,dealsLost:c.length,totalDeals:s.length}}return a}catch(t){throw console.error("Error fetching performance metrics:",t),t}},async getFilterOptions(){try{const{data:e,error:t}=await be.get("/api/v1/deals/analytics/filter-options");return t?{reps:[{value:"all",label:"All Representatives"}],dateRanges:[{value:"all",label:"All Time"},{value:"thisquarter",label:"This Quarter"},{value:"lastquarter",label:"Last Quarter"},{value:"thisyear",label:"This Year"},{value:"lastyear",label:"Last Year"}]}:e}catch(e){throw console.error("Error fetching filter options:",e),e}},async getWinRateData(e={}){try{const t=new URLSearchParams;e.dateRange&&t.append("date_range",e.dateRange),e.ownerId&&t.append("owner_id",e.ownerId);const r=t.toString(),n=`/api/v1/deals/analytics/winrate${r?`?${r}`:""}`,{data:a,error:i}=await be.get(n);if(i){const s=await this.getUserDeals();return["Q1","Q2","Q3","Q4"].map(c=>{const u=s.filter(m=>m.stage==="closed_won").length,d=s.filter(m=>m.stage==="closed_lost").length,f=u+d,h=f>0?Math.round(u/f*100):0;return{period:c,winRate:h+Math.floor(Math.random()*20)-10}})}return a}catch(t){throw console.error("Error fetching win rate data:",t),t}},async exportDeals(e={}){try{const t=new URLSearchParams;e.dateRange&&t.append("date_range",e.dateRange),e.probabilityRange&&t.append("probability_range",e.probabilityRange),e.ownerId&&t.append("owner_id",e.ownerId),e.stage&&t.append("stage",e.stage);const r=t.toString(),n=r?`/api/v1/deals/export?${r}`:"/api/v1/deals/export",{data:a,error:i}=await be.get(n);if(i)throw i;return a||[]}catch(t){throw console.error("Error exporting deals:",t),t}}},ei={async getUserActivities(e=50){const{data:t,error:r}=await be.get(`/api/v1/activities?limit=${e}`);if(r)throw r;return t||[]},async getRecentActivity(e=10){return this.getUserActivities(e)},async getDealActivities(e){const{data:t,error:r}=await be.get(`/api/v1/deals/${e}/activities`);if(r)throw r;return t||[]},async getContactActivities(e){const{data:t,error:r}=await be.get(`/api/v1/contacts/${e}/activities`);if(r)throw r;return t||[]},async getActivityById(e){const{data:t,error:r}=await be.get(`/api/v1/activities/${e}`);if(r)throw r;return t},async createActivity(e){const t={type:e.type,subject:e.subject,description:e.description||null,duration_minutes:e.duration_minutes||null,outcome:e.outcome||null,contact_id:e.contact_id||null,deal_id:e.deal_id||null,custom_fields:e.custom_fields||void 0},{data:r,error:n}=await be.post("/api/v1/activities",t);if(n)throw n;return r},async updateActivity(e,t){const r={type:t.type,subject:t.subject,description:t.description||null,duration_minutes:t.duration_minutes||null,outcome:t.outcome||null,contact_id:t.contact_id||null,deal_id:t.deal_id||null,custom_fields:t.custom_fields||void 0},{data:n,error:a}=await be.put(`/api/v1/activities/${e}`,r);if(a)throw a;return n},async deleteActivity(e){const{data:t,error:r}=await be.delete(`/api/v1/activities/${e}`);if(r)throw r;return!0},async deleteActivities(e){try{return await Promise.all(e.map(t=>this.deleteActivity(t))),!0}catch(t){throw t}},async searchActivities(e,t={}){const r=new URLSearchParams;e&&r.append("search",e),t.type&&t.type.length>0&&r.append("type",t.type.join(",")),t.dateRange&&(r.append("date_start",t.dateRange.start),r.append("date_end",t.dateRange.end));const n=r.toString(),a=n?`/api/v1/activities?${n}`:"/api/v1/activities",{data:i,error:s}=await be.get(a);if(s)throw s;return i||[]},async getActivityStats(){const{data:e,error:t}=await be.get("/api/v1/activities/stats");if(t){const r=await this.getUserActivities();return{total:r.length||0,calls:r.filter(a=>a.type==="call").length||0,emails:r.filter(a=>a.type==="email").length||0,meetings:r.filter(a=>a.type==="meeting").length||0,notes:r.filter(a=>a.type==="note").length||0,tasks:r.filter(a=>a.type==="task").length||0}}return e},async filterActivities(e){const t=new URLSearchParams;e.type&&e.type.length>0&&t.append("type",e.type.join(",")),e.contact&&e.contact.length>0&&t.append("contact",e.contact.join(",")),e.deal&&e.deal.length>0&&t.append("deal",e.deal.join(",")),e.dateRange&&(t.append("date_start",e.dateRange.start),t.append("date_end",e.dateRange.end));const r=t.toString(),n=r?`/api/v1/activities?${r}`:"/api/v1/activities",{data:a,error:i}=await be.get(n);if(i)throw i;return a||[]},subscribeToActivities(e){return{unsubscribe:()=>{}}},async logCall(e){return await this.createActivity({type:"call",subject:e.subject||"Phone Call",description:e.description,duration_minutes:e.duration_minutes,outcome:e.outcome,contact_id:e.contact_id,deal_id:e.deal_id})},async logEmail(e){return await this.createActivity({type:"email",subject:e.subject||"Email",description:e.description,contact_id:e.contact_id,deal_id:e.deal_id})},async logMeeting(e){return await this.createActivity({type:"meeting",subject:e.subject||"Meeting",description:e.description,duration_minutes:e.duration_minutes,outcome:e.outcome,contact_id:e.contact_id,deal_id:e.deal_id})},async addNote(e){return await this.createActivity({type:"note",subject:e.subject||"Note",description:e.description,contact_id:e.contact_id,deal_id:e.deal_id})},async completeTask(e){return await this.updateActivity(e,{outcome:"completed"})},async getCalendarActivities(e,t,r=!0){const n=new URLSearchParams({start_date:e,end_date:t,include_outlook:r}),{data:a,error:i}=await be.get(`/api/v1/activities/calendar?${n.toString()}`);if(i)throw i;return a||[]},async createCalendarActivity(e,t=!1,r=!1){const n={type:e.type,subject:e.subject,description:e.description||null,scheduled_at:e.scheduled_at,end_time:e.end_time,location:e.location||null,meeting_link:e.meeting_link||null,attendees:e.attendees||[],contact_id:e.contact_id||null,deal_id:e.deal_id||null,duration_minutes:e.duration_minutes||null,outcome:e.outcome||null},a=new URLSearchParams({sync_to_outlook:t,create_teams_meeting:r}),{data:i,error:s}=await be.post(`/api/v1/activities/calendar?${a.toString()}`,n);if(s)throw s;return i},async updateCalendarActivity(e,t,r=!1){const n={type:t.type,subject:t.subject,description:t.description||null,scheduled_at:t.scheduled_at,end_time:t.end_time,location:t.location||null,meeting_link:t.meeting_link||null,attendees:t.attendees||[],contact_id:t.contact_id||null,deal_id:t.deal_id||null,duration_minutes:t.duration_minutes||null,outcome:t.outcome||null},a=new URLSearchParams({sync_to_outlook:r}),{data:i,error:s}=await be.put(`/api/v1/activities/${e}/calendar?${a.toString()}`,n);if(s)throw s;return i},async syncActivityToOutlook(e,t=!1){const r=new URLSearchParams({create_teams_meeting:t}),{data:n,error:a}=await be.post(`/api/v1/calendar-integration/activities/${e}/sync-to-outlook?${r.toString()}`);if(a)throw a;return n}},eCe=()=>{const{user:e}=Vt(),[t,r]=M.useState([]),[n,a]=M.useState(!1),[i,s]=M.useState(""),l=Il();M.useEffect(()=>{e&&c()},[e]);const c=async()=>{try{a(!0),s("");const m=(await(ei==null?void 0:ei.getRecentActivity(10))||[]).map(x=>{var p,g,v,y;return{id:x.id,type:x.type,title:x.subject,contact:x.contact?`${x.contact.first_name} ${x.contact.last_name}`:null,company:((g=(p=x.contact)==null?void 0:p.company)==null?void 0:g.name)||((y=(v=x.deal)==null?void 0:v.company)==null?void 0:y.name)||null,user:x.user?`${x.user.first_name} ${x.user.last_name}`:"System",time:x.created_at}});r(m)}catch(h){console.error("Error loading recent activity:",h),s("Failed to load activity")}finally{a(!1)}},u=h=>{const m={email:"Mail",call:"Phone",meeting:"Calendar",note:"FileText",task:"CheckSquare",demo:"Play",proposal_sent:"Send"};return(m==null?void 0:m[h])||"Activity"},d=h=>{const m={email:"text-blue-600",call:"text-green-600",meeting:"text-purple-600",note:"text-gray-600",task:"text-orange-600",demo:"text-indigo-600",proposal_sent:"text-red-600"};return(m==null?void 0:m[h])||"text-gray-600"},f=h=>{const m=new Date,x=new Date(h),p=Math.floor((m-x)/(1e3*60));if(p<1)return"Just now";if(p<60)return`${p}m ago`;const g=Math.floor(p/60);if(g<24)return`${g}h ago`;const v=Math.floor(g/24);return v<7?`${v}d ago`:x==null?void 0:x.toLocaleDateString()};return e?o.jsxs("div",{className:"card p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Recent Activity"}),o.jsx("button",{onClick:c,className:"text-text-tertiary hover:text-text-secondary",disabled:n,children:o.jsx(Y,{name:"RefreshCw",size:16,className:n?"animate-spin":""})})]}),i&&o.jsx("div",{className:"bg-error-50 text-error text-sm p-3 rounded-lg mb-4",children:i}),n?o.jsx("div",{className:"space-y-3",children:[...Array(5)].map((h,m)=>o.jsxs("div",{className:"flex items-center space-x-3 animate-pulse",children:[o.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"h-3 bg-gray-200 rounded w-3/4 mb-1"}),o.jsx("div",{className:"h-2 bg-gray-200 rounded w-1/2"})]})]},m))}):(t==null?void 0:t.length)===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Y,{name:"Activity",size:32,className:"text-text-tertiary mx-auto mb-3"}),o.jsx("p",{className:"text-text-secondary text-sm",children:"No recent activity"})]}):o.jsxs("div",{className:"space-y-4",children:[t==null?void 0:t.map(h=>o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${(h==null?void 0:h.type)==="email"?"bg-blue-100":(h==null?void 0:h.type)==="call"?"bg-green-100":(h==null?void 0:h.type)==="meeting"?"bg-purple-100":(h==null?void 0:h.type)==="note"?"bg-gray-100":"bg-orange-100"}`,children:o.jsx(Y,{name:u(h==null?void 0:h.type),size:16,className:d(h==null?void 0:h.type)})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-sm text-text-primary font-medium truncate",children:h==null?void 0:h.title}),o.jsxs("div",{className:"flex items-center space-x-2 text-xs text-text-secondary mt-1",children:[o.jsx("span",{children:h==null?void 0:h.user}),(h==null?void 0:h.contact)&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{children:h==null?void 0:h.contact})]}),(h==null?void 0:h.company)&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{children:h==null?void 0:h.company})]})]}),o.jsx("p",{className:"text-xs text-text-tertiary mt-1",children:f(h==null?void 0:h.time)})]})]},h==null?void 0:h.id)),o.jsx("div",{className:"pt-3 border-t border-border",children:o.jsx("button",{onClick:()=>l("/activity-timeline"),className:"text-sm text-primary hover:text-primary-600 font-medium",children:"View all activity "})})]})]}):o.jsxs("div",{className:"card p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Recent Activity"}),o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Y,{name:"Activity",size:32,className:"text-text-tertiary mx-auto mb-3"}),o.jsx("p",{className:"text-text-secondary text-sm",children:"Sign in to view recent activity"})]})]})},tCe={async getUserTasks(e=null,t=null){let r="/api/v1/tasks";const n=new URLSearchParams;e&&n.append("status",e),t&&n.append("priority",t),n.toString()&&(r+=`?${n.toString()}`);const{data:a,error:i}=await be.get(r);if(i)throw i;return a||[]},async getUpcomingTasks(e=7){const t=await this.getUserTasks(),r=new Date,n=new Date;return n.setDate(r.getDate()+e),t.filter(a=>{if(!a.due_date)return!1;const i=new Date(a.due_date);return i>=r&&i<=n&&a.status!=="completed"})},async getOverdueTasks(){const e=await this.getUserTasks(),t=new Date;return e.filter(r=>r.due_date?new Date(r.due_date)<t&&r.status!=="completed":!1)},async getTaskById(e){const{data:t,error:r}=await be.get(`/api/v1/tasks/${e}`);if(r){if(r.status===404)return null;throw r}return t},async createTask(e){const t={title:e.title,description:e.description||null,status:e.status||"pending",priority:e.priority||"medium",due_date:e.due_date||null,contact_id:e.contact_id||null,deal_id:e.deal_id||null,assigned_to:e.assigned_to||null},{data:r,error:n}=await be.post("/api/v1/tasks",t);if(n)throw n;return r},async updateTask(e,t){const{data:r,error:n}=await be.put(`/api/v1/tasks/${e}`,t);if(n)throw n;return r},async deleteTask(e){const{data:t,error:r}=await be.delete(`/api/v1/tasks/${e}`);if(r)throw r;return!0},async getTaskStats(){const{data:e,error:t}=await be.get("/api/v1/tasks/stats/overview");if(t){const r=await this.getUserTasks();return{total:r.length||0,completed:r.filter(a=>a.status==="completed").length||0,pending:r.filter(a=>a.status==="pending").length||0,in_progress:r.filter(a=>a.status==="in_progress").length||0,overdue:r.filter(a=>a.due_date?new Date(a.due_date)<new Date&&a.status!=="completed":!1).length||0,high_priority:r.filter(a=>a.priority==="high").length||0}}return e},async filterTasks(e){const t=new URLSearchParams;e.status&&e.status.length>0&&t.append("status",e.status.join(",")),e.priority&&e.priority.length>0&&t.append("priority",e.priority.join(",")),e.assigned_to&&e.assigned_to.length>0&&t.append("assigned_to",e.assigned_to.join(",")),e.dateRange&&(t.append("date_start",e.dateRange.start),t.append("date_end",e.dateRange.end));const r=t.toString(),n=r?`/tasks?${r}`:"/tasks",{data:a,error:i}=await be.get(n);if(i)throw i;return a||[]},subscribeToTasks(e){return{unsubscribe:()=>{}}},async completeTask(e){return await this.updateTask(e,{status:"completed"})}};function Io({src:e,alt:t="Image Name",className:r="",...n}){return o.jsx("img",{src:e,alt:t,className:r,onError:a=>{a.target.src="/assets/images/no_image.png"},...n})}const rCe=({stage:e,totalValue:t,weightedValue:r})=>{var s;M.useEffect(()=>{Gr.loadConfiguration()},[]);const n=l=>{const c=Gr.getCurrency(),u=new Intl.NumberFormat("en-US",{style:"currency",currency:c,minimumFractionDigits:0,maximumFractionDigits:0});return l>=1e6?u.format(l/1e6).replace(/\.0/,"")+"M":l>=1e3?u.format(l/1e3).replace(/\.0/,"")+"K":u.format(l)},a=l=>{const c={lead:"bg-surface border-border",qualified:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-700/50",proposal:"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-700/50",negotiation:"bg-orange-50 dark:bg-orange-900/20 border-orange-200 dark:border-orange-700/50",closed:"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-700/50"};return(c==null?void 0:c[l])||"bg-surface border-border"},i=l=>{const c={lead:"UserPlus",qualified:"CheckCircle",proposal:"FileText",negotiation:"MessageSquare",closed:"Trophy"};return(c==null?void 0:c[l])||"Circle"};return o.jsxs("div",{className:`rounded-lg border-2 border-dashed p-3 h-full ${a(e==null?void 0:e.id)}`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:i(e==null?void 0:e.id),size:14,className:"text-text-secondary"}),o.jsx("h3",{className:"font-semibold text-sm text-text-primary",children:e==null?void 0:e.title})]}),o.jsx("span",{className:"text-xs font-semibold text-text-secondary bg-surface px-2 py-0.5 rounded-full",children:(s=e==null?void 0:e.deals)==null?void 0:s.length})]}),o.jsxs("div",{className:"mb-3 space-y-1 pb-3 border-b border-border",children:[o.jsxs("div",{className:"flex justify-between text-xs",children:[o.jsx("span",{className:"text-text-secondary",children:"Total:"}),o.jsx("span",{className:"font-semibold text-text-primary",children:n(t)})]}),o.jsxs("div",{className:"flex justify-between text-xs",children:[o.jsx("span",{className:"text-text-secondary",children:"Weighted:"}),o.jsx("span",{className:"font-semibold text-text-primary",children:n(r)})]})]}),o.jsx(TR,{droppableId:e==null?void 0:e.id,children:(l,c)=>{var u,d,f;return o.jsxs("div",{ref:l==null?void 0:l.innerRef,...l==null?void 0:l.droppableProps,className:`max-h-[500px] overflow-y-auto space-y-2 pr-1 pipeline-scroll ${c!=null&&c.isDraggingOver?"bg-primary-50 dark:bg-primary-900/20 rounded":""}`,style:{minHeight:((u=e==null?void 0:e.deals)==null?void 0:u.length)===0?"120px":"200px"},children:[(d=e==null?void 0:e.deals)==null?void 0:d.map((h,m)=>o.jsx(Mee,{draggableId:h==null?void 0:h.id,index:m,children:(x,p)=>o.jsxs("div",{ref:x==null?void 0:x.innerRef,...x==null?void 0:x.draggableProps,...x==null?void 0:x.dragHandleProps,className:`bg-surface rounded-lg p-2.5 border border-border shadow-sm cursor-move transition-all duration-150 hover:shadow-md hover:border-primary ${p!=null&&p.isDragging?"rotate-2 shadow-lg ring-2 ring-primary":""}`,children:[o.jsxs("div",{className:"flex items-start justify-between mb-2",children:[o.jsx("h4",{className:"text-xs font-semibold text-text-primary line-clamp-2 flex-1 pr-1",children:h==null?void 0:h.title}),o.jsx(Y,{name:"GripVertical",size:12,className:"text-text-tertiary flex-shrink-0"})]}),o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("span",{className:"text-sm font-bold text-text-primary",children:n(h==null?void 0:h.value)}),o.jsxs("span",{className:"text-xs px-1.5 py-0.5 bg-primary-50 dark:bg-primary-900/30 text-primary dark:text-primary-400 rounded-full font-medium",children:[h==null?void 0:h.probability,"%"]})]}),o.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[o.jsx(Io,{src:h==null?void 0:h.avatar,alt:h==null?void 0:h.contact,className:"w-5 h-5 rounded-full object-cover flex-shrink-0"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-xs font-medium text-text-primary truncate",children:h==null?void 0:h.contact}),o.jsx("p",{className:"text-xs text-text-secondary truncate",children:h==null?void 0:h.company})]})]}),o.jsxs("div",{className:"flex items-center justify-between text-xs text-text-tertiary pt-2 border-t border-border",children:[o.jsxs("span",{className:"truncate",children:[h==null?void 0:h.daysInStage,"d"]}),o.jsx("span",{className:"truncate",children:h==null?void 0:h.lastActivity})]})]})},h==null?void 0:h.id)),l==null?void 0:l.placeholder,((f=e==null?void 0:e.deals)==null?void 0:f.length)===0&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-6 text-text-tertiary",children:[o.jsx(Y,{name:"Plus",size:20,className:"mb-1"}),o.jsx("span",{className:"text-xs",children:"Drop deals here"})]})]})}})]})},nCe=({data:e,revenueData:t=[]})=>{M.useEffect(()=>{Gr.loadConfiguration()},[]);const r=l=>{const c=Gr.getCurrency(),u=new Intl.NumberFormat("en-US",{style:"currency",currency:c,minimumFractionDigits:1,maximumFractionDigits:1});return l>=1e6?u.format(l/1e6).replace(/\.0/,"")+"M":l>=1e3?u.format(l/1e3).replace(/\.0/,"")+"K":u.format(l)},n=[{name:"Achieved",value:e==null?void 0:e.achieved,color:"#10B981"},{name:"Remaining",value:(e==null?void 0:e.quota)-(e==null?void 0:e.achieved),color:"#E5E7EB"}],a=[{name:"Won",value:e==null?void 0:e.dealsWon,color:"#10B981"},{name:"Lost",value:e==null?void 0:e.dealsLost,color:"#EF4444"}];t.length>0&&t.map(l=>({month:l.month,target:l.target,actual:l.actual}));const i=Math.PI/180,s=({cx:l,cy:c,midAngle:u,innerRadius:d,outerRadius:f,percent:h})=>{const m=d+(f-d)*.5,x=l+m*Math.cos(-u*i),p=c+m*Math.sin(-u*i);return o.jsx("text",{x,y:p,fill:"white",textAnchor:x>l?"start":"end",dominantBaseline:"central",fontSize:"12",fontWeight:"600",children:`${(h*100).toFixed(0)}%`})};return o.jsxs("div",{className:"card p-6",children:[o.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-6",children:"Performance Metrics"}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-medium text-text-primary mb-4",children:"Quota Achievement"}),o.jsxs("div",{className:"flex items-center space-x-6",children:[o.jsx("div",{className:"w-32 h-32",children:o.jsx(pa,{width:"100%",height:"100%",children:o.jsx(rv,{children:o.jsx(Bi,{data:n,cx:"50%",cy:"50%",labelLine:!1,label:s,outerRadius:60,fill:"#8884d8",dataKey:"value",strokeWidth:0,children:n==null?void 0:n.map((l,c)=>o.jsx(Ao,{fill:l==null?void 0:l.color},`cell-${c}`))})})})}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Quota"}),o.jsx("p",{className:"text-lg font-semibold text-text-primary",children:r(e==null?void 0:e.quota)})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Achieved"}),o.jsx("p",{className:"text-lg font-semibold text-success",children:r(e==null?void 0:e.achieved)})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Remaining"}),o.jsx("p",{className:"text-lg font-semibold text-text-primary",children:r((e==null?void 0:e.quota)-(e==null?void 0:e.achieved))})]})]})]})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-medium text-text-primary mb-4",children:"Deal Outcomes"}),o.jsxs("div",{className:"flex items-center space-x-6",children:[o.jsx("div",{className:"w-32 h-32",children:o.jsx(pa,{width:"100%",height:"100%",children:o.jsx(rv,{children:o.jsx(Bi,{data:a,cx:"50%",cy:"50%",labelLine:!1,label:s,outerRadius:60,fill:"#8884d8",dataKey:"value",strokeWidth:0,children:a==null?void 0:a.map((l,c)=>o.jsx(Ao,{fill:l==null?void 0:l.color},`cell-${c}`))})})})}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Deals Won"}),o.jsx("p",{className:"text-lg font-semibold text-success",children:e==null?void 0:e.dealsWon})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Deals Lost"}),o.jsx("p",{className:"text-lg font-semibold text-error",children:e==null?void 0:e.dealsLost})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Win Rate"}),o.jsxs("p",{className:"text-lg font-semibold text-text-primary",children:[((e==null?void 0:e.dealsWon)/((e==null?void 0:e.dealsWon)+(e==null?void 0:e.dealsLost))*100).toFixed(1),"%"]})]})]})]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mt-8 pt-6 border-t border-border",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"w-12 h-12 bg-primary-50 rounded-lg flex items-center justify-center mx-auto mb-2",children:o.jsx(Y,{name:"DollarSign",size:20,className:"text-primary"})}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Avg Deal Size"}),o.jsx("p",{className:"text-lg font-semibold text-text-primary",children:r(e==null?void 0:e.avgDealSize)})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"w-12 h-12 bg-success-50 rounded-lg flex items-center justify-center mx-auto mb-2",children:o.jsx(Y,{name:"TrendingUp",size:20,className:"text-success"})}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Conversion Rate"}),o.jsxs("p",{className:"text-lg font-semibold text-text-primary",children:[e==null?void 0:e.conversionRate,"%"]})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"w-12 h-12 bg-accent-50 rounded-lg flex items-center justify-center mx-auto mb-2",children:o.jsx(Y,{name:"Clock",size:20,className:"text-accent"})}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Avg Sales Cycle"}),o.jsx("p",{className:"text-lg font-semibold text-text-primary",children:"45 days"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"w-12 h-12 bg-secondary-50 rounded-lg flex items-center justify-center mx-auto mb-2",children:o.jsx(Y,{name:"Target",size:20,className:"text-secondary"})}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Activities"}),o.jsx("p",{className:"text-lg font-semibold text-text-primary",children:"127"})]})]})]})},aCe=()=>{var V,W,B,P;const{user:e,loading:t}=Vt(),[r,n]=M.useState("all"),[a,i]=M.useState("all"),[s,l]=M.useState("all"),[c,u]=M.useState(new Date),[d,f]=M.useState({}),[h,m]=M.useState([]),[x,p]=M.useState({}),[g,v]=M.useState(!0),[y,b]=M.useState(!1),[w,_]=M.useState("");M.useEffect(()=>{Gr.loadConfiguration()},[]);const D=F=>{try{return Gr.formatCurrency(F)}catch{return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(F)}},j=F=>{try{const I=Gr.getCurrency(),R=new Intl.NumberFormat("en-US",{style:"currency",currency:I,minimumFractionDigits:1,maximumFractionDigits:1});return F>=1e6?R.format(F/1e6).replace(/\.0/,"")+"M":F>=1e3?R.format(F/1e3).replace(/\.0/,"")+"K":R.format(F)}catch{const R=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:1,maximumFractionDigits:1});return F>=1e6?R.format(F/1e6).replace(/\.0/,"")+"M":F>=1e3?R.format(F/1e3).replace(/\.0/,"")+"K":R.format(F)}},N=async(F=!1)=>{if(e)try{F?b(!0):v(!0),_("");const I={dateRange:r!=="all"?r:null,probabilityRange:a!=="all"?a:null,ownerId:s!=="all"?s:null},[R,C,k]=await Promise.all([gt==null?void 0:gt.getPipelineDeals(I),gt==null?void 0:gt.getRevenueData(),gt==null?void 0:gt.getPerformanceMetrics()]);f(R||{}),m(C||[]),p(k||{}),u(new Date)}catch(I){console.error("Error loading dashboard data:",I),_("Failed to load dashboard data. Please try again.")}finally{v(!1),b(!1)}};M.useEffect(()=>{e&&N()},[e]),M.useEffect(()=>{e&&N(!0)},[r,a,s]),M.useEffect(()=>{const F=setInterval(()=>{e&&N()},3e5);return()=>clearInterval(F)},[e]);const S=async F=>{var k,z;const{destination:I,source:R,draggableId:C}=F;if(I&&!((I==null?void 0:I.droppableId)===(R==null?void 0:R.droppableId)&&(I==null?void 0:I.index)===(R==null?void 0:R.index)))try{await(gt==null?void 0:gt.updateDealStage(C,I==null?void 0:I.droppableId));const q=d==null?void 0:d[R==null?void 0:R.droppableId],K=d==null?void 0:d[I==null?void 0:I.droppableId],se=(k=q==null?void 0:q.deals)==null?void 0:k.find(ie=>(ie==null?void 0:ie.id)===C);if(se){const ie={lead:10,qualified:25,proposal:50,negotiation:75,closed_won:100,closed_lost:0},ee={...se,probability:(ie==null?void 0:ie[I==null?void 0:I.droppableId])||(se==null?void 0:se.probability),daysInStage:0},ae=(z=q==null?void 0:q.deals)==null?void 0:z.filter(H=>(H==null?void 0:H.id)!==C),pe=[...(K==null?void 0:K.deals)||[]];pe==null||pe.splice(I==null?void 0:I.index,0,ee),f({...d,[R==null?void 0:R.droppableId]:{...q,deals:ae},[I==null?void 0:I.droppableId]:{...K,deals:pe}})}}catch(q){console.error("Error updating deal stage:",q),_("Failed to update deal stage. Please try again.")}},E=F=>{var I;return((I=F==null?void 0:F.deals)==null?void 0:I.reduce((R,C)=>{const k=typeof(C==null?void 0:C.value)=="string"?parseFloat(C.value):(C==null?void 0:C.value)||0;return R+(isNaN(k)?0:k)},0))||0},A=F=>{var I;return((I=F==null?void 0:F.deals)==null?void 0:I.reduce((R,C)=>R+((C==null?void 0:C.value)||0)*((C==null?void 0:C.probability)||0)/100,0))||0},T=(V=Object.values(d))==null?void 0:V.reduce((F,I)=>F+E(I),0),L=(W=Object.values(d))==null?void 0:W.reduce((F,I)=>F+A(I),0),O=(B=Object.values(d))==null?void 0:B.reduce((F,I)=>{var R;return F+(((R=I==null?void 0:I.deals)==null?void 0:R.length)||0)},0);return t?o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),o.jsx("span",{className:"text-text-secondary",children:"Loading dashboard..."})]})}):e?o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(ii,{}),o.jsx("main",{className:"pt-14 xs:pt-16 sm:pt-20 px-3 xs:px-4 sm:px-6 pb-6 xs:pb-8",children:o.jsxs("div",{className:"max-w-7xl mx-auto",children:[o.jsx("div",{className:"hidden sm:block",children:o.jsx(Hs,{})}),o.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-4 xs:mb-6 sm:mb-8",children:o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl xs:text-2xl sm:text-3xl font-bold text-text-primary mb-1 xs:mb-2",children:"Sales Dashboard"}),o.jsxs("p",{className:"text-xs xs:text-sm text-text-secondary",children:[o.jsxs("span",{className:"hidden xs:inline",children:["Last updated: ",c==null?void 0:c.toLocaleTimeString(),"  "]}),"Auto-refresh every 5 min"]})]})}),w&&o.jsxs("div",{className:"bg-error-50 border border-error-200 text-error p-4 rounded-lg mb-6 flex items-center space-x-2",children:[o.jsx(Y,{name:"AlertCircle",size:20}),o.jsx("span",{children:w}),o.jsx("button",{onClick:()=>_(""),className:"ml-auto text-error hover:text-error-600",children:o.jsx(Y,{name:"X",size:16})})]}),g?o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),o.jsx("span",{className:"text-text-secondary",children:"Loading dashboard data..."})]})}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"grid grid-cols-1 xs:grid-cols-2 lg:grid-cols-4 gap-3 xs:gap-4 sm:gap-6 mb-6 xs:mb-8",children:[o.jsx("div",{className:"card p-4 xs:p-5 sm:p-6",children:o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-text-secondary text-xs xs:text-sm font-normal truncate",children:"Total Pipeline"}),o.jsx("p",{className:"text-lg xs:text-xl sm:text-2xl font-normal text-text-primary truncate",children:j(T)})]}),o.jsx("div",{className:"w-10 h-10 xs:w-12 xs:h-12 bg-primary-50 rounded-lg flex items-center justify-center flex-shrink-0",children:o.jsx(Y,{name:"TrendingUp",size:20,className:"xs:w-6 xs:h-6 text-primary"})})]})}),o.jsx("div",{className:"card p-4 xs:p-5 sm:p-6",children:o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-text-secondary text-xs xs:text-sm font-normal truncate",children:"Weighted Pipeline"}),o.jsx("p",{className:"text-lg xs:text-xl sm:text-2xl font-normal text-text-primary truncate",children:j(L)})]}),o.jsx("div",{className:"w-10 h-10 xs:w-12 xs:h-12 bg-success-50 rounded-lg flex items-center justify-center flex-shrink-0",children:o.jsx(Y,{name:"Target",size:20,className:"xs:w-6 xs:h-6 text-success"})})]})}),o.jsx("div",{className:"card p-4 xs:p-5 sm:p-6",children:o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-text-secondary text-xs xs:text-sm font-normal truncate",children:"Active Deals"}),o.jsx("p",{className:"text-lg xs:text-xl sm:text-2xl font-normal text-text-primary",children:O})]}),o.jsx("div",{className:"w-10 h-10 xs:w-12 xs:h-12 bg-secondary-50 rounded-lg flex items-center justify-center flex-shrink-0",children:o.jsx(Y,{name:"Briefcase",size:20,className:"xs:w-6 xs:h-6 text-secondary"})})]})}),o.jsx("div",{className:"card p-4 xs:p-5 sm:p-6",children:o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-text-secondary text-xs xs:text-sm font-normal truncate",children:"Quota Achievement"}),o.jsxs("p",{className:"text-lg xs:text-xl sm:text-2xl font-normal text-text-primary",children:[(x==null?void 0:x.percentage)||0,"%"]})]}),o.jsx("div",{className:"w-10 h-10 xs:w-12 xs:h-12 bg-accent-50 rounded-lg flex items-center justify-center flex-shrink-0",children:o.jsx(Y,{name:"Award",size:20,className:"xs:w-6 xs:h-6 text-accent"})})]})})]}),o.jsxs("div",{className:"space-y-6 xs:space-y-8",children:[o.jsxs("div",{className:"card p-3 xs:p-4 sm:p-6",children:[o.jsxs("div",{className:"flex flex-col xs:flex-row items-start xs:items-center justify-between mb-3 xs:mb-4 gap-2",children:[o.jsx("h2",{className:"text-base xs:text-lg sm:text-xl font-normal text-text-primary",children:"Sales Pipeline"}),o.jsxs("div",{className:"flex items-center space-x-3 xs:space-x-4 w-full xs:w-auto overflow-x-auto",children:[y&&o.jsxs("div",{className:"flex items-center space-x-2 text-xs xs:text-sm text-text-secondary whitespace-nowrap",children:[o.jsx("div",{className:"animate-spin rounded-full h-3 w-3 xs:h-4 xs:w-4 border-b-2 border-primary"}),o.jsx("span",{className:"hidden xs:inline",children:"Applying filters..."})]}),o.jsxs("div",{className:"hidden lg:flex items-center space-x-2 text-sm text-text-secondary whitespace-nowrap",children:[o.jsx(Y,{name:"RefreshCw",size:16}),o.jsx("span",{children:"Drag deals to update stages"})]})]})]}),o.jsx(eee,{onDragEnd:S,children:o.jsx("div",{className:"overflow-x-auto pb-2 -mx-3 px-3 xs:-mx-4 xs:px-4 sm:-mx-6 sm:px-6 pipeline-scroll",children:o.jsx("div",{className:"flex gap-3 xs:gap-4 min-w-max",children:(P=Object.values(d))==null?void 0:P.map(F=>o.jsx("div",{className:"w-72 flex-shrink-0",children:o.jsx(rCe,{stage:F,totalValue:E(F),weightedValue:A(F)})},F==null?void 0:F.id))})})})]}),o.jsxs("div",{className:"card p-6",children:[o.jsx("h2",{className:"text-xl font-normal text-text-primary mb-6",children:"Monthly Revenue Forecast"}),o.jsx("div",{className:"h-80",children:o.jsx(pa,{width:"100%",height:"100%",children:o.jsxs(td,{data:h,children:[o.jsx(rs,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),o.jsx(Ea,{dataKey:"month",stroke:"#6B7280"}),o.jsx(Ta,{stroke:"#6B7280",tickFormatter:F=>{const I=Gr.getCurrency();return`${new Intl.NumberFormat("en-US",{style:"currency",currency:I}).formatToParts(0).find(C=>C.type==="currency").value}${F/1e3}K`}}),o.jsx(Rr,{content:({active:F,payload:I})=>{if(F&&I&&I.length>0){const R=I[0].payload;return o.jsxs("div",{className:"bg-white p-3 border border-border rounded-lg shadow-lg",children:[o.jsx("p",{className:"font-semibold text-text-primary mb-2",children:R.month}),I.map((C,k)=>o.jsx("div",{className:"mb-1",children:o.jsxs("div",{className:"flex items-center justify-between gap-3",children:[o.jsxs("span",{className:"text-sm text-text-secondary",children:[C.name,":"]}),o.jsx("span",{className:"text-sm font-semibold",style:{color:C.color},children:D(C.value)})]})},k)),R.actualDealsCount!==void 0&&o.jsxs("div",{className:"mt-2 pt-2 border-t border-border",children:[o.jsxs("p",{className:"text-xs text-text-tertiary",children:[R.actualDealsCount," ",R.actualDealsCount===1?"deal":"deals"," closed"]}),R.totalDealsCount>0&&o.jsxs("p",{className:"text-xs text-text-tertiary",children:[R.totalDealsCount," total ",R.totalDealsCount===1?"deal":"deals"]})]})]})}return null}}),o.jsx(ai,{dataKey:"forecast",fill:"var(--color-primary)",name:"Forecast"}),o.jsx(ai,{dataKey:"actual",fill:"var(--color-success)",name:"Actual"})]})})})]}),o.jsx(nCe,{data:x,revenueData:h}),o.jsx(eCe,{})]})]})]})})]}):o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(ii,{}),o.jsx("main",{className:"pt-20 px-6 pb-8",children:o.jsxs("div",{className:"max-w-7xl mx-auto",children:[o.jsx("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg mb-6",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:"Info",size:20,className:"text-blue-600"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-blue-800 font-medium",children:"Preview Mode"}),o.jsxs("p",{className:"text-blue-700 text-sm",children:["This is how the sales dashboard looks when authenticated."," ",o.jsx("a",{href:"/login",className:"font-medium underline hover:text-primary-600",children:"Sign in to access real data"})]})]})]})}),o.jsxs("div",{className:"opacity-75",children:[o.jsx("h1",{className:"text-3xl font-bold text-text-primary mb-2",children:"Sales Dashboard"}),o.jsx("p",{className:"text-text-secondary mb-8",children:"Preview of your sales pipeline and performance metrics"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-text-secondary text-sm",children:"Total Pipeline"}),o.jsx("p",{className:"text-2xl font-normal text-text-primary",children:j(21e5)})]}),o.jsx("div",{className:"w-12 h-12 bg-primary-50 rounded-lg flex items-center justify-center",children:o.jsx(Y,{name:"TrendingUp",size:24,className:"text-primary"})})]})}),o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-text-secondary text-sm",children:"Weighted Pipeline"}),o.jsx("p",{className:"text-2xl font-normal text-text-primary",children:j(12e5)})]}),o.jsx("div",{className:"w-12 h-12 bg-success-50 rounded-lg flex items-center justify-center",children:o.jsx(Y,{name:"Target",size:24,className:"text-success"})})]})}),o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-text-secondary text-sm",children:"Active Deals"}),o.jsx("p",{className:"text-2xl font-normal text-text-primary",children:"24"})]}),o.jsx("div",{className:"w-12 h-12 bg-secondary-50 rounded-lg flex items-center justify-center",children:o.jsx(Y,{name:"Briefcase",size:24,className:"text-secondary"})})]})}),o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-text-secondary text-sm",children:"Quota Achievement"}),o.jsx("p",{className:"text-2xl font-normal text-text-primary",children:"74%"})]}),o.jsx("div",{className:"w-12 h-12 bg-accent-50 rounded-lg flex items-center justify-center",children:o.jsx(Y,{name:"Award",size:24,className:"text-accent"})})]})})]}),o.jsxs("div",{className:"card p-6",children:[o.jsx("h2",{className:"text-xl font-normal text-text-primary mb-6",children:"Pipeline Preview"}),o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Y,{name:"BarChart3",size:48,className:"text-text-tertiary mx-auto mb-4"}),o.jsx("p",{className:"text-text-secondary",children:"Sign in to view your interactive sales pipeline"})]})]})]})]})})]})},Im=({currentPage:e,totalPages:t,totalItems:r,itemsPerPage:n,onPageChange:a,showInfo:i=!0})=>{if(t<=1)return null;const s=()=>{const d=[],f=Math.max(1,e-2),h=Math.min(t,e+2);f>1&&(d.push(1),f>2&&d.push("..."));for(let m=f;m<=h;m++)d.push(m);return h<t&&(h<t-1&&d.push("..."),d.push(t)),d},l=(e-1)*n+1,c=Math.min(e*n,r);return o.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 py-4",children:[i&&o.jsxs("div",{className:"text-sm text-text-secondary",children:["Showing ",l," to ",c," of ",r," items"]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:()=>a(e-1),disabled:e===1,className:"p-2 rounded-lg border border-border text-text-secondary hover:text-text-primary hover:bg-surface-hover disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150",title:"Previous page",children:o.jsx(Y,{name:"ChevronLeft",size:16})}),o.jsx("div",{className:"flex items-center gap-1",children:s().map((u,d)=>o.jsx(Q.Fragment,{children:u==="..."?o.jsx("span",{className:"px-3 py-2 text-text-tertiary",children:"..."}):o.jsx("button",{onClick:()=>a(u),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors duration-150 ${u===e?"bg-primary text-white":"text-text-secondary hover:text-text-primary hover:bg-surface-hover"}`,children:u})},d))}),o.jsx("button",{onClick:()=>a(e+1),disabled:e===t,className:"p-2 rounded-lg border border-border text-text-secondary hover:text-text-primary hover:bg-surface-hover disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150",title:"Next page",children:o.jsx(Y,{name:"ChevronRight",size:16})})]})]})},Zt={async getAllCompanies(){try{const{data:e,error:t}=await be.get("/api/v1/companies");if(t)throw t;return e||[]}catch(e){throw console.error("DEBUG: getAllCompanies error:",e),e}},async getCompanyById(e){const{data:t,error:r}=await be.get(`/api/v1/companies/${e}`);if(r){if(r.status===404)return null;throw r}return t},async createCompany(e){const t={name:e.name,industry:e.industry||null,size:e.size||null,website:e.website||null,phone:e.phone||null,email:e.email||null,address:e.address||null,city:e.city||null,state:e.state||null,zip_code:e.zip_code||null,country:e.country||null,description:e.description||null,revenue:e.revenue||null,custom_fields:e.custom_fields||void 0},{data:r,error:n}=await be.post("/api/v1/companies",t);if(n)throw n;return r},async updateCompany(e,t){const r={name:t.name,industry:t.industry||null,size:t.size||null,website:t.website||null,phone:t.phone||null,email:t.email||null,address:t.address||null,city:t.city||null,state:t.state||null,zip_code:t.zip_code||null,country:t.country||null,description:t.description||null,revenue:t.revenue||null,custom_fields:t.custom_fields||void 0},{data:n,error:a}=await be.put(`/api/v1/companies/${e}`,r);if(a)throw a;return n},async deleteCompany(e){const{data:t,error:r}=await be.delete(`/api/v1/companies/${e}`);if(r)throw r;return!0},async searchCompanies(e){const{data:t,error:r}=await be.get(`/api/v1/companies/search?q=${encodeURIComponent(e)}`);if(r)throw r;return t||[]},async getCompaniesByIndustry(e){const{data:t,error:r}=await be.get(`/api/v1/companies?industry=${encodeURIComponent(e)}`);if(r)throw r;return t||[]},async getCompanyStats(){try{const{data:e,error:t}=await be.get("/api/v1/companies/statistics");if(t){const r=await this.getAllCompanies(),n={total:r.length||0,industries:{},sizes:{},recentlyAdded:r.filter(a=>{const i=new Date(a.created_at),s=new Date;return s.setDate(s.getDate()-30),i>s}).length};return r.forEach(a=>{const i=a.industry||"unknown";n.industries[i]=(n.industries[i]||0)+1}),r.forEach(a=>{const i=a.size||"unknown";n.sizes[i]=(n.sizes[i]||0)+1}),n}return e}catch(e){throw console.error("DEBUG: getCompanyStats error:",e),e}},async getCompaniesWithData(){const{data:e,error:t}=await be.get("/api/v1/companies?include=contacts,deals");if(t)throw t;return e||[]},async filterCompanies(e){const t=new URLSearchParams;e.industry&&e.industry.length>0&&t.append("industry",e.industry.join(",")),e.size&&e.size.length>0&&t.append("size",e.size.join(",")),e.location&&e.location.length>0&&t.append("location",e.location.join(",")),e.revenueRange&&(e.revenueRange.min!==void 0&&t.append("min_revenue",e.revenueRange.min),e.revenueRange.max!==void 0&&t.append("max_revenue",e.revenueRange.max)),e.dateRange&&(t.append("date_start",e.dateRange.start),t.append("date_end",e.dateRange.end));const r=t.toString(),n=r?`/api/v1/companies?${r}`:"/api/v1/companies",{data:a,error:i}=await be.get(n);if(i)throw i;return a||[]},async getCompanyWithRelations(e){const{data:t,error:r}=await be.get(`/api/v1/companies/${e}?include=contacts,deals,activities`);if(r){if(r.status===404)return null;throw r}return t},async importCompanies(e){try{return await Promise.all(e.map(r=>this.createCompany(r)))}catch(t){throw t}},subscribeToCompanies(e){return{unsubscribe:()=>{}}}},HS="-",iCe=e=>{const t=oCe(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:s=>{const l=s.split(HS);return l[0]===""&&l.length!==1&&l.shift(),CL(l,t)||sCe(s)},getConflictingClassGroupIds:(s,l)=>{const c=r[s]||[];return l&&n[s]?[...c,...n[s]]:c}}},CL=(e,t)=>{var s;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),a=n?CL(e.slice(1),n):void 0;if(a)return a;if(t.validators.length===0)return;const i=e.join(HS);return(s=t.validators.find(({validator:l})=>l(i)))==null?void 0:s.classGroupId},pF=/^\[(.+)\]$/,sCe=e=>{if(pF.test(e)){const t=pF.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},oCe=e=>{const{theme:t,classGroups:r}=e,n={nextPart:new Map,validators:[]};for(const a in r)oj(r[a],n,a,t);return n},oj=(e,t,r,n)=>{e.forEach(a=>{if(typeof a=="string"){const i=a===""?t:xF(t,a);i.classGroupId=r;return}if(typeof a=="function"){if(lCe(a)){oj(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([i,s])=>{oj(s,xF(t,i),r,n)})})},xF=(e,t)=>{let r=e;return t.split(HS).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},lCe=e=>e.isThemeGetter,cCe=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const a=(i,s)=>{r.set(i,s),t++,t>e&&(t=0,n=r,r=new Map)};return{get(i){let s=r.get(i);if(s!==void 0)return s;if((s=n.get(i))!==void 0)return a(i,s),s},set(i,s){r.has(i)?r.set(i,s):a(i,s)}}},lj="!",cj=":",uCe=cj.length,dCe=e=>{const{prefix:t,experimentalParseClassName:r}=e;let n=a=>{const i=[];let s=0,l=0,c=0,u;for(let x=0;x<a.length;x++){let p=a[x];if(s===0&&l===0){if(p===cj){i.push(a.slice(c,x)),c=x+uCe;continue}if(p==="/"){u=x;continue}}p==="["?s++:p==="]"?s--:p==="("?l++:p===")"&&l--}const d=i.length===0?a:a.substring(c),f=fCe(d),h=f!==d,m=u&&u>c?u-c:void 0;return{modifiers:i,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:m}};if(t){const a=t+cj,i=n;n=s=>s.startsWith(a)?i(s.substring(a.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:s,maybePostfixModifierPosition:void 0}}if(r){const a=n;n=i=>r({className:i,parseClassName:a})}return n},fCe=e=>e.endsWith(lj)?e.substring(0,e.length-1):e.startsWith(lj)?e.substring(1):e,hCe=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(n=>[n,!0]));return n=>{if(n.length<=1)return n;const a=[];let i=[];return n.forEach(s=>{s[0]==="["||t[s]?(a.push(...i.sort(),s),i=[]):i.push(s)}),a.push(...i.sort()),a}},mCe=e=>({cache:cCe(e.cacheSize),parseClassName:dCe(e),sortModifiers:hCe(e),...iCe(e)}),pCe=/\s+/,xCe=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a,sortModifiers:i}=t,s=[],l=e.trim().split(pCe);let c="";for(let u=l.length-1;u>=0;u-=1){const d=l[u],{isExternal:f,modifiers:h,hasImportantModifier:m,baseClassName:x,maybePostfixModifierPosition:p}=r(d);if(f){c=d+(c.length>0?" "+c:c);continue}let g=!!p,v=n(g?x.substring(0,p):x);if(!v){if(!g){c=d+(c.length>0?" "+c:c);continue}if(v=n(x),!v){c=d+(c.length>0?" "+c:c);continue}g=!1}const y=i(h).join(":"),b=m?y+lj:y,w=b+v;if(s.includes(w))continue;s.push(w);const _=a(v,g);for(let D=0;D<_.length;++D){const j=_[D];s.push(b+j)}c=d+(c.length>0?" "+c:c)}return c};function gCe(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=AL(t))&&(n&&(n+=" "),n+=r);return n}const AL=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=AL(e[n]))&&(r&&(r+=" "),r+=t);return r};function vCe(e,...t){let r,n,a,i=s;function s(c){const u=t.reduce((d,f)=>f(d),e());return r=mCe(u),n=r.cache.get,a=r.cache.set,i=l,l(c)}function l(c){const u=n(c);if(u)return u;const d=xCe(c,r);return a(c,d),d}return function(){return i(gCe.apply(null,arguments))}}const nn=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},OL=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,FL=/^\((?:(\w[\w-]*):)?(.+)\)$/i,yCe=/^\d+\/\d+$/,bCe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,wCe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,_Ce=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,DCe=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,jCe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Su=e=>yCe.test(e),Et=e=>!!e&&!Number.isNaN(Number(e)),Zo=e=>!!e&&Number.isInteger(Number(e)),Tw=e=>e.endsWith("%")&&Et(e.slice(0,-1)),ao=e=>bCe.test(e),NCe=()=>!0,SCe=e=>wCe.test(e)&&!_Ce.test(e),PL=()=>!1,ECe=e=>DCe.test(e),TCe=e=>jCe.test(e),kCe=e=>!et(e)&&!tt(e),CCe=e=>Nf(e,ML,PL),et=e=>OL.test(e),oc=e=>Nf(e,UL,SCe),kw=e=>Nf(e,ICe,Et),gF=e=>Nf(e,IL,PL),ACe=e=>Nf(e,RL,TCe),Zx=e=>Nf(e,$L,ECe),tt=e=>FL.test(e),sh=e=>Sf(e,UL),OCe=e=>Sf(e,RCe),vF=e=>Sf(e,IL),FCe=e=>Sf(e,ML),PCe=e=>Sf(e,RL),Jx=e=>Sf(e,$L,!0),Nf=(e,t,r)=>{const n=OL.exec(e);return n?n[1]?t(n[1]):r(n[2]):!1},Sf=(e,t,r=!1)=>{const n=FL.exec(e);return n?n[1]?t(n[1]):r:!1},IL=e=>e==="position"||e==="percentage",RL=e=>e==="image"||e==="url",ML=e=>e==="length"||e==="size"||e==="bg-size",UL=e=>e==="length",ICe=e=>e==="number",RCe=e=>e==="family-name",$L=e=>e==="shadow",MCe=()=>{const e=nn("color"),t=nn("font"),r=nn("text"),n=nn("font-weight"),a=nn("tracking"),i=nn("leading"),s=nn("breakpoint"),l=nn("container"),c=nn("spacing"),u=nn("radius"),d=nn("shadow"),f=nn("inset-shadow"),h=nn("text-shadow"),m=nn("drop-shadow"),x=nn("blur"),p=nn("perspective"),g=nn("aspect"),v=nn("ease"),y=nn("animate"),b=()=>["auto","avoid","all","avoid-page","page","left","right","column"],w=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],_=()=>[...w(),tt,et],D=()=>["auto","hidden","clip","visible","scroll"],j=()=>["auto","contain","none"],N=()=>[tt,et,c],S=()=>[Su,"full","auto",...N()],E=()=>[Zo,"none","subgrid",tt,et],A=()=>["auto",{span:["full",Zo,tt,et]},Zo,tt,et],T=()=>[Zo,"auto",tt,et],L=()=>["auto","min","max","fr",tt,et],O=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],V=()=>["start","end","center","stretch","center-safe","end-safe"],W=()=>["auto",...N()],B=()=>[Su,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...N()],P=()=>[e,tt,et],F=()=>[...w(),vF,gF,{position:[tt,et]}],I=()=>["no-repeat",{repeat:["","x","y","space","round"]}],R=()=>["auto","cover","contain",FCe,CCe,{size:[tt,et]}],C=()=>[Tw,sh,oc],k=()=>["","none","full",u,tt,et],z=()=>["",Et,sh,oc],q=()=>["solid","dashed","dotted","double"],K=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],se=()=>[Et,Tw,vF,gF],ie=()=>["","none",x,tt,et],ee=()=>["none",Et,tt,et],ae=()=>["none",Et,tt,et],pe=()=>[Et,tt,et],H=()=>[Su,"full",...N()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[ao],breakpoint:[ao],color:[NCe],container:[ao],"drop-shadow":[ao],ease:["in","out","in-out"],font:[kCe],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[ao],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[ao],shadow:[ao],spacing:["px",Et],text:[ao],"text-shadow":[ao],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Su,et,tt,g]}],container:["container"],columns:[{columns:[Et,et,tt,l]}],"break-after":[{"break-after":b()}],"break-before":[{"break-before":b()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:_()}],overflow:[{overflow:D()}],"overflow-x":[{"overflow-x":D()}],"overflow-y":[{"overflow-y":D()}],overscroll:[{overscroll:j()}],"overscroll-x":[{"overscroll-x":j()}],"overscroll-y":[{"overscroll-y":j()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:S()}],"inset-x":[{"inset-x":S()}],"inset-y":[{"inset-y":S()}],start:[{start:S()}],end:[{end:S()}],top:[{top:S()}],right:[{right:S()}],bottom:[{bottom:S()}],left:[{left:S()}],visibility:["visible","invisible","collapse"],z:[{z:[Zo,"auto",tt,et]}],basis:[{basis:[Su,"full","auto",l,...N()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Et,Su,"auto","initial","none",et]}],grow:[{grow:["",Et,tt,et]}],shrink:[{shrink:["",Et,tt,et]}],order:[{order:[Zo,"first","last","none",tt,et]}],"grid-cols":[{"grid-cols":E()}],"col-start-end":[{col:A()}],"col-start":[{"col-start":T()}],"col-end":[{"col-end":T()}],"grid-rows":[{"grid-rows":E()}],"row-start-end":[{row:A()}],"row-start":[{"row-start":T()}],"row-end":[{"row-end":T()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":L()}],"auto-rows":[{"auto-rows":L()}],gap:[{gap:N()}],"gap-x":[{"gap-x":N()}],"gap-y":[{"gap-y":N()}],"justify-content":[{justify:[...O(),"normal"]}],"justify-items":[{"justify-items":[...V(),"normal"]}],"justify-self":[{"justify-self":["auto",...V()]}],"align-content":[{content:["normal",...O()]}],"align-items":[{items:[...V(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...V(),{baseline:["","last"]}]}],"place-content":[{"place-content":O()}],"place-items":[{"place-items":[...V(),"baseline"]}],"place-self":[{"place-self":["auto",...V()]}],p:[{p:N()}],px:[{px:N()}],py:[{py:N()}],ps:[{ps:N()}],pe:[{pe:N()}],pt:[{pt:N()}],pr:[{pr:N()}],pb:[{pb:N()}],pl:[{pl:N()}],m:[{m:W()}],mx:[{mx:W()}],my:[{my:W()}],ms:[{ms:W()}],me:[{me:W()}],mt:[{mt:W()}],mr:[{mr:W()}],mb:[{mb:W()}],ml:[{ml:W()}],"space-x":[{"space-x":N()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":N()}],"space-y-reverse":["space-y-reverse"],size:[{size:B()}],w:[{w:[l,"screen",...B()]}],"min-w":[{"min-w":[l,"screen","none",...B()]}],"max-w":[{"max-w":[l,"screen","none","prose",{screen:[s]},...B()]}],h:[{h:["screen","lh",...B()]}],"min-h":[{"min-h":["screen","lh","none",...B()]}],"max-h":[{"max-h":["screen","lh",...B()]}],"font-size":[{text:["base",r,sh,oc]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,tt,kw]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Tw,et]}],"font-family":[{font:[OCe,et,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[a,tt,et]}],"line-clamp":[{"line-clamp":[Et,"none",tt,kw]}],leading:[{leading:[i,...N()]}],"list-image":[{"list-image":["none",tt,et]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",tt,et]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:P()}],"text-color":[{text:P()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...q(),"wavy"]}],"text-decoration-thickness":[{decoration:[Et,"from-font","auto",tt,oc]}],"text-decoration-color":[{decoration:P()}],"underline-offset":[{"underline-offset":[Et,"auto",tt,et]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:N()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",tt,et]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",tt,et]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:F()}],"bg-repeat":[{bg:I()}],"bg-size":[{bg:R()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Zo,tt,et],radial:["",tt,et],conic:[Zo,tt,et]},PCe,ACe]}],"bg-color":[{bg:P()}],"gradient-from-pos":[{from:C()}],"gradient-via-pos":[{via:C()}],"gradient-to-pos":[{to:C()}],"gradient-from":[{from:P()}],"gradient-via":[{via:P()}],"gradient-to":[{to:P()}],rounded:[{rounded:k()}],"rounded-s":[{"rounded-s":k()}],"rounded-e":[{"rounded-e":k()}],"rounded-t":[{"rounded-t":k()}],"rounded-r":[{"rounded-r":k()}],"rounded-b":[{"rounded-b":k()}],"rounded-l":[{"rounded-l":k()}],"rounded-ss":[{"rounded-ss":k()}],"rounded-se":[{"rounded-se":k()}],"rounded-ee":[{"rounded-ee":k()}],"rounded-es":[{"rounded-es":k()}],"rounded-tl":[{"rounded-tl":k()}],"rounded-tr":[{"rounded-tr":k()}],"rounded-br":[{"rounded-br":k()}],"rounded-bl":[{"rounded-bl":k()}],"border-w":[{border:z()}],"border-w-x":[{"border-x":z()}],"border-w-y":[{"border-y":z()}],"border-w-s":[{"border-s":z()}],"border-w-e":[{"border-e":z()}],"border-w-t":[{"border-t":z()}],"border-w-r":[{"border-r":z()}],"border-w-b":[{"border-b":z()}],"border-w-l":[{"border-l":z()}],"divide-x":[{"divide-x":z()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":z()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...q(),"hidden","none"]}],"divide-style":[{divide:[...q(),"hidden","none"]}],"border-color":[{border:P()}],"border-color-x":[{"border-x":P()}],"border-color-y":[{"border-y":P()}],"border-color-s":[{"border-s":P()}],"border-color-e":[{"border-e":P()}],"border-color-t":[{"border-t":P()}],"border-color-r":[{"border-r":P()}],"border-color-b":[{"border-b":P()}],"border-color-l":[{"border-l":P()}],"divide-color":[{divide:P()}],"outline-style":[{outline:[...q(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Et,tt,et]}],"outline-w":[{outline:["",Et,sh,oc]}],"outline-color":[{outline:P()}],shadow:[{shadow:["","none",d,Jx,Zx]}],"shadow-color":[{shadow:P()}],"inset-shadow":[{"inset-shadow":["none",f,Jx,Zx]}],"inset-shadow-color":[{"inset-shadow":P()}],"ring-w":[{ring:z()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:P()}],"ring-offset-w":[{"ring-offset":[Et,oc]}],"ring-offset-color":[{"ring-offset":P()}],"inset-ring-w":[{"inset-ring":z()}],"inset-ring-color":[{"inset-ring":P()}],"text-shadow":[{"text-shadow":["none",h,Jx,Zx]}],"text-shadow-color":[{"text-shadow":P()}],opacity:[{opacity:[Et,tt,et]}],"mix-blend":[{"mix-blend":[...K(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":K()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Et]}],"mask-image-linear-from-pos":[{"mask-linear-from":se()}],"mask-image-linear-to-pos":[{"mask-linear-to":se()}],"mask-image-linear-from-color":[{"mask-linear-from":P()}],"mask-image-linear-to-color":[{"mask-linear-to":P()}],"mask-image-t-from-pos":[{"mask-t-from":se()}],"mask-image-t-to-pos":[{"mask-t-to":se()}],"mask-image-t-from-color":[{"mask-t-from":P()}],"mask-image-t-to-color":[{"mask-t-to":P()}],"mask-image-r-from-pos":[{"mask-r-from":se()}],"mask-image-r-to-pos":[{"mask-r-to":se()}],"mask-image-r-from-color":[{"mask-r-from":P()}],"mask-image-r-to-color":[{"mask-r-to":P()}],"mask-image-b-from-pos":[{"mask-b-from":se()}],"mask-image-b-to-pos":[{"mask-b-to":se()}],"mask-image-b-from-color":[{"mask-b-from":P()}],"mask-image-b-to-color":[{"mask-b-to":P()}],"mask-image-l-from-pos":[{"mask-l-from":se()}],"mask-image-l-to-pos":[{"mask-l-to":se()}],"mask-image-l-from-color":[{"mask-l-from":P()}],"mask-image-l-to-color":[{"mask-l-to":P()}],"mask-image-x-from-pos":[{"mask-x-from":se()}],"mask-image-x-to-pos":[{"mask-x-to":se()}],"mask-image-x-from-color":[{"mask-x-from":P()}],"mask-image-x-to-color":[{"mask-x-to":P()}],"mask-image-y-from-pos":[{"mask-y-from":se()}],"mask-image-y-to-pos":[{"mask-y-to":se()}],"mask-image-y-from-color":[{"mask-y-from":P()}],"mask-image-y-to-color":[{"mask-y-to":P()}],"mask-image-radial":[{"mask-radial":[tt,et]}],"mask-image-radial-from-pos":[{"mask-radial-from":se()}],"mask-image-radial-to-pos":[{"mask-radial-to":se()}],"mask-image-radial-from-color":[{"mask-radial-from":P()}],"mask-image-radial-to-color":[{"mask-radial-to":P()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":w()}],"mask-image-conic-pos":[{"mask-conic":[Et]}],"mask-image-conic-from-pos":[{"mask-conic-from":se()}],"mask-image-conic-to-pos":[{"mask-conic-to":se()}],"mask-image-conic-from-color":[{"mask-conic-from":P()}],"mask-image-conic-to-color":[{"mask-conic-to":P()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:F()}],"mask-repeat":[{mask:I()}],"mask-size":[{mask:R()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",tt,et]}],filter:[{filter:["","none",tt,et]}],blur:[{blur:ie()}],brightness:[{brightness:[Et,tt,et]}],contrast:[{contrast:[Et,tt,et]}],"drop-shadow":[{"drop-shadow":["","none",m,Jx,Zx]}],"drop-shadow-color":[{"drop-shadow":P()}],grayscale:[{grayscale:["",Et,tt,et]}],"hue-rotate":[{"hue-rotate":[Et,tt,et]}],invert:[{invert:["",Et,tt,et]}],saturate:[{saturate:[Et,tt,et]}],sepia:[{sepia:["",Et,tt,et]}],"backdrop-filter":[{"backdrop-filter":["","none",tt,et]}],"backdrop-blur":[{"backdrop-blur":ie()}],"backdrop-brightness":[{"backdrop-brightness":[Et,tt,et]}],"backdrop-contrast":[{"backdrop-contrast":[Et,tt,et]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Et,tt,et]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Et,tt,et]}],"backdrop-invert":[{"backdrop-invert":["",Et,tt,et]}],"backdrop-opacity":[{"backdrop-opacity":[Et,tt,et]}],"backdrop-saturate":[{"backdrop-saturate":[Et,tt,et]}],"backdrop-sepia":[{"backdrop-sepia":["",Et,tt,et]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":N()}],"border-spacing-x":[{"border-spacing-x":N()}],"border-spacing-y":[{"border-spacing-y":N()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",tt,et]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Et,"initial",tt,et]}],ease:[{ease:["linear","initial",v,tt,et]}],delay:[{delay:[Et,tt,et]}],animate:[{animate:["none",y,tt,et]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[p,tt,et]}],"perspective-origin":[{"perspective-origin":_()}],rotate:[{rotate:ee()}],"rotate-x":[{"rotate-x":ee()}],"rotate-y":[{"rotate-y":ee()}],"rotate-z":[{"rotate-z":ee()}],scale:[{scale:ae()}],"scale-x":[{"scale-x":ae()}],"scale-y":[{"scale-y":ae()}],"scale-z":[{"scale-z":ae()}],"scale-3d":["scale-3d"],skew:[{skew:pe()}],"skew-x":[{"skew-x":pe()}],"skew-y":[{"skew-y":pe()}],transform:[{transform:[tt,et,"","none","gpu","cpu"]}],"transform-origin":[{origin:_()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:H()}],"translate-x":[{"translate-x":H()}],"translate-y":[{"translate-y":H()}],"translate-z":[{"translate-z":H()}],"translate-none":["translate-none"],accent:[{accent:P()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:P()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",tt,et]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":N()}],"scroll-mx":[{"scroll-mx":N()}],"scroll-my":[{"scroll-my":N()}],"scroll-ms":[{"scroll-ms":N()}],"scroll-me":[{"scroll-me":N()}],"scroll-mt":[{"scroll-mt":N()}],"scroll-mr":[{"scroll-mr":N()}],"scroll-mb":[{"scroll-mb":N()}],"scroll-ml":[{"scroll-ml":N()}],"scroll-p":[{"scroll-p":N()}],"scroll-px":[{"scroll-px":N()}],"scroll-py":[{"scroll-py":N()}],"scroll-ps":[{"scroll-ps":N()}],"scroll-pe":[{"scroll-pe":N()}],"scroll-pt":[{"scroll-pt":N()}],"scroll-pr":[{"scroll-pr":N()}],"scroll-pb":[{"scroll-pb":N()}],"scroll-pl":[{"scroll-pl":N()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",tt,et]}],fill:[{fill:["none",...P()]}],"stroke-w":[{stroke:[Et,sh,oc,kw]}],stroke:[{stroke:["none",...P()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},UCe=vCe(MCe);function Ti(...e){return UCe(vt(e))}function yF(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function $Ce(...e){return t=>{let r=!1;const n=e.map(a=>{const i=yF(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():yF(e[a],null)}}}}function LCe(e){const t=WCe(e),r=M.forwardRef((n,a)=>{const{children:i,...s}=n,l=M.Children.toArray(i),c=l.find(HCe);if(c){const u=c.props.children,d=l.map(f=>f===c?M.Children.count(u)>1?M.Children.only(null):M.isValidElement(u)?u.props.children:null:f);return o.jsx(t,{...s,ref:a,children:M.isValidElement(u)?M.cloneElement(u,void 0,d):null})}return o.jsx(t,{...s,ref:a,children:i})});return r.displayName=`${e}.Slot`,r}var BCe=LCe("Slot");function WCe(e){const t=M.forwardRef((r,n)=>{const{children:a,...i}=r;if(M.isValidElement(a)){const s=qCe(a),l=VCe(i,a.props);return a.type!==M.Fragment&&(l.ref=n?$Ce(n,s):s),M.cloneElement(a,l)}return M.Children.count(a)>1?M.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var zCe=Symbol("radix.slottable");function HCe(e){return M.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===zCe}function VCe(e,t){const r={...t};for(const n in t){const a=e[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...l)=>{const c=i(...l);return a(...l),c}:a&&(r[n]=a):n==="style"?r[n]={...a,...i}:n==="className"&&(r[n]=[a,i].filter(Boolean).join(" "))}return{...e,...r}}function qCe(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}const bF=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,wF=vt,GCe=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return wF(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:i}=t,s=Object.keys(a).map(u=>{const d=r==null?void 0:r[u],f=i==null?void 0:i[u];if(d===null)return null;const h=bF(d)||bF(f);return a[u][h]}),l=r&&Object.entries(r).reduce((u,d)=>{let[f,h]=d;return h===void 0||(u[f]=h),u},{}),c=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((u,d)=>{let{class:f,className:h,...m}=d;return Object.entries(m).every(x=>{let[p,g]=x;return Array.isArray(g)?g.includes({...i,...l}[p]):{...i,...l}[p]===g})?[...u,f,h]:u},[]);return wF(e,s,c,r==null?void 0:r.class,r==null?void 0:r.className)},YCe=GCe("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",success:"bg-success text-success-foreground hover:bg-success/90",warning:"bg-warning text-warning-foreground hover:bg-warning/90",danger:"bg-error text-error-foreground hover:bg-error/90"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10",xs:"h-8 rounded-md px-2 text-xs",xl:"h-12 rounded-md px-10 text-base"}},defaultVariants:{variant:"default",size:"default"}}),LL=Q.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,children:a,loading:i=!1,iconName:s=null,iconPosition:l="left",iconSize:c=null,fullWidth:u=!1,disabled:d=!1,...f},h)=>{const m=n?BCe:"button",x={xs:12,sm:14,default:16,lg:18,xl:20,icon:16},p=c||(x==null?void 0:x[r])||16,g=()=>o.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),v=()=>s?o.jsx(Y,{name:s,size:p,className:Ti(a&&l==="left"&&"mr-2",a&&l==="right"&&"ml-2")}):null;return o.jsxs(m,{className:Ti(YCe({variant:t,size:r,className:e}),u&&"w-full"),ref:h,disabled:d||i,...f,children:[i&&o.jsx(g,{}),s&&l==="left"&&v(),a,s&&l==="right"&&v()]})});LL.displayName="Button";const BL=Q.forwardRef(({className:e,type:t="text",label:r,description:n,error:a,required:i=!1,id:s,...l},c)=>{var f,h;const u=s||`input-${(h=(f=Math.random())==null?void 0:f.toString(36))==null?void 0:h.substr(2,9)}`,d="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50";return t==="checkbox"?o.jsx("input",{type:"checkbox",className:Ti("h-4 w-4 rounded border border-input bg-background text-primary focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:c,id:u,...l}):t==="radio"?o.jsx("input",{type:"radio",className:Ti("h-4 w-4 rounded-full border border-input bg-background text-primary focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:c,id:u,...l}):o.jsxs("div",{className:"space-y-2",children:[r&&o.jsxs("label",{htmlFor:u,className:Ti("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",a?"text-destructive":"text-foreground"),children:[r,i&&o.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),o.jsx("input",{type:t,className:Ti(d,a&&"border-destructive focus-visible:ring-destructive",e),ref:c,id:u,...l}),n&&!a&&o.jsx("p",{className:"text-sm text-muted-foreground",children:n}),a&&o.jsx("p",{className:"text-sm text-destructive",children:a})]})});BL.displayName="Input";const WL=Q.forwardRef(({className:e,options:t=[],value:r,defaultValue:n,placeholder:a="Select an option",multiple:i=!1,disabled:s=!1,required:l=!1,label:c,description:u,error:d,searchable:f=!1,clearable:h=!1,loading:m=!1,id:x,name:p,onChange:g,onOpenChange:v,...y},b)=>{var P,F;const[w,_]=M.useState(!1),[D,j]=M.useState(""),N=M.useRef(null),S=x||`select-${(F=(P=Math.random())==null?void 0:P.toString(36))==null?void 0:F.substr(2,9)}`;M.useEffect(()=>{const I=R=>{N.current&&!N.current.contains(R.target)&&(_(!1),v==null||v(!1),j(""))};return w&&document.addEventListener("mousedown",I),()=>{document.removeEventListener("mousedown",I)}},[w,v]);const E=f&&D?t==null?void 0:t.filter(I=>{var R,C,k,z,q;return((C=(R=I==null?void 0:I.label)==null?void 0:R.toLowerCase())==null?void 0:C.includes(D==null?void 0:D.toLowerCase()))||(I==null?void 0:I.value)&&((q=(z=(k=I==null?void 0:I.value)==null?void 0:k.toString())==null?void 0:z.toLowerCase())==null?void 0:q.includes(D==null?void 0:D.toLowerCase()))}):t,A=()=>{var R;if(!r)return a;if(i){const C=t==null?void 0:t.filter(k=>r==null?void 0:r.includes(k==null?void 0:k.value));return(C==null?void 0:C.length)===0?a:(R=C==null?void 0:C.map(k=>k==null?void 0:k.label))==null?void 0:R.join(", ")}const I=t==null?void 0:t.find(C=>(C==null?void 0:C.value)===r);return I?I==null?void 0:I.label:a},T=()=>{if(!s){const I=!w;_(I),v==null||v(I),I||j("")}},L=I=>{if(i){const R=r||[],C=R!=null&&R.includes(I==null?void 0:I.value)?R==null?void 0:R.filter(k=>k!==(I==null?void 0:I.value)):[...R,I==null?void 0:I.value];g==null||g(C)}else g==null||g(I==null?void 0:I.value),_(!1),v==null||v(!1)},O=I=>{I==null||I.stopPropagation(),g==null||g(i?[]:"")},V=I=>{var R;j((R=I==null?void 0:I.target)==null?void 0:R.value)},W=I=>i?(r==null?void 0:r.includes(I))||!1:r===I,B=i?(r==null?void 0:r.length)>0:r!==void 0&&r!=="";return o.jsxs("div",{ref:N,className:Ti("relative",e),children:[c&&o.jsxs("label",{htmlFor:S,className:Ti("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 mb-2 block",d?"text-destructive":"text-foreground"),children:[c,l&&o.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),o.jsxs("div",{className:"relative",children:[o.jsxs("button",{ref:b,id:S,type:"button",className:Ti("flex h-10 w-full items-center justify-between rounded-md border border-input bg-white text-black px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",d&&"border-destructive focus:ring-destructive",!B&&"text-muted-foreground"),onClick:T,disabled:s,"aria-expanded":w,"aria-haspopup":"listbox",...y,children:[o.jsx("span",{className:"truncate",children:A()}),o.jsxs("div",{className:"flex items-center gap-1",children:[m&&o.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),h&&B&&!m&&o.jsx(LL,{variant:"ghost",size:"icon",className:"h-4 w-4",onClick:O,children:o.jsx(_8,{className:"h-3 w-3"})}),o.jsx(xq,{className:Ti("h-4 w-4 transition-transform",w&&"rotate-180")})]})]}),o.jsxs("select",{name:p,value:r||"",onChange:()=>{},className:"sr-only",tabIndex:-1,multiple:i,required:l,children:[o.jsx("option",{value:"",children:"Select..."}),t==null?void 0:t.map(I=>o.jsx("option",{value:I==null?void 0:I.value,children:I==null?void 0:I.label},I==null?void 0:I.value))]}),w&&o.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white text-black border border-gray-200 rounded-md shadow-lg animate-in fade-in-0 zoom-in-95",children:[f&&o.jsx("div",{className:"p-2 border-b border-gray-100",children:o.jsxs("div",{className:"relative",children:[o.jsx(gq,{className:"absolute left-2 top-2.5 h-4 w-4 text-gray-400"}),o.jsx(BL,{placeholder:"Search options...",value:D,onChange:V,className:"pl-8"})]})}),o.jsx("div",{className:"py-1 max-h-60 overflow-auto",children:(E==null?void 0:E.length)===0?o.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:D?"No options found":"No options available"}):E==null?void 0:E.map(I=>o.jsxs("div",{className:Ti("relative flex cursor-pointer select-none items-center rounded-sm px-3 py-2 text-sm outline-none transition-colors",i?"hover:bg-gray-100":W(I==null?void 0:I.value)?"bg-blue-50 text-blue-900":"hover:bg-gray-100",(I==null?void 0:I.disabled)&&"pointer-events-none opacity-50"),onClick:()=>!(I!=null&&I.disabled)&&L(I),children:[i&&o.jsx("div",{className:"flex items-center mr-2",children:o.jsx("div",{className:Ti("w-4 h-4 border-2 rounded flex items-center justify-center transition-colors",W(I==null?void 0:I.value)?"bg-blue-600 border-blue-600":"border-gray-300 bg-white"),children:W(I==null?void 0:I.value)&&o.jsx(qk,{className:"h-3 w-3 text-white",strokeWidth:3})})}),o.jsx("span",{className:"flex-1",children:I==null?void 0:I.label}),!i&&W(I==null?void 0:I.value)&&o.jsx(qk,{className:"h-4 w-4 text-blue-600"}),(I==null?void 0:I.description)&&o.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:I==null?void 0:I.description})]},I==null?void 0:I.value))})]})]}),u&&!d&&o.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:u}),d&&o.jsx("p",{className:"text-sm text-destructive mt-1",children:d})]})});WL.displayName="Select";const XCe=({field:e,value:t,onChange:r,error:n,disabled:a=!1})=>{if(!e||typeof e!="object")return console.error("CustomFieldInput: field prop is required and must be an object",e),null;const{field_type:i="text",name:s="Unnamed Field",placeholder:l="",help_text:c="",is_required:u=!1,field_config:d={},field_key:f=""}=e,h=x=>{f&&r&&r(f,x)},m=()=>{var x,p;switch(i){case"text":return o.jsx("input",{type:"text",value:t||"",onChange:y=>h(y.target.value),placeholder:l,disabled:a,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n?"border-red-500":"border-gray-300"} ${a?"bg-gray-100":""}`,maxLength:d==null?void 0:d.max_length,minLength:d==null?void 0:d.min_length});case"textarea":return o.jsx("textarea",{value:t||"",onChange:y=>h(y.target.value),placeholder:l,disabled:a,rows:3,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n?"border-red-500":"border-gray-300"} ${a?"bg-gray-100":""}`,maxLength:d==null?void 0:d.max_length,minLength:d==null?void 0:d.min_length});case"number":case"currency":case"percentage":return o.jsxs("div",{className:"relative",children:[(d==null?void 0:d.prefix)&&o.jsx("span",{className:"absolute left-3 top-2 text-gray-500",children:d.prefix}),o.jsx("input",{type:"number",value:t||"",onChange:y=>h(y.target.value),placeholder:l,disabled:a,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n?"border-red-500":"border-gray-300"} ${a?"bg-gray-100":""} ${d!=null&&d.prefix?"pl-8":""} ${d!=null&&d.suffix?"pr-8":""}`,min:d==null?void 0:d.min_value,max:d==null?void 0:d.max_value,step:i==="percentage"?"0.01":d!=null&&d.decimal_places?`0.${"0".repeat(d.decimal_places-1)}1`:"0.01"}),(d==null?void 0:d.suffix)&&o.jsx("span",{className:"absolute right-3 top-2 text-gray-500",children:d.suffix})]});case"email":return o.jsxs("div",{className:"relative",children:[o.jsx(bq,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),o.jsx("input",{type:"email",value:t||"",onChange:y=>h(y.target.value),placeholder:l||"email@example.com",disabled:a,className:`w-full pl-10 pr-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n?"border-red-500":"border-gray-300"} ${a?"bg-gray-100":""}`})]});case"phone":return o.jsxs("div",{className:"relative",children:[o.jsx(yq,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),o.jsx("input",{type:"tel",value:t||"",onChange:y=>h(y.target.value),placeholder:l||"+1 (555) 123-4567",disabled:a,className:`w-full pl-10 pr-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n?"border-red-500":"border-gray-300"} ${a?"bg-gray-100":""}`})]});case"url":return o.jsxs("div",{className:"relative",children:[o.jsx(vq,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),o.jsx("input",{type:"url",value:t||"",onChange:y=>h(y.target.value),placeholder:l||"https://example.com",disabled:a,className:`w-full pl-10 pr-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n?"border-red-500":"border-gray-300"} ${a?"bg-gray-100":""}`})]});case"date":return o.jsxs("div",{className:"relative",children:[o.jsx(p_,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),o.jsx("input",{type:"date",value:t||"",onChange:y=>h(y.target.value),disabled:a,className:`w-full pl-10 pr-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n?"border-red-500":"border-gray-300"} ${a?"bg-gray-100":""}`,min:d==null?void 0:d.min_date,max:d==null?void 0:d.max_date})]});case"datetime":return o.jsxs("div",{className:"relative",children:[o.jsx(p_,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),o.jsx("input",{type:"datetime-local",value:t||"",onChange:y=>h(y.target.value),disabled:a,className:`w-full pl-10 pr-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n?"border-red-500":"border-gray-300"} ${a?"bg-gray-100":""}`,min:d==null?void 0:d.min_date,max:d==null?void 0:d.max_date})]});case"boolean":return o.jsxs("div",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",checked:t==="true"||t===!0,onChange:y=>h(y.target.checked.toString()),disabled:a,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),o.jsx("label",{className:"ml-2 text-sm text-gray-900",children:l||"Yes"})]});case"select":return o.jsxs("select",{value:t||"",onChange:y=>h(y.target.value),disabled:a,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n?"border-red-500":"border-gray-300"} ${a?"bg-gray-100":""}`,children:[o.jsx("option",{value:"",children:"Select an option..."}),(x=d.options)==null?void 0:x.map((y,b)=>o.jsx("option",{value:y.value,children:y.label},b))]});case"multi_select":const g=((p=d.options)==null?void 0:p.map(y=>({value:y.value,label:y.label})))||[],v=t?(t||"").split(",").filter(y=>y):[];return o.jsx(WL,{multiple:!0,options:g,value:v,onChange:y=>{h(Array.isArray(y)?y.join(","):"")},placeholder:"Select options...",disabled:a,searchable:g.length>5,className:n?"border-red-500":""});default:return o.jsx("input",{type:"text",value:t||"",onChange:y=>h(y.target.value),placeholder:l,disabled:a,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n?"border-red-500":"border-gray-300"} ${a?"bg-gray-100":""}`})}};return o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s,u&&o.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),m(),c&&o.jsx("p",{className:"mt-1 text-xs text-gray-500",children:c}),n&&o.jsx("p",{className:"mt-1 text-xs text-red-600",children:n})]})},vb=({fields:e,values:t={},onChange:r,errors:n={},disabled:a=!1})=>!Array.isArray(e)||e.length===0?null:r?o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b pb-2",children:"Custom Fields"}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.map((i,s)=>{const l=(i==null?void 0:i.id)||(i==null?void 0:i.field_key)||`field-${s}`;return o.jsx(XCe,{field:i,value:t[i==null?void 0:i.field_key]||"",onChange:r,error:n[i==null?void 0:i.field_key],disabled:a},l)})})]}):(console.error("CustomFieldsGroup: onChange prop is required"),null),as={getAllFields:async(e={})=>{const t=new URLSearchParams;return e.entity_type&&t.append("entity_type",e.entity_type),e.is_active!==void 0&&t.append("is_active",e.is_active),e.placement&&t.append("placement",e.placement),(await be.get(`/api/v1/custom-fields/?${t}`)).data},getField:async e=>(await be.get(`/api/v1/custom-fields/${e}`)).data,createField:async e=>(await be.post("/api/v1/custom-fields/",e)).data,updateField:async(e,t)=>(await be.put(`/api/v1/custom-fields/${e}`,t)).data,deleteField:async e=>(await be.delete(`/api/v1/custom-fields/${e}`)).data,getEntityCustomFields:async(e,t)=>(await be.get(`/api/v1/custom-fields/values/${e}/${t}`)).data,createFieldValue:async e=>(await be.post("/api/v1/custom-fields/values/",e)).data,bulkUpdateFieldValues:async e=>(await be.put("/api/v1/custom-fields/values/bulk",e)).data,deleteEntityFieldValues:async(e,t)=>(await be.delete(`/api/v1/custom-fields/values/${e}/${t}`)).data,getFieldTypes:async()=>(await be.get("/api/v1/custom-fields/types/field-types")).data,getEntityTypes:async()=>(await be.get("/api/v1/custom-fields/types/entity-types")).data},mo={async getAllConfigurations(e=null){const t=e?`/api/v1/system-config?category=${encodeURIComponent(e)}`:"/api/v1/system-config",{data:r,error:n}=await be.get(t);if(n)throw n;return r||[]},async getConfigurationsGrouped(){const{data:e,error:t}=await be.get("/api/v1/system-config/grouped");if(t)throw t;return e||{}},async getCompanyEmail(){var e;try{const t=await this.getConfigurationsGrouped();return((e=t==null?void 0:t.general)==null?void 0:e.company_email)||"noreply@company.com"}catch(t){return console.error("Failed to get company email:",t),"noreply@company.com"}},async getConfigurationsByCategories(){const{data:e,error:t}=await be.get("/api/v1/system-config/categories");if(t)throw t;return e||[]},async getConfigurationSchema(){const{data:e,error:t}=await be.get("/api/v1/system-config/schema");if(t)throw t;return e||{}},async createConfiguration(e){const{data:t,error:r}=await be.post("/api/v1/system-config",e);if(r)throw r;return t},async updateConfiguration(e,t){const{data:r,error:n}=await be.put(`/api/v1/system-config/${e}`,t);if(n)throw n;return r},async updateConfigurationsBulk(e){const t={configurations:e},{data:r,error:n}=await be.put("/api/v1/system-config/bulk",t);if(n)throw n;return r},async deleteConfiguration(e){const{data:t,error:r}=await be.delete(`/api/v1/system-config/${e}`);if(r)throw r;return t},async exportConfiguration(){const{data:e,error:t}=await be.get("/api/v1/system-config/export");if(t)throw t;return e},async validateConfigurations(e){const{data:t,error:r}=await be.post("/api/v1/system-config/validate",e);if(r)throw r;return t},async initializeDefaultConfigurations(){const{data:e,error:t}=await be.post("/api/v1/system-config/initialize");if(t)throw t;return e},transformConfigurationsForUI(e){const t={general:{},sales:{},notifications:{},security:{},backup:{},integrations:{},performance:{}};return e.forEach(r=>{const n=r.key.split(".");if(n.length===2){const[a,i]=n;t[a]&&(t[a][i]=r.value)}}),t},transformConfigurationsFromUI(e){const t=[];return Object.entries(e).forEach(([r,n])=>{n&&typeof n=="object"&&Object.entries(n).forEach(([a,i])=>{if(i!=null&&i!==""){let s=i;const l=`${r}.${a}`;if((l.includes("_days")||l.includes("_minutes")||l.includes("_seconds")||l.includes("_length")||l.includes("_limit")||l.includes("_timeout")||l.includes("_attempts")||l.includes("_results"))&&(s=typeof i=="string"?parseInt(i,10):i,isNaN(s))){console.warn(`Invalid numeric value for ${l}: ${i}`);return}t.push({key:l,value:s})}})}),t},getDefaultConfiguration(){return{general:{company_name:"SalesFlow Pro Inc.",company_email:"admin@salesflowpro.com",company_phone:"+1-555-123-4567",company_address:"123 Business Street, Suite 100, Business City, BC 12345",timezone:"America/New_York",date_format:"MM/DD/YYYY",time_format:"12",currency:"USD",language:"en"},sales:{default_pipeline_stage:"prospecting",deal_currency:"USD",require_deal_value:!0,auto_progress_deals:!1,deal_inactivity_warning_days:30,lead_scoring_enabled:!0,opportunity_auto_close_days:90},notifications:{email_notifications:!0,deal_update_notifications:!0,task_reminders:!0,weekly_reports:!0,system_alerts:!0,lead_assignment_alerts:!0,quota_achievement_alerts:!0},security:{password_complexity:!0,min_password_length:8,two_factor_auth:!1,session_timeout_minutes:480,max_login_attempts:5,lockout_duration_minutes:30,data_encryption_at_rest:!0,audit_log_retention_days:365},backup:{enable_automatic_backups:!0,backup_frequency:"daily",backup_retention_days:30,backup_location:"local",compress_backups:!0},integrations:{email_service_provider:"sendgrid",calendar_integration:"google",crm_sync_enabled:!1,api_rate_limit:1e3},performance:{enable_caching:!0,cache_ttl_seconds:3600,max_search_results:100,database_query_timeout:30}}},getFieldOptions(){return{timezone:["America/New_York","America/Chicago","America/Denver","America/Los_Angeles","Europe/London","Europe/Paris","Asia/Tokyo","Australia/Sydney"],date_format:["MM/DD/YYYY","DD/MM/YYYY","YYYY-MM-DD"],time_format:["12","24"],currency:["USD","EUR","GBP","JPY","CAD","AUD"],language:["en","es","fr","de","it","pt","ja","zh"],default_pipeline_stage:["prospecting","qualification","proposal","negotiation","closed_won","closed_lost"],backup_frequency:["daily","weekly","monthly"],backup_location:["local","s3","azure","google_cloud"],email_service_provider:["sendgrid","mailgun","ses","smtp"],calendar_integration:["google","outlook","none"]}},validateConfigurationValue(e,t){return e.includes("email")&&typeof t=="string"?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t):(e.includes("days")||e.includes("minutes")||e.includes("seconds"))&&typeof t=="number"?t>0:e.includes("enable")||e.includes("require")||e.includes("auto")?typeof t=="boolean":!0}},KCe=({deal:e=null,contacts:t=[],companies:r=[],stages:n=[],onSubmit:a,onCancel:i,isSaving:s=!1})=>{var F,I,R;const{user:l}=Vt(),[c,u]=M.useState(!1),[d,f]=M.useState(!1),h=M.useRef(null),[m,x]=M.useState([]),[p,g]=M.useState({}),[v,y]=M.useState(!1),[b,w]=M.useState(!0),[_,D]=M.useState({name:"",description:"",value:"",stage:"lead",probability:10,expected_close_date:"",contact_id:"",company_id:"",lead_source:"website",owner_id:(l==null?void 0:l.id)||""}),[j,N]=M.useState({});M.useEffect(()=>{var C;if(A(),S(),e)if(D({name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||"",value:((C=e==null?void 0:e.value)==null?void 0:C.toString())||"",stage:(e==null?void 0:e.stage)||"lead",probability:(e==null?void 0:e.probability)||10,expected_close_date:(e==null?void 0:e.expected_close_date)||"",contact_id:(e==null?void 0:e.contact_id)||"",company_id:(e==null?void 0:e.company_id)||"",lead_source:(e==null?void 0:e.lead_source)||"website",owner_id:(e==null?void 0:e.owner_id)||(l==null?void 0:l.id)||""}),e!=null&&e.custom_fields){const k={};Object.entries(e.custom_fields).forEach(([z,q])=>{(q==null?void 0:q.value)!==null&&(q==null?void 0:q.value)!==void 0&&(k[z]=q.value)}),g(k)}else e!=null&&e.id&&T(e.id);else E()},[e]);const S=async()=>{var C;try{const k=await mo.getConfigurationsGrouped(),z=((C=k==null?void 0:k.sales)==null?void 0:C.require_deal_value)??!0;w(z)}catch(k){console.error("Error loading system config:",k),w(!0)}},E=async()=>{var C,k;try{const z=await mo.getConfigurationsGrouped(),q=((C=z==null?void 0:z.sales)==null?void 0:C.default_pipeline_stage)||"lead",K=((k=z==null?void 0:z.sales)==null?void 0:k.require_deal_value)??!0;w(K),D({name:"",description:"",value:"",stage:q,probability:10,expected_close_date:"",contact_id:"",company_id:"",lead_source:"website",owner_id:(l==null?void 0:l.id)||""}),g({})}catch(z){console.error("Error loading default stage:",z),D({name:"",description:"",value:"",stage:"lead",probability:10,expected_close_date:"",contact_id:"",company_id:"",lead_source:"website",owner_id:(l==null?void 0:l.id)||""}),g({})}},A=async()=>{y(!0);try{const k=(await as.getAllFields({entity_type:"deal",is_active:!0})||[]).filter(z=>z.placement==="form"||z.placement==="both");x(k)}catch(C){console.error("Error loading custom fields:",C),x([])}finally{y(!1)}},T=async C=>{try{const k=await as.getEntityCustomFields("deal",C),z={};k.forEach(q=>{q.current_value!==null&&q.current_value!==void 0&&(z[q.field_key]=q.current_value)}),g(z)}catch(k){console.error("Error loading custom field values:",k),g({})}},L=async C=>{var z;if(C==null||C.preventDefault(),c||d||h.current)return;const k=Date.now();h.current=k,u(!0),f(!0),N({});try{const q=["name"];b&&q.push("value");const K={};if(q==null||q.forEach(ie=>{var ee,ae;(ae=(ee=_==null?void 0:_[ie])==null?void 0:ee.toString())!=null&&ae.trim()||(K[ie]=`${ie==null?void 0:ie.replace("_"," ")} is required`)}),_!=null&&_.value&&(isNaN(_==null?void 0:_.value)||parseFloat(_==null?void 0:_.value)<0)&&(K.value="Please enter a valid deal value"),_!=null&&_.expected_close_date&&new Date(_==null?void 0:_.expected_close_date)<new Date&&(K.expected_close_date="Expected close date cannot be in the past"),((z=Object.keys(K))==null?void 0:z.length)>0){N(K),u(!1);return}const se={name:_.name,description:_.description||null,value:parseFloat(_==null?void 0:_.value)||null,stage:_.stage||"lead",probability:parseInt(_.probability)||0,expected_close_date:(_==null?void 0:_.expected_close_date)||null,source:_.source||null,next_action:_.next_action||null,company_id:_.company_id||null,contact_id:_.contact_id||null,custom_fields:Object.keys(p).length>0?p:void 0};Object.keys(se).forEach(ie=>{se[ie]===void 0&&delete se[ie]}),await a(se)}catch(q){console.error("Error in form submission:",q);let K="Failed to save deal. Please try again.";q!=null&&q.message&&(Array.isArray(q.message)?K=q.message.map(se=>se.msg||se).join(", "):typeof q.message=="string"&&(K=q.message)),N({submit:K})}finally{u(!1),f(!1),h.current=null}},O=(C,k)=>{if(D(z=>({...z,[C]:k})),C==="stage"){const z={lead:10,qualified:25,proposal:50,negotiation:75,closed_won:100,closed_lost:0};D(q=>({...q,[C]:k,probability:(z==null?void 0:z[k])||(q==null?void 0:q.probability)}))}j!=null&&j[C]&&N(z=>{const q={...z};return q==null||delete q[C],q})},V=(C,k)=>{C&&(g(z=>({...z,[C]:k})),j!=null&&j[C]&&N(z=>{const q={...z};return q==null||delete q[C],q}))},W=C=>{const k=t==null?void 0:t.find(z=>(z==null?void 0:z.id)===C);D(z=>({...z,contact_id:C,company_id:(k==null?void 0:k.company_id)||(z==null?void 0:z.company_id)}))},B=n.length>0?n:[{value:"lead",label:"Lead"},{value:"qualified",label:"Qualified"},{value:"proposal",label:"Proposal"},{value:"negotiation",label:"Negotiation"},{value:"closed_won",label:"Closed Won"},{value:"closed_lost",label:"Closed Lost"}],P=[{value:"website",label:"Website"},{value:"referral",label:"Referral"},{value:"cold_call",label:"Cold Call"},{value:"email_campaign",label:"Email Campaign"},{value:"social_media",label:"Social Media"},{value:"event",label:"Event"},{value:"partner",label:"Partner"},{value:"other",label:"Other"}];return o.jsxs("form",{onSubmit:L,className:"space-y-6",children:[o.jsxs("div",{className:"flex justify-between items-center py-4 border-b border-border",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:e?"Edit Deal":"Create New Deal"}),o.jsxs("button",{type:"submit",disabled:c||s||d,className:"bg-primary text-white px-6 py-2 rounded-lg hover:bg-primary-600 transition-colors duration-150 ease-smooth flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[(c||s||d)&&o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),o.jsx("span",{children:e?"Update Deal":"Create Deal"})]})]}),(j==null?void 0:j.submit)&&o.jsxs("div",{className:"bg-error-50 border border-error-200 text-error p-4 rounded-lg flex items-center space-x-2",children:[o.jsx(Y,{name:"AlertCircle",size:20}),o.jsx("span",{children:j==null?void 0:j.submit})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Deal Name *"}),o.jsx("input",{type:"text",value:_==null?void 0:_.name,onChange:C=>{var k;return O("name",(k=C==null?void 0:C.target)==null?void 0:k.value)},className:`w-full px-3 py-2 border rounded-lg bg-surface text-text-primary placeholder-text-tertiary focus:ring-primary focus:border-primary ${j!=null&&j.name?"border-error":"border-border"}`,placeholder:"Enterprise Software License - Acme Corp",required:!0}),(j==null?void 0:j.name)&&o.jsx("p",{className:"text-sm text-error mt-1",children:j==null?void 0:j.name})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Deal Value ",b&&"*"]}),o.jsxs("div",{className:"relative",children:[o.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-secondary",children:"$"}),o.jsx("input",{type:"number",min:"0",step:"0.01",value:_==null?void 0:_.value,onChange:C=>{var k;return O("value",(k=C==null?void 0:C.target)==null?void 0:k.value)},className:`w-full pl-8 pr-3 py-2 border rounded-lg bg-surface text-text-primary placeholder-text-tertiary focus:ring-primary focus:border-primary ${j!=null&&j.value?"border-error":"border-border"}`,placeholder:"50000",required:b})]}),(j==null?void 0:j.value)&&o.jsx("p",{className:"text-sm text-error mt-1",children:j==null?void 0:j.value})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Stage"}),o.jsx("select",{value:_==null?void 0:_.stage,onChange:C=>{var k;return O("stage",(k=C==null?void 0:C.target)==null?void 0:k.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary focus:ring-primary focus:border-primary",children:B==null?void 0:B.map(C=>o.jsx("option",{value:C==null?void 0:C.value,children:C==null?void 0:C.label},C==null?void 0:C.value))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Probability (%)"}),o.jsx("input",{type:"number",min:"0",max:"100",value:_==null?void 0:_.probability,onChange:C=>{var k;return O("probability",parseInt((k=C==null?void 0:C.target)==null?void 0:k.value)||0)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary focus:ring-primary focus:border-primary"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Primary Contact"}),o.jsxs("select",{value:_==null?void 0:_.contact_id,onChange:C=>{var k;return W((k=C==null?void 0:C.target)==null?void 0:k.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary focus:ring-primary focus:border-primary",children:[o.jsx("option",{value:"",children:"Select Contact"}),t==null?void 0:t.map(C=>{var k;return o.jsxs("option",{value:C==null?void 0:C.id,children:[(C==null?void 0:C.full_name)||`${C==null?void 0:C.first_name} ${C==null?void 0:C.last_name}`," - ",(k=C==null?void 0:C.company)==null?void 0:k.name]},C==null?void 0:C.id)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Company"}),o.jsxs("select",{value:_==null?void 0:_.company_id,onChange:C=>{var k;return O("company_id",(k=C==null?void 0:C.target)==null?void 0:k.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary focus:ring-primary focus:border-primary",children:[o.jsx("option",{value:"",children:"Select Company"}),r==null?void 0:r.map(C=>o.jsx("option",{value:C==null?void 0:C.id,children:C==null?void 0:C.name},C==null?void 0:C.id))]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Expected Close Date"}),o.jsx("input",{type:"date",value:_==null?void 0:_.expected_close_date,onChange:C=>{var k;return O("expected_close_date",(k=C==null?void 0:C.target)==null?void 0:k.value)},className:`w-full px-3 py-2 border rounded-lg bg-surface text-text-primary focus:ring-primary focus:border-primary ${j!=null&&j.expected_close_date?"border-error":"border-border"}`,min:(R=(I=(F=new Date)==null?void 0:F.toISOString())==null?void 0:I.split("T"))==null?void 0:R[0]}),(j==null?void 0:j.expected_close_date)&&o.jsx("p",{className:"text-sm text-error mt-1",children:j==null?void 0:j.expected_close_date})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Lead Source"}),o.jsx("select",{value:_==null?void 0:_.lead_source,onChange:C=>{var k;return O("lead_source",(k=C==null?void 0:C.target)==null?void 0:k.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary focus:ring-primary focus:border-primary",children:P==null?void 0:P.map(C=>o.jsx("option",{value:C==null?void 0:C.value,children:C==null?void 0:C.label},C==null?void 0:C.value))})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Description"}),o.jsx("textarea",{value:_==null?void 0:_.description,onChange:C=>{var k;return O("description",(k=C==null?void 0:C.target)==null?void 0:k.value)},rows:4,className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary placeholder-text-tertiary focus:ring-primary focus:border-primary",placeholder:"Describe the deal, requirements, and key details..."})]}),v&&o.jsx("div",{className:"pt-6 border-t border-border",children:o.jsxs("div",{className:"text-center py-4 text-gray-500",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),o.jsx("p",{className:"mt-2",children:"Loading custom fields..."})]})}),!v&&Array.isArray(m)&&m.length>0&&o.jsx("div",{className:"pt-6 border-t border-border",children:o.jsx(vb,{fields:m,values:p||{},onChange:V,errors:j||{}})})]})},ZCe=({deal:e,contacts:t,companies:r,stages:n,onEdit:a})=>{const i=d=>Gr.formatCurrency(d),s=n.find(d=>d.value===(e==null?void 0:e.stage)),l=t.find(d=>d.id===(e==null?void 0:e.contact_id)),c=r.find(d=>d.id===(e==null?void 0:e.company_id)),u={website:"Website",referral:"Referral",cold_call:"Cold Call",email_campaign:"Email Campaign",social_media:"Social Media",event:"Event",partner:"Partner",other:"Other"};return o.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[o.jsxs("div",{className:"px-6 py-4 border-b border-border flex items-center justify-between",children:[o.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Deal Details"}),a&&o.jsxs("button",{onClick:a,className:"btn-primary flex items-center space-x-2",children:[o.jsx(Y,{name:"Edit",size:16}),o.jsx("span",{children:"Edit Deal"})]})]}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Deal Name"}),o.jsx("p",{className:"text-text-primary text-base font-medium",children:(e==null?void 0:e.name)||"N/A"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Deal Value"}),o.jsx("p",{className:"text-text-primary text-base font-semibold",children:i((e==null?void 0:e.value)||0)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Stage"}),o.jsx("span",{className:`inline-block px-3 py-1 text-sm font-medium rounded-full ${(s==null?void 0:s.color)||"bg-gray-100 text-gray-800"}`,children:(s==null?void 0:s.label)||(e==null?void 0:e.stage)||"N/A"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Probability"}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2.5",children:o.jsx("div",{className:"bg-primary h-2.5 rounded-full transition-all duration-300",style:{width:`${(e==null?void 0:e.probability)||0}%`}})}),o.jsxs("span",{className:"text-text-primary text-sm font-medium",children:[(e==null?void 0:e.probability)||0,"%"]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Primary Contact"}),o.jsx("p",{className:"text-text-primary text-base",children:l?o.jsxs("span",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:"User",size:16,className:"text-text-tertiary"}),o.jsxs("span",{children:[l.first_name," ",l.last_name]})]}):"No contact assigned"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Company"}),o.jsx("p",{className:"text-text-primary text-base",children:c?o.jsxs("span",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:"Building",size:16,className:"text-text-tertiary"}),o.jsx("span",{children:c.name})]}):"No company assigned"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Expected Close Date"}),o.jsx("p",{className:"text-text-primary text-base",children:e!=null&&e.expected_close_date?o.jsxs("span",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:"Calendar",size:16,className:"text-text-tertiary"}),o.jsx("span",{children:new Date(e.expected_close_date).toLocaleDateString()})]}):"No date set"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Lead Source"}),o.jsx("p",{className:"text-text-primary text-base",children:u[e==null?void 0:e.lead_source]||(e==null?void 0:e.lead_source)||"N/A"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Description"}),o.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-border",children:o.jsx("p",{className:"text-text-primary text-base whitespace-pre-wrap",children:(e==null?void 0:e.description)||"No description provided"})})]}),(e==null?void 0:e.custom_fields)&&Object.keys(e.custom_fields).length>0&&(()=>{const d=Object.entries(e.custom_fields).map(([f,h])=>{let m=null,x=f;if(h!=null)if(typeof h=="object"){const p=h.value;h.field_name&&(x=h.field_name),p!=null&&p!==""&&(m=String(p))}else h!==""&&(m=String(h));return m?{key:f,fieldName:x,displayValue:m}:null}).filter(f=>f!==null);return d.length===0?null:o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Custom Fields"}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:d.map(({key:f,fieldName:h,displayValue:m})=>o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:h.replace(/_/g," ").replace(/\b\w/g,x=>x.toUpperCase())}),o.jsx("p",{className:"text-text-primary text-base",children:m})]},f))})]})})(),o.jsx("div",{className:"pt-4 border-t border-border",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-text-tertiary mb-1",children:"Deal ID"}),o.jsxs("p",{className:"text-text-secondary font-mono",children:["#",e==null?void 0:e.id]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-text-tertiary mb-1",children:"Created"}),o.jsx("p",{className:"text-text-secondary",children:e!=null&&e.created_at?new Date(e.created_at).toLocaleString():"N/A"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-text-tertiary mb-1",children:"Last Updated"}),o.jsx("p",{className:"text-text-secondary",children:e!=null&&e.updated_at?new Date(e.updated_at).toLocaleString():"N/A"})]})]})})]})]})},JCe="https://hibiz-tr-rocket-dev-05c28b6796db.herokuapp.com/",Sr={async getDealDocuments(e){try{const{data:t,error:r}=await be.get(`/api/v1/deals/${e}/documents`);if(r)throw r;return t||[]}catch(t){throw console.error("Error fetching deal documents:",t),t}},async uploadDealDocument(e,t,r=null){try{const n=new FormData;n.append("file",t);const a=localStorage.getItem("access_token"),i=await fetch(`${JCe}/api/v1/deals/${e}/documents`,{method:"POST",headers:{Authorization:`Bearer ${a}`},body:n});if(!i.ok){const l=await i.json();throw new Error(l.detail||"Upload failed")}return await i.json()}catch(n){throw console.error("Error uploading deal document:",n),n}},async deleteDealDocument(e){try{const{data:t,error:r}=await be.delete(`/api/v1/documents/${e}`);if(r)throw r;return!0}catch(t){throw console.error("Error deleting deal document:",t),t}},async getDocumentDownloadUrl(e){try{const{data:t,error:r}=await be.get(`/api/v1/documents/${e}/download`);if(r)throw r;return(t==null?void 0:t.download_url)||null}catch(t){throw console.error("Error getting document download URL:",t),t}},subscribeToDealDocuments(e,t){return{unsubscribe:()=>{}}},async uploadDocument(e,t,r="other"){return this.uploadDealDocument(t,e,`${r}_${e.name}`)},async deleteDocument(e,t=null){return this.deleteDealDocument(e)},subscribeToDocumentChanges(e,t){return this.subscribeToDealDocuments(e,t)},unsubscribeFromDocumentChanges(e){e&&e.unsubscribe&&e.unsubscribe()},formatFileSize(e){if(e===0)return"0 Bytes";const t=1024,r=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,n)).toFixed(2))+" "+r[n]},getFileExtension(e){return e.split(".").pop().toLowerCase()},getFileIcon(e){const t=this.getFileExtension(e),r={pdf:"FileText",doc:"FileText",docx:"FileText",txt:"FileText",xls:"FileSpreadsheet",xlsx:"FileSpreadsheet",csv:"FileSpreadsheet",ppt:"Presentation",pptx:"Presentation",jpg:"Image",jpeg:"Image",png:"Image",gif:"Image",svg:"Image",zip:"FileArchive",rar:"FileArchive","7z":"FileArchive",default:"File"};return r[t]||r.default},async getDocumentUrl(e){return`/api/v1/deals/documents/${e}/download`}},QCe=({fileUrl:e,fileName:t})=>{const[r,n]=M.useState(""),[a,i]=M.useState(!0),[s,l]=M.useState(null);return M.useEffect(()=>{e&&(async()=>{try{i(!0),l(null);const u=await fetch(e);if(!u.ok)throw new Error("Failed to load file");const d=await u.text();n(d)}catch(u){l(u.message)}finally{i(!1)}})()},[e]),a?o.jsx("div",{className:"flex items-center justify-center h-full min-h-[400px]",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2"}),o.jsx("p",{className:"text-text-secondary",children:"Loading text file..."})]})}):s?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full min-h-[400px] text-center",children:[o.jsx(Y,{name:"AlertCircle",size:48,className:"text-error mb-4"}),o.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-2",children:"Failed to load file"}),o.jsx("p",{className:"text-text-secondary",children:s})]}):o.jsx("div",{className:"h-full",children:o.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-h-[600px] overflow-auto",children:o.jsx("pre",{className:"text-sm text-text-primary font-mono whitespace-pre-wrap break-words",children:r||"File is empty"})})})};var zL={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(e,t){((r,n)=>{e.exports=n()})(ht,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},a,i=!n.document&&!!n.postMessage,s=n.IS_PAPA_WORKER||!1,l={},c=0,u={};function d(N){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(S){var E=_(S);E.chunkSize=parseInt(E.chunkSize),S.step||S.chunk||(E.chunkSize=null),this._handle=new p(E),(this._handle.streamer=this)._config=E}).call(this,N),this.parseChunk=function(S,E){var A=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<A){let L=this._config.newline;L||(T=this._config.quoteChar||'"',L=this._handle.guessLineEndings(S,T)),S=[...S.split(L).slice(A)].join(L)}this.isFirstChunk&&j(this._config.beforeFirstChunk)&&(T=this._config.beforeFirstChunk(S))!==void 0&&(S=T),this.isFirstChunk=!1,this._halted=!1;var A=this._partialLine+S,T=(this._partialLine="",this._handle.parse(A,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(S=T.meta.cursor,A=(this._finished||(this._partialLine=A.substring(S-this._baseIndex),this._baseIndex=S),T&&T.data&&(this._rowCount+=T.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),s)n.postMessage({results:T,workerId:u.WORKER_ID,finished:A});else if(j(this._config.chunk)&&!E){if(this._config.chunk(T,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=T=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(T.data),this._completeResults.errors=this._completeResults.errors.concat(T.errors),this._completeResults.meta=T.meta),this._completed||!A||!j(this._config.complete)||T&&T.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),A||T&&T.meta.paused||this._nextChunk(),T}this._halted=!0},this._sendError=function(S){j(this._config.error)?this._config.error(S):s&&this._config.error&&n.postMessage({workerId:u.WORKER_ID,error:S,finished:!1})}}function f(N){var S;(N=N||{}).chunkSize||(N.chunkSize=u.RemoteChunkSize),d.call(this,N),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(E){this._input=E,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(S=new XMLHttpRequest,this._config.withCredentials&&(S.withCredentials=this._config.withCredentials),i||(S.onload=D(this._chunkLoaded,this),S.onerror=D(this._chunkError,this)),S.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var E,A=this._config.downloadRequestHeaders;for(E in A)S.setRequestHeader(E,A[E])}var T;this._config.chunkSize&&(T=this._start+this._config.chunkSize-1,S.setRequestHeader("Range","bytes="+this._start+"-"+T));try{S.send(this._config.downloadRequestBody)}catch(L){this._chunkError(L.message)}i&&S.status===0&&this._chunkError()}},this._chunkLoaded=function(){S.readyState===4&&(S.status<200||400<=S.status?this._chunkError():(this._start+=this._config.chunkSize||S.responseText.length,this._finished=!this._config.chunkSize||this._start>=(E=>(E=E.getResponseHeader("Content-Range"))!==null?parseInt(E.substring(E.lastIndexOf("/")+1)):-1)(S),this.parseChunk(S.responseText)))},this._chunkError=function(E){E=S.statusText||E,this._sendError(new Error(E))}}function h(N){(N=N||{}).chunkSize||(N.chunkSize=u.LocalChunkSize),d.call(this,N);var S,E,A=typeof FileReader<"u";this.stream=function(T){this._input=T,E=T.slice||T.webkitSlice||T.mozSlice,A?((S=new FileReader).onload=D(this._chunkLoaded,this),S.onerror=D(this._chunkError,this)):S=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var T=this._input,L=(this._config.chunkSize&&(L=Math.min(this._start+this._config.chunkSize,this._input.size),T=E.call(T,this._start,L)),S.readAsText(T,this._config.encoding));A||this._chunkLoaded({target:{result:L}})},this._chunkLoaded=function(T){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(T.target.result)},this._chunkError=function(){this._sendError(S.error)}}function m(N){var S;d.call(this,N=N||{}),this.stream=function(E){return S=E,this._nextChunk()},this._nextChunk=function(){var E,A;if(!this._finished)return E=this._config.chunkSize,S=E?(A=S.substring(0,E),S.substring(E)):(A=S,""),this._finished=!S,this.parseChunk(A)}}function x(N){d.call(this,N=N||{});var S=[],E=!0,A=!1;this.pause=function(){d.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){d.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(T){this._input=T,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){A&&S.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),S.length?this.parseChunk(S.shift()):E=!0},this._streamData=D(function(T){try{S.push(typeof T=="string"?T:T.toString(this._config.encoding)),E&&(E=!1,this._checkIsFinished(),this.parseChunk(S.shift()))}catch(L){this._streamError(L)}},this),this._streamError=D(function(T){this._streamCleanUp(),this._sendError(T)},this),this._streamEnd=D(function(){this._streamCleanUp(),A=!0,this._streamData("")},this),this._streamCleanUp=D(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function p(N){var S,E,A,T,L=Math.pow(2,53),O=-L,V=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,W=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,B=this,P=0,F=0,I=!1,R=!1,C=[],k={data:[],errors:[],meta:{}};function z(ie){return N.skipEmptyLines==="greedy"?ie.join("").trim()==="":ie.length===1&&ie[0].length===0}function q(){if(k&&A&&(se("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+u.DefaultDelimiter+"'"),A=!1),N.skipEmptyLines&&(k.data=k.data.filter(function(pe){return!z(pe)})),K()){let pe=function(H,ne){j(N.transformHeader)&&(H=N.transformHeader(H,ne)),C.push(H)};if(k)if(Array.isArray(k.data[0])){for(var ie=0;K()&&ie<k.data.length;ie++)k.data[ie].forEach(pe);k.data.splice(0,1)}else k.data.forEach(pe)}function ee(pe,H){for(var ne=N.header?{}:[],U=0;U<pe.length;U++){var le=U,re=pe[U],re=((X,G)=>(ce=>(N.dynamicTypingFunction&&N.dynamicTyping[ce]===void 0&&(N.dynamicTyping[ce]=N.dynamicTypingFunction(ce)),(N.dynamicTyping[ce]||N.dynamicTyping)===!0))(X)?G==="true"||G==="TRUE"||G!=="false"&&G!=="FALSE"&&((ce=>{if(V.test(ce)&&(ce=parseFloat(ce),O<ce&&ce<L))return 1})(G)?parseFloat(G):W.test(G)?new Date(G):G===""?null:G):G)(le=N.header?U>=C.length?"__parsed_extra":C[U]:le,re=N.transform?N.transform(re,le):re);le==="__parsed_extra"?(ne[le]=ne[le]||[],ne[le].push(re)):ne[le]=re}return N.header&&(U>C.length?se("FieldMismatch","TooManyFields","Too many fields: expected "+C.length+" fields but parsed "+U,F+H):U<C.length&&se("FieldMismatch","TooFewFields","Too few fields: expected "+C.length+" fields but parsed "+U,F+H)),ne}var ae;k&&(N.header||N.dynamicTyping||N.transform)&&(ae=1,!k.data.length||Array.isArray(k.data[0])?(k.data=k.data.map(ee),ae=k.data.length):k.data=ee(k.data,0),N.header&&k.meta&&(k.meta.fields=C),F+=ae)}function K(){return N.header&&C.length===0}function se(ie,ee,ae,pe){ie={type:ie,code:ee,message:ae},pe!==void 0&&(ie.row=pe),k.errors.push(ie)}j(N.step)&&(T=N.step,N.step=function(ie){k=ie,K()?q():(q(),k.data.length!==0&&(P+=ie.data.length,N.preview&&P>N.preview?E.abort():(k.data=k.data[0],T(k,B))))}),this.parse=function(ie,ee,ae){var pe=N.quoteChar||'"',pe=(N.newline||(N.newline=this.guessLineEndings(ie,pe)),A=!1,N.delimiter?j(N.delimiter)&&(N.delimiter=N.delimiter(ie),k.meta.delimiter=N.delimiter):((pe=((H,ne,U,le,re)=>{var X,G,ce,J;re=re||[",","	","|",";",u.RECORD_SEP,u.UNIT_SEP];for(var ue=0;ue<re.length;ue++){for(var me,te=re[ue],oe=0,ge=0,ye=0,Ce=(ce=void 0,new v({comments:le,delimiter:te,newline:ne,preview:10}).parse(H)),Ie=0;Ie<Ce.data.length;Ie++)U&&z(Ce.data[Ie])?ye++:(me=Ce.data[Ie].length,ge+=me,ce===void 0?ce=me:0<me&&(oe+=Math.abs(me-ce),ce=me));0<Ce.data.length&&(ge/=Ce.data.length-ye),(G===void 0||oe<=G)&&(J===void 0||J<ge)&&1.99<ge&&(G=oe,X=te,J=ge)}return{successful:!!(N.delimiter=X),bestDelimiter:X}})(ie,N.newline,N.skipEmptyLines,N.comments,N.delimitersToGuess)).successful?N.delimiter=pe.bestDelimiter:(A=!0,N.delimiter=u.DefaultDelimiter),k.meta.delimiter=N.delimiter),_(N));return N.preview&&N.header&&pe.preview++,S=ie,E=new v(pe),k=E.parse(S,ee,ae),q(),I?{meta:{paused:!0}}:k||{meta:{paused:!1}}},this.paused=function(){return I},this.pause=function(){I=!0,E.abort(),S=j(N.chunk)?"":S.substring(E.getCharIndex())},this.resume=function(){B.streamer._halted?(I=!1,B.streamer.parseChunk(S,!0)):setTimeout(B.resume,3)},this.aborted=function(){return R},this.abort=function(){R=!0,E.abort(),k.meta.aborted=!0,j(N.complete)&&N.complete(k),S=""},this.guessLineEndings=function(H,pe){H=H.substring(0,1048576);var pe=new RegExp(g(pe)+"([^]*?)"+g(pe),"gm"),ae=(H=H.replace(pe,"")).split("\r"),pe=H.split(`
`),H=1<pe.length&&pe[0].length<ae[0].length;if(ae.length===1||H)return`
`;for(var ne=0,U=0;U<ae.length;U++)ae[U][0]===`
`&&ne++;return ne>=ae.length/2?`\r
`:"\r"}}function g(N){return N.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function v(N){var S=(N=N||{}).delimiter,E=N.newline,A=N.comments,T=N.step,L=N.preview,O=N.fastMode,V=null,W=!1,B=N.quoteChar==null?'"':N.quoteChar,P=B;if(N.escapeChar!==void 0&&(P=N.escapeChar),(typeof S!="string"||-1<u.BAD_DELIMITERS.indexOf(S))&&(S=","),A===S)throw new Error("Comment character same as delimiter");A===!0?A="#":(typeof A!="string"||-1<u.BAD_DELIMITERS.indexOf(A))&&(A=!1),E!==`
`&&E!=="\r"&&E!==`\r
`&&(E=`
`);var F=0,I=!1;this.parse=function(R,C,k){if(typeof R!="string")throw new Error("Input must be a string");var z=R.length,q=S.length,K=E.length,se=A.length,ie=j(T),ee=[],ae=[],pe=[],H=F=0;if(!R)return oe();if(O||O!==!1&&R.indexOf(B)===-1){for(var ne=R.split(E),U=0;U<ne.length;U++){if(pe=ne[U],F+=pe.length,U!==ne.length-1)F+=E.length;else if(k)return oe();if(!A||pe.substring(0,se)!==A){if(ie){if(ee=[],J(pe.split(S)),ge(),I)return oe()}else J(pe.split(S));if(L&&L<=U)return ee=ee.slice(0,L),oe(!0)}}return oe()}for(var le=R.indexOf(S,F),re=R.indexOf(E,F),X=new RegExp(g(P)+g(B),"g"),G=R.indexOf(B,F);;)if(R[F]===B)for(G=F,F++;;){if((G=R.indexOf(B,G+1))===-1)return k||ae.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:ee.length,index:F}),me();if(G===z-1)return me(R.substring(F,G).replace(X,B));if(B===P&&R[G+1]===P)G++;else if(B===P||G===0||R[G-1]!==P){le!==-1&&le<G+1&&(le=R.indexOf(S,G+1));var ce=ue((re=re!==-1&&re<G+1?R.indexOf(E,G+1):re)===-1?le:Math.min(le,re));if(R.substr(G+1+ce,q)===S){pe.push(R.substring(F,G).replace(X,B)),R[F=G+1+ce+q]!==B&&(G=R.indexOf(B,F)),le=R.indexOf(S,F),re=R.indexOf(E,F);break}if(ce=ue(re),R.substring(G+1+ce,G+1+ce+K)===E){if(pe.push(R.substring(F,G).replace(X,B)),te(G+1+ce+K),le=R.indexOf(S,F),G=R.indexOf(B,F),ie&&(ge(),I))return oe();if(L&&ee.length>=L)return oe(!0);break}ae.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:ee.length,index:F}),G++}}else if(A&&pe.length===0&&R.substring(F,F+se)===A){if(re===-1)return oe();F=re+K,re=R.indexOf(E,F),le=R.indexOf(S,F)}else if(le!==-1&&(le<re||re===-1))pe.push(R.substring(F,le)),F=le+q,le=R.indexOf(S,F);else{if(re===-1)break;if(pe.push(R.substring(F,re)),te(re+K),ie&&(ge(),I))return oe();if(L&&ee.length>=L)return oe(!0)}return me();function J(ye){ee.push(ye),H=F}function ue(ye){var Ce=0;return Ce=ye!==-1&&(ye=R.substring(G+1,ye))&&ye.trim()===""?ye.length:Ce}function me(ye){return k||(ye===void 0&&(ye=R.substring(F)),pe.push(ye),F=z,J(pe),ie&&ge()),oe()}function te(ye){F=ye,J(pe),pe=[],re=R.indexOf(E,F)}function oe(ye){if(N.header&&!C&&ee.length&&!W){var Ce=ee[0],Ie=Object.create(null),rt=new Set(Ce);let Pe=!1;for(let Ke=0;Ke<Ce.length;Ke++){let lt=Ce[Ke];if(Ie[lt=j(N.transformHeader)?N.transformHeader(lt,Ke):lt]){let nt,nr=Ie[lt];for(;nt=lt+"_"+nr,nr++,rt.has(nt););rt.add(nt),Ce[Ke]=nt,Ie[lt]++,Pe=!0,(V=V===null?{}:V)[nt]=lt}else Ie[lt]=1,Ce[Ke]=lt;rt.add(lt)}Pe&&console.warn("Duplicate headers found and renamed."),W=!0}return{data:ee,errors:ae,meta:{delimiter:S,linebreak:E,aborted:I,truncated:!!ye,cursor:H+(C||0),renamedHeaders:V}}}function ge(){T(oe()),ee=[],ae=[]}},this.abort=function(){I=!0},this.getCharIndex=function(){return F}}function y(N){var S=N.data,E=l[S.workerId],A=!1;if(S.error)E.userError(S.error,S.file);else if(S.results&&S.results.data){var T={abort:function(){A=!0,b(S.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:w,resume:w};if(j(E.userStep)){for(var L=0;L<S.results.data.length&&(E.userStep({data:S.results.data[L],errors:S.results.errors,meta:S.results.meta},T),!A);L++);delete S.results}else j(E.userChunk)&&(E.userChunk(S.results,T,S.file),delete S.results)}S.finished&&!A&&b(S.workerId,S.results)}function b(N,S){var E=l[N];j(E.userComplete)&&E.userComplete(S),E.terminate(),delete l[N]}function w(){throw new Error("Not implemented.")}function _(N){if(typeof N!="object"||N===null)return N;var S,E=Array.isArray(N)?[]:{};for(S in N)E[S]=_(N[S]);return E}function D(N,S){return function(){N.apply(S,arguments)}}function j(N){return typeof N=="function"}return u.parse=function(N,S){var E=(S=S||{}).dynamicTyping||!1;if(j(E)&&(S.dynamicTypingFunction=E,E={}),S.dynamicTyping=E,S.transform=!!j(S.transform)&&S.transform,!S.worker||!u.WORKERS_SUPPORTED)return E=null,u.NODE_STREAM_INPUT,typeof N=="string"?(N=(A=>A.charCodeAt(0)!==65279?A:A.slice(1))(N),E=new(S.download?f:m)(S)):N.readable===!0&&j(N.read)&&j(N.on)?E=new x(S):(n.File&&N instanceof File||N instanceof Object)&&(E=new h(S)),E.stream(N);(E=(()=>{var A;return!!u.WORKERS_SUPPORTED&&(A=(()=>{var T=n.URL||n.webkitURL||null,L=r.toString();return u.BLOB_URL||(u.BLOB_URL=T.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",L,")();"],{type:"text/javascript"})))})(),(A=new n.Worker(A)).onmessage=y,A.id=c++,l[A.id]=A)})()).userStep=S.step,E.userChunk=S.chunk,E.userComplete=S.complete,E.userError=S.error,S.step=j(S.step),S.chunk=j(S.chunk),S.complete=j(S.complete),S.error=j(S.error),delete S.worker,E.postMessage({input:N,config:S,workerId:E.id})},u.unparse=function(N,S){var E=!1,A=!0,T=",",L=`\r
`,O='"',V=O+O,W=!1,B=null,P=!1,F=((()=>{if(typeof S=="object"){if(typeof S.delimiter!="string"||u.BAD_DELIMITERS.filter(function(C){return S.delimiter.indexOf(C)!==-1}).length||(T=S.delimiter),typeof S.quotes!="boolean"&&typeof S.quotes!="function"&&!Array.isArray(S.quotes)||(E=S.quotes),typeof S.skipEmptyLines!="boolean"&&typeof S.skipEmptyLines!="string"||(W=S.skipEmptyLines),typeof S.newline=="string"&&(L=S.newline),typeof S.quoteChar=="string"&&(O=S.quoteChar),typeof S.header=="boolean"&&(A=S.header),Array.isArray(S.columns)){if(S.columns.length===0)throw new Error("Option columns is empty");B=S.columns}S.escapeChar!==void 0&&(V=S.escapeChar+O),S.escapeFormulae instanceof RegExp?P=S.escapeFormulae:typeof S.escapeFormulae=="boolean"&&S.escapeFormulae&&(P=/^[=+\-@\t\r].*$/)}})(),new RegExp(g(O),"g"));if(typeof N=="string"&&(N=JSON.parse(N)),Array.isArray(N)){if(!N.length||Array.isArray(N[0]))return I(null,N,W);if(typeof N[0]=="object")return I(B||Object.keys(N[0]),N,W)}else if(typeof N=="object")return typeof N.data=="string"&&(N.data=JSON.parse(N.data)),Array.isArray(N.data)&&(N.fields||(N.fields=N.meta&&N.meta.fields||B),N.fields||(N.fields=Array.isArray(N.data[0])?N.fields:typeof N.data[0]=="object"?Object.keys(N.data[0]):[]),Array.isArray(N.data[0])||typeof N.data[0]=="object"||(N.data=[N.data])),I(N.fields||[],N.data||[],W);throw new Error("Unable to serialize unrecognized input");function I(C,k,z){var q="",K=(typeof C=="string"&&(C=JSON.parse(C)),typeof k=="string"&&(k=JSON.parse(k)),Array.isArray(C)&&0<C.length),se=!Array.isArray(k[0]);if(K&&A){for(var ie=0;ie<C.length;ie++)0<ie&&(q+=T),q+=R(C[ie],ie);0<k.length&&(q+=L)}for(var ee=0;ee<k.length;ee++){var ae=(K?C:k[ee]).length,pe=!1,H=K?Object.keys(k[ee]).length===0:k[ee].length===0;if(z&&!K&&(pe=z==="greedy"?k[ee].join("").trim()==="":k[ee].length===1&&k[ee][0].length===0),z==="greedy"&&K){for(var ne=[],U=0;U<ae;U++){var le=se?C[U]:U;ne.push(k[ee][le])}pe=ne.join("").trim()===""}if(!pe){for(var re=0;re<ae;re++){0<re&&!H&&(q+=T);var X=K&&se?C[re]:re;q+=R(k[ee][X],re)}ee<k.length-1&&(!z||0<ae&&!H)&&(q+=L)}}return q}function R(C,k){var z,q;return C==null?"":C.constructor===Date?JSON.stringify(C).slice(1,25):(q=!1,P&&typeof C=="string"&&P.test(C)&&(C="'"+C,q=!0),z=C.toString().replace(F,V),(q=q||E===!0||typeof E=="function"&&E(C,k)||Array.isArray(E)&&E[k]||((K,se)=>{for(var ie=0;ie<se.length;ie++)if(-1<K.indexOf(se[ie]))return!0;return!1})(z,u.BAD_DELIMITERS)||-1<z.indexOf(T)||z.charAt(0)===" "||z.charAt(z.length-1)===" ")?O+z+O:z)}},u.RECORD_SEP="",u.UNIT_SEP="",u.BYTE_ORDER_MARK="\uFEFF",u.BAD_DELIMITERS=["\r",`
`,'"',u.BYTE_ORDER_MARK],u.WORKERS_SUPPORTED=!i&&!!n.Worker,u.NODE_STREAM_INPUT=1,u.LocalChunkSize=10485760,u.RemoteChunkSize=5242880,u.DefaultDelimiter=",",u.Parser=v,u.ParserHandle=p,u.NetworkStreamer=f,u.FileStreamer=h,u.StringStreamer=m,u.ReadableStreamStreamer=x,n.jQuery&&((a=n.jQuery).fn.parse=function(N){var S=N.config||{},E=[];return this.each(function(L){if(!(a(this).prop("tagName").toUpperCase()==="INPUT"&&a(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var O=0;O<this.files.length;O++)E.push({file:this.files[O],inputElem:this,instanceConfig:a.extend({},S)})}),A(),this;function A(){if(E.length===0)j(N.complete)&&N.complete();else{var L,O,V,W,B=E[0];if(j(N.before)){var P=N.before(B.file,B.inputElem);if(typeof P=="object"){if(P.action==="abort")return L="AbortError",O=B.file,V=B.inputElem,W=P.reason,void(j(N.error)&&N.error({name:L},O,V,W));if(P.action==="skip")return void T();typeof P.config=="object"&&(B.instanceConfig=a.extend(B.instanceConfig,P.config))}else if(P==="skip")return void T()}var F=B.instanceConfig.complete;B.instanceConfig.complete=function(I){j(F)&&F(I,B.file,B.inputElem),T()},u.parse(B.file,B.instanceConfig)}}function T(){E.splice(0,1),A()}}),s&&(n.onmessage=function(N){N=N.data,u.WORKER_ID===void 0&&N&&(u.WORKER_ID=N.workerId),typeof N.input=="string"?n.postMessage({workerId:u.WORKER_ID,results:u.parse(N.input,N.config),finished:!0}):(n.File&&N.input instanceof File||N.input instanceof Object)&&(N=u.parse(N.input,N.config))&&n.postMessage({workerId:u.WORKER_ID,results:N,finished:!0})}),(f.prototype=Object.create(d.prototype)).constructor=f,(h.prototype=Object.create(d.prototype)).constructor=h,(m.prototype=Object.create(m.prototype)).constructor=m,(x.prototype=Object.create(d.prototype)).constructor=x,u})})(zL);var eAe=zL.exports;const Rm=At(eAe),tAe=({fileUrl:e,fileName:t})=>{const[r,n]=M.useState([]),[a,i]=M.useState([]),[s,l]=M.useState(!0),[c,u]=M.useState(null),[d,f]=M.useState(1),h=50;if(M.useEffect(()=>{e&&(async()=>{try{l(!0),u(null);const y=await fetch(e);if(!y.ok)throw new Error("Failed to load file");const b=await y.text();Rm.parse(b,{header:!0,skipEmptyLines:!0,complete:w=>{if(w.errors.length>0&&console.warn("CSV parsing warnings:",w.errors),w.data.length===0){u("CSV file is empty"),l(!1);return}i(w.meta.fields||Object.keys(w.data[0])),n(w.data),l(!1)},error:w=>{u(w.message),l(!1)}})}catch(y){u(y.message),l(!1)}})()},[e]),s)return o.jsx("div",{className:"flex items-center justify-center h-full min-h-[400px]",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2"}),o.jsx("p",{className:"text-text-secondary",children:"Loading CSV file..."})]})});if(c)return o.jsxs("div",{className:"flex flex-col items-center justify-center h-full min-h-[400px] text-center",children:[o.jsx(Y,{name:"AlertCircle",size:48,className:"text-error mb-4"}),o.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-2",children:"Failed to load CSV"}),o.jsx("p",{className:"text-text-secondary",children:c})]});const m=Math.ceil(r.length/h),x=(d-1)*h,p=x+h,g=r.slice(x,p);return o.jsxs("div",{className:"h-full flex flex-col",children:[o.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 px-4 py-2 rounded-t-lg flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4 text-sm text-text-secondary",children:[o.jsxs("span",{children:[o.jsx("strong",{children:r.length})," rows"]}),o.jsx("span",{children:""}),o.jsxs("span",{children:[o.jsx("strong",{children:a.length})," columns"]})]}),m>1&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:()=>f(v=>Math.max(1,v-1)),disabled:d===1,className:"p-1 rounded hover:bg-white dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:o.jsx(Y,{name:"ChevronLeft",size:16})}),o.jsxs("span",{className:"text-sm text-text-secondary",children:["Page ",d," of ",m]}),o.jsx("button",{onClick:()=>f(v=>Math.min(m,v+1)),disabled:d===m,className:"p-1 rounded hover:bg-white dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:o.jsx(Y,{name:"ChevronRight",size:16})})]})]}),o.jsx("div",{className:"flex-1 overflow-auto bg-white dark:bg-gray-800 rounded-b-lg",children:o.jsxs("table",{className:"w-full border-collapse",children:[o.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700 sticky top-0",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-text-secondary border-b border-border w-12",children:"#"}),a.map((v,y)=>o.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-text-secondary border-b border-border whitespace-nowrap",children:v},y))]})}),o.jsx("tbody",{children:g.map((v,y)=>o.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[o.jsx("td",{className:"px-4 py-2 text-xs text-text-tertiary border-b border-border",children:x+y+1}),a.map((b,w)=>o.jsx("td",{className:"px-4 py-2 text-sm text-text-primary border-b border-border whitespace-nowrap",children:v[b]||""},w))]},x+y))})]})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Mm={};Mm.version="0.18.5";var si=1200,Bc=1252,rAe=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],VS={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},yb=function(e){rAe.indexOf(e)!=-1&&(Bc=VS[0]=e)};function nAe(){yb(1252)}var Ii=function(e){si=e,yb(e)};function bb(){Ii(1200),nAe()}function sv(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function aAe(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function HL(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var qu=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?aAe(e.slice(2)):t==254&&r==255?HL(e.slice(2)):t==65279?e.slice(1):e},wh=function(t){return String.fromCharCode(t)},uj=function(t){return String.fromCharCode(t)},Ut;function iAe(e){Ut=e,Ii=function(t){si=t,yb(t)},qu=function(t){return t.charCodeAt(0)===255&&t.charCodeAt(1)===254?Ut.utils.decode(1200,sv(t.slice(2))):t},wh=function(r){return si===1200?String.fromCharCode(r):Ut.utils.decode(si,[r&255,r>>8])[0]},uj=function(r){return Ut.utils.decode(Bc,[r])[0]},yB()}var cl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Um(e){for(var t="",r=0,n=0,a=0,i=0,s=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,n=e.charCodeAt(u++),s=(r&3)<<4|n>>4,a=e.charCodeAt(u++),l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),t+=cl.charAt(i)+cl.charAt(s)+cl.charAt(l)+cl.charAt(c);return t}function oi(e){var t="",r=0,n=0,a=0,i=0,s=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=cl.indexOf(e.charAt(u++)),s=cl.indexOf(e.charAt(u++)),r=i<<2|s>>4,t+=String.fromCharCode(r),l=cl.indexOf(e.charAt(u++)),n=(s&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=cl.indexOf(e.charAt(u++)),a=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(a));return t}var Tt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ho=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function El(e){return Tt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function _F(e){return Tt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Za=function(t){return Tt?Ho(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function rx(e){if(typeof ArrayBuffer>"u")return Za(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function zl(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function sAe(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function qS(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return qS(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var bn=Tt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ho(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function oAe(e){for(var t=[],r=0,n=e.length+250,a=El(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var l=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|l>>6&15|(s&3)<<4,a[r++]=128|l&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=El(65535),n=65530)}return t.push(a.slice(0,r)),bn(t)}var ta=/\u0000/g,_h=/[\u0001-\u0006]/g;function rd(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function is(e,t){var r=""+e;return r.length>=t?r:Ir("0",t-r.length)+r}function GS(e,t){var r=""+e;return r.length>=t?r:Ir(" ",t-r.length)+r}function ov(e,t){var r=""+e;return r.length>=t?r:r+Ir(" ",t-r.length)}function lAe(e,t){var r=""+Math.round(e);return r.length>=t?r:Ir("0",t-r.length)+r}function cAe(e,t){var r=""+e;return r.length>=t?r:Ir("0",t-r.length)+r}var DF=Math.pow(2,32);function Eu(e,t){if(e>DF||e<-DF)return lAe(e,t);var r=Math.round(e);return cAe(r,t)}function lv(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var jF=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Cw=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function uAe(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var dt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},NF={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},dAe={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function cv(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,l=0,c=1,u=0,d=0,f=Math.floor(a);u<t&&(f=Math.floor(a),l=f*s+i,d=f*u+c,!(a-f<5e-8));)a=1/(a-f),i=s,s=l,c=u,u=d;if(d>t&&(u>t?(d=c,l=i):(d=u,l=s)),!r)return[0,n*l,d];var h=Math.floor(n*l/d);return[h,n*l-h*d,d]}function ul(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],l={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=gAe(c,s))}return l.y=s[0],l.m=s[1],l.d=s[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=i,l}var VL=new Date(1899,11,31,0,0,0),fAe=VL.getTime(),hAe=new Date(1900,2,1,0,0,0);function qL(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=hAe&&(r+=24*60*60*1e3),(r-(fAe+(e.getTimezoneOffset()-VL.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function YS(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function mAe(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function pAe(e){var t=e<0?12:11,r=YS(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function xAe(e){var t=YS(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function $m(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=pAe(e):t===10?r=e.toFixed(10).substr(0,12):r=xAe(e),YS(mAe(r.toUpperCase()))}function Wc(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):$m(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return li(14,qL(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function gAe(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function vAe(e,t,r,n){var a="",i=0,s=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return Cw[r.m-1][1];case 5:return Cw[r.m-1][0];default:return Cw[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return jF[r.q][0];default:return jF[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?is(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=is(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?is(c,u):"";return d}function dl(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var GL=/%/g;function yAe(e,t,r){var n=t.replace(GL,""),a=t.length-n.length;return jo(e,n,r*Math.pow(10,2*a))+Ir("%",a)}function bAe(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return jo(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function YL(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+YL(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(a+i)%a)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var XL=/# (\?+)( ?)\/( ?)(\d+)/;function wAe(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,l=n;return r+(i===0?"":""+i)+" "+(s===0?Ir(" ",e[1].length+1+e[4].length):GS(s,e[1].length)+e[2]+"/"+e[3]+is(l,e[4].length))}function _Ae(e,t,r){return r+(t===0?"":""+t)+Ir(" ",e[1].length+2+e[4].length)}var KL=/^#*0*\.([0#]+)/,ZL=/\).*[0#]/,JL=/\(###\) ###\\?-####/;function ha(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function SF(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function EF(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function DAe(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function jAe(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function bi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ZL)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?bi("n",n,r):"("+bi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return bAe(e,t,r);if(t.indexOf("%")!==-1)return yAe(e,t,r);if(t.indexOf("E")!==-1)return YL(t,r);if(t.charCodeAt(0)===36)return"$"+bi(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Eu(c,t.length);if(t.match(/^[#?]+$/))return a=Eu(r,0),a==="0"&&(a=""),a.length>t.length?a:ha(t.substr(0,t.length-a.length))+a;if(i=t.match(XL))return wAe(i,c,u);if(t.match(/^#+0+$/))return u+Eu(c,t.length-t.indexOf("0"));if(i=t.match(KL))return a=SF(r,i[1].length).replace(/^([^\.]+)$/,"$1."+ha(i[1])).replace(/\.$/,"."+ha(i[1])).replace(/\.(\d*)$/,function(x,p){return"."+p+Ir("0",ha(i[1]).length-p.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+SF(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+dl(Eu(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+bi(e,t,-r):dl(""+(Math.floor(r)+DAe(r,i[1].length)))+"."+is(EF(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return bi(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=rd(bi(e,t.replace(/[\\-]/g,""),r)),s=0,rd(rd(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):x==="0"?"0":""}));if(t.match(JL))return a=bi(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),l=cv(c,Math.pow(10,s)-1,!1),a=""+u,d=jo("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+i[2]+"/"+i[3],d=ov(l[2],s),d.length<i[4].length&&(d=ha(i[4].substr(i[4].length-d.length))+d),a+=d,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),l=cv(c,Math.pow(10,s)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?GS(l[1],s)+i[2]+"/"+i[3]+ov(l[2],s):Ir(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Eu(r,0),t.length<=a.length?a:ha(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var f=t.indexOf(".")-s,h=t.length-a.length-f;return ha(t.substr(0,f)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=EF(r,i[1].length),r<0?"-"+bi(e,t,-r):dl(jAe(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?is(0,3-x.length):"")+x})+"."+is(s,i[1].length);switch(t){case"###,##0.00":return bi(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=dl(Eu(c,0));return m!=="0"?u+m:"";case"###,###.00":return bi(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return bi(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function NAe(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return jo(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function SAe(e,t,r){var n=t.replace(GL,""),a=t.length-n.length;return jo(e,n,r*Math.pow(10,2*a))+Ir("%",a)}function QL(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+QL(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(a+i)%a)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ts(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ZL)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ts("n",n,r):"("+Ts("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return NAe(e,t,r);if(t.indexOf("%")!==-1)return SAe(e,t,r);if(t.indexOf("E")!==-1)return QL(t,r);if(t.charCodeAt(0)===36)return"$"+Ts(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+is(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:ha(t.substr(0,t.length-a.length))+a;if(i=t.match(XL))return _Ae(i,c,u);if(t.match(/^#+0+$/))return u+is(c,t.length-t.indexOf("0"));if(i=t.match(KL))return a=(""+r).replace(/^([^\.]+)$/,"$1."+ha(i[1])).replace(/\.$/,"."+ha(i[1])),a=a.replace(/\.(\d*)$/,function(x,p){return"."+p+Ir("0",ha(i[1]).length-p.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+dl(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ts(e,t,-r):dl(""+r)+"."+Ir("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Ts(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=rd(Ts(e,t.replace(/[\\-]/g,""),r)),s=0,rd(rd(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):x==="0"?"0":""}));if(t.match(JL))return a=Ts(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),l=cv(c,Math.pow(10,s)-1,!1),a=""+u,d=jo("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+i[2]+"/"+i[3],d=ov(l[2],s),d.length<i[4].length&&(d=ha(i[4].substr(i[4].length-d.length))+d),a+=d,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),l=cv(c,Math.pow(10,s)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?GS(l[1],s)+i[2]+"/"+i[3]+ov(l[2],s):Ir(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:ha(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var f=t.indexOf(".")-s,h=t.length-a.length-f;return ha(t.substr(0,f)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ts(e,t,-r):dl(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?is(0,3-x.length):"")+x})+"."+is(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=dl(""+c);return m!=="0"?u+m:"";default:if(t.match(/\.[0#?]*$/))return Ts(e,t.slice(0,t.lastIndexOf(".")),r)+ha(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function jo(e,t,r){return(r|0)===r?Ts(e,t,r):bi(e,t,r)}function EAe(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var eB=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function uu(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":lv(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(eB))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function TAe(e,t,r,n){for(var a=[],i="",s=0,l="",c="t",u,d,f,h="H";s<e.length;)switch(l=e.charAt(s)){case"G":if(!lv(e,s))throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(f=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(f);a[a.length]={t:"t",v:i},++s;break;case"\\":var m=e.charAt(++s),x=m==="("||m===")"?m:"t";a[a.length]={t:x,v:m},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(u==null&&(u=ul(t,r,e.charAt(s+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},c=l,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=ul(t,r),u==null))return"";for(i=l;++s<e.length&&e.charAt(s).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=h),a[a.length]={t:l,v:i},c=l;break;case"A":case"a":case"":var p={t:l,v:l};if(u==null&&(u=ul(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",h="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",s+=5,h="h"):e.substr(s,5).toUpperCase()==="/"?(u!=null&&(p.v=u.H>=12?"":""),p.t="T",s+=5,h="h"):(p.t="t",++s),u==null&&p.t==="T")return"";a[a.length]=p,c=l;break;case"[":for(i=l;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(eB)){if(u==null&&(u=ul(t,r),u==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",uu(e)||(a[a.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=l;++s<e.length&&(l=e.charAt(s))==="0";)i+=l;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++s<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(s))>-1;)i+=l;a[a.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++s)===l;)i+=l;a[a.length]={t:l,v:i},c=l;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:l,v:l},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"t",v:l},++s;break}var g=0,v=0,y;for(s=a.length-1,c="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=h,c="h",g<1&&(g=1);break;case"s":(y=a[s].v.match(/\.0+$/))&&(v=Math.max(v,y[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=a[s].t;break;case"m":c==="s"&&(a[s].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&a[s].v.match(/[Hh]/)&&(g=1),g<2&&a[s].v.match(/[Mm]/)&&(g=2),g<3&&a[s].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var b="",w;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=vAe(a[s].t.charCodeAt(0),a[s].v,u,v),a[s].t="t";break;case"n":case"?":for(w=s+1;a[w]!=null&&((l=a[w].t)==="?"||l==="D"||(l===" "||l==="t")&&a[w+1]!=null&&(a[w+1].t==="?"||a[w+1].t==="t"&&a[w+1].v==="/")||a[s].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[w].v==="/"||a[w].v===" "&&a[w+1]!=null&&a[w+1].t=="?"));)a[s].v+=a[w].v,a[w]={v:"",t:";"},++w;b+=a[s].v,s=w-1;break;case"G":a[s].t="t",a[s].v=Wc(t,r);break}var _="",D,j;if(b.length>0){b.charCodeAt(0)==40?(D=t<0&&b.charCodeAt(0)===45?-t:t,j=jo("n",b,D)):(D=t<0&&n>1?-t:t,j=jo("n",b,D),D<0&&a[0]&&a[0].t=="t"&&(j=j.substr(1),a[0].v="-"+a[0].v)),w=j.length-1;var N=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){N=s;break}var S=a.length;if(N===a.length&&j.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(w>=a[s].v.length-1?(w-=a[s].v.length,a[s].v=j.substr(w+1,a[s].v.length)):w<0?a[s].v="":(a[s].v=j.substr(0,w+1),w=-1),a[s].t="t",S=s);w>=0&&S<a.length&&(a[S].v=j.substr(0,w+1)+a[S].v)}else if(N!==a.length&&j.indexOf("E")===-1){for(w=j.indexOf(".")-1,s=N;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(d=a[s].v.indexOf(".")>-1&&s===N?a[s].v.indexOf(".")-1:a[s].v.length-1,_=a[s].v.substr(d+1);d>=0;--d)w>=0&&(a[s].v.charAt(d)==="0"||a[s].v.charAt(d)==="#")&&(_=j.charAt(w--)+_);a[s].v=_,a[s].t="t",S=s}for(w>=0&&S<a.length&&(a[S].v=j.substr(0,w+1)+a[S].v),w=j.indexOf(".")+1,s=N;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==N)){for(d=a[s].v.indexOf(".")>-1&&s===N?a[s].v.indexOf(".")+1:0,_=a[s].v.substr(0,d);d<a[s].v.length;++d)w<j.length&&(_+=j.charAt(w++));a[s].v=_,a[s].t="t",S=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(D=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=jo(a[s].t,a[s].v,D),a[s].t="t");var E="";for(s=0;s!==a.length;++s)a[s]!=null&&(E+=a[s].v);return E}var TF=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function kF(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function kAe(e,t){var r=EAe(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(TF),l=r[1].match(TF);return kF(t,s)?[n,r[0]]:kF(t,l)?[n,r[1]]:[n,r[s!=null&&l!=null?2:1]]}return[n,i]}function li(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:dt)[e],n==null&&(n=r.table&&r.table[NF[e]]||dt[NF[e]]),n==null&&(n=dAe[e]||"General");break}if(lv(n,0))return Wc(t,r);t instanceof Date&&(t=qL(t,r.date1904));var a=kAe(n,t);if(lv(a[1]))return Wc(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return TAe(a[1],t,r,a[0])}function Us(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(dt[r]==null){t<0&&(t=r);continue}if(dt[r]==e){t=r;break}}t<0&&(t=391)}return dt[t]=e,t}function nx(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Us(e[t],t)}function Ef(){dt=uAe()}var tB={format:li,load:Us,_table:dt,load_table:nx,parse_date_code:ul,is_date:uu,get_table:function(){return tB._table=dt}},CAe={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},rB=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function AAe(e){var t=typeof e=="number"?dt[e]:e;return t=t.replace(rB,"(\\d+)"),new RegExp("^"+t+"$")}function OAe(e,t,r){var n=-1,a=-1,i=-1,s=-1,l=-1,c=-1;(t.match(rB)||[]).forEach(function(f,h){var m=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=m;break;case"d":i=m;break;case"h":s=m;break;case"s":c=m;break;case"m":s>=0?l=m:a=m;break}}),c>=0&&l==-1&&a>=0&&(l=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&l==-1&&c==-1?u:n==-1&&a==-1&&i==-1?d:u+"T"+d}var FAe=function(){var e={};e.version="1.2.0";function t(){for(var j=0,N=new Array(256),S=0;S!=256;++S)j=S,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,N[S]=j;return typeof Int32Array<"u"?new Int32Array(N):N}var r=t();function n(j){var N=0,S=0,E=0,A=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(E=0;E!=256;++E)A[E]=j[E];for(E=0;E!=256;++E)for(S=j[E],N=256+E;N<4096;N+=256)S=A[N]=S>>>8^j[S&255];var T=[];for(E=1;E!=16;++E)T[E-1]=typeof Int32Array<"u"?A.subarray(E*256,E*256+256):A.slice(E*256,E*256+256);return T}var a=n(r),i=a[0],s=a[1],l=a[2],c=a[3],u=a[4],d=a[5],f=a[6],h=a[7],m=a[8],x=a[9],p=a[10],g=a[11],v=a[12],y=a[13],b=a[14];function w(j,N){for(var S=N^-1,E=0,A=j.length;E<A;)S=S>>>8^r[(S^j.charCodeAt(E++))&255];return~S}function _(j,N){for(var S=N^-1,E=j.length-15,A=0;A<E;)S=b[j[A++]^S&255]^y[j[A++]^S>>8&255]^v[j[A++]^S>>16&255]^g[j[A++]^S>>>24]^p[j[A++]]^x[j[A++]]^m[j[A++]]^h[j[A++]]^f[j[A++]]^d[j[A++]]^u[j[A++]]^c[j[A++]]^l[j[A++]]^s[j[A++]]^i[j[A++]]^r[j[A++]];for(E+=15;A<E;)S=S>>>8^r[(S^j[A++])&255];return~S}function D(j,N){for(var S=N^-1,E=0,A=j.length,T=0,L=0;E<A;)T=j.charCodeAt(E++),T<128?S=S>>>8^r[(S^T)&255]:T<2048?(S=S>>>8^r[(S^(192|T>>6&31))&255],S=S>>>8^r[(S^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,L=j.charCodeAt(E++)&1023,S=S>>>8^r[(S^(240|T>>8&7))&255],S=S>>>8^r[(S^(128|T>>2&63))&255],S=S>>>8^r[(S^(128|L>>6&15|(T&3)<<4))&255],S=S>>>8^r[(S^(128|L&63))&255]):(S=S>>>8^r[(S^(224|T>>12&15))&255],S=S>>>8^r[(S^(128|T>>6&63))&255],S=S>>>8^r[(S^(128|T&63))&255]);return~S}return e.table=r,e.bstr=w,e.buf=_,e.str=D,e}(),it=function(){var t={};t.version="1.2.1";function r(Z,he){for(var de=Z.split("/"),fe=he.split("/"),xe=0,ve=0,_e=Math.min(de.length,fe.length);xe<_e;++xe){if(ve=de[xe].length-fe[xe].length)return ve;if(de[xe]!=fe[xe])return de[xe]<fe[xe]?-1:1}return de.length-fe.length}function n(Z){if(Z.charAt(Z.length-1)=="/")return Z.slice(0,-1).indexOf("/")===-1?Z:n(Z.slice(0,-1));var he=Z.lastIndexOf("/");return he===-1?Z:Z.slice(0,he+1)}function a(Z){if(Z.charAt(Z.length-1)=="/")return a(Z.slice(0,-1));var he=Z.lastIndexOf("/");return he===-1?Z:Z.slice(he+1)}function i(Z,he){typeof he=="string"&&(he=new Date(he));var de=he.getHours();de=de<<6|he.getMinutes(),de=de<<5|he.getSeconds()>>>1,Z.write_shift(2,de);var fe=he.getFullYear()-1980;fe=fe<<4|he.getMonth()+1,fe=fe<<5|he.getDate(),Z.write_shift(2,fe)}function s(Z){var he=Z.read_shift(2)&65535,de=Z.read_shift(2)&65535,fe=new Date,xe=de&31;de>>>=5;var ve=de&15;de>>>=4,fe.setMilliseconds(0),fe.setFullYear(de+1980),fe.setMonth(ve-1),fe.setDate(xe);var _e=he&31;he>>>=5;var Te=he&63;return he>>>=6,fe.setHours(he),fe.setMinutes(Te),fe.setSeconds(_e<<1),fe}function l(Z){Pn(Z,0);for(var he={},de=0;Z.l<=Z.length-4;){var fe=Z.read_shift(2),xe=Z.read_shift(2),ve=Z.l+xe,_e={};switch(fe){case 21589:de=Z.read_shift(1),de&1&&(_e.mtime=Z.read_shift(4)),xe>5&&(de&2&&(_e.atime=Z.read_shift(4)),de&4&&(_e.ctime=Z.read_shift(4))),_e.mtime&&(_e.mt=new Date(_e.mtime*1e3));break}Z.l=ve,he[fe]=_e}return he}var c;function u(){return c||(c={})}function d(Z,he){if(Z[0]==80&&Z[1]==75)return St(Z,he);if((Z[0]|32)==109&&(Z[1]|32)==105)return Ax(Z,he);if(Z.length<512)throw new Error("CFB file size "+Z.length+" < 512");var de=3,fe=512,xe=0,ve=0,_e=0,Te=0,we=0,De=[],je=Z.slice(0,512);Pn(je,0);var Re=f(je);switch(de=Re[0],de){case 3:fe=512;break;case 4:fe=4096;break;case 0:if(Re[1]==0)return St(Z,he);default:throw new Error("Major Version: Expected 3 or 4 saw "+de)}fe!==512&&(je=Z.slice(0,fe),Pn(je,28));var qe=Z.slice(0,fe);h(je,de);var Ze=je.read_shift(4,"i");if(de===3&&Ze!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ze);je.l+=4,_e=je.read_shift(4,"i"),je.l+=4,je.chk("00100000","Mini Stream Cutoff Size: "),Te=je.read_shift(4,"i"),xe=je.read_shift(4,"i"),we=je.read_shift(4,"i"),ve=je.read_shift(4,"i");for(var Le=-1,Ge=0;Ge<109&&(Le=je.read_shift(4,"i"),!(Le<0));++Ge)De[Ge]=Le;var wt=m(Z,fe);g(we,ve,wt,fe,De);var kr=y(wt,_e,De,fe);kr[_e].name="!Directory",xe>0&&Te!==L&&(kr[Te].name="!MiniFAT"),kr[De[0]].name="!FAT",kr.fat_addrs=De,kr.ssz=fe;var Cr={},Wn=[],zf=[],Hf=[];b(_e,kr,wt,Wn,xe,Cr,zf,Te),x(zf,Hf,Wn),Wn.shift();var Vf={FileIndex:zf,FullPaths:Hf};return he&&he.raw&&(Vf.raw={header:qe,sectors:wt}),Vf}function f(Z){if(Z[Z.l]==80&&Z[Z.l+1]==75)return[0,0];Z.chk(O,"Header Signature: "),Z.l+=16;var he=Z.read_shift(2,"u");return[Z.read_shift(2,"u"),he]}function h(Z,he){var de=9;switch(Z.l+=2,de=Z.read_shift(2)){case 9:if(he!=3)throw new Error("Sector Shift: Expected 9 saw "+de);break;case 12:if(he!=4)throw new Error("Sector Shift: Expected 12 saw "+de);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+de)}Z.chk("0600","Mini Sector Shift: "),Z.chk("000000000000","Reserved: ")}function m(Z,he){for(var de=Math.ceil(Z.length/he)-1,fe=[],xe=1;xe<de;++xe)fe[xe-1]=Z.slice(xe*he,(xe+1)*he);return fe[de-1]=Z.slice(de*he),fe}function x(Z,he,de){for(var fe=0,xe=0,ve=0,_e=0,Te=0,we=de.length,De=[],je=[];fe<we;++fe)De[fe]=je[fe]=fe,he[fe]=de[fe];for(;Te<je.length;++Te)fe=je[Te],xe=Z[fe].L,ve=Z[fe].R,_e=Z[fe].C,De[fe]===fe&&(xe!==-1&&De[xe]!==xe&&(De[fe]=De[xe]),ve!==-1&&De[ve]!==ve&&(De[fe]=De[ve])),_e!==-1&&(De[_e]=fe),xe!==-1&&fe!=De[fe]&&(De[xe]=De[fe],je.lastIndexOf(xe)<Te&&je.push(xe)),ve!==-1&&fe!=De[fe]&&(De[ve]=De[fe],je.lastIndexOf(ve)<Te&&je.push(ve));for(fe=1;fe<we;++fe)De[fe]===fe&&(ve!==-1&&De[ve]!==ve?De[fe]=De[ve]:xe!==-1&&De[xe]!==xe&&(De[fe]=De[xe]));for(fe=1;fe<we;++fe)if(Z[fe].type!==0){if(Te=fe,Te!=De[Te])do Te=De[Te],he[fe]=he[Te]+"/"+he[fe];while(Te!==0&&De[Te]!==-1&&Te!=De[Te]);De[fe]=-1}for(he[0]+="/",fe=1;fe<we;++fe)Z[fe].type!==2&&(he[fe]+="/")}function p(Z,he,de){for(var fe=Z.start,xe=Z.size,ve=[],_e=fe;de&&xe>0&&_e>=0;)ve.push(he.slice(_e*T,_e*T+T)),xe-=T,_e=vc(de,_e*4);return ve.length===0?Se(0):bn(ve).slice(0,Z.size)}function g(Z,he,de,fe,xe){var ve=L;if(Z===L){if(he!==0)throw new Error("DIFAT chain shorter than expected")}else if(Z!==-1){var _e=de[Z],Te=(fe>>>2)-1;if(!_e)return;for(var we=0;we<Te&&(ve=vc(_e,we*4))!==L;++we)xe.push(ve);g(vc(_e,fe-4),he-1,de,fe,xe)}}function v(Z,he,de,fe,xe){var ve=[],_e=[];xe||(xe=[]);var Te=fe-1,we=0,De=0;for(we=he;we>=0;){xe[we]=!0,ve[ve.length]=we,_e.push(Z[we]);var je=de[Math.floor(we*4/fe)];if(De=we*4&Te,fe<4+De)throw new Error("FAT boundary crossed: "+we+" 4 "+fe);if(!Z[je])break;we=vc(Z[je],De)}return{nodes:ve,data:BF([_e])}}function y(Z,he,de,fe){var xe=Z.length,ve=[],_e=[],Te=[],we=[],De=fe-1,je=0,Re=0,qe=0,Ze=0;for(je=0;je<xe;++je)if(Te=[],qe=je+he,qe>=xe&&(qe-=xe),!_e[qe]){we=[];var Le=[];for(Re=qe;Re>=0;){Le[Re]=!0,_e[Re]=!0,Te[Te.length]=Re,we.push(Z[Re]);var Ge=de[Math.floor(Re*4/fe)];if(Ze=Re*4&De,fe<4+Ze)throw new Error("FAT boundary crossed: "+Re+" 4 "+fe);if(!Z[Ge]||(Re=vc(Z[Ge],Ze),Le[Re]))break}ve[qe]={nodes:Te,data:BF([we])}}return ve}function b(Z,he,de,fe,xe,ve,_e,Te){for(var we=0,De=fe.length?2:0,je=he[Z].data,Re=0,qe=0,Ze;Re<je.length;Re+=128){var Le=je.slice(Re,Re+128);Pn(Le,64),qe=Le.read_shift(2),Ze=jb(Le,0,qe-De),fe.push(Ze);var Ge={name:Ze,type:Le.read_shift(1),color:Le.read_shift(1),L:Le.read_shift(4,"i"),R:Le.read_shift(4,"i"),C:Le.read_shift(4,"i"),clsid:Le.read_shift(16),state:Le.read_shift(4,"i"),start:0,size:0},wt=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);wt!==0&&(Ge.ct=w(Le,Le.l-8));var kr=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);kr!==0&&(Ge.mt=w(Le,Le.l-8)),Ge.start=Le.read_shift(4,"i"),Ge.size=Le.read_shift(4,"i"),Ge.size<0&&Ge.start<0&&(Ge.size=Ge.type=0,Ge.start=L,Ge.name=""),Ge.type===5?(we=Ge.start,xe>0&&we!==L&&(he[we].name="!StreamData")):Ge.size>=4096?(Ge.storage="fat",he[Ge.start]===void 0&&(he[Ge.start]=v(de,Ge.start,he.fat_addrs,he.ssz)),he[Ge.start].name=Ge.name,Ge.content=he[Ge.start].data.slice(0,Ge.size)):(Ge.storage="minifat",Ge.size<0?Ge.size=0:we!==L&&Ge.start!==L&&he[we]&&(Ge.content=p(Ge,he[we].data,(he[Te]||{}).data))),Ge.content&&Pn(Ge.content,0),ve[Ze]=Ge,_e.push(Ge)}}function w(Z,he){return new Date((yn(Z,he+4)/1e7*Math.pow(2,32)+yn(Z,he)/1e7-11644473600)*1e3)}function _(Z,he){return u(),d(c.readFileSync(Z),he)}function D(Z,he){var de=he&&he.type;switch(de||Tt&&Buffer.isBuffer(Z)&&(de="buffer"),de||"base64"){case"file":return _(Z,he);case"base64":return d(Za(oi(Z)),he);case"binary":return d(Za(Z),he)}return d(Z,he)}function j(Z,he){var de=he||{},fe=de.root||"Root Entry";if(Z.FullPaths||(Z.FullPaths=[]),Z.FileIndex||(Z.FileIndex=[]),Z.FullPaths.length!==Z.FileIndex.length)throw new Error("inconsistent CFB structure");Z.FullPaths.length===0&&(Z.FullPaths[0]=fe+"/",Z.FileIndex[0]={name:fe,type:5}),de.CLSID&&(Z.FileIndex[0].clsid=de.CLSID),N(Z)}function N(Z){var he="Sh33tJ5";if(!it.find(Z,"/"+he)){var de=Se(4);de[0]=55,de[1]=de[3]=50,de[2]=54,Z.FileIndex.push({name:he,type:2,content:de,size:4,L:69,R:69,C:69}),Z.FullPaths.push(Z.FullPaths[0]+he),S(Z)}}function S(Z,he){j(Z);for(var de=!1,fe=!1,xe=Z.FullPaths.length-1;xe>=0;--xe){var ve=Z.FileIndex[xe];switch(ve.type){case 0:fe?de=!0:(Z.FileIndex.pop(),Z.FullPaths.pop());break;case 1:case 2:case 5:fe=!0,isNaN(ve.R*ve.L*ve.C)&&(de=!0),ve.R>-1&&ve.L>-1&&ve.R==ve.L&&(de=!0);break;default:de=!0;break}}if(!(!de&&!he)){var _e=new Date(1987,1,19),Te=0,we=Object.create?Object.create(null):{},De=[];for(xe=0;xe<Z.FullPaths.length;++xe)we[Z.FullPaths[xe]]=!0,Z.FileIndex[xe].type!==0&&De.push([Z.FullPaths[xe],Z.FileIndex[xe]]);for(xe=0;xe<De.length;++xe){var je=n(De[xe][0]);fe=we[je],fe||(De.push([je,{name:a(je).replace("/",""),type:1,clsid:W,ct:_e,mt:_e,content:null}]),we[je]=!0)}for(De.sort(function(Ze,Le){return r(Ze[0],Le[0])}),Z.FullPaths=[],Z.FileIndex=[],xe=0;xe<De.length;++xe)Z.FullPaths[xe]=De[xe][0],Z.FileIndex[xe]=De[xe][1];for(xe=0;xe<De.length;++xe){var Re=Z.FileIndex[xe],qe=Z.FullPaths[xe];if(Re.name=a(qe).replace("/",""),Re.L=Re.R=Re.C=-(Re.color=1),Re.size=Re.content?Re.content.length:0,Re.start=0,Re.clsid=Re.clsid||W,xe===0)Re.C=De.length>1?1:-1,Re.size=0,Re.type=5;else if(qe.slice(-1)=="/"){for(Te=xe+1;Te<De.length&&n(Z.FullPaths[Te])!=qe;++Te);for(Re.C=Te>=De.length?-1:Te,Te=xe+1;Te<De.length&&n(Z.FullPaths[Te])!=n(qe);++Te);Re.R=Te>=De.length?-1:Te,Re.type=1}else n(Z.FullPaths[xe+1]||"")==n(qe)&&(Re.R=xe+1),Re.type=2}}}function E(Z,he){var de=he||{};if(de.fileType=="mad")return Ae(Z,de);switch(S(Z),de.fileType){case"zip":return kn(Z,de)}var fe=function(Ze){for(var Le=0,Ge=0,wt=0;wt<Ze.FileIndex.length;++wt){var kr=Ze.FileIndex[wt];if(kr.content){var Cr=kr.content.length;Cr>0&&(Cr<4096?Le+=Cr+63>>6:Ge+=Cr+511>>9)}}for(var Wn=Ze.FullPaths.length+3>>2,zf=Le+7>>3,Hf=Le+127>>7,Vf=zf+Ge+Wn+Hf,rc=Vf+127>>7,U1=rc<=109?0:Math.ceil((rc-109)/127);Vf+rc+U1+127>>7>rc;)U1=++rc<=109?0:Math.ceil((rc-109)/127);var to=[1,U1,rc,Hf,Wn,Ge,Le,0];return Ze.FileIndex[0].size=Le<<6,to[7]=(Ze.FileIndex[0].start=to[0]+to[1]+to[2]+to[3]+to[4]+to[5])+(to[6]+7>>3),to}(Z),xe=Se(fe[7]<<9),ve=0,_e=0;{for(ve=0;ve<8;++ve)xe.write_shift(1,V[ve]);for(ve=0;ve<8;++ve)xe.write_shift(2,0);for(xe.write_shift(2,62),xe.write_shift(2,3),xe.write_shift(2,65534),xe.write_shift(2,9),xe.write_shift(2,6),ve=0;ve<3;++ve)xe.write_shift(2,0);for(xe.write_shift(4,0),xe.write_shift(4,fe[2]),xe.write_shift(4,fe[0]+fe[1]+fe[2]+fe[3]-1),xe.write_shift(4,0),xe.write_shift(4,4096),xe.write_shift(4,fe[3]?fe[0]+fe[1]+fe[2]-1:L),xe.write_shift(4,fe[3]),xe.write_shift(-4,fe[1]?fe[0]-1:L),xe.write_shift(4,fe[1]),ve=0;ve<109;++ve)xe.write_shift(-4,ve<fe[2]?fe[1]+ve:-1)}if(fe[1])for(_e=0;_e<fe[1];++_e){for(;ve<236+_e*127;++ve)xe.write_shift(-4,ve<fe[2]?fe[1]+ve:-1);xe.write_shift(-4,_e===fe[1]-1?L:_e+1)}var Te=function(Ze){for(_e+=Ze;ve<_e-1;++ve)xe.write_shift(-4,ve+1);Ze&&(++ve,xe.write_shift(-4,L))};for(_e=ve=0,_e+=fe[1];ve<_e;++ve)xe.write_shift(-4,B.DIFSECT);for(_e+=fe[2];ve<_e;++ve)xe.write_shift(-4,B.FATSECT);Te(fe[3]),Te(fe[4]);for(var we=0,De=0,je=Z.FileIndex[0];we<Z.FileIndex.length;++we)je=Z.FileIndex[we],je.content&&(De=je.content.length,!(De<4096)&&(je.start=_e,Te(De+511>>9)));for(Te(fe[6]+7>>3);xe.l&511;)xe.write_shift(-4,B.ENDOFCHAIN);for(_e=ve=0,we=0;we<Z.FileIndex.length;++we)je=Z.FileIndex[we],je.content&&(De=je.content.length,!(!De||De>=4096)&&(je.start=_e,Te(De+63>>6)));for(;xe.l&511;)xe.write_shift(-4,B.ENDOFCHAIN);for(ve=0;ve<fe[4]<<2;++ve){var Re=Z.FullPaths[ve];if(!Re||Re.length===0){for(we=0;we<17;++we)xe.write_shift(4,0);for(we=0;we<3;++we)xe.write_shift(4,-1);for(we=0;we<12;++we)xe.write_shift(4,0);continue}je=Z.FileIndex[ve],ve===0&&(je.start=je.size?je.start-1:L);var qe=ve===0&&de.root||je.name;if(De=2*(qe.length+1),xe.write_shift(64,qe,"utf16le"),xe.write_shift(2,De),xe.write_shift(1,je.type),xe.write_shift(1,je.color),xe.write_shift(-4,je.L),xe.write_shift(-4,je.R),xe.write_shift(-4,je.C),je.clsid)xe.write_shift(16,je.clsid,"hex");else for(we=0;we<4;++we)xe.write_shift(4,0);xe.write_shift(4,je.state||0),xe.write_shift(4,0),xe.write_shift(4,0),xe.write_shift(4,0),xe.write_shift(4,0),xe.write_shift(4,je.start),xe.write_shift(4,je.size),xe.write_shift(4,0)}for(ve=1;ve<Z.FileIndex.length;++ve)if(je=Z.FileIndex[ve],je.size>=4096)if(xe.l=je.start+1<<9,Tt&&Buffer.isBuffer(je.content))je.content.copy(xe,xe.l,0,je.size),xe.l+=je.size+511&-512;else{for(we=0;we<je.size;++we)xe.write_shift(1,je.content[we]);for(;we&511;++we)xe.write_shift(1,0)}for(ve=1;ve<Z.FileIndex.length;++ve)if(je=Z.FileIndex[ve],je.size>0&&je.size<4096)if(Tt&&Buffer.isBuffer(je.content))je.content.copy(xe,xe.l,0,je.size),xe.l+=je.size+63&-64;else{for(we=0;we<je.size;++we)xe.write_shift(1,je.content[we]);for(;we&63;++we)xe.write_shift(1,0)}if(Tt)xe.l=xe.length;else for(;xe.l<xe.length;)xe.write_shift(1,0);return xe}function A(Z,he){var de=Z.FullPaths.map(function(we){return we.toUpperCase()}),fe=de.map(function(we){var De=we.split("/");return De[De.length-(we.slice(-1)=="/"?2:1)]}),xe=!1;he.charCodeAt(0)===47?(xe=!0,he=de[0].slice(0,-1)+he):xe=he.indexOf("/")!==-1;var ve=he.toUpperCase(),_e=xe===!0?de.indexOf(ve):fe.indexOf(ve);if(_e!==-1)return Z.FileIndex[_e];var Te=!ve.match(_h);for(ve=ve.replace(ta,""),Te&&(ve=ve.replace(_h,"!")),_e=0;_e<de.length;++_e)if((Te?de[_e].replace(_h,"!"):de[_e]).replace(ta,"")==ve||(Te?fe[_e].replace(_h,"!"):fe[_e]).replace(ta,"")==ve)return Z.FileIndex[_e];return null}var T=64,L=-2,O="d0cf11e0a1b11ae1",V=[208,207,17,224,161,177,26,225],W="00000000000000000000000000000000",B={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:L,FREESECT:-1,HEADER_SIGNATURE:O,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:W,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function P(Z,he,de){u();var fe=E(Z,de);c.writeFileSync(he,fe)}function F(Z){for(var he=new Array(Z.length),de=0;de<Z.length;++de)he[de]=String.fromCharCode(Z[de]);return he.join("")}function I(Z,he){var de=E(Z,he);switch(he&&he.type||"buffer"){case"file":return u(),c.writeFileSync(he.filename,de),de;case"binary":return typeof de=="string"?de:F(de);case"base64":return Um(typeof de=="string"?de:F(de));case"buffer":if(Tt)return Buffer.isBuffer(de)?de:Ho(de);case"array":return typeof de=="string"?Za(de):de}return de}var R;function C(Z){try{var he=Z.InflateRaw,de=new he;if(de._processChunk(new Uint8Array([3,0]),de._finishFlushFlag),de.bytesRead)R=Z;else throw new Error("zlib does not expose bytesRead")}catch(fe){console.error("cannot use native zlib: "+(fe.message||fe))}}function k(Z,he){if(!R)return bt(Z,he);var de=R.InflateRaw,fe=new de,xe=fe._processChunk(Z.slice(Z.l),fe._finishFlushFlag);return Z.l+=fe.bytesRead,xe}function z(Z){return R?R.deflateRawSync(Z):Pe(Z)}var q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ie(Z){var he=(Z<<1|Z<<11)&139536|(Z<<5|Z<<15)&558144;return(he>>16|he>>8|he)&255}for(var ee=typeof Uint8Array<"u",ae=ee?new Uint8Array(256):[],pe=0;pe<256;++pe)ae[pe]=ie(pe);function H(Z,he){var de=ae[Z&255];return he<=8?de>>>8-he:(de=de<<8|ae[Z>>8&255],he<=16?de>>>16-he:(de=de<<8|ae[Z>>16&255],de>>>24-he))}function ne(Z,he){var de=he&7,fe=he>>>3;return(Z[fe]|(de<=6?0:Z[fe+1]<<8))>>>de&3}function U(Z,he){var de=he&7,fe=he>>>3;return(Z[fe]|(de<=5?0:Z[fe+1]<<8))>>>de&7}function le(Z,he){var de=he&7,fe=he>>>3;return(Z[fe]|(de<=4?0:Z[fe+1]<<8))>>>de&15}function re(Z,he){var de=he&7,fe=he>>>3;return(Z[fe]|(de<=3?0:Z[fe+1]<<8))>>>de&31}function X(Z,he){var de=he&7,fe=he>>>3;return(Z[fe]|(de<=1?0:Z[fe+1]<<8))>>>de&127}function G(Z,he,de){var fe=he&7,xe=he>>>3,ve=(1<<de)-1,_e=Z[xe]>>>fe;return de<8-fe||(_e|=Z[xe+1]<<8-fe,de<16-fe)||(_e|=Z[xe+2]<<16-fe,de<24-fe)||(_e|=Z[xe+3]<<24-fe),_e&ve}function ce(Z,he,de){var fe=he&7,xe=he>>>3;return fe<=5?Z[xe]|=(de&7)<<fe:(Z[xe]|=de<<fe&255,Z[xe+1]=(de&7)>>8-fe),he+3}function J(Z,he,de){var fe=he&7,xe=he>>>3;return de=(de&1)<<fe,Z[xe]|=de,he+1}function ue(Z,he,de){var fe=he&7,xe=he>>>3;return de<<=fe,Z[xe]|=de&255,de>>>=8,Z[xe+1]=de,he+8}function me(Z,he,de){var fe=he&7,xe=he>>>3;return de<<=fe,Z[xe]|=de&255,de>>>=8,Z[xe+1]=de&255,Z[xe+2]=de>>>8,he+16}function te(Z,he){var de=Z.length,fe=2*de>he?2*de:he+5,xe=0;if(de>=he)return Z;if(Tt){var ve=_F(fe);if(Z.copy)Z.copy(ve);else for(;xe<Z.length;++xe)ve[xe]=Z[xe];return ve}else if(ee){var _e=new Uint8Array(fe);if(_e.set)_e.set(Z);else for(;xe<de;++xe)_e[xe]=Z[xe];return _e}return Z.length=fe,Z}function oe(Z){for(var he=new Array(Z),de=0;de<Z;++de)he[de]=0;return he}function ge(Z,he,de){var fe=1,xe=0,ve=0,_e=0,Te=0,we=Z.length,De=ee?new Uint16Array(32):oe(32);for(ve=0;ve<32;++ve)De[ve]=0;for(ve=we;ve<de;++ve)Z[ve]=0;we=Z.length;var je=ee?new Uint16Array(we):oe(we);for(ve=0;ve<we;++ve)De[xe=Z[ve]]++,fe<xe&&(fe=xe),je[ve]=0;for(De[0]=0,ve=1;ve<=fe;++ve)De[ve+16]=Te=Te+De[ve-1]<<1;for(ve=0;ve<we;++ve)Te=Z[ve],Te!=0&&(je[ve]=De[Te+16]++);var Re=0;for(ve=0;ve<we;++ve)if(Re=Z[ve],Re!=0)for(Te=H(je[ve],fe)>>fe-Re,_e=(1<<fe+4-Re)-1;_e>=0;--_e)he[Te|_e<<Re]=Re&15|ve<<4;return fe}var ye=ee?new Uint16Array(512):oe(512),Ce=ee?new Uint16Array(32):oe(32);if(!ee){for(var Ie=0;Ie<512;++Ie)ye[Ie]=0;for(Ie=0;Ie<32;++Ie)Ce[Ie]=0}(function(){for(var Z=[],he=0;he<32;he++)Z.push(5);ge(Z,Ce,32);var de=[];for(he=0;he<=143;he++)de.push(8);for(;he<=255;he++)de.push(9);for(;he<=279;he++)de.push(7);for(;he<=287;he++)de.push(8);ge(de,ye,288)})();var rt=function(){for(var he=ee?new Uint8Array(32768):[],de=0,fe=0;de<se.length-1;++de)for(;fe<se[de+1];++fe)he[fe]=de;for(;fe<32768;++fe)he[fe]=29;var xe=ee?new Uint8Array(259):[];for(de=0,fe=0;de<K.length-1;++de)for(;fe<K[de+1];++fe)xe[fe]=de;function ve(Te,we){for(var De=0;De<Te.length;){var je=Math.min(65535,Te.length-De),Re=De+je==Te.length;for(we.write_shift(1,+Re),we.write_shift(2,je),we.write_shift(2,~je&65535);je-- >0;)we[we.l++]=Te[De++]}return we.l}function _e(Te,we){for(var De=0,je=0,Re=ee?new Uint16Array(32768):[];je<Te.length;){var qe=Math.min(65535,Te.length-je);if(qe<10){for(De=ce(we,De,+(je+qe==Te.length)),De&7&&(De+=8-(De&7)),we.l=De/8|0,we.write_shift(2,qe),we.write_shift(2,~qe&65535);qe-- >0;)we[we.l++]=Te[je++];De=we.l*8;continue}De=ce(we,De,+(je+qe==Te.length)+2);for(var Ze=0;qe-- >0;){var Le=Te[je];Ze=(Ze<<5^Le)&32767;var Ge=-1,wt=0;if((Ge=Re[Ze])&&(Ge|=je&-32768,Ge>je&&(Ge-=32768),Ge<je))for(;Te[Ge+wt]==Te[je+wt]&&wt<250;)++wt;if(wt>2){Le=xe[wt],Le<=22?De=ue(we,De,ae[Le+1]>>1)-1:(ue(we,De,3),De+=5,ue(we,De,ae[Le-23]>>5),De+=3);var kr=Le<8?0:Le-4>>2;kr>0&&(me(we,De,wt-K[Le]),De+=kr),Le=he[je-Ge],De=ue(we,De,ae[Le]>>3),De-=3;var Cr=Le<4?0:Le-2>>1;Cr>0&&(me(we,De,je-Ge-se[Le]),De+=Cr);for(var Wn=0;Wn<wt;++Wn)Re[Ze]=je&32767,Ze=(Ze<<5^Te[je])&32767,++je;qe-=wt-1}else Le<=143?Le=Le+48:De=J(we,De,1),De=ue(we,De,ae[Le]),Re[Ze]=je&32767,++je}De=ue(we,De,0)-1}return we.l=(De+7)/8|0,we.l}return function(we,De){return we.length<8?ve(we,De):_e(we,De)}}();function Pe(Z){var he=Se(50+Math.floor(Z.length*1.1)),de=rt(Z,he);return he.slice(0,de)}var Ke=ee?new Uint16Array(32768):oe(32768),lt=ee?new Uint16Array(32768):oe(32768),nt=ee?new Uint16Array(128):oe(128),nr=1,za=1;function Bn(Z,he){var de=re(Z,he)+257;he+=5;var fe=re(Z,he)+1;he+=5;var xe=le(Z,he)+4;he+=4;for(var ve=0,_e=ee?new Uint8Array(19):oe(19),Te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],we=1,De=ee?new Uint8Array(8):oe(8),je=ee?new Uint8Array(8):oe(8),Re=_e.length,qe=0;qe<xe;++qe)_e[q[qe]]=ve=U(Z,he),we<ve&&(we=ve),De[ve]++,he+=3;var Ze=0;for(De[0]=0,qe=1;qe<=we;++qe)je[qe]=Ze=Ze+De[qe-1]<<1;for(qe=0;qe<Re;++qe)(Ze=_e[qe])!=0&&(Te[qe]=je[Ze]++);var Le=0;for(qe=0;qe<Re;++qe)if(Le=_e[qe],Le!=0){Ze=ae[Te[qe]]>>8-Le;for(var Ge=(1<<7-Le)-1;Ge>=0;--Ge)nt[Ze|Ge<<Le]=Le&7|qe<<3}var wt=[];for(we=1;wt.length<de+fe;)switch(Ze=nt[X(Z,he)],he+=Ze&7,Ze>>>=3){case 16:for(ve=3+ne(Z,he),he+=2,Ze=wt[wt.length-1];ve-- >0;)wt.push(Ze);break;case 17:for(ve=3+U(Z,he),he+=3;ve-- >0;)wt.push(0);break;case 18:for(ve=11+X(Z,he),he+=7;ve-- >0;)wt.push(0);break;default:wt.push(Ze),we<Ze&&(we=Ze);break}var kr=wt.slice(0,de),Cr=wt.slice(de);for(qe=de;qe<286;++qe)kr[qe]=0;for(qe=fe;qe<30;++qe)Cr[qe]=0;return nr=ge(kr,Ke,286),za=ge(Cr,lt,30),he}function at(Z,he){if(Z[0]==3&&!(Z[1]&3))return[El(he),2];for(var de=0,fe=0,xe=_F(he||1<<18),ve=0,_e=xe.length>>>0,Te=0,we=0;!(fe&1);){if(fe=U(Z,de),de+=3,fe>>>1)fe>>1==1?(Te=9,we=5):(de=Bn(Z,de),Te=nr,we=za);else{de&7&&(de+=8-(de&7));var De=Z[de>>>3]|Z[(de>>>3)+1]<<8;if(de+=32,De>0)for(!he&&_e<ve+De&&(xe=te(xe,ve+De),_e=xe.length);De-- >0;)xe[ve++]=Z[de>>>3],de+=8;continue}for(;;){!he&&_e<ve+32767&&(xe=te(xe,ve+32767),_e=xe.length);var je=G(Z,de,Te),Re=fe>>>1==1?ye[je]:Ke[je];if(de+=Re&15,Re>>>=4,!(Re>>>8&255))xe[ve++]=Re;else{if(Re==256)break;Re-=257;var qe=Re<8?0:Re-4>>2;qe>5&&(qe=0);var Ze=ve+K[Re];qe>0&&(Ze+=G(Z,de,qe),de+=qe),je=G(Z,de,we),Re=fe>>>1==1?Ce[je]:lt[je],de+=Re&15,Re>>>=4;var Le=Re<4?0:Re-2>>1,Ge=se[Re];for(Le>0&&(Ge+=G(Z,de,Le),de+=Le),!he&&_e<Ze&&(xe=te(xe,Ze+100),_e=xe.length);ve<Ze;)xe[ve]=xe[ve-Ge],++ve}}}return he?[xe,de+7>>>3]:[xe.slice(0,ve),de+7>>>3]}function bt(Z,he){var de=Z.slice(Z.l||0),fe=at(de,he);return Z.l+=fe[1],fe[0]}function Mt(Z,he){if(Z)typeof console<"u"&&console.error(he);else throw new Error(he)}function St(Z,he){var de=Z;Pn(de,0);var fe=[],xe=[],ve={FileIndex:fe,FullPaths:xe};j(ve,{root:he.root});for(var _e=de.length-4;(de[_e]!=80||de[_e+1]!=75||de[_e+2]!=5||de[_e+3]!=6)&&_e>=0;)--_e;de.l=_e+4,de.l+=4;var Te=de.read_shift(2);de.l+=6;var we=de.read_shift(4);for(de.l=we,_e=0;_e<Te;++_e){de.l+=20;var De=de.read_shift(4),je=de.read_shift(4),Re=de.read_shift(2),qe=de.read_shift(2),Ze=de.read_shift(2);de.l+=8;var Le=de.read_shift(4),Ge=l(de.slice(de.l+Re,de.l+Re+qe));de.l+=Re+qe+Ze;var wt=de.l;de.l=Le+4,Ha(de,De,je,ve,Ge),de.l=wt}return ve}function Ha(Z,he,de,fe,xe){Z.l+=2;var ve=Z.read_shift(2),_e=Z.read_shift(2),Te=s(Z);if(ve&8257)throw new Error("Unsupported ZIP encryption");for(var we=Z.read_shift(4),De=Z.read_shift(4),je=Z.read_shift(4),Re=Z.read_shift(2),qe=Z.read_shift(2),Ze="",Le=0;Le<Re;++Le)Ze+=String.fromCharCode(Z[Z.l++]);if(qe){var Ge=l(Z.slice(Z.l,Z.l+qe));(Ge[21589]||{}).mt&&(Te=Ge[21589].mt),((xe||{})[21589]||{}).mt&&(Te=xe[21589].mt)}Z.l+=qe;var wt=Z.slice(Z.l,Z.l+De);switch(_e){case 8:wt=k(Z,je);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+_e)}var kr=!1;ve&8&&(we=Z.read_shift(4),we==134695760&&(we=Z.read_shift(4),kr=!0),De=Z.read_shift(4),je=Z.read_shift(4)),De!=he&&Mt(kr,"Bad compressed size: "+he+" != "+De),je!=de&&Mt(kr,"Bad uncompressed size: "+de+" != "+je),$e(fe,Ze,wt,{unsafe:!0,mt:Te})}function kn(Z,he){var de=he||{},fe=[],xe=[],ve=Se(1),_e=de.compression?8:0,Te=0,we=0,De=0,je=0,Re=0,qe=Z.FullPaths[0],Ze=qe,Le=Z.FileIndex[0],Ge=[],wt=0;for(we=1;we<Z.FullPaths.length;++we)if(Ze=Z.FullPaths[we].slice(qe.length),Le=Z.FileIndex[we],!(!Le.size||!Le.content||Ze=="Sh33tJ5")){var kr=je,Cr=Se(Ze.length);for(De=0;De<Ze.length;++De)Cr.write_shift(1,Ze.charCodeAt(De)&127);Cr=Cr.slice(0,Cr.l),Ge[Re]=FAe.buf(Le.content,0);var Wn=Le.content;_e==8&&(Wn=z(Wn)),ve=Se(30),ve.write_shift(4,67324752),ve.write_shift(2,20),ve.write_shift(2,Te),ve.write_shift(2,_e),Le.mt?i(ve,Le.mt):ve.write_shift(4,0),ve.write_shift(-4,Ge[Re]),ve.write_shift(4,Wn.length),ve.write_shift(4,Le.content.length),ve.write_shift(2,Cr.length),ve.write_shift(2,0),je+=ve.length,fe.push(ve),je+=Cr.length,fe.push(Cr),je+=Wn.length,fe.push(Wn),ve=Se(46),ve.write_shift(4,33639248),ve.write_shift(2,0),ve.write_shift(2,20),ve.write_shift(2,Te),ve.write_shift(2,_e),ve.write_shift(4,0),ve.write_shift(-4,Ge[Re]),ve.write_shift(4,Wn.length),ve.write_shift(4,Le.content.length),ve.write_shift(2,Cr.length),ve.write_shift(2,0),ve.write_shift(2,0),ve.write_shift(2,0),ve.write_shift(2,0),ve.write_shift(4,0),ve.write_shift(4,kr),wt+=ve.l,xe.push(ve),wt+=Cr.length,xe.push(Cr),++Re}return ve=Se(22),ve.write_shift(4,101010256),ve.write_shift(2,0),ve.write_shift(2,0),ve.write_shift(2,Re),ve.write_shift(2,Re),ve.write_shift(4,wt),ve.write_shift(4,je),ve.write_shift(2,0),bn([bn(fe),bn(xe),ve])}var Cn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ql(Z,he){if(Z.ctype)return Z.ctype;var de=Z.name||"",fe=de.match(/\.([^\.]+)$/);return fe&&Cn[fe[1]]||he&&(fe=(de=he).match(/[\.\\]([^\.\\])+$/),fe&&Cn[fe[1]])?Cn[fe[1]]:"application/octet-stream"}function Wf(Z){for(var he=Um(Z),de=[],fe=0;fe<he.length;fe+=76)de.push(he.slice(fe,fe+76));return de.join(`\r
`)+`\r
`}function ec(Z){var he=Z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(De){var je=De.charCodeAt(0).toString(16).toUpperCase();return"="+(je.length==1?"0"+je:je)});he=he.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),he.charAt(0)==`
`&&(he="=0D"+he.slice(1)),he=he.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var de=[],fe=he.split(`\r
`),xe=0;xe<fe.length;++xe){var ve=fe[xe];if(ve.length==0){de.push("");continue}for(var _e=0;_e<ve.length;){var Te=76,we=ve.slice(_e,_e+Te);we.charAt(Te-1)=="="?Te--:we.charAt(Te-2)=="="?Te-=2:we.charAt(Te-3)=="="&&(Te-=3),we=ve.slice(_e,_e+Te),_e+=Te,_e<ve.length&&(we+="="),de.push(we)}}return de.join(`\r
`)}function tc(Z){for(var he=[],de=0;de<Z.length;++de){for(var fe=Z[de];de<=Z.length&&fe.charAt(fe.length-1)=="=";)fe=fe.slice(0,fe.length-1)+Z[++de];he.push(fe)}for(var xe=0;xe<he.length;++xe)he[xe]=he[xe].replace(/[=][0-9A-Fa-f]{2}/g,function(ve){return String.fromCharCode(parseInt(ve.slice(1),16))});return Za(he.join(`\r
`))}function Cx(Z,he,de){for(var fe="",xe="",ve="",_e,Te=0;Te<10;++Te){var we=he[Te];if(!we||we.match(/^\s*$/))break;var De=we.match(/^(.*?):\s*([^\s].*)$/);if(De)switch(De[1].toLowerCase()){case"content-location":fe=De[2].trim();break;case"content-type":ve=De[2].trim();break;case"content-transfer-encoding":xe=De[2].trim();break}}switch(++Te,xe.toLowerCase()){case"base64":_e=Za(oi(he.slice(Te).join("")));break;case"quoted-printable":_e=tc(he.slice(Te));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+xe)}var je=$e(Z,fe.slice(de.length),_e,{unsafe:!0});ve&&(je.ctype=ve)}function Ax(Z,he){if(F(Z.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var de=he&&he.root||"",fe=(Tt&&Buffer.isBuffer(Z)?Z.toString("binary"):F(Z)).split(`\r
`),xe=0,ve="";for(xe=0;xe<fe.length;++xe)if(ve=fe[xe],!!/^Content-Location:/i.test(ve)&&(ve=ve.slice(ve.indexOf("file")),de||(de=ve.slice(0,ve.lastIndexOf("/")+1)),ve.slice(0,de.length)!=de))for(;de.length>0&&(de=de.slice(0,de.length-1),de=de.slice(0,de.lastIndexOf("/")+1),ve.slice(0,de.length)!=de););var _e=(fe[1]||"").match(/boundary="(.*?)"/);if(!_e)throw new Error("MAD cannot find boundary");var Te="--"+(_e[1]||""),we=[],De=[],je={FileIndex:we,FullPaths:De};j(je);var Re,qe=0;for(xe=0;xe<fe.length;++xe){var Ze=fe[xe];Ze!==Te&&Ze!==Te+"--"||(qe++&&Cx(je,fe.slice(Re,xe),de),Re=xe)}return je}function Ae(Z,he){var de=he||{},fe=de.boundary||"SheetJS";fe="------="+fe;for(var xe=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+fe.slice(2)+'"',"","",""],ve=Z.FullPaths[0],_e=ve,Te=Z.FileIndex[0],we=1;we<Z.FullPaths.length;++we)if(_e=Z.FullPaths[we].slice(ve.length),Te=Z.FileIndex[we],!(!Te.size||!Te.content||_e=="Sh33tJ5")){_e=_e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(wt){return"_x"+wt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(wt){return"_u"+wt.charCodeAt(0).toString(16)+"_"});for(var De=Te.content,je=Tt&&Buffer.isBuffer(De)?De.toString("binary"):F(De),Re=0,qe=Math.min(1024,je.length),Ze=0,Le=0;Le<=qe;++Le)(Ze=je.charCodeAt(Le))>=32&&Ze<128&&++Re;var Ge=Re>=qe*4/5;xe.push(fe),xe.push("Content-Location: "+(de.root||"file:///C:/SheetJS/")+_e),xe.push("Content-Transfer-Encoding: "+(Ge?"quoted-printable":"base64")),xe.push("Content-Type: "+Ql(Te,_e)),xe.push(""),xe.push(Ge?ec(je):Wf(je))}return xe.push(fe+`--\r
`),xe.join(`\r
`)}function Ye(Z){var he={};return j(he,Z),he}function $e(Z,he,de,fe){var xe=fe&&fe.unsafe;xe||j(Z);var ve=!xe&&it.find(Z,he);if(!ve){var _e=Z.FullPaths[0];he.slice(0,_e.length)==_e?_e=he:(_e.slice(-1)!="/"&&(_e+="/"),_e=(_e+he).replace("//","/")),ve={name:a(he),type:2},Z.FileIndex.push(ve),Z.FullPaths.push(_e),xe||it.utils.cfb_gc(Z)}return ve.content=de,ve.size=de?de.length:0,fe&&(fe.CLSID&&(ve.clsid=fe.CLSID),fe.mt&&(ve.mt=fe.mt),fe.ct&&(ve.ct=fe.ct)),ve}function ct(Z,he){j(Z);var de=it.find(Z,he);if(de){for(var fe=0;fe<Z.FileIndex.length;++fe)if(Z.FileIndex[fe]==de)return Z.FileIndex.splice(fe,1),Z.FullPaths.splice(fe,1),!0}return!1}function pr(Z,he,de){j(Z);var fe=it.find(Z,he);if(fe){for(var xe=0;xe<Z.FileIndex.length;++xe)if(Z.FileIndex[xe]==fe)return Z.FileIndex[xe].name=a(de),Z.FullPaths[xe]=de,!0}return!1}function eo(Z){S(Z,!0)}return t.find=A,t.read=D,t.parse=d,t.write=I,t.writeFile=P,t.utils={cfb_new:Ye,cfb_add:$e,cfb_del:ct,cfb_mov:pr,cfb_gc:eo,ReadShift:Ih,CheckField:bB,prep_blob:Pn,bconcat:bn,use_zlib:C,_deflateRaw:Pe,_inflateRaw:bt,consts:B},t}();let fl;function PAe(e){fl=e}function IAe(e){return typeof e=="string"?rx(e):Array.isArray(e)?sAe(e):e}function ax(e,t,r){if(typeof fl<"u"&&fl.writeFileSync)return r?fl.writeFileSync(e,t,r):fl.writeFileSync(e,t);if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=rx(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Is(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([IAe(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=zl(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function RAe(e){if(typeof fl<"u")return fl.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function zr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function CF(e,t){for(var r=[],n=zr(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function wb(e){for(var t=[],r=zr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function _b(e){for(var t=[],r=zr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function MAe(e){for(var t=[],r=zr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var uv=new Date(1899,11,30,0,0,0);function dn(e,t){var r=e.getTime(),n=uv.getTime()+(e.getTimezoneOffset()-uv.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var nB=new Date,UAe=uv.getTime()+(nB.getTimezoneOffset()-uv.getTimezoneOffset())*6e4,AF=nB.getTimezoneOffset();function Db(e){var t=new Date;return t.setTime(e*24*60*60*1e3+UAe),t.getTimezoneOffset()!==AF&&t.setTime(t.getTime()+(t.getTimezoneOffset()-AF)*6e4),t}function $Ae(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var OF=new Date("2017-02-19T19:06:09.000Z"),aB=isNaN(OF.getFullYear())?new Date("2/19/17"):OF,LAe=aB.getFullYear()==2017;function _r(e,t){var r=new Date(e);if(LAe)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(aB.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function zc(e,t){if(Tt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Is(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Is(HL(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Is(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Is(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function lr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=lr(e[r]));return t}function Ir(e,t){for(var r="";r.length<t;)r+=e;return r}function cs(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var BAe=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ld(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&BAe.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var WAe=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),s=[i[0]],l=1;l<i.length;++l)s.push(a),s.push(i[l]);return s}}();function iB(e){return e?e.content&&e.type?zc(e.content,!0):e.data?qu(e.data):e.asNodeBuffer&&Tt?qu(e.asNodeBuffer().toString("binary")):e.asBinary?qu(e.asBinary()):e._data&&e._data.getContent?qu(zc(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function sB(e){if(!e)return null;if(e.data)return sv(e.data);if(e.asNodeBuffer&&Tt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?sv(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function zAe(e){return e&&e.name.slice(-4)===".bin"?sB(e):iB(e)}function Di(e,t){for(var r=e.FullPaths||zr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var s=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function XS(e,t){var r=Di(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Qr(e,t,r){if(!r)return zAe(XS(e,t));if(!t)return null;try{return Qr(e,t)}catch{return null}}function Ja(e,t,r){if(!r)return iB(XS(e,t));if(!t)return null;try{return Ja(e,t)}catch{return null}}function HAe(e,t,r){return sB(XS(e,t))}function FF(e){for(var t=e.FullPaths||zr(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function jt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Tt?n=Ho(r):n=oAe(r),it.utils.cfb_add(e,t,n)}it.utils.cfb_add(e,t,r)}else e.file(t,r)}function KS(){return it.utils.cfb_new()}function oB(e,t){switch(t.type){case"base64":return it.read(e,{type:"base64"});case"binary":return it.read(e,{type:"binary"});case"buffer":case"array":return it.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Dh(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Yr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,VAe=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,PF=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,qAe=/<[^>]*>/g,oa=Yr.match(PF)?PF:qAe,GAe=/<\w*:/,YAe=/<(\/?)\w+:/;function xt(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(VAe),l=0,c="",u=0,d="",f="",h=1;if(s)for(u=0;u!=s.length;++u){for(f=s[u],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(d=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(h=(a=f.charCodeAt(i+1))==34||a==39?1:0,c=f.slice(i+1+h,f.length-h),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,n[d.toLowerCase()]=c;else{var m=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(n[m]&&d.slice(l-3,l)=="ext")continue;n[m]=c,n[m.toLowerCase()]=c}}return n}function Xs(e){return e.replace(YAe,"<$1")}var lB={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ZS=wb(lB),Bt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(l,c){return lB[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var s=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,s)+r(a.slice(s+3))}}(),JS=/[&<>'"]/g,XAe=/[\u0000-\u0008\u000b-\u001f]/g;function Qt(e){var t=e+"";return t.replace(JS,function(r){return ZS[r]}).replace(XAe,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function IF(e){return Qt(e).replace(/ /g,"_x0020_")}var cB=/[\u0000-\u001f]/g;function QS(e){var t=e+"";return t.replace(JS,function(r){return ZS[r]}).replace(/\n/g,"<br/>").replace(cB,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function KAe(e){var t=e+"";return t.replace(JS,function(r){return ZS[r]}).replace(cB,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var RF=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function ZAe(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function yr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Aw(e){for(var t="",r=0,n=0,a=0,i=0,s=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function MF(e){var t=El(2*e.length),r,n,a=1,i=0,s=0,l;for(n=0;n<e.length;n+=a)a=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function UF(e){return Ho(e,"binary").toString("utf8")}var Qx="foo bar baz",ir=Tt&&(UF(Qx)==Aw(Qx)&&UF||MF(Qx)==Aw(Qx)&&MF)||Aw,Is=Tt?function(e){return Ho(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Lm=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),uB=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),JAe=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),QAe=/<\/?(?:vt:)?variant>/g,e3e=/<(?:vt:)([^>]*)>([\s\S]*)</;function $F(e,t){var r=xt(e),n=e.match(JAe(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var s=i.replace(QAe,"").match(e3e);s&&a.push({v:ir(s[2]),t:s[1]})}),a}var dB=/(^\s|\s$|\n)/;function In(e,t){return"<"+e+(t.match(dB)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Bm(e){return zr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function We(e,t,r){return"<"+e+(r!=null?Bm(r):"")+(t!=null?(t.match(dB)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function dj(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function t3e(e,t){switch(typeof e){case"string":var r=We("vt:lpwstr",Qt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return We((e|0)==e?"vt:i4":"vt:r8",Qt(String(e)));case"boolean":return We("vt:bool",e?"true":"false")}if(e instanceof Date)return We("vt:filetime",dj(e));throw new Error("Unable to serialize "+e)}function eE(e){if(Tt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return ir(zl(qS(e)));throw new Error("Bad input format: expected Buffer or string")}var Wm=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,ln={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},du=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Xa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function r3e(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function n3e(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var LF=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},BF=Tt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ho(t)})):LF(e)}:LF,WF=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(vo(e,a)));return n.join("").replace(ta,"")},jb=Tt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(ta,""):WF(e,t,r)}:WF,zF=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},fB=Tt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):zF(e,t,r)}:zF,HF=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Uu(e,a)));return n.join("")},Tf=Tt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):HF(t,r,n)}:HF,hB=function(e,t){var r=yn(e,t);return r>0?Tf(e,t+4,t+4+r-1):""},tE=hB,mB=function(e,t){var r=yn(e,t);return r>0?Tf(e,t+4,t+4+r-1):""},rE=mB,pB=function(e,t){var r=2*yn(e,t);return r>0?Tf(e,t+4,t+4+r-1):""},nE=pB,xB=function(t,r){var n=yn(t,r);return n>0?jb(t,r+4,r+4+n):""},aE=xB,gB=function(e,t){var r=yn(e,t);return r>0?Tf(e,t+4,t+4+r):""},iE=gB,vB=function(e,t){return r3e(e,t)},dv=vB,sE=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Tt&&(tE=function(t,r){if(!Buffer.isBuffer(t))return hB(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},rE=function(t,r){if(!Buffer.isBuffer(t))return mB(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},nE=function(t,r){if(!Buffer.isBuffer(t))return pB(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},aE=function(t,r){if(!Buffer.isBuffer(t))return xB(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},iE=function(t,r){if(!Buffer.isBuffer(t))return gB(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},dv=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):vB(t,r)},sE=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});function yB(){jb=function(e,t,r){return Ut.utils.decode(1200,e.slice(t,r)).replace(ta,"")},Tf=function(e,t,r){return Ut.utils.decode(65001,e.slice(t,r))},tE=function(e,t){var r=yn(e,t);return r>0?Ut.utils.decode(Bc,e.slice(t+4,t+4+r-1)):""},rE=function(e,t){var r=yn(e,t);return r>0?Ut.utils.decode(si,e.slice(t+4,t+4+r-1)):""},nE=function(e,t){var r=2*yn(e,t);return r>0?Ut.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},aE=function(e,t){var r=yn(e,t);return r>0?Ut.utils.decode(1200,e.slice(t+4,t+4+r)):""},iE=function(e,t){var r=yn(e,t);return r>0?Ut.utils.decode(65001,e.slice(t+4,t+4+r)):""}}typeof Ut<"u"&&yB();var Uu=function(e,t){return e[t]},vo=function(e,t){return e[t+1]*256+e[t]},a3e=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},yn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},vc=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},i3e=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ih(e,t){var r="",n,a,i=[],s,l,c,u;switch(t){case"dbcs":if(u=this.l,Tt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(vo(this,u)),u+=2;e*=2;break;case"utf8":r=Tf(this,this.l,this.l+e);break;case"utf16le":e*=2,r=jb(this,this.l,this.l+e);break;case"wstr":if(typeof Ut<"u")r=Ut.utils.decode(si,this.slice(this.l,this.l+2*e));else return Ih.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":r=tE(this,this.l),e=4+yn(this,this.l);break;case"lpstr-cp":r=rE(this,this.l),e=4+yn(this,this.l);break;case"lpwstr":r=nE(this,this.l),e=4+2*yn(this,this.l);break;case"lpp4":e=4+yn(this,this.l),r=aE(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+yn(this,this.l),r=iE(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=Uu(this,this.l+e++))!==0;)i.push(wh(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=vo(this,this.l+e))!==0;)i.push(wh(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return s=Uu(this,u),this.l=u+1,l=Ih.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(wh(vo(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":if(typeof Ut<"u"){r=Ut.utils.decode(si,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return s=Uu(this,u),this.l=u+1,l=Ih.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(wh(Uu(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return n=Uu(this,this.l),this.l++,n;case 2:return n=(t==="i"?a3e:vo)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?vc:i3e)(this,this.l),this.l+=4,n):(a=yn(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=dv(this,this.l):a=dv([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=fB(this,this.l,e);break}}return this.l+=e,r}var s3e=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},o3e=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},l3e=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function c3e(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)l3e(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){if(typeof Ut<"u"&&Bc==874)for(a=0;a!=t.length;++a){var i=Ut.utils.encode(Bc,t.charAt(a));this[this.l+a]=i[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var l=t.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,s3e(this,t,this.l);break;case 8:if(n=8,r==="f"){n3e(this,t,this.l);break}case 16:break;case-4:n=4,o3e(this,t,this.l);break}return this.l+=n,this}function bB(e,t){var r=fB(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Pn(e,t){e.l=t,e.read_shift=Ih,e.chk=bB,e.write_shift=c3e}function aa(e,t){e.l+=t}function Se(e){var t=El(e);return Pn(t,0),t}function Vo(e,t,r){if(e){var n,a,i;Pn(e,e.l||0);for(var s=e.length,l=0,c=0;e.l<s;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var u=Ym[l]||Ym[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;c=e.l+i;var d=u.f&&u.f(e,i,r);if(e.l=c,t(d,u,l))return}}}function Fa(){var e=[],t=Tt?256:2048,r=function(u){var d=Se(u);return Pn(d,0),d},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},s=function(){return a(),bn(e)},l=function(u){a(),n=u,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:l,end:s,_bufs:e}}function Oe(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=Ym[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var l=0;l!=4;++l)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&sE(r)&&e.push(r)}}function Rh(e,t,r){var n=lr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function VF(e,t,r){var n=lr(e);return n.s=Rh(n.s,t.s,r),n.e=Rh(n.e,t.s,r),n}function Mh(e,t){if(e.cRel&&e.c<0)for(e=lr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=lr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=pt(e);return!e.cRel&&e.cRel!=null&&(r=f3e(r)),!e.rRel&&e.rRel!=null&&(r=u3e(r)),r}function Ow(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+wr(e.s.c)+":"+(e.e.cRel?"":"$")+wr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+$r(e.s.r)+":"+(e.e.rRel?"":"$")+$r(e.e.r):Mh(e.s,t.biff)+":"+Mh(e.e,t.biff)}function oE(e){return parseInt(d3e(e),10)-1}function $r(e){return""+(e+1)}function u3e(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function d3e(e){return e.replace(/\$(\d+)$/,"$1")}function lE(e){for(var t=h3e(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function wr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function f3e(e){return e.replace(/^([A-Z])/,"$$$1")}function h3e(e){return e.replace(/^\$([A-Z])/,"$1")}function m3e(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Fr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function pt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function ba(e){var t=e.indexOf(":");return t==-1?{s:Fr(e),e:Fr(e)}:{s:Fr(e.slice(0,t)),e:Fr(e.slice(t+1))}}function Dt(e,t){return typeof t>"u"||typeof t=="number"?Dt(e.s,e.e):(typeof e!="string"&&(e=pt(e)),typeof t!="string"&&(t=pt(t)),e==t?e:e+":"+t)}function Ft(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function qF(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=li(e.z,r?dn(t):t)}catch{}try{return e.w=li((e.XF||{}).numFmtId||(r?14:0),r?dn(t):t)}catch{return""+t}}function Vs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?qo[e.v]||e.v:t==null?qF(e,e.v):qF(e,t))}function Hl(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function wB(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,l=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?Fr(n.origin):n.origin;s=c.r,l=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=Ft(i["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),s==-1&&(u.e.r=s=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var m={v:t[f][h]},x=s+f,p=l+h;if(u.s.r>x&&(u.s.r=x),u.s.c>p&&(u.s.c=p),u.e.r<x&&(u.e.r=x),u.e.c<p&&(u.e.c=p),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))m=t[f][h];else if(Array.isArray(m.v)&&(m.f=t[f][h][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||dt[14],n.cellDates?(m.t="d",m.w=li(m.z,dn(m.v))):(m.t="n",m.v=dn(m.v),m.w=li(m.z,m.v))):m.t="s";if(a)i[x]||(i[x]=[]),i[x][p]&&i[x][p].z&&(m.z=i[x][p].z),i[x][p]=m;else{var g=pt({c:p,r:x});i[g]&&i[g].z&&(m.z=i[g].z),i[g]=m}}}return u.s.c<1e7&&(i["!ref"]=Dt(u)),i}function kf(e,t){return wB(null,e,t)}function p3e(e){return e.read_shift(4,"i")}function us(e,t){return t||(t=Se(4)),t.write_shift(4,e),t}function ra(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function wn(e,t){var r=!1;return t==null&&(r=!0,t=Se(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function x3e(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function g3e(e,t){return t||(t=Se(4)),t.write_shift(2,0),t.write_shift(2,0),t}function cE(e,t){var r=e.l,n=e.read_shift(1),a=ra(e),i=[],s={t:a,h:a};if(n&1){for(var l=e.read_shift(4),c=0;c!=l;++c)i.push(x3e(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function v3e(e,t){var r=!1;return t==null&&(r=!0,t=Se(15+4*e.t.length)),t.write_shift(1,0),wn(e.t,t),r?t.slice(0,t.l):t}var y3e=cE;function b3e(e,t){var r=!1;return t==null&&(r=!0,t=Se(23+4*e.t.length)),t.write_shift(1,1),wn(e.t,t),t.write_shift(4,1),g3e({},t),r?t.slice(0,t.l):t}function Gi(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function fu(e,t){return t==null&&(t=Se(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function hu(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function mu(e,t){return t==null&&(t=Se(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var w3e=ra,_B=wn;function uE(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function fv(e,t){var r=!1;return t==null&&(r=!0,t=Se(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var _3e=ra,fj=uE,dE=fv;function fE(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?dv([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):vc(t,0)>>2;return r?a/100:a}function DB(e,t){t==null&&(t=Se(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function jB(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function D3e(e,t){return t||(t=Se(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var pu=jB,Cf=D3e;function Qn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Hc(e,t){return(t||Se(8)).write_shift(8,e,"f")}function j3e(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=Tc[a];u&&(t.rgb=Hm(u));break;case 2:t.rgb=Hm([s,l,c]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function hv(e,t){if(t||(t=Se(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function N3e(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function S3e(e,t){t||(t=Se(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function NB(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function E3e(e){return NB(e,1)}function T3e(e){return NB(e,2)}var hE=2,Na=3,e0=11,GF=12,mv=19,t0=64,k3e=65,C3e=71,A3e=4108,O3e=4126,gn=80,SB=81,F3e=[gn,SB],hj={1:{n:"CodePage",t:hE},2:{n:"Category",t:gn},3:{n:"PresentationFormat",t:gn},4:{n:"ByteCount",t:Na},5:{n:"LineCount",t:Na},6:{n:"ParagraphCount",t:Na},7:{n:"SlideCount",t:Na},8:{n:"NoteCount",t:Na},9:{n:"HiddenCount",t:Na},10:{n:"MultimediaClipCount",t:Na},11:{n:"ScaleCrop",t:e0},12:{n:"HeadingPairs",t:A3e},13:{n:"TitlesOfParts",t:O3e},14:{n:"Manager",t:gn},15:{n:"Company",t:gn},16:{n:"LinksUpToDate",t:e0},17:{n:"CharacterCount",t:Na},19:{n:"SharedDoc",t:e0},22:{n:"HyperlinksChanged",t:e0},23:{n:"AppVersion",t:Na,p:"version"},24:{n:"DigSig",t:k3e},26:{n:"ContentType",t:gn},27:{n:"ContentStatus",t:gn},28:{n:"Language",t:gn},29:{n:"Version",t:gn},255:{},2147483648:{n:"Locale",t:mv},2147483651:{n:"Behavior",t:mv},1919054434:{}},mj={1:{n:"CodePage",t:hE},2:{n:"Title",t:gn},3:{n:"Subject",t:gn},4:{n:"Author",t:gn},5:{n:"Keywords",t:gn},6:{n:"Comments",t:gn},7:{n:"Template",t:gn},8:{n:"LastAuthor",t:gn},9:{n:"RevNumber",t:gn},10:{n:"EditTime",t:t0},11:{n:"LastPrinted",t:t0},12:{n:"CreatedDate",t:t0},13:{n:"ModifiedDate",t:t0},14:{n:"PageCount",t:Na},15:{n:"WordCount",t:Na},16:{n:"CharCount",t:Na},17:{n:"Thumbnail",t:C3e},18:{n:"Application",t:gn},19:{n:"DocSecurity",t:Na},255:{},2147483648:{n:"Locale",t:mv},2147483651:{n:"Behavior",t:mv},1919054434:{}},YF={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},P3e=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function I3e(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var R3e=I3e([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Tc=lr(R3e),qo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},EB={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},pj={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},r0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function mE(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function M3e(e){var t=mE();if(!e||!e.match)return t;var r={};if((e.match(oa)||[]).forEach(function(n){var a=xt(n);switch(a[0].replace(GAe,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[pj[a.ContentType]]!==void 0&&t[pj[a.ContentType]].push(a.PartName);break}}),t.xmlns!==ln.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function TB(e,t){var r=MAe(pj),n=[],a;n[n.length]=Yr,n[n.length]=We("Types",null,{xmlns:ln.CT,"xmlns:xsd":ln.xsd,"xmlns:xsi":ln.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return We("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(a=e[c][0],n[n.length]=We("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:r0[c][t.bookType]||r0[c].xlsx}))},s=function(c){(e[c]||[]).forEach(function(u){n[n.length]=We("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r0[c][t.bookType]||r0[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(u){n[n.length]=We("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return i("workbooks"),s("sheets"),s("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),s("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var kt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function zm(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Uh(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(oa)||[]).forEach(function(a){var i=xt(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:Dh(i.Target,t);r[l]=s,n[i.Id]=s}}),r["!id"]=n,r}function nd(e){var t=[Yr,We("Relationships",null,{xmlns:ln.RELS})];return zr(e["!id"]).forEach(function(r){t[t.length]=We("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Kt(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[kt.HLINK,kt.XPATH,kt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var U3e="application/vnd.oasis.opendocument.spreadsheet";function $3e(e,t){for(var r=eE(e),n,a;n=Wm.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=xt(n[0],!1),a.path=="/"&&a.type!==U3e)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function L3e(e){var t=[Yr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function XF(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function B3e(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function W3e(e){var t=[Yr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(XF(e[r][0],e[r][1])),t.push(B3e("",e[r][0]));return t.push(XF("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function kB(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Mm.version+"</meta:generator></office:meta></office:document-meta>"}var Mi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],z3e=function(){for(var e=new Array(Mi.length),t=0;t<Mi.length;++t){var r=Mi[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function CB(e){var t={};e=ir(e);for(var r=0;r<Mi.length;++r){var n=Mi[r],a=e.match(z3e[r]);a!=null&&a.length>0&&(t[n[1]]=Bt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=_r(t[n[1]]))}return t}function Fw(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Qt(t),n[n.length]=r?We(e,t,r):In(e,t))}function AB(e,t){var r=t||{},n=[Yr,We("cp:coreProperties",null,{"xmlns:cp":ln.CORE_PROPS,"xmlns:dc":ln.dc,"xmlns:dcterms":ln.dcterms,"xmlns:dcmitype":ln.dcmitype,"xmlns:xsi":ln.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Fw("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:dj(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Fw("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:dj(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=Mi.length;++i){var s=Mi[i],l=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Fw(s[0],l,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var kc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],OB=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function FB(e,t,r,n){var a=[];if(typeof e=="string")a=$F(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(d){return{v:d}}));var s=typeof t=="string"?$F(t,n).map(function(d){return d.v}):t,l=0,c=0;if(s.length>0)for(var u=0;u!==a.length;u+=2){switch(c=+a[u+1].v,a[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=s.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=s.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=s.slice(l,l+c);break}l+=c}}function H3e(e,t,r){var n={};return t||(t={}),e=ir(e),kc.forEach(function(a){var i=(e.match(Lm(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=Bt(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var s=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&FB(n.HeadingPairs,n.TitlesOfParts,t,r),t}function PB(e){var t=[],r=We;return e||(e={}),e.Application="SheetJS",t[t.length]=Yr,t[t.length]=We("Properties",null,{xmlns:ln.EXT_PROPS,"xmlns:vt":ln.vt}),kc.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Qt(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Qt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var V3e=/<[^>]+>[^<]*/g;function q3e(e,t){var r={},n="",a=e.match(V3e);if(a)for(var i=0;i!=a.length;++i){var s=a[i],l=xt(s);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Bt(l.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var c=s.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=Bt(d);break;case"bool":r[n]=yr(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=_r(d);break;case"cy":case"error":r[n]=Bt(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,u,c)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}function IB(e){var t=[Yr,We("Properties",null,{xmlns:ln.CUST_PROPS,"xmlns:vt":ln.vt})];if(!e)return t.join("");var r=1;return zr(e).forEach(function(a){++r,t[t.length]=We("property",t3e(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Qt(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var xj={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Pw;function G3e(e,t,r){Pw||(Pw=wb(xj)),t=Pw[t]||t,e[t]=r}function Y3e(e,t){var r=[];return zr(xj).map(function(n){for(var a=0;a<Mi.length;++a)if(Mi[a][1]==n)return Mi[a];for(a=0;a<kc.length;++a)if(kc[a][1]==n)return kc[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(In(xj[n[1]]||n[1],a))}}),We("DocumentProperties",r.join(""),{xmlns:Xa.o})}function X3e(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&zr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<Mi.length;++s)if(i==Mi[s][1])return;for(s=0;s<kc.length;++s)if(i==kc[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var l=e[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),a.push(We(IF(i),l,{"dt:dt":c}))}}),t&&zr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],l="string";typeof s=="number"?(l="float",s=String(s)):s===!0||s===!1?(l="boolean",s=s?"1":"0"):s instanceof Date?(l="dateTime.tz",s=s.toISOString()):s=String(s),a.push(We(IF(i),s,{"dt:dt":l}))}}),"<"+n+' xmlns="'+Xa.o+'">'+a.join("")+"</"+n+">"}function pE(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function K3e(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=Se(8);return s.write_shift(4,n),s.write_shift(4,a),s}function RB(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function MB(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function UB(e,t,r){return t===31?MB(e):RB(e,t,r)}function gj(e,t,r){return UB(e,t,r===!1?0:4)}function Z3e(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return UB(e,t,0)}function J3e(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(ta,""),e.l-a&2&&(e.l+=2)}return r}function Q3e(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(ta,"");return r}function e4e(e){var t=e.l,r=pv(e,SB);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=pv(e,Na);return[r,n]}function t4e(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(e4e(e));return r}function KF(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),s=e.read_shift(4);n[i]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(ta,"").replace(_h,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function $B(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function r4e(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function pv(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==GF&&n!==t&&F3e.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===GF?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return RB(e,n,4).replace(ta,"");case 31:return MB(e);case 64:return pE(e);case 65:return $B(e);case 71:return r4e(e);case 80:return gj(e,n,!i.raw).replace(ta,"");case 81:return Z3e(e,n).replace(ta,"");case 4108:return t4e(e);case 4126:case 4127:return n==4127?J3e(e):Q3e(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function ZF(e,t){var r=Se(4),n=Se(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Se(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=K3e(t);break;case 31:case 80:for(n=Se(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return bn([r,n])}function JF(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0,l=0,c=-1,u={};for(s=0;s!=a;++s){var d=e.read_shift(4),f=e.read_shift(4);i[s]=[d,f+r]}i.sort(function(y,b){return y[1]-b[1]});var h={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var m=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,m=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],m=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],m=!1);break}if((!t||s==0)&&e.l<=i[s][1]&&(m=!1,e.l=i[s][1]),m)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(t){var x=t[i[s][0]];if(h[x.n]=pv(e,x.t,{raw:!0}),x.p==="version"&&(h[x.n]=String(h[x.n]>>16)+"."+("0000"+String(h[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(h[x.n]){case 0:h[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ii(l=h[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[x.n])}}else if(i[s][0]===1){if(l=h.CodePage=pv(e,hE),Ii(l),c!==-1){var p=e.l;e.l=i[c][1],u=KF(e,l),e.l=p}}else if(i[s][0]===0){if(l===0){c=s,e.l=i[s+1][1];continue}u=KF(e,l)}else{var g=u[i[s][0]],v;switch(e[e.l]){case 65:e.l+=4,v=$B(e);break;case 30:e.l+=4,v=gj(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=gj(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=Hr(e,4);break;case 64:e.l+=4,v=_r(pE(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=v}}return e.l=r+n,h}var LB=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function n4e(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function QF(e,t,r){var n=Se(8),a=[],i=[],s=8,l=0,c=Se(8),u=Se(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),i.push(c),a.push(u),s+=8+c.length,!t){u=Se(8),u.write_shift(4,0),a.unshift(u);var d=[Se(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=Se(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=bn(d),i.unshift(c),s+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(LB.indexOf(e[l][0])>-1||OB.indexOf(e[l][0])>-1)&&e[l][1]!=null){var h=e[l][1],m=0;if(t){m=+t[e[l][0]];var x=r[m];if(x.p=="version"&&typeof h=="string"){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}c=ZF(x.t,h)}else{var g=n4e(h);g==-1&&(g=31,h=String(h)),c=ZF(g,h)}i.push(c),u=Se(8),u.write_shift(4,t?m:2+l),a.push(u),s+=8+c.length}var v=8*(i.length+1);for(l=0;l<i.length;++l)a[l].write_shift(4,v),v+=i[l].length;return n.write_shift(4,s),n.write_shift(4,i.length),bn([n].concat(a).concat(i))}function eP(e,t,r){var n=e.content;if(!n)return{};Pn(n,0);var a,i,s,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==it.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),l=n.read_shift(4),a===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);a===2&&(s=n.read_shift(16),c=n.read_shift(4));var f=JF(n,t),h={SystemIdentifier:u};for(var m in f)h[m]=f[m];if(h.FMTID=i,a===1)return h;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var x;try{x=JF(n,null)}catch{}for(m in x)h[m]=x[m];return h.FMTID=[i,s],h}function tP(e,t,r,n,a,i){var s=Se(a?68:48),l=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,it.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var c=QF(e,r,n);if(l.push(c),a){var u=QF(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+c.length),l.push(u)}return bn(l)}function Jo(e,t){return e.read_shift(t),null}function a4e(e,t){t||(t=Se(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function i4e(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Hr(e,t){return e.read_shift(t)===1}function ma(e,t){return t||(t=Se(2)),t.write_shift(2,+!!e),t}function en(e){return e.read_shift(2,"u")}function Ni(e,t){return t||(t=Se(2)),t.write_shift(2,e),t}function BB(e,t){return i4e(e,t,en)}function s4e(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function WB(e,t,r){return r||(r=Se(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function ix(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont",i=si;if(r&&r.biff>=8&&(si=1200),!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var l=n?e.read_shift(n,a):"";return si=i,l}function o4e(e){var t=si;si=1200;var r=e.read_shift(2),n=e.read_shift(1),a=n&4,i=n&8,s=1+(n&1),l=0,c,u={};i&&(l=e.read_shift(2)),a&&(c=e.read_shift(4));var d=s==2?"dbcs-cont":"sbcs-cont",f=r===0?"":e.read_shift(r,d);return i&&(e.l+=4*l),a&&(e.l+=c),u.t=f,i||(u.raw="<t>"+u.t+"</t>",u.r=u.t),si=t,u}function l4e(e){var t=e.t||"",r=Se(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Se(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return bn(a)}function Vc(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function sx(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Vc(e,n,r)}function xu(e,t,r){if(r.biff>5)return sx(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function zB(e,t,r){return r||(r=Se(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function c4e(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function u4e(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(ta,"");return n&&(e.l+=24),a}function d4e(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(ta,"");return r+s}function f4e(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return u4e(e);case"0303000000000000c000000000000046":return d4e(e);default:throw new Error("Unsupported Moniker "+r)}}function n0(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(ta,""):"";return r}function rP(e,t){t||(t=Se(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function h4e(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,s,l,c,u="",d,f;a&16&&(i=n0(e,r-e.l)),a&128&&(s=n0(e,r-e.l)),(a&257)===257&&(l=n0(e,r-e.l)),(a&257)===1&&(c=f4e(e,r-e.l)),a&8&&(u=n0(e,r-e.l)),a&32&&(d=e.read_shift(16)),a&64&&(f=pE(e)),e.l=r;var h=s||l||c||"";h&&u&&(h+="#"+u),h||(h="#"+u),a&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var m={Target:h};return d&&(m.guid=d),f&&(m.time=f),i&&(m.Tooltip=i),m}function m4e(e){var t=Se(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)n=n.slice(1),rP(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var l=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&rP(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function HB(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function VB(e,t){var r=HB(e);return r[3]=0,r}function Ks(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function qc(e,t,r,n){return n||(n=Se(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function p4e(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function x4e(e,t,r){return t===0?"":xu(e,t,r)}function g4e(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function qB(e){var t=e.read_shift(2),r=fE(e);return[t,r]}function v4e(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=ix(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function Nb(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function GB(e,t){return t||(t=Se(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function YB(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var y4e=YB;function XB(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function b4e(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function w4e(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function zn(e){e.l+=2,e.l+=e.read_shift(2)}var _4e={0:zn,4:zn,5:zn,6:zn,7:w4e,8:zn,9:zn,10:zn,11:zn,12:zn,13:b4e,14:zn,15:zn,16:zn,17:zn,18:zn,19:zn,20:zn,21:XB};function D4e(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(_4e[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function a0(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function xE(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Se(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function j4e(e,t){return t===0||e.read_shift(2),1200}function N4e(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=xu(e,0,r);return e.read_shift(t+n-e.l),a}function S4e(e,t){var r=!t||t.biff==8,n=Se(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function E4e(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function T4e(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=ix(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:i,name:s}}function k4e(e,t){var r=!t||t.biff>=8?2:1,n=Se(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function C4e(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<r;++s)i.push(o4e(e));return i.Count=n,i.Unique=a,i}function A4e(e,t){var r=Se(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=l4e(e[a]);var i=bn([r].concat(n));return i.parts=[r.length].concat(n.map(function(s){return s.length})),i}function O4e(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function F4e(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function P4e(e){var t=p4e(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function I4e(e){return e.read_shift(2),e.read_shift(4)}function nP(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function R4e(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:s,FirstTab:l,Selected:c,TabRatio:u}}function M4e(){var e=Se(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function U4e(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function $4e(e){var t=Se(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function L4e(){}function B4e(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=ix(e,0,r),n}function W4e(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=Se(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function z4e(e){var t=Ks(e);return t.isst=e.read_shift(4),t}function H4e(e,t,r,n){var a=Se(10);return qc(e,t,n,a),a.write_shift(4,r),a}function V4e(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Ks(e);r.biff==2&&e.l++;var i=sx(e,n-e.l,r);return a.val=i,a}function q4e(e,t,r,n,a){var i=!a||a.biff==8,s=Se(8+ +i+(1+i)*r.length);return qc(e,t,n,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function G4e(e,t,r){var n=e.read_shift(2),a=xu(e,0,r);return[n,a]}function Y4e(e,t,r,n){var a=r&&r.biff==5;n||(n=Se(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var X4e=xu;function aP(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),s=e.read_shift(a),l=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:i,c:l},e:{r:s,c}}}function K4e(e,t){var r=t.biff==8||!t.biff?4:2,n=Se(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Z4e(e){var t=e.read_shift(2),r=e.read_shift(2),n=qB(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function J4e(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(qB(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function Q4e(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function eOe(e,t,r,n){var a={},i=e.read_shift(4),s=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return a.patternType=P3e[l>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=l&127,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function tOe(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=eOe(e,t,n.fStyle,r),n}function iP(e,t,r,n){var a=r&&r.biff==5;n||(n=Se(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function rOe(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function nOe(e){var t=Se(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function sP(e,t,r){var n=Ks(e);(r.biff==2||t==9)&&++e.l;var a=s4e(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function aOe(e,t,r,n,a,i){var s=Se(8);return qc(e,t,n,s),WB(r,i,s),s}function iOe(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ks(e),a=Qn(e);return n.val=a,n}function sOe(e,t,r,n){var a=Se(14);return qc(e,t,n,a),Hc(r,a),a}var oP=x4e;function oOe(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=Vc(e,i),l=[];n>e.l;)l.push(sx(e));return[i,a,s,l]}function lP(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=v4e(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var lOe=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function cP(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=Vc(e,s,r);a&32&&(u=lOe[u.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var f=n==e.l||l===0||!(d>0)?[]:D6e(e,d,r,l);return{chKey:i,Name:u,itab:c,rgce:f}}function KB(e,t,r){if(r.biff<8)return cOe(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(g4e(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function cOe(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=ix(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function uOe(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=Vc(e,n,r),s=Vc(e,a,r);return[i,s]}function dOe(e,t,r){var n=YB(e);e.l++;var a=e.read_shift(1);return t-=8,[j6e(e,t,r),a,n]}function uP(e,t,r){var n=y4e(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,w6e(e,t,r)]}function fOe(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function hOe(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),l=xu(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},l,s,i]}}function mOe(e,t,r){return hOe(e,t,r)}function pOe(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Nb(e));return r}function xOe(e){var t=Se(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)GB(e[r],t);return t}function gOe(e,t,r){if(r&&r.biff<8)return yOe(e,t,r);var n=XB(e),a=D4e(e,t-22,n[1]);return{cmo:n,ft:a}}var vOe={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function yOe(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((vOe[n]||aa)(e,t,r)),{cmo:[a,n,i],ft:s}}function bOe(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=c4e(e,6,r);var l=e.read_shift(2);e.read_shift(2),en(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=Vc(e,e.lens[u+1]-e.lens[u]-1);if(a+=f,a.length>=(d?l:2*l))break}if(a.length!==l&&a.length!==l*2)throw new Error("cchText: "+l+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function wOe(e,t){var r=Nb(e);e.l+=16;var n=h4e(e,t-24);return[r,n]}function _Oe(e){var t=Se(24),r=Fr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return bn([t,m4e(e[1])])}function DOe(e,t){e.read_shift(2);var r=Nb(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(ta,""),[r,n]}function jOe(e){var t=e[1].Tooltip,r=Se(10+2*(t.length+1));r.write_shift(2,2048);var n=Fr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function NOe(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=YF[r]||r,r=e.read_shift(2),t[1]=YF[r]||r,t}function SOe(e){return e||(e=Se(4)),e.write_shift(2,1),e.write_shift(2,1),e}function EOe(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(VB(e));return r}function TOe(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(VB(e));return r}function kOe(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function ZB(e,t,r){if(!r.cellStyles)return aa(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:i,w:s,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function COe(e,t){var r=Se(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function AOe(e,t){var r={};return t<32||(e.l+=16,r.header=Qn(e),r.footer=Qn(e),e.l+=2),r}function OOe(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function FOe(e){for(var t=Se(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var POe=Ks,IOe=BB,ROe=sx;function MOe(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function UOe(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ks(e);++e.l;var a=xu(e,t-7,r);return n.t="str",n.val=a,n}function $Oe(e){var t=Ks(e);++e.l;var r=Qn(e);return t.t="n",t.val=r,t}function LOe(e,t,r){var n=Se(15);return ux(n,e,t),n.write_shift(8,r,"f"),n}function BOe(e){var t=Ks(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function WOe(e,t,r){var n=Se(9);return ux(n,e,t),n.write_shift(2,r),n}function zOe(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function HOe(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function VOe(e,t,r){var n=e.l+t,a=Ks(e),i=e.read_shift(2),s=Vc(e,i,r);return e.l=n,a.t="str",a.val=s,a}var qOe=[2,3,48,49,131,139,140,245],vj=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=wb({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=El(1);switch(c.type){case"base64":d=Za(oi(l));break;case"binary":d=Za(l);break;case"buffer":case"array":d=l;break}Pn(d,0);var f=d.read_shift(1),h=!!(f&136),m=!1,x=!1;switch(f){case 2:break;case 3:break;case 48:m=!0,h=!0;break;case 49:m=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,g=521;f==2&&(p=d.read_shift(2)),d.l+=3,f!=2&&(p=d.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(g=d.read_shift(2));var v=d.read_shift(2),y=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(y=e[d[d.l]]),d.l+=1,d.l+=2),x&&(d.l+=36);for(var b=[],w={},_=Math.min(d.length,f==2?521:g-10-(m?264:0)),D=x?32:11;d.l<_&&d[d.l]!=13;)switch(w={},w.name=Ut.utils.decode(y,d.slice(d.l,d.l+D)).replace(/[\u0000\r\n].*$/g,""),d.l+=D,w.type=String.fromCharCode(d.read_shift(1)),f!=2&&!x&&(w.offset=d.read_shift(4)),w.len=d.read_shift(1),f==2&&(w.offset=d.read_shift(2)),w.dec=d.read_shift(1),w.name.length&&b.push(w),f!=2&&(d.l+=x?13:14),w.type){case"B":(!m||w.len!=8)&&c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(d[d.l]!==13&&(d.l=g-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=g;var j=0,N=0;for(u[0]=[],N=0;N!=b.length;++N)u[0][N]=b[N].name;for(;p-- >0;){if(d[d.l]===42){d.l+=v;continue}for(++d.l,u[++j]=[],N=0,N=0;N!=b.length;++N){var S=d.slice(d.l,d.l+b[N].len);d.l+=b[N].len,Pn(S,0);var E=Ut.utils.decode(y,S);switch(b[N].type){case"C":E.trim().length&&(u[j][N]=E.replace(/\s+$/,""));break;case"D":E.length===8?u[j][N]=new Date(+E.slice(0,4),+E.slice(4,6)-1,+E.slice(6,8)):u[j][N]=E;break;case"F":u[j][N]=parseFloat(E.trim());break;case"+":case"I":u[j][N]=x?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(E.trim().toUpperCase()){case"Y":case"T":u[j][N]=!0;break;case"N":case"F":u[j][N]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+E+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[j][N]="##MEMO##"+(x?parseInt(E.trim(),10):S.read_shift(4));break;case"N":E=E.replace(/\u0000/g,"").trim(),E&&E!="."&&(u[j][N]=+E||0);break;case"@":u[j][N]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":u[j][N]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":u[j][N]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[j][N]=-S.read_shift(-8,"f");break;case"B":if(m&&b[N].len==8){u[j][N]=S.read_shift(8,"f");break}case"G":case"P":S.l+=b[N].len;break;case"0":if(b[N].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[N].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=b,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=kf(r(l,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function a(l,c){try{return Hl(n(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(l,c){var u=c||{};if(+u.codepage>=0&&Ii(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Fa(),f=vv(l,{header:1,raw:!0,cellDates:!0}),h=f[0],m=f.slice(1),x=l["!cols"]||[],p=0,g=0,v=0,y=1;for(p=0;p<h.length;++p){if(((x[p]||{}).DBF||{}).name){h[p]=x[p].DBF.name,++v;continue}if(h[p]!=null){if(++v,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(g=0;g<1024;++g)if(h.indexOf(h[p]+"_"+g)==-1){h[p]+="_"+g;break}}}}var b=Ft(l["!ref"]),w=[],_=[],D=[];for(p=0;p<=b.e.c-b.s.c;++p){var j="",N="",S=0,E=[];for(g=0;g<m.length;++g)m[g][p]!=null&&E.push(m[g][p]);if(E.length==0||h[p]==null){w[p]="?";continue}for(g=0;g<E.length;++g){switch(typeof E[g]){case"number":N="B";break;case"string":N="C";break;case"boolean":N="L";break;case"object":N=E[g]instanceof Date?"D":"C";break;default:N="C"}S=Math.max(S,String(E[g]).length),j=j&&j!=N?"C":N}S>250&&(S=250),N=((x[p]||{}).DBF||{}).type,N=="C"&&x[p].DBF.len>S&&(S=x[p].DBF.len),j=="B"&&N=="N"&&(j="N",D[p]=x[p].DBF.dec,S=x[p].DBF.len),_[p]=j=="C"||N=="N"?S:i[j]||0,y+=_[p],w[p]=j}var A=d.next(32);for(A.write_shift(4,318902576),A.write_shift(4,m.length),A.write_shift(2,296+32*v),A.write_shift(2,y),p=0;p<4;++p)A.write_shift(4,0);for(A.write_shift(4,0|(+t[Bc]||3)<<8),p=0,g=0;p<h.length;++p)if(h[p]!=null){var T=d.next(32),L=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,L,"sbcs"),T.write_shift(1,w[p]=="?"?"C":w[p],"sbcs"),T.write_shift(4,g),T.write_shift(1,_[p]||i[w[p]]||0),T.write_shift(1,D[p]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),g+=_[p]||i[w[p]]||0}var O=d.next(264);for(O.write_shift(4,13),p=0;p<65;++p)O.write_shift(4,0);for(p=0;p<m.length;++p){var V=d.next(y);for(V.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(w[g]){case"L":V.write_shift(1,m[p][g]==null?63:m[p][g]?84:70);break;case"B":V.write_shift(8,m[p][g]||0,"f");break;case"N":var W="0";for(typeof m[p][g]=="number"&&(W=m[p][g].toFixed(D[g]||0)),v=0;v<_[g]-W.length;++v)V.write_shift(1,32);V.write_shift(1,W,"sbcs");break;case"D":m[p][g]?(V.write_shift(4,("0000"+m[p][g].getFullYear()).slice(-4),"sbcs"),V.write_shift(2,("00"+(m[p][g].getMonth()+1)).slice(-2),"sbcs"),V.write_shift(2,("00"+m[p][g].getDate()).slice(-2),"sbcs")):V.write_shift(8,"00000000","sbcs");break;case"C":var B=String(m[p][g]!=null?m[p][g]:"").slice(0,_[g]);for(V.write_shift(1,B,"sbcs"),v=0;v<_[g]-B.length;++v)V.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),JB=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+zr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,m){var x=e[m];return typeof x=="number"?uj(x):x},n=function(h,m,x){var p=m.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return p==59?h:uj(p)};e["|"]=254;function a(h,m){switch(m.type){case"base64":return i(oi(h),m);case"binary":return i(h,m);case"buffer":return i(Tt&&Buffer.isBuffer(h)?h.toString("binary"):zl(h),m);case"array":return i(zc(h),m)}throw new Error("Unrecognized type "+m.type)}function i(h,m){var x=h.split(/[\n\r]+/),p=-1,g=-1,v=0,y=0,b=[],w=[],_=null,D={},j=[],N=[],S=[],E=0,A;for(+m.codepage>=0&&Ii(+m.codepage);v!==x.length;++v){E=0;var T=x[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),L=T.replace(/;;/g,"\0").split(";").map(function(q){return q.replace(/\u0000/g,";")}),O=L[0],V;if(T.length>0)switch(O){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":L[1].charAt(0)=="P"&&w.push(T.slice(3).replace(/;;/g,";"));break;case"C":var W=!1,B=!1,P=!1,F=!1,I=-1,R=-1;for(y=1;y<L.length;++y)switch(L[y].charAt(0)){case"A":break;case"X":g=parseInt(L[y].slice(1))-1,B=!0;break;case"Y":for(p=parseInt(L[y].slice(1))-1,B||(g=0),A=b.length;A<=p;++A)b[A]=[];break;case"K":V=L[y].slice(1),V.charAt(0)==='"'?V=V.slice(1,V.length-1):V==="TRUE"?V=!0:V==="FALSE"?V=!1:isNaN(cs(V))?isNaN(Ld(V).getDate())||(V=_r(V)):(V=cs(V),_!==null&&uu(_)&&(V=Db(V))),typeof Ut<"u"&&typeof V=="string"&&(m||{}).type!="string"&&(m||{}).codepage&&(V=Ut.utils.decode(m.codepage,V)),W=!0;break;case"E":F=!0;var C=ad(L[y].slice(1),{r:p,c:g});b[p][g]=[b[p][g],C];break;case"S":P=!0,b[p][g]=[b[p][g],"S5S"];break;case"G":break;case"R":I=parseInt(L[y].slice(1))-1;break;case"C":R=parseInt(L[y].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+T)}if(W&&(b[p][g]&&b[p][g].length==2?b[p][g][0]=V:b[p][g]=V,_=null),P){if(F)throw new Error("SYLK shared formula cannot have own formula");var k=I>-1&&b[I][R];if(!k||!k[1])throw new Error("SYLK shared formula cannot find base");b[p][g][1]=x9(k[1],{r:p-I,c:g-R})}break;case"F":var z=0;for(y=1;y<L.length;++y)switch(L[y].charAt(0)){case"X":g=parseInt(L[y].slice(1))-1,++z;break;case"Y":for(p=parseInt(L[y].slice(1))-1,A=b.length;A<=p;++A)b[A]=[];break;case"M":E=parseInt(L[y].slice(1))/20;break;case"F":break;case"G":break;case"P":_=w[parseInt(L[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=L[y].slice(1).split(" "),A=parseInt(S[0],10);A<=parseInt(S[1],10);++A)E=parseInt(S[2],10),N[A-1]=E===0?{hidden:!0}:{wch:E},Tl(N[A-1]);break;case"C":g=parseInt(L[y].slice(1))-1,N[g]||(N[g]={});break;case"R":p=parseInt(L[y].slice(1))-1,j[p]||(j[p]={}),E>0?(j[p].hpt=E,j[p].hpx=Wd(E)):E===0&&(j[p].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+T)}z<1&&(_=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+T)}}return j.length>0&&(D["!rows"]=j),N.length>0&&(D["!cols"]=N),m&&m.sheetRows&&(b=b.slice(0,m.sheetRows)),[b,D]}function s(h,m){var x=a(h,m),p=x[0],g=x[1],v=kf(p,m);return zr(g).forEach(function(y){v[y]=g[y]}),v}function l(h,m){return Hl(s(h,m),m)}function c(h,m,x,p){var g="C;Y"+(x+1)+";X"+(p+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+_E(h.f,{r:x,c:p}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function u(h,m){m.forEach(function(x,p){var g="F;W"+(p+1)+" "+(p+1)+" ";x.hidden?g+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=Vm(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=qm(x.wpx)),typeof x.wch=="number"&&(g+=Math.round(x.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function d(h,m){m.forEach(function(x,p){var g="F;";x.hidden?g+="M0;":x.hpt?g+="M"+20*x.hpt+";":x.hpx&&(g+="M"+20*Gm(x.hpx)+";"),g.length>2&&h.push(g+"R"+(p+1))})}function f(h,m){var x=["ID;PWXL;N;E"],p=[],g=Ft(h["!ref"]),v,y=Array.isArray(h),b=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&u(x,h["!cols"]),h["!rows"]&&d(x,h["!rows"]),x.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var w=g.s.r;w<=g.e.r;++w)for(var _=g.s.c;_<=g.e.c;++_){var D=pt({r:w,c:_});v=y?(h[w]||[])[_]:h[D],!(!v||v.v==null&&(!v.f||v.F))&&p.push(c(v,h,w,_))}return x.join(b)+b+p.join(b)+b+"E"+b}return{to_workbook:l,to_sheet:s,from_sheet:f}}(),QB=function(){function e(i,s){switch(s.type){case"base64":return t(oi(i),s);case"binary":return t(i,s);case"buffer":return t(Tt&&Buffer.isBuffer(i)?i.toString("binary"):zl(i),s);case"array":return t(zc(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var l=i.split(`
`),c=-1,u=-1,d=0,f=[];d!==l.length;++d){if(l[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var h=l[d].trim().split(","),m=h[0],x=h[1];++d;for(var p=l[d]||"";(p.match(/["]/g)||[]).length&1&&d<l.length-1;)p+=`
`+l[++d];switch(p=p.trim(),+m){case-1:if(p==="BOT"){f[++c]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[c][u]=!0:p==="FALSE"?f[c][u]=!1:isNaN(cs(x))?isNaN(Ld(x).getDate())?f[c][u]=x:f[c][u]=_r(x):f[c][u]=cs(x),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[c][u++]=p!==""?p:null;break}if(p==="EOD")break}}return s&&s.sheetRows&&(f=f.slice(0,s.sheetRows)),f}function r(i,s){return kf(e(i,s),s)}function n(i,s){return Hl(r(i,s),s)}var a=function(){var i=function(c,u,d,f,h){c.push(u),c.push(d+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},s=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=Ft(c["!ref"]),f,h=Array.isArray(c);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,d.e.r-d.s.r+1,""),i(u,"TUPLES",0,d.e.c-d.s.c+1,""),i(u,"DATA",0,0,"");for(var m=d.s.r;m<=d.e.r;++m){s(u,-1,0,"BOT");for(var x=d.s.c;x<=d.e.c;++x){var p=pt({r:m,c:x});if(f=h?(c[m]||[])[x]:c[p],!f){s(u,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?s(u,1,0,"="+f.f):s(u,1,0,""):s(u,0,g,"V");break;case"b":s(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":s(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=li(f.z||dt[14],dn(_r(f.v)))),s(u,0,f.w,"V");break;default:s(u,1,0,"")}}}s(u,-1,0,"EOD");var v=`\r
`,y=u.join(v);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),e9=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var m=f.split(`
`),x=-1,p=-1,g=0,v=[];g!==m.length;++g){var y=m[g].trim().split(":");if(y[0]==="cell"){var b=Fr(y[1]);if(v.length<=b.r)for(x=v.length;x<=b.r;++x)v[x]||(v[x]=[]);switch(x=b.r,p=b.c,y[2]){case"t":v[x][p]=e(y[3]);break;case"v":v[x][p]=+y[3];break;case"vtf":var w=y[y.length-1];case"vtc":switch(y[3]){case"nl":v[x][p]=!!+y[4];break;default:v[x][p]=+y[4];break}y[2]=="vtf"&&(v[x][p]=[v[x][p],w])}}}return h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),v}function n(f,h){return kf(r(f,h),h)}function a(f,h){return Hl(n(f,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var h=[],m=[],x,p="",g=ba(f["!ref"]),v=Array.isArray(f),y=g.s.r;y<=g.e.r;++y)for(var b=g.s.c;b<=g.e.c;++b)if(p=pt({r:y,c:b}),x=v?(f[y]||[])[b]:f[p],!(!x||x.v==null||x.t==="z")){switch(m=["cell",p,"t"],x.t){case"s":case"str":m.push(t(x.v));break;case"n":x.f?(m[2]="vtf",m[3]="n",m[4]=x.v,m[5]=t(x.f)):(m[2]="v",m[3]=x.v);break;case"b":m[2]="vt"+(x.f?"f":"c"),m[3]="nl",m[4]=x.v?"1":"0",m[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var w=dn(_r(x.v));m[2]="vtc",m[3]="nd",m[4]=""+w,m[5]=x.w||li(x.z||dt[14],w);break;case"e":continue}h.push(m.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[i,s,l,s,u(f),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}}(),Bd=function(){function e(d,f,h,m,x){x.raw?f[h][m]=d:d===""||(d==="TRUE"?f[h][m]=!0:d==="FALSE"?f[h][m]=!1:isNaN(cs(d))?isNaN(Ld(d).getDate())?f[h][m]=d:f[h][m]=_r(d):f[h][m]=cs(d))}function t(d,f){var h=f||{},m=[];if(!d||d.length===0)return m;for(var x=d.split(/[\r\n]/),p=x.length-1;p>=0&&x[p].length===0;)--p;for(var g=10,v=0,y=0;y<=p;++y)v=x[y].indexOf(" "),v==-1?v=x[y].length:v++,g=Math.max(g,v);for(y=0;y<=p;++y){m[y]=[];var b=0;for(e(x[y].slice(0,g).trim(),m,y,b,h),b=1;b<=(x[y].length-g)/10+1;++b)e(x[y].slice(g+(b-1)*10,g+b*10).trim(),m,y,b,h)}return h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var f={},h=!1,m=0,x=0;m<d.length;++m)(x=d.charCodeAt(m))==34?h=!h:!h&&x in r&&(f[x]=(f[x]||0)+1);x=[];for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&x.push([f[m],m]);if(!x.length){f=n;for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&x.push([f[m],m])}return x.sort(function(p,g){return p[0]-g[0]||n[p[1]]-n[g[1]]}),r[x.pop()[1]]||44}function i(d,f){var h=f||{},m="",x=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(m=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(m=d.charAt(4),d=d.slice(6)):m=a(d.slice(0,1024)):h&&h.FS?m=h.FS:m=a(d.slice(0,1024));var g=0,v=0,y=0,b=0,w=0,_=m.charCodeAt(0),D=!1,j=0,N=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var S=h.dateNF!=null?AAe(h.dateNF):null;function E(){var A=d.slice(b,w),T={};if(A.charAt(0)=='"'&&A.charAt(A.length-1)=='"'&&(A=A.slice(1,-1).replace(/""/g,'"')),A.length===0)T.t="z";else if(h.raw)T.t="s",T.v=A;else if(A.trim().length===0)T.t="s",T.v=A;else if(A.charCodeAt(0)==61)A.charCodeAt(1)==34&&A.charCodeAt(A.length-1)==34?(T.t="s",T.v=A.slice(2,-1).replace(/""/g,'"')):o5e(A)?(T.t="n",T.f=A.slice(1)):(T.t="s",T.v=A);else if(A=="TRUE")T.t="b",T.v=!0;else if(A=="FALSE")T.t="b",T.v=!1;else if(!isNaN(y=cs(A)))T.t="n",h.cellText!==!1&&(T.w=A),T.v=y;else if(!isNaN(Ld(A).getDate())||S&&A.match(S)){T.z=h.dateNF||dt[14];var L=0;S&&A.match(S)&&(A=OAe(A,h.dateNF,A.match(S)||[]),L=1),h.cellDates?(T.t="d",T.v=_r(A,L)):(T.t="n",T.v=dn(_r(A,L))),h.cellText!==!1&&(T.w=li(T.z,T.v instanceof Date?dn(T.v):T.v)),h.cellNF||delete T.z}else T.t="s",T.v=A;if(T.t=="z"||(h.dense?(x[g]||(x[g]=[]),x[g][v]=T):x[pt({c:v,r:g})]=T),b=w+1,N=d.charCodeAt(b),p.e.c<v&&(p.e.c=v),p.e.r<g&&(p.e.r=g),j==_)++v;else if(v=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;w<d.length;++w)switch(j=d.charCodeAt(w)){case 34:N===34&&(D=!D);break;case _:case 10:case 13:if(!D&&E())break e;break}return w-b>0&&E(),x["!ref"]=Dt(p),x}function s(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,f):kf(t(d,f),f)}function l(d,f){var h="",m=f.type=="string"?[0,0,0,0]:AE(d,f);switch(f.type){case"base64":h=oi(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof Ut<"u"?h=Ut.utils.decode(f.codepage,d):h=Tt&&Buffer.isBuffer(d)?d.toString("binary"):zl(d);break;case"array":h=zc(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return m[0]==239&&m[1]==187&&m[2]==191?h=ir(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=ir(h):f.type=="binary"&&typeof Ut<"u"&&f.codepage&&(h=Ut.utils.decode(f.codepage,Ut.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?e9.to_sheet(f.type=="string"?h:ir(h),f):s(h,f)}function c(d,f){return Hl(l(d,f),f)}function u(d){for(var f=[],h=Ft(d["!ref"]),m,x=Array.isArray(d),p=h.s.r;p<=h.e.r;++p){for(var g=[],v=h.s.c;v<=h.e.c;++v){var y=pt({r:p,c:v});if(m=x?(d[p]||[])[v]:d[y],!m||m.v==null){g.push("          ");continue}for(var b=(m.w||(Vs(m),m.w)||"").slice(0,10);b.length<10;)b+=" ";g.push(b+(v===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function GOe(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=JB.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Bd.to_workbook(e,t)}}var Cc=function(){function e(C,k,z){if(C){Pn(C,C.l||0);for(var q=z.Enum||I;C.l<C.length;){var K=C.read_shift(2),se=q[K]||q[65535],ie=C.read_shift(2),ee=C.l+ie,ae=se.f&&se.f(C,ie,z);if(C.l=ee,k(ae,se,K))return}}}function t(C,k){switch(k.type){case"base64":return r(Za(oi(C)),k);case"binary":return r(Za(C),k);case"buffer":case"array":return r(C,k)}throw"Unsupported type "+k.type}function r(C,k){if(!C)return C;var z=k||{},q=z.dense?[]:{},K="Sheet1",se="",ie=0,ee={},ae=[],pe=[],H={s:{r:0,c:0},e:{r:0,c:0}},ne=z.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)z.Enum=I,e(C,function(X,G,ce){switch(ce){case 0:z.vers=X,X>=4096&&(z.qpro=!0);break;case 6:H=X;break;case 204:X&&(se=X);break;case 222:se=X;break;case 15:case 51:z.qpro||(X[1].v=X[1].v.slice(1));case 13:case 14:case 16:ce==14&&(X[2]&112)==112&&(X[2]&15)>1&&(X[2]&15)<15&&(X[1].z=z.dateNF||dt[14],z.cellDates&&(X[1].t="d",X[1].v=Db(X[1].v))),z.qpro&&X[3]>ie&&(q["!ref"]=Dt(H),ee[K]=q,ae.push(K),q=z.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},ie=X[3],K=se||"Sheet"+(ie+1),se="");var J=z.dense?(q[X[0].r]||[])[X[0].c]:q[pt(X[0])];if(J){J.t=X[1].t,J.v=X[1].v,X[1].z!=null&&(J.z=X[1].z),X[1].f!=null&&(J.f=X[1].f);break}z.dense?(q[X[0].r]||(q[X[0].r]=[]),q[X[0].r][X[0].c]=X[1]):q[pt(X[0])]=X[1];break}},z);else if(C[2]==26||C[2]==14)z.Enum=R,C[2]==14&&(z.qpro=!0,C.l=0),e(C,function(X,G,ce){switch(ce){case 204:K=X;break;case 22:X[1].v=X[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(X[3]>ie&&(q["!ref"]=Dt(H),ee[K]=q,ae.push(K),q=z.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},ie=X[3],K="Sheet"+(ie+1)),ne>0&&X[0].r>=ne)break;z.dense?(q[X[0].r]||(q[X[0].r]=[]),q[X[0].r][X[0].c]=X[1]):q[pt(X[0])]=X[1],H.e.c<X[0].c&&(H.e.c=X[0].c),H.e.r<X[0].r&&(H.e.r=X[0].r);break;case 27:X[14e3]&&(pe[X[14e3][0]]=X[14e3][1]);break;case 1537:pe[X[0]]=X[1],X[0]==ie&&(K=X[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(q["!ref"]=Dt(H),ee[se||K]=q,ae.push(se||K),!pe.length)return{SheetNames:ae,Sheets:ee};for(var U={},le=[],re=0;re<pe.length;++re)ee[ae[re]]?(le.push(pe[re]||ae[re]),U[pe[re]]=ee[pe[re]]||ee[ae[re]]):(le.push(pe[re]),U[pe[re]]={"!ref":"A1"});return{SheetNames:le,Sheets:U}}function n(C,k){var z=k||{};if(+z.codepage>=0&&Ii(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var q=Fa(),K=Ft(C["!ref"]),se=Array.isArray(C),ie=[];ze(q,0,i(1030)),ze(q,6,c(K));for(var ee=Math.min(K.e.r,8191),ae=K.s.r;ae<=ee;++ae)for(var pe=$r(ae),H=K.s.c;H<=K.e.c;++H){ae===K.s.r&&(ie[H]=wr(H));var ne=ie[H]+pe,U=se?(C[ae]||[])[H]:C[ne];if(!(!U||U.t=="z"))if(U.t=="n")(U.v|0)==U.v&&U.v>=-32768&&U.v<=32767?ze(q,13,m(ae,H,U.v)):ze(q,14,p(ae,H,U.v));else{var le=Vs(U);ze(q,15,f(ae,H,le.slice(0,239)))}}return ze(q,1),q.end()}function a(C,k){var z=k||{};if(+z.codepage>=0&&Ii(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var q=Fa();ze(q,0,s(C));for(var K=0,se=0;K<C.SheetNames.length;++K)(C.Sheets[C.SheetNames[K]]||{})["!ref"]&&ze(q,27,F(C.SheetNames[K],se++));var ie=0;for(K=0;K<C.SheetNames.length;++K){var ee=C.Sheets[C.SheetNames[K]];if(!(!ee||!ee["!ref"])){for(var ae=Ft(ee["!ref"]),pe=Array.isArray(ee),H=[],ne=Math.min(ae.e.r,8191),U=ae.s.r;U<=ne;++U)for(var le=$r(U),re=ae.s.c;re<=ae.e.c;++re){U===ae.s.r&&(H[re]=wr(re));var X=H[re]+le,G=pe?(ee[U]||[])[re]:ee[X];if(!(!G||G.t=="z"))if(G.t=="n")ze(q,23,E(U,re,ie,G.v));else{var ce=Vs(G);ze(q,22,j(U,re,ie,ce.slice(0,239)))}}++ie}}return ze(q,1),q.end()}function i(C){var k=Se(2);return k.write_shift(2,C),k}function s(C){var k=Se(26);k.write_shift(2,4096),k.write_shift(2,4),k.write_shift(4,0);for(var z=0,q=0,K=0,se=0;se<C.SheetNames.length;++se){var ie=C.SheetNames[se],ee=C.Sheets[ie];if(!(!ee||!ee["!ref"])){++K;var ae=ba(ee["!ref"]);z<ae.e.r&&(z=ae.e.r),q<ae.e.c&&(q=ae.e.c)}}return z>8191&&(z=8191),k.write_shift(2,z),k.write_shift(1,K),k.write_shift(1,q),k.write_shift(2,0),k.write_shift(2,0),k.write_shift(1,1),k.write_shift(1,2),k.write_shift(4,0),k.write_shift(4,0),k}function l(C,k,z){var q={s:{c:0,r:0},e:{c:0,r:0}};return k==8&&z.qpro?(q.s.c=C.read_shift(1),C.l++,q.s.r=C.read_shift(2),q.e.c=C.read_shift(1),C.l++,q.e.r=C.read_shift(2),q):(q.s.c=C.read_shift(2),q.s.r=C.read_shift(2),k==12&&z.qpro&&(C.l+=2),q.e.c=C.read_shift(2),q.e.r=C.read_shift(2),k==12&&z.qpro&&(C.l+=2),q.s.c==65535&&(q.s.c=q.e.c=q.s.r=q.e.r=0),q)}function c(C){var k=Se(8);return k.write_shift(2,C.s.c),k.write_shift(2,C.s.r),k.write_shift(2,C.e.c),k.write_shift(2,C.e.r),k}function u(C,k,z){var q=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(q[0].c=C.read_shift(1),q[3]=C.read_shift(1),q[0].r=C.read_shift(2),C.l+=2):(q[2]=C.read_shift(1),q[0].c=C.read_shift(2),q[0].r=C.read_shift(2)),q}function d(C,k,z){var q=C.l+k,K=u(C,k,z);if(K[1].t="s",z.vers==20768){C.l++;var se=C.read_shift(1);return K[1].v=C.read_shift(se,"utf8"),K}return z.qpro&&C.l++,K[1].v=C.read_shift(q-C.l,"cstr"),K}function f(C,k,z){var q=Se(7+z.length);q.write_shift(1,255),q.write_shift(2,k),q.write_shift(2,C),q.write_shift(1,39);for(var K=0;K<q.length;++K){var se=z.charCodeAt(K);q.write_shift(1,se>=128?95:se)}return q.write_shift(1,0),q}function h(C,k,z){var q=u(C,k,z);return q[1].v=C.read_shift(2,"i"),q}function m(C,k,z){var q=Se(7);return q.write_shift(1,255),q.write_shift(2,k),q.write_shift(2,C),q.write_shift(2,z,"i"),q}function x(C,k,z){var q=u(C,k,z);return q[1].v=C.read_shift(8,"f"),q}function p(C,k,z){var q=Se(13);return q.write_shift(1,255),q.write_shift(2,k),q.write_shift(2,C),q.write_shift(8,z,"f"),q}function g(C,k,z){var q=C.l+k,K=u(C,k,z);if(K[1].v=C.read_shift(8,"f"),z.qpro)C.l=q;else{var se=C.read_shift(2);w(C.slice(C.l,C.l+se),K),C.l+=se}return K}function v(C,k,z){var q=k&32768;return k&=-32769,k=(q?C:0)+(k>=8192?k-16384:k),(q?"":"$")+(z?wr(k):$r(k))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(C,k){Pn(C,0);for(var z=[],q=0,K="",se="",ie="",ee="";C.l<C.length;){var ae=C[C.l++];switch(ae){case 0:z.push(C.read_shift(8,"f"));break;case 1:se=v(k[0].c,C.read_shift(2),!0),K=v(k[0].r,C.read_shift(2),!1),z.push(se+K);break;case 2:{var pe=v(k[0].c,C.read_shift(2),!0),H=v(k[0].r,C.read_shift(2),!1);se=v(k[0].c,C.read_shift(2),!0),K=v(k[0].r,C.read_shift(2),!1),z.push(pe+H+":"+se+K)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(C.read_shift(2));break;case 6:{for(var ne="";ae=C[C.l++];)ne+=String.fromCharCode(ae);z.push('"'+ne.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:ee=z.pop(),ie=z.pop(),z.push(["AND","OR"][ae-20]+"("+ie+","+ee+")");break;default:if(ae<32&&b[ae])ee=z.pop(),ie=z.pop(),z.push(ie+b[ae]+ee);else if(y[ae]){if(q=y[ae][1],q==69&&(q=C[C.l++]),q>z.length){console.error("WK1 bad formula parse 0x"+ae.toString(16)+":|"+z.join("|")+"|");return}var U=z.slice(-q);z.length-=q,z.push(y[ae][0]+"("+U.join(",")+")")}else return ae<=7?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=24?console.error("WK1 unsupported op "+ae.toString(16)):ae<=30?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=115?console.error("WK1 unsupported function opcode "+ae.toString(16)):console.error("WK1 unrecognized opcode "+ae.toString(16))}}z.length==1?k[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function _(C){var k=[{c:0,r:0},{t:"n",v:0},0];return k[0].r=C.read_shift(2),k[3]=C[C.l++],k[0].c=C[C.l++],k}function D(C,k){var z=_(C);return z[1].t="s",z[1].v=C.read_shift(k-4,"cstr"),z}function j(C,k,z,q){var K=Se(6+q.length);K.write_shift(2,C),K.write_shift(1,z),K.write_shift(1,k),K.write_shift(1,39);for(var se=0;se<q.length;++se){var ie=q.charCodeAt(se);K.write_shift(1,ie>=128?95:ie)}return K.write_shift(1,0),K}function N(C,k){var z=_(C);z[1].v=C.read_shift(2);var q=z[1].v>>1;if(z[1].v&1)switch(q&7){case 0:q=(q>>3)*5e3;break;case 1:q=(q>>3)*500;break;case 2:q=(q>>3)/20;break;case 3:q=(q>>3)/200;break;case 4:q=(q>>3)/2e3;break;case 5:q=(q>>3)/2e4;break;case 6:q=(q>>3)/16;break;case 7:q=(q>>3)/64;break}return z[1].v=q,z}function S(C,k){var z=_(C),q=C.read_shift(4),K=C.read_shift(4),se=C.read_shift(2);if(se==65535)return q===0&&K===3221225472?(z[1].t="e",z[1].v=15):q===0&&K===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var ie=se&32768;return se=(se&32767)-16446,z[1].v=(1-ie*2)*(K*Math.pow(2,se+32)+q*Math.pow(2,se)),z}function E(C,k,z,q){var K=Se(14);if(K.write_shift(2,C),K.write_shift(1,z),K.write_shift(1,k),q==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var se=0,ie=0,ee=0,ae=0;return q<0&&(se=1,q=-q),ie=Math.log2(q)|0,q/=Math.pow(2,ie-31),ae=q>>>0,ae&2147483648||(q/=2,++ie,ae=q>>>0),q-=ae,ae|=2147483648,ae>>>=0,q*=Math.pow(2,32),ee=q>>>0,K.write_shift(4,ee),K.write_shift(4,ae),ie+=16383+(se?32768:0),K.write_shift(2,ie),K}function A(C,k){var z=S(C);return C.l+=k-14,z}function T(C,k){var z=_(C),q=C.read_shift(4);return z[1].v=q>>6,z}function L(C,k){var z=_(C),q=C.read_shift(8,"f");return z[1].v=q,z}function O(C,k){var z=L(C);return C.l+=k-10,z}function V(C,k){return C[C.l+k-1]==0?C.read_shift(k,"cstr"):""}function W(C,k){var z=C[C.l++];z>k-1&&(z=k-1);for(var q="";q.length<z;)q+=String.fromCharCode(C[C.l++]);return q}function B(C,k,z){if(!(!z.qpro||k<21)){var q=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var K=C.read_shift(k-21,"cstr");return[q,K]}}function P(C,k){for(var z={},q=C.l+k;C.l<q;){var K=C.read_shift(2);if(K==14e3){for(z[K]=[0,""],z[K][0]=C.read_shift(2);C[C.l];)z[K][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return z}function F(C,k){var z=Se(5+C.length);z.write_shift(2,14e3),z.write_shift(2,k);for(var q=0;q<C.length;++q){var K=C.charCodeAt(q);z[z.l++]=K>127?95:K}return z[z.l++]=0,z}var I={0:{n:"BOF",f:en},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:V},222:{n:"SHEETNAMELP",f:W},65535:{n:""}},R={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:D},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:N},25:{n:"FORMULA19",f:A},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:P},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:L},40:{n:"FORMULA28",f:O},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:V},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:B},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function YOe(e){var t={},r=e.match(oa),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=xt(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=VS[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var XOe=function(){var e=Lm("t"),t=Lm("rPr");function r(i){var s=i.match(e);if(!s)return{t:"s",v:""};var l={t:"s",v:Bt(s[1])},c=i.match(t);return c&&(l.s=YOe(c[1])),l}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(r).filter(function(l){return l.v})}}(),KOe=function(){var t=/(\r\n|\n)/g;function r(a,i,s){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),s.push("</"+c+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),ZOe=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,JOe=/<(?:\w+:)?r>/,QOe=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function gE(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Bt(ir(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=ir(e),r&&(n.h=QS(n.t))):e.match(JOe)&&(n.r=ir(e),n.t=Bt(ir((e.replace(QOe,"").match(ZOe)||[]).join("").replace(oa,""))),r&&(n.h=KOe(XOe(n.r)))),n):{t:""}}var eFe=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,tFe=/<(?:\w+:)?(?:si|sstItem)>/g,rFe=/<\/(?:\w+:)?(?:si|sstItem)>/;function nFe(e,t){var r=[],n="";if(!e)return r;var a=e.match(eFe);if(a){n=a[2].replace(tFe,"").split(rFe);for(var i=0;i!=n.length;++i){var s=gE(n[i].trim(),t);s!=null&&(r[r.length]=s)}a=xt(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var aFe=/^\s|\s$|[\t\n\r]/;function t9(e,t){if(!t.bookSST)return"";var r=[Yr];r[r.length]=We("sst",null,{xmlns:du[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(aFe)&&(i+=' xml:space="preserve"'),i+=">"+Qt(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function iFe(e){return[e.read_shift(4),e.read_shift(4)]}function sFe(e,t){var r=[],n=!1;return Vo(e,function(i,s,l){switch(l){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function oFe(e,t){return t||(t=Se(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var lFe=v3e;function cFe(e){var t=Fa();Oe(t,159,oFe(e));for(var r=0;r<e.length;++r)Oe(t,19,lFe(e[r]));return Oe(t,160),t.end()}function r9(e){if(typeof Ut<"u")return Ut.utils.encode(Bc,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function No(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function uFe(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=No(e,4),t.U=No(e,4),t.W=No(e,4),t}function dFe(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function fFe(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(dFe(e));return t}function hFe(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function mFe(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=No(e,4),t.U=No(e,4),t.W=No(e,4),t}function pFe(e){var t=mFe(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function n9(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function a9(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function xFe(e){var t=No(e);switch(t.Minor){case 2:return[t.Minor,gFe(e)];case 3:return[t.Minor,vFe()];case 4:return[t.Minor,yFe(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function gFe(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=n9(e,r),a=a9(e,e.length-e.l);return{t:"Std",h:n,v:a}}function vFe(){throw new Error("File is password-protected: ECMA-376 Extensible")}function yFe(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(oa,function(i){var s=xt(i);switch(Xs(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=s[l]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function bFe(e,t){var r={},n=r.EncryptionVersionInfo=No(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=n9(e,a),t-=a,r.EncryptionVerifier=a9(e,t),r}function wFe(e){var t={},r=t.EncryptionVersionInfo=No(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function vE(e){var t=0,r,n=r9(e),a=n.length+1,i,s,l,c,u;for(r=El(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],l=t&16384?1:0,c=t<<1&32767,u=l|c,t=u^s;return t^52811}var i9=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,l){return n(s^l)},i=function(s){for(var l=t[s.length-1],c=104,u=s.length-1;u>=0;--u)for(var d=s[u],f=0;f!=7;++f)d&64&&(l^=r[c]),d*=2,--c;return l};return function(s){for(var l=r9(s),c=i(l),u=l.length,d=El(16),f=0;f!=16;++f)d[f]=0;var h,m,x;for((u&1)===1&&(h=c>>8,d[u]=a(e[0],h),--u,h=c&255,m=l[l.length-1],d[u]=a(m,h));u>0;)--u,h=c>>8,d[u]=a(l[u],h),--u,h=c&255,d[u]=a(l[u],h);for(u=15,x=15-l.length;x>0;)h=c>>8,d[u]=a(e[x],h),--u,--x,h=c&255,d[u]=a(l[u],h),--u,--x;return d}}(),_Fe=function(e,t,r,n,a){a||(a=t),n||(n=i9(e));var i,s;for(i=0;i!=t.length;++i)s=t[i],s^=n[r],s=(s>>5|s<<3)&255,a[i]=s,++r;return[a,r,n]},DFe=function(e){var t=0,r=i9(e);return function(n){var a=_Fe("",n,t,r);return t=a[1],a[0]}};function jFe(e,t,r,n){var a={key:en(e),verificationBytes:en(e)};return r.password&&(a.verifier=vE(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=DFe(r.password)),a}function NFe(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=wFe(e):n.Data=bFe(e,t),n}function SFe(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?NFe(e,t-2,n):jFe(e,r.biff>=8?t:t-2,r,n),n}var s9=function(){function e(a,i){switch(i.type){case"base64":return t(oi(a),i);case"binary":return t(a,i);case"buffer":return t(Tt&&Buffer.isBuffer(a)?a.toString("binary"):zl(a),i);case"array":return t(zc(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},l=s.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(l)&&(l[f]=[]);for(var h=/\\\w+\b/g,m=0,x,p=-1;x=h.exec(d);){switch(x[0]){case"\\cell":var g=d.slice(m,h.lastIndex-x[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var v={v:g,t:"s"};Array.isArray(l)?l[f][p]=v:l[pt({r:f,c:p})]=v}break}m=h.lastIndex}p>u.e.c&&(u.e.c=p)}),l["!ref"]=Dt(u),l}function r(a,i){return Hl(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=Ft(a["!ref"]),l,c=Array.isArray(a),u=s.s.r;u<=s.e.r;++u){i.push("\\trowd\\trautofit1");for(var d=s.s.c;d<=s.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=s.s.c;d<=s.e.c;++d){var f=pt({r:u,c:d});l=c?(a[u]||[])[d]:a[f],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(Vs(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function EFe(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Hm(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function TFe(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),s=a-i;if(s===0)return[0,0,t];var l=0,c=0,u=a+i;switch(c=s/(u>1?2-u:u),a){case t:l=((r-n)/s+6)%6;break;case r:l=(n-t)/s+2;break;case n:l=(t-r)/s+4;break}return[l/6,c,u/2]}function kFe(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=a*l,s[0]+=a,s[1]+=c;break;case 1:c=a*(2-l),s[0]+=c,s[1]+=a;break;case 2:c=a*(l-2),s[1]+=a,s[2]+=c;break;case 3:c=a*(4-l),s[1]+=c,s[2]+=a;break;case 4:c=a*(l-4),s[2]+=a,s[0]+=c;break;case 5:c=a*(6-l),s[2]+=c,s[0]+=a;break}for(var u=0;u!=3;++u)s[u]=Math.round(s[u]*255);return s}function xv(e,t){if(t===0)return e;var r=TFe(EFe(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Hm(kFe(r))}var o9=6,CFe=15,AFe=1,Zn=o9;function Vm(e){return Math.floor((e+Math.round(128/Zn)/256)*Zn)}function qm(e){return Math.floor((e-5)/Zn*100+.5)/100}function gv(e){return Math.round((e*Zn+5)/Zn*256)/256}function Iw(e){return gv(qm(Vm(e)))}function yE(e){var t=Math.abs(e-Iw(e)),r=Zn;if(t>.005)for(Zn=AFe;Zn<CFe;++Zn)Math.abs(e-Iw(e))<=t&&(t=Math.abs(e-Iw(e)),r=Zn);Zn=r}function Tl(e){e.width?(e.wpx=Vm(e.width),e.wch=qm(e.wpx),e.MDW=Zn):e.wpx?(e.wch=qm(e.wpx),e.width=gv(e.wch),e.MDW=Zn):typeof e.wch=="number"&&(e.width=gv(e.wch),e.wpx=Vm(e.width),e.MDW=Zn),e.customWidth&&delete e.customWidth}var OFe=96,l9=OFe;function Gm(e){return e*96/l9}function Wd(e){return e*l9/96}var FFe={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function PFe(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(oa)||[]).forEach(function(s){var l=xt(s);switch(Xs(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=yr(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=yr(l.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function IFe(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(oa)||[]).forEach(function(s){var l=xt(s);switch(Xs(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function RFe(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(oa)||[]).forEach(function(s){var l=xt(s);switch(Xs(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=ir(l.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=l.val?yr(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?yr(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?yr(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?yr(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?yr(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?yr(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?yr(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=VS[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=yr(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var c=Tc[a.color.index];a.color.index==81&&(c=Tc[1]),c||(c=Tc[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=xv(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function MFe(e,t,r){t.NumberFmt=[];for(var n=zr(dt),a=0;a<n.length;++a)t.NumberFmt[n[a]]=dt[n[a]];var i=e[0].match(oa);if(i)for(a=0;a<i.length;++a){var s=xt(i[a]);switch(Xs(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=Bt(ir(s.formatCode)),c=parseInt(s.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}Us(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function UFe(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=We("numFmt",null,{numFmtId:n,formatCode:Qt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=We("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var i0=["numFmtId","fillId","fontId","borderId","xfId"],s0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function $Fe(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(oa)||[]).forEach(function(i){var s=xt(i),l=0;switch(Xs(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],l=0;l<i0.length;++l)n[i0[l]]&&(n[i0[l]]=parseInt(n[i0[l]],10));for(l=0;l<s0.length;++l)n[s0[l]]&&(n[s0[l]]=yr(n[s0[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};s.vertical&&(c.vertical=s.vertical),s.horizontal&&(c.horizontal=s.horizontal),s.textRotation!=null&&(c.textRotation=s.textRotation),s.indent&&(c.indent=s.indent),s.wrapText&&(c.wrapText=yr(s.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function LFe(e){var t=[];return t[t.length]=We("cellXfs",null),e.forEach(function(r){t[t.length]=We("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=We("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var BFe=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(t))&&MFe(f,d,u),(f=l.match(a))&&RFe(f,d,c,u),(f=l.match(n))&&IFe(f,d,c,u),(f=l.match(i))&&PFe(f,d,c,u),(f=l.match(r))&&$Fe(f,d,u),d}}();function c9(e,t){var r=[Yr,We("styleSheet",null,{xmlns:du[0],"xmlns:vt":ln.vt})],n;return e.SSF&&(n=UFe(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=LFe(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function WFe(e,t){var r=e.read_shift(2),n=ra(e);return[r,n]}function zFe(e,t,r){r||(r=Se(6+4*t.length)),r.write_shift(2,e),wn(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function HFe(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=N3e(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=j3e(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=ra(e),n}function VFe(e,t){t||(t=Se(25+4*32)),t.write_shift(2,e.sz*20),S3e(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),hv(e.color,t);var n=0;return n=2,t.write_shift(1,n),wn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var qFe=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Rw,GFe=aa;function dP(e,t){t||(t=Se(4*3+8*7+16*1)),Rw||(Rw=wb(qFe));var r=Rw[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(hv({auto:1},t),hv({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function YFe(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function u9(e,t,r){r||(r=Se(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function oh(e,t){return t||(t=Se(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var XFe=aa;function KFe(e,t){return t||(t=Se(51)),t.write_shift(1,0),oh(null,t),oh(null,t),oh(null,t),oh(null,t),oh(null,t),t.length>t.l?t.slice(0,t.l):t}function ZFe(e,t){return t||(t=Se(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),fv(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function JFe(e,t,r){var n=Se(2052);return n.write_shift(4,e),fv(t,n),fv(r,n),n.length>n.l?n.slice(0,n.l):n}function QFe(e,t,r){var n={};n.NumberFmt=[];for(var a in dt)n.NumberFmt[a]=dt[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return Vo(e,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],Us(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=xv(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(d),s=!0;break;case 38:i.pop(),s=!1;break;default:if(u.T>0)i.push(d);else if(u.T<0)i.pop();else if(!s||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function ePe(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(Oe(e,615,us(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Oe(e,44,zFe(a,t[a]))}),Oe(e,616))}}function tPe(e){var t=1;Oe(e,611,us(t)),Oe(e,43,VFe({sz:12,color:{theme:1},name:"Calibri",family:2})),Oe(e,612)}function rPe(e){var t=2;Oe(e,603,us(t)),Oe(e,45,dP({patternType:"none"})),Oe(e,45,dP({patternType:"gray125"})),Oe(e,604)}function nPe(e){var t=1;Oe(e,613,us(t)),Oe(e,46,KFe()),Oe(e,614)}function aPe(e){var t=1;Oe(e,626,us(t)),Oe(e,47,u9({numFmtId:0},65535)),Oe(e,627)}function iPe(e,t){Oe(e,617,us(t.length)),t.forEach(function(r){Oe(e,47,u9(r,0))}),Oe(e,618)}function sPe(e){var t=1;Oe(e,619,us(t)),Oe(e,48,ZFe({xfId:0,name:"Normal"})),Oe(e,620)}function oPe(e){var t=0;Oe(e,505,us(t)),Oe(e,506)}function lPe(e){var t=0;Oe(e,508,JFe(t,"TableStyleMedium9","PivotStyleMedium4")),Oe(e,509)}function cPe(e,t){var r=Fa();return Oe(r,278),ePe(r,e.SSF),tPe(r),rPe(r),nPe(r),aPe(r),iPe(r,t.cellXfs),sPe(r),oPe(r),lPe(r),Oe(r,279),r.end()}var uPe=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function dPe(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(oa)||[]).forEach(function(a){var i=xt(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[uPe.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function fPe(){}function hPe(){}var mPe=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,pPe=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,xPe=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function gPe(e,t,r){t.themeElements={};var n;[["clrScheme",mPe,dPe],["fontScheme",pPe,fPe],["fmtScheme",xPe,hPe]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var vPe=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function d9(e,t){(!e||e.length===0)&&(e=bE());var r,n={};if(!(r=e.match(vPe)))throw new Error("themeElements not found in theme");return gPe(r[0],n,t),n.raw=e,n}function bE(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Yr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function yPe(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var s;try{s=oB(i,{type:"array"})}catch{return}var l=Ja(s,"theme/theme/theme1.xml",!0);if(l)return d9(l,r)}}function bPe(e){return e.read_shift(4)}function wPe(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=_Pe(e,4);break;case 2:t.xclrValue=HB(e);break;case 3:t.xclrValue=bPe(e);break;case 4:e.l+=4;break}return e.l+=8,t}function _Pe(e,t){return aa(e,t)}function DPe(e,t){return aa(e,t)}function jPe(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=wPe(e);break;case 6:n[1]=DPe(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function NPe(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(jPe(e,r-e.l));return{ixfe:n,ext:i}}function SPe(e,t){t.forEach(function(r){switch(r[0]){}})}function EPe(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ra(e)}}function TPe(e){var t=Se(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),wn(e.name,t),t.slice(0,t.l)}function kPe(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function CPe(e){var t=Se(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function APe(e,t){var r=Se(8+2*t.length);return r.write_shift(4,e),wn(t,r),r.slice(0,r.l)}function OPe(e){return e.l+=4,e.read_shift(4)!=0}function FPe(e,t){var r=Se(8);return r.write_shift(4,e),r.write_shift(4,1),r}function PPe(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],s=!1,l=2;return Vo(e,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):l==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:i.push(d),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!u.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function IPe(){var e=Fa();return Oe(e,332),Oe(e,334,us(1)),Oe(e,335,TPe({name:"XLDAPR",version:12e4,flags:3496657072})),Oe(e,336),Oe(e,339,APe(1,"XLDAPR")),Oe(e,52),Oe(e,35,us(514)),Oe(e,4096,us(0)),Oe(e,4097,Ni(1)),Oe(e,36),Oe(e,53),Oe(e,340),Oe(e,337,FPe(1)),Oe(e,51,CPe([[1,0]])),Oe(e,338),Oe(e,333),e.end()}function RPe(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,s;return e.replace(oa,function(l){var c=xt(l);switch(Xs(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(s=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):i==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+c.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function f9(){var e=[Yr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function MPe(e){var t=[];if(!e)return t;var r=1;return(e.match(oa)||[]).forEach(function(n){var a=xt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function UPe(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=pt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function $Pe(e,t,r){var n=[];return Vo(e,function(i,s,l){switch(l){case 63:n.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function LPe(e,t,r,n){if(!e)return e;var a=n||{},i=!1;Vo(e,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function BPe(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Gu=1024;function h9(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[We("xml",null,{"xmlns:v":Xa.v,"xmlns:o":Xa.o,"xmlns:x":Xa.x,"xmlns:mv":Xa.mv}).replace(/\/>/,">"),We("o:shapelayout",We("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),We("v:shapetype",[We("v:stroke",null,{joinstyle:"miter"}),We("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Gu<e*1e3;)Gu+=1e3;return t.forEach(function(i){var s=Fr(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?We("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=We("v:fill",c,l),d={on:"t",obscured:"t"};++Gu,a=a.concat(["<v:shape"+Bm({id:"_x0000_s"+Gu,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,We("v:shadow",null,d),We("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",In("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),In("x:AutoFill","False"),In("x:Row",String(s.r)),In("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function fP(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(s){var l=Fr(s.ref);if(a?(e[l.r]||(e[l.r]=[]),i=e[l.r][l.c]):i=e[s.ref],!i){i={t:"z"},a?e[l.r][l.c]=i:e[s.ref]=i;var c=Ft(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=Dt(c);u!==e["!ref"]&&(e["!ref"]=u)}i.c||(i.c=[]);var d={a:s.author,t:s.t,r:s.r,T:r};s.h&&(d.h=s.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}i.c.push(d)})}function WPe(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var l=s.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var l=s.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=xt(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=Fr(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&gE(f[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function m9(e){var t=[Yr,We("comments",null,{xmlns:du[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=Qt(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(Qt(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(In("t",Qt(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)s+=`Reply:
    `+i[l]+`
`;t.push(In("t",Qt(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function zPe(e,t){var r=[],n=!1,a={},i=0;return e.replace(oa,function(l,c){var u=xt(l);switch(Xs(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=c+l.length;break;case"</text>":a.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function HPe(e,t,r){var n=[Yr,We("ThreadedComments",null,{xmlns:ln.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,l){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,s.ID=c.id,s.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(We("threadedComment",In("text",s.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function VPe(e,t){var r=[],n=!1;return e.replace(oa,function(i){var s=xt(i);switch(Xs(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),r}function qPe(e){var t=[Yr,We("personList",null,{xmlns:ln.TCMNT,"xmlns:x":du[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(We("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function GPe(e){var t={};t.iauthor=e.read_shift(4);var r=pu(e);return t.rfx=r.s,t.ref=pt(r.s),e.l+=16,t}function YPe(e,t){return t==null&&(t=Se(36)),t.write_shift(4,e[1].iauthor),Cf(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var XPe=ra;function KPe(e){return wn(e.slice(0,54))}function ZPe(e,t){var r=[],n=[],a={},i=!1;return Vo(e,function(l,c,u){switch(u){case 632:n.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function JPe(e){var t=Fa(),r=[];return Oe(t,628),Oe(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Oe(t,632,KPe(a.a)))})}),Oe(t,631),Oe(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:Fr(n[0]),e:Fr(n[0])};Oe(t,635,YPe([i,a])),a.t&&a.t.length>0&&Oe(t,637,b3e(a)),Oe(t,636),delete a.iauthor})}),Oe(t,634),Oe(t,629),t.end()}var QPe="application/vnd.ms-office.vbaProject";function e5e(e){var t=it.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");it.utils.cfb_add(t,a,e.FileIndex[n].content)}}),it.write(t)}function t5e(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&it.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var p9=["xlsb","xlsm","xlam","biff8","xla"];function r5e(){return{"!type":"dialog"}}function n5e(){return{"!type":"dialog"}}function a5e(){return{"!type":"macro"}}function i5e(){return{"!type":"macro"}}var ad=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,d=s.length>0?parseInt(s,10)|0:0;return l?d+=t.c:--d,c?u+=t.r:--u,a+(l?"":"$")+wr(d)+(c?"":"$")+$r(u)}return function(a,i){return t=i,a.replace(e,r)}}(),wE=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,_E=function(){return function(t,r){return t.replace(wE,function(n,a,i,s,l,c){var u=lE(s)-(i?0:r.c),d=oE(c)-(l?0:r.r),f=d==0?"":l?d+1:"["+d+"]",h=u==0?"":i?u+1:"["+u+"]";return a+"R"+f+"C"+h})}}();function x9(e,t){return e.replace(wE,function(r,n,a,i,s,l){return n+(a=="$"?a+i:wr(lE(i)+t.c))+(s=="$"?s+l:$r(oE(l)+t.r))})}function s5e(e,t,r){var n=ba(t),a=n.s,i=Fr(r),s={r:i.r-a.r,c:i.c-a.c};return x9(e,s)}function o5e(e){return e.length!=1}function hP(e){return e.replace(/_xlfn\./g,"")}function Zr(e){e.l+=1}function kl(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function g9(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return v9(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=kl(e),l=kl(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function v9(e){var t=kl(e),r=kl(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function l5e(e,t,r){if(r.biff<8)return v9(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=kl(e),s=kl(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function y9(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return c5e(e);var n=e.read_shift(r&&r.biff==12?4:2),a=kl(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function c5e(e){var t=kl(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function u5e(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function d5e(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return f5e(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:l}}function f5e(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function h5e(e,t,r){var n=(e[e.l++]&96)>>5,a=g9(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function m5e(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=g9(e,i,r);return[n,a,s]}function p5e(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function x5e(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function g5e(e,t,r){var n=(e[e.l++]&96)>>5,a=l5e(e,t-1,r);return[n,a]}function v5e(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function mP(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function y5e(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function b5e(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function w5e(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function _5e(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function D5e(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function b9(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function j5e(e){return e.read_shift(2),b9(e)}function N5e(e){return e.read_shift(2),b9(e)}function S5e(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=y9(e,0,r);return[n,a]}function E5e(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=d5e(e,0,r);return[n,a]}function T5e(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=y9(e,0,r);return[n,a,i]}function k5e(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[O6e[a],D9[a],n]}function C5e(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:A5e(e);return[a,(i[0]===0?D9:A6e)[i[1]]]}function A5e(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function O5e(e,t,r){e.l+=r&&r.biff==2?3:4}function F5e(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function P5e(e){return e.l++,qo[e.read_shift(1)]}function I5e(e){return e.l++,e.read_shift(2)}function R5e(e){return e.l++,e.read_shift(1)!==0}function M5e(e){return e.l++,Qn(e)}function U5e(e,t,r){return e.l++,ix(e,t-1,r)}function $5e(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Hr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=qo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Qn(e);break;case 2:r[1]=xu(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function L5e(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?pu:Nb)(e));return a}function B5e(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var l=0;l!=a;++l)s[i][l]=$5e(e,r.biff);return s}function W5e(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function z5e(e,t,r){if(r.biff==5)return H5e(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function H5e(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function V5e(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function q5e(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function G5e(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Y5e(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var X5e=aa,K5e=aa,Z5e=aa;function ox(e,t,r){return e.l+=2,[u5e(e)]}function DE(e){return e.l+=6,[]}var J5e=ox,Q5e=DE,e6e=DE,t6e=ox;function w9(e){return e.l+=2,[en(e),e.read_shift(2)&1]}var r6e=ox,n6e=w9,a6e=DE,i6e=ox,s6e=ox,o6e=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function l6e(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=o6e[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function c6e(e){return e.l+=2,[e.read_shift(4)]}function u6e(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function d6e(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function f6e(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function h6e(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function m6e(e){return e.l+=4,[0,0]}var pP={1:{n:"PtgExp",f:F5e},2:{n:"PtgTbl",f:Z5e},3:{n:"PtgAdd",f:Zr},4:{n:"PtgSub",f:Zr},5:{n:"PtgMul",f:Zr},6:{n:"PtgDiv",f:Zr},7:{n:"PtgPower",f:Zr},8:{n:"PtgConcat",f:Zr},9:{n:"PtgLt",f:Zr},10:{n:"PtgLe",f:Zr},11:{n:"PtgEq",f:Zr},12:{n:"PtgGe",f:Zr},13:{n:"PtgGt",f:Zr},14:{n:"PtgNe",f:Zr},15:{n:"PtgIsect",f:Zr},16:{n:"PtgUnion",f:Zr},17:{n:"PtgRange",f:Zr},18:{n:"PtgUplus",f:Zr},19:{n:"PtgUminus",f:Zr},20:{n:"PtgPercent",f:Zr},21:{n:"PtgParen",f:Zr},22:{n:"PtgMissArg",f:Zr},23:{n:"PtgStr",f:U5e},26:{n:"PtgSheet",f:u6e},27:{n:"PtgEndSheet",f:d6e},28:{n:"PtgErr",f:P5e},29:{n:"PtgBool",f:R5e},30:{n:"PtgInt",f:I5e},31:{n:"PtgNum",f:M5e},32:{n:"PtgArray",f:v5e},33:{n:"PtgFunc",f:k5e},34:{n:"PtgFuncVar",f:C5e},35:{n:"PtgName",f:W5e},36:{n:"PtgRef",f:S5e},37:{n:"PtgArea",f:h5e},38:{n:"PtgMemArea",f:V5e},39:{n:"PtgMemErr",f:X5e},40:{n:"PtgMemNoMem",f:K5e},41:{n:"PtgMemFunc",f:q5e},42:{n:"PtgRefErr",f:G5e},43:{n:"PtgAreaErr",f:p5e},44:{n:"PtgRefN",f:E5e},45:{n:"PtgAreaN",f:g5e},46:{n:"PtgMemAreaN",f:f6e},47:{n:"PtgMemNoMemN",f:h6e},57:{n:"PtgNameX",f:z5e},58:{n:"PtgRef3d",f:T5e},59:{n:"PtgArea3d",f:m5e},60:{n:"PtgRefErr3d",f:Y5e},61:{n:"PtgAreaErr3d",f:x5e},255:{}},p6e={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},x6e={1:{n:"PtgElfLel",f:w9},2:{n:"PtgElfRw",f:i6e},3:{n:"PtgElfCol",f:J5e},6:{n:"PtgElfRwV",f:s6e},7:{n:"PtgElfColV",f:t6e},10:{n:"PtgElfRadical",f:r6e},11:{n:"PtgElfRadicalS",f:a6e},13:{n:"PtgElfColS",f:Q5e},15:{n:"PtgElfColSV",f:e6e},16:{n:"PtgElfRadicalLel",f:n6e},25:{n:"PtgList",f:l6e},29:{n:"PtgSxName",f:c6e},255:{}},g6e={0:{n:"PtgAttrNoop",f:m6e},1:{n:"PtgAttrSemi",f:D5e},2:{n:"PtgAttrIf",f:w5e},4:{n:"PtgAttrChoose",f:y5e},8:{n:"PtgAttrGoto",f:b5e},16:{n:"PtgAttrSum",f:O5e},32:{n:"PtgAttrBaxcel",f:mP},33:{n:"PtgAttrBaxcel",f:mP},64:{n:"PtgAttrSpace",f:j5e},65:{n:"PtgAttrSpaceSemi",f:N5e},128:{n:"PtgAttrIfError",f:_5e},255:{}};function lx(e,t,r,n){if(n.biff<8)return aa(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=B5e(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=L5e(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(aa(e,t)),i}function cx(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=pP[i]||pP[p6e[i]],(i===24||i===25)&&(a=(i===24?x6e:g6e)[e[e.l+1]]),!a||!a.f?aa(e,t):s.push([a.n,a.f(e,t,r)]);return s}function v6e(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var y6e={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function b6e(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function _9(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function xP(e,t,r){var n=_9(e,t,r);return n=="#REF"?n:b6e(n,r)}function Xn(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0}},l=[],c,u,d,f=0,h=0,m,x="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",v=0,y=e[0].length;v<y;++v){var b=e[0][v];switch(b[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=Ir(" ",e[0][p][1][1]);break;case 1:g=Ir("\r",e[0][p][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}u=u+g,p=-1}l.push(u+y6e[b[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Rh(b[1][1],s,a),l.push(Mh(d,i));break;case"PtgRefN":d=r?Rh(b[1][1],r,a):b[1][1],l.push(Mh(d,i));break;case"PtgRef3d":f=b[1][1],d=Rh(b[1][2],s,a),x=xP(n,f,a),l.push(x+"!"+Mh(d,i));break;case"PtgFunc":case"PtgFuncVar":var w=b[1][0],_=b[1][1];w||(w=0),w&=127;var D=w==0?[]:l.slice(-w);l.length-=w,_==="User"&&(_=D.shift()),l.push(_+"("+D.join(",")+")");break;case"PtgBool":l.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(b[1]);break;case"PtgNum":l.push(String(b[1]));break;case"PtgStr":l.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(b[1]);break;case"PtgAreaN":m=VF(b[1][1],r?{s:r}:s,a),l.push(Ow(m,a));break;case"PtgArea":m=VF(b[1][1],s,a),l.push(Ow(m,a));break;case"PtgArea3d":f=b[1][1],m=b[1][2],x=xP(n,f,a),l.push(x+"!"+Ow(m,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=b[1][2];var j=(n.names||[])[h-1]||(n[0]||[])[h],N=j?j.Name:"SH33TJSNAME"+String(h);N&&N.slice(0,6)=="_xlfn."&&!a.xlfn&&(N=N.slice(6)),l.push(N);break;case"PtgNameX":var S=b[1][1];h=b[1][2];var E;if(a.biff<=5)S<0&&(S=-S),n[S]&&(E=n[S][h]);else{var A="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][h]&&n[S][h].itab>0&&(A=n.SheetNames[n[S][h].itab-1]+"!"):A=n.SheetNames[h-1]+"!"),n[S]&&n[S][h])A+=n[S][h].Name;else if(n[0]&&n[0][h])A+=n[0][h].Name;else{var T=(_9(n,S,a)||"").split(";;");T[h-1]?A=T[h-1]:A+="SH33TJSERRX"}l.push(A);break}E||(E={Name:"SH33TJSERRY"}),l.push(E.Name);break;case"PtgParen":var L="(",O=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:L=Ir(" ",e[0][p][1][1])+L;break;case 3:L=Ir("\r",e[0][p][1][1])+L;break;case 4:O=Ir(" ",e[0][p][1][1])+O;break;case 5:O=Ir("\r",e[0][p][1][1])+O;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}l.push(L+l.pop()+O);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:b[1][1],r:b[1][0]};var V={c:r.c,r:r.r};if(n.sharedf[pt(d)]){var W=n.sharedf[pt(d)];l.push(Xn(W,s,V,n,a))}else{var B=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(Xn(u[1],s,V,n,a)),B=!0;break}B||l.push(b[1])}break;case"PtgArray":l.push("{"+v6e(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var P=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&p>=0&&P.indexOf(e[0][v][0])==-1){b=e[0][p];var F=!0;switch(b[1][0]){case 4:F=!1;case 0:g=Ir(" ",b[1][1]);break;case 5:F=!1;case 1:g=Ir("\r",b[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}l.push((F?g:"")+l.pop()+(F?"":g)),p=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function w6e(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],aa(e,t-2)];var l=cx(e,s,r);return t!==s+a&&(i=lx(e,t-s-a,l,r)),e.l=n,[l,i]}function _6e(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],aa(e,t-2)];var l=cx(e,s,r);return t!==s+a&&(i=lx(e,t-s-a,l,r)),e.l=n,[l,i]}function D6e(e,t,r,n){var a=e.l+t,i=cx(e,n,r),s;return a!==e.l&&(s=lx(e,a-e.l,i,r)),[i,s]}function j6e(e,t,r){var n=e.l+t,a,i=e.read_shift(2),s=cx(e,i,r);return i==65535?[[],aa(e,t-2)]:(t!==i+2&&(a=lx(e,n-i-2,s,r)),[s,a])}function N6e(e){var t;if(vo(e,e.l+6)!==65535)return[Qn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function S6e(e){if(e==null){var t=Se(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Hc(e);return Hc(0)}function Mw(e,t,r){var n=e.l+t,a=Ks(e);r.biff==2&&++e.l;var i=N6e(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=_6e(e,n-e.l,r);return{cell:a,val:i[0],formula:l,shared:s>>3&1,tt:i[1]}}function E6e(e,t,r,n,a){var i=qc(t,r,a),s=S6e(e.v),l=Se(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=Se(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=bn([i,s,l,u]);return f}function Sb(e,t,r){var n=e.read_shift(4),a=cx(e,n,r),i=e.read_shift(4),s=i>0?lx(e,i,a,r):null;return[a,s]}var T6e=Sb,Eb=Sb,k6e=Sb,C6e=Sb,A6e={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},D9={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},O6e={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function gP(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function F6e(e){var t="of:="+e.replace(wE,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Uw(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function P6e(e){return e.replace(/\./,"!")}var $h={},id={},Lh=typeof Map<"u";function jE(e,t,r){var n=0,a=e.length;if(r){if(Lh?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Lh?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Lh?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Tb(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Zn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=qm(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=gv(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Ac(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Vl(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){Us(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function j9(e,t,r,n,a,i){try{n.cellNF&&(e.z=dt[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=_r(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(dt[t]==null&&Us(CAe[t]||"General",t),e.t==="e")e.w=e.w||qo[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=$m(e.v);else if(e.t==="d"){var s=dn(e.v);(s|0)===s?e.w=s.toString(10):e.w=$m(s)}else{if(e.v===void 0)return"";e.w=Wc(e.v,id)}else e.t==="d"?e.w=li(t,dn(e.v),id):e.w=li(t,e.v,id)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=xv(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=xv(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&i.Fills)throw l}}}function I6e(e,t,r){if(e&&e["!ref"]){var n=Ft(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function R6e(e,t){var r=Ft(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Dt(r))}var M6e=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,U6e=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,$6e=/<(?:\w:)?hyperlink [^>]*>/mg,L6e=/"(\w*:\w*)"/,B6e=/<(?:\w:)?col\b[^>]*[\/]?>/g,W6e=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,z6e=/<(?:\w:)?pageMargins[^>]*\/>/g,N9=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,H6e=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,V6e=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function q6e(e,t,r,n,a,i,s){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(U6e);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var h=u.match(N9);h?NE(h[0],l,a,r):(h=u.match(H6e))&&Y6e(h[0],h[1]||"",l,a,r);var m=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var x=u.slice(m,m+50).match(L6e);x&&R6e(l,x[1])}var p=u.match(V6e);p&&p[1]&&o8e(p[1],a);var g=[];if(t.cellStyles){var v=u.match(B6e);v&&r8e(g,v)}f&&u8e(f[1],l,t,c,i,s);var y=d.match(W6e);y&&(l["!autofilter"]=a8e(y[0]));var b=[],w=d.match(M6e);if(w)for(m=0;m!=w.length;++m)b[m]=Ft(w[m].slice(w[m].indexOf('"')+1));var _=d.match($6e);_&&Q6e(l,_,n);var D=d.match(z6e);if(D&&(l["!margins"]=e8e(xt(D[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Dt(c)),t.sheetRows>0&&l["!ref"]){var j=Ft(l["!ref"]);t.sheetRows<=+j.e.r&&(j.e.r=t.sheetRows-1,j.e.r>c.e.r&&(j.e.r=c.e.r),j.e.r<j.s.r&&(j.s.r=j.e.r),j.e.c>c.e.c&&(j.e.c=c.e.c),j.e.c<j.s.c&&(j.s.c=j.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Dt(j))}return g.length>0&&(l["!cols"]=g),b.length>0&&(l["!merges"]=b),l}function G6e(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Dt(e[r])+'"/>';return t+"</mergeCells>"}function NE(e,t,r,n){var a=xt(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Bt(ir(a.codeName)))}function Y6e(e,t,r,n,a){NE(e.slice(0,e.indexOf(">")),r,n,a)}function X6e(e,t,r,n,a){var i=!1,s={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,s.codeName=Is(Qt(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+We("outlinePr",null,u)}!i&&!l||(a[a.length]=We("sheetPr",l,s))}var K6e=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Z6e=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function J6e(e){var t={sheet:1};return K6e.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),Z6e.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=vE(e.password).toString(16).toUpperCase()),We("sheetProtection",null,t)}function Q6e(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=xt(ir(t[a]),!0);if(!i.ref)return;var s=((r||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+Bt(i.location))):(i.Target="#"+Bt(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=Ft(i.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var d=pt({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=i):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=i)}}}function e8e(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function t8e(e){return Ac(e),We("pageMargins",null,e)}function r8e(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=xt(t[n],!0);a.hidden&&(a.hidden=yr(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,yE(a.width)),Tl(a);i<=s;)e[i++]=lr(a)}}function n8e(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=We("col",null,Tb(a,n)));return r[r.length]="</cols>",r.join("")}function a8e(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function i8e(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Dt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=ba(a);s.s.r==s.e.r&&(s.e.r=ba(t["!ref"]).e.r,a=Dt(s));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),We("autoFilter",null,{ref:a})}var s8e=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function o8e(e,t){t.Views||(t.Views=[{}]),(e.match(s8e)||[]).forEach(function(r,n){var a=xt(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),yr(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function l8e(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),We("sheetViews",We("sheetView",null,a),{})}function c8e(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=qo[e.v];break;case"d":n&&n.cellDates?a=_r(e.v,-1).toISOString():(e=lr(e),e.t="n",a=""+(e.v=dn(_r(e.v)))),typeof e.z>"u"&&(e.z=dt[14]);break;default:a=e.v;break}var l=In("v",Qt(a)),c={r:t},u=Vl(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=In("v",""+jE(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=We("f",Qt(e.f),d)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),We("c",l,c)}var u8e=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=Lm("v"),s=Lm("f");return function(c,u,d,f,h,m){for(var x=0,p="",g=[],v=[],y=0,b=0,w=0,_="",D,j,N=0,S=0,E,A,T=0,L=0,O=Array.isArray(m.CellXf),V,W=[],B=[],P=Array.isArray(u),F=[],I={},R=!1,C=!!d.sheetStubs,k=c.split(t),z=0,q=k.length;z!=q;++z){p=k[z].trim();var K=p.length;if(K!==0){var se=0;e:for(x=0;x<K;++x)switch(p[x]){case">":if(p[x-1]!="/"){++x;break e}if(d&&d.cellStyles){if(j=xt(p.slice(se,x),!0),N=j.r!=null?parseInt(j.r,10):N+1,S=-1,d.sheetRows&&d.sheetRows<N)continue;I={},R=!1,j.ht&&(R=!0,I.hpt=parseFloat(j.ht),I.hpx=Wd(I.hpt)),j.hidden=="1"&&(R=!0,I.hidden=!0),j.outlineLevel!=null&&(R=!0,I.level=+j.outlineLevel),R&&(F[N-1]=I)}break;case"<":se=x;break}if(se>=x)break;if(j=xt(p.slice(se,x),!0),N=j.r!=null?parseInt(j.r,10):N+1,S=-1,!(d.sheetRows&&d.sheetRows<N)){f.s.r>N-1&&(f.s.r=N-1),f.e.r<N-1&&(f.e.r=N-1),d&&d.cellStyles&&(I={},R=!1,j.ht&&(R=!0,I.hpt=parseFloat(j.ht),I.hpx=Wd(I.hpt)),j.hidden=="1"&&(R=!0,I.hidden=!0),j.outlineLevel!=null&&(R=!0,I.level=+j.outlineLevel),R&&(F[N-1]=I)),g=p.slice(x).split(e);for(var ie=0;ie!=g.length&&g[ie].trim().charAt(0)=="<";++ie);for(g=g.slice(ie),x=0;x!=g.length;++x)if(p=g[x].trim(),p.length!==0){if(v=p.match(r),y=x,b=0,w=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,v!=null&&v.length===2){for(y=0,_=v[1],b=0;b!=_.length&&!((w=_.charCodeAt(b)-64)<1||w>26);++b)y=26*y+w;--y,S=y}else++S;for(b=0;b!=p.length&&p.charCodeAt(b)!==62;++b);if(++b,j=xt(p.slice(0,b),!0),j.r||(j.r=pt({r:N-1,c:S})),_=p.slice(b),D={t:""},(v=_.match(i))!=null&&v[1]!==""&&(D.v=Bt(v[1])),d.cellFormula){if((v=_.match(s))!=null&&v[1]!==""){if(D.f=Bt(ir(v[1])).replace(/\r\n/g,`
`),d.xlfn||(D.f=hP(D.f)),v[0].indexOf('t="array"')>-1)D.F=(_.match(a)||[])[1],D.F.indexOf(":")>-1&&W.push([Ft(D.F),D.F]);else if(v[0].indexOf('t="shared"')>-1){A=xt(v[0]);var ee=Bt(ir(v[1]));d.xlfn||(ee=hP(ee)),B[parseInt(A.si,10)]=[A,ee,j.r]}}else(v=_.match(/<f[^>]*\/>/))&&(A=xt(v[0]),B[A.si]&&(D.f=s5e(B[A.si][1],B[A.si][2],j.r)));var ae=Fr(j.r);for(b=0;b<W.length;++b)ae.r>=W[b][0].s.r&&ae.r<=W[b][0].e.r&&ae.c>=W[b][0].s.c&&ae.c<=W[b][0].e.c&&(D.F=W[b][1])}if(j.t==null&&D.v===void 0)if(D.f||D.F)D.v=0,D.t="n";else if(C)D.t="z";else continue;else D.t=j.t||"n";switch(f.s.c>S&&(f.s.c=S),f.e.c<S&&(f.e.c=S),D.t){case"n":if(D.v==""||D.v==null){if(!C)continue;D.t="z"}else D.v=parseFloat(D.v);break;case"s":if(typeof D.v>"u"){if(!C)continue;D.t="z"}else E=$h[parseInt(D.v,10)],D.v=E.t,D.r=E.r,d.cellHTML&&(D.h=E.h);break;case"str":D.t="s",D.v=D.v!=null?ir(D.v):"",d.cellHTML&&(D.h=QS(D.v));break;case"inlineStr":v=_.match(n),D.t="s",v!=null&&(E=gE(v[1]))?(D.v=E.t,d.cellHTML&&(D.h=E.h)):D.v="";break;case"b":D.v=yr(D.v);break;case"d":d.cellDates?D.v=_r(D.v,1):(D.v=dn(_r(D.v,1)),D.t="n");break;case"e":(!d||d.cellText!==!1)&&(D.w=D.v),D.v=EB[D.v];break}if(T=L=0,V=null,O&&j.s!==void 0&&(V=m.CellXf[j.s],V!=null&&(V.numFmtId!=null&&(T=V.numFmtId),d.cellStyles&&V.fillId!=null&&(L=V.fillId))),j9(D,T,L,d,h,m),d.cellDates&&O&&D.t=="n"&&uu(dt[T])&&(D.t="d",D.v=Db(D.v)),j.cm&&d.xlmeta){var pe=(d.xlmeta.Cell||[])[+j.cm-1];pe&&pe.type=="XLDAPR"&&(D.D=!0)}if(P){var H=Fr(j.r);u[H.r]||(u[H.r]=[]),u[H.r][H.c]=D}else u[j.r]=D}}}}F.length>0&&(u["!rows"]=F)}}();function d8e(e,t,r,n){var a=[],i=[],s=Ft(e["!ref"]),l="",c,u="",d=[],f=0,h=0,m=e["!rows"],x=Array.isArray(e),p={r:u},g,v=-1;for(h=s.s.c;h<=s.e.c;++h)d[h]=wr(h);for(f=s.s.r;f<=s.e.r;++f){for(i=[],u=$r(f),h=s.s.c;h<=s.e.c;++h){c=d[h]+u;var y=x?(e[f]||[])[h]:e[c];y!==void 0&&(l=c8e(y,c,e,t))!=null&&i.push(l)}(i.length>0||m&&m[f])&&(p={r:u},m&&m[f]&&(g=m[f],g.hidden&&(p.hidden=1),v=-1,g.hpx?v=Gm(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(p.ht=v,p.customHeight=1),g.level&&(p.outlineLevel=g.level)),a[a.length]=We("row",i.join(""),p))}if(m)for(;f<m.length;++f)m&&m[f]&&(p={r:f+1},g=m[f],g.hidden&&(p.hidden=1),v=-1,g.hpx?v=Gm(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(p.ht=v,p.customHeight=1),g.level&&(p.outlineLevel=g.level),a[a.length]=We("row","",p));return a.join("")}function S9(e,t,r,n){var a=[Yr,We("worksheet",null,{xmlns:du[0],"xmlns:r":ln.r})],i=r.SheetNames[e],s=0,l="",c=r.Sheets[i];c==null&&(c={});var u=c["!ref"]||"A1",d=Ft(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Dt(d)}n||(n={}),c["!comments"]=[];var f=[];X6e(c,r,e,t,a),a[a.length]=We("dimension",null,{ref:u}),a[a.length]=l8e(c,t,e,r),t.sheetFormat&&(a[a.length]=We("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=n8e(c,c["!cols"])),a[s=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=d8e(c,t),l.length>0&&(a[a.length]=l)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),c["!protect"]&&(a[a.length]=J6e(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=i8e(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=G6e(c["!merges"]));var h=-1,m,x=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(m={ref:p[0]},p[1].Target.charAt(0)!="#"&&(x=Kt(n,-1,Qt(p[1].Target).replace(/#.*$/,""),kt.HLINK),m["r:id"]="rId"+x),(h=p[1].Target.indexOf("#"))>-1&&(m.location=Qt(p[1].Target.slice(h+1))),p[1].Tooltip&&(m.tooltip=Qt(p[1].Tooltip)),a[a.length]=We("hyperlink",null,m))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=t8e(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=In("ignoredErrors",We("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(x=Kt(n,-1,"../drawings/drawing"+(e+1)+".xml",kt.DRAW),a[a.length]=We("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=f),c["!comments"].length>0&&(x=Kt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",kt.VML),a[a.length]=We("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function f8e(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function h8e(e,t,r){var n=Se(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=Gm(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,h=-1,m=d<<10;m<d+1<<10;++m){u.c=m;var x=Array.isArray(r)?(r[u.r]||[])[u.c]:r[pt(u)];x&&(f<0&&(f=m),h=m)}f<0||(++l,n.write_shift(4,f),n.write_shift(4,h))}var p=n.l;return n.l=c,n.write_shift(4,l),n.l=p,n.length>n.l?n.slice(0,n.l):n}function m8e(e,t,r,n){var a=h8e(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&Oe(e,0,a)}var p8e=pu,x8e=Cf;function g8e(){}function v8e(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=w3e(e),r}function y8e(e,t,r){r==null&&(r=Se(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return hv({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),_B(e,r),r.slice(0,r.l)}function b8e(e){var t=Gi(e);return[t]}function w8e(e,t,r){return r==null&&(r=Se(8)),fu(t,r)}function _8e(e){var t=hu(e);return[t]}function D8e(e,t,r){return r==null&&(r=Se(4)),mu(t,r)}function j8e(e){var t=Gi(e),r=e.read_shift(1);return[t,r,"b"]}function N8e(e,t,r){return r==null&&(r=Se(9)),fu(t,r),r.write_shift(1,e.v?1:0),r}function S8e(e){var t=hu(e),r=e.read_shift(1);return[t,r,"b"]}function E8e(e,t,r){return r==null&&(r=Se(5)),mu(t,r),r.write_shift(1,e.v?1:0),r}function T8e(e){var t=Gi(e),r=e.read_shift(1);return[t,r,"e"]}function k8e(e,t,r){return r==null&&(r=Se(9)),fu(t,r),r.write_shift(1,e.v),r}function C8e(e){var t=hu(e),r=e.read_shift(1);return[t,r,"e"]}function A8e(e,t,r){return r==null&&(r=Se(8)),mu(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function O8e(e){var t=Gi(e),r=e.read_shift(4);return[t,r,"s"]}function F8e(e,t,r){return r==null&&(r=Se(12)),fu(t,r),r.write_shift(4,t.v),r}function P8e(e){var t=hu(e),r=e.read_shift(4);return[t,r,"s"]}function I8e(e,t,r){return r==null&&(r=Se(8)),mu(t,r),r.write_shift(4,t.v),r}function R8e(e){var t=Gi(e),r=Qn(e);return[t,r,"n"]}function M8e(e,t,r){return r==null&&(r=Se(16)),fu(t,r),Hc(e.v,r),r}function E9(e){var t=hu(e),r=Qn(e);return[t,r,"n"]}function U8e(e,t,r){return r==null&&(r=Se(12)),mu(t,r),Hc(e.v,r),r}function $8e(e){var t=Gi(e),r=fE(e);return[t,r,"n"]}function L8e(e,t,r){return r==null&&(r=Se(12)),fu(t,r),DB(e.v,r),r}function B8e(e){var t=hu(e),r=fE(e);return[t,r,"n"]}function W8e(e,t,r){return r==null&&(r=Se(8)),mu(t,r),DB(e.v,r),r}function z8e(e){var t=Gi(e),r=cE(e);return[t,r,"is"]}function H8e(e){var t=Gi(e),r=ra(e);return[t,r,"str"]}function V8e(e,t,r){return r==null&&(r=Se(12+4*e.v.length)),fu(t,r),wn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function q8e(e){var t=hu(e),r=ra(e);return[t,r,"str"]}function G8e(e,t,r){return r==null&&(r=Se(8+4*e.v.length)),mu(t,r),wn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Y8e(e,t,r){var n=e.l+t,a=Gi(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var l=Eb(e,n-e.l,r);s[3]=Xn(l,null,a,r.supbooks,r)}else e.l=n;return s}function X8e(e,t,r){var n=e.l+t,a=Gi(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var l=Eb(e,n-e.l,r);s[3]=Xn(l,null,a,r.supbooks,r)}else e.l=n;return s}function K8e(e,t,r){var n=e.l+t,a=Gi(e);a.r=r["!row"];var i=Qn(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var l=Eb(e,n-e.l,r);s[3]=Xn(l,null,a,r.supbooks,r)}else e.l=n;return s}function Z8e(e,t,r){var n=e.l+t,a=Gi(e);a.r=r["!row"];var i=ra(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var l=Eb(e,n-e.l,r);s[3]=Xn(l,null,a,r.supbooks,r)}else e.l=n;return s}var J8e=pu,Q8e=Cf;function eIe(e,t){return t==null&&(t=Se(4)),t.write_shift(4,e),t}function tIe(e,t){var r=e.l+t,n=pu(e),a=uE(e),i=ra(e),s=ra(e),l=ra(e);e.l=r;var c={rfx:n,relId:a,loc:i,display:l};return s&&(c.Tooltip=s),c}function rIe(e,t){var r=Se(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Cf({s:Fr(e[0]),e:Fr(e[0])},r),dE("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return wn(a||"",r),wn(e[1].Tooltip||"",r),wn("",r),r.slice(0,r.l)}function nIe(){}function aIe(e,t,r){var n=e.l+t,a=jB(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var l=T6e(e,n-e.l,r);s[1]=l}else e.l=n;return s}function iIe(e,t,r){var n=e.l+t,a=pu(e),i=[a];if(r.cellFormula){var s=C6e(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}function sIe(e,t,r){r==null&&(r=Se(18));var n=Tb(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var T9=["left","right","top","bottom","header","footer"];function oIe(e){var t={};return T9.forEach(function(r){t[r]=Qn(e)}),t}function lIe(e,t){return t==null&&(t=Se(6*8)),Ac(e),T9.forEach(function(r){Hc(e[r],t)}),t}function cIe(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function uIe(e,t,r){r==null&&(r=Se(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function dIe(e){var t=Se(24);return t.write_shift(4,4),t.write_shift(4,1),Cf(e,t),t}function fIe(e,t){return t==null&&(t=Se(16*4+2)),t.write_shift(2,e.password?vE(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function hIe(){}function mIe(){}function pIe(e,t,r,n,a,i,s){if(!e)return e;var l=t||{};n||(n={"!id":{}});var c=l.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,m,x,p,g,v,y,b,w,_,D=[];l.biff=12,l["!row"]=0;var j=0,N=!1,S=[],E={},A=l.supbooks||a.supbooks||[[]];if(A.sharedf=E,A.arrayf=S,A.SheetNames=a.SheetNames||a.Sheets.map(function(P){return P.name}),!l.supbooks&&(l.supbooks=A,a.Names))for(var T=0;T<a.Names.length;++T)A[0][T+1]=a.Names[T];var L=[],O=[],V=!1;Ym[16]={n:"BrtShortReal",f:E9};var W;if(Vo(e,function(F,I,R){if(!h)switch(R){case 148:u=F;break;case 0:m=F,l.sheetRows&&l.sheetRows<=m.r&&(h=!0),w=$r(g=m.r),l["!row"]=m.r,(F.hidden||F.hpt||F.level!=null)&&(F.hpt&&(F.hpx=Wd(F.hpt)),O[F.r]=F);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:F[2]},F[2]){case"n":x.v=F[1];break;case"s":b=$h[F[1]],x.v=b.t,x.r=b.r;break;case"b":x.v=!!F[1];break;case"e":x.v=F[1],l.cellText!==!1&&(x.w=qo[x.v]);break;case"str":x.t="s",x.v=F[1];break;case"is":x.t="s",x.v=F[1].t;break}if((p=s.CellXf[F[0].iStyleRef])&&j9(x,p.numFmtId,null,l,i,s),v=F[0].c==-1?v+1:F[0].c,l.dense?(c[g]||(c[g]=[]),c[g][v]=x):c[wr(v)+w]=x,l.cellFormula){for(N=!1,j=0;j<S.length;++j){var C=S[j];m.r>=C[0].s.r&&m.r<=C[0].e.r&&v>=C[0].s.c&&v<=C[0].e.c&&(x.F=Dt(C[0]),N=!0)}!N&&F.length>3&&(x.f=F[3])}if(d.s.r>m.r&&(d.s.r=m.r),d.s.c>v&&(d.s.c=v),d.e.r<m.r&&(d.e.r=m.r),d.e.c<v&&(d.e.c=v),l.cellDates&&p&&x.t=="n"&&uu(dt[p.numFmtId])){var k=ul(x.v);k&&(x.t="d",x.v=new Date(k.y,k.m-1,k.d,k.H,k.M,k.S,k.u))}W&&(W.type=="XLDAPR"&&(x.D=!0),W=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;x={t:"z",v:void 0},v=F[0].c==-1?v+1:F[0].c,l.dense?(c[g]||(c[g]=[]),c[g][v]=x):c[wr(v)+w]=x,d.s.r>m.r&&(d.s.r=m.r),d.s.c>v&&(d.s.c=v),d.e.r<m.r&&(d.e.r=m.r),d.e.c<v&&(d.e.c=v),W&&(W.type=="XLDAPR"&&(x.D=!0),W=void 0);break;case 176:D.push(F);break;case 49:W=((l.xlmeta||{}).Cell||[])[F-1];break;case 494:var z=n["!id"][F.relId];for(z?(F.Target=z.Target,F.loc&&(F.Target+="#"+F.loc),F.Rel=z):F.relId==""&&(F.Target="#"+F.loc),g=F.rfx.s.r;g<=F.rfx.e.r;++g)for(v=F.rfx.s.c;v<=F.rfx.e.c;++v)l.dense?(c[g]||(c[g]=[]),c[g][v]||(c[g][v]={t:"z",v:void 0}),c[g][v].l=F):(y=pt({c:v,r:g}),c[y]||(c[y]={t:"z",v:void 0}),c[y].l=F);break;case 426:if(!l.cellFormula)break;S.push(F),_=l.dense?c[g][v]:c[wr(v)+w],_.f=Xn(F[1],d,{r:m.r,c:v},A,l),_.F=Dt(F[0]);break;case 427:if(!l.cellFormula)break;E[pt(F[0].s)]=F[1],_=l.dense?c[g][v]:c[wr(v)+w],_.f=Xn(F[1],d,{r:m.r,c:v},A,l);break;case 60:if(!l.cellStyles)break;for(;F.e>=F.s;)L[F.e--]={width:F.w/256,hidden:!!(F.flags&1),level:F.level},V||(V=!0,yE(F.w/256)),Tl(L[F.e+1]);break;case 161:c["!autofilter"]={ref:Dt(F)};break;case 476:c["!margins"]=F;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),F.name&&(a.Sheets[r].CodeName=F.name),(F.above||F.left)&&(c["!outline"]={above:F.above,left:F.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),F.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!I.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+R.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Dt(u||d)),l.sheetRows&&c["!ref"]){var B=Ft(c["!ref"]);l.sheetRows<=+B.e.r&&(B.e.r=l.sheetRows-1,B.e.r>d.e.r&&(B.e.r=d.e.r),B.e.r<B.s.r&&(B.s.r=B.e.r),B.e.c>d.e.c&&(B.e.c=d.e.c),B.e.c<B.s.c&&(B.s.c=B.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Dt(B))}return D.length>0&&(c["!merges"]=D),L.length>0&&(c["!cols"]=L),O.length>0&&(c["!rows"]=O),c}function xIe(e,t,r,n,a,i,s){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=lr(t),t.z=t.z||dt[14],t.v=dn(_r(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:n};switch(c.s=Vl(a.cellXfs,t,a),t.l&&i["!links"].push([pt(c),t.l]),t.c&&i["!comments"].push([pt(c),t.c]),t.t){case"s":case"str":return a.bookSST?(l=jE(a.Strings,t.v,a.revStrings),c.t="s",c.v=l,s?Oe(e,18,I8e(t,c)):Oe(e,7,F8e(t,c))):(c.t="str",s?Oe(e,17,G8e(t,c)):Oe(e,6,V8e(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?Oe(e,13,W8e(t,c)):Oe(e,2,L8e(t,c)):s?Oe(e,16,U8e(t,c)):Oe(e,5,M8e(t,c)),!0;case"b":return c.t="b",s?Oe(e,15,E8e(t,c)):Oe(e,4,N8e(t,c)),!0;case"e":return c.t="e",s?Oe(e,14,A8e(t,c)):Oe(e,3,k8e(t,c)),!0}return s?Oe(e,12,D8e(t,c)):Oe(e,1,w8e(t,c)),!0}function gIe(e,t,r,n){var a=Ft(t["!ref"]||"A1"),i,s="",l=[];Oe(e,145);var c=Array.isArray(t),u=a.e.r;t["!rows"]&&(u=Math.max(a.e.r,t["!rows"].length-1));for(var d=a.s.r;d<=u;++d){s=$r(d),m8e(e,t,a,d);var f=!1;if(d<=a.e.r)for(var h=a.s.c;h<=a.e.c;++h){d===a.s.r&&(l[h]=wr(h)),i=l[h]+s;var m=c?(t[d]||[])[h]:t[i];if(!m){f=!1;continue}f=xIe(e,m,d,h,n,t,f)}}Oe(e,146)}function vIe(e,t){!t||!t["!merges"]||(Oe(e,177,eIe(t["!merges"].length)),t["!merges"].forEach(function(r){Oe(e,176,Q8e(r))}),Oe(e,178))}function yIe(e,t){!t||!t["!cols"]||(Oe(e,390),t["!cols"].forEach(function(r,n){r&&Oe(e,60,sIe(n,r))}),Oe(e,391))}function bIe(e,t){!t||!t["!ref"]||(Oe(e,648),Oe(e,649,dIe(Ft(t["!ref"]))),Oe(e,650))}function wIe(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=Kt(r,-1,n[1].Target.replace(/#.*$/,""),kt.HLINK);Oe(e,494,rIe(n,a))}}),delete t["!links"]}function _Ie(e,t,r,n){if(t["!comments"].length>0){var a=Kt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",kt.VML);Oe(e,551,dE("rId"+a)),t["!legacy"]=a}}function DIe(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:Dt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,l=ba(i);l.s.r==l.e.r&&(l.e.r=ba(t["!ref"]).e.r,i=Dt(l));for(var c=0;c<s.length;++c){var u=s[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+i;break}}c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Oe(e,161,Cf(Ft(i))),Oe(e,162)}}function jIe(e,t,r){Oe(e,133),Oe(e,137,uIe(t,r)),Oe(e,138),Oe(e,134)}function NIe(e,t){t["!protect"]&&Oe(e,535,fIe(t["!protect"]))}function SIe(e,t,r,n){var a=Fa(),i=r.SheetNames[e],s=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=Ft(s["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],Oe(a,129),(r.vbaraw||s["!outline"])&&Oe(a,147,y8e(l,s["!outline"])),Oe(a,148,x8e(c)),jIe(a,s,r.Workbook),yIe(a,s),gIe(a,s,e,t),NIe(a,s),DIe(a,s,r,e),vIe(a,s),wIe(a,s,n),s["!margins"]&&Oe(a,476,lIe(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&bIe(a,s),_Ie(a,s,e,n),Oe(a,130),a.end()}function EIe(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var a=Bt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function TIe(e,t,r,n,a,i){var s=i||{"!type":"chart"};if(!e)return i;var l=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=EIe(f);d.s.r=d.s.c=0,d.e.c=l,u=wr(l),h[0].forEach(function(m,x){s[u+$r(x)]={t:"n",v:m,z:h[1]},c=x}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(s["!ref"]=Dt(d)),s}function kIe(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,l=e.match(N9);return l&&NE(l[0],i,a,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function CIe(e,t){e.l+=10;var r=ra(e);return{name:r}}function AIe(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return Vo(e,function(c,u,d){switch(d){case 550:i["!rel"]=c;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),c.name&&(a.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var SE=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],OIe=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],FIe=[],PIe=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function vP(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=yr(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function yP(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=yr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function k9(e){yP(e.WBProps,SE),yP(e.CalcPr,PIe),vP(e.WBView,OIe),vP(e.Sheets,FIe),id.date1904=yr(e.WBProps.date1904)}function IIe(e){return!e.Workbook||!e.Workbook.WBProps?"false":yr(e.Workbook.WBProps.date1904)?"true":"false"}var RIe="][*?/\\".split("");function C9(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return RIe.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function MIe(e,t,r){e.forEach(function(n,a){C9(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function A9(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];MIe(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)I6e(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var UIe=/<\w+:workbook/;function $Ie(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(e.replace(oa,function(c,u){var d=xt(c);switch(Xs(d[0])){case"<?xml":break;case"<workbook":c.match(UIe)&&(a="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[a];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":SE.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=yr(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=ir(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Bt(ir(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=ir(d.name),d.comment&&(i.Comment=d.comment),d.localSheetId&&(i.Sheet=+d.localSheetId),yr(d.hidden||"0")&&(i.Hidden=!0),s=u+c.length;break;case"</definedName>":i.Ref=Bt(ir(e.slice(s,u))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),du.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return k9(r),r}function O9(e){var t=[Yr];t[t.length]=We("workbook",null,{xmlns:du[0],"xmlns:r":ln.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(SE.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=We("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:Qt(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=We("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=We("definedName",Qt(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function LIe(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=fj(e),r.name=ra(e),r}function BIe(e,t){return t||(t=Se(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),dE(e.strRelID,t),wn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function WIe(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?ra(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function zIe(e,t){t||(t=Se(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),_B(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function HIe(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function VIe(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=_3e(e),s=k6e(e,0,r),l=uE(e);e.l=n;var c={Name:i,Ptg:s};return a<268435455&&(c.Sheet=a),l&&(c.Comment=l),c}function qIe(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],Ym[16]={n:"BrtFRTArchID$",f:HIe},Vo(e,function(c,u,d){switch(d){case 156:s.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Xn(c.Ptg,null,null,s,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([d,c]):s[0]=[d,c],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(c),s.XTI=s.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(d),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),k9(r),r.Names=i,r.supbooks=s,r}function GIe(e,t){Oe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Oe(e,156,BIe(a))}Oe(e,144)}function YIe(e,t){t||(t=Se(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return wn("SheetJS",t),wn(Mm.version,t),wn(Mm.version,t),wn("7262",t),t.length>t.l?t.slice(0,t.l):t}function XIe(e,t){t||(t=Se(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function KIe(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(Oe(e,135),Oe(e,158,XIe(a)),Oe(e,136))}}function ZIe(e,t){var r=Fa();return Oe(r,131),Oe(r,128,YIe()),Oe(r,153,zIe(e.Workbook&&e.Workbook.WBProps||null)),KIe(r,e),GIe(r,e),Oe(r,132),r.end()}function JIe(e,t,r){return t.slice(-4)===".bin"?qIe(e,r):$Ie(e,r)}function QIe(e,t,r,n,a,i,s,l){return t.slice(-4)===".bin"?pIe(e,n,r,a,i,s,l):q6e(e,n,r,a,i,s,l)}function eRe(e,t,r,n,a,i,s,l){return t.slice(-4)===".bin"?AIe(e,n,r,a,i):kIe(e,n,r,a,i)}function tRe(e,t,r,n,a,i,s,l){return t.slice(-4)===".bin"?a5e():i5e()}function rRe(e,t,r,n,a,i,s,l){return t.slice(-4)===".bin"?r5e():n5e()}function nRe(e,t,r,n){return t.slice(-4)===".bin"?QFe(e,r,n):BFe(e,r,n)}function aRe(e,t,r){return d9(e,r)}function iRe(e,t,r){return t.slice(-4)===".bin"?sFe(e,r):nFe(e,r)}function sRe(e,t,r){return t.slice(-4)===".bin"?ZPe(e,r):WPe(e,r)}function oRe(e,t,r){return t.slice(-4)===".bin"?$Pe(e):MPe(e)}function lRe(e,t,r,n){return r.slice(-4)===".bin"?LPe(e,t,r,n):void 0}function cRe(e,t,r){return t.slice(-4)===".bin"?PPe(e,t,r):RPe(e,t,r)}function uRe(e,t,r){return(t.slice(-4)===".bin"?ZIe:O9)(e)}function dRe(e,t,r,n,a){return(t.slice(-4)===".bin"?SIe:S9)(e,r,n,a)}function fRe(e,t,r){return(t.slice(-4)===".bin"?cPe:c9)(e,r)}function hRe(e,t,r){return(t.slice(-4)===".bin"?cFe:t9)(e,r)}function mRe(e,t,r){return(t.slice(-4)===".bin"?JPe:m9)(e)}function pRe(e){return(e.slice(-4)===".bin"?IPe:f9)()}var F9=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,P9=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Zi(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(F9),i,s,l,c;if(a)for(c=0;c!=a.length;++c)i=a[c].match(P9),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(s+1),n[l]=i[2].slice(1,i[2].length-1));return n}function xRe(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(F9),a,i,s,l;if(n)for(l=0;l!=n.length;++l)a=n[l].match(P9),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),r[s]=a[2].slice(1,a[2].length-1));return r}var Bh;function gRe(e,t){var r=Bh[e]||Bt(e);return r==="General"?Wc(t):li(r,t)}function vRe(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=yr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=_r(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Bt(t)]=a}function yRe(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||qo[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=$m(e.v):e.w=Wc(e.v):e.w=gRe(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Bh[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&uu(n)){var a=ul(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function bRe(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=FFe[n.Pattern]||n.Pattern)}e[t.ID]=t}function wRe(e,t,r,n,a,i,s,l,c,u){var d="General",f=n.StyleID,h={};u=u||{};var m=[],x=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&s&&(f=s.StyleID);i[f]!==void 0&&(i[f].nf&&(d=i[f].nf),i[f].Interior&&m.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=yr(e);break;case"String":n.t="s",n.r=RF(Bt(e)),n.v=e.indexOf("<")>-1?Bt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(_r(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Bt(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=EB[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=RF(t||e));break}if(yRe(n,d,u),u.cellFormula!==!1)if(n.Formula){var p=Bt(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=ad(p,a),delete n.Formula,n.ArrayRange=="RC"?n.F=ad("RC:RC",a):n.ArrayRange&&(n.F=ad(n.ArrayRange,a),c.push([Ft(n.F),n.F]))}else for(x=0;x<c.length;++x)a.r>=c[x][0].s.r&&a.r<=c[x][0].e.r&&a.c>=c[x][0].s.c&&a.c<=c[x][0].e.c&&(n.F=c[x][1]);u.cellStyles&&(m.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function _Re(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function $w(e,t){var r=t||{};Ef();var n=qu(eE(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof Ut<"u"?n=Ut.utils.decode(65001,sv(n)):n=ir(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=lr(r);return s.type="string",Bd.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(G){a.indexOf("<"+G)>=0&&(i=!0)}),i)return aMe(n,r);Bh={"General Number":"General","General Date":dt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":dt[15],"Short Date":dt[14],"Long Time":dt[19],"Medium Time":dt[18],"Short Time":dt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:dt[2],Standard:dt[4],Percent:dt[10],Scientific:dt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,d={},f=[],h=r.dense?[]:{},m="",x={},p={},g=Zi('<Data ss:Type="String">'),v=0,y=0,b=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},_={},D={},j="",N=0,S=[],E={},A={},T=0,L=[],O=[],V={},W=[],B,P=!1,F=[],I=[],R={},C=0,k=0,z={Sheets:[],WBProps:{date1904:!1}},q={};Wm.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var K="";l=Wm.exec(n);)switch(l[3]=(K=l[3]).toLowerCase()){case"data":if(K=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?wRe(n.slice(v,l.index),j,g,c[c.length-1][0]=="comment"?V:x,{c:y,r:b},_,W[y],p,F,r):(j="",g=Zi(l[0]),v=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(O.length>0&&(x.c=O),(!r.sheetRows||r.sheetRows>b)&&x.v!==void 0&&(r.dense?(h[b]||(h[b]=[]),h[b][y]=x):h[wr(y)+$r(b)]=x),x.HRef&&(x.l={Target:Bt(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(C=y+(parseInt(x.MergeAcross,10)|0),k=b+(parseInt(x.MergeDown,10)|0),S.push({s:{c:y,r:b},e:{c:C,r:k}})),!r.sheetStubs)x.MergeAcross?y=C+1:++y;else if(x.MergeAcross||x.MergeDown){for(var se=y;se<=C;++se)for(var ie=b;ie<=k;++ie)(se>y||ie>b)&&(r.dense?(h[ie]||(h[ie]=[]),h[ie][se]={t:"z"}):h[wr(se)+$r(ie)]={t:"z"});y=C+1}else++y;else x=xRe(l[0]),x.Index&&(y=+x.Index-1),y<w.s.c&&(w.s.c=y),y>w.e.c&&(w.e.c=y),l[0].slice(-2)==="/>"&&++y,O=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(b<w.s.r&&(w.s.r=b),b>w.e.r&&(w.e.r=b),l[0].slice(-2)==="/>"&&(p=Zi(l[0]),p.Index&&(b=+p.Index-1)),y=0,++b):(p=Zi(l[0]),p.Index&&(b=+p.Index-1),R={},(p.AutoFitHeight=="0"||p.Height)&&(R.hpx=parseInt(p.Height,10),R.hpt=Gm(R.hpx),I[b]=R),p.Hidden=="1"&&(R.hidden=!0,I[b]=R));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));f.push(m),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(h["!ref"]=Dt(w),r.sheetRows&&r.sheetRows<=w.e.r&&(h["!fullref"]=h["!ref"],w.e.r=r.sheetRows-1,h["!ref"]=Dt(w))),S.length&&(h["!merges"]=S),W.length>0&&(h["!cols"]=W),I.length>0&&(h["!rows"]=I),d[m]=h}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=y=0,c.push([l[3],!1]),u=Zi(l[0]),m=Bt(u.Name),h=r.dense?[]:{},S=[],F=[],I=[],q={name:m,Hidden:0},z.Sheets.push(q);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),W=[],P=!1}break;case"style":l[1]==="/"?bRe(_,D,r):D=Zi(l[0]);break;case"numberformat":D.nf=Bt(Zi(l[0]).Format||"General"),Bh[D.nf]&&(D.nf=Bh[D.nf]);for(var ee=0;ee!=392&&dt[ee]!=D.nf;++ee);if(ee==392){for(ee=57;ee!=392;++ee)if(dt[ee]==null){Us(D.nf,ee);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(B=Zi(l[0]),B.Hidden&&(B.hidden=!0,delete B.Hidden),B.Width&&(B.wpx=parseInt(B.Width,10)),!P&&B.wpx>10){P=!0,Zn=o9;for(var ae=0;ae<W.length;++ae)W[ae]&&Tl(W[ae])}P&&Tl(B),W[B.Index-1||W.length]=B;for(var pe=0;pe<+B.Span;++pe)W[W.length]=lr(B);break;case"namedrange":if(l[1]==="/")break;z.Names||(z.Names=[]);var H=xt(l[0]),ne={Name:H.Name,Ref:ad(H.RefersTo.slice(1),{r:0,c:0})};z.Sheets.length>0&&(ne.Sheet=z.Sheets.length-1),z.Names.push(ne);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?j+=n.slice(N,l.index):N=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;D.Interior=Zi(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?G3e(E,K,n.slice(T,l.index)):T=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));_Re(V),O.push(V)}else c.push([l[3],!1]),u=Zi(l[0]),V={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var U=Zi(l[0]);h["!autofilter"]={ref:ad(U.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return jP(n,r);var le=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:le=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:le=!1}break;case"excelworkbook":switch(l[3]){case"date1904":z.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:le=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:le=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(T,l.index)){case"SheetHidden":q.Hidden=1;break;case"SheetVeryHidden":q.Hidden=2;break}else T=l.index+l[0].length;break;case"header":h["!margins"]||Ac(h["!margins"]={},"xlml"),isNaN(+xt(l[0]).Margin)||(h["!margins"].header=+xt(l[0]).Margin);break;case"footer":h["!margins"]||Ac(h["!margins"]={},"xlml"),isNaN(+xt(l[0]).Margin)||(h["!margins"].footer=+xt(l[0]).Margin);break;case"pagemargins":var re=xt(l[0]);h["!margins"]||Ac(h["!margins"]={},"xlml"),isNaN(+re.Top)||(h["!margins"].top=+re.Top),isNaN(+re.Left)||(h["!margins"].left=+re.Left),isNaN(+re.Right)||(h["!margins"].right=+re.Right),isNaN(+re.Bottom)||(h["!margins"].bottom=+re.Bottom);break;case"displayrighttoleft":z.Views||(z.Views=[]),z.Views[0]||(z.Views[0]={}),z.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:le=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:le=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:le=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:le=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:le=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:le=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:le=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:le=!1}break;case"smarttags":break;default:le=!1;break}if(le||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?vRe(A,K,L,n.slice(T,l.index)):(L=l,T=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var X={};return!r.bookSheets&&!r.bookProps&&(X.Sheets=d),X.SheetNames=f,X.Workbook=z,X.SSF=lr(dt),X.Props=E,X.Custprops=A,X}function yj(e,t){switch(kE(t=t||{}),t.type||"base64"){case"base64":return $w(oi(e),t);case"binary":case"buffer":case"file":return $w(e,t);case"array":return $w(zl(e),t)}}function DRe(e,t){var r=[];return e.Props&&r.push(Y3e(e.Props,t)),e.Custprops&&r.push(X3e(e.Props,e.Custprops)),r.join("")}function jRe(){return""}function NRe(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(We("NumberFormat",null,{"ss:Format":Qt(dt[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};r.push(We("Style",i.join(""),s))}),We("Styles",r.join(""))}function I9(e){return We("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+_E(e.Ref,{r:0,c:0})})}function SRe(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(I9(a)))}return We("Names",r.join(""))}function ERe(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var l=a[s];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(I9(l)))}return i.join("")}function TRe(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(We("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(We("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(We("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(We("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(In("ProtectContents","True")),e["!protect"].objects&&a.push(In("ProtectObjects","True")),e["!protect"].scenarios&&a.push(In("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(In("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(In("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":We("WorksheetOptions",a.join(""),{xmlns:Xa.x})}function kRe(e){return e.map(function(t){var r=ZAe(t.t||""),n=We("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return We("Comment",n,{"ss:Author":t.a})}).join("")}function CRe(e,t,r,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Qt(_E(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var c=Fr(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==s.r?"":"["+(c.r-s.r)+"]")+"C"+(c.c==s.c?"":"["+(c.c-s.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Qt(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Qt(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=s.c||u[d].s.r!=s.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=qo[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||dt[14]);break;case"s":f="String",h=KAe(e.v||"");break}var m=Vl(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+m),l["ss:Index"]=s.c+1;var x=e.v!=null?h:"",p=e.t=="z"?"":'<Data ss:Type="'+f+'">'+x+"</Data>";return(e.c||[]).length>0&&(p+=kRe(e.c)),We("Cell",p,l)}function ARe(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Wd(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function ORe(e,t,r,n){if(!e["!ref"])return"";var a=Ft(e["!ref"]),i=e["!merges"]||[],s=0,l=[];e["!cols"]&&e["!cols"].forEach(function(g,v){Tl(g);var y=!!g.width,b=Tb(v,g),w={"ss:Index":v+1};y&&(w["ss:Width"]=Vm(b.width)),g.hidden&&(w["ss:Hidden"]="1"),l.push(We("Column",null,w))});for(var c=Array.isArray(e),u=a.s.r;u<=a.e.r;++u){for(var d=[ARe(u,(e["!rows"]||[])[u])],f=a.s.c;f<=a.e.c;++f){var h=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>f)&&!(i[s].s.r>u)&&!(i[s].e.c<f)&&!(i[s].e.r<u)){(i[s].s.c!=f||i[s].s.r!=u)&&(h=!0);break}if(!h){var m={r:u,c:f},x=pt(m),p=c?(e[u]||[])[f]:e[x];d.push(CRe(p,x,e,t,r,n,m))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function FRe(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],s=i?ERe(i,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?ORe(i,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(TRe(i,t,e,r)),n.join("")}function PRe(e,t){t||(t={}),e.SSF||(e.SSF=lr(dt)),e.SSF&&(Ef(),nx(e.SSF),t.revssf=_b(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Vl(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(DRe(e,t)),r.push(jRe()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(We("Worksheet",FRe(n,t,e),{"ss:Name":Qt(e.SheetNames[n])}));return r[2]=NRe(e,t),r[3]=SRe(e),Yr+We("Workbook",r.join(""),{xmlns:Xa.ss,"xmlns:o":Xa.o,"xmlns:x":Xa.x,"xmlns:ss":Xa.ss,"xmlns:dt":Xa.dt,"xmlns:html":Xa.html})}function IRe(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=E3e(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=T3e(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var RRe=[60,1084,2066,2165,2175];function MRe(e,t,r,n,a){var i=n,s=[],l=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(l)}s.push(l),r.l+=i;for(var c=vo(r,r.l),u=bj[c],d=0;u!=null&&RRe.indexOf(c)>-1;)i=vo(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),l=r.slice(d,r.l+4+i),s.push(l),r.l+=4+i,u=bj[c=vo(r,r.l)];var f=bn(s);Pn(f,0);var h=0;f.lens=[];for(var m=0;m<s.length;++m)f.lens.push(h),h+=s[m].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,a)}function Es(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=dt[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||qo[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=$m(e.v):e.w=Wc(e.v):e.w=li(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&uu(dt[n]||String(n))){var a=ul(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function o0(e,t,r){return{v:e,ixfe:t,t:r}}function URe(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},s={},l=null,c=[],u="",d={},f,h="",m,x,p,g,v={},y=[],b,w,_=[],D=[],j={Sheets:[],WBProps:{date1904:!1},Views:[{}]},N={},S=function(Pe){return Pe<8?Tc[Pe]:Pe<64&&D[Pe-8]||Tc[Pe]},E=function(Pe,Ke,lt){var nt=Ke.XF.data;if(!(!nt||!nt.patternType||!lt||!lt.cellStyles)){Ke.s={},Ke.s.patternType=nt.patternType;var nr;(nr=Hm(S(nt.icvFore)))&&(Ke.s.fgColor={rgb:nr}),(nr=Hm(S(nt.icvBack)))&&(Ke.s.bgColor={rgb:nr})}},A=function(Pe,Ke,lt){if(!(R>1)&&!(lt.sheetRows&&Pe.r>=lt.sheetRows)){if(lt.cellStyles&&Ke.XF&&Ke.XF.data&&E(Pe,Ke,lt),delete Ke.ixfe,delete Ke.XF,f=Pe,h=pt(Pe),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Pe.r<s.s.r&&(s.s.r=Pe.r),Pe.c<s.s.c&&(s.s.c=Pe.c),Pe.r+1>s.e.r&&(s.e.r=Pe.r+1),Pe.c+1>s.e.c&&(s.e.c=Pe.c+1),lt.cellFormula&&Ke.f){for(var nt=0;nt<y.length;++nt)if(!(y[nt][0].s.c>Pe.c||y[nt][0].s.r>Pe.r)&&!(y[nt][0].e.c<Pe.c||y[nt][0].e.r<Pe.r)){Ke.F=Dt(y[nt][0]),(y[nt][0].s.c!=Pe.c||y[nt][0].s.r!=Pe.r)&&delete Ke.f,Ke.f&&(Ke.f=""+Xn(y[nt][1],s,Pe,F,T));break}}lt.dense?(a[Pe.r]||(a[Pe.r]=[]),a[Pe.r][Pe.c]=Ke):a[h]=Ke}},T={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(T.password=t.password);var L,O=[],V=[],W=[],B=[],P=!1,F=[];F.SheetNames=T.snames,F.sharedf=T.sharedf,F.arrayf=T.arrayf,F.names=[],F.XTI=[];var I=0,R=0,C=0,k=[],z=[],q;T.codepage=1200,Ii(1200);for(var K=!1;e.l<e.length-1;){var se=e.l,ie=e.read_shift(2);if(ie===0&&I===10)break;var ee=e.l===e.length?0:e.read_shift(2),ae=bj[ie];if(ae&&ae.f){if(t.bookSheets&&I===133&&ie!==133)break;if(I=ie,ae.r===2||ae.r==12){var pe=e.read_shift(2);if(ee-=2,!T.enc&&pe!==ie&&((pe&255)<<8|pe>>8)!==ie)throw new Error("rt mismatch: "+pe+"!="+ie);ae.r==12&&(e.l+=10,ee-=10)}var H={};if(ie===10?H=ae.f(e,ee,T):H=MRe(ie,ae,e,ee,T),R==0&&[9,521,1033,2057].indexOf(I)===-1)continue;switch(ie){case 34:r.opts.Date1904=j.WBProps.date1904=H;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(T.enc||(e.l=0),T.enc=H,!t.password)throw new Error("File is password-protected");if(H.valid==null)throw new Error("Encryption scheme unsupported");if(!H.valid)throw new Error("Password is incorrect");break;case 92:T.lastuser=H;break;case 66:var ne=Number(H);switch(ne){case 21010:ne=1200;break;case 32768:ne=1e4;break;case 32769:ne=1252;break}Ii(T.codepage=ne),K=!0;break;case 317:T.rrtabid=H;break;case 25:T.winlocked=H;break;case 439:r.opts.RefreshAll=H;break;case 12:r.opts.CalcCount=H;break;case 16:r.opts.CalcDelta=H;break;case 17:r.opts.CalcIter=H;break;case 13:r.opts.CalcMode=H;break;case 14:r.opts.CalcPrecision=H;break;case 95:r.opts.CalcSaveRecalc=H;break;case 15:T.CalcRefMode=H;break;case 2211:r.opts.FullCalc=H;break;case 129:H.fDialog&&(a["!type"]="dialog"),H.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),H.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:_.push(H);break;case 430:F.push([H]),F[F.length-1].XTI=[];break;case 35:case 547:F[F.length-1].push(H);break;case 24:case 536:q={Name:H.Name,Ref:Xn(H.rgce,s,null,F,T)},H.itab>0&&(q.Sheet=H.itab-1),F.names.push(q),F[0]||(F[0]=[],F[0].XTI=[]),F[F.length-1].push(H),H.Name=="_xlnm._FilterDatabase"&&H.itab>0&&H.rgce&&H.rgce[0]&&H.rgce[0][0]&&H.rgce[0][0][0]=="PtgArea3d"&&(z[H.itab-1]={ref:Dt(H.rgce[0][0][1][2])});break;case 22:T.ExternCount=H;break;case 23:F.length==0&&(F[0]=[],F[0].XTI=[]),F[F.length-1].XTI=F[F.length-1].XTI.concat(H),F.XTI=F.XTI.concat(H);break;case 2196:if(T.biff<8)break;q!=null&&(q.Comment=H[1]);break;case 18:a["!protect"]=H;break;case 19:H!==0&&T.WTF&&console.error("Password verifier: "+H);break;case 133:i[H.pos]=H,T.snames.push(H.name);break;case 10:{if(--R)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=Dt(s),t.sheetRows&&t.sheetRows<=s.e.r){var U=s.e.r;s.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Dt(s),s.e.r=U}s.e.r++,s.e.c++}O.length>0&&(a["!merges"]=O),V.length>0&&(a["!objects"]=V),W.length>0&&(a["!cols"]=W),B.length>0&&(a["!rows"]=B),j.Sheets.push(N)}u===""?d=a:n[u]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(T.biff===8&&(T.biff={9:2,521:3,1033:4}[ie]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[H.BIFFVer]||8),T.biffguess=H.BIFFVer==0,H.BIFFVer==0&&H.dt==4096&&(T.biff=5,K=!0,Ii(T.codepage=28591)),T.biff==8&&H.BIFFVer==0&&H.dt==16&&(T.biff=2),R++)break;if(a=t.dense?[]:{},T.biff<8&&!K&&(K=!0,Ii(T.codepage=t.codepage||1252)),T.biff<5||H.BIFFVer==0&&H.dt==4096){u===""&&(u="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var le={pos:e.l-ee,name:u};i[le.pos]=le,T.snames.push(u)}else u=(i[se]||{name:""}).name;H.dt==32&&(a["!type"]="chart"),H.dt==64&&(a["!type"]="macro"),O=[],V=[],T.arrayf=y=[],W=[],B=[],P=!1,N={Hidden:(i[se]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[H.r]||[])[H.c]:a[pt({c:H.c,r:H.r})])&&++H.c,b={ixfe:H.ixfe,XF:_[H.ixfe]||{},v:H.val,t:"n"},C>0&&(b.z=k[b.ixfe>>8&63]),Es(b,t,r.opts.Date1904),A({c:H.c,r:H.r},b,t);break;case 5:case 517:b={ixfe:H.ixfe,XF:_[H.ixfe],v:H.val,t:H.t},C>0&&(b.z=k[b.ixfe>>8&63]),Es(b,t,r.opts.Date1904),A({c:H.c,r:H.r},b,t);break;case 638:b={ixfe:H.ixfe,XF:_[H.ixfe],v:H.rknum,t:"n"},C>0&&(b.z=k[b.ixfe>>8&63]),Es(b,t,r.opts.Date1904),A({c:H.c,r:H.r},b,t);break;case 189:for(var re=H.c;re<=H.C;++re){var X=H.rkrec[re-H.c][0];b={ixfe:X,XF:_[X],v:H.rkrec[re-H.c][1],t:"n"},C>0&&(b.z=k[b.ixfe>>8&63]),Es(b,t,r.opts.Date1904),A({c:re,r:H.r},b,t)}break;case 6:case 518:case 1030:{if(H.val=="String"){l=H;break}if(b=o0(H.val,H.cell.ixfe,H.tt),b.XF=_[b.ixfe],t.cellFormula){var G=H.formula;if(G&&G[0]&&G[0][0]&&G[0][0][0]=="PtgExp"){var ce=G[0][0][1][0],J=G[0][0][1][1],ue=pt({r:ce,c:J});v[ue]?b.f=""+Xn(H.formula,s,H.cell,F,T):b.F=((t.dense?(a[ce]||[])[J]:a[ue])||{}).F}else b.f=""+Xn(H.formula,s,H.cell,F,T)}C>0&&(b.z=k[b.ixfe>>8&63]),Es(b,t,r.opts.Date1904),A(H.cell,b,t),l=H}break;case 7:case 519:if(l)l.val=H,b=o0(H,l.cell.ixfe,"s"),b.XF=_[b.ixfe],t.cellFormula&&(b.f=""+Xn(l.formula,s,l.cell,F,T)),C>0&&(b.z=k[b.ixfe>>8&63]),Es(b,t,r.opts.Date1904),A(l.cell,b,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(H);var me=pt(H[0].s);if(m=t.dense?(a[H[0].s.r]||[])[H[0].s.c]:a[me],t.cellFormula&&m){if(!l||!me||!m)break;m.f=""+Xn(H[1],s,H[0],F,T),m.F=Dt(H[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!l)break;v[pt(l.cell)]=H[0],m=t.dense?(a[l.cell.r]||[])[l.cell.c]:a[pt(l.cell)],(m||{}).f=""+Xn(H[0],s,f,F,T)}}break;case 253:b=o0(c[H.isst].t,H.ixfe,"s"),c[H.isst].h&&(b.h=c[H.isst].h),b.XF=_[b.ixfe],C>0&&(b.z=k[b.ixfe>>8&63]),Es(b,t,r.opts.Date1904),A({c:H.c,r:H.r},b,t);break;case 513:t.sheetStubs&&(b={ixfe:H.ixfe,XF:_[H.ixfe],t:"z"},C>0&&(b.z=k[b.ixfe>>8&63]),Es(b,t,r.opts.Date1904),A({c:H.c,r:H.r},b,t));break;case 190:if(t.sheetStubs)for(var te=H.c;te<=H.C;++te){var oe=H.ixfe[te-H.c];b={ixfe:oe,XF:_[oe],t:"z"},C>0&&(b.z=k[b.ixfe>>8&63]),Es(b,t,r.opts.Date1904),A({c:te,r:H.r},b,t)}break;case 214:case 516:case 4:b=o0(H.val,H.ixfe,"s"),b.XF=_[b.ixfe],C>0&&(b.z=k[b.ixfe>>8&63]),Es(b,t,r.opts.Date1904),A({c:H.c,r:H.r},b,t);break;case 0:case 512:R===1&&(s=H);break;case 252:c=H;break;case 1054:if(T.biff==4){k[C++]=H[1];for(var ge=0;ge<C+163&&dt[ge]!=H[1];++ge);ge>=163&&Us(H[1],C+163)}else Us(H[1],H[0]);break;case 30:{k[C++]=H;for(var ye=0;ye<C+163&&dt[ye]!=H;++ye);ye>=163&&Us(H,C+163)}break;case 229:O=O.concat(H);break;case 93:V[H.cmo[0]]=T.lastobj=H;break;case 438:T.lastobj.TxO=H;break;case 127:T.lastobj.ImData=H;break;case 440:for(g=H[0].s.r;g<=H[0].e.r;++g)for(p=H[0].s.c;p<=H[0].e.c;++p)m=t.dense?(a[g]||[])[p]:a[pt({c:p,r:g})],m&&(m.l=H[1]);break;case 2048:for(g=H[0].s.r;g<=H[0].e.r;++g)for(p=H[0].s.c;p<=H[0].e.c;++p)m=t.dense?(a[g]||[])[p]:a[pt({c:p,r:g})],m&&m.l&&(m.l.Tooltip=H[1]);break;case 28:{if(T.biff<=5&&T.biff>=2)break;m=t.dense?(a[H[0].r]||[])[H[0].c]:a[pt(H[0])];var Ce=V[H[2]];m||(t.dense?(a[H[0].r]||(a[H[0].r]=[]),m=a[H[0].r][H[0].c]={t:"z"}):m=a[pt(H[0])]={t:"z"},s.e.r=Math.max(s.e.r,H[0].r),s.s.r=Math.min(s.s.r,H[0].r),s.e.c=Math.max(s.e.c,H[0].c),s.s.c=Math.min(s.s.c,H[0].c)),m.c||(m.c=[]),x={a:H[1],t:Ce.TxO.t},m.c.push(x)}break;case 2173:SPe(_[H.ixfe],H.ext);break;case 125:{if(!T.cellStyles)break;for(;H.e>=H.s;)W[H.e--]={width:H.w/256,level:H.level||0,hidden:!!(H.flags&1)},P||(P=!0,yE(H.w/256)),Tl(W[H.e+1])}break;case 520:{var Ie={};H.level!=null&&(B[H.r]=Ie,Ie.level=H.level),H.hidden&&(B[H.r]=Ie,Ie.hidden=!0),H.hpt&&(B[H.r]=Ie,Ie.hpt=H.hpt,Ie.hpx=Wd(H.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Ac(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ie]]=H;break;case 161:a["!margins"]||Ac(a["!margins"]={}),a["!margins"].header=H.header,a["!margins"].footer=H.footer;break;case 574:H.RTL&&(j.Views[0].RTL=!0);break;case 146:D=H;break;case 2198:L=H;break;case 140:w=H;break;case 442:u?N.CodeName=H||N.name:j.WBProps.CodeName=H||"ThisWorkbook";break}}else ae||console.error("Missing Info for XLS Record 0x"+ie.toString(16)),e.l+=ee}return r.SheetNames=zr(i).sort(function(rt,Pe){return Number(rt)-Number(Pe)}).map(function(rt){return i[rt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&z.forEach(function(rt,Pe){r.Sheets[r.SheetNames[Pe]]["!autofilter"]=rt}),r.Strings=c,r.SSF=lr(dt),T.enc&&(r.Encryption=T.enc),L&&(r.Themes=L),r.Metadata={},w!==void 0&&(r.Metadata.Country=w),F.names.length>0&&(j.Names=F.names),r.Workbook=j,r}var Wh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function $Re(e,t,r){var n=it.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=eP(n,hj,Wh.DSI);for(var i in a)t[i]=a[i]}catch(u){if(r.WTF)throw u}var s=it.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var l=eP(s,mj,Wh.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(FB(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function LRe(e,t){var r=[],n=[],a=[],i=0,s,l=CF(hj,"n"),c=CF(mj,"n");if(e.Props)for(s=zr(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(l,s[i])?r:Object.prototype.hasOwnProperty.call(c,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=zr(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(l,s[i])?r:Object.prototype.hasOwnProperty.call(c,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var u=[];for(i=0;i<a.length;++i)LB.indexOf(a[i][0])>-1||OB.indexOf(a[i][0])>-1||a[i][1]!=null&&u.push(a[i]);n.length&&it.utils.cfb_add(t,"/SummaryInformation",tP(n,Wh.SI,c,mj)),(r.length||u.length)&&it.utils.cfb_add(t,"/DocumentSummaryInformation",tP(r,Wh.DSI,l,hj,u.length?u:null,Wh.UDI))}function EE(e,t){t||(t={}),kE(t),bb(),t.codepage&&yb(t.codepage);var r,n;if(e.FullPaths){if(it.find(e,"/encryption"))throw new Error("File is password-protected");r=it.find(e,"!CompObj"),n=it.find(e,"/Workbook")||it.find(e,"/Book")}else{switch(t.type){case"base64":e=Za(oi(e));break;case"binary":e=Za(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Pn(e,0),n={content:e}}var a,i;if(r&&IRe(r),t.bookProps&&!t.bookSheets)a={};else{var s=Tt?"buffer":"array";if(n&&n.content)a=URe(n.content,t);else if((i=it.find(e,"PerfectOffice_MAIN"))&&i.content)a=Cc.to_workbook(i.content,(t.type=s,t));else if((i=it.find(e,"NativeContent_MAIN"))&&i.content)a=Cc.to_workbook(i.content,(t.type=s,t));else throw(i=it.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&it.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=e5e(e))}var l={};return e.FullPaths&&$Re(e,l,t),a.Props=a.Custprops=l,t.bookFiles&&(a.cfb=e),a}function BRe(e,t){var r=t||{},n=it.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return it.utils.cfb_add(n,a,R9(e,r)),r.biff==8&&(e.Props||e.Custprops)&&LRe(e,n),r.biff==8&&e.vbaraw&&t5e(n,it.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Ym={0:{f:f8e},1:{f:b8e},2:{f:$8e},3:{f:T8e},4:{f:j8e},5:{f:R8e},6:{f:H8e},7:{f:O8e},8:{f:Z8e},9:{f:K8e},10:{f:Y8e},11:{f:X8e},12:{f:_8e},13:{f:B8e},14:{f:C8e},15:{f:S8e},16:{f:E9},17:{f:q8e},18:{f:P8e},19:{f:cE},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:VIe},40:{},42:{},43:{f:HFe},44:{f:WFe},45:{f:GFe},46:{f:XFe},47:{f:YFe},48:{},49:{f:p3e},50:{},51:{f:kPe},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ZB},62:{f:z8e},63:{f:UPe},64:{f:hIe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:aa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:cIe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:v8e},148:{f:p8e,p:16},151:{f:nIe},152:{},153:{f:WIe},154:{},155:{},156:{f:LIe},157:{},158:{},159:{T:1,f:iFe},160:{T:-1},161:{T:1,f:pu},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:J8e},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:EPe},336:{T:-1},337:{f:OPe,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:fj},357:{},358:{},359:{},360:{T:1},361:{},362:{f:KB},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:aIe},427:{f:iIe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:oIe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:g8e},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:tIe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:fj},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:XPe},633:{T:1},634:{T:-1},635:{T:1,f:GPe},636:{T:-1},637:{f:y3e},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:CIe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:mIe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},bj={6:{f:Mw},10:{f:Jo},12:{f:en},13:{f:en},14:{f:Hr},15:{f:Hr},16:{f:Qn},17:{f:Hr},18:{f:Hr},19:{f:en},20:{f:oP},21:{f:oP},23:{f:KB},24:{f:cP},25:{f:Hr},26:{},27:{},28:{f:mOe},29:{},34:{f:Hr},35:{f:lP},38:{f:Qn},39:{f:Qn},40:{f:Qn},41:{f:Qn},42:{f:Hr},43:{f:Hr},47:{f:SFe},49:{f:B4e},51:{f:en},60:{},61:{f:R4e},64:{f:Hr},65:{f:L4e},66:{f:en},77:{},80:{},81:{},82:{},85:{f:en},89:{},90:{},91:{},92:{f:N4e},93:{f:gOe},94:{},95:{f:Hr},96:{},97:{},99:{f:Hr},125:{f:ZB},128:{f:rOe},129:{f:E4e},130:{f:en},131:{f:Hr},132:{f:Hr},133:{f:T4e},134:{},140:{f:NOe},141:{f:en},144:{},146:{f:TOe},151:{},152:{},153:{},154:{},155:{},156:{f:en},157:{},158:{},160:{f:IOe},161:{f:AOe},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:J4e},190:{f:Q4e},193:{f:Jo},197:{},198:{},199:{},200:{},201:{},202:{f:Hr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:en},220:{},221:{f:Hr},222:{},224:{f:tOe},225:{f:j4e},226:{f:Jo},227:{},229:{f:pOe},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:C4e},253:{f:z4e},255:{f:O4e},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:BB},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Hr},353:{f:Jo},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:oOe},431:{f:Hr},432:{},433:{},434:{},437:{},438:{f:bOe},439:{f:Hr},440:{f:wOe},441:{},442:{f:sx},443:{},444:{f:en},445:{},446:{},448:{f:Jo},449:{f:I4e,r:2},450:{f:Jo},512:{f:aP},513:{f:POe},515:{f:iOe},516:{f:V4e},517:{f:sP},519:{f:ROe},520:{f:F4e},523:{},545:{f:uP},549:{f:nP},566:{},574:{f:U4e},638:{f:Z4e},659:{},1048:{},1054:{f:G4e},1084:{},1212:{f:dOe},2048:{f:DOe},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:a0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Jo},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:kOe,r:12},2173:{f:NPe,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Hr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:uOe,r:12},2197:{},2198:{f:yPe,r:12},2199:{},2200:{},2201:{},2202:{f:fOe,r:12},2203:{f:Jo},2204:{},2205:{},2206:{},2207:{},2211:{f:P4e},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:en},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:OOe},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:EOe},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:aP},1:{},2:{f:BOe},3:{f:$Oe},4:{f:UOe},5:{f:sP},7:{f:zOe},8:{},9:{f:a0},11:{},22:{f:en},30:{f:X4e},31:{},32:{},33:{f:uP},36:{},37:{f:nP},50:{f:HOe},62:{},52:{},67:{},68:{f:en},69:{},86:{},126:{},127:{f:MOe},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:VOe},223:{},234:{},354:{},421:{},518:{f:Mw},521:{f:a0},536:{f:cP},547:{f:lP},561:{},579:{},1030:{f:Mw},1033:{f:a0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ze(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&sE(r)&&e.push(r)}}function WRe(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return ze(e,t,r,a);var i=t;if(!isNaN(i)){for(var s=r.parts||[],l=0,c=0,u=0;u+(s[l]||8224)<=8224;)u+=s[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,i),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<a;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(s[l]||8224)<=8224;)u+=s[l]||8224,l++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function ux(e,t,r){return e||(e=Se(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function zRe(e,t,r,n){var a=Se(9);return ux(a,e,t),WB(r,n||"b",a),a}function HRe(e,t,r){var n=Se(8+2*r.length);return ux(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function VRe(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?dn(_r(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?ze(e,2,WOe(r,n,a)):ze(e,3,LOe(r,n,a));return;case"b":case"e":ze(e,5,zRe(r,n,t.v,t.t));return;case"s":case"str":ze(e,4,HRe(r,n,(t.v||"").slice(0,255)));return}ze(e,1,ux(null,r,n))}function qRe(e,t,r,n){var a=Array.isArray(t),i=Ft(t["!ref"]||"A1"),s,l="",c=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=Dt(i)}for(var u=i.s.r;u<=i.e.r;++u){l=$r(u);for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(c[d]=wr(d)),s=c[d]+l;var f=a?(t[u]||[])[d]:t[s];f&&VRe(e,f,u,d)}}}function GRe(e,t){for(var r=t||{},n=Fa(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ze(n,r.biff==4?1033:r.biff==3?521:9,xE(e,16,r)),qRe(n,e.Sheets[e.SheetNames[a]],a,r),ze(n,10),n.end()}function YRe(e,t,r){ze(e,49,W4e({sz:12,name:"Arial"},r))}function XRe(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&ze(e,1054,Y4e(a,t[a],r))})}function KRe(e,t){var r=Se(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ze(e,2151,r),r=Se(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),GB(Ft(t["!ref"]||"A1"),r),r.write_shift(4,4),ze(e,2152,r)}function ZRe(e,t){for(var r=0;r<16;++r)ze(e,224,iP({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){ze(e,224,iP(n,0,t))})}function JRe(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];ze(e,440,_Oe(n)),n[1].Tooltip&&ze(e,2048,jOe(n))}delete t["!links"]}function QRe(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&ze(e,125,COe(Tb(a,n),a))})}}function eMe(e,t,r,n,a){var i=16+Vl(a.cellXfs,t,a);if(t.v==null&&!t.bf){ze(e,513,qc(r,n,i));return}if(t.bf)ze(e,6,E6e(t,r,n,a,i));else switch(t.t){case"d":case"n":var s=t.t=="d"?dn(_r(t.v)):t.v;ze(e,515,sOe(r,n,s,i));break;case"b":case"e":ze(e,517,aOe(r,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var l=jE(a.Strings,t.v,a.revStrings);ze(e,253,H4e(r,n,l,i))}else ze(e,516,q4e(r,n,(t.v||"").slice(0,255),i,a));break;default:ze(e,513,qc(r,n,i))}}function tMe(e,t,r){var n=Fa(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},l=(s.Sheets||[])[e]||{},c=Array.isArray(i),u=t.biff==8,d,f="",h=[],m=Ft(i["!ref"]||"A1"),x=u?65536:16384;if(m.e.c>255||m.e.r>=x){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,x-1)}ze(n,2057,xE(r,16,t)),ze(n,13,Ni(1)),ze(n,12,Ni(100)),ze(n,15,ma(!0)),ze(n,17,ma(!1)),ze(n,16,Hc(.001)),ze(n,95,ma(!0)),ze(n,42,ma(!1)),ze(n,43,ma(!1)),ze(n,130,Ni(1)),ze(n,128,nOe()),ze(n,131,ma(!1)),ze(n,132,ma(!1)),u&&QRe(n,i["!cols"]),ze(n,512,K4e(m,t)),u&&(i["!links"]=[]);for(var p=m.s.r;p<=m.e.r;++p){f=$r(p);for(var g=m.s.c;g<=m.e.c;++g){p===m.s.r&&(h[g]=wr(g)),d=h[g]+f;var v=c?(i[p]||[])[g]:i[d];v&&(eMe(n,v,p,g,t),u&&v.l&&i["!links"].push([d,v.l]))}}var y=l.CodeName||l.name||a;return u&&ze(n,574,$4e((s.Views||[])[0])),u&&(i["!merges"]||[]).length&&ze(n,229,xOe(i["!merges"])),u&&JRe(n,i),ze(n,442,zB(y)),u&&KRe(n,i),ze(n,10),n.end()}function rMe(e,t,r){var n=Fa(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},l=r.biff==8,c=r.biff==5;if(ze(n,2057,xE(e,5,r)),r.bookType=="xla"&&ze(n,135),ze(n,225,l?Ni(1200):null),ze(n,193,a4e(2)),c&&ze(n,191),c&&ze(n,192),ze(n,226),ze(n,92,S4e("SheetJS",r)),ze(n,66,Ni(l?1200:1252)),l&&ze(n,353,Ni(0)),l&&ze(n,448),ze(n,317,FOe(e.SheetNames.length)),l&&e.vbaraw&&ze(n,211),l&&e.vbaraw){var u=s.CodeName||"ThisWorkbook";ze(n,442,zB(u))}ze(n,156,Ni(17)),ze(n,25,ma(!1)),ze(n,18,ma(!1)),ze(n,19,Ni(0)),l&&ze(n,431,ma(!1)),l&&ze(n,444,Ni(0)),ze(n,61,M4e()),ze(n,64,ma(!1)),ze(n,141,Ni(0)),ze(n,34,ma(IIe(e)=="true")),ze(n,14,ma(!0)),l&&ze(n,439,ma(!1)),ze(n,218,Ni(0)),YRe(n,e,r),XRe(n,e.SSF,r),ZRe(n,r),l&&ze(n,352,ma(!1));var d=n.end(),f=Fa();l&&ze(f,140,SOe()),l&&r.Strings&&WRe(f,252,A4e(r.Strings)),ze(f,10);var h=f.end(),m=Fa(),x=0,p=0;for(p=0;p<e.SheetNames.length;++p)x+=(l?12:11)+(l?2:1)*e.SheetNames[p].length;var g=d.length+x+h.length;for(p=0;p<e.SheetNames.length;++p){var v=i[p]||{};ze(m,133,k4e({pos:g,hs:v.Hidden||0,dt:0,name:e.SheetNames[p]},r)),g+=t[p].length}var y=m.end();if(x!=y.length)throw new Error("BS8 "+x+" != "+y.length);var b=[];return d.length&&b.push(d),y.length&&b.push(y),h.length&&b.push(h),bn(b)}function nMe(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=lr(dt)),e&&e.SSF&&(Ef(),nx(e.SSF),r.revssf=_b(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,CE(r),r.cellXfs=[],Vl(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=tMe(a,r,e);return n.unshift(rMe(e,n,r)),bn(n)}function R9(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=ba(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return nMe(e,t);case 4:case 3:case 2:return GRe(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function bP(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=a.index,l=i&&i.index||e.length,c=WAe(e.slice(s,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,h=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(s=0;s<c.length;++s){var p=c[s].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(g!="<td"&&g!="<th")){var v=p.split(/<\/t[dh]>/i);for(l=0;l<v.length;++l){var y=v[l].trim();if(y.match(/<t[dh]/i)){for(var b=y,w=0;b.charAt(0)=="<"&&(w=b.indexOf(">"))>-1;)b=b.slice(w+1);for(var _=0;_<x.length;++_){var D=x[_];D.s.c==d&&D.s.r<u&&u<=D.e.r&&(d=D.e.c+1,_=-1)}var j=xt(y.slice(0,y.indexOf(">")));h=j.colspan?+j.colspan:1,((f=+j.rowspan)>1||h>1)&&x.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+h-1}});var N=j.t||j["data-t"]||"";if(!b.length){d+=h;continue}if(b=uB(b),m.s.r>u&&(m.s.r=u),m.e.r<u&&(m.e.r=u),m.s.c>d&&(m.s.c=d),m.e.c<d&&(m.e.c=d),!b.length){d+=h;continue}var S={t:"s",v:b};r.raw||!b.trim().length||N=="s"||(b==="TRUE"?S={t:"b",v:!0}:b==="FALSE"?S={t:"b",v:!1}:isNaN(cs(b))?isNaN(Ld(b).getDate())||(S={t:"d",v:_r(b)},r.cellDates||(S={t:"n",v:dn(S.v)}),S.z=r.dateNF||dt[14]):S={t:"n",v:cs(b)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=S):n[pt({r:u,c:d})]=S,d+=h}}}}return n["!ref"]=Dt(m),x.length&&(n["!merges"]=x),n}function M9(e,t,r,n){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var l=0,c=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>s)&&!(a[u].e.r<r||a[u].e.c<s)){if(a[u].s.r<r||a[u].s.c<s){l=-1;break}l=a[u].e.r-a[u].s.r+1,c=a[u].e.c-a[u].s.c+1;break}if(!(l<0)){var d=pt({r,c:s}),f=n.dense?(e[r]||[])[s]:e[d],h=f&&f.v!=null&&(f.h||QS(f.w||(Vs(f),f.w)||""))||"",m={};l>1&&(m.rowspan=l),c>1&&(m.colspan=c),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(m["data-t"]=f&&f.t||"z",f.v!=null&&(m["data-v"]=f.v),f.z!=null&&(m["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),m.id=(n.id||"sjs")+"-"+d,i.push(We("td",h,m))}}var x="<tr>";return x+i.join("")+"</tr>"}var U9='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',$9="</body></html>";function aMe(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Hl(bP(r[0],t),t);var n=IE();return r.forEach(function(a,i){RE(n,bP(a,t),"Sheet"+(i+1))}),n}function L9(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function B9(e,t){var r=t||{},n=r.header!=null?r.header:U9,a=r.footer!=null?r.footer:$9,i=[n],s=ba(e["!ref"]);r.dense=Array.isArray(e),i.push(L9(e,s,r));for(var l=s.s.r;l<=s.e.r;++l)i.push(M9(e,s,l,r));return i.push("</table>"+a),i.join("")}function W9(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?Fr(n.origin):n.origin;a=s.r,i=s.c}var l=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var d=ba(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),a==-1&&(u.e.r=a=d.e.r+1)}var f=[],h=0,m=e["!rows"]||(e["!rows"]=[]),x=0,p=0,g=0,v=0,y=0,b=0;for(e["!cols"]||(e["!cols"]=[]);x<l.length&&p<c;++x){var w=l[x];if(wP(w)){if(n.display)continue;m[p]={hidden:!0}}var _=w.children;for(g=v=0;g<_.length;++g){var D=_[g];if(!(n.display&&wP(D))){var j=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):uB(D.innerHTML),N=D.getAttribute("data-z")||D.getAttribute("z");for(h=0;h<f.length;++h){var S=f[h];S.s.c==v+i&&S.s.r<p+a&&p+a<=S.e.r&&(v=S.e.c+1-i,h=-1)}b=+D.getAttribute("colspan")||1,((y=+D.getAttribute("rowspan")||1)>1||b>1)&&f.push({s:{r:p+a,c:v+i},e:{r:p+a+(y||1)-1,c:v+i+(b||1)-1}});var E={t:"s",v:j},A=D.getAttribute("data-t")||D.getAttribute("t")||"";j!=null&&(j.length==0?E.t=A||"z":n.raw||j.trim().length==0||A=="s"||(j==="TRUE"?E={t:"b",v:!0}:j==="FALSE"?E={t:"b",v:!1}:isNaN(cs(j))?isNaN(Ld(j).getDate())||(E={t:"d",v:_r(j)},n.cellDates||(E={t:"n",v:dn(E.v)}),E.z=n.dateNF||dt[14]):E={t:"n",v:cs(j)})),E.z===void 0&&N!=null&&(E.z=N);var T="",L=D.getElementsByTagName("A");if(L&&L.length)for(var O=0;O<L.length&&!(L[O].hasAttribute("href")&&(T=L[O].getAttribute("href"),T.charAt(0)!="#"));++O);T&&T.charAt(0)!="#"&&(E.l={Target:T}),n.dense?(e[p+a]||(e[p+a]=[]),e[p+a][v+i]=E):e[pt({c:v+i,r:p+a})]=E,u.e.c<v+i&&(u.e.c=v+i),v+=b}}++p}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,p-1+a),e["!ref"]=Dt(u),p>=c&&(e["!fullref"]=Dt((u.e.r=l.length-x+p-1+a,u))),e}function z9(e,t){var r=t||{},n=r.dense?[]:{};return W9(n,e,t)}function iMe(e,t){return Hl(z9(e,t),t)}function wP(e){var t="",r=sMe(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function sMe(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function oMe(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Bt(t.replace(/<[^>]*>/g,""));return[r]}var _P={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function H9(e,t){var r=t||{},n=eE(e),a=[],i,s,l={name:""},c="",u=0,d,f,h={},m=[],x=r.dense?[]:{},p,g,v={value:""},y="",b=0,w=[],_=-1,D=-1,j={s:{r:1e6,c:1e7},e:{r:0,c:0}},N=0,S={},E=[],A={},T=0,L=0,O=[],V=1,W=1,B=[],P={Names:[]},F={},I=["",""],R=[],C={},k="",z=0,q=!1,K=!1,se=0;for(Wm.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Wm.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(j.e.c>=j.s.c&&j.e.r>=j.s.r?x["!ref"]=Dt(j):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=j.e.r&&(x["!fullref"]=x["!ref"],j.e.r=r.sheetRows-1,x["!ref"]=Dt(j)),E.length&&(x["!merges"]=E),O.length&&(x["!rows"]=O),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),m.push(d.name),h[d.name]=x,K=!1):p[0].charAt(p[0].length-2)!=="/"&&(d=xt(p[0],!1),_=D=-1,j.s.r=j.s.c=1e7,j.e.r=j.e.c=0,x=r.dense?[]:{},E=[],O=[],K=!0);break;case"table-row-group":p[1]==="/"?--N:++N;break;case"table-row":case"":if(p[1]==="/"){_+=V,V=1;break}if(f=xt(p[0],!1),f.?_=f.-1:_==-1&&(_=0),V=+f["number-rows-repeated"]||1,V<10)for(se=0;se<V;++se)N>0&&(O[_+se]={level:N});D=-1;break;case"covered-table-cell":p[1]!=="/"&&++D,r.sheetStubs&&(r.dense?(x[_]||(x[_]=[]),x[_][D]={t:"z"}):x[pt({r:_,c:D})]={t:"z"}),y="",w=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++D,v=xt(p[0],!1),W=parseInt(v["number-columns-repeated"]||"1",10),g={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(g.f=gP(Bt(v.formula))),(v.||v["value-type"])=="string"&&(g.t="s",g.v=Bt(v["string-value"]||""),r.dense?(x[_]||(x[_]=[]),x[_][D]=g):x[pt({r:_,c:D})]=g),D+=W-1;else if(p[1]!=="/"){++D,y="",b=0,w=[],W=1;var ie=V?_+V-1:_;if(D>j.e.c&&(j.e.c=D),D<j.s.c&&(j.s.c=D),_<j.s.r&&(j.s.r=_),ie>j.e.r&&(j.e.r=ie),v=xt(p[0],!1),R=[],C={},g={t:v.||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=Bt(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(T=parseInt(v["number-matrix-rows-spanned"],10)||0,L=parseInt(v["number-matrix-columns-spanned"],10)||0,A={s:{r:_,c:D},e:{r:_+T-1,c:D+L-1}},g.F=Dt(A),B.push([A,g.F])),v.formula)g.f=gP(v.formula);else for(se=0;se<B.length;++se)_>=B[se][0].s.r&&_<=B[se][0].e.r&&D>=B[se][0].s.c&&D<=B[se][0].e.c&&(g.F=B[se][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(T=parseInt(v["number-rows-spanned"],10)||0,L=parseInt(v["number-columns-spanned"],10)||0,A={s:{r:_,c:D},e:{r:_+T-1,c:D+L-1}},E.push(A)),v["number-columns-repeated"]&&(W=parseInt(v["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=yr(v["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(v.value);break;case"percentage":g.t="n",g.v=parseFloat(v.value);break;case"currency":g.t="n",g.v=parseFloat(v.value);break;case"date":g.t="d",g.v=_r(v["date-value"]),r.cellDates||(g.t="n",g.v=dn(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=$Ae(v["time-value"])/86400,r.cellDates&&(g.t="d",g.v=Db(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(v.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",v["string-value"]!=null&&(y=Bt(v["string-value"]),w=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(q=!1,g.t==="s"&&(g.v=y||"",w.length&&(g.R=w),q=b==0),F.Target&&(g.l=F),R.length>0&&(g.c=R,R=[]),y&&r.cellText!==!1&&(g.w=y),q&&(g.t="z",delete g.v),(!q||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=_))for(var ee=0;ee<V;++ee){if(W=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(x[_+ee]||(x[_+ee]=[]),x[_+ee][D]=ee==0?g:lr(g);--W>0;)x[_+ee][D+W]=lr(g);else for(x[pt({r:_+ee,c:D})]=g;--W>0;)x[pt({r:_+ee,c:D+W})]=lr(g);j.e.c<=D&&(j.e.c=D)}W=parseInt(v["number-columns-repeated"]||"1",10),D+=W-1,W=0,g={},y="",w=[]}F={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((i=a.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((i=a.pop())[0]!==p[3])throw"Bad state: "+i;C.t=y,w.length&&(C.R=w),C.a=k,R.push(C)}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);k="",z=0,y="",b=0,w=[];break;case"creator":p[1]==="/"?k=n.slice(z,p.index):z=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((i=a.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);y="",b=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(S[l.name]=c,(i=a.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&(c="",l=xt(p[0],!1),a.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=xt(p[0],!1),c+=_P[p[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=xt(p[0],!1),c+=_P[p[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,p.index);break}else u=p.index+p[0].length;break;case"named-range":s=xt(p[0],!1),I=Uw(s["cell-range-address"]);var ae={Name:s.name,Ref:I[0]+"!"+I[1]};K&&(ae.Sheet=m.length),P.Names.push(ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(p[1]==="/"&&(!v||!v["string-value"])){var pe=oMe(n.slice(b,p.index));y=(y.length>0?y+`
`:"")+pe[0]}else xt(p[0],!1),b=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{I=Uw(xt(p[0])["target-range-address"]),h[I[0]]["!autofilter"]={ref:I[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(F=xt(p[0],!1),!F.href)break;F.Target=Bt(F.href),delete F.href,F.Target.charAt(0)=="#"&&F.Target.indexOf(".")>-1?(I=Uw(F.Target.slice(1)),F.Target="#"+I[0]+"!"+I[1]):F.Target.match(/^\.\.[\\\/]/)&&(F.Target=F.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var H={Sheets:h,SheetNames:m,Workbook:P};return r.bookSheets&&delete H.Sheets,H}function DP(e,t){t=t||{},Di(e,"META-INF/manifest.xml")&&$3e(Qr(e,"META-INF/manifest.xml"),t);var r=Ja(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=H9(ir(r),t);return Di(e,"meta.xml")&&(n.Props=CB(Qr(e,"meta.xml"))),n}function jP(e,t){return H9(e,t)}var lMe=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Bm({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Yr+t}}(),NP=function(){var e=function(i){return Qt(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,s,l){var c=[];c.push('      <table:table table:name="'+Qt(s.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,f=ba(i["!ref"]||"A1"),h=i["!merges"]||[],m=0,x=Array.isArray(i);if(i["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var p="",g=i["!rows"]||[];for(u=0;u<f.s.r;++u)p=g[u]?' table:style-name="ro'+g[u].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;u<=f.e.r;++u){for(p=g[u]?' table:style-name="ro'+g[u].ods+'"':"",c.push("        <table:table-row"+p+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var v=!1,y={},b="";for(m=0;m!=h.length;++m)if(!(h[m].s.c>d)&&!(h[m].s.r>u)&&!(h[m].e.c<d)&&!(h[m].e.r<u)){(h[m].s.c!=d||h[m].s.r!=u)&&(v=!0),y["table:number-columns-spanned"]=h[m].e.c-h[m].s.c+1,y["table:number-rows-spanned"]=h[m].e.r-h[m].s.r+1;break}if(v){c.push(r);continue}var w=pt({r:u,c:d}),_=x?(i[u]||[])[d]:i[w];if(_&&_.f&&(y["table:formula"]=Qt(F6e(_.f)),_.F&&_.F.slice(0,w.length)==w)){var D=ba(_.F);y["table:number-matrix-columns-spanned"]=D.e.c-D.s.c+1,y["table:number-matrix-rows-spanned"]=D.e.r-D.s.r+1}if(!_){c.push(t);continue}switch(_.t){case"b":b=_.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=_.v?"true":"false";break;case"n":b=_.w||String(_.v||0),y["office:value-type"]="float",y["office:value"]=_.v||0;break;case"s":case"str":b=_.v==null?"":_.v,y["office:value-type"]="string";break;case"d":b=_.w||_r(_.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=_r(_.v).toISOString(),y["table:style-name"]="ce1";break;default:c.push(t);continue}var j=e(b);if(_.l&&_.l.Target){var N=_.l.Target;N=N.charAt(0)=="#"?"#"+P6e(N.slice(1)):N,N.charAt(0)!="#"&&!N.match(/^\w+:/)&&(N="../"+N),j=We("text:a",j,{"xlink:href":N.replace(/&/g,"&amp;")})}c.push("          "+We("table:table-cell",We("text:p",j,{}),y)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Tl(f),f.ods=l;var h=u["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),i.push(`  </style:style>
`),++l}}});var c=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,l){var c=[Yr],u=Bm({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Bm({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(kB().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),a(c,s),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=s.SheetNames.length;++f)c.push(n(s.Sheets[s.SheetNames[f]],s,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function V9(e,t){if(t.bookType=="fods")return NP(e,t);var r=KS(),n="",a=[],i=[];return n="mimetype",jt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",jt(r,n,NP(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",jt(r,n,lMe(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",jt(r,n,Yr+kB()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",jt(r,n,W3e(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",jt(r,n,L3e(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Gc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function wj(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):ir(zl(e))}function cMe(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Za(Is(e))}function uMe(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Cl(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function SP(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function dMe(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function fMe(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function Xm(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Yt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Lr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Wt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Xm(e,r),i=a&7;a=Math.floor(a/8);var s=0,l;if(a==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:s=4,l=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,l=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=Xm(e,r),l=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var u={data:l,type:i};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function On(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(Yt(n*8+a.type)),a.type==2&&t.push(Yt(a.data.length)),t.push(a.data))})}),Cl(t)}function TE(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function wi(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Xm(e,n),i=Wt(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:Lr(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=Wt(l.data),u=Lr(c[3][0].data);s.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=i[3])!=null&&t[0]&&(s.merge=Lr(i[3][0].data)>>>0>0),r.push(s)}return r}function Tu(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Yt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Yt(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:Yt(s.data.length)}],n[2].push({data:On(s.meta),type:2})});var i=On(n);t.push(Yt(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),Cl(t)}function hMe(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Xm(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var l=s-59;s=t[r[0]],l>1&&(s|=t[r[0]+1]<<8),l>2&&(s|=t[r[0]+2]<<16),l>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=l}a.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var c=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Cl(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(a.push(a[0].slice(-c)),u-=c;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-c,-c+u))}}var d=Cl(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function _i(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(hMe(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Cl(t)}function ku(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=Yt(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,r+=n}return Cl(t)}function mMe(e,t,r,n){var a=Gc(e),i=a.getUint32(4,!0),s=(n>1?12:8)+SP(i&(n>1?3470:398))*4,l=-1,c=-1,u=NaN,d=new Date(2001,0,1);i&512&&(l=a.getUint32(s,!0),s+=4),s+=SP(i&(n>1?12288:4096))*4,i&16&&(c=a.getUint32(s,!0),s+=4),i&32&&(u=a.getFloat64(s,!0),s+=8),i&64&&(d.setTime(d.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function pMe(e,t,r){var n=Gc(e),a=n.getUint32(8,!0),i=12,s=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);a&1&&(c=dMe(e,i),i+=16),a&2&&(u=n.getFloat64(i,!0),i+=8),a&4&&(d.setTime(d.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(l=n.getUint32(i,!0),i+=4),a&16&&(s=n.getUint32(i,!0),i+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(s>-1)f={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return f}function Lw(e,t){var r=new Uint8Array(32),n=Gc(r),a=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,fMe(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,a)}function Bw(e,t){var r=new Uint8Array(32),n=Gc(r),a=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,a)}function xMe(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return mMe(e,t,r,e[0]);case 5:return pMe(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Yn(e){var t=Wt(e);return Xm(t[1][0].data)}function EP(e,t){var r=Wt(t.data),n=Lr(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(s){var l=Wt(s.data),c=Lr(l[1][0].data)>>>0;switch(n){case 1:i[c]=wj(l[3][0].data);break;case 8:{var u=e[Yn(l[9][0].data)][0],d=Wt(u.data),f=e[Yn(d[1][0].data)][0],h=Lr(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var m=Wt(f.data);i[c]=m[3].map(function(x){return wj(x.data)}).join("")}break}}),i}function gMe(e,t){var r,n,a,i,s,l,c,u,d,f,h,m,x,p,g=Wt(e),v=Lr(g[1][0].data)>>>0,y=Lr(g[2][0].data)>>>0,b=((n=(r=g[8])==null?void 0:r[0])==null?void 0:n.data)&&Lr(g[8][0].data)>0||!1,w,_;if((i=(a=g[7])==null?void 0:a[0])!=null&&i.data&&t!=0)w=(l=(s=g[7])==null?void 0:s[0])==null?void 0:l.data,_=(u=(c=g[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=g[4])==null?void 0:d[0])!=null&&f.data&&t!=1)w=(m=(h=g[4])==null?void 0:h[0])==null?void 0:m.data,_=(p=(x=g[3])==null?void 0:x[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var D=b?4:1,j=Gc(w),N=[],S=0;S<w.length/2;++S){var E=j.getUint16(S*2,!0);E<65535&&N.push([S,E])}if(N.length!=y)throw"Expected ".concat(y," cells, found ").concat(N.length);var A=[];for(S=0;S<N.length-1;++S)A[N[S][0]]=_.subarray(N[S][1]*D,N[S+1][1]*D);return N.length>=1&&(A[N[N.length-1][0]]=_.subarray(N[N.length-1][1]*D)),{R:v,cells:A}}function vMe(e,t){var r,n=Wt(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Lr(n[7][0].data)>>>0>0?1:0:-1,i=TE(n[5],function(s){return gMe(s,a)});return{nrows:Lr(n[4][0].data)>>>0,data:i.reduce(function(s,l){return s[l.R]||(s[l.R]=[]),l.cells.forEach(function(c,u){if(s[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));s[l.R][u]=c}),s},[])}}function yMe(e,t,r){var n,a=Wt(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Lr(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(Lr(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Dt(i);var s=Wt(a[4][0].data),l=EP(e,e[Yn(s[4][0].data)][0]),c=(n=s[17])!=null&&n[0]?EP(e,e[Yn(s[17][0].data)][0]):[],u=Wt(s[3][0].data),d=0;u[1].forEach(function(f){var h=Wt(f.data),m=e[Yn(h[2][0].data)][0],x=Lr(m.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var p=vMe(e,m);p.data.forEach(function(g,v){g.forEach(function(y,b){var w=pt({r:d+v,c:b}),_=xMe(y,l,c);_&&(r[w]=_)})}),d+=p.nrows})}function bMe(e,t){var r=Wt(t.data),n={"!ref":"A1"},a=e[Yn(r[2][0].data)],i=Lr(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return yMe(e,a[0],n),n}function wMe(e,t){var r,n=Wt(t.data),a={name:(r=n[1])!=null&&r[0]?wj(n[1][0].data):"",sheets:[]},i=TE(n[2],Yn);return i.forEach(function(s){e[s].forEach(function(l){var c=Lr(l.meta[1][0].data);c==6e3&&a.sheets.push(bMe(e,l))})}),a}function _Me(e,t){var r=IE(),n=Wt(t.data),a=TE(n[1],Yn);if(a.forEach(function(i){e[i].forEach(function(s){var l=Lr(s.meta[1][0].data);if(l==2){var c=wMe(e,s);c.sheets.forEach(function(u,d){RE(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Ww(e){var t,r,n,a,i={},s=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=_i(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=wi(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){i[f.id]=f.messages,s.push(f.id)})}}),!s.length)throw new Error("File has no messages");var l=((a=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Lr(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||s.forEach(function(c){i[c].forEach(function(u){var d=Lr(u.meta[1][0].data)>>>0;if(d==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return _Me(i,l)}function DMe(e,t,r){var n,a,i,s;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var l=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&Lr(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=Gc(e[7][0].data),d=0,f=[],h=Gc(e[4][0].data),m=0,x=[],p=0;p<t.length;++p){if(t[p]==null){u.setUint16(p*2,65535,!0),h.setUint16(p*2,65535);continue}u.setUint16(p*2,d,!0),h.setUint16(p*2,m,!0);var g,v;switch(typeof t[p]){case"string":g=Lw({t:"s",v:t[p]},r),v=Bw({t:"s",v:t[p]},r);break;case"number":g=Lw({t:"n",v:t[p]},r),v=Bw({t:"n",v:t[p]},r);break;case"boolean":g=Lw({t:"b",v:t[p]},r),v=Bw({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}f.push(g),d+=g.length,x.push(v),m+=v.length,++c}for(e[2][0].data=Yt(c);p<e[7][0].data.length/2;++p)u.setUint16(p*2,65535,!0),h.setUint16(p*2,65535,!0);return e[6][0].data=Cl(f),e[3][0].data=Cl(x),c}function jMe(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ba(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Dt(n)));var i=vv(r,{range:n,header:1}),s=["~Sh33tJ5~"];i.forEach(function(k){return k.forEach(function(z){typeof z=="string"&&s.push(z)})});var l={},c=[],u=it.read(t.numbers,{type:"base64"});u.FileIndex.map(function(k,z){return[k,u.FullPaths[z]]}).forEach(function(k){var z=k[0],q=k[1];if(z.type==2&&z.name.match(/\.iwa/)){var K=z.content,se=_i(K),ie=wi(se);ie.forEach(function(ee){c.push(ee.id),l[ee.id]={deps:[],location:q,type:Lr(ee.messages[0].meta[1][0].data)}})}}),c.sort(function(k,z){return k-z});var d=c.filter(function(k){return k>1}).map(function(k){return[k,Yt(k)]});u.FileIndex.map(function(k,z){return[k,u.FullPaths[z]]}).forEach(function(k){var z=k[0];if(k[1],!!z.name.match(/\.iwa/)){var q=wi(_i(z.content));q.forEach(function(K){K.messages.forEach(function(se){d.forEach(function(ie){K.messages.some(function(ee){return Lr(ee.meta[1][0].data)!=11006&&uMe(ee.data,ie[1])})&&l[ie[0]].deps.push(K.id)})})})}});for(var f=it.find(u,l[1].location),h=wi(_i(f.content)),m,x=0;x<h.length;++x){var p=h[x];p.id==1&&(m=p)}var g=Yn(Wt(m.messages[0].data)[1][0].data);for(f=it.find(u,l[g].location),h=wi(_i(f.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(m=p);for(g=Yn(Wt(m.messages[0].data)[2][0].data),f=it.find(u,l[g].location),h=wi(_i(f.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(m=p);for(g=Yn(Wt(m.messages[0].data)[2][0].data),f=it.find(u,l[g].location),h=wi(_i(f.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(m=p);var v=Wt(m.messages[0].data);{v[6][0].data=Yt(n.e.r+1),v[7][0].data=Yt(n.e.c+1);var y=Yn(v[46][0].data),b=it.find(u,l[y].location),w=wi(_i(b.content));{for(var _=0;_<w.length&&w[_].id!=y;++_);if(w[_].id!=y)throw"Bad ColumnRowUIDMapArchive";var D=Wt(w[_].messages[0].data);D[1]=[],D[2]=[],D[3]=[];for(var j=0;j<=n.e.c;++j){var N=[];N[1]=N[2]=[{type:0,data:Yt(j+420690)}],D[1].push({type:2,data:On(N)}),D[2].push({type:0,data:Yt(j)}),D[3].push({type:0,data:Yt(j)})}D[4]=[],D[5]=[],D[6]=[];for(var S=0;S<=n.e.r;++S)N=[],N[1]=N[2]=[{type:0,data:Yt(S+726270)}],D[4].push({type:2,data:On(N)}),D[5].push({type:0,data:Yt(S)}),D[6].push({type:0,data:Yt(S)});w[_].messages[0].data=On(D)}b.content=ku(Tu(w)),b.size=b.content.length,delete v[46];var E=Wt(v[4][0].data);{E[7][0].data=Yt(n.e.r+1);var A=Wt(E[1][0].data),T=Yn(A[2][0].data);b=it.find(u,l[T].location),w=wi(_i(b.content));{if(w[0].id!=T)throw"Bad HeaderStorageBucket";var L=Wt(w[0].messages[0].data);for(S=0;S<i.length;++S){var O=Wt(L[2][0].data);O[1][0].data=Yt(S),O[4][0].data=Yt(i[S].length),L[2][S]={type:L[2][0].type,data:On(O)}}w[0].messages[0].data=On(L)}b.content=ku(Tu(w)),b.size=b.content.length;var V=Yn(E[2][0].data);b=it.find(u,l[V].location),w=wi(_i(b.content));{if(w[0].id!=V)throw"Bad HeaderStorageBucket";for(L=Wt(w[0].messages[0].data),j=0;j<=n.e.c;++j)O=Wt(L[2][0].data),O[1][0].data=Yt(j),O[4][0].data=Yt(n.e.r+1),L[2][j]={type:L[2][0].type,data:On(O)};w[0].messages[0].data=On(L)}b.content=ku(Tu(w)),b.size=b.content.length;var W=Yn(E[4][0].data);(function(){for(var k=it.find(u,l[W].location),z=wi(_i(k.content)),q,K=0;K<z.length;++K){var se=z[K];se.id==W&&(q=se)}var ie=Wt(q.messages[0].data);{ie[3]=[];var ee=[];s.forEach(function(H,ne){ee[1]=[{type:0,data:Yt(ne)}],ee[2]=[{type:0,data:Yt(1)}],ee[3]=[{type:2,data:cMe(H)}],ie[3].push({type:2,data:On(ee)})})}q.messages[0].data=On(ie);var ae=Tu(z),pe=ku(ae);k.content=pe,k.size=k.content.length})();var B=Wt(E[3][0].data);{var P=B[1][0];delete B[2];var F=Wt(P.data);{var I=Yn(F[2][0].data);(function(){for(var k=it.find(u,l[I].location),z=wi(_i(k.content)),q,K=0;K<z.length;++K){var se=z[K];se.id==I&&(q=se)}var ie=Wt(q.messages[0].data);{delete ie[6],delete B[7];var ee=new Uint8Array(ie[5][0].data);ie[5]=[];for(var ae=0,pe=0;pe<=n.e.r;++pe){var H=Wt(ee);ae+=DMe(H,i[pe],s),H[1][0].data=Yt(pe),ie[5].push({data:On(H),type:2})}ie[1]=[{type:0,data:Yt(n.e.c+1)}],ie[2]=[{type:0,data:Yt(n.e.r+1)}],ie[3]=[{type:0,data:Yt(ae)}],ie[4]=[{type:0,data:Yt(n.e.r+1)}]}q.messages[0].data=On(ie);var ne=Tu(z),U=ku(ne);k.content=U,k.size=k.content.length})()}P.data=On(F)}E[3][0].data=On(B)}v[4][0].data=On(E)}m.messages[0].data=On(v);var R=Tu(h),C=ku(R);return f.content=C,f.size=f.content.length,u}function q9(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function kE(e){q9([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function CE(e){q9([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function NMe(e){return kt.WS.indexOf(e)>-1?"sheet":e==kt.CS?"chart":e==kt.DS?"dialog":e==kt.MS?"macro":e&&e.length?e:"sheet"}function SMe(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,NMe(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function EMe(e,t,r,n,a,i,s,l,c,u,d,f){try{i[n]=Uh(Ja(e,r,!0),t);var h=Qr(e,t),m;switch(l){case"sheet":m=QIe(h,t,a,c,i[n],u,d,f);break;case"chart":if(m=eRe(h,t,a,c,i[n],u,d,f),!m||!m["!drawel"])break;var x=Dh(m["!drawel"].Target,t),p=zm(x),g=BPe(Ja(e,x,!0),Uh(Ja(e,p,!0),x)),v=Dh(g,x),y=zm(v);m=TIe(Ja(e,v,!0),v,c,Uh(Ja(e,y,!0),v),u,m);break;case"macro":m=tRe(h,t,a,c,i[n],u,d,f);break;case"dialog":m=rRe(h,t,a,c,i[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+l)}s[n]=m;var b=[];i&&i[n]&&zr(i[n]).forEach(function(w){var _="";if(i[n][w].Type==kt.CMNT){_=Dh(i[n][w].Target,t);var D=sRe(Qr(e,_,!0),_,c);if(!D||!D.length)return;fP(m,D,!1)}i[n][w].Type==kt.TCMNT&&(_=Dh(i[n][w].Target,t),b=b.concat(zPe(Qr(e,_,!0),c)))}),b&&b.length&&fP(m,b,!0,c.people||[])}catch(w){if(c.WTF)throw w}}function vi(e){return e.charAt(0)=="/"?e.slice(1):e}function G9(e,t){if(Ef(),t=t||{},kE(t),Di(e,"META-INF/manifest.xml")||Di(e,"objectdata.xml"))return DP(e,t);if(Di(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Ww<"u"){if(e.FileIndex)return Ww(e);var r=it.utils.cfb_new();return FF(e).forEach(function(O){jt(r,O,HAe(e,O))}),Ww(r)}throw new Error("Unsupported NUMBERS file")}if(!Di(e,"[Content_Types].xml"))throw Di(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Di(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=FF(e),a=M3e(Ja(e,"[Content_Types].xml")),i=!1,s,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",Qr(e,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!Qr(e,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if($h=[],a.sst)try{$h=iRe(Qr(e,vi(a.sst)),a.sst,t)}catch(O){if(t.WTF)throw O}t.cellStyles&&a.themes.length&&(c=aRe(Ja(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(u=nRe(Qr(e,vi(a.style)),a.style,c,t))}a.links.map(function(O){try{var V=Uh(Ja(e,zm(vi(O))),O);return lRe(Qr(e,vi(O)),V,O,t)}catch{}});var d=JIe(Qr(e,vi(a.workbooks[0])),a.workbooks[0],t),f={},h="";a.coreprops.length&&(h=Qr(e,vi(a.coreprops[0]),!0),h&&(f=CB(h)),a.extprops.length!==0&&(h=Qr(e,vi(a.extprops[0]),!0),h&&H3e(h,f,t)));var m={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(h=Ja(e,vi(a.custprops[0]),!0),h&&(m=q3e(h,t)));var x={};if((t.bookSheets||t.bookProps)&&(d.Sheets?s=d.Sheets.map(function(V){return V.name}):f.Worksheets&&f.SheetNames.length>0&&(s=f.SheetNames),t.bookProps&&(x.Props=f,x.Custprops=m),t.bookSheets&&typeof s<"u"&&(x.SheetNames=s),t.bookSheets?x.SheetNames:t.bookProps))return x;s={};var p={};t.bookDeps&&a.calcchain&&(p=oRe(Qr(e,vi(a.calcchain)),a.calcchain));var g=0,v={},y,b;{var w=d.Sheets;f.Worksheets=w.length,f.SheetNames=[];for(var _=0;_!=w.length;++_)f.SheetNames[_]=w[_].name}var D=i?"bin":"xml",j=a.workbooks[0].lastIndexOf("/"),N=(a.workbooks[0].slice(0,j+1)+"_rels/"+a.workbooks[0].slice(j+1)+".rels").replace(/^\//,"");Di(e,N)||(N="xl/_rels/workbook."+D+".rels");var S=Uh(Ja(e,N,!0),N.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=cRe(Qr(e,vi(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=VPe(Qr(e,vi(a.people[0])),t)),S&&(S=SMe(S,d.Sheets));var E=Qr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=f.Worksheets;++g){var A="sheet";if(S&&S[g]?(y="xl/"+S[g][1].replace(/[\/]?xl\//,""),Di(e,y)||(y=S[g][1]),Di(e,y)||(y=N.replace(/_rels\/.*$/,"")+S[g][1]),A=S[g][2]):(y="xl/worksheets/sheet"+(g+1-E)+"."+D,y=y.replace(/sheet0\./,"sheet.")),b=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(f.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var T=!1,L=0;L!=t.sheets.length;++L)typeof t.sheets[L]=="number"&&t.sheets[L]==g&&(T=1),typeof t.sheets[L]=="string"&&t.sheets[L].toLowerCase()==f.SheetNames[g].toLowerCase()&&(T=1);if(!T)continue e}}EMe(e,y,b,f.SheetNames[g],g,v,s,A,t,d,c,u)}return x={Directory:a,Workbook:d,Props:f,Custprops:m,Deps:p,Sheets:s,SheetNames:f.SheetNames,Strings:$h,Styles:u,Themes:c,SSF:lr(dt)},t&&t.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(O,V){O=O.replace(/^Root Entry[\/]/,""),x.keys.push(O),x.files[O]=e.FileIndex[V]}))),t&&t.bookVBA&&(a.vba.length>0?x.vbaraw=Qr(e,vi(a.vba[0]),!0):a.defaults&&a.defaults.bin===QPe&&(x.vbaraw=Qr(e,"xl/vbaProject.bin",!0))),x}function TMe(e,t){var r=t||{},n="Workbook",a=it.find(e,n);try{if(n="/!DataSpaces/Version",a=it.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(uFe(a.content),n="/!DataSpaces/DataSpaceMap",a=it.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=fFe(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=it.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=hFe(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=it.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);pFe(a.content)}catch{}if(n="/EncryptionInfo",a=it.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=xFe(a.content);if(n="/EncryptedPackage",a=it.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],a.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function kMe(e,t){return t.bookType=="ods"?V9(e,t):t.bookType=="numbers"?jMe(e,t):t.bookType=="xlsb"?CMe(e,t):Y9(e,t)}function CMe(e,t){Gu=1024,e&&!e.SSF&&(e.SSF=lr(dt)),e&&e.SSF&&(Ef(),nx(e.SSF),t.revssf=_b(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Lh?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=p9.indexOf(t.bookType)>-1,a=mE();CE(t=t||{});var i=KS(),s="",l=0;if(t.cellXfs=[],Vl(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",jt(i,s,AB(e.Props,t)),a.coreprops.push(s),Kt(t.rels,2,s,kt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,jt(i,s,PB(e.Props)),a.extprops.push(s),Kt(t.rels,3,s,kt.EXT_PROPS),e.Custprops!==e.Props&&zr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",jt(i,s,IB(e.Custprops)),a.custprops.push(s),Kt(t.rels,4,s,kt.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:s="xl/worksheets/sheet"+l+"."+r,jt(i,s,dRe(l-1,s,t,e,d)),a.sheets.push(s),Kt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,kt.WS[0])}if(f){var m=f["!comments"],x=!1,p="";m&&m.length>0&&(p="xl/comments"+l+"."+r,jt(i,p,mRe(m,p)),a.comments.push(p),Kt(d,-1,"../comments"+l+"."+r,kt.CMNT),x=!0),f["!legacy"]&&x&&jt(i,"xl/drawings/vmlDrawing"+l+".vml",h9(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&jt(i,zm(s),nd(d))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,jt(i,s,hRe(t.Strings,s,t)),a.strs.push(s),Kt(t.wbrels,-1,"sharedStrings."+r,kt.SST)),s="xl/workbook."+r,jt(i,s,uRe(e,s)),a.workbooks.push(s),Kt(t.rels,1,s,kt.WB),s="xl/theme/theme1.xml",jt(i,s,bE(e.Themes,t)),a.themes.push(s),Kt(t.wbrels,-1,"theme/theme1.xml",kt.THEME),s="xl/styles."+r,jt(i,s,fRe(e,s,t)),a.styles.push(s),Kt(t.wbrels,-1,"styles."+r,kt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",jt(i,s,e.vbaraw),a.vba.push(s),Kt(t.wbrels,-1,"vbaProject.bin",kt.VBA)),s="xl/metadata."+r,jt(i,s,pRe(s)),a.metadata.push(s),Kt(t.wbrels,-1,"metadata."+r,kt.XLMETA),jt(i,"[Content_Types].xml",TB(a,t)),jt(i,"_rels/.rels",nd(t.rels)),jt(i,"xl/_rels/workbook."+r+".rels",nd(t.wbrels)),delete t.revssf,delete t.ssf,i}function Y9(e,t){Gu=1024,e&&!e.SSF&&(e.SSF=lr(dt)),e&&e.SSF&&(Ef(),nx(e.SSF),t.revssf=_b(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Lh?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=p9.indexOf(t.bookType)>-1,a=mE();CE(t=t||{});var i=KS(),s="",l=0;if(t.cellXfs=[],Vl(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",jt(i,s,AB(e.Props,t)),a.coreprops.push(s),Kt(t.rels,2,s,kt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,jt(i,s,PB(e.Props)),a.extprops.push(s),Kt(t.rels,3,s,kt.EXT_PROPS),e.Custprops!==e.Props&&zr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",jt(i,s,IB(e.Custprops)),a.custprops.push(s),Kt(t.rels,4,s,kt.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:s="xl/worksheets/sheet"+l+"."+r,jt(i,s,S9(l-1,t,e,f)),a.sheets.push(s),Kt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,kt.WS[0])}if(h){var x=h["!comments"],p=!1,g="";if(x&&x.length>0){var v=!1;x.forEach(function(y){y[1].forEach(function(b){b.T==!0&&(v=!0)})}),v&&(g="xl/threadedComments/threadedComment"+l+"."+r,jt(i,g,HPe(x,d,t)),a.threadedcomments.push(g),Kt(f,-1,"../threadedComments/threadedComment"+l+"."+r,kt.TCMNT)),g="xl/comments"+l+"."+r,jt(i,g,m9(x)),a.comments.push(g),Kt(f,-1,"../comments"+l+"."+r,kt.CMNT),p=!0}h["!legacy"]&&p&&jt(i,"xl/drawings/vmlDrawing"+l+".vml",h9(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&jt(i,zm(s),nd(f))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,jt(i,s,t9(t.Strings,t)),a.strs.push(s),Kt(t.wbrels,-1,"sharedStrings."+r,kt.SST)),s="xl/workbook."+r,jt(i,s,O9(e)),a.workbooks.push(s),Kt(t.rels,1,s,kt.WB),s="xl/theme/theme1.xml",jt(i,s,bE(e.Themes,t)),a.themes.push(s),Kt(t.wbrels,-1,"theme/theme1.xml",kt.THEME),s="xl/styles."+r,jt(i,s,c9(e,t)),a.styles.push(s),Kt(t.wbrels,-1,"styles."+r,kt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",jt(i,s,e.vbaraw),a.vba.push(s),Kt(t.wbrels,-1,"vbaProject.bin",kt.VBA)),s="xl/metadata."+r,jt(i,s,f9()),a.metadata.push(s),Kt(t.wbrels,-1,"metadata."+r,kt.XLMETA),d.length>1&&(s="xl/persons/person.xml",jt(i,s,qPe(d)),a.people.push(s),Kt(t.wbrels,-1,"persons/person.xml",kt.PEOPLE)),jt(i,"[Content_Types].xml",TB(a,t)),jt(i,"_rels/.rels",nd(t.rels)),jt(i,"xl/_rels/workbook."+r+".rels",nd(t.wbrels)),delete t.revssf,delete t.ssf,i}function AE(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=oi(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function AMe(e,t){return it.find(e,"EncryptedPackage")?TMe(e,t):EE(e,t)}function OMe(e,t){var r,n=e,a=t||{};return a.type||(a.type=Tt&&Buffer.isBuffer(e)?"buffer":"base64"),r=oB(n,a),G9(r,a)}function X9(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return yj(e.slice(r),t);default:break e}return Bd.to_workbook(e,t)}function FMe(e,t){var r="",n=AE(e,t);switch(t.type){case"base64":r=oi(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=zc(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=ir(r)),t.type="binary",X9(r,t)}function PMe(e,t){var r=e;return t.type=="base64"&&(r=oi(r)),r=Ut.utils.decode(1200,r.slice(2),"str"),t.type="binary",X9(r,t)}function IMe(e){return e.match(/[^\x00-\x7F]/)?Is(e):e}function zw(e,t,r,n){return n?(r.type="string",Bd.to_workbook(e,r)):Bd.to_workbook(t,r)}function Km(e,t){bb();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Km(new Uint8Array(e),(r=lr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),id={},r.dateNF&&(id.dateNF=r.dateNF),r.type||(r.type=Tt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Tt?"buffer":"binary",n=RAe(e),typeof Uint8Array<"u"&&!Tt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=IMe(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),l=new Uint8Array(s);if(l.foo="bar",!l.foo)return r=lr(r),r.type="array",Km(qS(n),r)}switch((a=AE(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return AMe(it.read(n,r),r);break;case 9:if(a[1]<=8)return EE(n,r);break;case 60:return yj(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return GOe(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return QB.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?OMe(n,r):zw(e,n,r,i);case 239:return a[3]===60?yj(n,r):zw(e,n,r,i);case 255:if(a[1]===254)return PMe(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Cc.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Cc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return vj.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return s9.to_workbook(n,r);break;case 10:case 13:case 32:return FMe(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return qOe.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?vj.to_workbook(n,r):zw(e,n,r,i)}function TP(e,t){var r=t||{};return r.type="file",Km(e,r)}function K9(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return ax(t.file,it.write(e,{type:Tt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return it.write(e,t)}function RMe(e,t){var r=lr(t||{}),n=kMe(e,r);return Z9(n,r)}function MMe(e,t){var r=lr(t||{}),n=Y9(e,r);return Z9(n,r)}function Z9(e,t){var r={},n=Tt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?it.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(rx(a))}return t.password&&typeof encrypt_agile<"u"?K9(encrypt_agile(a,t.password),t):t.type==="file"?ax(t.file,a):t.type=="string"?ir(a):a}function UMe(e,t){var r=t||{},n=BRe(e,r);return K9(n,r)}function ks(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Um(Is(n));case"binary":return Is(n);case"string":return e;case"file":return ax(t.file,n,"utf8");case"buffer":return Tt?Ho(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ks(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function $Me(e,t){switch(t.type){case"base64":return Um(e);case"binary":return e;case"string":return e;case"file":return ax(t.file,e,"binary");case"buffer":return Tt?Ho(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function l0(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Um(r):t.type=="string"?ir(r):r;case"file":return ax(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function OE(e,t){bb(),A9(e);var r=lr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=OE(e,r);return r.type="array",rx(n)}return MMe(e,r)}function kb(e,t){bb(),A9(e);var r=lr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=kb(e,r);return r.type="array",rx(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ks(PRe(e,r),r);case"slk":case"sylk":return ks(JB.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return ks(B9(e.Sheets[e.SheetNames[a]],r),r);case"txt":return $Me(e7(e.Sheets[e.SheetNames[a]],r),r);case"csv":return ks(PE(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return ks(QB.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return l0(vj.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return ks(Bd.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return ks(s9.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return ks(e9.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return ks(V9(e,r),r);case"wk1":return l0(Cc.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return l0(Cc.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),l0(R9(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),UMe(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return RMe(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function FE(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function kP(e,t,r){var n=r||{};return n.type="file",n.file=t,FE(n),kb(e,n)}function LMe(e,t,r){var n=r||{};return n.type="file",n.file=t,FE(n),OE(e,n)}function BMe(e,t,r,n){var a=r||{};a.type="file",a.file=e,FE(a),a.type="buffer";var i=n;return i instanceof Function||(i=r),fl.writeFile(e,kb(t,a),i)}function J9(e,t,r,n,a,i,s,l){var c=$r(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!s||e[r])for(var m=t.s.c;m<=t.e.c;++m){var x=s?e[r][m]:e[n[m]+c];if(x===void 0||x.t===void 0){if(u===void 0)continue;i[m]!=null&&(h[i[m]]=u);continue}var p=x.v;switch(x.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[m]!=null){if(p==null)if(x.t=="e"&&p===null)h[i[m]]=null;else if(u!==void 0)h[i[m]]=u;else if(d&&p===null)h[i[m]]=null;else continue;else h[i[m]]=d&&(x.t!=="n"||x.t==="n"&&l.rawNumbers!==!1)?p:Vs(x,p,l);p!=null&&(f=!1)}}return{row:h,isempty:f}}function vv(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=Ft(d);break;case"number":c=Ft(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(a=0);var f=$r(c.s.r),h=[],m=[],x=0,p=0,g=Array.isArray(e),v=c.s.r,y=0,b={};g&&!e[v]&&(e[v]=[]);var w=u.skipHidden&&e["!cols"]||[],_=u.skipHidden&&e["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(w[y]||{}).hidden)switch(h[y]=wr(y),r=g?e[v][y]:e[h[y]+f],n){case 1:i[y]=y-c.s.c;break;case 2:i[y]=h[y];break;case 3:i[y]=u.header[y-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=s=Vs(r,null,u),p=b[s]||0,!p)b[s]=1;else{do l=s+"_"+p++;while(b[l]);b[s]=p,b[l]=1}i[y]=l}for(v=c.s.r+a;v<=c.e.r;++v)if(!(_[v]||{}).hidden){var D=J9(e,c,v,h,n,i,g,u);(D.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(m[x++]=D.row)}return m.length=x,m}var CP=/"/g;function Q9(e,t,r,n,a,i,s,l){for(var c=!0,u=[],d="",f=$r(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var m=l.dense?(e[r]||[])[h]:e[n[h]+f];if(m==null)d="";else if(m.v!=null){c=!1,d=""+(l.rawNumbers&&m.t=="n"?m.v:Vs(m,null,l));for(var x=0,p=0;x!==d.length;++x)if((p=d.charCodeAt(x))===a||p===i||p===34||l.forceQuotes){d='"'+d.replace(CP,'""')+'"';break}d=="ID"&&(d='"ID"')}else m.f!=null&&!m.F?(c=!1,d="="+m.f,d.indexOf(",")>=0&&(d='"'+d.replace(CP,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(s)}function PE(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Ft(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],m=n.skipHidden&&e["!rows"]||[],x=a.s.c;x<=a.e.c;++x)(h[x]||{}).hidden||(f[x]=wr(x));for(var p=0,g=a.s.r;g<=a.e.r;++g)(m[g]||{}).hidden||(d=Q9(e,a,g,f,s,c,i,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((p++?l:"")+d)));return delete n.dense,r.join("")}function e7(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=PE(e,t);if(typeof Ut>"u"||t.type=="string")return r;var n=Ut.utils.encode(1200,r,"str");return""+n}function WMe(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Ft(e["!ref"]),i="",s=[],l,c=[],u=Array.isArray(e);for(l=a.s.c;l<=a.e.c;++l)s[l]=wr(l);for(var d=a.s.r;d<=a.e.r;++d)for(i=$r(d),l=a.s.c;l<=a.e.c;++l)if(t=s[l]+i,r=u?(e[d]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function t7(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},s=0,l=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?Fr(n.origin):n.origin;s=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:s+t.length-1+a}};if(i["!ref"]){var f=Ft(i["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),s==-1&&(s=f.e.r+1,d.e.r=s+t.length-1+a)}else s==-1&&(s=0,d.e.r=t.length-1+a);var h=n.header||[],m=0;t.forEach(function(p,g){zr(p).forEach(function(v){(m=h.indexOf(v))==-1&&(h[m=h.length]=v);var y=p[v],b="z",w="",_=pt({c:l+m,r:s+g+a});u=Zm(i,_),y&&typeof y=="object"&&!(y instanceof Date)?i[_]=y:(typeof y=="number"?b="n":typeof y=="boolean"?b="b":typeof y=="string"?b="s":y instanceof Date?(b="d",n.cellDates||(b="n",y=dn(y)),w=n.dateNF||dt[14]):y===null&&n.nullError&&(b="e",y=0),u?(u.t=b,u.v=y,delete u.w,delete u.R,w&&(u.z=w)):i[_]=u={t:b,v:y},w&&(u.z=w))})}),d.e.c=Math.max(d.e.c,l+h.length-1);var x=$r(s);if(a)for(m=0;m<h.length;++m)i[wr(m+l)+x]={t:"s",v:h[m]};return i["!ref"]=Dt(d),i}function zMe(e,t){return t7(null,e,t)}function Zm(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Fr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Zm(e,pt(t)):Zm(e,pt({r:t,c:r||0}))}function HMe(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function IE(){return{SheetNames:[],Sheets:{}}}function RE(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(C9(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function VMe(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=HMe(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function qMe(e,t){return e.z=t,e}function r7(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function GMe(e,t,r){return r7(e,"#"+t,r)}function YMe(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function XMe(e,t,r,n){for(var a=typeof t!="string"?t:Ft(t),i=typeof t=="string"?t:Dt(t),s=a.s.r;s<=a.e.r;++s)for(var l=a.s.c;l<=a.e.c;++l){var c=Zm(e,s,l);c.t="n",c.F=i,delete c.v,s==a.s.r&&l==a.s.c&&(c.f=r,n&&(c.D=!0))}return e}var n7={encode_col:wr,encode_row:$r,encode_cell:pt,encode_range:Dt,decode_col:lE,decode_row:oE,split_cell:m3e,decode_cell:Fr,decode_range:ba,format_cell:Vs,sheet_add_aoa:wB,sheet_add_json:t7,sheet_add_dom:W9,aoa_to_sheet:kf,json_to_sheet:zMe,table_to_sheet:z9,table_to_book:iMe,sheet_to_csv:PE,sheet_to_txt:e7,sheet_to_json:vv,sheet_to_html:B9,sheet_to_formulae:WMe,sheet_to_row_object_array:vv,sheet_get_cell:Zm,book_new:IE,book_append_sheet:RE,book_set_sheet_visibility:VMe,cell_set_number_format:qMe,cell_set_hyperlink:r7,cell_set_internal_link:GMe,cell_add_comment:YMe,sheet_set_array_formula:XMe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Cb;function KMe(e){Cb=e}function ZMe(e,t){var r=Cb(),n=t??{};if(e==null||e["!ref"]==null)return r.push(null),r;var a=Ft(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],m=n.skipHidden&&e["!rows"]||[],x=a.s.c;x<=a.e.c;++x)(h[x]||{}).hidden||(f[x]=wr(x));var p=a.s.r,g=!1,v=0;return r._read=function(){if(!g)return g=!0,r.push("\uFEFF");for(;p<=a.e.r;)if(++p,!(m[p-1]||{}).hidden&&(d=Q9(e,a,p-1,f,s,c,i,n),d!=null&&(n.strip&&(d=d.replace(u,"")),d||n.blankrows!==!1)))return r.push((v++?l:"")+d);return r.push(null)},r}function JMe(e,t){var r=Cb(),n=t||{},a=n.header!=null?n.header:U9,i=n.footer!=null?n.footer:$9;r.push(a);var s=ba(e["!ref"]);n.dense=Array.isArray(e),r.push(L9(e,s,n));var l=s.s.r,c=!1;return r._read=function(){if(l>s.e.r)return c||(c=!0,r.push("</table>"+i)),r.push(null);for(;l<=s.e.r;){r.push(M9(e,s,l,n)),++l;break}},r}function QMe(e,t){var r=Cb({objectMode:!0});if(e==null||e["!ref"]==null)return r.push(null),r;var n={t:"n",v:0},a=0,i=1,s=[],l=0,c="",u={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},f=d.range!=null?d.range:e["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)&&(a=3),typeof f){case"string":u=Ft(f);break;case"number":u=Ft(e["!ref"]),u.s.r=f;break;default:u=f}a>0&&(i=0);var h=$r(u.s.r),m=[],x=0,p=Array.isArray(e),g=u.s.r,v=0,y={};p&&!e[g]&&(e[g]=[]);var b=d.skipHidden&&e["!cols"]||[],w=d.skipHidden&&e["!rows"]||[];for(v=u.s.c;v<=u.e.c;++v)if(!(b[v]||{}).hidden)switch(m[v]=wr(v),n=p?e[g][v]:e[m[v]+h],a){case 1:s[v]=v-u.s.c;break;case 2:s[v]=m[v];break;case 3:s[v]=d.header[v-u.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),c=l=Vs(n,null,d),x=y[l]||0,!x)y[l]=1;else{do c=l+"_"+x++;while(y[c]);y[l]=x,y[c]=1}s[v]=c}return g=u.s.r+i,r._read=function(){for(;g<=u.e.r;)if(!(w[g-1]||{}).hidden){var _=J9(e,u,g,m,a,s,p,d);if(++g,_.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows)){r.push(_.row);return}}return r.push(null)},r}var eUe={to_json:QMe,to_html:JMe,to_csv:ZMe,set_readable:KMe};const tUe=Mm.version,rUe=Object.freeze(Object.defineProperty({__proto__:null,CFB:it,SSF:tB,parse_xlscfb:EE,parse_zip:G9,read:Km,readFile:TP,readFileSync:TP,set_cptable:iAe,set_fs:PAe,stream:eUe,utils:n7,version:tUe,write:kb,writeFile:kP,writeFileAsync:BMe,writeFileSync:kP,writeFileXLSX:LMe,writeXLSX:OE},Symbol.toStringTag,{value:"Module"})),nUe=({fileUrl:e,fileName:t})=>{const[r,n]=M.useState(null),[a,i]=M.useState([]),[s,l]=M.useState(""),[c,u]=M.useState([]),[d,f]=M.useState([]),[h,m]=M.useState(!0),[x,p]=M.useState(null),[g,v]=M.useState(1),y=50;M.useEffect(()=>{e&&(async()=>{try{m(!0),p(null);const E=await fetch(e);if(!E.ok)throw new Error("Failed to load file");const A=await E.arrayBuffer(),T=new Uint8Array(A),L=Km(T,{type:"array"});if(L.SheetNames.length===0){p("Excel file has no sheets"),m(!1);return}n(L),i(L.SheetNames),l(L.SheetNames[0]),b(L,L.SheetNames[0]),m(!1)}catch(E){p(E.message),m(!1)}})()},[e]);const b=(S,E)=>{try{const A=S.Sheets[E],T=n7.sheet_to_json(A,{header:1,defval:""});if(T.length===0){f([]),u([]);return}const L=T[0],O=T.slice(1);f(L),u(O),v(1)}catch(A){console.error("Error loading sheet:",A),f([]),u([])}},w=S=>{l(S),b(r,S)};if(h)return o.jsx("div",{className:"flex items-center justify-center h-full min-h-[400px]",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2"}),o.jsx("p",{className:"text-text-secondary",children:"Loading Excel file..."})]})});if(x)return o.jsxs("div",{className:"flex flex-col items-center justify-center h-full min-h-[400px] text-center",children:[o.jsx(Y,{name:"AlertCircle",size:48,className:"text-error mb-4"}),o.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-2",children:"Failed to load Excel file"}),o.jsx("p",{className:"text-text-secondary",children:x})]});const _=Math.ceil(c.length/y),D=(g-1)*y,j=D+y,N=c.slice(D,j);return o.jsxs("div",{className:"h-full flex flex-col",children:[a.length>1&&o.jsx("div",{className:"flex items-center space-x-1 px-2 py-2 bg-gray-100 dark:bg-gray-800 rounded-t-lg overflow-x-auto",children:a.map(S=>o.jsx("button",{onClick:()=>w(S),className:`px-4 py-2 text-sm font-medium rounded transition-colors whitespace-nowrap ${s===S?"bg-white dark:bg-gray-700 text-primary shadow":"text-text-secondary hover:text-text-primary hover:bg-gray-50 dark:hover:bg-gray-700/50"}`,children:S},S))}),o.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 px-4 py-2 flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4 text-sm text-text-secondary",children:[o.jsxs("span",{children:[o.jsx("strong",{children:c.length})," rows"]}),o.jsx("span",{children:""}),o.jsxs("span",{children:[o.jsx("strong",{children:d.length})," columns"]}),a.length>1&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsxs("span",{children:[o.jsx("strong",{children:a.length})," sheets"]})]})]}),_>1&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:()=>v(S=>Math.max(1,S-1)),disabled:g===1,className:"p-1 rounded hover:bg-white dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:o.jsx(Y,{name:"ChevronLeft",size:16})}),o.jsxs("span",{className:"text-sm text-text-secondary",children:["Page ",g," of ",_]}),o.jsx("button",{onClick:()=>v(S=>Math.min(_,S+1)),disabled:g===_,className:"p-1 rounded hover:bg-white dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:o.jsx(Y,{name:"ChevronRight",size:16})})]})]}),o.jsx("div",{className:"flex-1 overflow-auto bg-white dark:bg-gray-800 rounded-b-lg",children:d.length===0?o.jsx("div",{className:"flex items-center justify-center h-full min-h-[200px]",children:o.jsx("p",{className:"text-text-secondary",children:"Sheet is empty"})}):o.jsxs("table",{className:"w-full border-collapse",children:[o.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700 sticky top-0",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-text-secondary border-b border-border w-12",children:"#"}),d.map((S,E)=>o.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-text-secondary border-b border-border whitespace-nowrap",children:S||`Column ${E+1}`},E))]})}),o.jsx("tbody",{children:N.map((S,E)=>o.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[o.jsx("td",{className:"px-4 py-2 text-xs text-text-tertiary border-b border-border",children:D+E+1}),d.map((A,T)=>o.jsx("td",{className:"px-4 py-2 text-sm text-text-primary border-b border-border whitespace-nowrap",children:S[T]!==void 0&&S[T]!==null?String(S[T]):""},T))]},D+E))})]})})]})};var _s={},ME="1.13.7",AP=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||Function("return this")()||{},Ab=Array.prototype,UE=Object.prototype,OP=typeof Symbol<"u"?Symbol.prototype:null,aUe=Ab.push,dx=Ab.slice,Jm=UE.toString,iUe=UE.hasOwnProperty,a7=typeof ArrayBuffer<"u",sUe=typeof DataView<"u",oUe=Array.isArray,FP=Object.keys,PP=Object.create,IP=a7&&ArrayBuffer.isView,lUe=isNaN,cUe=isFinite,i7=!{toString:null}.propertyIsEnumerable("toString"),RP=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],uUe=Math.pow(2,53)-1;function wa(e,t){return t=t==null?e.length-1:+t,function(){for(var r=Math.max(arguments.length-t,0),n=Array(r),a=0;a<r;a++)n[a]=arguments[a+t];switch(t){case 0:return e.call(this,n);case 1:return e.call(this,arguments[0],n);case 2:return e.call(this,arguments[0],arguments[1],n)}var i=Array(t+1);for(a=0;a<t;a++)i[a]=arguments[a];return i[t]=n,e.apply(this,i)}}function ql(e){var t=typeof e;return t==="function"||t==="object"&&!!e}function s7(e){return e===null}function $E(e){return e===void 0}function LE(e){return e===!0||e===!1||Jm.call(e)==="[object Boolean]"}function o7(e){return!!(e&&e.nodeType===1)}function la(e){var t="[object "+e+"]";return function(r){return Jm.call(r)===t}}const Ob=la("String"),BE=la("Number"),l7=la("Date"),c7=la("RegExp"),u7=la("Error"),WE=la("Symbol"),zE=la("ArrayBuffer");var d7=la("Function"),dUe=AP.document&&AP.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof dUe!="function"&&(d7=function(e){return typeof e=="function"||!1});const ia=d7,f7=la("Object");var h7=sUe&&(!/\[native code\]/.test(String(DataView))||f7(new DataView(new ArrayBuffer(8)))),HE=typeof Map<"u"&&f7(new Map),fUe=la("DataView");function hUe(e){return e!=null&&ia(e.getInt8)&&zE(e.buffer)}const Qm=h7?hUe:fUe,Gl=oUe||la("Array");function Yl(e,t){return e!=null&&iUe.call(e,t)}var _j=la("Arguments");(function(){_j(arguments)||(_j=function(e){return Yl(e,"callee")})})();const Fb=_j;function m7(e){return!WE(e)&&cUe(e)&&!isNaN(parseFloat(e))}function VE(e){return BE(e)&&lUe(e)}function qE(e){return function(){return e}}function p7(e){return function(t){var r=e(t);return typeof r=="number"&&r>=0&&r<=uUe}}function x7(e){return function(t){return t==null?void 0:t[e]}}const yv=x7("byteLength"),mUe=p7(yv);var pUe=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;function xUe(e){return IP?IP(e)&&!Qm(e):mUe(e)&&pUe.test(Jm.call(e))}const GE=a7?xUe:qE(!1),Ma=x7("length");function gUe(e){for(var t={},r=e.length,n=0;n<r;++n)t[e[n]]=!0;return{contains:function(a){return t[a]===!0},push:function(a){return t[a]=!0,e.push(a)}}}function g7(e,t){t=gUe(t);var r=RP.length,n=e.constructor,a=ia(n)&&n.prototype||UE,i="constructor";for(Yl(e,i)&&!t.contains(i)&&t.push(i);r--;)i=RP[r],i in e&&e[i]!==a[i]&&!t.contains(i)&&t.push(i)}function fn(e){if(!ql(e))return[];if(FP)return FP(e);var t=[];for(var r in e)Yl(e,r)&&t.push(r);return i7&&g7(e,t),t}function v7(e){if(e==null)return!0;var t=Ma(e);return typeof t=="number"&&(Gl(e)||Ob(e)||Fb(e))?t===0:Ma(fn(e))===0}function YE(e,t){var r=fn(t),n=r.length;if(e==null)return!n;for(var a=Object(e),i=0;i<n;i++){var s=r[i];if(t[s]!==a[s]||!(s in a))return!1}return!0}function Gt(e){if(e instanceof Gt)return e;if(!(this instanceof Gt))return new Gt(e);this._wrapped=e}Gt.VERSION=ME;Gt.prototype.value=function(){return this._wrapped};Gt.prototype.valueOf=Gt.prototype.toJSON=Gt.prototype.value;Gt.prototype.toString=function(){return String(this._wrapped)};function MP(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,yv(e))}var UP="[object DataView]";function Dj(e,t,r,n){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var a=typeof e;return a!=="function"&&a!=="object"&&typeof t!="object"?!1:y7(e,t,r,n)}function y7(e,t,r,n){e instanceof Gt&&(e=e._wrapped),t instanceof Gt&&(t=t._wrapped);var a=Jm.call(e);if(a!==Jm.call(t))return!1;if(h7&&a=="[object Object]"&&Qm(e)){if(!Qm(t))return!1;a=UP}switch(a){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return OP.valueOf.call(e)===OP.valueOf.call(t);case"[object ArrayBuffer]":case UP:return y7(MP(e),MP(t),r,n)}var i=a==="[object Array]";if(!i&&GE(e)){var s=yv(e);if(s!==yv(t))return!1;if(e.buffer===t.buffer&&e.byteOffset===t.byteOffset)return!0;i=!0}if(!i){if(typeof e!="object"||typeof t!="object")return!1;var l=e.constructor,c=t.constructor;if(l!==c&&!(ia(l)&&l instanceof l&&ia(c)&&c instanceof c)&&"constructor"in e&&"constructor"in t)return!1}r=r||[],n=n||[];for(var u=r.length;u--;)if(r[u]===e)return n[u]===t;if(r.push(e),n.push(t),i){if(u=e.length,u!==t.length)return!1;for(;u--;)if(!Dj(e[u],t[u],r,n))return!1}else{var d=fn(e),f;if(u=d.length,fn(t).length!==u)return!1;for(;u--;)if(f=d[u],!(Yl(t,f)&&Dj(e[f],t[f],r,n)))return!1}return r.pop(),n.pop(),!0}function b7(e,t){return Dj(e,t)}function Af(e){if(!ql(e))return[];var t=[];for(var r in e)t.push(r);return i7&&g7(e,t),t}function XE(e){var t=Ma(e);return function(r){if(r==null)return!1;var n=Af(r);if(Ma(n))return!1;for(var a=0;a<t;a++)if(!ia(r[e[a]]))return!1;return e!==D7||!ia(r[KE])}}var KE="forEach",w7="has",ZE=["clear","delete"],_7=["get",w7,"set"],vUe=ZE.concat(KE,_7),D7=ZE.concat(_7),yUe=["add"].concat(ZE,KE,w7);const j7=HE?XE(vUe):la("Map"),N7=HE?XE(D7):la("WeakMap"),S7=HE?XE(yUe):la("Set"),E7=la("WeakSet");function gu(e){for(var t=fn(e),r=t.length,n=Array(r),a=0;a<r;a++)n[a]=e[t[a]];return n}function T7(e){for(var t=fn(e),r=t.length,n=Array(r),a=0;a<r;a++)n[a]=[t[a],e[t[a]]];return n}function JE(e){for(var t={},r=fn(e),n=0,a=r.length;n<a;n++)t[e[r[n]]]=r[n];return t}function ep(e){var t=[];for(var r in e)ia(e[r])&&t.push(r);return t.sort()}function QE(e,t){return function(r){var n=arguments.length;if(t&&(r=Object(r)),n<2||r==null)return r;for(var a=1;a<n;a++)for(var i=arguments[a],s=e(i),l=s.length,c=0;c<l;c++){var u=s[c];(!t||r[u]===void 0)&&(r[u]=i[u])}return r}}const eT=QE(Af),zd=QE(fn),tT=QE(Af,!0);function bUe(){return function(){}}function k7(e){if(!ql(e))return{};if(PP)return PP(e);var t=bUe();t.prototype=e;var r=new t;return t.prototype=null,r}function C7(e,t){var r=k7(e);return t&&zd(r,t),r}function A7(e){return ql(e)?Gl(e)?e.slice():eT({},e):e}function O7(e,t){return t(e),e}function rT(e){return Gl(e)?e:[e]}Gt.toPath=rT;function fx(e){return Gt.toPath(e)}function nT(e,t){for(var r=t.length,n=0;n<r;n++){if(e==null)return;e=e[t[n]]}return r?e:void 0}function aT(e,t,r){var n=nT(e,fx(t));return $E(n)?r:n}function F7(e,t){t=fx(t);for(var r=t.length,n=0;n<r;n++){var a=t[n];if(!Yl(e,a))return!1;e=e[a]}return!!r}function Pb(e){return e}function Yc(e){return e=zd({},e),function(t){return YE(t,e)}}function Ib(e){return e=fx(e),function(t){return nT(t,e)}}function hx(e,t,r){if(t===void 0)return e;switch(r??3){case 1:return function(n){return e.call(t,n)};case 3:return function(n,a,i){return e.call(t,n,a,i)};case 4:return function(n,a,i,s){return e.call(t,n,a,i,s)}}return function(){return e.apply(t,arguments)}}function P7(e,t,r){return e==null?Pb:ia(e)?hx(e,t,r):ql(e)&&!Gl(e)?Yc(e):Ib(e)}function Rb(e,t){return P7(e,t,1/0)}Gt.iteratee=Rb;function $a(e,t,r){return Gt.iteratee!==Rb?Gt.iteratee(e,t):P7(e,t,r)}function I7(e,t,r){t=$a(t,r);for(var n=fn(e),a=n.length,i={},s=0;s<a;s++){var l=n[s];i[l]=t(e[l],l,e)}return i}function iT(){}function R7(e){return e==null?iT:function(t){return aT(e,t)}}function M7(e,t,r){var n=Array(Math.max(0,e));t=hx(t,r,1);for(var a=0;a<e;a++)n[a]=t(a);return n}function bv(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}const Hd=Date.now||function(){return new Date().getTime()};function U7(e){var t=function(i){return e[i]},r="(?:"+fn(e).join("|")+")",n=RegExp(r),a=RegExp(r,"g");return function(i){return i=i==null?"":""+i,n.test(i)?i.replace(a,t):i}}const $7={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},L7=U7($7),wUe=JE($7),B7=U7(wUe),W7=Gt.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var Hw=/(.)^/,_Ue={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},DUe=/\\|'|\r|\n|\u2028|\u2029/g;function jUe(e){return"\\"+_Ue[e]}var NUe=/^\s*(\w|\$)+\s*$/;function z7(e,t,r){!t&&r&&(t=r),t=tT({},t,Gt.templateSettings);var n=RegExp([(t.escape||Hw).source,(t.interpolate||Hw).source,(t.evaluate||Hw).source].join("|")+"|$","g"),a=0,i="__p+='";e.replace(n,function(u,d,f,h,m){return i+=e.slice(a,m).replace(DUe,jUe),a=m+u.length,d?i+=`'+
((__t=(`+d+`))==null?'':_.escape(__t))+
'`:f?i+=`'+
((__t=(`+f+`))==null?'':__t)+
'`:h&&(i+=`';
`+h+`
__p+='`),u}),i+=`';
`;var s=t.variable;if(s){if(!NUe.test(s))throw new Error("variable is not a bare identifier: "+s)}else i=`with(obj||{}){
`+i+`}
`,s="obj";i=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+i+`return __p;
`;var l;try{l=new Function(s,"_",i)}catch(u){throw u.source=i,u}var c=function(u){return l.call(this,u,Gt)};return c.source="function("+s+`){
`+i+"}",c}function H7(e,t,r){t=fx(t);var n=t.length;if(!n)return ia(r)?r.call(e):r;for(var a=0;a<n;a++){var i=e==null?void 0:e[t[a]];i===void 0&&(i=r,a=n),e=ia(i)?i.call(e):i}return e}var SUe=0;function V7(e){var t=++SUe+"";return e?e+t:t}function q7(e){var t=Gt(e);return t._chain=!0,t}function G7(e,t,r,n,a){if(!(n instanceof t))return e.apply(r,a);var i=k7(e.prototype),s=e.apply(i,a);return ql(s)?s:i}var vu=wa(function(e,t){var r=vu.placeholder,n=function(){for(var a=0,i=t.length,s=Array(i),l=0;l<i;l++)s[l]=t[l]===r?arguments[a++]:t[l];for(;a<arguments.length;)s.push(arguments[a++]);return G7(e,n,this,this,s)};return n});vu.placeholder=Gt;const sT=wa(function(e,t,r){if(!ia(e))throw new TypeError("Bind must be called on a function");var n=wa(function(a){return G7(e,n,t,this,r.concat(a))});return n}),di=p7(Ma);function yu(e,t,r,n){if(n=n||[],!t&&t!==0)t=1/0;else if(t<=0)return n.concat(e);for(var a=n.length,i=0,s=Ma(e);i<s;i++){var l=e[i];if(di(l)&&(Gl(l)||Fb(l)))if(t>1)yu(l,t-1,r,n),a=n.length;else for(var c=0,u=l.length;c<u;)n[a++]=l[c++];else r||(n[a++]=l)}return n}const Y7=wa(function(e,t){t=yu(t,!1,!1);var r=t.length;if(r<1)throw new Error("bindAll must be passed function names");for(;r--;){var n=t[r];e[n]=sT(e[n],e)}return e});function X7(e,t){var r=function(n){var a=r.cache,i=""+(t?t.apply(this,arguments):n);return Yl(a,i)||(a[i]=e.apply(this,arguments)),a[i]};return r.cache={},r}const oT=wa(function(e,t,r){return setTimeout(function(){return e.apply(null,r)},t)}),K7=vu(oT,Gt,1);function Z7(e,t,r){var n,a,i,s,l=0;r||(r={});var c=function(){l=r.leading===!1?0:Hd(),n=null,s=e.apply(a,i),n||(a=i=null)},u=function(){var d=Hd();!l&&r.leading===!1&&(l=d);var f=t-(d-l);return a=this,i=arguments,f<=0||f>t?(n&&(clearTimeout(n),n=null),l=d,s=e.apply(a,i),n||(a=i=null)):!n&&r.trailing!==!1&&(n=setTimeout(c,f)),s};return u.cancel=function(){clearTimeout(n),l=0,n=a=i=null},u}function J7(e,t,r){var n,a,i,s,l,c=function(){var d=Hd()-a;t>d?n=setTimeout(c,t-d):(n=null,r||(s=e.apply(l,i)),n||(i=l=null))},u=wa(function(d){return l=this,i=d,a=Hd(),n||(n=setTimeout(c,t),r&&(s=e.apply(l,i))),s});return u.cancel=function(){clearTimeout(n),n=i=l=null},u}function Q7(e,t){return vu(t,e)}function Mb(e){return function(){return!e.apply(this,arguments)}}function eW(){var e=arguments,t=e.length-1;return function(){for(var r=t,n=e[t].apply(this,arguments);r--;)n=e[r].call(this,n);return n}}function tW(e,t){return function(){if(--e<1)return t.apply(this,arguments)}}function lT(e,t){var r;return function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=null),r}}const rW=vu(lT,2);function cT(e,t,r){t=$a(t,r);for(var n=fn(e),a,i=0,s=n.length;i<s;i++)if(a=n[i],t(e[a],a,e))return a}function nW(e){return function(t,r,n){r=$a(r,n);for(var a=Ma(t),i=e>0?0:a-1;i>=0&&i<a;i+=e)if(r(t[i],i,t))return i;return-1}}const Ub=nW(1),uT=nW(-1);function dT(e,t,r,n){r=$a(r,n,1);for(var a=r(t),i=0,s=Ma(e);i<s;){var l=Math.floor((i+s)/2);r(e[l])<a?i=l+1:s=l}return i}function aW(e,t,r){return function(n,a,i){var s=0,l=Ma(n);if(typeof i=="number")e>0?s=i>=0?i:Math.max(i+l,s):l=i>=0?Math.min(i+1,l):i+l+1;else if(r&&i&&l)return i=r(n,a),n[i]===a?i:-1;if(a!==a)return i=t(dx.call(n,s,l),VE),i>=0?i+s:-1;for(i=e>0?s:l-1;i>=0&&i<l;i+=e)if(n[i]===a)return i;return-1}}const fT=aW(1,Ub,dT),iW=aW(-1,uT);function tp(e,t,r){var n=di(e)?Ub:cT,a=n(e,t,r);if(a!==void 0&&a!==-1)return e[a]}function sW(e,t){return tp(e,Yc(t))}function fs(e,t,r){t=hx(t,r);var n,a;if(di(e))for(n=0,a=e.length;n<a;n++)t(e[n],n,e);else{var i=fn(e);for(n=0,a=i.length;n<a;n++)t(e[i[n]],i[n],e)}return e}function Ro(e,t,r){t=$a(t,r);for(var n=!di(e)&&fn(e),a=(n||e).length,i=Array(a),s=0;s<a;s++){var l=n?n[s]:s;i[s]=t(e[l],l,e)}return i}function oW(e){var t=function(r,n,a,i){var s=!di(r)&&fn(r),l=(s||r).length,c=e>0?0:l-1;for(i||(a=r[s?s[c]:c],c+=e);c>=0&&c<l;c+=e){var u=s?s[c]:c;a=n(a,r[u],u,r)}return a};return function(r,n,a,i){var s=arguments.length>=3;return t(r,hx(n,i,4),a,s)}}const sd=oW(1),wv=oW(-1);function Al(e,t,r){var n=[];return t=$a(t,r),fs(e,function(a,i,s){t(a,i,s)&&n.push(a)}),n}function lW(e,t,r){return Al(e,Mb($a(t)),r)}function _v(e,t,r){t=$a(t,r);for(var n=!di(e)&&fn(e),a=(n||e).length,i=0;i<a;i++){var s=n?n[i]:i;if(!t(e[s],s,e))return!1}return!0}function Dv(e,t,r){t=$a(t,r);for(var n=!di(e)&&fn(e),a=(n||e).length,i=0;i<a;i++){var s=n?n[i]:i;if(t(e[s],s,e))return!0}return!1}function Ui(e,t,r,n){return di(e)||(e=gu(e)),(typeof r!="number"||n)&&(r=0),fT(e,t,r)>=0}const cW=wa(function(e,t,r){var n,a;return ia(t)?a=t:(t=fx(t),n=t.slice(0,-1),t=t[t.length-1]),Ro(e,function(i){var s=a;if(!s){if(n&&n.length&&(i=nT(i,n)),i==null)return;s=i[t]}return s==null?s:s.apply(i,r)})});function $b(e,t){return Ro(e,Ib(t))}function uW(e,t){return Al(e,Yc(t))}function hT(e,t,r){var n=-1/0,a=-1/0,i,s;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=di(e)?e:gu(e);for(var l=0,c=e.length;l<c;l++)i=e[l],i!=null&&i>n&&(n=i)}else t=$a(t,r),fs(e,function(u,d,f){s=t(u,d,f),(s>a||s===-1/0&&n===-1/0)&&(n=u,a=s)});return n}function dW(e,t,r){var n=1/0,a=1/0,i,s;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=di(e)?e:gu(e);for(var l=0,c=e.length;l<c;l++)i=e[l],i!=null&&i<n&&(n=i)}else t=$a(t,r),fs(e,function(u,d,f){s=t(u,d,f),(s<a||s===1/0&&n===1/0)&&(n=u,a=s)});return n}var EUe=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function mT(e){return e?Gl(e)?dx.call(e):Ob(e)?e.match(EUe):di(e)?Ro(e,Pb):gu(e):[]}function pT(e,t,r){if(t==null||r)return di(e)||(e=gu(e)),e[bv(e.length-1)];var n=mT(e),a=Ma(n);t=Math.max(Math.min(t,a),0);for(var i=a-1,s=0;s<t;s++){var l=bv(s,i),c=n[s];n[s]=n[l],n[l]=c}return n.slice(0,t)}function fW(e){return pT(e,1/0)}function hW(e,t,r){var n=0;return t=$a(t,r),$b(Ro(e,function(a,i,s){return{value:a,index:n++,criteria:t(a,i,s)}}).sort(function(a,i){var s=a.criteria,l=i.criteria;if(s!==l){if(s>l||s===void 0)return 1;if(s<l||l===void 0)return-1}return a.index-i.index}),"value")}function Lb(e,t){return function(r,n,a){var i=t?[[],[]]:{};return n=$a(n,a),fs(r,function(s,l){var c=n(s,l,r);e(i,s,c)}),i}}const mW=Lb(function(e,t,r){Yl(e,r)?e[r].push(t):e[r]=[t]}),pW=Lb(function(e,t,r){e[r]=t}),xW=Lb(function(e,t,r){Yl(e,r)?e[r]++:e[r]=1}),gW=Lb(function(e,t,r){e[r?0:1].push(t)},!0);function vW(e){return e==null?0:di(e)?e.length:fn(e).length}function TUe(e,t,r){return t in r}const xT=wa(function(e,t){var r={},n=t[0];if(e==null)return r;ia(n)?(t.length>1&&(n=hx(n,t[1])),t=Af(e)):(n=TUe,t=yu(t,!1,!1),e=Object(e));for(var a=0,i=t.length;a<i;a++){var s=t[a],l=e[s];n(l,s,e)&&(r[s]=l)}return r}),yW=wa(function(e,t){var r=t[0],n;return ia(r)?(r=Mb(r),t.length>1&&(n=t[1])):(t=Ro(yu(t,!1,!1),String),r=function(a,i){return!Ui(t,i)}),xT(e,r,n)});function gT(e,t,r){return dx.call(e,0,Math.max(0,e.length-(t==null||r?1:t)))}function od(e,t,r){return e==null||e.length<1?t==null||r?void 0:[]:t==null||r?e[0]:gT(e,e.length-t)}function Oc(e,t,r){return dx.call(e,t==null||r?1:t)}function bW(e,t,r){return e==null||e.length<1?t==null||r?void 0:[]:t==null||r?e[e.length-1]:Oc(e,Math.max(0,e.length-t))}function wW(e){return Al(e,Boolean)}function _W(e,t){return yu(e,t,!1)}const vT=wa(function(e,t){return t=yu(t,!0,!0),Al(e,function(r){return!Ui(t,r)})}),DW=wa(function(e,t){return vT(e,t)});function rp(e,t,r,n){LE(t)||(n=r,r=t,t=!1),r!=null&&(r=$a(r,n));for(var a=[],i=[],s=0,l=Ma(e);s<l;s++){var c=e[s],u=r?r(c,s,e):c;t&&!r?((!s||i!==u)&&a.push(c),i=u):r?Ui(i,u)||(i.push(u),a.push(c)):Ui(a,c)||a.push(c)}return a}const jW=wa(function(e){return rp(yu(e,!0,!0))});function NW(e){for(var t=[],r=arguments.length,n=0,a=Ma(e);n<a;n++){var i=e[n];if(!Ui(t,i)){var s;for(s=1;s<r&&Ui(arguments[s],i);s++);s===r&&t.push(i)}}return t}function np(e){for(var t=e&&hT(e,Ma).length||0,r=Array(t),n=0;n<t;n++)r[n]=$b(e,n);return r}const SW=wa(np);function EW(e,t){for(var r={},n=0,a=Ma(e);n<a;n++)t?r[e[n]]=t[n]:r[e[n][0]]=e[n][1];return r}function TW(e,t,r){t==null&&(t=e||0,e=0),r||(r=t<e?-1:1);for(var n=Math.max(Math.ceil((t-e)/r),0),a=Array(n),i=0;i<n;i++,e+=r)a[i]=e;return a}function kW(e,t){if(t==null||t<1)return[];for(var r=[],n=0,a=e.length;n<a;)r.push(dx.call(e,n,n+=t));return r}function yT(e,t){return e._chain?Gt(t).chain():t}function bT(e){return fs(ep(e),function(t){var r=Gt[t]=e[t];Gt.prototype[t]=function(){var n=[this._wrapped];return aUe.apply(n,arguments),yT(this,r.apply(Gt,n))}}),Gt}fs(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=Ab[e];Gt.prototype[e]=function(){var r=this._wrapped;return r!=null&&(t.apply(r,arguments),(e==="shift"||e==="splice")&&r.length===0&&delete r[0]),yT(this,r)}});fs(["concat","join","slice"],function(e){var t=Ab[e];Gt.prototype[e]=function(){var r=this._wrapped;return r!=null&&(r=t.apply(r,arguments)),yT(this,r)}});const kUe=Object.freeze(Object.defineProperty({__proto__:null,VERSION:ME,after:tW,all:_v,allKeys:Af,any:Dv,assign:zd,before:lT,bind:sT,bindAll:Y7,chain:q7,chunk:kW,clone:A7,collect:Ro,compact:wW,compose:eW,constant:qE,contains:Ui,countBy:xW,create:C7,debounce:J7,default:Gt,defaults:tT,defer:K7,delay:oT,detect:tp,difference:vT,drop:Oc,each:fs,escape:L7,every:_v,extend:eT,extendOwn:zd,filter:Al,find:tp,findIndex:Ub,findKey:cT,findLastIndex:uT,findWhere:sW,first:od,flatten:_W,foldl:sd,foldr:wv,forEach:fs,functions:ep,get:aT,groupBy:mW,has:F7,head:od,identity:Pb,include:Ui,includes:Ui,indexBy:pW,indexOf:fT,initial:gT,inject:sd,intersection:NW,invert:JE,invoke:cW,isArguments:Fb,isArray:Gl,isArrayBuffer:zE,isBoolean:LE,isDataView:Qm,isDate:l7,isElement:o7,isEmpty:v7,isEqual:b7,isError:u7,isFinite:m7,isFunction:ia,isMap:j7,isMatch:YE,isNaN:VE,isNull:s7,isNumber:BE,isObject:ql,isRegExp:c7,isSet:S7,isString:Ob,isSymbol:WE,isTypedArray:GE,isUndefined:$E,isWeakMap:N7,isWeakSet:E7,iteratee:Rb,keys:fn,last:bW,lastIndexOf:iW,map:Ro,mapObject:I7,matcher:Yc,matches:Yc,max:hT,memoize:X7,methods:ep,min:dW,mixin:bT,negate:Mb,noop:iT,now:Hd,object:EW,omit:yW,once:rW,pairs:T7,partial:vu,partition:gW,pick:xT,pluck:$b,property:Ib,propertyOf:R7,random:bv,range:TW,reduce:sd,reduceRight:wv,reject:lW,rest:Oc,restArguments:wa,result:H7,sample:pT,select:Al,shuffle:fW,size:vW,some:Dv,sortBy:hW,sortedIndex:dT,tail:Oc,take:od,tap:O7,template:z7,templateSettings:W7,throttle:Z7,times:M7,toArray:mT,toPath:rT,transpose:np,unescape:B7,union:jW,uniq:rp,unique:rp,uniqueId:V7,unzip:np,values:gu,where:uW,without:DW,wrap:Q7,zip:SW},Symbol.toStringTag,{value:"Module"}));var jj=bT(kUe);jj._=jj;const CUe=Object.freeze(Object.defineProperty({__proto__:null,VERSION:ME,after:tW,all:_v,allKeys:Af,any:Dv,assign:zd,before:lT,bind:sT,bindAll:Y7,chain:q7,chunk:kW,clone:A7,collect:Ro,compact:wW,compose:eW,constant:qE,contains:Ui,countBy:xW,create:C7,debounce:J7,default:jj,defaults:tT,defer:K7,delay:oT,detect:tp,difference:vT,drop:Oc,each:fs,escape:L7,every:_v,extend:eT,extendOwn:zd,filter:Al,find:tp,findIndex:Ub,findKey:cT,findLastIndex:uT,findWhere:sW,first:od,flatten:_W,foldl:sd,foldr:wv,forEach:fs,functions:ep,get:aT,groupBy:mW,has:F7,head:od,identity:Pb,include:Ui,includes:Ui,indexBy:pW,indexOf:fT,initial:gT,inject:sd,intersection:NW,invert:JE,invoke:cW,isArguments:Fb,isArray:Gl,isArrayBuffer:zE,isBoolean:LE,isDataView:Qm,isDate:l7,isElement:o7,isEmpty:v7,isEqual:b7,isError:u7,isFinite:m7,isFunction:ia,isMap:j7,isMatch:YE,isNaN:VE,isNull:s7,isNumber:BE,isObject:ql,isRegExp:c7,isSet:S7,isString:Ob,isSymbol:WE,isTypedArray:GE,isUndefined:$E,isWeakMap:N7,isWeakSet:E7,iteratee:Rb,keys:fn,last:bW,lastIndexOf:iW,map:Ro,mapObject:I7,matcher:Yc,matches:Yc,max:hT,memoize:X7,methods:ep,min:dW,mixin:bT,negate:Mb,noop:iT,now:Hd,object:EW,omit:yW,once:rW,pairs:T7,partial:vu,partition:gW,pick:xT,pluck:$b,property:Ib,propertyOf:R7,random:bv,range:TW,reduce:sd,reduceRight:wv,reject:lW,rest:Oc,restArguments:wa,result:H7,sample:pT,select:Al,shuffle:fW,size:vW,some:Dv,sortBy:hW,sortedIndex:dT,tail:Oc,take:od,tap:O7,template:z7,templateSettings:W7,throttle:Z7,times:M7,toArray:mT,toPath:rT,transpose:np,unescape:B7,union:jW,uniq:rp,unique:rp,uniqueId:V7,unzip:np,values:gu,where:uW,without:DW,wrap:Q7,zip:SW},Symbol.toStringTag,{value:"Module"})),Xr=uq(CUe);var wT={},Tn={},CW={exports:{}},c0={exports:{}},$P;function Of(){if($P)return c0.exports;$P=1;var e=function(){return this===void 0}();if(e)c0.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:e,propertyIsWritable:function(d,f){var h=Object.getOwnPropertyDescriptor(d,f);return!!(!h||h.writable||h.set)}};else{var t={}.hasOwnProperty,r={}.toString,n={}.constructor.prototype,a=function(d){var f=[];for(var h in d)t.call(d,h)&&f.push(h);return f},i=function(d,f){return{value:d[f]}},s=function(d,f,h){return d[f]=h.value,d},l=function(d){return d},c=function(d){try{return Object(d).constructor.prototype}catch{return n}},u=function(d){try{return r.call(d)==="[object Array]"}catch{return!1}};c0.exports={isArray:u,keys:a,names:a,defineProperty:s,getDescriptor:i,freeze:l,getPrototypeOf:c,isES5:e,propertyIsWritable:function(){return!0}}}return c0.exports}var Vw,LP;function mr(){if(LP)return Vw;LP=1;var e={},t=Of(),r=typeof navigator>"u",n={e:{}},a,i=typeof self<"u"?self:typeof window<"u"?window:typeof ht<"u"?ht:ht!==void 0?ht:null;function s(){try{var k=a;return a=null,k.apply(this,arguments)}catch(z){return n.e=z,n}}function l(k){return a=k,s}var c=function(k,z){var q={}.hasOwnProperty;function K(){this.constructor=k,this.constructor$=z;for(var se in z.prototype)q.call(z.prototype,se)&&se.charAt(se.length-1)!=="$"&&(this[se+"$"]=z.prototype[se])}return K.prototype=z.prototype,k.prototype=new K,k.prototype};function u(k){return k==null||k===!0||k===!1||typeof k=="string"||typeof k=="number"}function d(k){return typeof k=="function"||typeof k=="object"&&k!==null}function f(k){return u(k)?new Error(j(k)):k}function h(k,z){var q=k.length,K=new Array(q+1),se;for(se=0;se<q;++se)K[se]=k[se];return K[se]=z,K}function m(k,z,q){if(t.isES5){var K=Object.getOwnPropertyDescriptor(k,z);if(K!=null)return K.get==null&&K.set==null?K.value:q}else return{}.hasOwnProperty.call(k,z)?k[z]:void 0}function x(k,z,q){if(u(k))return k;var K={value:q,configurable:!0,enumerable:!1,writable:!0};return t.defineProperty(k,z,K),k}function p(k){throw k}var g=function(){var k=[Array.prototype,Object.prototype,Function.prototype],z=function(se){for(var ie=0;ie<k.length;++ie)if(k[ie]===se)return!0;return!1};if(t.isES5){var q=Object.getOwnPropertyNames;return function(se){for(var ie=[],ee=Object.create(null);se!=null&&!z(se);){var ae;try{ae=q(se)}catch{return ie}for(var pe=0;pe<ae.length;++pe){var H=ae[pe];if(!ee[H]){ee[H]=!0;var ne=Object.getOwnPropertyDescriptor(se,H);ne!=null&&ne.get==null&&ne.set==null&&ie.push(H)}}se=t.getPrototypeOf(se)}return ie}}else{var K={}.hasOwnProperty;return function(se){if(z(se))return[];var ie=[];e:for(var ee in se)if(K.call(se,ee))ie.push(ee);else{for(var ae=0;ae<k.length;++ae)if(K.call(k[ae],ee))continue e;ie.push(ee)}return ie}}}(),v=/this\s*\.\s*\S+\s*=/;function y(k){try{if(typeof k=="function"){var z=t.names(k.prototype),q=t.isES5&&z.length>1,K=z.length>0&&!(z.length===1&&z[0]==="constructor"),se=v.test(k+"")&&t.names(k).length>0;if(q||K||se)return!0}return!1}catch{return!1}}function b(k){return k}var w=/^[a-z$_][a-z$_0-9]*$/i;function _(k){return w.test(k)}function D(k,z,q){for(var K=new Array(k),se=0;se<k;++se)K[se]=z+se+q;return K}function j(k){try{return k+""}catch{return"[no string representation]"}}function N(k){return k!==null&&typeof k=="object"&&typeof k.message=="string"&&typeof k.name=="string"}function S(k){try{x(k,"isOperational",!0)}catch{}}function E(k){return k==null?!1:k instanceof Error.__BluebirdErrorTypes__.OperationalError||k.isOperational===!0}function A(k){return N(k)&&t.propertyIsWritable(k,"stack")}var T=function(){return"stack"in new Error?function(k){return A(k)?k:new Error(j(k))}:function(k){if(A(k))return k;try{throw new Error(j(k))}catch(z){return z}}}();function L(k){return{}.toString.call(k)}function O(k,z,q){for(var K=t.names(k),se=0;se<K.length;++se){var ie=K[se];if(q(ie))try{t.defineProperty(z,ie,t.getDescriptor(k,ie))}catch{}}}var V=function(k){return t.isArray(k)?k:null};if(typeof Symbol<"u"&&Symbol.iterator){var W=typeof Array.from=="function"?function(k){return Array.from(k)}:function(k){for(var z=[],q=k[Symbol.iterator](),K;!(K=q.next()).done;)z.push(K.value);return z};V=function(k){return t.isArray(k)?k:k!=null&&typeof k[Symbol.iterator]=="function"?W(k):null}}var B=typeof process<"u"&&L(process).toLowerCase()==="[object process]",P=typeof process<"u"&&typeof e<"u";function F(k){return P?e[k]:void 0}function I(){if(typeof Promise=="function")try{var k=new Promise(function(){});if({}.toString.call(k)==="[object Promise]")return Promise}catch{}}function R(k,z){return k.bind(z)}var C={isClass:y,isIdentifier:_,inheritedDataKeys:g,getDataPropertyOrDefault:m,thrower:p,isArray:t.isArray,asArray:V,notEnumerableProp:x,isPrimitive:u,isObject:d,isError:N,canEvaluate:r,errorObj:n,tryCatch:l,inherits:c,withAppended:h,maybeWrapAsError:f,toFastProperties:b,filledRange:D,toString:j,canAttachTrace:A,ensureErrorObject:T,originatesFromRejection:E,markAsOriginatingFromRejection:S,classString:L,copyDescriptors:O,hasDevTools:typeof chrome<"u"&&chrome&&typeof chrome.loadTimes=="function",isNode:B,hasEnvVariables:P,env:F,global:i,getNativePromise:I,domainBind:R};C.isRecentNode=C.isNode&&function(){var k=process.versions.node.split(".").map(Number);return k[0]===0&&k[1]>10||k[0]>0}(),C.isNode&&C.toFastProperties(process);try{throw new Error}catch(k){C.lastLineError=k}return Vw=C,Vw}var u0={exports:{}},qw,BP;function AUe(){if(BP)return qw;BP=1;var e=mr(),t,r=function(){throw new Error(`No async scheduler available

    See http://goo.gl/MqrFmX
`)},n=e.getNativePromise();if(e.isNode&&typeof MutationObserver>"u"){var a=ht.setImmediate,i=process.nextTick;t=e.isRecentNode?function(l){a.call(ht,l)}:function(l){i.call(process,l)}}else if(typeof n=="function"&&typeof n.resolve=="function"){var s=n.resolve();t=function(l){s.then(l)}}else typeof MutationObserver<"u"&&!(typeof window<"u"&&window.navigator&&(window.navigator.standalone||window.cordova))?t=function(){var l=document.createElement("div"),c={attributes:!0},u=!1,d=document.createElement("div"),f=new MutationObserver(function(){l.classList.toggle("foo"),u=!1});f.observe(d,c);var h=function(){u||(u=!0,d.classList.toggle("foo"))};return function(x){var p=new MutationObserver(function(){p.disconnect(),x()});p.observe(l,c),h()}}():typeof setImmediate<"u"?t=function(l){setImmediate(l)}:typeof setTimeout<"u"?t=function(l){setTimeout(l,0)}:t=r;return qw=t,qw}var Gw,WP;function OUe(){if(WP)return Gw;WP=1;function e(r,n,a,i,s){for(var l=0;l<s;++l)a[l+i]=r[l+n],r[l+n]=void 0}function t(r){this._capacity=r,this._length=0,this._front=0}return t.prototype._willBeOverCapacity=function(r){return this._capacity<r},t.prototype._pushOne=function(r){var n=this.length();this._checkCapacity(n+1);var a=this._front+n&this._capacity-1;this[a]=r,this._length=n+1},t.prototype.push=function(r,n,a){var i=this.length()+3;if(this._willBeOverCapacity(i)){this._pushOne(r),this._pushOne(n),this._pushOne(a);return}var s=this._front+i-3;this._checkCapacity(i);var l=this._capacity-1;this[s+0&l]=r,this[s+1&l]=n,this[s+2&l]=a,this._length=i},t.prototype.shift=function(){var r=this._front,n=this[r];return this[r]=void 0,this._front=r+1&this._capacity-1,this._length--,n},t.prototype.length=function(){return this._length},t.prototype._checkCapacity=function(r){this._capacity<r&&this._resizeTo(this._capacity<<1)},t.prototype._resizeTo=function(r){var n=this._capacity;this._capacity=r;var a=this._front,i=this._length,s=a+i&n-1;e(this,0,this,n,s)},Gw=t,Gw}var zP;function FUe(){if(zP)return u0.exports;zP=1;var e;try{throw new Error}catch(c){e=c}var t=AUe(),r=OUe(),n=mr();function a(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new r(16),this._normalQueue=new r(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var c=this;this.drainQueues=function(){c._drainQueues()},this._schedule=t}a.prototype.setScheduler=function(c){var u=this._schedule;return this._schedule=c,this._customScheduler=!0,u},a.prototype.hasCustomScheduler=function(){return this._customScheduler},a.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},a.prototype.disableTrampolineIfNecessary=function(){n.hasDevTools&&(this._trampolineEnabled=!1)},a.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},a.prototype.fatalError=function(c,u){u?(process.stderr.write("Fatal "+(c instanceof Error?c.stack:c)+`
`),process.exit(2)):this.throwLater(c)},a.prototype.throwLater=function(c,u){if(arguments.length===1&&(u=c,c=function(){throw u}),typeof setTimeout<"u")setTimeout(function(){c(u)},0);else try{this._schedule(function(){c(u)})}catch{throw new Error(`No async scheduler available

    See http://goo.gl/MqrFmX
`)}};function i(c,u,d){this._lateQueue.push(c,u,d),this._queueTick()}function s(c,u,d){this._normalQueue.push(c,u,d),this._queueTick()}function l(c){this._normalQueue._pushOne(c),this._queueTick()}return n.hasDevTools?(a.prototype.invokeLater=function(c,u,d){this._trampolineEnabled?i.call(this,c,u,d):this._schedule(function(){setTimeout(function(){c.call(u,d)},100)})},a.prototype.invoke=function(c,u,d){this._trampolineEnabled?s.call(this,c,u,d):this._schedule(function(){c.call(u,d)})},a.prototype.settlePromises=function(c){this._trampolineEnabled?l.call(this,c):this._schedule(function(){c._settlePromises()})}):(a.prototype.invokeLater=i,a.prototype.invoke=s,a.prototype.settlePromises=l),a.prototype._drainQueue=function(c){for(;c.length()>0;){var u=c.shift();if(typeof u!="function"){u._settlePromises();continue}var d=c.shift(),f=c.shift();u.call(d,f)}},a.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},a.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},a.prototype._reset=function(){this._isTickUsed=!1},u0.exports=a,u0.exports.firstLineError=e,u0.exports}var Yw,HP;function Ol(){if(HP)return Yw;HP=1;var e=Of(),t=e.freeze,r=mr(),n=r.inherits,a=r.notEnumerableProp;function i(v,y){function b(w){if(!(this instanceof b))return new b(w);a(this,"message",typeof w=="string"?w:y),a(this,"name",v),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return n(b,Error),b}var s,l,c=i("Warning","warning"),u=i("CancellationError","cancellation error"),d=i("TimeoutError","timeout error"),f=i("AggregateError","aggregate error");try{s=TypeError,l=RangeError}catch{s=i("TypeError","type error"),l=i("RangeError","range error")}for(var h="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),m=0;m<h.length;++m)typeof Array.prototype[h[m]]=="function"&&(f.prototype[h[m]]=Array.prototype[h[m]]);e.defineProperty(f.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),f.prototype.isOperational=!0;var x=0;f.prototype.toString=function(){var v=Array(x*4+1).join(" "),y=`
`+v+`AggregateError of:
`;x++,v=Array(x*4+1).join(" ");for(var b=0;b<this.length;++b){for(var w=this[b]===this?"[Circular AggregateError]":this[b]+"",_=w.split(`
`),D=0;D<_.length;++D)_[D]=v+_[D];w=_.join(`
`),y+=w+`
`}return x--,y};function p(v){if(!(this instanceof p))return new p(v);a(this,"name","OperationalError"),a(this,"message",v),this.cause=v,this.isOperational=!0,v instanceof Error?(a(this,"message",v.message),a(this,"stack",v.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}n(p,Error);var g=Error.__BluebirdErrorTypes__;return g||(g=t({CancellationError:u,TimeoutError:d,OperationalError:p,RejectionError:p,AggregateError:f}),e.defineProperty(Error,"__BluebirdErrorTypes__",{value:g,writable:!1,enumerable:!1,configurable:!1})),Yw={Error,TypeError:s,RangeError:l,CancellationError:g.CancellationError,OperationalError:g.OperationalError,TimeoutError:g.TimeoutError,AggregateError:g.AggregateError,Warning:c},Yw}var Xw,VP;function PUe(){return VP||(VP=1,Xw=function(e,t){var r=mr(),n=r.errorObj,a=r.isObject;function i(f,h){if(a(f)){if(f instanceof e)return f;var m=l(f);if(m===n){h&&h._pushContext();var x=e.reject(m.e);return h&&h._popContext(),x}else if(typeof m=="function"){if(u(f)){var x=new e(t);return f._then(x._fulfill,x._reject,void 0,x,null),x}return d(f,m,h)}}return f}function s(f){return f.then}function l(f){try{return s(f)}catch(h){return n.e=h,n}}var c={}.hasOwnProperty;function u(f){try{return c.call(f,"_promise0")}catch{return!1}}function d(f,h,m){var x=new e(t),p=x;m&&m._pushContext(),x._captureStackTrace(),m&&m._popContext();var g=!0,v=r.tryCatch(h).call(f,y,b);g=!1,x&&v===n&&(x._rejectCallback(v.e,!0,!0),x=null);function y(w){x&&(x._resolveCallback(w),x=null)}function b(w){x&&(x._rejectCallback(w,g,!0),x=null)}return p}return i}),Xw}var Kw,qP;function IUe(){return qP||(qP=1,Kw=function(e,t,r,n,a){var i=mr();i.isArray;function s(c){switch(c){case-2:return[];case-3:return{}}}function l(c){var u=this._promise=new e(t);c instanceof e&&u._propagateFrom(c,3),u._setOnCancel(this),this._values=c,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return i.inherits(l,a),l.prototype.length=function(){return this._length},l.prototype.promise=function(){return this._promise},l.prototype._init=function c(u,d){var f=r(this._values,this._promise);if(f instanceof e){f=f._target();var h=f._bitField;if(this._values=f,h&50397184)if(h&33554432)f=f._value();else return h&16777216?this._reject(f._reason()):this._cancel();else return this._promise._setAsyncGuaranteed(),f._then(c,this._reject,void 0,this,d)}if(f=i.asArray(f),f===null){var m=n("expecting an array or an iterable object but got "+i.classString(f)).reason();this._promise._rejectCallback(m,!1);return}if(f.length===0){d===-5?this._resolveEmptyArray():this._resolve(s(d));return}this._iterate(f)},l.prototype._iterate=function(c){var u=this.getActualLength(c.length);this._length=u,this._values=this.shouldCopyValues()?new Array(u):this._values;for(var d=this._promise,f=!1,h=null,m=0;m<u;++m){var x=r(c[m],d);x instanceof e?(x=x._target(),h=x._bitField):h=null,f?h!==null&&x.suppressUnhandledRejections():h!==null?h&50397184?h&33554432?f=this._promiseFulfilled(x._value(),m):h&16777216?f=this._promiseRejected(x._reason(),m):f=this._promiseCancelled(m):(x._proxy(this,m),this._values[m]=x):f=this._promiseFulfilled(x,m)}f||d._setAsyncGuaranteed()},l.prototype._isResolved=function(){return this._values===null},l.prototype._resolve=function(c){this._values=null,this._promise._fulfill(c)},l.prototype._cancel=function(){this._isResolved()||!this._promise._isCancellable()||(this._values=null,this._promise._cancel())},l.prototype._reject=function(c){this._values=null,this._promise._rejectCallback(c,!1)},l.prototype._promiseFulfilled=function(c,u){this._values[u]=c;var d=++this._totalResolved;return d>=this._length?(this._resolve(this._values),!0):!1},l.prototype._promiseCancelled=function(){return this._cancel(),!0},l.prototype._promiseRejected=function(c){return this._totalResolved++,this._reject(c),!0},l.prototype._resultCancelled=function(){if(!this._isResolved()){var c=this._values;if(this._cancel(),c instanceof e)c.cancel();else for(var u=0;u<c.length;++u)c[u]instanceof e&&c[u].cancel()}},l.prototype.shouldCopyValues=function(){return!0},l.prototype.getActualLength=function(c){return c},l}),Kw}var Zw,GP;function RUe(){return GP||(GP=1,Zw=function(e){var t=!1,r=[];e.prototype._promiseCreated=function(){},e.prototype._pushContext=function(){},e.prototype._popContext=function(){return null},e._peekContext=e.prototype._peekContext=function(){};function n(){this._trace=new n.CapturedTrace(i())}n.prototype._pushContext=function(){this._trace!==void 0&&(this._trace._promiseCreated=null,r.push(this._trace))},n.prototype._popContext=function(){if(this._trace!==void 0){var s=r.pop(),l=s._promiseCreated;return s._promiseCreated=null,l}return null};function a(){if(t)return new n}function i(){var s=r.length-1;if(s>=0)return r[s]}return n.CapturedTrace=null,n.create=a,n.deactivateLongStackTraces=function(){},n.activateLongStackTraces=function(){var s=e.prototype._pushContext,l=e.prototype._popContext,c=e._peekContext,u=e.prototype._peekContext,d=e.prototype._promiseCreated;n.deactivateLongStackTraces=function(){e.prototype._pushContext=s,e.prototype._popContext=l,e._peekContext=c,e.prototype._peekContext=u,e.prototype._promiseCreated=d,t=!1},t=!0,e.prototype._pushContext=n.prototype._pushContext,e.prototype._popContext=n.prototype._popContext,e._peekContext=e.prototype._peekContext=i,e.prototype._promiseCreated=function(){var f=this._peekContext();f&&f._promiseCreated==null&&(f._promiseCreated=this)}},n}),Zw}var Jw,YP;function MUe(){return YP||(YP=1,Jw=function(e,t){var r=e._getDomain,n=e._async,a=Ol().Warning,i=mr(),s=i.canAttachTrace,l,c,u=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,d=/\((?:timers\.js):\d+:\d+\)/,f=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,h=null,m=null,x=!1,p,g=!!(i.env("BLUEBIRD_DEBUG")!=0&&(i.env("BLUEBIRD_DEBUG")||i.env("NODE_ENV")==="development")),v=!!(i.env("BLUEBIRD_WARNINGS")!=0&&(g||i.env("BLUEBIRD_WARNINGS"))),y=!!(i.env("BLUEBIRD_LONG_STACK_TRACES")!=0&&(g||i.env("BLUEBIRD_LONG_STACK_TRACES"))),b=i.env("BLUEBIRD_W_FORGOTTEN_RETURN")!=0&&(v||!!i.env("BLUEBIRD_W_FORGOTTEN_RETURN"));e.prototype.suppressUnhandledRejections=function(){var te=this._target();te._bitField=te._bitField&-1048577|524288},e.prototype._ensurePossibleRejectionHandled=function(){this._bitField&524288||(this._setRejectionIsUnhandled(),n.invokeLater(this._notifyUnhandledRejection,this,void 0))},e.prototype._notifyUnhandledRejectionIsHandled=function(){H("rejectionHandled",l,void 0,this)},e.prototype._setReturnedNonUndefined=function(){this._bitField=this._bitField|268435456},e.prototype._returnedNonUndefined=function(){return(this._bitField&268435456)!==0},e.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var te=this._settledValue();this._setUnhandledRejectionIsNotified(),H("unhandledRejection",c,te,this)}},e.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=this._bitField|262144},e.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=this._bitField&-262145},e.prototype._isUnhandledRejectionNotified=function(){return(this._bitField&262144)>0},e.prototype._setRejectionIsUnhandled=function(){this._bitField=this._bitField|1048576},e.prototype._unsetRejectionIsUnhandled=function(){this._bitField=this._bitField&-1048577,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},e.prototype._isRejectionUnhandled=function(){return(this._bitField&1048576)>0},e.prototype._warn=function(te,oe,ge){return z(te,oe,ge||this)},e.onPossiblyUnhandledRejection=function(te){var oe=r();c=typeof te=="function"?oe===null?te:i.domainBind(oe,te):void 0},e.onUnhandledRejectionHandled=function(te){var oe=r();l=typeof te=="function"?oe===null?te:i.domainBind(oe,te):void 0};var w=function(){};e.longStackTraces=function(){if(n.haveItemsQueued()&&!me.longStackTraces)throw new Error(`cannot enable long stack traces after promises have been created

    See http://goo.gl/MqrFmX
`);if(!me.longStackTraces&&le()){var te=e.prototype._captureStackTrace,oe=e.prototype._attachExtraTrace;me.longStackTraces=!0,w=function(){if(n.haveItemsQueued()&&!me.longStackTraces)throw new Error(`cannot enable long stack traces after promises have been created

    See http://goo.gl/MqrFmX
`);e.prototype._captureStackTrace=te,e.prototype._attachExtraTrace=oe,t.deactivateLongStackTraces(),n.enableTrampoline(),me.longStackTraces=!1},e.prototype._captureStackTrace=I,e.prototype._attachExtraTrace=R,t.activateLongStackTraces(),n.disableTrampolineIfNecessary()}},e.hasLongStackTraces=function(){return me.longStackTraces&&le()};var _=function(){try{if(typeof CustomEvent=="function"){var te=new CustomEvent("CustomEvent");return i.global.dispatchEvent(te),function(oe,ge){var ye=new CustomEvent(oe.toLowerCase(),{detail:ge,cancelable:!0});return!i.global.dispatchEvent(ye)}}else if(typeof Event=="function"){var te=new Event("CustomEvent");return i.global.dispatchEvent(te),function(ge,ye){var Ce=new Event(ge.toLowerCase(),{cancelable:!0});return Ce.detail=ye,!i.global.dispatchEvent(Ce)}}else{var te=document.createEvent("CustomEvent");return te.initCustomEvent("testingtheevent",!1,!0,{}),i.global.dispatchEvent(te),function(ge,ye){var Ce=document.createEvent("CustomEvent");return Ce.initCustomEvent(ge.toLowerCase(),!1,!0,ye),!i.global.dispatchEvent(Ce)}}}catch{}return function(){return!1}}(),D=function(){return i.isNode?function(){return process.emit.apply(process,arguments)}:i.global?function(te){var oe="on"+te.toLowerCase(),ge=i.global[oe];return ge?(ge.apply(i.global,[].slice.call(arguments,1)),!0):!1}:function(){return!1}}();function j(te,oe){return{promise:oe}}var N={promiseCreated:j,promiseFulfilled:j,promiseRejected:j,promiseResolved:j,promiseCancelled:j,promiseChained:function(te,oe,ge){return{promise:oe,child:ge}},warning:function(te,oe){return{warning:oe}},unhandledRejection:function(te,oe,ge){return{reason:oe,promise:ge}},rejectionHandled:j},S=function(te){var oe=!1;try{oe=D.apply(null,arguments)}catch(ye){n.throwLater(ye),oe=!0}var ge=!1;try{ge=_(te,N[te].apply(null,arguments))}catch(ye){n.throwLater(ye),ge=!0}return ge||oe};e.config=function(te){if(te=Object(te),"longStackTraces"in te&&(te.longStackTraces?e.longStackTraces():!te.longStackTraces&&e.hasLongStackTraces()&&w()),"warnings"in te){var oe=te.warnings;me.warnings=!!oe,b=me.warnings,i.isObject(oe)&&"wForgottenReturn"in oe&&(b=!!oe.wForgottenReturn)}if("cancellation"in te&&te.cancellation&&!me.cancellation){if(n.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");e.prototype._clearCancellationData=V,e.prototype._propagateFrom=W,e.prototype._onCancel=L,e.prototype._setOnCancel=O,e.prototype._attachCancellationCallback=T,e.prototype._execute=A,P=W,me.cancellation=!0}return"monitoring"in te&&(te.monitoring&&!me.monitoring?(me.monitoring=!0,e.prototype._fireEvent=S):!te.monitoring&&me.monitoring&&(me.monitoring=!1,e.prototype._fireEvent=E)),e};function E(){return!1}e.prototype._fireEvent=E,e.prototype._execute=function(te,oe,ge){try{te(oe,ge)}catch(ye){return ye}},e.prototype._onCancel=function(){},e.prototype._setOnCancel=function(te){},e.prototype._attachCancellationCallback=function(te){},e.prototype._captureStackTrace=function(){},e.prototype._attachExtraTrace=function(){},e.prototype._clearCancellationData=function(){},e.prototype._propagateFrom=function(te,oe){};function A(te,oe,ge){var ye=this;try{te(oe,ge,function(Ce){if(typeof Ce!="function")throw new TypeError("onCancel must be a function, got: "+i.toString(Ce));ye._attachCancellationCallback(Ce)})}catch(Ce){return Ce}}function T(te){if(!this._isCancellable())return this;var oe=this._onCancel();oe!==void 0?i.isArray(oe)?oe.push(te):this._setOnCancel([oe,te]):this._setOnCancel(te)}function L(){return this._onCancelField}function O(te){this._onCancelField=te}function V(){this._cancellationParent=void 0,this._onCancelField=void 0}function W(te,oe){if(oe&1){this._cancellationParent=te;var ge=te._branchesRemainingToCancel;ge===void 0&&(ge=0),te._branchesRemainingToCancel=ge+1}oe&2&&te._isBound()&&this._setBoundTo(te._boundTo)}function B(te,oe){oe&2&&te._isBound()&&this._setBoundTo(te._boundTo)}var P=B;function F(){var te=this._boundTo;return te!==void 0&&te instanceof e?te.isFulfilled()?te.value():void 0:te}function I(){this._trace=new J(this._peekContext())}function R(te,oe){if(s(te)){var ge=this._trace;if(ge!==void 0&&oe&&(ge=ge._parent),ge!==void 0)ge.attachExtraTrace(te);else if(!te.__stackCleaned__){var ye=ae(te);i.notEnumerableProp(te,"stack",ye.message+`
`+ye.stack.join(`
`)),i.notEnumerableProp(te,"__stackCleaned__",!0)}}}function C(te,oe,ge,ye,Ce){if(te===void 0&&oe!==null&&b){if(Ce!==void 0&&Ce._returnedNonUndefined()||!(ye._bitField&65535))return;ge&&(ge=ge+" ");var Ie="",rt="";if(oe._trace){for(var Pe=oe._trace.stack.split(`
`),Ke=ie(Pe),lt=Ke.length-1;lt>=0;--lt){var nt=Ke[lt];if(!d.test(nt)){var nr=nt.match(f);nr&&(Ie="at "+nr[1]+":"+nr[2]+":"+nr[3]+" ");break}}if(Ke.length>0){for(var za=Ke[0],lt=0;lt<Pe.length;++lt)if(Pe[lt]===za){lt>0&&(rt=`
`+Pe[lt-1]);break}}}var Bn="a promise was created in a "+ge+"handler "+Ie+"but was not returned from it, see http://goo.gl/rRqMUw"+rt;ye._warn(Bn,!0,oe)}}function k(te,oe){var ge=te+" is deprecated and will be removed in a future version.";return oe&&(ge+=" Use "+oe+" instead."),z(ge)}function z(te,oe,ge){if(me.warnings){var ye=new a(te),Ce;if(oe)ge._attachExtraTrace(ye);else if(me.longStackTraces&&(Ce=e._peekContext()))Ce.attachExtraTrace(ye);else{var Ie=ae(ye);ye.stack=Ie.message+`
`+Ie.stack.join(`
`)}S("warning",ye)||pe(ye,"",!0)}}function q(te,oe){for(var ge=0;ge<oe.length-1;++ge)oe[ge].push("From previous event:"),oe[ge]=oe[ge].join(`
`);return ge<oe.length&&(oe[ge]=oe[ge].join(`
`)),te+`
`+oe.join(`
`)}function K(te){for(var oe=0;oe<te.length;++oe)(te[oe].length===0||oe+1<te.length&&te[oe][0]===te[oe+1][0])&&(te.splice(oe,1),oe--)}function se(te){for(var oe=te[0],ge=1;ge<te.length;++ge){for(var ye=te[ge],Ce=oe.length-1,Ie=oe[Ce],rt=-1,Pe=ye.length-1;Pe>=0;--Pe)if(ye[Pe]===Ie){rt=Pe;break}for(var Pe=rt;Pe>=0;--Pe){var Ke=ye[Pe];if(oe[Ce]===Ke)oe.pop(),Ce--;else break}oe=ye}}function ie(te){for(var oe=[],ge=0;ge<te.length;++ge){var ye=te[ge],Ce=ye==="    (No stack trace)"||h.test(ye),Ie=Ce&&re(ye);Ce&&!Ie&&(x&&ye.charAt(0)!==" "&&(ye="    "+ye),oe.push(ye))}return oe}function ee(te){for(var oe=te.stack.replace(/\s+$/g,"").split(`
`),ge=0;ge<oe.length;++ge){var ye=oe[ge];if(ye==="    (No stack trace)"||h.test(ye))break}return ge>0&&te.name!="SyntaxError"&&(oe=oe.slice(ge)),oe}function ae(te){var oe=te.stack,ge=te.toString();return oe=typeof oe=="string"&&oe.length>0?ee(te):["    (No stack trace)"],{message:ge,stack:te.name=="SyntaxError"?oe:ie(oe)}}function pe(te,oe,ge){if(typeof console<"u"){var ye;if(i.isObject(te)){var Ce=te.stack;ye=oe+m(Ce,te)}else ye=oe+String(te);typeof p=="function"?p(ye,ge):(typeof console.log=="function"||typeof console.log=="object")&&console.log(ye)}}function H(te,oe,ge,ye){var Ce=!1;try{typeof oe=="function"&&(Ce=!0,te==="rejectionHandled"?oe(ye):oe(ge,ye))}catch(Ie){n.throwLater(Ie)}te==="unhandledRejection"?!S(te,ge,ye)&&!Ce&&pe(ge,"Unhandled rejection "):S(te,ye)}function ne(te){var oe;if(typeof te=="function")oe="[function "+(te.name||"anonymous")+"]";else{oe=te&&typeof te.toString=="function"?te.toString():i.toString(te);var ge=/\[object [a-zA-Z0-9$_]+\]/;if(ge.test(oe))try{var ye=JSON.stringify(te);oe=ye}catch{}oe.length===0&&(oe="(empty array)")}return"(<"+U(oe)+">, no stack trace)"}function U(te){var oe=41;return te.length<oe?te:te.substr(0,oe-3)+"..."}function le(){return typeof ue=="function"}var re=function(){return!1},X=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function G(te){var oe=te.match(X);if(oe)return{fileName:oe[1],line:parseInt(oe[2],10)}}function ce(te,oe){if(le()){for(var ge=te.stack.split(`
`),ye=oe.stack.split(`
`),Ce=-1,Ie=-1,rt,Pe,Ke=0;Ke<ge.length;++Ke){var lt=G(ge[Ke]);if(lt){rt=lt.fileName,Ce=lt.line;break}}for(var Ke=0;Ke<ye.length;++Ke){var lt=G(ye[Ke]);if(lt){Pe=lt.fileName,Ie=lt.line;break}}Ce<0||Ie<0||!rt||!Pe||rt!==Pe||Ce>=Ie||(re=function(nt){if(u.test(nt))return!0;var nr=G(nt);return!!(nr&&nr.fileName===rt&&Ce<=nr.line&&nr.line<=Ie)})}}function J(te){this._parent=te,this._promisesCreated=0;var oe=this._length=1+(te===void 0?0:te._length);ue(this,J),oe>32&&this.uncycle()}i.inherits(J,Error),t.CapturedTrace=J,J.prototype.uncycle=function(){var te=this._length;if(!(te<2)){for(var oe=[],ge={},ye=0,Ce=this;Ce!==void 0;++ye)oe.push(Ce),Ce=Ce._parent;te=this._length=ye;for(var ye=te-1;ye>=0;--ye){var Ie=oe[ye].stack;ge[Ie]===void 0&&(ge[Ie]=ye)}for(var ye=0;ye<te;++ye){var rt=oe[ye].stack,Pe=ge[rt];if(Pe!==void 0&&Pe!==ye){Pe>0&&(oe[Pe-1]._parent=void 0,oe[Pe-1]._length=1),oe[ye]._parent=void 0,oe[ye]._length=1;var Ke=ye>0?oe[ye-1]:this;Pe<te-1?(Ke._parent=oe[Pe+1],Ke._parent.uncycle(),Ke._length=Ke._parent._length+1):(Ke._parent=void 0,Ke._length=1);for(var lt=Ke._length+1,nt=ye-2;nt>=0;--nt)oe[nt]._length=lt,lt++;return}}}},J.prototype.attachExtraTrace=function(te){if(!te.__stackCleaned__){this.uncycle();for(var oe=ae(te),ge=oe.message,ye=[oe.stack],Ce=this;Ce!==void 0;)ye.push(ie(Ce.stack.split(`
`))),Ce=Ce._parent;se(ye),K(ye),i.notEnumerableProp(te,"stack",q(ge,ye)),i.notEnumerableProp(te,"__stackCleaned__",!0)}};var ue=function(){var oe=/^\s*at\s*/,ge=function(rt,Pe){return typeof rt=="string"?rt:Pe.name!==void 0&&Pe.message!==void 0?Pe.toString():ne(Pe)};if(typeof Error.stackTraceLimit=="number"&&typeof Error.captureStackTrace=="function"){Error.stackTraceLimit+=6,h=oe,m=ge;var ye=Error.captureStackTrace;return re=function(rt){return u.test(rt)},function(rt,Pe){Error.stackTraceLimit+=6,ye(rt,Pe),Error.stackTraceLimit-=6}}var Ce=new Error;if(typeof Ce.stack=="string"&&Ce.stack.split(`
`)[0].indexOf("stackDetection@")>=0)return h=/@/,m=ge,x=!0,function(Pe){Pe.stack=new Error().stack};var Ie;try{throw new Error}catch(rt){Ie="stack"in rt}return!("stack"in Ce)&&Ie&&typeof Error.stackTraceLimit=="number"?(h=oe,m=ge,function(Pe){Error.stackTraceLimit+=6;try{throw new Error}catch(Ke){Pe.stack=Ke.stack}Error.stackTraceLimit-=6}):(m=function(rt,Pe){return typeof rt=="string"?rt:(typeof Pe=="object"||typeof Pe=="function")&&Pe.name!==void 0&&Pe.message!==void 0?Pe.toString():ne(Pe)},null)}();typeof console<"u"&&typeof console.warn<"u"&&(p=function(te){console.warn(te)},i.isNode&&process.stderr.isTTY?p=function(te,oe){var ge=oe?"\x1B[33m":"\x1B[31m";console.warn(ge+te+`\x1B[0m
`)}:!i.isNode&&typeof new Error().stack=="string"&&(p=function(te,oe){console.warn("%c"+te,oe?"color: darkorange":"color: red")}));var me={warnings:v,longStackTraces:!1,cancellation:!1,monitoring:!1};return y&&e.longStackTraces(),{longStackTraces:function(){return me.longStackTraces},warnings:function(){return me.warnings},cancellation:function(){return me.cancellation},monitoring:function(){return me.monitoring},propagateFromFunction:function(){return P},boundValueFunction:function(){return F},checkForgottenReturns:C,setBounds:ce,warn:z,deprecated:k,CapturedTrace:J,fireDomEvent:_,fireGlobalEvent:D}}),Jw}var Qw,XP;function UUe(){return XP||(XP=1,Qw=function(e,t){var r=mr(),n=e.CancellationError,a=r.errorObj;function i(f,h,m){this.promise=f,this.type=h,this.handler=m,this.called=!1,this.cancelPromise=null}i.prototype.isFinallyHandler=function(){return this.type===0};function s(f){this.finallyHandler=f}s.prototype._resultCancelled=function(){l(this.finallyHandler)};function l(f,h){return f.cancelPromise!=null?(arguments.length>1?f.cancelPromise._reject(h):f.cancelPromise._cancel(),f.cancelPromise=null,!0):!1}function c(){return d.call(this,this.promise._target()._settledValue())}function u(f){if(!l(this,f))return a.e=f,a}function d(f){var h=this.promise,m=this.handler;if(!this.called){this.called=!0;var x=this.isFinallyHandler()?m.call(h._boundValue()):m.call(h._boundValue(),f);if(x!==void 0){h._setReturnedNonUndefined();var p=t(x,h);if(p instanceof e){if(this.cancelPromise!=null)if(p._isCancelled()){var g=new n("late cancellation observer");return h._attachExtraTrace(g),a.e=g,a}else p.isPending()&&p._attachCancellationCallback(new s(this));return p._then(c,u,void 0,this,void 0)}}}return h.isRejected()?(l(this),a.e=f,a):(l(this),f)}return e.prototype._passThrough=function(f,h,m,x){return typeof f!="function"?this.then():this._then(m,x,void 0,new i(this,h,f),void 0)},e.prototype.lastly=e.prototype.finally=function(f){return this._passThrough(f,0,d,d)},e.prototype.tap=function(f){return this._passThrough(f,1,d)},i}),Qw}var e2,KP;function $Ue(){return KP||(KP=1,e2=function(e){var t=mr(),r=Of().keys,n=t.tryCatch,a=t.errorObj;function i(s,l,c){return function(u){var d=c._boundValue();e:for(var f=0;f<s.length;++f){var h=s[f];if(h===Error||h!=null&&h.prototype instanceof Error){if(u instanceof h)return n(l).call(d,u)}else if(typeof h=="function"){var m=n(h).call(d,u);if(m===a)return m;if(m)return n(l).call(d,u)}else if(t.isObject(u)){for(var x=r(h),p=0;p<x.length;++p){var g=x[p];if(h[g]!=u[g])continue e}return n(l).call(d,u)}}return e}}return i}),e2}var t2,ZP;function AW(){if(ZP)return t2;ZP=1;var e=mr(),t=e.maybeWrapAsError,r=Ol(),n=r.OperationalError,a=Of();function i(u){return u instanceof Error&&a.getPrototypeOf(u)===Error.prototype}var s=/^(?:name|message|stack|cause)$/;function l(u){var d;if(i(u)){d=new n(u),d.name=u.name,d.message=u.message,d.stack=u.stack;for(var f=a.keys(u),h=0;h<f.length;++h){var m=f[h];s.test(m)||(d[m]=u[m])}return d}return e.markAsOriginatingFromRejection(u),u}function c(u,d){return function(f,h){if(u!==null){if(f){var m=l(t(f));u._attachExtraTrace(m),u._reject(m)}else if(!d)u._fulfill(h);else{for(var x=arguments.length,p=new Array(Math.max(x-1,0)),g=1;g<x;++g)p[g-1]=arguments[g];u._fulfill(p)}u=null}}}return t2=c,t2}var r2,JP;function LUe(){return JP||(JP=1,r2=function(e,t,r,n,a){var i=mr(),s=i.tryCatch;e.method=function(l){if(typeof l!="function")throw new e.TypeError("expecting a function but got "+i.classString(l));return function(){var c=new e(t);c._captureStackTrace(),c._pushContext();var u=s(l).apply(this,arguments),d=c._popContext();return a.checkForgottenReturns(u,d,"Promise.method",c),c._resolveFromSyncValue(u),c}},e.attempt=e.try=function(l){if(typeof l!="function")return n("expecting a function but got "+i.classString(l));var c=new e(t);c._captureStackTrace(),c._pushContext();var u;if(arguments.length>1){a.deprecated("calling Promise.try with more than 1 argument");var d=arguments[1],f=arguments[2];u=i.isArray(d)?s(l).apply(f,d):s(l).call(f,d)}else u=s(l)();var h=c._popContext();return a.checkForgottenReturns(u,h,"Promise.try",c),c._resolveFromSyncValue(u),c},e.prototype._resolveFromSyncValue=function(l){l===i.errorObj?this._rejectCallback(l.e,!1):this._resolveCallback(l,!0)}}),r2}var n2,QP;function BUe(){return QP||(QP=1,n2=function(e,t,r,n){var a=!1,i=function(u,d){this._reject(d)},s=function(u,d){d.promiseRejectionQueued=!0,d.bindingPromise._then(i,i,null,this,u)},l=function(u,d){this._bitField&50397184||this._resolveCallback(d.target)},c=function(u,d){d.promiseRejectionQueued||this._reject(u)};e.prototype.bind=function(u){a||(a=!0,e.prototype._propagateFrom=n.propagateFromFunction(),e.prototype._boundValue=n.boundValueFunction());var d=r(u),f=new e(t);f._propagateFrom(this,1);var h=this._target();if(f._setBoundTo(d),d instanceof e){var m={promiseRejectionQueued:!1,promise:f,target:h,bindingPromise:d};h._then(t,s,void 0,f,m),d._then(l,c,void 0,f,m),f._setOnCancel(d)}else f._resolveCallback(h);return f},e.prototype._setBoundTo=function(u){u!==void 0?(this._bitField=this._bitField|2097152,this._boundTo=u):this._bitField=this._bitField&-2097153},e.prototype._isBound=function(){return(this._bitField&2097152)===2097152},e.bind=function(u,d){return e.resolve(d).bind(u)}}),n2}var a2,e5;function WUe(){return e5||(e5=1,a2=function(e,t,r,n){var a=mr(),i=a.tryCatch,s=a.errorObj,l=e._async;e.prototype.break=e.prototype.cancel=function(){if(!n.cancellation())return this._warn("cancellation is disabled");for(var c=this,u=c;c._isCancellable();){if(!c._cancelBy(u)){u._isFollowing()?u._followee().cancel():u._cancelBranched();break}var d=c._cancellationParent;if(d==null||!d._isCancellable()){c._isFollowing()?c._followee().cancel():c._cancelBranched();break}else c._isFollowing()&&c._followee().cancel(),c._setWillBeCancelled(),u=c,c=d}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return this._branchesRemainingToCancel===void 0||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(c){return c===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),this._enoughBranchesHaveCancelled()?(this._invokeOnCancel(),!0):!1)},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),l.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(c,u){if(a.isArray(c))for(var d=0;d<c.length;++d)this._doInvokeOnCancel(c[d],u);else if(c!==void 0)if(typeof c=="function"){if(!u){var f=i(c).call(this._boundValue());f===s&&(this._attachExtraTrace(f.e),l.throwLater(f.e))}}else c._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var c=this._onCancel();this._unsetOnCancel(),l.invoke(this._doInvokeOnCancel,this,c)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}),a2}var i2,t5;function zUe(){return t5||(t5=1,i2=function(e){function t(){return this.value}function r(){throw this.reason}e.prototype.return=e.prototype.thenReturn=function(n){return n instanceof e&&n.suppressUnhandledRejections(),this._then(t,void 0,void 0,{value:n},void 0)},e.prototype.throw=e.prototype.thenThrow=function(n){return this._then(r,void 0,void 0,{reason:n},void 0)},e.prototype.catchThrow=function(n){if(arguments.length<=1)return this._then(void 0,r,void 0,{reason:n},void 0);var a=arguments[1],i=function(){throw a};return this.caught(n,i)},e.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof e&&n.suppressUnhandledRejections(),this._then(void 0,t,void 0,{value:n},void 0);var a=arguments[1];a instanceof e&&a.suppressUnhandledRejections();var i=function(){return a};return this.caught(n,i)}}),i2}var s2,r5;function HUe(){return r5||(r5=1,s2=function(e){function t(c){c!==void 0?(c=c._target(),this._bitField=c._bitField,this._settledValueField=c._isFateSealed()?c._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}t.prototype._settledValue=function(){return this._settledValueField};var r=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError(`cannot get fulfillment value of a non-fulfilled promise

    See http://goo.gl/MqrFmX
`);return this._settledValue()},n=t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError(`cannot get rejection reason of a non-rejected promise

    See http://goo.gl/MqrFmX
`);return this._settledValue()},a=t.prototype.isFulfilled=function(){return(this._bitField&33554432)!==0},i=t.prototype.isRejected=function(){return(this._bitField&16777216)!==0},s=t.prototype.isPending=function(){return(this._bitField&50397184)===0},l=t.prototype.isResolved=function(){return(this._bitField&50331648)!==0};t.prototype.isCancelled=function(){return(this._bitField&8454144)!==0},e.prototype.__isCancelled=function(){return(this._bitField&65536)===65536},e.prototype._isCancelled=function(){return this._target().__isCancelled()},e.prototype.isCancelled=function(){return(this._target()._bitField&8454144)!==0},e.prototype.isPending=function(){return s.call(this._target())},e.prototype.isRejected=function(){return i.call(this._target())},e.prototype.isFulfilled=function(){return a.call(this._target())},e.prototype.isResolved=function(){return l.call(this._target())},e.prototype.value=function(){return r.call(this._target())},e.prototype.reason=function(){var c=this._target();return c._unsetRejectionIsUnhandled(),n.call(c)},e.prototype._value=function(){return this._settledValue()},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},e.PromiseInspection=t}),s2}var o2,n5;function VUe(){return n5||(n5=1,o2=function(e,t,r,n,a,i){var s=mr(),l=s.canEvaluate,c=s.tryCatch,u=s.errorObj,d;if(l){for(var f=function(y){return new Function("value","holder",`                             
	            'use strict';                                                    
	            holder.pIndex = value;                                           
	            holder.checkFulfillment(this);                                   
	            `.replace(/Index/g,y))},h=function(y){return new Function("promise","holder",`                           
	            'use strict';                                                    
	            holder.pIndex = promise;                                         
	            `.replace(/Index/g,y))},m=function(y){for(var b=new Array(y),w=0;w<b.length;++w)b[w]="this.p"+(w+1);var _=b.join(" = ")+" = null;",D=`var promise;
`+b.map(function(E){return`                                                         
	                promise = `+E+`;                                      
	                if (promise instanceof Promise) {                            
	                    promise.cancel();                                        
	                }                                                            
	            `}).join(`
`),j=b.join(", "),N="Holder$"+y,S=`return function(tryCatch, errorObj, Promise, async) {    
	            'use strict';                                                    
	            function [TheName](fn) {                                         
	                [TheProperties]                                              
	                this.fn = fn;                                                
	                this.asyncNeeded = true;                                     
	                this.now = 0;                                                
	            }                                                                
	                                                                             
	            [TheName].prototype._callFunction = function(promise) {          
	                promise._pushContext();                                      
	                var ret = tryCatch(this.fn)([ThePassedArguments]);           
	                promise._popContext();                                       
	                if (ret === errorObj) {                                      
	                    promise._rejectCallback(ret.e, false);                   
	                } else {                                                     
	                    promise._resolveCallback(ret);                           
	                }                                                            
	            };                                                               
	                                                                             
	            [TheName].prototype.checkFulfillment = function(promise) {       
	                var now = ++this.now;                                        
	                if (now === [TheTotal]) {                                    
	                    if (this.asyncNeeded) {                                  
	                        async.invoke(this._callFunction, this, promise);     
	                    } else {                                                 
	                        this._callFunction(promise);                         
	                    }                                                        
	                                                                             
	                }                                                            
	            };                                                               
	                                                                             
	            [TheName].prototype._resultCancelled = function() {              
	                [CancellationCode]                                           
	            };                                                               
	                                                                             
	            return [TheName];                                                
	        }(tryCatch, errorObj, Promise, async);                               
	        `;return S=S.replace(/\[TheName\]/g,N).replace(/\[TheTotal\]/g,y).replace(/\[ThePassedArguments\]/g,j).replace(/\[TheProperties\]/g,_).replace(/\[CancellationCode\]/g,D),new Function("tryCatch","errorObj","Promise","async",S)(c,u,e,a)},x=[],p=[],g=[],v=0;v<8;++v)x.push(m(v+1)),p.push(f(v+1)),g.push(h(v+1));d=function(y){this._reject(y)}}e.join=function(){var y=arguments.length-1,b;if(y>0&&typeof arguments[y]=="function"&&(b=arguments[y],y<=8&&l)){var O=new e(n);O._captureStackTrace();for(var w=x[y-1],_=new w(b),D=p,j=0;j<y;++j){var N=r(arguments[j],O);if(N instanceof e){N=N._target();var S=N._bitField;S&50397184?S&33554432?D[j].call(O,N._value(),_):S&16777216?O._reject(N._reason()):O._cancel():(N._then(D[j],d,void 0,O,_),g[j](N,_),_.asyncNeeded=!1)}else D[j].call(O,N,_)}if(!O._isFateSealed()){if(_.asyncNeeded){var E=i();E!==null&&(_.fn=s.domainBind(E,_.fn))}O._setAsyncGuaranteed(),O._setOnCancel(_)}return O}for(var A=arguments.length,T=new Array(A),L=0;L<A;++L)T[L]=arguments[L];b&&T.pop();var O=new t(T).promise();return b!==void 0?O.spread(b):O}}),o2}var l2,a5;function qUe(){return a5||(a5=1,l2=function(e,t,r,n,a,i){var s=e._getDomain,l=mr(),c=l.tryCatch,u=l.errorObj,d=e._async;function f(m,x,p,g){this.constructor$(m),this._promise._captureStackTrace();var v=s();this._callback=v===null?x:l.domainBind(v,x),this._preservedValues=g===a?new Array(this.length()):null,this._limit=p,this._inFlight=0,this._queue=[],d.invoke(this._asyncInit,this,void 0)}l.inherits(f,t),f.prototype._asyncInit=function(){this._init$(void 0,-2)},f.prototype._init=function(){},f.prototype._promiseFulfilled=function(m,x){var p=this._values,g=this.length(),v=this._preservedValues,y=this._limit;if(x<0){if(x=x*-1-1,p[x]=m,y>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(y>=1&&this._inFlight>=y)return p[x]=m,this._queue.push(x),!1;v!==null&&(v[x]=m);var b=this._promise,w=this._callback,_=b._boundValue();b._pushContext();var D=c(w).call(_,m,x,g),j=b._popContext();if(i.checkForgottenReturns(D,j,v!==null?"Promise.filter":"Promise.map",b),D===u)return this._reject(D.e),!0;var N=n(D,this._promise);if(N instanceof e){N=N._target();var S=N._bitField;if(S&50397184)if(S&33554432)D=N._value();else return S&16777216?(this._reject(N._reason()),!0):(this._cancel(),!0);else return y>=1&&this._inFlight++,p[x]=N,N._proxy(this,(x+1)*-1),!1}p[x]=D}var E=++this._totalResolved;return E>=g?(v!==null?this._filter(p,v):this._resolve(p),!0):!1},f.prototype._drainQueue=function(){for(var m=this._queue,x=this._limit,p=this._values;m.length>0&&this._inFlight<x;){if(this._isResolved())return;var g=m.pop();this._promiseFulfilled(p[g],g)}},f.prototype._filter=function(m,x){for(var p=x.length,g=new Array(p),v=0,y=0;y<p;++y)m[y]&&(g[v++]=x[y]);g.length=v,this._resolve(g)},f.prototype.preservedValues=function(){return this._preservedValues};function h(m,x,p,g){if(typeof x!="function")return r("expecting a function but got "+l.classString(x));var v=0;if(p!==void 0)if(typeof p=="object"&&p!==null){if(typeof p.concurrency!="number")return e.reject(new TypeError("'concurrency' must be a number but it is "+l.classString(p.concurrency)));v=p.concurrency}else return e.reject(new TypeError("options argument must be an object but it is "+l.classString(p)));return v=typeof v=="number"&&isFinite(v)&&v>=1?v:0,new f(m,x,v,g).promise()}e.prototype.map=function(m,x){return h(this,m,x,null)},e.map=function(m,x,p,g){return h(m,x,p,g)}}),l2}var c2,i5;function GUe(){if(i5)return c2;i5=1;var e=Object.create;if(e){var t=e(null),r=e(null);t[" size"]=r[" size"]=0}return c2=function(n){var a=mr(),i=a.canEvaluate,s=a.isIdentifier,l,c;{var u=function(g){return new Function("ensureMethod",`                                    
	        return function(obj) {                                               
	            'use strict'                                                     
	            var len = this.length;                                           
	            ensureMethod(obj, 'methodName');                                 
	            switch(len) {                                                    
	                case 1: return obj.methodName(this[0]);                      
	                case 2: return obj.methodName(this[0], this[1]);             
	                case 3: return obj.methodName(this[0], this[1], this[2]);    
	                case 0: return obj.methodName();                             
	                default:                                                     
	                    return obj.methodName.apply(obj, this);                  
	            }                                                                
	        };                                                                   
	        `.replace(/methodName/g,g))(h)},d=function(g){return new Function("obj",`                                             
	        'use strict';                                                        
	        return obj.propertyName;                                             
	        `.replace("propertyName",g))},f=function(g,v,y){var b=y[g];if(typeof b!="function"){if(!s(g))return null;if(b=v(g),y[g]=b,y[" size"]++,y[" size"]>512){for(var w=Object.keys(y),_=0;_<256;++_)delete y[w[_]];y[" size"]=w.length-256}}return b};l=function(g){return f(g,u,t)},c=function(g){return f(g,d,r)}}function h(g,v){var y;if(g!=null&&(y=g[v]),typeof y!="function"){var b="Object "+a.classString(g)+" has no method '"+a.toString(v)+"'";throw new n.TypeError(b)}return y}function m(g){var v=this.pop(),y=h(g,v);return y.apply(g,this)}n.prototype.call=function(g){for(var v=arguments.length,y=new Array(Math.max(v-1,0)),b=1;b<v;++b)y[b-1]=arguments[b];if(i){var w=l(g);if(w!==null)return this._then(w,void 0,void 0,y,void 0)}return y.push(g),this._then(m,void 0,void 0,y,void 0)};function x(g){return g[this]}function p(g){var v=+this;return v<0&&(v=Math.max(0,v+g.length)),g[v]}n.prototype.get=function(g){var v=typeof g=="number",y;if(v)y=p;else if(i){var b=c(g);y=b!==null?b:x}else y=x;return this._then(y,void 0,void 0,g,void 0)}},c2}var u2,s5;function YUe(){return s5||(s5=1,u2=function(e,t,r,n,a,i){var s=mr(),l=Ol().TypeError,c=mr().inherits,u=s.errorObj,d=s.tryCatch,f={};function h(b){setTimeout(function(){throw b},0)}function m(b){var w=r(b);return w!==b&&typeof b._isDisposable=="function"&&typeof b._getDisposer=="function"&&b._isDisposable()&&w._setDisposable(b._getDisposer()),w}function x(b,w){var _=0,D=b.length,j=new e(a);function N(){if(_>=D)return j._fulfill();var S=m(b[_++]);if(S instanceof e&&S._isDisposable()){try{S=r(S._getDisposer().tryDispose(w),b.promise)}catch(E){return h(E)}if(S instanceof e)return S._then(N,h,null,null,null)}N()}return N(),j}function p(b,w,_){this._data=b,this._promise=w,this._context=_}p.prototype.data=function(){return this._data},p.prototype.promise=function(){return this._promise},p.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():f},p.prototype.tryDispose=function(b){var w=this.resource(),_=this._context;_!==void 0&&_._pushContext();var D=w!==f?this.doDispose(w,b):null;return _!==void 0&&_._popContext(),this._promise._unsetDisposable(),this._data=null,D},p.isDisposer=function(b){return b!=null&&typeof b.resource=="function"&&typeof b.tryDispose=="function"};function g(b,w,_){this.constructor$(b,w,_)}c(g,p),g.prototype.doDispose=function(b,w){var _=this.data();return _.call(b,b,w)};function v(b){return p.isDisposer(b)?(this.resources[this.index]._setDisposable(b),b.promise()):b}function y(b){this.length=b,this.promise=null,this[b-1]=null}y.prototype._resultCancelled=function(){for(var b=this.length,w=0;w<b;++w){var _=this[w];_ instanceof e&&_.cancel()}},e.using=function(){var b=arguments.length;if(b<2)return t("you must pass at least 2 arguments to Promise.using");var w=arguments[b-1];if(typeof w!="function")return t("expecting a function but got "+s.classString(w));var _,D=!0;b===2&&Array.isArray(arguments[0])?(_=arguments[0],b=_.length,D=!1):(_=arguments,b--);for(var j=new y(b),N=0;N<b;++N){var S=_[N];if(p.isDisposer(S)){var E=S;S=S.promise(),S._setDisposable(E)}else{var A=r(S);A instanceof e&&(S=A._then(v,null,null,{resources:j,index:N},void 0))}j[N]=S}for(var T=new Array(j.length),N=0;N<T.length;++N)T[N]=e.resolve(j[N]).reflect();var L=e.all(T).then(function(V){for(var W=0;W<V.length;++W){var B=V[W];if(B.isRejected())return u.e=B.error(),u;if(!B.isFulfilled()){L.cancel();return}V[W]=B.value()}O._pushContext(),w=d(w);var P=D?w.apply(void 0,V):w(V),F=O._popContext();return i.checkForgottenReturns(P,F,"Promise.using",O),P}),O=L.lastly(function(){var V=new e.PromiseInspection(L);return x(j,V)});return j.promise=O,O._setOnCancel(j),O},e.prototype._setDisposable=function(b){this._bitField=this._bitField|131072,this._disposer=b},e.prototype._isDisposable=function(){return(this._bitField&131072)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=this._bitField&-131073,this._disposer=void 0},e.prototype.disposer=function(b){if(typeof b=="function")return new g(b,this,n());throw new l}}),u2}var d2,o5;function XUe(){return o5||(o5=1,d2=function(e,t,r){var n=mr(),a=e.TimeoutError;function i(f){this.handle=f}i.prototype._resultCancelled=function(){clearTimeout(this.handle)};var s=function(f){return l(+this).thenReturn(f)},l=e.delay=function(f,h){var m,x;return h!==void 0?(m=e.resolve(h)._then(s,null,null,f,void 0),r.cancellation()&&h instanceof e&&m._setOnCancel(h)):(m=new e(t),x=setTimeout(function(){m._fulfill()},+f),r.cancellation()&&m._setOnCancel(new i(x)),m._captureStackTrace()),m._setAsyncGuaranteed(),m};e.prototype.delay=function(f){return l(f,this)};var c=function(f,h,m){var x;typeof h!="string"?h instanceof Error?x=h:x=new a("operation timed out"):x=new a(h),n.markAsOriginatingFromRejection(x),f._attachExtraTrace(x),f._reject(x),m!=null&&m.cancel()};function u(f){return clearTimeout(this.handle),f}function d(f){throw clearTimeout(this.handle),f}e.prototype.timeout=function(f,h){f=+f;var m,x,p=new i(setTimeout(function(){m.isPending()&&c(m,h,x)},f));return r.cancellation()?(x=this.then(),m=x._then(u,d,void 0,p,void 0),m._setOnCancel(p)):m=this._then(u,d,void 0,p,void 0),m}}),d2}var f2,l5;function KUe(){return l5||(l5=1,f2=function(e,t,r,n,a,i){var s=Ol(),l=s.TypeError,c=mr(),u=c.errorObj,d=c.tryCatch,f=[];function h(x,p,g){for(var v=0;v<p.length;++v){g._pushContext();var y=d(p[v])(x);if(g._popContext(),y===u){g._pushContext();var b=e.reject(u.e);return g._popContext(),b}var w=n(y,g);if(w instanceof e)return w}return null}function m(x,p,g,v){if(i.cancellation()){var y=new e(r),b=this._finallyPromise=new e(r);this._promise=y.lastly(function(){return b}),y._captureStackTrace(),y._setOnCancel(this)}else{var w=this._promise=new e(r);w._captureStackTrace()}this._stack=v,this._generatorFunction=x,this._receiver=p,this._generator=void 0,this._yieldHandlers=typeof g=="function"?[g].concat(f):f,this._yieldedPromise=null,this._cancellationPhase=!1}c.inherits(m,a),m.prototype._isResolved=function(){return this._promise===null},m.prototype._cleanup=function(){this._promise=this._generator=null,i.cancellation()&&this._finallyPromise!==null&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},m.prototype._promiseCancelled=function(){if(!this._isResolved()){var x=typeof this._generator.return<"u",p;if(x)this._promise._pushContext(),p=d(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var g=new e.CancellationError("generator .return() sentinel");e.coroutine.returnSentinel=g,this._promise._attachExtraTrace(g),this._promise._pushContext(),p=d(this._generator.throw).call(this._generator,g),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(p)}},m.prototype._promiseFulfilled=function(x){this._yieldedPromise=null,this._promise._pushContext();var p=d(this._generator.next).call(this._generator,x);this._promise._popContext(),this._continue(p)},m.prototype._promiseRejected=function(x){this._yieldedPromise=null,this._promise._attachExtraTrace(x),this._promise._pushContext();var p=d(this._generator.throw).call(this._generator,x);this._promise._popContext(),this._continue(p)},m.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var x=this._yieldedPromise;this._yieldedPromise=null,x.cancel()}},m.prototype.promise=function(){return this._promise},m.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},m.prototype._continue=function(x){var p=this._promise;if(x===u)return this._cleanup(),this._cancellationPhase?p.cancel():p._rejectCallback(x.e,!1);var g=x.value;if(x.done===!0)return this._cleanup(),this._cancellationPhase?p.cancel():p._resolveCallback(g);var v=n(g,this._promise);if(!(v instanceof e)&&(v=h(v,this._yieldHandlers,this._promise),v===null)){this._promiseRejected(new l(`A value %s was yielded that could not be treated as a promise

    See http://goo.gl/MqrFmX

`.replace("%s",g)+`From coroutine:
`+this._stack.split(`
`).slice(1,-7).join(`
`)));return}v=v._target();var y=v._bitField;y&50397184?y&33554432?e._async.invoke(this._promiseFulfilled,this,v._value()):y&16777216?e._async.invoke(this._promiseRejected,this,v._reason()):this._promiseCancelled():(this._yieldedPromise=v,v._proxy(this,null))},e.coroutine=function(x,p){if(typeof x!="function")throw new l(`generatorFunction must be a function

    See http://goo.gl/MqrFmX
`);var g=Object(p).yieldHandler,v=m,y=new Error().stack;return function(){var b=x.apply(this,arguments),w=new v(void 0,void 0,g,y),_=w.promise();return w._generator=b,w._promiseFulfilled(void 0),_}},e.coroutine.addYieldHandler=function(x){if(typeof x!="function")throw new l("expecting a function but got "+c.classString(x));f.push(x)},e.spawn=function(x){if(i.deprecated("Promise.spawn()","Promise.coroutine()"),typeof x!="function")return t(`generatorFunction must be a function

    See http://goo.gl/MqrFmX
`);var p=new m(x,this),g=p.promise();return p._run(e.spawn),g}}),f2}var h2,c5;function ZUe(){return c5||(c5=1,h2=function(e){var t=mr(),r=e._async,n=t.tryCatch,a=t.errorObj;function i(c,u){var d=this;if(!t.isArray(c))return s.call(d,c,u);var f=n(u).apply(d._boundValue(),[null].concat(c));f===a&&r.throwLater(f.e)}function s(c,u){var d=this,f=d._boundValue(),h=c===void 0?n(u).call(f,null):n(u).call(f,null,c);h===a&&r.throwLater(h.e)}function l(c,u){var d=this;if(!c){var f=new Error(c+"");f.cause=c,c=f}var h=n(u).call(d._boundValue(),c);h===a&&r.throwLater(h.e)}e.prototype.asCallback=e.prototype.nodeify=function(c,u){if(typeof c=="function"){var d=s;u!==void 0&&Object(u).spread&&(d=i),this._then(d,l,void 0,this,c)}return this}}),h2}var m2,u5;function JUe(){return u5||(u5=1,m2=function(e,t){var r={},n=mr(),a=AW(),i=n.withAppended,s=n.maybeWrapAsError,l=n.canEvaluate,c=Ol().TypeError,u="Async",d={__isPromisified__:!0},f=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],h=new RegExp("^(?:"+f.join("|")+")$"),m=function(L){return n.isIdentifier(L)&&L.charAt(0)!=="_"&&L!=="constructor"};function x(L){return!h.test(L)}function p(L){try{return L.__isPromisified__===!0}catch{return!1}}function g(L,O,V){var W=n.getDataPropertyOrDefault(L,O+V,d);return W?p(W):!1}function v(L,O,V){for(var W=0;W<L.length;W+=2){var B=L[W];if(V.test(B)){for(var P=B.replace(V,""),F=0;F<L.length;F+=2)if(L[F]===P)throw new c(`Cannot promisify an API that has normal methods with '%s'-suffix

    See http://goo.gl/MqrFmX
`.replace("%s",O))}}}function y(L,O,V,W){for(var B=n.inheritedDataKeys(L),P=[],F=0;F<B.length;++F){var I=B[F],R=L[I],C=W===m?!0:m(I);typeof R=="function"&&!p(R)&&!g(L,I,O)&&W(I,R,L,C)&&P.push(I,R)}return v(P,O,V),P}var b=function(L){return L.replace(/([$])/,"\\$")},w;{var _=function(L){for(var O=[L],V=Math.max(0,L-1-3),W=L-1;W>=V;--W)O.push(W);for(var W=L+1;W<=3;++W)O.push(W);return O},D=function(L){return n.filledRange(L,"_arg","")},j=function(L){return n.filledRange(Math.max(L,3),"_arg","")},N=function(L){return typeof L.length=="number"?Math.max(Math.min(L.length,1024),0):0};w=function(L,O,V,W,B,P){var F=Math.max(0,N(W)-1),I=_(F),R=typeof L=="string"||O===r;function C(K){var se=D(K).join(", "),ie=K>0?", ":"",ee;return R?ee=`ret = callback.call(this, {{args}}, nodeback); break;
`:ee=O===void 0?`ret = callback({{args}}, nodeback); break;
`:`ret = callback.call(receiver, {{args}}, nodeback); break;
`,ee.replace("{{args}}",se).replace(", ",ie)}function k(){for(var K="",se=0;se<I.length;++se)K+="case "+I[se]+":"+C(I[se]);return K+=`                                                             
	        default:                                                             
	            var args = new Array(len + 1);                                   
	            var i = 0;                                                       
	            for (var i = 0; i < len; ++i) {                                  
	               args[i] = arguments[i];                                       
	            }                                                                
	            args[i] = nodeback;                                              
	            [CodeForCall]                                                    
	            break;                                                           
	        `.replace("[CodeForCall]",R?`ret = callback.apply(this, args);
`:`ret = callback.apply(receiver, args);
`),K}var z=typeof L=="string"?"this != null ? this['"+L+"'] : fn":"fn",q=`'use strict';                                                
	        var ret = function (Parameters) {                                    
	            'use strict';                                                    
	            var len = arguments.length;                                      
	            var promise = new Promise(INTERNAL);                             
	            promise._captureStackTrace();                                    
	            var nodeback = nodebackForPromise(promise, `+P+`);   
	            var ret;                                                         
	            var callback = tryCatch([GetFunctionCode]);                      
	            switch(len) {                                                    
	                [CodeForSwitchCase]                                          
	            }                                                                
	            if (ret === errorObj) {                                          
	                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);
	            }                                                                
	            if (!promise._isFateSealed()) promise._setAsyncGuaranteed();     
	            return promise;                                                  
	        };                                                                   
	        notEnumerableProp(ret, '__isPromisified__', true);                   
	        return ret;                                                          
	    `.replace("[CodeForSwitchCase]",k()).replace("[GetFunctionCode]",z);return q=q.replace("Parameters",j(F)),new Function("Promise","fn","receiver","withAppended","maybeWrapAsError","nodebackForPromise","tryCatch","errorObj","notEnumerableProp","INTERNAL",q)(e,W,O,i,s,a,n.tryCatch,n.errorObj,n.notEnumerableProp,t)}}function S(L,O,V,W,B,P){var F=function(){return this}(),I=L;typeof I=="string"&&(L=W);function R(){var C=O;O===r&&(C=this);var k=new e(t);k._captureStackTrace();var z=typeof I=="string"&&this!==F?this[I]:L,q=a(k,P);try{z.apply(C,i(arguments,q))}catch(K){k._rejectCallback(s(K),!0,!0)}return k._isFateSealed()||k._setAsyncGuaranteed(),k}return n.notEnumerableProp(R,"__isPromisified__",!0),R}var E=l?w:S;function A(L,O,V,W,B){for(var P=new RegExp(b(O)+"$"),F=y(L,O,P,V),I=0,R=F.length;I<R;I+=2){var C=F[I],k=F[I+1],z=C+O;if(W===E)L[z]=E(C,r,C,k,O,B);else{var q=W(k,function(){return E(C,r,C,k,O,B)});n.notEnumerableProp(q,"__isPromisified__",!0),L[z]=q}}return n.toFastProperties(L),L}function T(L,O,V){return E(L,O,void 0,L,null,V)}e.promisify=function(L,O){if(typeof L!="function")throw new c("expecting a function but got "+n.classString(L));if(p(L))return L;O=Object(O);var V=O.context===void 0?r:O.context,W=!!O.multiArgs,B=T(L,V,W);return n.copyDescriptors(L,B,x),B},e.promisifyAll=function(L,O){if(typeof L!="function"&&typeof L!="object")throw new c(`the target of promisifyAll must be an object or a function

    See http://goo.gl/MqrFmX
`);O=Object(O);var V=!!O.multiArgs,W=O.suffix;typeof W!="string"&&(W=u);var B=O.filter;typeof B!="function"&&(B=m);var P=O.promisifier;if(typeof P!="function"&&(P=E),!n.isIdentifier(W))throw new RangeError(`suffix must be a valid identifier

    See http://goo.gl/MqrFmX
`);for(var F=n.inheritedDataKeys(L),I=0;I<F.length;++I){var R=L[F[I]];F[I]!=="constructor"&&n.isClass(R)&&(A(R.prototype,W,B,P,V),A(R,W,B,P,V))}return A(L,W,B,P,V)}}),m2}var p2,d5;function QUe(){return d5||(d5=1,p2=function(e,t,r,n){var a=mr(),i=a.isObject,s=Of(),l;typeof Map=="function"&&(l=Map);var c=function(){var h=0,m=0;function x(p,g){this[h]=p,this[h+m]=g,h++}return function(g){m=g.size,h=0;var v=new Array(g.size*2);return g.forEach(x,v),v}}(),u=function(h){for(var m=new l,x=h.length/2|0,p=0;p<x;++p){var g=h[x+p],v=h[p];m.set(g,v)}return m};function d(h){var m=!1,x;if(l!==void 0&&h instanceof l)x=c(h),m=!0;else{var p=s.keys(h),g=p.length;x=new Array(g*2);for(var v=0;v<g;++v){var y=p[v];x[v]=h[y],x[v+g]=y}}this.constructor$(x),this._isMap=m,this._init$(void 0,-3)}a.inherits(d,t),d.prototype._init=function(){},d.prototype._promiseFulfilled=function(h,m){this._values[m]=h;var x=++this._totalResolved;if(x>=this._length){var p;if(this._isMap)p=u(this._values);else{p={};for(var g=this.length(),v=0,y=this.length();v<y;++v)p[this._values[v+g]]=this._values[v]}return this._resolve(p),!0}return!1},d.prototype.shouldCopyValues=function(){return!1},d.prototype.getActualLength=function(h){return h>>1};function f(h){var m,x=r(h);if(i(x))x instanceof e?m=x._then(e.props,void 0,void 0,void 0,void 0):m=new d(x).promise();else return n(`cannot await properties of a non-object

    See http://goo.gl/MqrFmX
`);return x instanceof e&&m._propagateFrom(x,2),m}e.prototype.props=function(){return f(this)},e.props=function(h){return f(h)}}),p2}var x2,f5;function e$e(){return f5||(f5=1,x2=function(e,t,r,n){var a=mr(),i=function(l){return l.then(function(c){return s(c,l)})};function s(l,c){var u=r(l);if(u instanceof e)return i(u);if(l=a.asArray(l),l===null)return n("expecting an array or an iterable object but got "+a.classString(l));var d=new e(t);c!==void 0&&d._propagateFrom(c,3);for(var f=d._fulfill,h=d._reject,m=0,x=l.length;m<x;++m){var p=l[m];p===void 0&&!(m in l)||e.cast(p)._then(f,h,void 0,d,null)}return d}e.race=function(l){return s(l,void 0)},e.prototype.race=function(){return s(this,void 0)}}),x2}var g2,h5;function t$e(){return h5||(h5=1,g2=function(e,t,r,n,a,i){var s=e._getDomain,l=mr(),c=l.tryCatch;function u(x,p,g,v){this.constructor$(x);var y=s();this._fn=y===null?p:l.domainBind(y,p),g!==void 0&&(g=e.resolve(g),g._attachCancellationCallback(this)),this._initialValue=g,this._currentCancellable=null,v===a?this._eachValues=Array(this._length):v===0?this._eachValues=null:this._eachValues=void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}l.inherits(u,t),u.prototype._gotAccum=function(x){this._eachValues!==void 0&&this._eachValues!==null&&x!==a&&this._eachValues.push(x)},u.prototype._eachComplete=function(x){return this._eachValues!==null&&this._eachValues.push(x),this._eachValues},u.prototype._init=function(){},u.prototype._resolveEmptyArray=function(){this._resolve(this._eachValues!==void 0?this._eachValues:this._initialValue)},u.prototype.shouldCopyValues=function(){return!1},u.prototype._resolve=function(x){this._promise._resolveCallback(x),this._values=null},u.prototype._resultCancelled=function(x){if(x===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof e&&this._currentCancellable.cancel(),this._initialValue instanceof e&&this._initialValue.cancel())},u.prototype._iterate=function(x){this._values=x;var p,g,v=x.length;if(this._initialValue!==void 0?(p=this._initialValue,g=0):(p=e.resolve(x[0]),g=1),this._currentCancellable=p,!p.isRejected())for(;g<v;++g){var y={accum:null,value:x[g],index:g,length:v,array:this};p=p._then(h,void 0,void 0,y,void 0)}this._eachValues!==void 0&&(p=p._then(this._eachComplete,void 0,void 0,this,void 0)),p._then(d,d,void 0,p,this)},e.prototype.reduce=function(x,p){return f(this,x,p,null)},e.reduce=function(x,p,g,v){return f(x,p,g,v)};function d(x,p){this.isFulfilled()?p._resolve(x):p._reject(x)}function f(x,p,g,v){if(typeof p!="function")return r("expecting a function but got "+l.classString(p));var y=new u(x,p,g,v);return y.promise()}function h(x){this.accum=x,this.array._gotAccum(x);var p=n(this.value,this.array._promise);return p instanceof e?(this.array._currentCancellable=p,p._then(m,void 0,void 0,this,void 0)):m.call(this,p)}function m(x){var p=this.array,g=p._promise,v=c(p._fn);g._pushContext();var y;p._eachValues!==void 0?y=v.call(g._boundValue(),x,this.index,this.length):y=v.call(g._boundValue(),this.accum,x,this.index,this.length),y instanceof e&&(p._currentCancellable=y);var b=g._popContext();return i.checkForgottenReturns(y,b,p._eachValues!==void 0?"Promise.each":"Promise.reduce",g),y}}),g2}var v2,m5;function r$e(){return m5||(m5=1,v2=function(e,t,r){var n=e.PromiseInspection,a=mr();function i(s){this.constructor$(s)}a.inherits(i,t),i.prototype._promiseResolved=function(s,l){this._values[s]=l;var c=++this._totalResolved;return c>=this._length?(this._resolve(this._values),!0):!1},i.prototype._promiseFulfilled=function(s,l){var c=new n;return c._bitField=33554432,c._settledValueField=s,this._promiseResolved(l,c)},i.prototype._promiseRejected=function(s,l){var c=new n;return c._bitField=16777216,c._settledValueField=s,this._promiseResolved(l,c)},e.settle=function(s){return r.deprecated(".settle()",".reflect()"),new i(s).promise()},e.prototype.settle=function(){return e.settle(this)}}),v2}var y2,p5;function n$e(){return p5||(p5=1,y2=function(e,t,r){var n=mr(),a=Ol().RangeError,i=Ol().AggregateError,s=n.isArray,l={};function c(d){this.constructor$(d),this._howMany=0,this._unwrap=!1,this._initialized=!1}n.inherits(c,t),c.prototype._init=function(){if(this._initialized){if(this._howMany===0){this._resolve([]);return}this._init$(void 0,-5);var d=s(this._values);!this._isResolved()&&d&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},c.prototype.init=function(){this._initialized=!0,this._init()},c.prototype.setUnwrap=function(){this._unwrap=!0},c.prototype.howMany=function(){return this._howMany},c.prototype.setHowMany=function(d){this._howMany=d},c.prototype._promiseFulfilled=function(d){return this._addFulfilled(d),this._fulfilled()===this.howMany()?(this._values.length=this.howMany(),this.howMany()===1&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0):!1},c.prototype._promiseRejected=function(d){return this._addRejected(d),this._checkOutcome()},c.prototype._promiseCancelled=function(){return this._values instanceof e||this._values==null?this._cancel():(this._addRejected(l),this._checkOutcome())},c.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var d=new i,f=this.length();f<this._values.length;++f)this._values[f]!==l&&d.push(this._values[f]);return d.length>0?this._reject(d):this._cancel(),!0}return!1},c.prototype._fulfilled=function(){return this._totalResolved},c.prototype._rejected=function(){return this._values.length-this.length()},c.prototype._addRejected=function(d){this._values.push(d)},c.prototype._addFulfilled=function(d){this._values[this._totalResolved++]=d},c.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},c.prototype._getRangeError=function(d){var f="Input array must contain at least "+this._howMany+" items but contains only "+d+" items";return new a(f)},c.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))};function u(d,f){if((f|0)!==f||f<0)return r(`expecting a positive integer

    See http://goo.gl/MqrFmX
`);var h=new c(d),m=h.promise();return h.setHowMany(f),h.init(),m}e.some=function(d,f){return u(d,f)},e.prototype.some=function(d){return u(this,d)},e._SomePromiseArray=c}),y2}var b2,x5;function a$e(){return x5||(x5=1,b2=function(e,t){var r=e.map;e.prototype.filter=function(n,a){return r(this,n,a,t)},e.filter=function(n,a,i){return r(n,a,i,t)}}),b2}var w2,g5;function i$e(){return g5||(g5=1,w2=function(e,t){var r=e.reduce,n=e.all;function a(){return n(this)}function i(s,l){return r(s,l,t,t)}e.prototype.each=function(s){return r(this,s,t,0)._then(a,void 0,void 0,this,void 0)},e.prototype.mapSeries=function(s){return r(this,s,t,t)},e.each=function(s,l){return r(s,l,t,0)._then(a,void 0,void 0,s,void 0)},e.mapSeries=i}),w2}var _2,v5;function s$e(){return v5||(v5=1,_2=function(e){var t=e._SomePromiseArray;function r(n){var a=new t(n),i=a.promise();return a.setHowMany(1),a.setUnwrap(),a.init(),i}e.any=function(n){return r(n)},e.prototype.any=function(){return r(this)}}),_2}(function(e){e.exports=function(){var t=function(){return new h(`circular promise resolution chain

    See http://goo.gl/MqrFmX
`)},r=function(){return new T.PromiseInspection(this._target())},n=function(W){return T.reject(new h(W))};function a(){}var i={},s=mr(),l;s.isNode?l=function(){var W=process.domain;return W===void 0&&(W=null),W}:l=function(){return null},s.notEnumerableProp(T,"_getDomain",l);var c=Of(),u=FUe(),d=new u;c.defineProperty(T,"_async",{value:d});var f=Ol(),h=T.TypeError=f.TypeError;T.RangeError=f.RangeError;var m=T.CancellationError=f.CancellationError;T.TimeoutError=f.TimeoutError,T.OperationalError=f.OperationalError,T.RejectionError=f.OperationalError,T.AggregateError=f.AggregateError;var x=function(){},p={},g={},v=PUe()(T,x),y=IUe()(T,x,v,n,a),b=RUe()(T),w=b.create,_=MUe()(T,b);_.CapturedTrace;var D=UUe()(T,v),j=$Ue()(g),N=AW(),S=s.errorObj,E=s.tryCatch;function A(W,B){if(typeof B!="function")throw new h("expecting a function but got "+s.classString(B));if(W.constructor!==T)throw new h(`the promise constructor cannot be invoked directly

    See http://goo.gl/MqrFmX
`)}function T(W){this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,W!==x&&(A(this,W),this._resolveFromExecutor(W)),this._promiseCreated(),this._fireEvent("promiseCreated",this)}T.prototype.toString=function(){return"[object Promise]"},T.prototype.caught=T.prototype.catch=function(W){var B=arguments.length;if(B>1){var P=new Array(B-1),F=0,I;for(I=0;I<B-1;++I){var R=arguments[I];if(s.isObject(R))P[F++]=R;else return n("expecting an object but got A catch statement predicate "+s.classString(R))}return P.length=F,W=arguments[I],this.then(void 0,j(P,W,this))}return this.then(void 0,W)},T.prototype.reflect=function(){return this._then(r,r,void 0,this,void 0)},T.prototype.then=function(W,B){if(_.warnings()&&arguments.length>0&&typeof W!="function"&&typeof B!="function"){var P=".then() only accepts functions but was passed: "+s.classString(W);arguments.length>1&&(P+=", "+s.classString(B)),this._warn(P)}return this._then(W,B,void 0,void 0,void 0)},T.prototype.done=function(W,B){var P=this._then(W,B,void 0,void 0,void 0);P._setIsFinal()},T.prototype.spread=function(W){return typeof W!="function"?n("expecting a function but got "+s.classString(W)):this.all()._then(W,void 0,void 0,p,void 0)},T.prototype.toJSON=function(){var W={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(W.fulfillmentValue=this.value(),W.isFulfilled=!0):this.isRejected()&&(W.rejectionReason=this.reason(),W.isRejected=!0),W},T.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new y(this).promise()},T.prototype.error=function(W){return this.caught(s.originatesFromRejection,W)},T.getNewLibraryCopy=e.exports,T.is=function(W){return W instanceof T},T.fromNode=T.fromCallback=function(W){var B=new T(x);B._captureStackTrace();var P=arguments.length>1?!!Object(arguments[1]).multiArgs:!1,F=E(W)(N(B,P));return F===S&&B._rejectCallback(F.e,!0),B._isFateSealed()||B._setAsyncGuaranteed(),B},T.all=function(W){return new y(W).promise()},T.cast=function(W){var B=v(W);return B instanceof T||(B=new T(x),B._captureStackTrace(),B._setFulfilled(),B._rejectionHandler0=W),B},T.resolve=T.fulfilled=T.cast,T.reject=T.rejected=function(W){var B=new T(x);return B._captureStackTrace(),B._rejectCallback(W,!0),B},T.setScheduler=function(W){if(typeof W!="function")throw new h("expecting a function but got "+s.classString(W));return d.setScheduler(W)},T.prototype._then=function(W,B,P,F,I){var R=I!==void 0,C=R?I:new T(x),k=this._target(),z=k._bitField;R||(C._propagateFrom(this,3),C._captureStackTrace(),F===void 0&&this._bitField&2097152&&(z&50397184?F=this._boundValue():F=k===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,C));var q=l();if(z&50397184){var K,se,ie=k._settlePromiseCtx;z&33554432?(se=k._rejectionHandler0,K=W):z&16777216?(se=k._fulfillmentHandler0,K=B,k._unsetRejectionIsUnhandled()):(ie=k._settlePromiseLateCancellationObserver,se=new m("late cancellation observer"),k._attachExtraTrace(se),K=B),d.invoke(ie,k,{handler:q===null?K:typeof K=="function"&&s.domainBind(q,K),promise:C,receiver:F,value:se})}else k._addCallbacks(W,B,C,F,q);return C},T.prototype._length=function(){return this._bitField&65535},T.prototype._isFateSealed=function(){return(this._bitField&117506048)!==0},T.prototype._isFollowing=function(){return(this._bitField&67108864)===67108864},T.prototype._setLength=function(W){this._bitField=this._bitField&-65536|W&65535},T.prototype._setFulfilled=function(){this._bitField=this._bitField|33554432,this._fireEvent("promiseFulfilled",this)},T.prototype._setRejected=function(){this._bitField=this._bitField|16777216,this._fireEvent("promiseRejected",this)},T.prototype._setFollowing=function(){this._bitField=this._bitField|67108864,this._fireEvent("promiseResolved",this)},T.prototype._setIsFinal=function(){this._bitField=this._bitField|4194304},T.prototype._isFinal=function(){return(this._bitField&4194304)>0},T.prototype._unsetCancelled=function(){this._bitField=this._bitField&-65537},T.prototype._setCancelled=function(){this._bitField=this._bitField|65536,this._fireEvent("promiseCancelled",this)},T.prototype._setWillBeCancelled=function(){this._bitField=this._bitField|8388608},T.prototype._setAsyncGuaranteed=function(){d.hasCustomScheduler()||(this._bitField=this._bitField|134217728)},T.prototype._receiverAt=function(W){var B=W===0?this._receiver0:this[W*4-4+3];if(B!==i)return B===void 0&&this._isBound()?this._boundValue():B},T.prototype._promiseAt=function(W){return this[W*4-4+2]},T.prototype._fulfillmentHandlerAt=function(W){return this[W*4-4+0]},T.prototype._rejectionHandlerAt=function(W){return this[W*4-4+1]},T.prototype._boundValue=function(){},T.prototype._migrateCallback0=function(W){W._bitField;var B=W._fulfillmentHandler0,P=W._rejectionHandler0,F=W._promise0,I=W._receiverAt(0);I===void 0&&(I=i),this._addCallbacks(B,P,F,I,null)},T.prototype._migrateCallbackAt=function(W,B){var P=W._fulfillmentHandlerAt(B),F=W._rejectionHandlerAt(B),I=W._promiseAt(B),R=W._receiverAt(B);R===void 0&&(R=i),this._addCallbacks(P,F,I,R,null)},T.prototype._addCallbacks=function(W,B,P,F,I){var R=this._length();if(R>=65531&&(R=0,this._setLength(0)),R===0)this._promise0=P,this._receiver0=F,typeof W=="function"&&(this._fulfillmentHandler0=I===null?W:s.domainBind(I,W)),typeof B=="function"&&(this._rejectionHandler0=I===null?B:s.domainBind(I,B));else{var C=R*4-4;this[C+2]=P,this[C+3]=F,typeof W=="function"&&(this[C+0]=I===null?W:s.domainBind(I,W)),typeof B=="function"&&(this[C+1]=I===null?B:s.domainBind(I,B))}return this._setLength(R+1),R},T.prototype._proxy=function(W,B){this._addCallbacks(void 0,void 0,B,W,null)},T.prototype._resolveCallback=function(W,B){if(!(this._bitField&117506048)){if(W===this)return this._rejectCallback(t(),!1);var P=v(W,this);if(!(P instanceof T))return this._fulfill(W);B&&this._propagateFrom(P,2);var F=P._target();if(F===this){this._reject(t());return}var I=F._bitField;if(I&50397184)if(I&33554432)this._fulfill(F._value());else if(I&16777216)this._reject(F._reason());else{var k=new m("late cancellation observer");F._attachExtraTrace(k),this._reject(k)}else{var R=this._length();R>0&&F._migrateCallback0(this);for(var C=1;C<R;++C)F._migrateCallbackAt(this,C);this._setFollowing(),this._setLength(0),this._setFollowee(F)}}},T.prototype._rejectCallback=function(W,B,P){var F=s.ensureErrorObject(W),I=F===W;if(!I&&!P&&_.warnings()){var R="a promise was rejected with a non-error: "+s.classString(W);this._warn(R,!0)}this._attachExtraTrace(F,B?I:!1),this._reject(W)},T.prototype._resolveFromExecutor=function(W){var B=this;this._captureStackTrace(),this._pushContext();var P=!0,F=this._execute(W,function(I){B._resolveCallback(I)},function(I){B._rejectCallback(I,P)});P=!1,this._popContext(),F!==void 0&&B._rejectCallback(F,!0)},T.prototype._settlePromiseFromHandler=function(W,B,P,F){var I=F._bitField;if(!(I&65536)){F._pushContext();var R;B===p?!P||typeof P.length!="number"?(R=S,R.e=new h("cannot .spread() a non-array: "+s.classString(P))):R=E(W).apply(this._boundValue(),P):R=E(W).call(B,P);var C=F._popContext();I=F._bitField,!(I&65536)&&(R===g?F._reject(P):R===S?F._rejectCallback(R.e,!1):(_.checkForgottenReturns(R,C,"",F,this),F._resolveCallback(R)))}},T.prototype._target=function(){for(var W=this;W._isFollowing();)W=W._followee();return W},T.prototype._followee=function(){return this._rejectionHandler0},T.prototype._setFollowee=function(W){this._rejectionHandler0=W},T.prototype._settlePromise=function(W,B,P,F){var I=W instanceof T,R=this._bitField,C=(R&134217728)!==0;R&65536?(I&&W._invokeInternalOnCancel(),P instanceof D&&P.isFinallyHandler()?(P.cancelPromise=W,E(B).call(P,F)===S&&W._reject(S.e)):B===r?W._fulfill(r.call(P)):P instanceof a?P._promiseCancelled(W):I||W instanceof y?W._cancel():P.cancel()):typeof B=="function"?I?(C&&W._setAsyncGuaranteed(),this._settlePromiseFromHandler(B,P,F,W)):B.call(P,F,W):P instanceof a?P._isResolved()||(R&33554432?P._promiseFulfilled(F,W):P._promiseRejected(F,W)):I&&(C&&W._setAsyncGuaranteed(),R&33554432?W._fulfill(F):W._reject(F))},T.prototype._settlePromiseLateCancellationObserver=function(W){var B=W.handler,P=W.promise,F=W.receiver,I=W.value;typeof B=="function"?P instanceof T?this._settlePromiseFromHandler(B,F,I,P):B.call(F,I,P):P instanceof T&&P._reject(I)},T.prototype._settlePromiseCtx=function(W){this._settlePromise(W.promise,W.handler,W.receiver,W.value)},T.prototype._settlePromise0=function(W,B,P){var F=this._promise0,I=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(F,W,I,B)},T.prototype._clearCallbackDataAtIndex=function(W){var B=W*4-4;this[B+2]=this[B+3]=this[B+0]=this[B+1]=void 0},T.prototype._fulfill=function(W){var B=this._bitField;if(!((B&117506048)>>>16)){if(W===this){var P=t();return this._attachExtraTrace(P),this._reject(P)}this._setFulfilled(),this._rejectionHandler0=W,(B&65535)>0&&(B&134217728?this._settlePromises():d.settlePromises(this))}},T.prototype._reject=function(W){var B=this._bitField;if(!((B&117506048)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=W,this._isFinal())return d.fatalError(W,s.isNode);(B&65535)>0?d.settlePromises(this):this._ensurePossibleRejectionHandled()}},T.prototype._fulfillPromises=function(W,B){for(var P=1;P<W;P++){var F=this._fulfillmentHandlerAt(P),I=this._promiseAt(P),R=this._receiverAt(P);this._clearCallbackDataAtIndex(P),this._settlePromise(I,F,R,B)}},T.prototype._rejectPromises=function(W,B){for(var P=1;P<W;P++){var F=this._rejectionHandlerAt(P),I=this._promiseAt(P),R=this._receiverAt(P);this._clearCallbackDataAtIndex(P),this._settlePromise(I,F,R,B)}},T.prototype._settlePromises=function(){var W=this._bitField,B=W&65535;if(B>0){if(W&16842752){var P=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,P,W),this._rejectPromises(B,P)}else{var F=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,F,W),this._fulfillPromises(B,F)}this._setLength(0)}this._clearCancellationData()},T.prototype._settledValue=function(){var W=this._bitField;if(W&33554432)return this._rejectionHandler0;if(W&16777216)return this._fulfillmentHandler0};function L(W){this.promise._resolveCallback(W)}function O(W){this.promise._rejectCallback(W,!1)}T.defer=T.pending=function(){_.deprecated("Promise.defer","new Promise");var W=new T(x);return{promise:W,resolve:L,reject:O}},s.notEnumerableProp(T,"_makeSelfResolutionError",t),LUe()(T,x,v,n,_),BUe()(T,x,v,_),WUe()(T,y,n,_),zUe()(T),HUe()(T),VUe()(T,y,v,x,d,l),T.Promise=T,T.version="3.4.7",qUe()(T,y,n,v,x,_),GUe()(T),YUe()(T,n,v,w,x,_),XUe()(T,x,_),KUe()(T,n,x,v,a,_),ZUe()(T),JUe()(T,x),QUe()(T,y,v,n),e$e()(T,x,v,n),t$e()(T,y,n,v,x,_),r$e()(T,y,_),n$e()(T,y,n),a$e()(T,x),i$e()(T,x),s$e()(T),s.toFastProperties(T),s.toFastProperties(T.prototype);function V(W){var B=new T(x);B._fulfillmentHandler0=W,B._rejectionHandler0=W,B._promise0=W,B._receiver0=W}return V({a:1}),V({b:2}),V({c:3}),V(1),V(function(){}),V(void 0),V(!1),V(new T(x)),_.setBounds(u.firstLineError,s.lastLineError),T}})(CW);var o$e=CW.exports,l$e=Xr,Ua=o$e();Tn.defer=c$e;Tn.when=Ua.resolve;Tn.resolve=Ua.resolve;Tn.all=Ua.all;Tn.props=Ua.props;Tn.reject=Ua.reject;Tn.promisify=Ua.promisify;Tn.mapSeries=Ua.mapSeries;Tn.attempt=Ua.attempt;Tn.nfcall=function(e){var t=Array.prototype.slice.call(arguments,1),r=Ua.promisify(e);return r.apply(null,t)};Ua.prototype.fail=Ua.prototype.caught;Ua.prototype.also=function(e){return this.then(function(t){var r=l$e.extend({},t,e(t));return Ua.props(r)})};function c$e(){var e,t,r=new Ua.Promise(function(n,a){e=n,t=a});return{resolve:e,reject:t,promise:r}}var Pt={},u$e=Xr,$n=Pt.types={document:"document",paragraph:"paragraph",run:"run",text:"text",tab:"tab",checkbox:"checkbox",hyperlink:"hyperlink",noteReference:"noteReference",image:"image",note:"note",commentReference:"commentReference",comment:"comment",table:"table",tableRow:"tableRow",tableCell:"tableCell",break:"break",bookmarkStart:"bookmarkStart"};function d$e(e,t){return t=t||{},{type:$n.document,children:e,notes:t.notes||new Bb({}),comments:t.comments||[]}}function f$e(e,t){t=t||{};var r=t.indent||{};return{type:$n.paragraph,children:e,styleId:t.styleId||null,styleName:t.styleName||null,numbering:t.numbering||null,alignment:t.alignment||null,indent:{start:r.start||null,end:r.end||null,firstLine:r.firstLine||null,hanging:r.hanging||null}}}function h$e(e,t){return t=t||{},{type:$n.run,children:e,styleId:t.styleId||null,styleName:t.styleName||null,isBold:!!t.isBold,isUnderline:!!t.isUnderline,isItalic:!!t.isItalic,isStrikethrough:!!t.isStrikethrough,isAllCaps:!!t.isAllCaps,isSmallCaps:!!t.isSmallCaps,verticalAlignment:t.verticalAlignment||OW.baseline,font:t.font||null,fontSize:t.fontSize||null,highlight:t.highlight||null}}var OW={baseline:"baseline",superscript:"superscript",subscript:"subscript"};function m$e(e){return{type:$n.text,value:e}}function p$e(){return{type:$n.tab}}function x$e(e){return{type:$n.checkbox,checked:e.checked}}function g$e(e,t){return{type:$n.hyperlink,children:e,href:t.href,anchor:t.anchor,targetFrame:t.targetFrame}}function v$e(e){return{type:$n.noteReference,noteType:e.noteType,noteId:e.noteId}}function Bb(e){this._notes=u$e.indexBy(e,function(t){return FW(t.noteType,t.noteId)})}Bb.prototype.resolve=function(e){return this.findNoteByKey(FW(e.noteType,e.noteId))};Bb.prototype.findNoteByKey=function(e){return this._notes[e]||null};function y$e(e){return{type:$n.note,noteType:e.noteType,noteId:e.noteId,body:e.body}}function b$e(e){return{type:$n.commentReference,commentId:e.commentId}}function w$e(e){return{type:$n.comment,commentId:e.commentId,body:e.body,authorName:e.authorName,authorInitials:e.authorInitials}}function FW(e,t){return e+"-"+t}function _$e(e){return{type:$n.image,read:function(t){return t?e.readImage(t):e.readImage().then(function(r){return Buffer.from(r)})},readAsArrayBuffer:function(){return e.readImage()},readAsBase64String:function(){return e.readImage("base64")},readAsBuffer:function(){return e.readImage().then(function(t){return Buffer.from(t)})},altText:e.altText,contentType:e.contentType}}function D$e(e,t){return t=t||{},{type:$n.table,children:e,styleId:t.styleId||null,styleName:t.styleName||null}}function j$e(e,t){return t=t||{},{type:$n.tableRow,children:e,isHeader:t.isHeader||!1}}function N$e(e,t){return t=t||{},{type:$n.tableCell,children:e,colSpan:t.colSpan==null?1:t.colSpan,rowSpan:t.rowSpan==null?1:t.rowSpan}}function _T(e){return{type:$n.break,breakType:e}}function S$e(e){return{type:$n.bookmarkStart,name:e.name}}Pt.document=Pt.Document=d$e;Pt.paragraph=Pt.Paragraph=f$e;Pt.run=Pt.Run=h$e;Pt.text=Pt.Text=m$e;Pt.tab=Pt.Tab=p$e;Pt.checkbox=Pt.Checkbox=x$e;Pt.Hyperlink=g$e;Pt.noteReference=Pt.NoteReference=v$e;Pt.Notes=Bb;Pt.Note=y$e;Pt.commentReference=b$e;Pt.comment=w$e;Pt.Image=_$e;Pt.Table=D$e;Pt.TableRow=j$e;Pt.TableCell=N$e;Pt.lineBreak=_T("line");Pt.pageBreak=_T("page");Pt.columnBreak=_T("column");Pt.BookmarkStart=S$e;Pt.verticalAlignment=OW;var fi={},ap=Xr;fi.Result=qs;fi.success=E$e;fi.warning=T$e;fi.error=k$e;function qs(e,t){this.value=e,this.messages=t||[]}qs.prototype.map=function(e){return new qs(e(this.value),this.messages)};qs.prototype.flatMap=function(e){var t=e(this.value);return new qs(t.value,DT([this,t]))};qs.prototype.flatMapThen=function(e){var t=this;return e(this.value).then(function(r){return new qs(r.value,DT([t,r]))})};qs.combine=function(e){var t=ap.flatten(ap.pluck(e,"value")),r=DT(e);return new qs(t,r)};function E$e(e){return new qs(e,[])}function T$e(e){return{type:"warning",message:e}}function k$e(e){return{type:"error",message:e.message,error:e}}function DT(e){var t=[];return ap.flatten(ap.pluck(e,"messages"),!0).forEach(function(r){C$e(t,r)||t.push(r)}),t}function C$e(e,t){return ap.find(e,A$e.bind(null,t))!==void 0}function A$e(e,t){return e.type===t.type&&e.message===t.message}var mx={},Wb={};Wb.byteLength=P$e;Wb.toByteArray=R$e;Wb.fromByteArray=$$e;var As=[],ji=[],O$e=typeof Uint8Array<"u"?Uint8Array:Array,D2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Cu=0,F$e=D2.length;Cu<F$e;++Cu)As[Cu]=D2[Cu],ji[D2.charCodeAt(Cu)]=Cu;ji[45]=62;ji[95]=63;function PW(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");r===-1&&(r=t);var n=r===t?0:4-r%4;return[r,n]}function P$e(e){var t=PW(e),r=t[0],n=t[1];return(r+n)*3/4-n}function I$e(e,t,r){return(t+r)*3/4-r}function R$e(e){var t,r=PW(e),n=r[0],a=r[1],i=new O$e(I$e(e,n,a)),s=0,l=a>0?n-4:n,c;for(c=0;c<l;c+=4)t=ji[e.charCodeAt(c)]<<18|ji[e.charCodeAt(c+1)]<<12|ji[e.charCodeAt(c+2)]<<6|ji[e.charCodeAt(c+3)],i[s++]=t>>16&255,i[s++]=t>>8&255,i[s++]=t&255;return a===2&&(t=ji[e.charCodeAt(c)]<<2|ji[e.charCodeAt(c+1)]>>4,i[s++]=t&255),a===1&&(t=ji[e.charCodeAt(c)]<<10|ji[e.charCodeAt(c+1)]<<4|ji[e.charCodeAt(c+2)]>>2,i[s++]=t>>8&255,i[s++]=t&255),i}function M$e(e){return As[e>>18&63]+As[e>>12&63]+As[e>>6&63]+As[e&63]}function U$e(e,t,r){for(var n,a=[],i=t;i<r;i+=3)n=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(e[i+2]&255),a.push(M$e(n));return a.join("")}function $$e(e){for(var t,r=e.length,n=r%3,a=[],i=16383,s=0,l=r-n;s<l;s+=i)a.push(U$e(e,s,s+i>l?l:s+i));return n===1?(t=e[r-1],a.push(As[t>>2]+As[t<<4&63]+"==")):n===2&&(t=(e[r-2]<<8)+e[r-1],a.push(As[t>>10]+As[t>>4&63]+As[t<<2&63]+"=")),a.join("")}function d0(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var IW={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,a,i){function s(u,d){if(!a[u]){if(!n[u]){var f=typeof d0=="function"&&d0;if(!d&&f)return f(u,!0);if(l)return l(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var m=a[u]={exports:{}};n[u][0].call(m.exports,function(x){var p=n[u][1][x];return s(p||x)},m,m.exports,r,n,a,i)}return a[u].exports}for(var l=typeof d0=="function"&&d0,c=0;c<i.length;c++)s(i[c]);return s}({1:[function(r,n,a){var i=r("./utils"),s=r("./support"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(c){for(var u,d,f,h,m,x,p,g=[],v=0,y=c.length,b=y,w=i.getTypeOf(c)!=="string";v<c.length;)b=y-v,f=w?(u=c[v++],d=v<y?c[v++]:0,v<y?c[v++]:0):(u=c.charCodeAt(v++),d=v<y?c.charCodeAt(v++):0,v<y?c.charCodeAt(v++):0),h=u>>2,m=(3&u)<<4|d>>4,x=1<b?(15&d)<<2|f>>6:64,p=2<b?63&f:64,g.push(l.charAt(h)+l.charAt(m)+l.charAt(x)+l.charAt(p));return g.join("")},a.decode=function(c){var u,d,f,h,m,x,p=0,g=0,v="data:";if(c.substr(0,v.length)===v)throw new Error("Invalid base64 input, it looks like a data url.");var y,b=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===l.charAt(64)&&b--,c.charAt(c.length-2)===l.charAt(64)&&b--,b%1!=0)throw new Error("Invalid base64 input, bad content length.");for(y=s.uint8array?new Uint8Array(0|b):new Array(0|b);p<c.length;)u=l.indexOf(c.charAt(p++))<<2|(h=l.indexOf(c.charAt(p++)))>>4,d=(15&h)<<4|(m=l.indexOf(c.charAt(p++)))>>2,f=(3&m)<<6|(x=l.indexOf(c.charAt(p++))),y[g++]=u,m!==64&&(y[g++]=d),x!==64&&(y[g++]=f);return y}},{"./support":30,"./utils":32}],2:[function(r,n,a){var i=r("./external"),s=r("./stream/DataWorker"),l=r("./stream/Crc32Probe"),c=r("./stream/DataLengthProbe");function u(d,f,h,m,x){this.compressedSize=d,this.uncompressedSize=f,this.crc32=h,this.compression=m,this.compressedContent=x}u.prototype={getContentWorker:function(){var d=new s(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),f=this;return d.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),d},getCompressedWorker:function(){return new s(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(d,f,h){return d.pipe(new l).pipe(new c("uncompressedSize")).pipe(f.compressWorker(h)).pipe(new c("compressedSize")).withStreamInfo("compression",f)},n.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,n,a){var i=r("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},a.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,n,a){var i=r("./utils"),s=function(){for(var l,c=[],u=0;u<256;u++){l=u;for(var d=0;d<8;d++)l=1&l?3988292384^l>>>1:l>>>1;c[u]=l}return c}();n.exports=function(l,c){return l!==void 0&&l.length?i.getTypeOf(l)!=="string"?function(u,d,f,h){var m=s,x=h+f;u^=-1;for(var p=h;p<x;p++)u=u>>>8^m[255&(u^d[p])];return-1^u}(0|c,l,l.length,0):function(u,d,f,h){var m=s,x=h+f;u^=-1;for(var p=h;p<x;p++)u=u>>>8^m[255&(u^d.charCodeAt(p))];return-1^u}(0|c,l,l.length,0):0}},{"./utils":32}],5:[function(r,n,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(r,n,a){var i=null;i=typeof Promise<"u"?Promise:r("lie"),n.exports={Promise:i}},{lie:37}],7:[function(r,n,a){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=r("pako"),l=r("./utils"),c=r("./stream/GenericWorker"),u=i?"uint8array":"array";function d(f,h){c.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=h,this.meta={}}a.magic="\b\0",l.inherits(d,c),d.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(l.transformTo(u,f.data),!1)},d.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},d.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},d.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(h){f.push({data:h,meta:f.meta})}},a.compressWorker=function(f){return new d("Deflate",f)},a.uncompressWorker=function(){return new d("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,n,a){function i(m,x){var p,g="";for(p=0;p<x;p++)g+=String.fromCharCode(255&m),m>>>=8;return g}function s(m,x,p,g,v,y){var b,w,_=m.file,D=m.compression,j=y!==u.utf8encode,N=l.transformTo("string",y(_.name)),S=l.transformTo("string",u.utf8encode(_.name)),E=_.comment,A=l.transformTo("string",y(E)),T=l.transformTo("string",u.utf8encode(E)),L=S.length!==_.name.length,O=T.length!==E.length,V="",W="",B="",P=_.dir,F=_.date,I={crc32:0,compressedSize:0,uncompressedSize:0};x&&!p||(I.crc32=m.crc32,I.compressedSize=m.compressedSize,I.uncompressedSize=m.uncompressedSize);var R=0;x&&(R|=8),j||!L&&!O||(R|=2048);var C=0,k=0;P&&(C|=16),v==="UNIX"?(k=798,C|=function(q,K){var se=q;return q||(se=K?16893:33204),(65535&se)<<16}(_.unixPermissions,P)):(k=20,C|=function(q){return 63&(q||0)}(_.dosPermissions)),b=F.getUTCHours(),b<<=6,b|=F.getUTCMinutes(),b<<=5,b|=F.getUTCSeconds()/2,w=F.getUTCFullYear()-1980,w<<=4,w|=F.getUTCMonth()+1,w<<=5,w|=F.getUTCDate(),L&&(W=i(1,1)+i(d(N),4)+S,V+="up"+i(W.length,2)+W),O&&(B=i(1,1)+i(d(A),4)+T,V+="uc"+i(B.length,2)+B);var z="";return z+=`
\0`,z+=i(R,2),z+=D.magic,z+=i(b,2),z+=i(w,2),z+=i(I.crc32,4),z+=i(I.compressedSize,4),z+=i(I.uncompressedSize,4),z+=i(N.length,2),z+=i(V.length,2),{fileRecord:f.LOCAL_FILE_HEADER+z+N+V,dirRecord:f.CENTRAL_FILE_HEADER+i(k,2)+z+i(A.length,2)+"\0\0\0\0"+i(C,4)+i(g,4)+N+V+A}}var l=r("../utils"),c=r("../stream/GenericWorker"),u=r("../utf8"),d=r("../crc32"),f=r("../signature");function h(m,x,p,g){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=x,this.zipPlatform=p,this.encodeFileName=g,this.streamFiles=m,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}l.inherits(h,c),h.prototype.push=function(m){var x=m.meta.percent||0,p=this.entriesCount,g=this._sources.length;this.accumulate?this.contentBuffer.push(m):(this.bytesWritten+=m.data.length,c.prototype.push.call(this,{data:m.data,meta:{currentFile:this.currentFile,percent:p?(x+100*(p-g-1))/p:100}}))},h.prototype.openedSource=function(m){this.currentSourceOffset=this.bytesWritten,this.currentFile=m.file.name;var x=this.streamFiles&&!m.file.dir;if(x){var p=s(m,x,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:p.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(m){this.accumulate=!1;var x=this.streamFiles&&!m.file.dir,p=s(m,x,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(p.dirRecord),x)this.push({data:function(g){return f.DATA_DESCRIPTOR+i(g.crc32,4)+i(g.compressedSize,4)+i(g.uncompressedSize,4)}(m),meta:{percent:100}});else for(this.push({data:p.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var m=this.bytesWritten,x=0;x<this.dirRecords.length;x++)this.push({data:this.dirRecords[x],meta:{percent:100}});var p=this.bytesWritten-m,g=function(v,y,b,w,_){var D=l.transformTo("string",_(w));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(v,2)+i(v,2)+i(y,4)+i(b,4)+i(D.length,2)+D}(this.dirRecords.length,p,m,this.zipComment,this.encodeFileName);this.push({data:g,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(m){this._sources.push(m);var x=this;return m.on("data",function(p){x.processChunk(p)}),m.on("end",function(){x.closedSource(x.previous.streamInfo),x._sources.length?x.prepareNextSource():x.end()}),m.on("error",function(p){x.error(p)}),this},h.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(m){var x=this._sources;if(!c.prototype.error.call(this,m))return!1;for(var p=0;p<x.length;p++)try{x[p].error(m)}catch{}return!0},h.prototype.lock=function(){c.prototype.lock.call(this);for(var m=this._sources,x=0;x<m.length;x++)m[x].lock()},n.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,n,a){var i=r("../compressions"),s=r("./ZipFileWorker");a.generateWorker=function(l,c,u){var d=new s(c.streamFiles,u,c.platform,c.encodeFileName),f=0;try{l.forEach(function(h,m){f++;var x=function(y,b){var w=y||b,_=i[w];if(!_)throw new Error(w+" is not a valid compression method !");return _}(m.options.compression,c.compression),p=m.options.compressionOptions||c.compressionOptions||{},g=m.dir,v=m.date;m._compressWorker(x,p).withStreamInfo("file",{name:h,dir:g,date:v,comment:m.comment||"",unixPermissions:m.unixPermissions,dosPermissions:m.dosPermissions}).pipe(d)}),d.entriesCount=f}catch(h){d.error(h)}return d}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,n,a){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new i;for(var l in this)typeof this[l]!="function"&&(s[l]=this[l]);return s}}(i.prototype=r("./object")).loadAsync=r("./load"),i.support=r("./support"),i.defaults=r("./defaults"),i.version="3.10.1",i.loadAsync=function(s,l){return new i().loadAsync(s,l)},i.external=r("./external"),n.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,n,a){var i=r("./utils"),s=r("./external"),l=r("./utf8"),c=r("./zipEntries"),u=r("./stream/Crc32Probe"),d=r("./nodejsUtils");function f(h){return new s.Promise(function(m,x){var p=h.decompressed.getContentWorker().pipe(new u);p.on("error",function(g){x(g)}).on("end",function(){p.streamInfo.crc32!==h.decompressed.crc32?x(new Error("Corrupted zip : CRC32 mismatch")):m()}).resume()})}n.exports=function(h,m){var x=this;return m=i.extend(m||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:l.utf8decode}),d.isNode&&d.isStream(h)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",h,!0,m.optimizedBinaryString,m.base64).then(function(p){var g=new c(m);return g.load(p),g}).then(function(p){var g=[s.Promise.resolve(p)],v=p.files;if(m.checkCRC32)for(var y=0;y<v.length;y++)g.push(f(v[y]));return s.Promise.all(g)}).then(function(p){for(var g=p.shift(),v=g.files,y=0;y<v.length;y++){var b=v[y],w=b.fileNameStr,_=i.resolve(b.fileNameStr);x.file(_,b.decompressed,{binary:!0,optimizedBinaryString:!0,date:b.date,dir:b.dir,comment:b.fileCommentStr.length?b.fileCommentStr:null,unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions,createFolders:m.createFolders}),b.dir||(x.file(_).unsafeOriginalName=w)}return g.zipComment.length&&(x.comment=g.zipComment),x})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,n,a){var i=r("../utils"),s=r("../stream/GenericWorker");function l(c,u){s.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(u)}i.inherits(l,s),l.prototype._bindStream=function(c){var u=this;(this._stream=c).pause(),c.on("data",function(d){u.push({data:d,meta:{percent:0}})}).on("error",function(d){u.isPaused?this.generatedError=d:u.error(d)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},l.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,n,a){var i=r("readable-stream").Readable;function s(l,c,u){i.call(this,c),this._helper=l;var d=this;l.on("data",function(f,h){d.push(f)||d._helper.pause(),u&&u(h)}).on("error",function(f){d.emit("error",f)}).on("end",function(){d.push(null)})}r("../utils").inherits(s,i),s.prototype._read=function(){this._helper.resume()},n.exports=s},{"../utils":32,"readable-stream":16}],14:[function(r,n,a){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,s);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,s)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var s=new Buffer(i);return s.fill(0),s},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(r,n,a){function i(_,D,j){var N,S=l.getTypeOf(D),E=l.extend(j||{},d);E.date=E.date||new Date,E.compression!==null&&(E.compression=E.compression.toUpperCase()),typeof E.unixPermissions=="string"&&(E.unixPermissions=parseInt(E.unixPermissions,8)),E.unixPermissions&&16384&E.unixPermissions&&(E.dir=!0),E.dosPermissions&&16&E.dosPermissions&&(E.dir=!0),E.dir&&(_=v(_)),E.createFolders&&(N=g(_))&&y.call(this,N,!0);var A=S==="string"&&E.binary===!1&&E.base64===!1;j&&j.binary!==void 0||(E.binary=!A),(D instanceof f&&D.uncompressedSize===0||E.dir||!D||D.length===0)&&(E.base64=!1,E.binary=!0,D="",E.compression="STORE",S="string");var T=null;T=D instanceof f||D instanceof c?D:x.isNode&&x.isStream(D)?new p(_,D):l.prepareContent(_,D,E.binary,E.optimizedBinaryString,E.base64);var L=new h(_,T,E);this.files[_]=L}var s=r("./utf8"),l=r("./utils"),c=r("./stream/GenericWorker"),u=r("./stream/StreamHelper"),d=r("./defaults"),f=r("./compressedObject"),h=r("./zipObject"),m=r("./generate"),x=r("./nodejsUtils"),p=r("./nodejs/NodejsStreamInputAdapter"),g=function(_){_.slice(-1)==="/"&&(_=_.substring(0,_.length-1));var D=_.lastIndexOf("/");return 0<D?_.substring(0,D):""},v=function(_){return _.slice(-1)!=="/"&&(_+="/"),_},y=function(_,D){return D=D!==void 0?D:d.createFolders,_=v(_),this.files[_]||i.call(this,_,null,{dir:!0,createFolders:D}),this.files[_]};function b(_){return Object.prototype.toString.call(_)==="[object RegExp]"}var w={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(_){var D,j,N;for(D in this.files)N=this.files[D],(j=D.slice(this.root.length,D.length))&&D.slice(0,this.root.length)===this.root&&_(j,N)},filter:function(_){var D=[];return this.forEach(function(j,N){_(j,N)&&D.push(N)}),D},file:function(_,D,j){if(arguments.length!==1)return _=this.root+_,i.call(this,_,D,j),this;if(b(_)){var N=_;return this.filter(function(E,A){return!A.dir&&N.test(E)})}var S=this.files[this.root+_];return S&&!S.dir?S:null},folder:function(_){if(!_)return this;if(b(_))return this.filter(function(S,E){return E.dir&&_.test(S)});var D=this.root+_,j=y.call(this,D),N=this.clone();return N.root=j.name,N},remove:function(_){_=this.root+_;var D=this.files[_];if(D||(_.slice(-1)!=="/"&&(_+="/"),D=this.files[_]),D&&!D.dir)delete this.files[_];else for(var j=this.filter(function(S,E){return E.name.slice(0,_.length)===_}),N=0;N<j.length;N++)delete this.files[j[N].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(_){var D,j={};try{if((j=l.extend(_||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=j.type.toLowerCase(),j.compression=j.compression.toUpperCase(),j.type==="binarystring"&&(j.type="string"),!j.type)throw new Error("No output type specified.");l.checkSupport(j.type),j.platform!=="darwin"&&j.platform!=="freebsd"&&j.platform!=="linux"&&j.platform!=="sunos"||(j.platform="UNIX"),j.platform==="win32"&&(j.platform="DOS");var N=j.comment||this.comment||"";D=m.generateWorker(this,j,N)}catch(S){(D=new c("error")).error(S)}return new u(D,j.type||"string",j.mimeType)},generateAsync:function(_,D){return this.generateInternalStream(_).accumulate(D)},generateNodeStream:function(_,D){return(_=_||{}).type||(_.type="nodebuffer"),this.generateInternalStream(_).toNodejsStream(D)}};n.exports=w},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,n,a){n.exports=r("stream")},{stream:void 0}],17:[function(r,n,a){var i=r("./DataReader");function s(l){i.call(this,l);for(var c=0;c<this.data.length;c++)l[c]=255&l[c]}r("../utils").inherits(s,i),s.prototype.byteAt=function(l){return this.data[this.zero+l]},s.prototype.lastIndexOfSignature=function(l){for(var c=l.charCodeAt(0),u=l.charCodeAt(1),d=l.charCodeAt(2),f=l.charCodeAt(3),h=this.length-4;0<=h;--h)if(this.data[h]===c&&this.data[h+1]===u&&this.data[h+2]===d&&this.data[h+3]===f)return h-this.zero;return-1},s.prototype.readAndCheckSignature=function(l){var c=l.charCodeAt(0),u=l.charCodeAt(1),d=l.charCodeAt(2),f=l.charCodeAt(3),h=this.readData(4);return c===h[0]&&u===h[1]&&d===h[2]&&f===h[3]},s.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=s},{"../utils":32,"./DataReader":18}],18:[function(r,n,a){var i=r("../utils");function s(l){this.data=l,this.length=l.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<this.zero+l||l<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+l+"). Corrupted zip ?")},setIndex:function(l){this.checkIndex(l),this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(){},readInt:function(l){var c,u=0;for(this.checkOffset(l),c=this.index+l-1;c>=this.index;c--)u=(u<<8)+this.byteAt(c);return this.index+=l,u},readString:function(l){return i.transformTo("string",this.readData(l))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var l=this.readInt(4);return new Date(Date.UTC(1980+(l>>25&127),(l>>21&15)-1,l>>16&31,l>>11&31,l>>5&63,(31&l)<<1))}},n.exports=s},{"../utils":32}],19:[function(r,n,a){var i=r("./Uint8ArrayReader");function s(l){i.call(this,l)}r("../utils").inherits(s,i),s.prototype.readData=function(l){this.checkOffset(l);var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,n,a){var i=r("./DataReader");function s(l){i.call(this,l)}r("../utils").inherits(s,i),s.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},s.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},s.prototype.readAndCheckSignature=function(l){return l===this.readData(4)},s.prototype.readData=function(l){this.checkOffset(l);var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=s},{"../utils":32,"./DataReader":18}],21:[function(r,n,a){var i=r("./ArrayReader");function s(l){i.call(this,l)}r("../utils").inherits(s,i),s.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(r,n,a){var i=r("../utils"),s=r("../support"),l=r("./ArrayReader"),c=r("./StringReader"),u=r("./NodeBufferReader"),d=r("./Uint8ArrayReader");n.exports=function(f){var h=i.getTypeOf(f);return i.checkSupport(h),h!=="string"||s.uint8array?h==="nodebuffer"?new u(f):s.uint8array?new d(i.transformTo("uint8array",f)):new l(i.transformTo("array",f)):new c(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,n,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,n,a){var i=r("./GenericWorker"),s=r("../utils");function l(c){i.call(this,"ConvertWorker to "+c),this.destType=c}s.inherits(l,i),l.prototype.processChunk=function(c){this.push({data:s.transformTo(this.destType,c.data),meta:c.meta})},n.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(r,n,a){var i=r("./GenericWorker"),s=r("../crc32");function l(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(l,i),l.prototype.processChunk=function(c){this.streamInfo.crc32=s(c.data,this.streamInfo.crc32||0),this.push(c)},n.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,n,a){var i=r("../utils"),s=r("./GenericWorker");function l(c){s.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}i.inherits(l,s),l.prototype.processChunk=function(c){if(c){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+c.data.length}s.prototype.processChunk.call(this,c)},n.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(r,n,a){var i=r("../utils"),s=r("./GenericWorker");function l(c){s.call(this,"DataWorker");var u=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(d){u.dataIsReady=!0,u.data=d,u.max=d&&d.length||0,u.type=i.getTypeOf(d),u.isPaused||u._tickAndRepeat()},function(d){u.error(d)})}i.inherits(l,s),l.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,u=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,u);break;case"uint8array":c=this.data.subarray(this.index,u);break;case"array":case"nodebuffer":c=this.data.slice(this.index,u)}return this.index=u,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(r,n,a){function i(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return!this.isFinished&&(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,l){return this._listeners[s].push(l),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,l){if(this._listeners[s])for(var c=0;c<this._listeners[s].length;c++)this._listeners[s][c].call(this,l)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var l=this;return s.on("data",function(c){l.processChunk(c)}),s.on("end",function(){l.end()}),s.on("error",function(c){l.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var s=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,l){return this.extraStreamInfo[s]=l,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},n.exports=i},{}],29:[function(r,n,a){var i=r("../utils"),s=r("./ConvertWorker"),l=r("./GenericWorker"),c=r("../base64"),u=r("../support"),d=r("../external"),f=null;if(u.nodestream)try{f=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(x,p){return new d.Promise(function(g,v){var y=[],b=x._internalType,w=x._outputType,_=x._mimeType;x.on("data",function(D,j){y.push(D),p&&p(j)}).on("error",function(D){y=[],v(D)}).on("end",function(){try{var D=function(j,N,S){switch(j){case"blob":return i.newBlob(i.transformTo("arraybuffer",N),S);case"base64":return c.encode(N);default:return i.transformTo(j,N)}}(w,function(j,N){var S,E=0,A=null,T=0;for(S=0;S<N.length;S++)T+=N[S].length;switch(j){case"string":return N.join("");case"array":return Array.prototype.concat.apply([],N);case"uint8array":for(A=new Uint8Array(T),S=0;S<N.length;S++)A.set(N[S],E),E+=N[S].length;return A;case"nodebuffer":return Buffer.concat(N);default:throw new Error("concat : unsupported type '"+j+"'")}}(b,y),_);g(D)}catch(j){v(j)}y=[]}).resume()})}function m(x,p,g){var v=p;switch(p){case"blob":case"arraybuffer":v="uint8array";break;case"base64":v="string"}try{this._internalType=v,this._outputType=p,this._mimeType=g,i.checkSupport(v),this._worker=x.pipe(new s(v)),x.lock()}catch(y){this._worker=new l("error"),this._worker.error(y)}}m.prototype={accumulate:function(x){return h(this,x)},on:function(x,p){var g=this;return x==="data"?this._worker.on(x,function(v){p.call(g,v.data,v.meta)}):this._worker.on(x,function(){i.delay(p,arguments,g)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(x){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},x)}},n.exports=m},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,n,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",a.nodebuffer=typeof Buffer<"u",a.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")a.blob=!1;else{var i=new ArrayBuffer(0);try{a.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(i),a.blob=s.getBlob("application/zip").size===0}catch{a.blob=!1}}}try{a.nodestream=!!r("readable-stream").Readable}catch{a.nodestream=!1}},{"readable-stream":16}],31:[function(r,n,a){for(var i=r("./utils"),s=r("./support"),l=r("./nodejsUtils"),c=r("./stream/GenericWorker"),u=new Array(256),d=0;d<256;d++)u[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;u[254]=u[254]=1;function f(){c.call(this,"utf-8 decode"),this.leftOver=null}function h(){c.call(this,"utf-8 encode")}a.utf8encode=function(m){return s.nodebuffer?l.newBufferFrom(m,"utf-8"):function(x){var p,g,v,y,b,w=x.length,_=0;for(y=0;y<w;y++)(64512&(g=x.charCodeAt(y)))==55296&&y+1<w&&(64512&(v=x.charCodeAt(y+1)))==56320&&(g=65536+(g-55296<<10)+(v-56320),y++),_+=g<128?1:g<2048?2:g<65536?3:4;for(p=s.uint8array?new Uint8Array(_):new Array(_),y=b=0;b<_;y++)(64512&(g=x.charCodeAt(y)))==55296&&y+1<w&&(64512&(v=x.charCodeAt(y+1)))==56320&&(g=65536+(g-55296<<10)+(v-56320),y++),g<128?p[b++]=g:(g<2048?p[b++]=192|g>>>6:(g<65536?p[b++]=224|g>>>12:(p[b++]=240|g>>>18,p[b++]=128|g>>>12&63),p[b++]=128|g>>>6&63),p[b++]=128|63&g);return p}(m)},a.utf8decode=function(m){return s.nodebuffer?i.transformTo("nodebuffer",m).toString("utf-8"):function(x){var p,g,v,y,b=x.length,w=new Array(2*b);for(p=g=0;p<b;)if((v=x[p++])<128)w[g++]=v;else if(4<(y=u[v]))w[g++]=65533,p+=y-1;else{for(v&=y===2?31:y===3?15:7;1<y&&p<b;)v=v<<6|63&x[p++],y--;1<y?w[g++]=65533:v<65536?w[g++]=v:(v-=65536,w[g++]=55296|v>>10&1023,w[g++]=56320|1023&v)}return w.length!==g&&(w.subarray?w=w.subarray(0,g):w.length=g),i.applyFromCharCode(w)}(m=i.transformTo(s.uint8array?"uint8array":"array",m))},i.inherits(f,c),f.prototype.processChunk=function(m){var x=i.transformTo(s.uint8array?"uint8array":"array",m.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var p=x;(x=new Uint8Array(p.length+this.leftOver.length)).set(this.leftOver,0),x.set(p,this.leftOver.length)}else x=this.leftOver.concat(x);this.leftOver=null}var g=function(y,b){var w;for((b=b||y.length)>y.length&&(b=y.length),w=b-1;0<=w&&(192&y[w])==128;)w--;return w<0||w===0?b:w+u[y[w]]>b?w:b}(x),v=x;g!==x.length&&(s.uint8array?(v=x.subarray(0,g),this.leftOver=x.subarray(g,x.length)):(v=x.slice(0,g),this.leftOver=x.slice(g,x.length))),this.push({data:a.utf8decode(v),meta:m.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=f,i.inherits(h,c),h.prototype.processChunk=function(m){this.push({data:a.utf8encode(m.data),meta:m.meta})},a.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,n,a){var i=r("./support"),s=r("./base64"),l=r("./nodejsUtils"),c=r("./external");function u(p){return p}function d(p,g){for(var v=0;v<p.length;++v)g[v]=255&p.charCodeAt(v);return g}r("setimmediate"),a.newBlob=function(p,g){a.checkSupport("blob");try{return new Blob([p],{type:g})}catch{try{var v=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return v.append(p),v.getBlob(g)}catch{throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(p,g,v){var y=[],b=0,w=p.length;if(w<=v)return String.fromCharCode.apply(null,p);for(;b<w;)g==="array"||g==="nodebuffer"?y.push(String.fromCharCode.apply(null,p.slice(b,Math.min(b+v,w)))):y.push(String.fromCharCode.apply(null,p.subarray(b,Math.min(b+v,w)))),b+=v;return y.join("")},stringifyByChar:function(p){for(var g="",v=0;v<p.length;v++)g+=String.fromCharCode(p[v]);return g},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,l.allocBuffer(1)).length===1}catch{return!1}}()}};function h(p){var g=65536,v=a.getTypeOf(p),y=!0;if(v==="uint8array"?y=f.applyCanBeUsed.uint8array:v==="nodebuffer"&&(y=f.applyCanBeUsed.nodebuffer),y)for(;1<g;)try{return f.stringifyByChunk(p,v,g)}catch{g=Math.floor(g/2)}return f.stringifyByChar(p)}function m(p,g){for(var v=0;v<p.length;v++)g[v]=p[v];return g}a.applyFromCharCode=h;var x={};x.string={string:u,array:function(p){return d(p,new Array(p.length))},arraybuffer:function(p){return x.string.uint8array(p).buffer},uint8array:function(p){return d(p,new Uint8Array(p.length))},nodebuffer:function(p){return d(p,l.allocBuffer(p.length))}},x.array={string:h,array:u,arraybuffer:function(p){return new Uint8Array(p).buffer},uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return l.newBufferFrom(p)}},x.arraybuffer={string:function(p){return h(new Uint8Array(p))},array:function(p){return m(new Uint8Array(p),new Array(p.byteLength))},arraybuffer:u,uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return l.newBufferFrom(new Uint8Array(p))}},x.uint8array={string:h,array:function(p){return m(p,new Array(p.length))},arraybuffer:function(p){return p.buffer},uint8array:u,nodebuffer:function(p){return l.newBufferFrom(p)}},x.nodebuffer={string:h,array:function(p){return m(p,new Array(p.length))},arraybuffer:function(p){return x.nodebuffer.uint8array(p).buffer},uint8array:function(p){return m(p,new Uint8Array(p.length))},nodebuffer:u},a.transformTo=function(p,g){if(g=g||"",!p)return g;a.checkSupport(p);var v=a.getTypeOf(g);return x[v][p](g)},a.resolve=function(p){for(var g=p.split("/"),v=[],y=0;y<g.length;y++){var b=g[y];b==="."||b===""&&y!==0&&y!==g.length-1||(b===".."?v.pop():v.push(b))}return v.join("/")},a.getTypeOf=function(p){return typeof p=="string"?"string":Object.prototype.toString.call(p)==="[object Array]"?"array":i.nodebuffer&&l.isBuffer(p)?"nodebuffer":i.uint8array&&p instanceof Uint8Array?"uint8array":i.arraybuffer&&p instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(p){if(!i[p.toLowerCase()])throw new Error(p+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(p){var g,v,y="";for(v=0;v<(p||"").length;v++)y+="\\x"+((g=p.charCodeAt(v))<16?"0":"")+g.toString(16).toUpperCase();return y},a.delay=function(p,g,v){setImmediate(function(){p.apply(v||null,g||[])})},a.inherits=function(p,g){function v(){}v.prototype=g.prototype,p.prototype=new v},a.extend=function(){var p,g,v={};for(p=0;p<arguments.length;p++)for(g in arguments[p])Object.prototype.hasOwnProperty.call(arguments[p],g)&&v[g]===void 0&&(v[g]=arguments[p][g]);return v},a.prepareContent=function(p,g,v,y,b){return c.Promise.resolve(g).then(function(w){return i.blob&&(w instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(w))!==-1)&&typeof FileReader<"u"?new c.Promise(function(_,D){var j=new FileReader;j.onload=function(N){_(N.target.result)},j.onerror=function(N){D(N.target.error)},j.readAsArrayBuffer(w)}):w}).then(function(w){var _=a.getTypeOf(w);return _?(_==="arraybuffer"?w=a.transformTo("uint8array",w):_==="string"&&(b?w=s.decode(w):v&&y!==!0&&(w=function(D){return d(D,i.uint8array?new Uint8Array(D.length):new Array(D.length))}(w))),w):c.Promise.reject(new Error("Can't read the data of '"+p+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,n,a){var i=r("./reader/readerFor"),s=r("./utils"),l=r("./signature"),c=r("./zipEntry"),u=r("./support");function d(f){this.files=[],this.loadOptions=f}d.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(h)+", expected "+s.pretty(f)+")")}},isSignature:function(f,h){var m=this.reader.index;this.reader.setIndex(f);var x=this.reader.readString(4)===h;return this.reader.setIndex(m),x},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),h=u.uint8array?"uint8array":"array",m=s.transformTo(h,f);this.zipComment=this.loadOptions.decodeFileName(m)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,h,m,x=this.zip64EndOfCentralSize-44;0<x;)f=this.reader.readInt(2),h=this.reader.readInt(4),m=this.reader.readData(h),this.zip64ExtensibleData[f]={id:f,length:h,value:m}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,h;for(f=0;f<this.files.length;f++)h=this.files[f],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(l.CENTRAL_FILE_HEADER);)(f=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,l.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var h=f;if(this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var m=this.centralDirOffset+this.centralDirSize;this.zip64&&(m+=20,m+=12+this.zip64EndOfCentralSize);var x=h-m;if(0<x)this.isSignature(h,l.CENTRAL_FILE_HEADER)||(this.reader.zero=x);else if(x<0)throw new Error("Corrupted zip: missing "+Math.abs(x)+" bytes.")},prepareReader:function(f){this.reader=i(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=d},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,n,a){var i=r("./reader/readerFor"),s=r("./utils"),l=r("./compressedObject"),c=r("./crc32"),u=r("./utf8"),d=r("./compressions"),f=r("./support");function h(m,x){this.options=m,this.loadOptions=x}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(m){var x,p;if(m.skip(22),this.fileNameLength=m.readInt(2),p=m.readInt(2),this.fileName=m.readData(this.fileNameLength),m.skip(p),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((x=function(g){for(var v in d)if(Object.prototype.hasOwnProperty.call(d,v)&&d[v].magic===g)return d[v];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new l(this.compressedSize,this.uncompressedSize,this.crc32,x,m.readData(this.compressedSize))},readCentralPart:function(m){this.versionMadeBy=m.readInt(2),m.skip(2),this.bitFlag=m.readInt(2),this.compressionMethod=m.readString(2),this.date=m.readDate(),this.crc32=m.readInt(4),this.compressedSize=m.readInt(4),this.uncompressedSize=m.readInt(4);var x=m.readInt(2);if(this.extraFieldsLength=m.readInt(2),this.fileCommentLength=m.readInt(2),this.diskNumberStart=m.readInt(2),this.internalFileAttributes=m.readInt(2),this.externalFileAttributes=m.readInt(4),this.localHeaderOffset=m.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");m.skip(x),this.readExtraFields(m),this.parseZIP64ExtraField(m),this.fileComment=m.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var m=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),m==0&&(this.dosPermissions=63&this.externalFileAttributes),m==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var m=i(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=m.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=m.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=m.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=m.readInt(4))}},readExtraFields:function(m){var x,p,g,v=m.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});m.index+4<v;)x=m.readInt(2),p=m.readInt(2),g=m.readData(p),this.extraFields[x]={id:x,length:p,value:g};m.setIndex(v)},handleUTF8:function(){var m=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var x=this.findExtraFieldUnicodePath();if(x!==null)this.fileNameStr=x;else{var p=s.transformTo(m,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(p)}var g=this.findExtraFieldUnicodeComment();if(g!==null)this.fileCommentStr=g;else{var v=s.transformTo(m,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(v)}}},findExtraFieldUnicodePath:function(){var m=this.extraFields[28789];if(m){var x=i(m.value);return x.readInt(1)!==1||c(this.fileName)!==x.readInt(4)?null:u.utf8decode(x.readData(m.length-5))}return null},findExtraFieldUnicodeComment:function(){var m=this.extraFields[25461];if(m){var x=i(m.value);return x.readInt(1)!==1||c(this.fileComment)!==x.readInt(4)?null:u.utf8decode(x.readData(m.length-5))}return null}},n.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,n,a){function i(x,p,g){this.name=x,this.dir=g.dir,this.date=g.date,this.comment=g.comment,this.unixPermissions=g.unixPermissions,this.dosPermissions=g.dosPermissions,this._data=p,this._dataBinary=g.binary,this.options={compression:g.compression,compressionOptions:g.compressionOptions}}var s=r("./stream/StreamHelper"),l=r("./stream/DataWorker"),c=r("./utf8"),u=r("./compressedObject"),d=r("./stream/GenericWorker");i.prototype={internalStream:function(x){var p=null,g="string";try{if(!x)throw new Error("No output type specified.");var v=(g=x.toLowerCase())==="string"||g==="text";g!=="binarystring"&&g!=="text"||(g="string"),p=this._decompressWorker();var y=!this._dataBinary;y&&!v&&(p=p.pipe(new c.Utf8EncodeWorker)),!y&&v&&(p=p.pipe(new c.Utf8DecodeWorker))}catch(b){(p=new d("error")).error(b)}return new s(p,g,"")},async:function(x,p){return this.internalStream(x).accumulate(p)},nodeStream:function(x,p){return this.internalStream(x||"nodebuffer").toNodejsStream(p)},_compressWorker:function(x,p){if(this._data instanceof u&&this._data.compression.magic===x.magic)return this._data.getCompressedWorker();var g=this._decompressWorker();return this._dataBinary||(g=g.pipe(new c.Utf8EncodeWorker)),u.createWorkerFrom(g,x,p)},_decompressWorker:function(){return this._data instanceof u?this._data.getContentWorker():this._data instanceof d?this._data:new l(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},m=0;m<f.length;m++)i.prototype[f[m]]=h;n.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,n,a){(function(i){var s,l,c=i.MutationObserver||i.WebKitMutationObserver;if(c){var u=0,d=new c(x),f=i.document.createTextNode("");d.observe(f,{characterData:!0}),s=function(){f.data=u=++u%2}}else if(i.setImmediate||i.MessageChannel===void 0)s="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var p=i.document.createElement("script");p.onreadystatechange=function(){x(),p.onreadystatechange=null,p.parentNode.removeChild(p),p=null},i.document.documentElement.appendChild(p)}:function(){setTimeout(x,0)};else{var h=new i.MessageChannel;h.port1.onmessage=x,s=function(){h.port2.postMessage(0)}}var m=[];function x(){var p,g;l=!0;for(var v=m.length;v;){for(g=m,m=[],p=-1;++p<v;)g[p]();v=m.length}l=!1}n.exports=function(p){m.push(p)!==1||l||s()}}).call(this,typeof ht<"u"?ht:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,n,a){var i=r("immediate");function s(){}var l={},c=["REJECTED"],u=["FULFILLED"],d=["PENDING"];function f(v){if(typeof v!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,v!==s&&p(this,v)}function h(v,y,b){this.promise=v,typeof y=="function"&&(this.onFulfilled=y,this.callFulfilled=this.otherCallFulfilled),typeof b=="function"&&(this.onRejected=b,this.callRejected=this.otherCallRejected)}function m(v,y,b){i(function(){var w;try{w=y(b)}catch(_){return l.reject(v,_)}w===v?l.reject(v,new TypeError("Cannot resolve promise with itself")):l.resolve(v,w)})}function x(v){var y=v&&v.then;if(v&&(typeof v=="object"||typeof v=="function")&&typeof y=="function")return function(){y.apply(v,arguments)}}function p(v,y){var b=!1;function w(j){b||(b=!0,l.reject(v,j))}function _(j){b||(b=!0,l.resolve(v,j))}var D=g(function(){y(_,w)});D.status==="error"&&w(D.value)}function g(v,y){var b={};try{b.value=v(y),b.status="success"}catch(w){b.status="error",b.value=w}return b}(n.exports=f).prototype.finally=function(v){if(typeof v!="function")return this;var y=this.constructor;return this.then(function(b){return y.resolve(v()).then(function(){return b})},function(b){return y.resolve(v()).then(function(){throw b})})},f.prototype.catch=function(v){return this.then(null,v)},f.prototype.then=function(v,y){if(typeof v!="function"&&this.state===u||typeof y!="function"&&this.state===c)return this;var b=new this.constructor(s);return this.state!==d?m(b,this.state===u?v:y,this.outcome):this.queue.push(new h(b,v,y)),b},h.prototype.callFulfilled=function(v){l.resolve(this.promise,v)},h.prototype.otherCallFulfilled=function(v){m(this.promise,this.onFulfilled,v)},h.prototype.callRejected=function(v){l.reject(this.promise,v)},h.prototype.otherCallRejected=function(v){m(this.promise,this.onRejected,v)},l.resolve=function(v,y){var b=g(x,y);if(b.status==="error")return l.reject(v,b.value);var w=b.value;if(w)p(v,w);else{v.state=u,v.outcome=y;for(var _=-1,D=v.queue.length;++_<D;)v.queue[_].callFulfilled(y)}return v},l.reject=function(v,y){v.state=c,v.outcome=y;for(var b=-1,w=v.queue.length;++b<w;)v.queue[b].callRejected(y);return v},f.resolve=function(v){return v instanceof this?v:l.resolve(new this(s),v)},f.reject=function(v){var y=new this(s);return l.reject(y,v)},f.all=function(v){var y=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=v.length,w=!1;if(!b)return this.resolve([]);for(var _=new Array(b),D=0,j=-1,N=new this(s);++j<b;)S(v[j],j);return N;function S(E,A){y.resolve(E).then(function(T){_[A]=T,++D!==b||w||(w=!0,l.resolve(N,_))},function(T){w||(w=!0,l.reject(N,T))})}},f.race=function(v){var y=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=v.length,w=!1;if(!b)return this.resolve([]);for(var _=-1,D=new this(s);++_<b;)j=v[_],y.resolve(j).then(function(N){w||(w=!0,l.resolve(D,N))},function(N){w||(w=!0,l.reject(D,N))});var j;return D}},{immediate:36}],38:[function(r,n,a){var i={};(0,r("./lib/utils/common").assign)(i,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),n.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,n,a){var i=r("./zlib/deflate"),s=r("./utils/common"),l=r("./utils/strings"),c=r("./zlib/messages"),u=r("./zlib/zstream"),d=Object.prototype.toString,f=0,h=-1,m=0,x=8;function p(v){if(!(this instanceof p))return new p(v);this.options=s.assign({level:h,method:x,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},v||{});var y=this.options;y.raw&&0<y.windowBits?y.windowBits=-y.windowBits:y.gzip&&0<y.windowBits&&y.windowBits<16&&(y.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var b=i.deflateInit2(this.strm,y.level,y.method,y.windowBits,y.memLevel,y.strategy);if(b!==f)throw new Error(c[b]);if(y.header&&i.deflateSetHeader(this.strm,y.header),y.dictionary){var w;if(w=typeof y.dictionary=="string"?l.string2buf(y.dictionary):d.call(y.dictionary)==="[object ArrayBuffer]"?new Uint8Array(y.dictionary):y.dictionary,(b=i.deflateSetDictionary(this.strm,w))!==f)throw new Error(c[b]);this._dict_set=!0}}function g(v,y){var b=new p(y);if(b.push(v,!0),b.err)throw b.msg||c[b.err];return b.result}p.prototype.push=function(v,y){var b,w,_=this.strm,D=this.options.chunkSize;if(this.ended)return!1;w=y===~~y?y:y===!0?4:0,typeof v=="string"?_.input=l.string2buf(v):d.call(v)==="[object ArrayBuffer]"?_.input=new Uint8Array(v):_.input=v,_.next_in=0,_.avail_in=_.input.length;do{if(_.avail_out===0&&(_.output=new s.Buf8(D),_.next_out=0,_.avail_out=D),(b=i.deflate(_,w))!==1&&b!==f)return this.onEnd(b),!(this.ended=!0);_.avail_out!==0&&(_.avail_in!==0||w!==4&&w!==2)||(this.options.to==="string"?this.onData(l.buf2binstring(s.shrinkBuf(_.output,_.next_out))):this.onData(s.shrinkBuf(_.output,_.next_out)))}while((0<_.avail_in||_.avail_out===0)&&b!==1);return w===4?(b=i.deflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===f):w!==2||(this.onEnd(f),!(_.avail_out=0))},p.prototype.onData=function(v){this.chunks.push(v)},p.prototype.onEnd=function(v){v===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},a.Deflate=p,a.deflate=g,a.deflateRaw=function(v,y){return(y=y||{}).raw=!0,g(v,y)},a.gzip=function(v,y){return(y=y||{}).gzip=!0,g(v,y)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,n,a){var i=r("./zlib/inflate"),s=r("./utils/common"),l=r("./utils/strings"),c=r("./zlib/constants"),u=r("./zlib/messages"),d=r("./zlib/zstream"),f=r("./zlib/gzheader"),h=Object.prototype.toString;function m(p){if(!(this instanceof m))return new m(p);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},p||{});var g=this.options;g.raw&&0<=g.windowBits&&g.windowBits<16&&(g.windowBits=-g.windowBits,g.windowBits===0&&(g.windowBits=-15)),!(0<=g.windowBits&&g.windowBits<16)||p&&p.windowBits||(g.windowBits+=32),15<g.windowBits&&g.windowBits<48&&!(15&g.windowBits)&&(g.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var v=i.inflateInit2(this.strm,g.windowBits);if(v!==c.Z_OK)throw new Error(u[v]);this.header=new f,i.inflateGetHeader(this.strm,this.header)}function x(p,g){var v=new m(g);if(v.push(p,!0),v.err)throw v.msg||u[v.err];return v.result}m.prototype.push=function(p,g){var v,y,b,w,_,D,j=this.strm,N=this.options.chunkSize,S=this.options.dictionary,E=!1;if(this.ended)return!1;y=g===~~g?g:g===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof p=="string"?j.input=l.binstring2buf(p):h.call(p)==="[object ArrayBuffer]"?j.input=new Uint8Array(p):j.input=p,j.next_in=0,j.avail_in=j.input.length;do{if(j.avail_out===0&&(j.output=new s.Buf8(N),j.next_out=0,j.avail_out=N),(v=i.inflate(j,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&S&&(D=typeof S=="string"?l.string2buf(S):h.call(S)==="[object ArrayBuffer]"?new Uint8Array(S):S,v=i.inflateSetDictionary(this.strm,D)),v===c.Z_BUF_ERROR&&E===!0&&(v=c.Z_OK,E=!1),v!==c.Z_STREAM_END&&v!==c.Z_OK)return this.onEnd(v),!(this.ended=!0);j.next_out&&(j.avail_out!==0&&v!==c.Z_STREAM_END&&(j.avail_in!==0||y!==c.Z_FINISH&&y!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(b=l.utf8border(j.output,j.next_out),w=j.next_out-b,_=l.buf2string(j.output,b),j.next_out=w,j.avail_out=N-w,w&&s.arraySet(j.output,j.output,b,w,0),this.onData(_)):this.onData(s.shrinkBuf(j.output,j.next_out)))),j.avail_in===0&&j.avail_out===0&&(E=!0)}while((0<j.avail_in||j.avail_out===0)&&v!==c.Z_STREAM_END);return v===c.Z_STREAM_END&&(y=c.Z_FINISH),y===c.Z_FINISH?(v=i.inflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===c.Z_OK):y!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(j.avail_out=0))},m.prototype.onData=function(p){this.chunks.push(p)},m.prototype.onEnd=function(p){p===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg},a.Inflate=m,a.inflate=x,a.inflateRaw=function(p,g){return(g=g||{}).raw=!0,x(p,g)},a.ungzip=x},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,n,a){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";a.assign=function(c){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var d=u.shift();if(d){if(typeof d!="object")throw new TypeError(d+"must be non-object");for(var f in d)d.hasOwnProperty(f)&&(c[f]=d[f])}}return c},a.shrinkBuf=function(c,u){return c.length===u?c:c.subarray?c.subarray(0,u):(c.length=u,c)};var s={arraySet:function(c,u,d,f,h){if(u.subarray&&c.subarray)c.set(u.subarray(d,d+f),h);else for(var m=0;m<f;m++)c[h+m]=u[d+m]},flattenChunks:function(c){var u,d,f,h,m,x;for(u=f=0,d=c.length;u<d;u++)f+=c[u].length;for(x=new Uint8Array(f),u=h=0,d=c.length;u<d;u++)m=c[u],x.set(m,h),h+=m.length;return x}},l={arraySet:function(c,u,d,f,h){for(var m=0;m<f;m++)c[h+m]=u[d+m]},flattenChunks:function(c){return[].concat.apply([],c)}};a.setTyped=function(c){c?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,s)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,l))},a.setTyped(i)},{}],42:[function(r,n,a){var i=r("./common"),s=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}for(var c=new i.Buf8(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;function d(f,h){if(h<65537&&(f.subarray&&l||!f.subarray&&s))return String.fromCharCode.apply(null,i.shrinkBuf(f,h));for(var m="",x=0;x<h;x++)m+=String.fromCharCode(f[x]);return m}c[254]=c[254]=1,a.string2buf=function(f){var h,m,x,p,g,v=f.length,y=0;for(p=0;p<v;p++)(64512&(m=f.charCodeAt(p)))==55296&&p+1<v&&(64512&(x=f.charCodeAt(p+1)))==56320&&(m=65536+(m-55296<<10)+(x-56320),p++),y+=m<128?1:m<2048?2:m<65536?3:4;for(h=new i.Buf8(y),p=g=0;g<y;p++)(64512&(m=f.charCodeAt(p)))==55296&&p+1<v&&(64512&(x=f.charCodeAt(p+1)))==56320&&(m=65536+(m-55296<<10)+(x-56320),p++),m<128?h[g++]=m:(m<2048?h[g++]=192|m>>>6:(m<65536?h[g++]=224|m>>>12:(h[g++]=240|m>>>18,h[g++]=128|m>>>12&63),h[g++]=128|m>>>6&63),h[g++]=128|63&m);return h},a.buf2binstring=function(f){return d(f,f.length)},a.binstring2buf=function(f){for(var h=new i.Buf8(f.length),m=0,x=h.length;m<x;m++)h[m]=f.charCodeAt(m);return h},a.buf2string=function(f,h){var m,x,p,g,v=h||f.length,y=new Array(2*v);for(m=x=0;m<v;)if((p=f[m++])<128)y[x++]=p;else if(4<(g=c[p]))y[x++]=65533,m+=g-1;else{for(p&=g===2?31:g===3?15:7;1<g&&m<v;)p=p<<6|63&f[m++],g--;1<g?y[x++]=65533:p<65536?y[x++]=p:(p-=65536,y[x++]=55296|p>>10&1023,y[x++]=56320|1023&p)}return d(y,x)},a.utf8border=function(f,h){var m;for((h=h||f.length)>f.length&&(h=f.length),m=h-1;0<=m&&(192&f[m])==128;)m--;return m<0||m===0?h:m+c[f[m]]>h?m:h}},{"./common":41}],43:[function(r,n,a){n.exports=function(i,s,l,c){for(var u=65535&i|0,d=i>>>16&65535|0,f=0;l!==0;){for(l-=f=2e3<l?2e3:l;d=d+(u=u+s[c++]|0)|0,--f;);u%=65521,d%=65521}return u|d<<16|0}},{}],44:[function(r,n,a){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,n,a){var i=function(){for(var s,l=[],c=0;c<256;c++){s=c;for(var u=0;u<8;u++)s=1&s?3988292384^s>>>1:s>>>1;l[c]=s}return l}();n.exports=function(s,l,c,u){var d=i,f=u+c;s^=-1;for(var h=u;h<f;h++)s=s>>>8^d[255&(s^l[h])];return-1^s}},{}],46:[function(r,n,a){var i,s=r("../utils/common"),l=r("./trees"),c=r("./adler32"),u=r("./crc32"),d=r("./messages"),f=0,h=4,m=0,x=-2,p=-1,g=4,v=2,y=8,b=9,w=286,_=30,D=19,j=2*w+1,N=15,S=3,E=258,A=E+S+1,T=42,L=113,O=1,V=2,W=3,B=4;function P(U,le){return U.msg=d[le],le}function F(U){return(U<<1)-(4<U?9:0)}function I(U){for(var le=U.length;0<=--le;)U[le]=0}function R(U){var le=U.state,re=le.pending;re>U.avail_out&&(re=U.avail_out),re!==0&&(s.arraySet(U.output,le.pending_buf,le.pending_out,re,U.next_out),U.next_out+=re,le.pending_out+=re,U.total_out+=re,U.avail_out-=re,le.pending-=re,le.pending===0&&(le.pending_out=0))}function C(U,le){l._tr_flush_block(U,0<=U.block_start?U.block_start:-1,U.strstart-U.block_start,le),U.block_start=U.strstart,R(U.strm)}function k(U,le){U.pending_buf[U.pending++]=le}function z(U,le){U.pending_buf[U.pending++]=le>>>8&255,U.pending_buf[U.pending++]=255&le}function q(U,le){var re,X,G=U.max_chain_length,ce=U.strstart,J=U.prev_length,ue=U.nice_match,me=U.strstart>U.w_size-A?U.strstart-(U.w_size-A):0,te=U.window,oe=U.w_mask,ge=U.prev,ye=U.strstart+E,Ce=te[ce+J-1],Ie=te[ce+J];U.prev_length>=U.good_match&&(G>>=2),ue>U.lookahead&&(ue=U.lookahead);do if(te[(re=le)+J]===Ie&&te[re+J-1]===Ce&&te[re]===te[ce]&&te[++re]===te[ce+1]){ce+=2,re++;do;while(te[++ce]===te[++re]&&te[++ce]===te[++re]&&te[++ce]===te[++re]&&te[++ce]===te[++re]&&te[++ce]===te[++re]&&te[++ce]===te[++re]&&te[++ce]===te[++re]&&te[++ce]===te[++re]&&ce<ye);if(X=E-(ye-ce),ce=ye-E,J<X){if(U.match_start=le,ue<=(J=X))break;Ce=te[ce+J-1],Ie=te[ce+J]}}while((le=ge[le&oe])>me&&--G!=0);return J<=U.lookahead?J:U.lookahead}function K(U){var le,re,X,G,ce,J,ue,me,te,oe,ge=U.w_size;do{if(G=U.window_size-U.lookahead-U.strstart,U.strstart>=ge+(ge-A)){for(s.arraySet(U.window,U.window,ge,ge,0),U.match_start-=ge,U.strstart-=ge,U.block_start-=ge,le=re=U.hash_size;X=U.head[--le],U.head[le]=ge<=X?X-ge:0,--re;);for(le=re=ge;X=U.prev[--le],U.prev[le]=ge<=X?X-ge:0,--re;);G+=ge}if(U.strm.avail_in===0)break;if(J=U.strm,ue=U.window,me=U.strstart+U.lookahead,te=G,oe=void 0,oe=J.avail_in,te<oe&&(oe=te),re=oe===0?0:(J.avail_in-=oe,s.arraySet(ue,J.input,J.next_in,oe,me),J.state.wrap===1?J.adler=c(J.adler,ue,oe,me):J.state.wrap===2&&(J.adler=u(J.adler,ue,oe,me)),J.next_in+=oe,J.total_in+=oe,oe),U.lookahead+=re,U.lookahead+U.insert>=S)for(ce=U.strstart-U.insert,U.ins_h=U.window[ce],U.ins_h=(U.ins_h<<U.hash_shift^U.window[ce+1])&U.hash_mask;U.insert&&(U.ins_h=(U.ins_h<<U.hash_shift^U.window[ce+S-1])&U.hash_mask,U.prev[ce&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=ce,ce++,U.insert--,!(U.lookahead+U.insert<S)););}while(U.lookahead<A&&U.strm.avail_in!==0)}function se(U,le){for(var re,X;;){if(U.lookahead<A){if(K(U),U.lookahead<A&&le===f)return O;if(U.lookahead===0)break}if(re=0,U.lookahead>=S&&(U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+S-1])&U.hash_mask,re=U.prev[U.strstart&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=U.strstart),re!==0&&U.strstart-re<=U.w_size-A&&(U.match_length=q(U,re)),U.match_length>=S)if(X=l._tr_tally(U,U.strstart-U.match_start,U.match_length-S),U.lookahead-=U.match_length,U.match_length<=U.max_lazy_match&&U.lookahead>=S){for(U.match_length--;U.strstart++,U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+S-1])&U.hash_mask,re=U.prev[U.strstart&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=U.strstart,--U.match_length!=0;);U.strstart++}else U.strstart+=U.match_length,U.match_length=0,U.ins_h=U.window[U.strstart],U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+1])&U.hash_mask;else X=l._tr_tally(U,0,U.window[U.strstart]),U.lookahead--,U.strstart++;if(X&&(C(U,!1),U.strm.avail_out===0))return O}return U.insert=U.strstart<S-1?U.strstart:S-1,le===h?(C(U,!0),U.strm.avail_out===0?W:B):U.last_lit&&(C(U,!1),U.strm.avail_out===0)?O:V}function ie(U,le){for(var re,X,G;;){if(U.lookahead<A){if(K(U),U.lookahead<A&&le===f)return O;if(U.lookahead===0)break}if(re=0,U.lookahead>=S&&(U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+S-1])&U.hash_mask,re=U.prev[U.strstart&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=U.strstart),U.prev_length=U.match_length,U.prev_match=U.match_start,U.match_length=S-1,re!==0&&U.prev_length<U.max_lazy_match&&U.strstart-re<=U.w_size-A&&(U.match_length=q(U,re),U.match_length<=5&&(U.strategy===1||U.match_length===S&&4096<U.strstart-U.match_start)&&(U.match_length=S-1)),U.prev_length>=S&&U.match_length<=U.prev_length){for(G=U.strstart+U.lookahead-S,X=l._tr_tally(U,U.strstart-1-U.prev_match,U.prev_length-S),U.lookahead-=U.prev_length-1,U.prev_length-=2;++U.strstart<=G&&(U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+S-1])&U.hash_mask,re=U.prev[U.strstart&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=U.strstart),--U.prev_length!=0;);if(U.match_available=0,U.match_length=S-1,U.strstart++,X&&(C(U,!1),U.strm.avail_out===0))return O}else if(U.match_available){if((X=l._tr_tally(U,0,U.window[U.strstart-1]))&&C(U,!1),U.strstart++,U.lookahead--,U.strm.avail_out===0)return O}else U.match_available=1,U.strstart++,U.lookahead--}return U.match_available&&(X=l._tr_tally(U,0,U.window[U.strstart-1]),U.match_available=0),U.insert=U.strstart<S-1?U.strstart:S-1,le===h?(C(U,!0),U.strm.avail_out===0?W:B):U.last_lit&&(C(U,!1),U.strm.avail_out===0)?O:V}function ee(U,le,re,X,G){this.good_length=U,this.max_lazy=le,this.nice_length=re,this.max_chain=X,this.func=G}function ae(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*j),this.dyn_dtree=new s.Buf16(2*(2*_+1)),this.bl_tree=new s.Buf16(2*(2*D+1)),I(this.dyn_ltree),I(this.dyn_dtree),I(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(N+1),this.heap=new s.Buf16(2*w+1),I(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*w+1),I(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function pe(U){var le;return U&&U.state?(U.total_in=U.total_out=0,U.data_type=v,(le=U.state).pending=0,le.pending_out=0,le.wrap<0&&(le.wrap=-le.wrap),le.status=le.wrap?T:L,U.adler=le.wrap===2?0:1,le.last_flush=f,l._tr_init(le),m):P(U,x)}function H(U){var le=pe(U);return le===m&&function(re){re.window_size=2*re.w_size,I(re.head),re.max_lazy_match=i[re.level].max_lazy,re.good_match=i[re.level].good_length,re.nice_match=i[re.level].nice_length,re.max_chain_length=i[re.level].max_chain,re.strstart=0,re.block_start=0,re.lookahead=0,re.insert=0,re.match_length=re.prev_length=S-1,re.match_available=0,re.ins_h=0}(U.state),le}function ne(U,le,re,X,G,ce){if(!U)return x;var J=1;if(le===p&&(le=6),X<0?(J=0,X=-X):15<X&&(J=2,X-=16),G<1||b<G||re!==y||X<8||15<X||le<0||9<le||ce<0||g<ce)return P(U,x);X===8&&(X=9);var ue=new ae;return(U.state=ue).strm=U,ue.wrap=J,ue.gzhead=null,ue.w_bits=X,ue.w_size=1<<ue.w_bits,ue.w_mask=ue.w_size-1,ue.hash_bits=G+7,ue.hash_size=1<<ue.hash_bits,ue.hash_mask=ue.hash_size-1,ue.hash_shift=~~((ue.hash_bits+S-1)/S),ue.window=new s.Buf8(2*ue.w_size),ue.head=new s.Buf16(ue.hash_size),ue.prev=new s.Buf16(ue.w_size),ue.lit_bufsize=1<<G+6,ue.pending_buf_size=4*ue.lit_bufsize,ue.pending_buf=new s.Buf8(ue.pending_buf_size),ue.d_buf=1*ue.lit_bufsize,ue.l_buf=3*ue.lit_bufsize,ue.level=le,ue.strategy=ce,ue.method=re,H(U)}i=[new ee(0,0,0,0,function(U,le){var re=65535;for(re>U.pending_buf_size-5&&(re=U.pending_buf_size-5);;){if(U.lookahead<=1){if(K(U),U.lookahead===0&&le===f)return O;if(U.lookahead===0)break}U.strstart+=U.lookahead,U.lookahead=0;var X=U.block_start+re;if((U.strstart===0||U.strstart>=X)&&(U.lookahead=U.strstart-X,U.strstart=X,C(U,!1),U.strm.avail_out===0)||U.strstart-U.block_start>=U.w_size-A&&(C(U,!1),U.strm.avail_out===0))return O}return U.insert=0,le===h?(C(U,!0),U.strm.avail_out===0?W:B):(U.strstart>U.block_start&&(C(U,!1),U.strm.avail_out),O)}),new ee(4,4,8,4,se),new ee(4,5,16,8,se),new ee(4,6,32,32,se),new ee(4,4,16,16,ie),new ee(8,16,32,32,ie),new ee(8,16,128,128,ie),new ee(8,32,128,256,ie),new ee(32,128,258,1024,ie),new ee(32,258,258,4096,ie)],a.deflateInit=function(U,le){return ne(U,le,y,15,8,0)},a.deflateInit2=ne,a.deflateReset=H,a.deflateResetKeep=pe,a.deflateSetHeader=function(U,le){return U&&U.state?U.state.wrap!==2?x:(U.state.gzhead=le,m):x},a.deflate=function(U,le){var re,X,G,ce;if(!U||!U.state||5<le||le<0)return U?P(U,x):x;if(X=U.state,!U.output||!U.input&&U.avail_in!==0||X.status===666&&le!==h)return P(U,U.avail_out===0?-5:x);if(X.strm=U,re=X.last_flush,X.last_flush=le,X.status===T)if(X.wrap===2)U.adler=0,k(X,31),k(X,139),k(X,8),X.gzhead?(k(X,(X.gzhead.text?1:0)+(X.gzhead.hcrc?2:0)+(X.gzhead.extra?4:0)+(X.gzhead.name?8:0)+(X.gzhead.comment?16:0)),k(X,255&X.gzhead.time),k(X,X.gzhead.time>>8&255),k(X,X.gzhead.time>>16&255),k(X,X.gzhead.time>>24&255),k(X,X.level===9?2:2<=X.strategy||X.level<2?4:0),k(X,255&X.gzhead.os),X.gzhead.extra&&X.gzhead.extra.length&&(k(X,255&X.gzhead.extra.length),k(X,X.gzhead.extra.length>>8&255)),X.gzhead.hcrc&&(U.adler=u(U.adler,X.pending_buf,X.pending,0)),X.gzindex=0,X.status=69):(k(X,0),k(X,0),k(X,0),k(X,0),k(X,0),k(X,X.level===9?2:2<=X.strategy||X.level<2?4:0),k(X,3),X.status=L);else{var J=y+(X.w_bits-8<<4)<<8;J|=(2<=X.strategy||X.level<2?0:X.level<6?1:X.level===6?2:3)<<6,X.strstart!==0&&(J|=32),J+=31-J%31,X.status=L,z(X,J),X.strstart!==0&&(z(X,U.adler>>>16),z(X,65535&U.adler)),U.adler=1}if(X.status===69)if(X.gzhead.extra){for(G=X.pending;X.gzindex<(65535&X.gzhead.extra.length)&&(X.pending!==X.pending_buf_size||(X.gzhead.hcrc&&X.pending>G&&(U.adler=u(U.adler,X.pending_buf,X.pending-G,G)),R(U),G=X.pending,X.pending!==X.pending_buf_size));)k(X,255&X.gzhead.extra[X.gzindex]),X.gzindex++;X.gzhead.hcrc&&X.pending>G&&(U.adler=u(U.adler,X.pending_buf,X.pending-G,G)),X.gzindex===X.gzhead.extra.length&&(X.gzindex=0,X.status=73)}else X.status=73;if(X.status===73)if(X.gzhead.name){G=X.pending;do{if(X.pending===X.pending_buf_size&&(X.gzhead.hcrc&&X.pending>G&&(U.adler=u(U.adler,X.pending_buf,X.pending-G,G)),R(U),G=X.pending,X.pending===X.pending_buf_size)){ce=1;break}ce=X.gzindex<X.gzhead.name.length?255&X.gzhead.name.charCodeAt(X.gzindex++):0,k(X,ce)}while(ce!==0);X.gzhead.hcrc&&X.pending>G&&(U.adler=u(U.adler,X.pending_buf,X.pending-G,G)),ce===0&&(X.gzindex=0,X.status=91)}else X.status=91;if(X.status===91)if(X.gzhead.comment){G=X.pending;do{if(X.pending===X.pending_buf_size&&(X.gzhead.hcrc&&X.pending>G&&(U.adler=u(U.adler,X.pending_buf,X.pending-G,G)),R(U),G=X.pending,X.pending===X.pending_buf_size)){ce=1;break}ce=X.gzindex<X.gzhead.comment.length?255&X.gzhead.comment.charCodeAt(X.gzindex++):0,k(X,ce)}while(ce!==0);X.gzhead.hcrc&&X.pending>G&&(U.adler=u(U.adler,X.pending_buf,X.pending-G,G)),ce===0&&(X.status=103)}else X.status=103;if(X.status===103&&(X.gzhead.hcrc?(X.pending+2>X.pending_buf_size&&R(U),X.pending+2<=X.pending_buf_size&&(k(X,255&U.adler),k(X,U.adler>>8&255),U.adler=0,X.status=L)):X.status=L),X.pending!==0){if(R(U),U.avail_out===0)return X.last_flush=-1,m}else if(U.avail_in===0&&F(le)<=F(re)&&le!==h)return P(U,-5);if(X.status===666&&U.avail_in!==0)return P(U,-5);if(U.avail_in!==0||X.lookahead!==0||le!==f&&X.status!==666){var ue=X.strategy===2?function(me,te){for(var oe;;){if(me.lookahead===0&&(K(me),me.lookahead===0)){if(te===f)return O;break}if(me.match_length=0,oe=l._tr_tally(me,0,me.window[me.strstart]),me.lookahead--,me.strstart++,oe&&(C(me,!1),me.strm.avail_out===0))return O}return me.insert=0,te===h?(C(me,!0),me.strm.avail_out===0?W:B):me.last_lit&&(C(me,!1),me.strm.avail_out===0)?O:V}(X,le):X.strategy===3?function(me,te){for(var oe,ge,ye,Ce,Ie=me.window;;){if(me.lookahead<=E){if(K(me),me.lookahead<=E&&te===f)return O;if(me.lookahead===0)break}if(me.match_length=0,me.lookahead>=S&&0<me.strstart&&(ge=Ie[ye=me.strstart-1])===Ie[++ye]&&ge===Ie[++ye]&&ge===Ie[++ye]){Ce=me.strstart+E;do;while(ge===Ie[++ye]&&ge===Ie[++ye]&&ge===Ie[++ye]&&ge===Ie[++ye]&&ge===Ie[++ye]&&ge===Ie[++ye]&&ge===Ie[++ye]&&ge===Ie[++ye]&&ye<Ce);me.match_length=E-(Ce-ye),me.match_length>me.lookahead&&(me.match_length=me.lookahead)}if(me.match_length>=S?(oe=l._tr_tally(me,1,me.match_length-S),me.lookahead-=me.match_length,me.strstart+=me.match_length,me.match_length=0):(oe=l._tr_tally(me,0,me.window[me.strstart]),me.lookahead--,me.strstart++),oe&&(C(me,!1),me.strm.avail_out===0))return O}return me.insert=0,te===h?(C(me,!0),me.strm.avail_out===0?W:B):me.last_lit&&(C(me,!1),me.strm.avail_out===0)?O:V}(X,le):i[X.level].func(X,le);if(ue!==W&&ue!==B||(X.status=666),ue===O||ue===W)return U.avail_out===0&&(X.last_flush=-1),m;if(ue===V&&(le===1?l._tr_align(X):le!==5&&(l._tr_stored_block(X,0,0,!1),le===3&&(I(X.head),X.lookahead===0&&(X.strstart=0,X.block_start=0,X.insert=0))),R(U),U.avail_out===0))return X.last_flush=-1,m}return le!==h?m:X.wrap<=0?1:(X.wrap===2?(k(X,255&U.adler),k(X,U.adler>>8&255),k(X,U.adler>>16&255),k(X,U.adler>>24&255),k(X,255&U.total_in),k(X,U.total_in>>8&255),k(X,U.total_in>>16&255),k(X,U.total_in>>24&255)):(z(X,U.adler>>>16),z(X,65535&U.adler)),R(U),0<X.wrap&&(X.wrap=-X.wrap),X.pending!==0?m:1)},a.deflateEnd=function(U){var le;return U&&U.state?(le=U.state.status)!==T&&le!==69&&le!==73&&le!==91&&le!==103&&le!==L&&le!==666?P(U,x):(U.state=null,le===L?P(U,-3):m):x},a.deflateSetDictionary=function(U,le){var re,X,G,ce,J,ue,me,te,oe=le.length;if(!U||!U.state||(ce=(re=U.state).wrap)===2||ce===1&&re.status!==T||re.lookahead)return x;for(ce===1&&(U.adler=c(U.adler,le,oe,0)),re.wrap=0,oe>=re.w_size&&(ce===0&&(I(re.head),re.strstart=0,re.block_start=0,re.insert=0),te=new s.Buf8(re.w_size),s.arraySet(te,le,oe-re.w_size,re.w_size,0),le=te,oe=re.w_size),J=U.avail_in,ue=U.next_in,me=U.input,U.avail_in=oe,U.next_in=0,U.input=le,K(re);re.lookahead>=S;){for(X=re.strstart,G=re.lookahead-(S-1);re.ins_h=(re.ins_h<<re.hash_shift^re.window[X+S-1])&re.hash_mask,re.prev[X&re.w_mask]=re.head[re.ins_h],re.head[re.ins_h]=X,X++,--G;);re.strstart=X,re.lookahead=S-1,K(re)}return re.strstart+=re.lookahead,re.block_start=re.strstart,re.insert=re.lookahead,re.lookahead=0,re.match_length=re.prev_length=S-1,re.match_available=0,U.next_in=ue,U.input=me,U.avail_in=J,re.wrap=ce,m},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,n,a){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,n,a){n.exports=function(i,s){var l,c,u,d,f,h,m,x,p,g,v,y,b,w,_,D,j,N,S,E,A,T,L,O,V;l=i.state,c=i.next_in,O=i.input,u=c+(i.avail_in-5),d=i.next_out,V=i.output,f=d-(s-i.avail_out),h=d+(i.avail_out-257),m=l.dmax,x=l.wsize,p=l.whave,g=l.wnext,v=l.window,y=l.hold,b=l.bits,w=l.lencode,_=l.distcode,D=(1<<l.lenbits)-1,j=(1<<l.distbits)-1;e:do{b<15&&(y+=O[c++]<<b,b+=8,y+=O[c++]<<b,b+=8),N=w[y&D];t:for(;;){if(y>>>=S=N>>>24,b-=S,(S=N>>>16&255)===0)V[d++]=65535&N;else{if(!(16&S)){if(!(64&S)){N=w[(65535&N)+(y&(1<<S)-1)];continue t}if(32&S){l.mode=12;break e}i.msg="invalid literal/length code",l.mode=30;break e}E=65535&N,(S&=15)&&(b<S&&(y+=O[c++]<<b,b+=8),E+=y&(1<<S)-1,y>>>=S,b-=S),b<15&&(y+=O[c++]<<b,b+=8,y+=O[c++]<<b,b+=8),N=_[y&j];r:for(;;){if(y>>>=S=N>>>24,b-=S,!(16&(S=N>>>16&255))){if(!(64&S)){N=_[(65535&N)+(y&(1<<S)-1)];continue r}i.msg="invalid distance code",l.mode=30;break e}if(A=65535&N,b<(S&=15)&&(y+=O[c++]<<b,(b+=8)<S&&(y+=O[c++]<<b,b+=8)),m<(A+=y&(1<<S)-1)){i.msg="invalid distance too far back",l.mode=30;break e}if(y>>>=S,b-=S,(S=d-f)<A){if(p<(S=A-S)&&l.sane){i.msg="invalid distance too far back",l.mode=30;break e}if(L=v,(T=0)===g){if(T+=x-S,S<E){for(E-=S;V[d++]=v[T++],--S;);T=d-A,L=V}}else if(g<S){if(T+=x+g-S,(S-=g)<E){for(E-=S;V[d++]=v[T++],--S;);if(T=0,g<E){for(E-=S=g;V[d++]=v[T++],--S;);T=d-A,L=V}}}else if(T+=g-S,S<E){for(E-=S;V[d++]=v[T++],--S;);T=d-A,L=V}for(;2<E;)V[d++]=L[T++],V[d++]=L[T++],V[d++]=L[T++],E-=3;E&&(V[d++]=L[T++],1<E&&(V[d++]=L[T++]))}else{for(T=d-A;V[d++]=V[T++],V[d++]=V[T++],V[d++]=V[T++],2<(E-=3););E&&(V[d++]=V[T++],1<E&&(V[d++]=V[T++]))}break}}break}}while(c<u&&d<h);c-=E=b>>3,y&=(1<<(b-=E<<3))-1,i.next_in=c,i.next_out=d,i.avail_in=c<u?u-c+5:5-(c-u),i.avail_out=d<h?h-d+257:257-(d-h),l.hold=y,l.bits=b}},{}],49:[function(r,n,a){var i=r("../utils/common"),s=r("./adler32"),l=r("./crc32"),c=r("./inffast"),u=r("./inftrees"),d=1,f=2,h=0,m=-2,x=1,p=852,g=592;function v(T){return(T>>>24&255)+(T>>>8&65280)+((65280&T)<<8)+((255&T)<<24)}function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function b(T){var L;return T&&T.state?(L=T.state,T.total_in=T.total_out=L.total=0,T.msg="",L.wrap&&(T.adler=1&L.wrap),L.mode=x,L.last=0,L.havedict=0,L.dmax=32768,L.head=null,L.hold=0,L.bits=0,L.lencode=L.lendyn=new i.Buf32(p),L.distcode=L.distdyn=new i.Buf32(g),L.sane=1,L.back=-1,h):m}function w(T){var L;return T&&T.state?((L=T.state).wsize=0,L.whave=0,L.wnext=0,b(T)):m}function _(T,L){var O,V;return T&&T.state?(V=T.state,L<0?(O=0,L=-L):(O=1+(L>>4),L<48&&(L&=15)),L&&(L<8||15<L)?m:(V.window!==null&&V.wbits!==L&&(V.window=null),V.wrap=O,V.wbits=L,w(T))):m}function D(T,L){var O,V;return T?(V=new y,(T.state=V).window=null,(O=_(T,L))!==h&&(T.state=null),O):m}var j,N,S=!0;function E(T){if(S){var L;for(j=new i.Buf32(512),N=new i.Buf32(32),L=0;L<144;)T.lens[L++]=8;for(;L<256;)T.lens[L++]=9;for(;L<280;)T.lens[L++]=7;for(;L<288;)T.lens[L++]=8;for(u(d,T.lens,0,288,j,0,T.work,{bits:9}),L=0;L<32;)T.lens[L++]=5;u(f,T.lens,0,32,N,0,T.work,{bits:5}),S=!1}T.lencode=j,T.lenbits=9,T.distcode=N,T.distbits=5}function A(T,L,O,V){var W,B=T.state;return B.window===null&&(B.wsize=1<<B.wbits,B.wnext=0,B.whave=0,B.window=new i.Buf8(B.wsize)),V>=B.wsize?(i.arraySet(B.window,L,O-B.wsize,B.wsize,0),B.wnext=0,B.whave=B.wsize):(V<(W=B.wsize-B.wnext)&&(W=V),i.arraySet(B.window,L,O-V,W,B.wnext),(V-=W)?(i.arraySet(B.window,L,O-V,V,0),B.wnext=V,B.whave=B.wsize):(B.wnext+=W,B.wnext===B.wsize&&(B.wnext=0),B.whave<B.wsize&&(B.whave+=W))),0}a.inflateReset=w,a.inflateReset2=_,a.inflateResetKeep=b,a.inflateInit=function(T){return D(T,15)},a.inflateInit2=D,a.inflate=function(T,L){var O,V,W,B,P,F,I,R,C,k,z,q,K,se,ie,ee,ae,pe,H,ne,U,le,re,X,G=0,ce=new i.Buf8(4),J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!T||!T.state||!T.output||!T.input&&T.avail_in!==0)return m;(O=T.state).mode===12&&(O.mode=13),P=T.next_out,W=T.output,I=T.avail_out,B=T.next_in,V=T.input,F=T.avail_in,R=O.hold,C=O.bits,k=F,z=I,le=h;e:for(;;)switch(O.mode){case x:if(O.wrap===0){O.mode=13;break}for(;C<16;){if(F===0)break e;F--,R+=V[B++]<<C,C+=8}if(2&O.wrap&&R===35615){ce[O.check=0]=255&R,ce[1]=R>>>8&255,O.check=l(O.check,ce,2,0),C=R=0,O.mode=2;break}if(O.flags=0,O.head&&(O.head.done=!1),!(1&O.wrap)||(((255&R)<<8)+(R>>8))%31){T.msg="incorrect header check",O.mode=30;break}if((15&R)!=8){T.msg="unknown compression method",O.mode=30;break}if(C-=4,U=8+(15&(R>>>=4)),O.wbits===0)O.wbits=U;else if(U>O.wbits){T.msg="invalid window size",O.mode=30;break}O.dmax=1<<U,T.adler=O.check=1,O.mode=512&R?10:12,C=R=0;break;case 2:for(;C<16;){if(F===0)break e;F--,R+=V[B++]<<C,C+=8}if(O.flags=R,(255&O.flags)!=8){T.msg="unknown compression method",O.mode=30;break}if(57344&O.flags){T.msg="unknown header flags set",O.mode=30;break}O.head&&(O.head.text=R>>8&1),512&O.flags&&(ce[0]=255&R,ce[1]=R>>>8&255,O.check=l(O.check,ce,2,0)),C=R=0,O.mode=3;case 3:for(;C<32;){if(F===0)break e;F--,R+=V[B++]<<C,C+=8}O.head&&(O.head.time=R),512&O.flags&&(ce[0]=255&R,ce[1]=R>>>8&255,ce[2]=R>>>16&255,ce[3]=R>>>24&255,O.check=l(O.check,ce,4,0)),C=R=0,O.mode=4;case 4:for(;C<16;){if(F===0)break e;F--,R+=V[B++]<<C,C+=8}O.head&&(O.head.xflags=255&R,O.head.os=R>>8),512&O.flags&&(ce[0]=255&R,ce[1]=R>>>8&255,O.check=l(O.check,ce,2,0)),C=R=0,O.mode=5;case 5:if(1024&O.flags){for(;C<16;){if(F===0)break e;F--,R+=V[B++]<<C,C+=8}O.length=R,O.head&&(O.head.extra_len=R),512&O.flags&&(ce[0]=255&R,ce[1]=R>>>8&255,O.check=l(O.check,ce,2,0)),C=R=0}else O.head&&(O.head.extra=null);O.mode=6;case 6:if(1024&O.flags&&(F<(q=O.length)&&(q=F),q&&(O.head&&(U=O.head.extra_len-O.length,O.head.extra||(O.head.extra=new Array(O.head.extra_len)),i.arraySet(O.head.extra,V,B,q,U)),512&O.flags&&(O.check=l(O.check,V,q,B)),F-=q,B+=q,O.length-=q),O.length))break e;O.length=0,O.mode=7;case 7:if(2048&O.flags){if(F===0)break e;for(q=0;U=V[B+q++],O.head&&U&&O.length<65536&&(O.head.name+=String.fromCharCode(U)),U&&q<F;);if(512&O.flags&&(O.check=l(O.check,V,q,B)),F-=q,B+=q,U)break e}else O.head&&(O.head.name=null);O.length=0,O.mode=8;case 8:if(4096&O.flags){if(F===0)break e;for(q=0;U=V[B+q++],O.head&&U&&O.length<65536&&(O.head.comment+=String.fromCharCode(U)),U&&q<F;);if(512&O.flags&&(O.check=l(O.check,V,q,B)),F-=q,B+=q,U)break e}else O.head&&(O.head.comment=null);O.mode=9;case 9:if(512&O.flags){for(;C<16;){if(F===0)break e;F--,R+=V[B++]<<C,C+=8}if(R!==(65535&O.check)){T.msg="header crc mismatch",O.mode=30;break}C=R=0}O.head&&(O.head.hcrc=O.flags>>9&1,O.head.done=!0),T.adler=O.check=0,O.mode=12;break;case 10:for(;C<32;){if(F===0)break e;F--,R+=V[B++]<<C,C+=8}T.adler=O.check=v(R),C=R=0,O.mode=11;case 11:if(O.havedict===0)return T.next_out=P,T.avail_out=I,T.next_in=B,T.avail_in=F,O.hold=R,O.bits=C,2;T.adler=O.check=1,O.mode=12;case 12:if(L===5||L===6)break e;case 13:if(O.last){R>>>=7&C,C-=7&C,O.mode=27;break}for(;C<3;){if(F===0)break e;F--,R+=V[B++]<<C,C+=8}switch(O.last=1&R,C-=1,3&(R>>>=1)){case 0:O.mode=14;break;case 1:if(E(O),O.mode=20,L!==6)break;R>>>=2,C-=2;break e;case 2:O.mode=17;break;case 3:T.msg="invalid block type",O.mode=30}R>>>=2,C-=2;break;case 14:for(R>>>=7&C,C-=7&C;C<32;){if(F===0)break e;F--,R+=V[B++]<<C,C+=8}if((65535&R)!=(R>>>16^65535)){T.msg="invalid stored block lengths",O.mode=30;break}if(O.length=65535&R,C=R=0,O.mode=15,L===6)break e;case 15:O.mode=16;case 16:if(q=O.length){if(F<q&&(q=F),I<q&&(q=I),q===0)break e;i.arraySet(W,V,B,q,P),F-=q,B+=q,I-=q,P+=q,O.length-=q;break}O.mode=12;break;case 17:for(;C<14;){if(F===0)break e;F--,R+=V[B++]<<C,C+=8}if(O.nlen=257+(31&R),R>>>=5,C-=5,O.ndist=1+(31&R),R>>>=5,C-=5,O.ncode=4+(15&R),R>>>=4,C-=4,286<O.nlen||30<O.ndist){T.msg="too many length or distance symbols",O.mode=30;break}O.have=0,O.mode=18;case 18:for(;O.have<O.ncode;){for(;C<3;){if(F===0)break e;F--,R+=V[B++]<<C,C+=8}O.lens[J[O.have++]]=7&R,R>>>=3,C-=3}for(;O.have<19;)O.lens[J[O.have++]]=0;if(O.lencode=O.lendyn,O.lenbits=7,re={bits:O.lenbits},le=u(0,O.lens,0,19,O.lencode,0,O.work,re),O.lenbits=re.bits,le){T.msg="invalid code lengths set",O.mode=30;break}O.have=0,O.mode=19;case 19:for(;O.have<O.nlen+O.ndist;){for(;ee=(G=O.lencode[R&(1<<O.lenbits)-1])>>>16&255,ae=65535&G,!((ie=G>>>24)<=C);){if(F===0)break e;F--,R+=V[B++]<<C,C+=8}if(ae<16)R>>>=ie,C-=ie,O.lens[O.have++]=ae;else{if(ae===16){for(X=ie+2;C<X;){if(F===0)break e;F--,R+=V[B++]<<C,C+=8}if(R>>>=ie,C-=ie,O.have===0){T.msg="invalid bit length repeat",O.mode=30;break}U=O.lens[O.have-1],q=3+(3&R),R>>>=2,C-=2}else if(ae===17){for(X=ie+3;C<X;){if(F===0)break e;F--,R+=V[B++]<<C,C+=8}C-=ie,U=0,q=3+(7&(R>>>=ie)),R>>>=3,C-=3}else{for(X=ie+7;C<X;){if(F===0)break e;F--,R+=V[B++]<<C,C+=8}C-=ie,U=0,q=11+(127&(R>>>=ie)),R>>>=7,C-=7}if(O.have+q>O.nlen+O.ndist){T.msg="invalid bit length repeat",O.mode=30;break}for(;q--;)O.lens[O.have++]=U}}if(O.mode===30)break;if(O.lens[256]===0){T.msg="invalid code -- missing end-of-block",O.mode=30;break}if(O.lenbits=9,re={bits:O.lenbits},le=u(d,O.lens,0,O.nlen,O.lencode,0,O.work,re),O.lenbits=re.bits,le){T.msg="invalid literal/lengths set",O.mode=30;break}if(O.distbits=6,O.distcode=O.distdyn,re={bits:O.distbits},le=u(f,O.lens,O.nlen,O.ndist,O.distcode,0,O.work,re),O.distbits=re.bits,le){T.msg="invalid distances set",O.mode=30;break}if(O.mode=20,L===6)break e;case 20:O.mode=21;case 21:if(6<=F&&258<=I){T.next_out=P,T.avail_out=I,T.next_in=B,T.avail_in=F,O.hold=R,O.bits=C,c(T,z),P=T.next_out,W=T.output,I=T.avail_out,B=T.next_in,V=T.input,F=T.avail_in,R=O.hold,C=O.bits,O.mode===12&&(O.back=-1);break}for(O.back=0;ee=(G=O.lencode[R&(1<<O.lenbits)-1])>>>16&255,ae=65535&G,!((ie=G>>>24)<=C);){if(F===0)break e;F--,R+=V[B++]<<C,C+=8}if(ee&&!(240&ee)){for(pe=ie,H=ee,ne=ae;ee=(G=O.lencode[ne+((R&(1<<pe+H)-1)>>pe)])>>>16&255,ae=65535&G,!(pe+(ie=G>>>24)<=C);){if(F===0)break e;F--,R+=V[B++]<<C,C+=8}R>>>=pe,C-=pe,O.back+=pe}if(R>>>=ie,C-=ie,O.back+=ie,O.length=ae,ee===0){O.mode=26;break}if(32&ee){O.back=-1,O.mode=12;break}if(64&ee){T.msg="invalid literal/length code",O.mode=30;break}O.extra=15&ee,O.mode=22;case 22:if(O.extra){for(X=O.extra;C<X;){if(F===0)break e;F--,R+=V[B++]<<C,C+=8}O.length+=R&(1<<O.extra)-1,R>>>=O.extra,C-=O.extra,O.back+=O.extra}O.was=O.length,O.mode=23;case 23:for(;ee=(G=O.distcode[R&(1<<O.distbits)-1])>>>16&255,ae=65535&G,!((ie=G>>>24)<=C);){if(F===0)break e;F--,R+=V[B++]<<C,C+=8}if(!(240&ee)){for(pe=ie,H=ee,ne=ae;ee=(G=O.distcode[ne+((R&(1<<pe+H)-1)>>pe)])>>>16&255,ae=65535&G,!(pe+(ie=G>>>24)<=C);){if(F===0)break e;F--,R+=V[B++]<<C,C+=8}R>>>=pe,C-=pe,O.back+=pe}if(R>>>=ie,C-=ie,O.back+=ie,64&ee){T.msg="invalid distance code",O.mode=30;break}O.offset=ae,O.extra=15&ee,O.mode=24;case 24:if(O.extra){for(X=O.extra;C<X;){if(F===0)break e;F--,R+=V[B++]<<C,C+=8}O.offset+=R&(1<<O.extra)-1,R>>>=O.extra,C-=O.extra,O.back+=O.extra}if(O.offset>O.dmax){T.msg="invalid distance too far back",O.mode=30;break}O.mode=25;case 25:if(I===0)break e;if(q=z-I,O.offset>q){if((q=O.offset-q)>O.whave&&O.sane){T.msg="invalid distance too far back",O.mode=30;break}K=q>O.wnext?(q-=O.wnext,O.wsize-q):O.wnext-q,q>O.length&&(q=O.length),se=O.window}else se=W,K=P-O.offset,q=O.length;for(I<q&&(q=I),I-=q,O.length-=q;W[P++]=se[K++],--q;);O.length===0&&(O.mode=21);break;case 26:if(I===0)break e;W[P++]=O.length,I--,O.mode=21;break;case 27:if(O.wrap){for(;C<32;){if(F===0)break e;F--,R|=V[B++]<<C,C+=8}if(z-=I,T.total_out+=z,O.total+=z,z&&(T.adler=O.check=O.flags?l(O.check,W,z,P-z):s(O.check,W,z,P-z)),z=I,(O.flags?R:v(R))!==O.check){T.msg="incorrect data check",O.mode=30;break}C=R=0}O.mode=28;case 28:if(O.wrap&&O.flags){for(;C<32;){if(F===0)break e;F--,R+=V[B++]<<C,C+=8}if(R!==(4294967295&O.total)){T.msg="incorrect length check",O.mode=30;break}C=R=0}O.mode=29;case 29:le=1;break e;case 30:le=-3;break e;case 31:return-4;case 32:default:return m}return T.next_out=P,T.avail_out=I,T.next_in=B,T.avail_in=F,O.hold=R,O.bits=C,(O.wsize||z!==T.avail_out&&O.mode<30&&(O.mode<27||L!==4))&&A(T,T.output,T.next_out,z-T.avail_out)?(O.mode=31,-4):(k-=T.avail_in,z-=T.avail_out,T.total_in+=k,T.total_out+=z,O.total+=z,O.wrap&&z&&(T.adler=O.check=O.flags?l(O.check,W,z,T.next_out-z):s(O.check,W,z,T.next_out-z)),T.data_type=O.bits+(O.last?64:0)+(O.mode===12?128:0)+(O.mode===20||O.mode===15?256:0),(k==0&&z===0||L===4)&&le===h&&(le=-5),le)},a.inflateEnd=function(T){if(!T||!T.state)return m;var L=T.state;return L.window&&(L.window=null),T.state=null,h},a.inflateGetHeader=function(T,L){var O;return T&&T.state&&2&(O=T.state).wrap?((O.head=L).done=!1,h):m},a.inflateSetDictionary=function(T,L){var O,V=L.length;return T&&T.state?(O=T.state).wrap!==0&&O.mode!==11?m:O.mode===11&&s(1,L,V,0)!==O.check?-3:A(T,L,V,V)?(O.mode=31,-4):(O.havedict=1,h):m},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,n,a){var i=r("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(d,f,h,m,x,p,g,v){var y,b,w,_,D,j,N,S,E,A=v.bits,T=0,L=0,O=0,V=0,W=0,B=0,P=0,F=0,I=0,R=0,C=null,k=0,z=new i.Buf16(16),q=new i.Buf16(16),K=null,se=0;for(T=0;T<=15;T++)z[T]=0;for(L=0;L<m;L++)z[f[h+L]]++;for(W=A,V=15;1<=V&&z[V]===0;V--);if(V<W&&(W=V),V===0)return x[p++]=20971520,x[p++]=20971520,v.bits=1,0;for(O=1;O<V&&z[O]===0;O++);for(W<O&&(W=O),T=F=1;T<=15;T++)if(F<<=1,(F-=z[T])<0)return-1;if(0<F&&(d===0||V!==1))return-1;for(q[1]=0,T=1;T<15;T++)q[T+1]=q[T]+z[T];for(L=0;L<m;L++)f[h+L]!==0&&(g[q[f[h+L]]++]=L);if(j=d===0?(C=K=g,19):d===1?(C=s,k-=257,K=l,se-=257,256):(C=c,K=u,-1),T=O,D=p,P=L=R=0,w=-1,_=(I=1<<(B=W))-1,d===1&&852<I||d===2&&592<I)return 1;for(;;){for(N=T-P,E=g[L]<j?(S=0,g[L]):g[L]>j?(S=K[se+g[L]],C[k+g[L]]):(S=96,0),y=1<<T-P,O=b=1<<B;x[D+(R>>P)+(b-=y)]=N<<24|S<<16|E|0,b!==0;);for(y=1<<T-1;R&y;)y>>=1;if(y!==0?(R&=y-1,R+=y):R=0,L++,--z[T]==0){if(T===V)break;T=f[h+g[L]]}if(W<T&&(R&_)!==w){for(P===0&&(P=W),D+=O,F=1<<(B=T-P);B+P<V&&!((F-=z[B+P])<=0);)B++,F<<=1;if(I+=1<<B,d===1&&852<I||d===2&&592<I)return 1;x[w=R&_]=W<<24|B<<16|D-p|0}}return R!==0&&(x[D+R]=T-P<<24|64<<16|0),v.bits=W,0}},{"../utils/common":41}],51:[function(r,n,a){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,n,a){var i=r("../utils/common"),s=0,l=1;function c(G){for(var ce=G.length;0<=--ce;)G[ce]=0}var u=0,d=29,f=256,h=f+1+d,m=30,x=19,p=2*h+1,g=15,v=16,y=7,b=256,w=16,_=17,D=18,j=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],N=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],E=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],A=new Array(2*(h+2));c(A);var T=new Array(2*m);c(T);var L=new Array(512);c(L);var O=new Array(256);c(O);var V=new Array(d);c(V);var W,B,P,F=new Array(m);function I(G,ce,J,ue,me){this.static_tree=G,this.extra_bits=ce,this.extra_base=J,this.elems=ue,this.max_length=me,this.has_stree=G&&G.length}function R(G,ce){this.dyn_tree=G,this.max_code=0,this.stat_desc=ce}function C(G){return G<256?L[G]:L[256+(G>>>7)]}function k(G,ce){G.pending_buf[G.pending++]=255&ce,G.pending_buf[G.pending++]=ce>>>8&255}function z(G,ce,J){G.bi_valid>v-J?(G.bi_buf|=ce<<G.bi_valid&65535,k(G,G.bi_buf),G.bi_buf=ce>>v-G.bi_valid,G.bi_valid+=J-v):(G.bi_buf|=ce<<G.bi_valid&65535,G.bi_valid+=J)}function q(G,ce,J){z(G,J[2*ce],J[2*ce+1])}function K(G,ce){for(var J=0;J|=1&G,G>>>=1,J<<=1,0<--ce;);return J>>>1}function se(G,ce,J){var ue,me,te=new Array(g+1),oe=0;for(ue=1;ue<=g;ue++)te[ue]=oe=oe+J[ue-1]<<1;for(me=0;me<=ce;me++){var ge=G[2*me+1];ge!==0&&(G[2*me]=K(te[ge]++,ge))}}function ie(G){var ce;for(ce=0;ce<h;ce++)G.dyn_ltree[2*ce]=0;for(ce=0;ce<m;ce++)G.dyn_dtree[2*ce]=0;for(ce=0;ce<x;ce++)G.bl_tree[2*ce]=0;G.dyn_ltree[2*b]=1,G.opt_len=G.static_len=0,G.last_lit=G.matches=0}function ee(G){8<G.bi_valid?k(G,G.bi_buf):0<G.bi_valid&&(G.pending_buf[G.pending++]=G.bi_buf),G.bi_buf=0,G.bi_valid=0}function ae(G,ce,J,ue){var me=2*ce,te=2*J;return G[me]<G[te]||G[me]===G[te]&&ue[ce]<=ue[J]}function pe(G,ce,J){for(var ue=G.heap[J],me=J<<1;me<=G.heap_len&&(me<G.heap_len&&ae(ce,G.heap[me+1],G.heap[me],G.depth)&&me++,!ae(ce,ue,G.heap[me],G.depth));)G.heap[J]=G.heap[me],J=me,me<<=1;G.heap[J]=ue}function H(G,ce,J){var ue,me,te,oe,ge=0;if(G.last_lit!==0)for(;ue=G.pending_buf[G.d_buf+2*ge]<<8|G.pending_buf[G.d_buf+2*ge+1],me=G.pending_buf[G.l_buf+ge],ge++,ue===0?q(G,me,ce):(q(G,(te=O[me])+f+1,ce),(oe=j[te])!==0&&z(G,me-=V[te],oe),q(G,te=C(--ue),J),(oe=N[te])!==0&&z(G,ue-=F[te],oe)),ge<G.last_lit;);q(G,b,ce)}function ne(G,ce){var J,ue,me,te=ce.dyn_tree,oe=ce.stat_desc.static_tree,ge=ce.stat_desc.has_stree,ye=ce.stat_desc.elems,Ce=-1;for(G.heap_len=0,G.heap_max=p,J=0;J<ye;J++)te[2*J]!==0?(G.heap[++G.heap_len]=Ce=J,G.depth[J]=0):te[2*J+1]=0;for(;G.heap_len<2;)te[2*(me=G.heap[++G.heap_len]=Ce<2?++Ce:0)]=1,G.depth[me]=0,G.opt_len--,ge&&(G.static_len-=oe[2*me+1]);for(ce.max_code=Ce,J=G.heap_len>>1;1<=J;J--)pe(G,te,J);for(me=ye;J=G.heap[1],G.heap[1]=G.heap[G.heap_len--],pe(G,te,1),ue=G.heap[1],G.heap[--G.heap_max]=J,G.heap[--G.heap_max]=ue,te[2*me]=te[2*J]+te[2*ue],G.depth[me]=(G.depth[J]>=G.depth[ue]?G.depth[J]:G.depth[ue])+1,te[2*J+1]=te[2*ue+1]=me,G.heap[1]=me++,pe(G,te,1),2<=G.heap_len;);G.heap[--G.heap_max]=G.heap[1],function(Ie,rt){var Pe,Ke,lt,nt,nr,za,Bn=rt.dyn_tree,at=rt.max_code,bt=rt.stat_desc.static_tree,Mt=rt.stat_desc.has_stree,St=rt.stat_desc.extra_bits,Ha=rt.stat_desc.extra_base,kn=rt.stat_desc.max_length,Cn=0;for(nt=0;nt<=g;nt++)Ie.bl_count[nt]=0;for(Bn[2*Ie.heap[Ie.heap_max]+1]=0,Pe=Ie.heap_max+1;Pe<p;Pe++)kn<(nt=Bn[2*Bn[2*(Ke=Ie.heap[Pe])+1]+1]+1)&&(nt=kn,Cn++),Bn[2*Ke+1]=nt,at<Ke||(Ie.bl_count[nt]++,nr=0,Ha<=Ke&&(nr=St[Ke-Ha]),za=Bn[2*Ke],Ie.opt_len+=za*(nt+nr),Mt&&(Ie.static_len+=za*(bt[2*Ke+1]+nr)));if(Cn!==0){do{for(nt=kn-1;Ie.bl_count[nt]===0;)nt--;Ie.bl_count[nt]--,Ie.bl_count[nt+1]+=2,Ie.bl_count[kn]--,Cn-=2}while(0<Cn);for(nt=kn;nt!==0;nt--)for(Ke=Ie.bl_count[nt];Ke!==0;)at<(lt=Ie.heap[--Pe])||(Bn[2*lt+1]!==nt&&(Ie.opt_len+=(nt-Bn[2*lt+1])*Bn[2*lt],Bn[2*lt+1]=nt),Ke--)}}(G,ce),se(te,Ce,G.bl_count)}function U(G,ce,J){var ue,me,te=-1,oe=ce[1],ge=0,ye=7,Ce=4;for(oe===0&&(ye=138,Ce=3),ce[2*(J+1)+1]=65535,ue=0;ue<=J;ue++)me=oe,oe=ce[2*(ue+1)+1],++ge<ye&&me===oe||(ge<Ce?G.bl_tree[2*me]+=ge:me!==0?(me!==te&&G.bl_tree[2*me]++,G.bl_tree[2*w]++):ge<=10?G.bl_tree[2*_]++:G.bl_tree[2*D]++,te=me,Ce=(ge=0)===oe?(ye=138,3):me===oe?(ye=6,3):(ye=7,4))}function le(G,ce,J){var ue,me,te=-1,oe=ce[1],ge=0,ye=7,Ce=4;for(oe===0&&(ye=138,Ce=3),ue=0;ue<=J;ue++)if(me=oe,oe=ce[2*(ue+1)+1],!(++ge<ye&&me===oe)){if(ge<Ce)for(;q(G,me,G.bl_tree),--ge!=0;);else me!==0?(me!==te&&(q(G,me,G.bl_tree),ge--),q(G,w,G.bl_tree),z(G,ge-3,2)):ge<=10?(q(G,_,G.bl_tree),z(G,ge-3,3)):(q(G,D,G.bl_tree),z(G,ge-11,7));te=me,Ce=(ge=0)===oe?(ye=138,3):me===oe?(ye=6,3):(ye=7,4)}}c(F);var re=!1;function X(G,ce,J,ue){z(G,(u<<1)+(ue?1:0),3),function(me,te,oe,ge){ee(me),k(me,oe),k(me,~oe),i.arraySet(me.pending_buf,me.window,te,oe,me.pending),me.pending+=oe}(G,ce,J)}a._tr_init=function(G){re||(function(){var ce,J,ue,me,te,oe=new Array(g+1);for(me=ue=0;me<d-1;me++)for(V[me]=ue,ce=0;ce<1<<j[me];ce++)O[ue++]=me;for(O[ue-1]=me,me=te=0;me<16;me++)for(F[me]=te,ce=0;ce<1<<N[me];ce++)L[te++]=me;for(te>>=7;me<m;me++)for(F[me]=te<<7,ce=0;ce<1<<N[me]-7;ce++)L[256+te++]=me;for(J=0;J<=g;J++)oe[J]=0;for(ce=0;ce<=143;)A[2*ce+1]=8,ce++,oe[8]++;for(;ce<=255;)A[2*ce+1]=9,ce++,oe[9]++;for(;ce<=279;)A[2*ce+1]=7,ce++,oe[7]++;for(;ce<=287;)A[2*ce+1]=8,ce++,oe[8]++;for(se(A,h+1,oe),ce=0;ce<m;ce++)T[2*ce+1]=5,T[2*ce]=K(ce,5);W=new I(A,j,f+1,h,g),B=new I(T,N,0,m,g),P=new I(new Array(0),S,0,x,y)}(),re=!0),G.l_desc=new R(G.dyn_ltree,W),G.d_desc=new R(G.dyn_dtree,B),G.bl_desc=new R(G.bl_tree,P),G.bi_buf=0,G.bi_valid=0,ie(G)},a._tr_stored_block=X,a._tr_flush_block=function(G,ce,J,ue){var me,te,oe=0;0<G.level?(G.strm.data_type===2&&(G.strm.data_type=function(ge){var ye,Ce=4093624447;for(ye=0;ye<=31;ye++,Ce>>>=1)if(1&Ce&&ge.dyn_ltree[2*ye]!==0)return s;if(ge.dyn_ltree[18]!==0||ge.dyn_ltree[20]!==0||ge.dyn_ltree[26]!==0)return l;for(ye=32;ye<f;ye++)if(ge.dyn_ltree[2*ye]!==0)return l;return s}(G)),ne(G,G.l_desc),ne(G,G.d_desc),oe=function(ge){var ye;for(U(ge,ge.dyn_ltree,ge.l_desc.max_code),U(ge,ge.dyn_dtree,ge.d_desc.max_code),ne(ge,ge.bl_desc),ye=x-1;3<=ye&&ge.bl_tree[2*E[ye]+1]===0;ye--);return ge.opt_len+=3*(ye+1)+5+5+4,ye}(G),me=G.opt_len+3+7>>>3,(te=G.static_len+3+7>>>3)<=me&&(me=te)):me=te=J+5,J+4<=me&&ce!==-1?X(G,ce,J,ue):G.strategy===4||te===me?(z(G,2+(ue?1:0),3),H(G,A,T)):(z(G,4+(ue?1:0),3),function(ge,ye,Ce,Ie){var rt;for(z(ge,ye-257,5),z(ge,Ce-1,5),z(ge,Ie-4,4),rt=0;rt<Ie;rt++)z(ge,ge.bl_tree[2*E[rt]+1],3);le(ge,ge.dyn_ltree,ye-1),le(ge,ge.dyn_dtree,Ce-1)}(G,G.l_desc.max_code+1,G.d_desc.max_code+1,oe+1),H(G,G.dyn_ltree,G.dyn_dtree)),ie(G),ue&&ee(G)},a._tr_tally=function(G,ce,J){return G.pending_buf[G.d_buf+2*G.last_lit]=ce>>>8&255,G.pending_buf[G.d_buf+2*G.last_lit+1]=255&ce,G.pending_buf[G.l_buf+G.last_lit]=255&J,G.last_lit++,ce===0?G.dyn_ltree[2*J]++:(G.matches++,ce--,G.dyn_ltree[2*(O[J]+f+1)]++,G.dyn_dtree[2*C(ce)]++),G.last_lit===G.lit_bufsize-1},a._tr_align=function(G){z(G,2,3),q(G,b,A),function(ce){ce.bi_valid===16?(k(ce,ce.bi_buf),ce.bi_buf=0,ce.bi_valid=0):8<=ce.bi_valid&&(ce.pending_buf[ce.pending++]=255&ce.bi_buf,ce.bi_buf>>=8,ce.bi_valid-=8)}(G)}},{"../utils/common":41}],53:[function(r,n,a){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,n,a){(function(i){(function(s,l){if(!s.setImmediate){var c,u,d,f,h=1,m={},x=!1,p=s.document,g=Object.getPrototypeOf&&Object.getPrototypeOf(s);g=g&&g.setTimeout?g:s,c={}.toString.call(s.process)==="[object process]"?function(w){process.nextTick(function(){y(w)})}:function(){if(s.postMessage&&!s.importScripts){var w=!0,_=s.onmessage;return s.onmessage=function(){w=!1},s.postMessage("","*"),s.onmessage=_,w}}()?(f="setImmediate$"+Math.random()+"$",s.addEventListener?s.addEventListener("message",b,!1):s.attachEvent("onmessage",b),function(w){s.postMessage(f+w,"*")}):s.MessageChannel?((d=new MessageChannel).port1.onmessage=function(w){y(w.data)},function(w){d.port2.postMessage(w)}):p&&"onreadystatechange"in p.createElement("script")?(u=p.documentElement,function(w){var _=p.createElement("script");_.onreadystatechange=function(){y(w),_.onreadystatechange=null,u.removeChild(_),_=null},u.appendChild(_)}):function(w){setTimeout(y,0,w)},g.setImmediate=function(w){typeof w!="function"&&(w=new Function(""+w));for(var _=new Array(arguments.length-1),D=0;D<_.length;D++)_[D]=arguments[D+1];var j={callback:w,args:_};return m[h]=j,c(h),h++},g.clearImmediate=v}function v(w){delete m[w]}function y(w){if(x)setTimeout(y,0,w);else{var _=m[w];if(_){x=!0;try{(function(D){var j=D.callback,N=D.args;switch(N.length){case 0:j();break;case 1:j(N[0]);break;case 2:j(N[0],N[1]);break;case 3:j(N[0],N[1],N[2]);break;default:j.apply(l,N)}})(_)}finally{v(w),x=!1}}}}function b(w){w.source===s&&typeof w.data=="string"&&w.data.indexOf(f)===0&&y(+w.data.slice(f.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof ht<"u"?ht:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(IW);var L$e=IW.exports,B$e=Wb,W$e=L$e;mx.openArrayBuffer=z$e;mx.splitPath=H$e;mx.joinPath=V$e;function z$e(e){return W$e.loadAsync(e).then(function(t){function r(s){return t.file(s)!==null}function n(s,l){return t.file(s).async("uint8array").then(function(c){if(l==="base64")return B$e.fromByteArray(c);if(l){var u=new TextDecoder(l);return u.decode(c)}else return c})}function a(s,l){t.file(s,l)}function i(){return t.generateAsync({type:"arraybuffer"})}return{exists:r,read:n,write:a,toArrayBuffer:i}})}function H$e(e){var t=e.lastIndexOf("/");return t===-1?{dirname:"",basename:e}:{dirname:e.substring(0,t),basename:e.substring(t+1)}}function V$e(){var e=Array.prototype.filter.call(arguments,function(r){return r}),t=[];return e.forEach(function(r){/^\//.test(r)?t=[r]:t.push(r)}),t.join("/")}var jT={},Go={},Ff={},zb=Xr;Ff.Element=Pf;Ff.element=function(e,t,r){return new Pf(e,t,r)};Ff.text=function(e){return{type:"text",value:e}};var RW=Ff.emptyElement={first:function(){return null},firstOrEmpty:function(){return RW},attributes:{},children:[]};function Pf(e,t,r){this.type="element",this.name=e,this.attributes=t||{},this.children=r||[]}Pf.prototype.first=function(e){return zb.find(this.children,function(t){return t.name===e})};Pf.prototype.firstOrEmpty=function(e){return this.first(e)||RW};Pf.prototype.getElementsByTagName=function(e){var t=zb.filter(this.children,function(r){return r.name===e});return MW(t)};Pf.prototype.text=function(){if(this.children.length===0)return"";if(this.children.length!==1||this.children[0].type!=="text")throw new Error("Not implemented");return this.children[0].value};var q$e={getElementsByTagName:function(e){return MW(zb.flatten(this.map(function(t){return t.getElementsByTagName(e)},!0)))}};function MW(e){return zb.extend(e,q$e)}var UW={},NT={},Hb={},Zs={},Yo={};function G$e(e,t,r){if(r===void 0&&(r=Array.prototype),e&&typeof r.find=="function")return r.find.call(e,t);for(var n=0;n<e.length;n++)if(Object.prototype.hasOwnProperty.call(e,n)){var a=e[n];if(t.call(void 0,a,n,e))return a}}function ST(e,t){return t===void 0&&(t=Object),t&&typeof t.freeze=="function"?t.freeze(e):e}function Y$e(e,t){if(e===null||typeof e!="object")throw new TypeError("target is not an object");for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}var $W=ST({HTML:"text/html",isHTML:function(e){return e===$W.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),LW=ST({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(e){return e===LW.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});Yo.assign=Y$e;Yo.find=G$e;Yo.freeze=ST;Yo.MIME_TYPE=$W;Yo.NAMESPACE=LW;var BW=Yo,$s=BW.find,ip=BW.NAMESPACE;function X$e(e){return e!==""}function K$e(e){return e?e.split(/[\t\n\f\r ]+/).filter(X$e):[]}function Z$e(e,t){return e.hasOwnProperty(t)||(e[t]=!0),e}function y5(e){if(!e)return[];var t=K$e(e);return Object.keys(t.reduce(Z$e,{}))}function J$e(e){return function(t){return e&&e.indexOf(t)!==-1}}function px(e,t){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}function La(e,t){var r=e.prototype;if(!(r instanceof t)){let n=function(){};n.prototype=t.prototype,n=new n,px(r,n),e.prototype=r=n}r.constructor!=e&&(typeof e!="function"&&console.error("unknown Class:"+e),r.constructor=e)}var Ba={},$i=Ba.ELEMENT_NODE=1,Vd=Ba.ATTRIBUTE_NODE=2,jv=Ba.TEXT_NODE=3,WW=Ba.CDATA_SECTION_NODE=4,zW=Ba.ENTITY_REFERENCE_NODE=5,Q$e=Ba.ENTITY_NODE=6,HW=Ba.PROCESSING_INSTRUCTION_NODE=7,VW=Ba.COMMENT_NODE=8,qW=Ba.DOCUMENT_NODE=9,GW=Ba.DOCUMENT_TYPE_NODE=10,Mo=Ba.DOCUMENT_FRAGMENT_NODE=11,eLe=Ba.NOTATION_NODE=12,ca={},jn={};ca.INDEX_SIZE_ERR=(jn[1]="Index size error",1);ca.DOMSTRING_SIZE_ERR=(jn[2]="DOMString size error",2);var Sa=ca.HIERARCHY_REQUEST_ERR=(jn[3]="Hierarchy request error",3);ca.WRONG_DOCUMENT_ERR=(jn[4]="Wrong document",4);ca.INVALID_CHARACTER_ERR=(jn[5]="Invalid character",5);ca.NO_DATA_ALLOWED_ERR=(jn[6]="No data allowed",6);ca.NO_MODIFICATION_ALLOWED_ERR=(jn[7]="No modification allowed",7);var YW=ca.NOT_FOUND_ERR=(jn[8]="Not found",8);ca.NOT_SUPPORTED_ERR=(jn[9]="Not supported",9);var b5=ca.INUSE_ATTRIBUTE_ERR=(jn[10]="Attribute in use",10);ca.INVALID_STATE_ERR=(jn[11]="Invalid state",11);ca.SYNTAX_ERR=(jn[12]="Syntax error",12);ca.INVALID_MODIFICATION_ERR=(jn[13]="Invalid modification",13);ca.NAMESPACE_ERR=(jn[14]="Invalid namespace",14);ca.INVALID_ACCESS_ERR=(jn[15]="Invalid access",15);function qr(e,t){if(t instanceof Error)var r=t;else r=this,Error.call(this,jn[e]),this.message=jn[e],Error.captureStackTrace&&Error.captureStackTrace(this,qr);return r.code=e,t&&(this.message=this.message+": "+t),r}qr.prototype=Error.prototype;px(ca,qr);function So(){}So.prototype={length:0,item:function(e){return e>=0&&e<this.length?this[e]:null},toString:function(e,t){for(var r=[],n=0;n<this.length;n++)Yu(this[n],r,e,t);return r.join("")},filter:function(e){return Array.prototype.filter.call(this,e)},indexOf:function(e){return Array.prototype.indexOf.call(this,e)}};function qd(e,t){this._node=e,this._refresh=t,ET(this)}function ET(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!==t){var r=e._refresh(e._node);if(sz(e,"length",r.length),!e.$$length||r.length<e.$$length)for(var n=r.length;n in e;n++)Object.prototype.hasOwnProperty.call(e,n)&&delete e[n];px(r,e),e._inc=t}}qd.prototype.item=function(e){return ET(this),this[e]||null};La(qd,So);function Nv(){}function XW(e,t){for(var r=e.length;r--;)if(e[r]===t)return r}function w5(e,t,r,n){if(n?t[XW(t,n)]=r:t[t.length++]=r,e){r.ownerElement=e;var a=e.ownerDocument;a&&(n&&JW(a,e,n),tLe(a,e,r))}}function _5(e,t,r){var n=XW(t,r);if(n>=0){for(var a=t.length-1;n<a;)t[n]=t[++n];if(t.length=a,e){var i=e.ownerDocument;i&&(JW(i,e,r),r.ownerElement=null)}}else throw new qr(YW,new Error(e.tagName+"@"+r))}Nv.prototype={length:0,item:So.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var r=this[t];if(r.nodeName==e)return r}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new qr(b5);var r=this.getNamedItem(e.nodeName);return w5(this._ownerElement,this,e,r),r},setNamedItemNS:function(e){var t=e.ownerElement,r;if(t&&t!=this._ownerElement)throw new qr(b5);return r=this.getNamedItemNS(e.namespaceURI,e.localName),w5(this._ownerElement,this,e,r),r},removeNamedItem:function(e){var t=this.getNamedItem(e);return _5(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var r=this.getNamedItemNS(e,t);return _5(this._ownerElement,this,r),r},getNamedItemNS:function(e,t){for(var r=this.length;r--;){var n=this[r];if(n.localName==t&&n.namespaceURI==e)return n}return null}};function KW(){}KW.prototype={hasFeature:function(e,t){return!0},createDocument:function(e,t,r){var n=new xx;if(n.implementation=this,n.childNodes=new So,n.doctype=r||null,r&&n.appendChild(r),t){var a=n.createElementNS(e,t);n.appendChild(a)}return n},createDocumentType:function(e,t,r){var n=new Vb;return n.name=e,n.nodeName=e,n.publicId=t||"",n.systemId=r||"",n}};function er(){}er.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return Sv(this,e,t)},replaceChild:function(e,t){Sv(this,e,t,ez),t&&this.removeChild(t)},removeChild:function(e){return QW(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(e){return Nj(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==jv&&e.nodeType==jv?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var r=t._nsMap;if(r){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)&&r[n]===e)return n}t=t.nodeType==Vd?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var r=t._nsMap;if(r&&Object.prototype.hasOwnProperty.call(r,e))return r[e];t=t.nodeType==Vd?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){var t=this.lookupPrefix(e);return t==null}};function ZW(e){return e=="<"&&"&lt;"||e==">"&&"&gt;"||e=="&"&&"&amp;"||e=='"'&&"&quot;"||"&#"+e.charCodeAt()+";"}px(Ba,er);px(Ba,er.prototype);function sp(e,t){if(t(e))return!0;if(e=e.firstChild)do if(sp(e,t))return!0;while(e=e.nextSibling)}function xx(){this.ownerDocument=this}function tLe(e,t,r){e&&e._inc++;var n=r.namespaceURI;n===ip.XMLNS&&(t._nsMap[r.prefix?r.localName:""]=r.value)}function JW(e,t,r,n){e&&e._inc++;var a=r.namespaceURI;a===ip.XMLNS&&delete t._nsMap[r.prefix?r.localName:""]}function TT(e,t,r){if(e&&e._inc){e._inc++;var n=t.childNodes;if(r)n[n.length++]=r;else{for(var a=t.firstChild,i=0;a;)n[i++]=a,a=a.nextSibling;n.length=i,delete n[n.length]}}}function QW(e,t){var r=t.previousSibling,n=t.nextSibling;return r?r.nextSibling=n:e.firstChild=n,n?n.previousSibling=r:e.lastChild=r,t.parentNode=null,t.previousSibling=null,t.nextSibling=null,TT(e.ownerDocument,e),t}function rLe(e){return e&&(e.nodeType===er.DOCUMENT_NODE||e.nodeType===er.DOCUMENT_FRAGMENT_NODE||e.nodeType===er.ELEMENT_NODE)}function nLe(e){return e&&(Ls(e)||kT(e)||Uo(e)||e.nodeType===er.DOCUMENT_FRAGMENT_NODE||e.nodeType===er.COMMENT_NODE||e.nodeType===er.PROCESSING_INSTRUCTION_NODE)}function Uo(e){return e&&e.nodeType===er.DOCUMENT_TYPE_NODE}function Ls(e){return e&&e.nodeType===er.ELEMENT_NODE}function kT(e){return e&&e.nodeType===er.TEXT_NODE}function D5(e,t){var r=e.childNodes||[];if($s(r,Ls)||Uo(t))return!1;var n=$s(r,Uo);return!(t&&n&&r.indexOf(n)>r.indexOf(t))}function j5(e,t){var r=e.childNodes||[];function n(i){return Ls(i)&&i!==t}if($s(r,n))return!1;var a=$s(r,Uo);return!(t&&a&&r.indexOf(a)>r.indexOf(t))}function aLe(e,t,r){if(!rLe(e))throw new qr(Sa,"Unexpected parent node type "+e.nodeType);if(r&&r.parentNode!==e)throw new qr(YW,"child not in parent");if(!nLe(t)||Uo(t)&&e.nodeType!==er.DOCUMENT_NODE)throw new qr(Sa,"Unexpected node type "+t.nodeType+" for parent node type "+e.nodeType)}function iLe(e,t,r){var n=e.childNodes||[],a=t.childNodes||[];if(t.nodeType===er.DOCUMENT_FRAGMENT_NODE){var i=a.filter(Ls);if(i.length>1||$s(a,kT))throw new qr(Sa,"More than one element or text in fragment");if(i.length===1&&!D5(e,r))throw new qr(Sa,"Element in fragment can not be inserted before doctype")}if(Ls(t)&&!D5(e,r))throw new qr(Sa,"Only one element can be added and only after doctype");if(Uo(t)){if($s(n,Uo))throw new qr(Sa,"Only one doctype is allowed");var s=$s(n,Ls);if(r&&n.indexOf(s)<n.indexOf(r))throw new qr(Sa,"Doctype can only be inserted before an element");if(!r&&s)throw new qr(Sa,"Doctype can not be appended since element is present")}}function ez(e,t,r){var n=e.childNodes||[],a=t.childNodes||[];if(t.nodeType===er.DOCUMENT_FRAGMENT_NODE){var i=a.filter(Ls);if(i.length>1||$s(a,kT))throw new qr(Sa,"More than one element or text in fragment");if(i.length===1&&!j5(e,r))throw new qr(Sa,"Element in fragment can not be inserted before doctype")}if(Ls(t)&&!j5(e,r))throw new qr(Sa,"Only one element can be added and only after doctype");if(Uo(t)){if($s(n,function(c){return Uo(c)&&c!==r}))throw new qr(Sa,"Only one doctype is allowed");var s=$s(n,Ls);if(r&&n.indexOf(s)<n.indexOf(r))throw new qr(Sa,"Doctype can only be inserted before an element")}}function Sv(e,t,r,n){aLe(e,t,r),e.nodeType===er.DOCUMENT_NODE&&(n||iLe)(e,t,r);var a=t.parentNode;if(a&&a.removeChild(t),t.nodeType===Mo){var i=t.firstChild;if(i==null)return t;var s=t.lastChild}else i=s=t;var l=r?r.previousSibling:e.lastChild;i.previousSibling=l,s.nextSibling=r,l?l.nextSibling=i:e.firstChild=i,r==null?e.lastChild=s:r.previousSibling=s;do{i.parentNode=e;var c=e.ownerDocument||e;op(i,c)}while(i!==s&&(i=i.nextSibling));return TT(e.ownerDocument||e,e),t.nodeType==Mo&&(t.firstChild=t.lastChild=null),t}function op(e,t){if(e.ownerDocument!==t){if(e.ownerDocument=t,e.nodeType===$i&&e.attributes)for(var r=0;r<e.attributes.length;r++){var n=e.attributes.item(r);n&&(n.ownerDocument=t)}for(var a=e.firstChild;a;)op(a,t),a=a.nextSibling}}function sLe(e,t){t.parentNode&&t.parentNode.removeChild(t),t.parentNode=e,t.previousSibling=e.lastChild,t.nextSibling=null,t.previousSibling?t.previousSibling.nextSibling=t:e.firstChild=t,e.lastChild=t,TT(e.ownerDocument,e,t);var r=e.ownerDocument||e;return op(t,r),t}xx.prototype={nodeName:"#document",nodeType:qW,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==Mo){for(var r=e.firstChild;r;){var n=r.nextSibling;this.insertBefore(r,t),r=n}return e}return Sv(this,e,t),op(e,this),this.documentElement===null&&e.nodeType===$i&&(this.documentElement=e),e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),QW(this,e)},replaceChild:function(e,t){Sv(this,e,t,ez),op(e,this),t&&this.removeChild(t),Ls(e)&&(this.documentElement=e)},importNode:function(e,t){return iz(this,e,t)},getElementById:function(e){var t=null;return sp(this.documentElement,function(r){if(r.nodeType==$i&&r.getAttribute("id")==e)return t=r,!0}),t},getElementsByClassName:function(e){var t=y5(e);return new qd(this,function(r){var n=[];return t.length>0&&sp(r.documentElement,function(a){if(a!==r&&a.nodeType===$i){var i=a.getAttribute("class");if(i){var s=e===i;if(!s){var l=y5(i);s=t.every(J$e(l))}s&&n.push(a)}}}),n})},createElement:function(e){var t=new Xc;t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.localName=e,t.childNodes=new So;var r=t.attributes=new Nv;return r._ownerElement=t,t},createDocumentFragment:function(){var e=new qb;return e.ownerDocument=this,e.childNodes=new So,e},createTextNode:function(e){var t=new CT;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new AT;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new OT;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var r=new PT;return r.ownerDocument=this,r.tagName=r.nodeName=r.target=e,r.nodeValue=r.data=t,r},createAttribute:function(e){var t=new Ev;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new FT;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var r=new Xc,n=t.split(":"),a=r.attributes=new Nv;return r.childNodes=new So,r.ownerDocument=this,r.nodeName=t,r.tagName=t,r.namespaceURI=e,n.length==2?(r.prefix=n[0],r.localName=n[1]):r.localName=t,a._ownerElement=r,r},createAttributeNS:function(e,t){var r=new Ev,n=t.split(":");return r.ownerDocument=this,r.nodeName=t,r.name=t,r.namespaceURI=e,r.specified=!0,n.length==2?(r.prefix=n[0],r.localName=n[1]):r.localName=t,r}};La(xx,er);function Xc(){this._nsMap={}}Xc.prototype={nodeType:$i,hasAttribute:function(e){return this.getAttributeNode(e)!=null},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var r=this.ownerDocument.createAttribute(e);r.value=r.nodeValue=""+t,this.setAttributeNode(r)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===Mo?this.insertBefore(e,null):sLe(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var r=this.getAttributeNodeNS(e,t);r&&this.removeAttributeNode(r)},hasAttributeNS:function(e,t){return this.getAttributeNodeNS(e,t)!=null},getAttributeNS:function(e,t){var r=this.getAttributeNodeNS(e,t);return r&&r.value||""},setAttributeNS:function(e,t,r){var n=this.ownerDocument.createAttributeNS(e,t);n.value=n.nodeValue=""+r,this.setAttributeNode(n)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new qd(this,function(t){var r=[];return sp(t,function(n){n!==t&&n.nodeType==$i&&(e==="*"||n.tagName==e)&&r.push(n)}),r})},getElementsByTagNameNS:function(e,t){return new qd(this,function(r){var n=[];return sp(r,function(a){a!==r&&a.nodeType===$i&&(e==="*"||a.namespaceURI===e)&&(t==="*"||a.localName==t)&&n.push(a)}),n})}};xx.prototype.getElementsByTagName=Xc.prototype.getElementsByTagName;xx.prototype.getElementsByTagNameNS=Xc.prototype.getElementsByTagNameNS;La(Xc,er);function Ev(){}Ev.prototype.nodeType=Vd;La(Ev,er);function gx(){}gx.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(jn[Sa])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,r){var n=this.data.substring(0,e),a=this.data.substring(e+t);r=n+r+a,this.nodeValue=this.data=r,this.length=r.length}};La(gx,er);function CT(){}CT.prototype={nodeName:"#text",nodeType:jv,splitText:function(e){var t=this.data,r=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var n=this.ownerDocument.createTextNode(r);return this.parentNode&&this.parentNode.insertBefore(n,this.nextSibling),n}};La(CT,gx);function AT(){}AT.prototype={nodeName:"#comment",nodeType:VW};La(AT,gx);function OT(){}OT.prototype={nodeName:"#cdata-section",nodeType:WW};La(OT,gx);function Vb(){}Vb.prototype.nodeType=GW;La(Vb,er);function tz(){}tz.prototype.nodeType=eLe;La(tz,er);function rz(){}rz.prototype.nodeType=Q$e;La(rz,er);function FT(){}FT.prototype.nodeType=zW;La(FT,er);function qb(){}qb.prototype.nodeName="#document-fragment";qb.prototype.nodeType=Mo;La(qb,er);function PT(){}PT.prototype.nodeType=HW;La(PT,er);function nz(){}nz.prototype.serializeToString=function(e,t,r){return az.call(e,t,r)};er.prototype.toString=az;function az(e,t){var r=[],n=this.nodeType==9&&this.documentElement||this,a=n.prefix,i=n.namespaceURI;if(i&&a==null){var a=n.lookupPrefix(i);if(a==null)var s=[{namespace:i,prefix:null}]}return Yu(this,r,e,t,s),r.join("")}function N5(e,t,r){var n=e.prefix||"",a=e.namespaceURI;if(!a||n==="xml"&&a===ip.XML||a===ip.XMLNS)return!1;for(var i=r.length;i--;){var s=r[i];if(s.prefix===n)return s.namespace!==a}return!0}function j2(e,t,r){e.push(" ",t,'="',r.replace(/[<>&"\t\n\r]/g,ZW),'"')}function Yu(e,t,r,n,a){if(a||(a=[]),n)if(e=n(e),e){if(typeof e=="string"){t.push(e);return}}else return;switch(e.nodeType){case $i:var i=e.attributes,s=i.length,v=e.firstChild,l=e.tagName;r=ip.isHTML(e.namespaceURI)||r;var c=l;if(!r&&!e.prefix&&e.namespaceURI){for(var u,d=0;d<i.length;d++)if(i.item(d).name==="xmlns"){u=i.item(d).value;break}if(!u)for(var f=a.length-1;f>=0;f--){var h=a[f];if(h.prefix===""&&h.namespace===e.namespaceURI){u=h.namespace;break}}if(u!==e.namespaceURI)for(var f=a.length-1;f>=0;f--){var h=a[f];if(h.namespace===e.namespaceURI){h.prefix&&(c=h.prefix+":"+l);break}}}t.push("<",c);for(var m=0;m<s;m++){var x=i.item(m);x.prefix=="xmlns"?a.push({prefix:x.localName,namespace:x.value}):x.nodeName=="xmlns"&&a.push({prefix:"",namespace:x.value})}for(var m=0;m<s;m++){var x=i.item(m);if(N5(x,r,a)){var p=x.prefix||"",g=x.namespaceURI;j2(t,p?"xmlns:"+p:"xmlns",g),a.push({prefix:p,namespace:g})}Yu(x,t,r,n,a)}if(l===c&&N5(e,r,a)){var p=e.prefix||"",g=e.namespaceURI;j2(t,p?"xmlns:"+p:"xmlns",g),a.push({prefix:p,namespace:g})}if(v||r&&!/^(?:meta|link|img|br|hr|input)$/i.test(l)){if(t.push(">"),r&&/^script$/i.test(l))for(;v;)v.data?t.push(v.data):Yu(v,t,r,n,a.slice()),v=v.nextSibling;else for(;v;)Yu(v,t,r,n,a.slice()),v=v.nextSibling;t.push("</",c,">")}else t.push("/>");return;case qW:case Mo:for(var v=e.firstChild;v;)Yu(v,t,r,n,a.slice()),v=v.nextSibling;return;case Vd:return j2(t,e.name,e.value);case jv:return t.push(e.data.replace(/[<&>]/g,ZW));case WW:return t.push("<![CDATA[",e.data,"]]>");case VW:return t.push("<!--",e.data,"-->");case GW:var y=e.publicId,b=e.systemId;if(t.push("<!DOCTYPE ",e.name),y)t.push(" PUBLIC ",y),b&&b!="."&&t.push(" ",b),t.push(">");else if(b&&b!=".")t.push(" SYSTEM ",b,">");else{var w=e.internalSubset;w&&t.push(" [",w,"]"),t.push(">")}return;case HW:return t.push("<?",e.target," ",e.data,"?>");case zW:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function iz(e,t,r){var n;switch(t.nodeType){case $i:n=t.cloneNode(!1),n.ownerDocument=e;case Mo:break;case Vd:r=!0;break}if(n||(n=t.cloneNode(!1)),n.ownerDocument=e,n.parentNode=null,r)for(var a=t.firstChild;a;)n.appendChild(iz(e,a,r)),a=a.nextSibling;return n}function Nj(e,t,r){var n=new t.constructor;for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var i=t[a];typeof i!="object"&&i!=n[a]&&(n[a]=i)}switch(t.childNodes&&(n.childNodes=new So),n.ownerDocument=e,n.nodeType){case $i:var s=t.attributes,l=n.attributes=new Nv,c=s.length;l._ownerElement=n;for(var u=0;u<c;u++)n.setAttributeNode(Nj(e,s.item(u),!0));break;case Vd:r=!0}if(r)for(var d=t.firstChild;d;)n.appendChild(Nj(e,d,r)),d=d.nextSibling;return n}function sz(e,t,r){e[t]=r}try{if(Object.defineProperty){let e=function(t){switch(t.nodeType){case $i:case Mo:var r=[];for(t=t.firstChild;t;)t.nodeType!==7&&t.nodeType!==8&&r.push(e(t)),t=t.nextSibling;return r.join("");default:return t.nodeValue}};Object.defineProperty(qd.prototype,"length",{get:function(){return ET(this),this.$$length}}),Object.defineProperty(er.prototype,"textContent",{get:function(){return e(this)},set:function(t){switch(this.nodeType){case $i:case Mo:for(;this.firstChild;)this.removeChild(this.firstChild);(t||String(t))&&this.appendChild(this.ownerDocument.createTextNode(t));break;default:this.data=t,this.value=t,this.nodeValue=t}}}),sz=function(t,r,n){t["$$"+r]=n}}}catch{}Zs.DocumentType=Vb;Zs.DOMException=qr;Zs.DOMImplementation=KW;Zs.Element=Xc;Zs.Node=er;Zs.NodeList=So;Zs.XMLSerializer=nz;var Gb={},oz={};(function(e){var t=Yo.freeze;e.XML_ENTITIES=t({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),e.HTML_ENTITIES=t({Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:"",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",AMP:"&",amp:"&",And:"",and:"",andand:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsd:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",ap:"",apacir:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",Barwed:"",barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",Because:"",because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxDL:"",boxDl:"",boxdL:"",boxdl:"",boxDR:"",boxDr:"",boxdR:"",boxdr:"",boxH:"",boxh:"",boxHD:"",boxHd:"",boxhD:"",boxhd:"",boxHU:"",boxHu:"",boxhU:"",boxhu:"",boxminus:"",boxplus:"",boxtimes:"",boxUL:"",boxUl:"",boxuL:"",boxul:"",boxUR:"",boxUr:"",boxuR:"",boxur:"",boxV:"",boxv:"",boxVH:"",boxVh:"",boxvH:"",boxvh:"",boxVL:"",boxVl:"",boxvL:"",boxvl:"",boxVR:"",boxVr:"",boxvR:"",boxvr:"",bprime:"",Breve:"",breve:"",brvbar:"",Bscr:"",bscr:"",bsemi:"",bsim:"",bsime:"",bsol:"\\",bsolb:"",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",Cap:"",cap:"",capand:"",capbrcup:"",capcap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",CenterDot:"",centerdot:"",Cfr:"",cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",cir:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",Colon:"",colon:":",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",Conint:"",conint:"",ContourIntegral:"",Copf:"",copf:"",coprod:"",Coproduct:"",COPY:"",copy:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",Cross:"",cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",Cup:"",cup:"",cupbrcap:"",CupCap:"",cupcap:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",Dagger:"",dagger:"",daleth:"",Darr:"",dArr:"",darr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",DD:"",dd:"",ddagger:"",ddarr:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",Diamond:"",diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrow:"",Downarrow:"",downarrow:"",DownArrowBar:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVector:"",DownLeftVectorBar:"",DownRightTeeVector:"",DownRightVector:"",DownRightVectorBar:"",DownTee:"",DownTeeArrow:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",ecir:"",Ecirc:"",ecirc:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",eDot:"",edot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp:"",emsp13:"",emsp14:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",Escr:"",escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",ExponentialE:"",exponentiale:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",ForAll:"",forall:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",Fscr:"",fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:"",gdot:"",gE:"",ge:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",ges:"",gescc:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",Gg:"",gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gl:"",gla:"",glE:"",glj:"",gnap:"",gnapprox:"",gnE:"",gne:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",Gt:"",GT:">",gt:">",gtcc:"",gtcir:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",hArr:"",harr:"",harrcir:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",Hfr:"",hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",Hopf:"",hopf:"",horbar:"",HorizontalLine:"",Hscr:"",hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",Ifr:"",ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Im:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",imof:"",imped:"",Implies:"",in:"",incare:"",infin:"",infintie:"",inodot:"",Int:"",int:"",intcal:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",Iscr:"",iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",Lang:"",lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",Larr:"",lArr:"",larr:"",larrb:"",larrbfs:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",lat:"",lAtail:"",latail:"",late:"",lates:"",lBarr:"",lbarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",lE:"",le:"",LeftAngleBracket:"",LeftArrow:"",Leftarrow:"",leftarrow:"",LeftArrowBar:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVector:"",LeftDownVectorBar:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTee:"",LeftTeeArrow:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangle:"",LeftTriangleBar:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVector:"",LeftUpVectorBar:"",LeftVector:"",LeftVectorBar:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",les:"",lescc:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",Ll:"",ll:"",llarr:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoust:"",lmoustache:"",lnap:"",lnapprox:"",lnE:"",lne:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",LongLeftArrow:"",Longleftarrow:"",longleftarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longleftrightarrow:"",longmapsto:"",LongRightArrow:"",Longrightarrow:"",longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",Lscr:"",lscr:"",Lsh:"",lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",Lt:"",LT:"<",lt:"<",ltcc:"",ltcir:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",mid:"",midast:"*",midcir:"",middot:"",minus:"",minusb:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",Mscr:"",mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natur:"",natural:"",naturals:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",ne:"",nearhk:"",neArr:"",nearr:"",nearrow:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:`
`,nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nhArr:"",nharr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlArr:"",nlarr:"",nldr:"",nlE:"",nle:"",nLeftarrow:"",nleftarrow:"",nLeftrightarrow:"",nleftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",Nopf:"",nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangle:"",NotLeftTriangleBar:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangle:"",NotRightTriangleBar:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",npar:"",nparallel:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",npre:"",nprec:"",npreceq:"",nrArr:"",nrarr:"",nrarrc:"",nrarrw:"",nRightarrow:"",nrightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nVDash:"",nVdash:"",nvDash:"",nvdash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwArr:"",nwarr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",ocir:"",Ocirc:"",ocirc:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",Or:"",or:"",orarr:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",Otimes:"",otimes:"",otimesas:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",par:"",para:"",parallel:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:"",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plus:"+",plusacir:"",plusb:"",pluscir:"",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",Popf:"",popf:"",pound:"",Pr:"",pr:"",prap:"",prcue:"",prE:"",pre:"",prec:"",precapprox:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",precsim:"",Prime:"",prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportion:"",Proportional:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",Qopf:"",qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",QUOT:'"',quot:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",Rang:"",rang:"",rangd:"",range:"",rangle:"",raquo:"",Rarr:"",rArr:"",rarr:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",rAtail:"",ratail:"",ratio:"",rationals:"",RBarr:"",rBarr:"",rbarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:"",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",Re:"",real:"",realine:"",realpart:"",reals:"",rect:"",REG:"",reg:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",Rfr:"",rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrow:"",Rightarrow:"",rightarrow:"",RightArrowBar:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVector:"",RightDownVectorBar:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTee:"",RightTeeArrow:"",RightTeeVector:"",rightthreetimes:"",RightTriangle:"",RightTriangleBar:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVector:"",RightUpVectorBar:"",RightVector:"",RightVectorBar:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoust:"",rmoustache:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",Ropf:"",ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",Rscr:"",rscr:"",Rsh:"",rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",Sc:"",sc:"",scap:"",Scaron:"",scaron:"",sccue:"",scE:"",sce:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdot:"",sdotb:"",sdote:"",searhk:"",seArr:"",searr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",sol:"/",solb:"",solbar:"",Sopf:"",sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",squ:"",Square:"",square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",Sub:"",sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",Subset:"",subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succ:"",succapprox:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",Sum:"",sum:"",sung:"",Sup:"",sup:"",sup1:"",sup2:"",sup3:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",Supset:"",supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swArr:"",swarr:"",swarrow:"",swnwar:"",szlig:"",Tab:"	",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",Therefore:"",therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",thinsp:"",ThinSpace:"",thkap:"",thksim:"",THORN:"",thorn:"",Tilde:"",tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",times:"",timesb:"",timesbar:"",timesd:"",tint:"",toea:"",top:"",topbot:"",topcir:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",TRADE:"",trade:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",Uacute:"",uacute:"",Uarr:"",uArr:"",uarr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrow:"",Uparrow:"",uparrow:"",UpArrowBar:"",UpArrowDownArrow:"",UpDownArrow:"",Updownarrow:"",updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",Upsi:"",upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTee:"",UpTeeArrow:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",vArr:"",varr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",Vbar:"",vBar:"",vBarv:"",Vcy:"",vcy:"",VDash:"",Vdash:"",vDash:"",vdash:"",Vdashl:"",Vee:"",vee:"",veebar:"",veeeq:"",vellip:"",Verbar:"",verbar:"|",Vert:"",vert:"|",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",Wedge:"",wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xhArr:"",xharr:"",Xi:"",xi:"",xlArr:"",xlarr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrArr:"",xrarr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",Yuml:"",yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",Zfr:"",zfr:"",ZHcy:"",zhcy:"",zigrarr:"",Zopf:"",zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""}),e.entityMap=e.HTML_ENTITIES})(oz);var IT={},lp=Yo.NAMESPACE,Sj=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,S5=new RegExp("[\\-\\.0-9"+Sj.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),E5=new RegExp("^"+Sj.source+S5.source+"*(?::"+Sj.source+S5.source+"*)?$"),lh=0,Qo=1,Au=2,ch=3,Ou=4,Fu=5,uh=6,f0=7;function Gd(e,t){this.message=e,this.locator=t,Error.captureStackTrace&&Error.captureStackTrace(this,Gd)}Gd.prototype=new Error;Gd.prototype.name=Gd.name;function lz(){}lz.prototype={parse:function(e,t,r){var n=this.domBuilder;n.startDocument(),cz(t,t={}),oLe(e,t,r,n,this.errorHandler),n.endDocument()}};function oLe(e,t,r,n,a){function i(W){if(W>65535){W-=65536;var B=55296+(W>>10),P=56320+(W&1023);return String.fromCharCode(B,P)}else return String.fromCharCode(W)}function s(W){var B=W.slice(1,-1);return Object.hasOwnProperty.call(r,B)?r[B]:B.charAt(0)==="#"?i(parseInt(B.substr(1).replace("x","0x"))):(a.error("entity not found:"+W),W)}function l(W){if(W>p){var B=e.substring(p,W).replace(/&#?\w+;/g,s);h&&c(p),n.characters(B,0,W-p),p=W}}function c(W,B){for(;W>=d&&(B=f.exec(e));)u=B.index,d=u+B[0].length,h.lineNumber++;h.columnNumber=W-u+1}for(var u=0,d=0,f=/.*(?:\r\n?|\n)|.*$/g,h=n.locator,m=[{currentNSMap:t}],x={},p=0;;){try{var g=e.indexOf("<",p);if(g<0){if(!e.substr(p).match(/^\s*$/)){var v=n.doc,y=v.createTextNode(e.substr(p));v.appendChild(y),n.currentElement=y}return}switch(g>p&&l(g),e.charAt(g+1)){case"/":var A=e.indexOf(">",g+3),b=e.substring(g+2,A).replace(/[ \t\n\r]+$/g,""),w=m.pop();A<0?(b=e.substring(g+2).replace(/[\s<].*/,""),a.error("end tag name: "+b+" is not complete:"+w.tagName),A=g+1+b.length):b.match(/\s</)&&(b=b.replace(/[\s<].*/,""),a.error("end tag name: "+b+" maybe not complete"),A=g+1+b.length);var _=w.localNSMap,D=w.tagName==b,j=D||w.tagName&&w.tagName.toLowerCase()==b.toLowerCase();if(j){if(n.endElement(w.uri,w.localName,b),_)for(var N in _)Object.prototype.hasOwnProperty.call(_,N)&&n.endPrefixMapping(N);D||a.fatalError("end tag name: "+b+" is not match the current start tagName:"+w.tagName)}else m.push(w);A++;break;case"?":h&&c(g),A=fLe(e,g,n);break;case"!":h&&c(g),A=dLe(e,g,n,a);break;default:h&&c(g);var S=new uz,E=m[m.length-1].currentNSMap,A=lLe(e,g,S,E,s,a),T=S.length;if(!S.closed&&uLe(e,A,S.tagName,x)&&(S.closed=!0,r.nbsp||a.warning("unclosed xml attribute")),h&&T){for(var L=T5(h,{}),O=0;O<T;O++){var V=S[O];c(V.offset),V.locator=T5(h,{})}n.locator=L,k5(S,n,E)&&m.push(S),n.locator=h}else k5(S,n,E)&&m.push(S);lp.isHTML(S.uri)&&!S.closed?A=cLe(e,A,S.tagName,s,n):A++}}catch(W){if(W instanceof Gd)throw W;a.error("element parse error: "+W),A=-1}A>p?p=A:l(Math.max(g,p)+1)}}function T5(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function lLe(e,t,r,n,a,i){function s(h,m,x){r.attributeNames.hasOwnProperty(h)&&i.fatalError("Attribute "+h+" redefined"),r.addValue(h,m.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,a),x)}for(var l,c,u=++t,d=lh;;){var f=e.charAt(u);switch(f){case"=":if(d===Qo)l=e.slice(t,u),d=ch;else if(d===Au)d=ch;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(d===ch||d===Qo)if(d===Qo&&(i.warning('attribute value must after "="'),l=e.slice(t,u)),t=u+1,u=e.indexOf(f,t),u>0)c=e.slice(t,u),s(l,c,t-1),d=Fu;else throw new Error("attribute value no end '"+f+"' match");else if(d==Ou)c=e.slice(t,u),s(l,c,t),i.warning('attribute "'+l+'" missed start quot('+f+")!!"),t=u+1,d=Fu;else throw new Error('attribute value must after "="');break;case"/":switch(d){case lh:r.setTagName(e.slice(t,u));case Fu:case uh:case f0:d=f0,r.closed=!0;case Ou:case Qo:break;case Au:r.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return i.error("unexpected end of input"),d==lh&&r.setTagName(e.slice(t,u)),u;case">":switch(d){case lh:r.setTagName(e.slice(t,u));case Fu:case uh:case f0:break;case Ou:case Qo:c=e.slice(t,u),c.slice(-1)==="/"&&(r.closed=!0,c=c.slice(0,-1));case Au:d===Au&&(c=l),d==Ou?(i.warning('attribute "'+c+'" missed quot(")!'),s(l,c,t)):((!lp.isHTML(n[""])||!c.match(/^(?:disabled|checked|selected)$/i))&&i.warning('attribute "'+c+'" missed value!! "'+c+'" instead!!'),s(c,c,t));break;case ch:throw new Error("attribute value missed!!")}return u;case"":f=" ";default:if(f<=" ")switch(d){case lh:r.setTagName(e.slice(t,u)),d=uh;break;case Qo:l=e.slice(t,u),d=Au;break;case Ou:var c=e.slice(t,u);i.warning('attribute "'+c+'" missed quot(")!!'),s(l,c,t);case Fu:d=uh;break}else switch(d){case Au:r.tagName,(!lp.isHTML(n[""])||!l.match(/^(?:disabled|checked|selected)$/i))&&i.warning('attribute "'+l+'" missed value!! "'+l+'" instead2!!'),s(l,l,t),t=u,d=Qo;break;case Fu:i.warning('attribute space is required"'+l+'"!!');case uh:d=Qo,t=u;break;case ch:d=Ou,t=u;break;case f0:throw new Error("elements closed character '/' and '>' must be connected to")}}u++}}function k5(e,t,r){for(var n=e.tagName,a=null,f=e.length;f--;){var i=e[f],s=i.qName,l=i.value,h=s.indexOf(":");if(h>0)var c=i.prefix=s.slice(0,h),u=s.slice(h+1),d=c==="xmlns"&&u;else u=s,c=null,d=s==="xmlns"&&"";i.localName=u,d!==!1&&(a==null&&(a={},cz(r,r={})),r[d]=a[d]=l,i.uri=lp.XMLNS,t.startPrefixMapping(d,l))}for(var f=e.length;f--;){i=e[f];var c=i.prefix;c&&(c==="xml"&&(i.uri=lp.XML),c!=="xmlns"&&(i.uri=r[c||""]))}var h=n.indexOf(":");h>0?(c=e.prefix=n.slice(0,h),u=e.localName=n.slice(h+1)):(c=null,u=e.localName=n);var m=e.uri=r[c||""];if(t.startElement(m,u,n,e),e.closed){if(t.endElement(m,u,n),a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&t.endPrefixMapping(c)}else return e.currentNSMap=r,e.localNSMap=a,!0}function cLe(e,t,r,n,a){if(/^(?:script|textarea)$/i.test(r)){var i=e.indexOf("</"+r+">",t),s=e.substring(t+1,i);if(/[&<]/.test(s))return/^script$/i.test(r)?(a.characters(s,0,s.length),i):(s=s.replace(/&#?\w+;/g,n),a.characters(s,0,s.length),i)}return t+1}function uLe(e,t,r,n){var a=n[r];return a==null&&(a=e.lastIndexOf("</"+r+">"),a<t&&(a=e.lastIndexOf("</"+r)),n[r]=a),a<t}function cz(e,t){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}function dLe(e,t,r,n){var a=e.charAt(t+2);switch(a){case"-":if(e.charAt(t+3)==="-"){var i=e.indexOf("-->",t+4);return i>t?(r.comment(e,t+4,i-t-4),i+3):(n.error("Unclosed comment"),-1)}else return-1;default:if(e.substr(t+3,6)=="CDATA["){var i=e.indexOf("]]>",t+9);return r.startCDATA(),r.characters(e,t+9,i-t-9),r.endCDATA(),i+3}var s=hLe(e,t),l=s.length;if(l>1&&/!doctype/i.test(s[0][0])){var c=s[1][0],u=!1,d=!1;l>3&&(/^public$/i.test(s[2][0])?(u=s[3][0],d=l>4&&s[4][0]):/^system$/i.test(s[2][0])&&(d=s[3][0]));var f=s[l-1];return r.startDTD(c,u,d),r.endDTD(),f.index+f[0].length}}return-1}function fLe(e,t,r){var n=e.indexOf("?>",t);if(n){var a=e.substring(t,n).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return a?(a[0].length,r.processingInstruction(a[1],a[2]),n+2):-1}return-1}function uz(){this.attributeNames={}}uz.prototype={setTagName:function(e){if(!E5.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},addValue:function(e,t,r){if(!E5.test(e))throw new Error("invalid attribute:"+e);this.attributeNames[e]=this.length,this[this.length++]={qName:e,value:t,offset:r}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}};function hLe(e,t){var r,n=[],a=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(a.lastIndex=t,a.exec(e);r=a.exec(e);)if(n.push(r),r[1])return n}IT.XMLReader=lz;IT.ParseError=Gd;var mLe=Yo,pLe=Zs,C5=oz,dz=IT,xLe=pLe.DOMImplementation,A5=mLe.NAMESPACE,gLe=dz.ParseError,vLe=dz.XMLReader;function fz(e){return e.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028]/g,`
`)}function hz(e){this.options=e||{locator:{}}}hz.prototype.parseFromString=function(e,t){var r=this.options,n=new vLe,a=r.domBuilder||new vx,i=r.errorHandler,s=r.locator,l=r.xmlns||{},c=/\/x?html?$/.test(t),u=c?C5.HTML_ENTITIES:C5.XML_ENTITIES;s&&a.setDocumentLocator(s),n.errorHandler=yLe(i,a,s),n.domBuilder=r.domBuilder||a,c&&(l[""]=A5.HTML),l.xml=l.xml||A5.XML;var d=r.normalizeLineEndings||fz;return e&&typeof e=="string"?n.parse(d(e),l,u):n.errorHandler.error("invalid doc source"),a.doc};function yLe(e,t,r){if(!e){if(t instanceof vx)return t;e=t}var n={},a=e instanceof Function;r=r||{};function i(s){var l=e[s];!l&&a&&(l=e.length==2?function(c){e(s,c)}:e),n[s]=l&&function(c){l("[xmldom "+s+"]	"+c+Ej(r))}||function(){}}return i("warning"),i("error"),i("fatalError"),n}function vx(){this.cdata=!1}function Pu(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}vx.prototype={startDocument:function(){this.doc=new xLe().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,r,n){var a=this.doc,i=a.createElementNS(e,r||t),s=n.length;h0(this,i),this.currentElement=i,this.locator&&Pu(this.locator,i);for(var l=0;l<s;l++){var e=n.getURI(l),c=n.getValue(l),r=n.getQName(l),u=a.createAttributeNS(e,r);this.locator&&Pu(n.getLocator(l),u),u.value=u.nodeValue=c,i.setAttributeNode(u)}},endElement:function(e,t,r){var n=this.currentElement;n.tagName,this.currentElement=n.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var r=this.doc.createProcessingInstruction(e,t);this.locator&&Pu(this.locator,r),h0(this,r)},ignorableWhitespace:function(e,t,r){},characters:function(e,t,r){if(e=O5.apply(this,arguments),e){if(this.cdata)var n=this.doc.createCDATASection(e);else var n=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(n):/^\s*$/.test(e)&&this.doc.appendChild(n),this.locator&&Pu(this.locator,n)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,r){e=O5.apply(this,arguments);var n=this.doc.createComment(e);this.locator&&Pu(this.locator,n),h0(this,n)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,r){var n=this.doc.implementation;if(n&&n.createDocumentType){var a=n.createDocumentType(e,t,r);this.locator&&Pu(this.locator,a),h0(this,a),this.doc.doctype=a}},warning:function(e){console.warn("[xmldom warning]	"+e,Ej(this.locator))},error:function(e){console.error("[xmldom error]	"+e,Ej(this.locator))},fatalError:function(e){throw new gLe(e,this.locator)}};function Ej(e){if(e)return`
@`+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function O5(e,t,r){return typeof e=="string"?e.substr(t,r):e.length>=t+r||t?new java.lang.String(e,t,r)+"":e}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){vx.prototype[e]=function(){return null}});function h0(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}Gb.__DOMHandler=vx;Gb.normalizeLineEndings=fz;Gb.DOMParser=hz;var mz=Zs;Hb.DOMImplementation=mz.DOMImplementation;Hb.XMLSerializer=mz.XMLSerializer;Hb.DOMParser=Gb.DOMParser;var bLe=Hb,wLe=Zs;function _Le(e){var t=null,r=new bLe.DOMParser({errorHandler:function(a,i){t={level:a,message:i}}}),n=r.parseFromString(e);if(t===null)return n;throw new Error(t.level+": "+t.message)}NT.parseFromString=_Le;NT.Node=wLe.Node;var N2=Tn,F5=Xr,pz=NT,xz=Ff,DLe=xz.Element;UW.readString=jLe;var P5=pz.Node;function jLe(e,t){t=t||{};try{var r=pz.parseFromString(e,"text/xml")}catch(s){return N2.reject(s)}if(r.documentElement.tagName==="parsererror")return N2.resolve(new Error(r.documentElement.textContent));function n(s){switch(s.nodeType){case P5.ELEMENT_NODE:return a(s);case P5.TEXT_NODE:return xz.text(s.nodeValue)}}function a(s){var l=i(s),c=[];F5.forEach(s.childNodes,function(d){var f=n(d);f&&c.push(f)});var u={};return F5.forEach(s.attributes,function(d){u[i(d)]=d.value}),new DLe(l,u,c)}function i(s){if(s.namespaceURI){var l=t[s.namespaceURI],c;return l?c=l+":":c="{"+s.namespaceURI+"}",c+s.localName}else return s.localName}return N2.resolve(n(r.documentElement))}var gz={},jh={},io={},I5;function Xl(){return I5||(I5=1,(function(){var e,t,r,n,a,i,s,l=[].slice,c={}.hasOwnProperty;e=function(){var u,d,f,h,m,x;if(x=arguments[0],m=2<=arguments.length?l.call(arguments,1):[],a(Object.assign))Object.assign.apply(null,arguments);else for(u=0,f=m.length;u<f;u++)if(h=m[u],h!=null)for(d in h)c.call(h,d)&&(x[d]=h[d]);return x},a=function(u){return!!u&&Object.prototype.toString.call(u)==="[object Function]"},i=function(u){var d;return!!u&&((d=typeof u)=="function"||d==="object")},r=function(u){return a(Array.isArray)?Array.isArray(u):Object.prototype.toString.call(u)==="[object Array]"},n=function(u){var d;if(r(u))return!u.length;for(d in u)if(c.call(u,d))return!1;return!0},s=function(u){var d,f;return i(u)&&(f=Object.getPrototypeOf(u))&&(d=f.constructor)&&typeof d=="function"&&d instanceof d&&Function.prototype.toString.call(d)===Function.prototype.toString.call(Object)},t=function(u){return a(u.valueOf)?u.valueOf():u},io.assign=e,io.isFunction=a,io.isObject=i,io.isArray=r,io.isEmpty=n,io.isPlainObject=s,io.getValue=t}).call(ht)),io}var S2={exports:{}},E2={exports:{}},T2={exports:{}},k2={exports:{}},R5;function vz(){return R5||(R5=1,(function(){k2.exports=function(){function e(t,r,n){if(this.options=t.options,this.stringify=t.stringify,this.parent=t,r==null)throw new Error("Missing attribute name. "+this.debugInfo(r));if(n==null)throw new Error("Missing attribute value. "+this.debugInfo(r));this.name=this.stringify.attName(r),this.value=this.stringify.attValue(n)}return e.prototype.clone=function(){return Object.create(this)},e.prototype.toString=function(t){return this.options.writer.set(t).attribute(this)},e.prototype.debugInfo=function(t){return t=t||this.name,t==null?"parent: <"+this.parent.name+">":"attribute: {"+t+"}, parent: <"+this.parent.name+">"},e}()}).call(ht)),k2.exports}var M5;function Yb(){return M5||(M5=1,(function(){var e,t,r,n,a,i,s=function(c,u){for(var d in u)l.call(u,d)&&(c[d]=u[d]);function f(){this.constructor=c}return f.prototype=u.prototype,c.prototype=new f,c.__super__=u.prototype,c},l={}.hasOwnProperty;i=Xl(),a=i.isObject,n=i.isFunction,r=i.getValue,t=Wa(),e=vz(),T2.exports=function(c){s(u,c);function u(d,f,h){if(u.__super__.constructor.call(this,d),f==null)throw new Error("Missing element name. "+this.debugInfo());this.name=this.stringify.eleName(f),this.attributes={},h!=null&&this.attribute(h),d.isDocument&&(this.isRoot=!0,this.documentObject=d,d.rootObject=this)}return u.prototype.clone=function(){var d,f,h,m;h=Object.create(this),h.isRoot&&(h.documentObject=null),h.attributes={},m=this.attributes;for(f in m)l.call(m,f)&&(d=m[f],h.attributes[f]=d.clone());return h.children=[],this.children.forEach(function(x){var p;return p=x.clone(),p.parent=h,h.children.push(p)}),h},u.prototype.attribute=function(d,f){var h,m;if(d!=null&&(d=r(d)),a(d))for(h in d)l.call(d,h)&&(m=d[h],this.attribute(h,m));else n(f)&&(f=f.apply()),(!this.options.skipNullAttributes||f!=null)&&(this.attributes[d]=new e(this,d,f));return this},u.prototype.removeAttribute=function(d){var f,h,m;if(d==null)throw new Error("Missing attribute name. "+this.debugInfo());if(d=r(d),Array.isArray(d))for(h=0,m=d.length;h<m;h++)f=d[h],delete this.attributes[f];else delete this.attributes[d];return this},u.prototype.toString=function(d){return this.options.writer.set(d).element(this)},u.prototype.att=function(d,f){return this.attribute(d,f)},u.prototype.a=function(d,f){return this.attribute(d,f)},u}(t)}).call(ht)),T2.exports}var C2={exports:{}},U5;function Xb(){return U5||(U5=1,(function(){var e,t=function(n,a){for(var i in a)r.call(a,i)&&(n[i]=a[i]);function s(){this.constructor=n}return s.prototype=a.prototype,n.prototype=new s,n.__super__=a.prototype,n},r={}.hasOwnProperty;e=Wa(),C2.exports=function(n){t(a,n);function a(i,s){if(a.__super__.constructor.call(this,i),s==null)throw new Error("Missing CDATA text. "+this.debugInfo());this.text=this.stringify.cdata(s)}return a.prototype.clone=function(){return Object.create(this)},a.prototype.toString=function(i){return this.options.writer.set(i).cdata(this)},a}(e)}).call(ht)),C2.exports}var A2={exports:{}},$5;function Kb(){return $5||($5=1,(function(){var e,t=function(n,a){for(var i in a)r.call(a,i)&&(n[i]=a[i]);function s(){this.constructor=n}return s.prototype=a.prototype,n.prototype=new s,n.__super__=a.prototype,n},r={}.hasOwnProperty;e=Wa(),A2.exports=function(n){t(a,n);function a(i,s){if(a.__super__.constructor.call(this,i),s==null)throw new Error("Missing comment text. "+this.debugInfo());this.text=this.stringify.comment(s)}return a.prototype.clone=function(){return Object.create(this)},a.prototype.toString=function(i){return this.options.writer.set(i).comment(this)},a}(e)}).call(ht)),A2.exports}var O2={exports:{}},L5;function Zb(){return L5||(L5=1,(function(){var e,t,r=function(a,i){for(var s in i)n.call(i,s)&&(a[s]=i[s]);function l(){this.constructor=a}return l.prototype=i.prototype,a.prototype=new l,a.__super__=i.prototype,a},n={}.hasOwnProperty;t=Xl().isObject,e=Wa(),O2.exports=function(a){r(i,a);function i(s,l,c,u){var d;i.__super__.constructor.call(this,s),t(l)&&(d=l,l=d.version,c=d.encoding,u=d.standalone),l||(l="1.0"),this.version=this.stringify.xmlVersion(l),c!=null&&(this.encoding=this.stringify.xmlEncoding(c)),u!=null&&(this.standalone=this.stringify.xmlStandalone(u))}return i.prototype.toString=function(s){return this.options.writer.set(s).declaration(this)},i}(e)}).call(ht)),O2.exports}var F2={exports:{}},P2={exports:{}},B5;function Jb(){return B5||(B5=1,(function(){var e,t=function(n,a){for(var i in a)r.call(a,i)&&(n[i]=a[i]);function s(){this.constructor=n}return s.prototype=a.prototype,n.prototype=new s,n.__super__=a.prototype,n},r={}.hasOwnProperty;e=Wa(),P2.exports=function(n){t(a,n);function a(i,s,l,c,u,d){if(a.__super__.constructor.call(this,i),s==null)throw new Error("Missing DTD element name. "+this.debugInfo());if(l==null)throw new Error("Missing DTD attribute name. "+this.debugInfo(s));if(!c)throw new Error("Missing DTD attribute type. "+this.debugInfo(s));if(!u)throw new Error("Missing DTD attribute default. "+this.debugInfo(s));if(u.indexOf("#")!==0&&(u="#"+u),!u.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(s));if(d&&!u.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(s));this.elementName=this.stringify.eleName(s),this.attributeName=this.stringify.attName(l),this.attributeType=this.stringify.dtdAttType(c),this.defaultValue=this.stringify.dtdAttDefault(d),this.defaultValueType=u}return a.prototype.toString=function(i){return this.options.writer.set(i).dtdAttList(this)},a}(e)}).call(ht)),P2.exports}var I2={exports:{}},W5;function Qb(){return W5||(W5=1,(function(){var e,t,r=function(a,i){for(var s in i)n.call(i,s)&&(a[s]=i[s]);function l(){this.constructor=a}return l.prototype=i.prototype,a.prototype=new l,a.__super__=i.prototype,a},n={}.hasOwnProperty;t=Xl().isObject,e=Wa(),I2.exports=function(a){r(i,a);function i(s,l,c,u){if(i.__super__.constructor.call(this,s),c==null)throw new Error("Missing DTD entity name. "+this.debugInfo(c));if(u==null)throw new Error("Missing DTD entity value. "+this.debugInfo(c));if(this.pe=!!l,this.name=this.stringify.eleName(c),!t(u))this.value=this.stringify.dtdEntityValue(u);else{if(!u.pubID&&!u.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(c));if(u.pubID&&!u.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(c));if(u.pubID!=null&&(this.pubID=this.stringify.dtdPubID(u.pubID)),u.sysID!=null&&(this.sysID=this.stringify.dtdSysID(u.sysID)),u.nData!=null&&(this.nData=this.stringify.dtdNData(u.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(c))}}return i.prototype.toString=function(s){return this.options.writer.set(s).dtdEntity(this)},i}(e)}).call(ht)),I2.exports}var R2={exports:{}},z5;function e1(){return z5||(z5=1,(function(){var e,t=function(n,a){for(var i in a)r.call(a,i)&&(n[i]=a[i]);function s(){this.constructor=n}return s.prototype=a.prototype,n.prototype=new s,n.__super__=a.prototype,n},r={}.hasOwnProperty;e=Wa(),R2.exports=function(n){t(a,n);function a(i,s,l){if(a.__super__.constructor.call(this,i),s==null)throw new Error("Missing DTD element name. "+this.debugInfo());l||(l="(#PCDATA)"),Array.isArray(l)&&(l="("+l.join(",")+")"),this.name=this.stringify.eleName(s),this.value=this.stringify.dtdElementValue(l)}return a.prototype.toString=function(i){return this.options.writer.set(i).dtdElement(this)},a}(e)}).call(ht)),R2.exports}var M2={exports:{}},H5;function t1(){return H5||(H5=1,(function(){var e,t=function(n,a){for(var i in a)r.call(a,i)&&(n[i]=a[i]);function s(){this.constructor=n}return s.prototype=a.prototype,n.prototype=new s,n.__super__=a.prototype,n},r={}.hasOwnProperty;e=Wa(),M2.exports=function(n){t(a,n);function a(i,s,l){if(a.__super__.constructor.call(this,i),s==null)throw new Error("Missing DTD notation name. "+this.debugInfo(s));if(!l.pubID&&!l.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(s));this.name=this.stringify.eleName(s),l.pubID!=null&&(this.pubID=this.stringify.dtdPubID(l.pubID)),l.sysID!=null&&(this.sysID=this.stringify.dtdSysID(l.sysID))}return a.prototype.toString=function(i){return this.options.writer.set(i).dtdNotation(this)},a}(e)}).call(ht)),M2.exports}var V5;function r1(){return V5||(V5=1,(function(){var e,t,r,n,a,i,s=function(c,u){for(var d in u)l.call(u,d)&&(c[d]=u[d]);function f(){this.constructor=c}return f.prototype=u.prototype,c.prototype=new f,c.__super__=u.prototype,c},l={}.hasOwnProperty;i=Xl().isObject,a=Wa(),e=Jb(),r=Qb(),t=e1(),n=t1(),F2.exports=function(c){s(u,c);function u(d,f,h){var m,x;u.__super__.constructor.call(this,d),this.name="!DOCTYPE",this.documentObject=d,i(f)&&(m=f,f=m.pubID,h=m.sysID),h==null&&(x=[f,h],h=x[0],f=x[1]),f!=null&&(this.pubID=this.stringify.dtdPubID(f)),h!=null&&(this.sysID=this.stringify.dtdSysID(h))}return u.prototype.element=function(d,f){var h;return h=new t(this,d,f),this.children.push(h),this},u.prototype.attList=function(d,f,h,m,x){var p;return p=new e(this,d,f,h,m,x),this.children.push(p),this},u.prototype.entity=function(d,f){var h;return h=new r(this,!1,d,f),this.children.push(h),this},u.prototype.pEntity=function(d,f){var h;return h=new r(this,!0,d,f),this.children.push(h),this},u.prototype.notation=function(d,f){var h;return h=new n(this,d,f),this.children.push(h),this},u.prototype.toString=function(d){return this.options.writer.set(d).docType(this)},u.prototype.ele=function(d,f){return this.element(d,f)},u.prototype.att=function(d,f,h,m,x){return this.attList(d,f,h,m,x)},u.prototype.ent=function(d,f){return this.entity(d,f)},u.prototype.pent=function(d,f){return this.pEntity(d,f)},u.prototype.not=function(d,f){return this.notation(d,f)},u.prototype.up=function(){return this.root()||this.documentObject},u}(a)}).call(ht)),F2.exports}var U2={exports:{}},q5;function n1(){return q5||(q5=1,(function(){var e,t=function(n,a){for(var i in a)r.call(a,i)&&(n[i]=a[i]);function s(){this.constructor=n}return s.prototype=a.prototype,n.prototype=new s,n.__super__=a.prototype,n},r={}.hasOwnProperty;e=Wa(),U2.exports=function(n){t(a,n);function a(i,s){if(a.__super__.constructor.call(this,i),s==null)throw new Error("Missing raw text. "+this.debugInfo());this.value=this.stringify.raw(s)}return a.prototype.clone=function(){return Object.create(this)},a.prototype.toString=function(i){return this.options.writer.set(i).raw(this)},a}(e)}).call(ht)),U2.exports}var $2={exports:{}},G5;function a1(){return G5||(G5=1,(function(){var e,t=function(n,a){for(var i in a)r.call(a,i)&&(n[i]=a[i]);function s(){this.constructor=n}return s.prototype=a.prototype,n.prototype=new s,n.__super__=a.prototype,n},r={}.hasOwnProperty;e=Wa(),$2.exports=function(n){t(a,n);function a(i,s){if(a.__super__.constructor.call(this,i),s==null)throw new Error("Missing element text. "+this.debugInfo());this.value=this.stringify.eleText(s)}return a.prototype.clone=function(){return Object.create(this)},a.prototype.toString=function(i){return this.options.writer.set(i).text(this)},a}(e)}).call(ht)),$2.exports}var L2={exports:{}},Y5;function i1(){return Y5||(Y5=1,(function(){var e,t=function(n,a){for(var i in a)r.call(a,i)&&(n[i]=a[i]);function s(){this.constructor=n}return s.prototype=a.prototype,n.prototype=new s,n.__super__=a.prototype,n},r={}.hasOwnProperty;e=Wa(),L2.exports=function(n){t(a,n);function a(i,s,l){if(a.__super__.constructor.call(this,i),s==null)throw new Error("Missing instruction target. "+this.debugInfo());this.target=this.stringify.insTarget(s),l&&(this.value=this.stringify.insValue(l))}return a.prototype.clone=function(){return Object.create(this)},a.prototype.toString=function(i){return this.options.writer.set(i).processingInstruction(this)},a}(e)}).call(ht)),L2.exports}var B2={exports:{}},X5;function RT(){return X5||(X5=1,(function(){var e,t=function(n,a){for(var i in a)r.call(a,i)&&(n[i]=a[i]);function s(){this.constructor=n}return s.prototype=a.prototype,n.prototype=new s,n.__super__=a.prototype,n},r={}.hasOwnProperty;e=Wa(),B2.exports=function(n){t(a,n);function a(i){a.__super__.constructor.call(this,i),this.isDummy=!0}return a.prototype.clone=function(){return Object.create(this)},a.prototype.toString=function(i){return""},a}(e)}).call(ht)),B2.exports}var K5;function Wa(){return K5||(K5=1,(function(){var e,t,r,n,a,i,s,l,c,u,d,f,h,m,x={}.hasOwnProperty;m=Xl(),h=m.isObject,f=m.isFunction,d=m.isEmpty,u=m.getValue,i=null,e=null,t=null,r=null,n=null,l=null,c=null,s=null,a=null,E2.exports=function(){function p(g){this.parent=g,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.children=[],i||(i=Yb(),e=Xb(),t=Kb(),r=Zb(),n=r1(),l=n1(),c=a1(),s=i1(),a=RT())}return p.prototype.element=function(g,v,y){var b,w,_,D,j,N,S,E,A,T,L;if(N=null,v===null&&y==null&&(A=[{},null],v=A[0],y=A[1]),v==null&&(v={}),v=u(v),h(v)||(T=[v,y],y=T[0],v=T[1]),g!=null&&(g=u(g)),Array.isArray(g))for(_=0,S=g.length;_<S;_++)w=g[_],N=this.element(w);else if(f(g))N=this.element(g.apply());else if(h(g)){for(j in g)if(x.call(g,j))if(L=g[j],f(L)&&(L=L.apply()),h(L)&&d(L)&&(L=null),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&j.indexOf(this.stringify.convertAttKey)===0)N=this.attribute(j.substr(this.stringify.convertAttKey.length),L);else if(!this.options.separateArrayItems&&Array.isArray(L))for(D=0,E=L.length;D<E;D++)w=L[D],b={},b[j]=w,N=this.element(b);else h(L)?(N=this.element(j),N.element(L)):N=this.element(j,L)}else this.options.skipNullNodes&&y===null?N=this.dummy():!this.options.ignoreDecorators&&this.stringify.convertTextKey&&g.indexOf(this.stringify.convertTextKey)===0?N=this.text(y):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&g.indexOf(this.stringify.convertCDataKey)===0?N=this.cdata(y):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&g.indexOf(this.stringify.convertCommentKey)===0?N=this.comment(y):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&g.indexOf(this.stringify.convertRawKey)===0?N=this.raw(y):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&g.indexOf(this.stringify.convertPIKey)===0?N=this.instruction(g.substr(this.stringify.convertPIKey.length),y):N=this.node(g,v,y);if(N==null)throw new Error("Could not create any elements with: "+g+". "+this.debugInfo());return N},p.prototype.insertBefore=function(g,v,y){var b,w,_;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(g));return w=this.parent.children.indexOf(this),_=this.parent.children.splice(w),b=this.parent.element(g,v,y),Array.prototype.push.apply(this.parent.children,_),b},p.prototype.insertAfter=function(g,v,y){var b,w,_;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(g));return w=this.parent.children.indexOf(this),_=this.parent.children.splice(w+1),b=this.parent.element(g,v,y),Array.prototype.push.apply(this.parent.children,_),b},p.prototype.remove=function(){var g;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return g=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[g,g-g+1].concat([])),this.parent},p.prototype.node=function(g,v,y){var b,w;return g!=null&&(g=u(g)),v||(v={}),v=u(v),h(v)||(w=[v,y],y=w[0],v=w[1]),b=new i(this,g,v),y!=null&&b.text(y),this.children.push(b),b},p.prototype.text=function(g){var v;return v=new c(this,g),this.children.push(v),this},p.prototype.cdata=function(g){var v;return v=new e(this,g),this.children.push(v),this},p.prototype.comment=function(g){var v;return v=new t(this,g),this.children.push(v),this},p.prototype.commentBefore=function(g){var v,y;return v=this.parent.children.indexOf(this),y=this.parent.children.splice(v),this.parent.comment(g),Array.prototype.push.apply(this.parent.children,y),this},p.prototype.commentAfter=function(g){var v,y;return v=this.parent.children.indexOf(this),y=this.parent.children.splice(v+1),this.parent.comment(g),Array.prototype.push.apply(this.parent.children,y),this},p.prototype.raw=function(g){var v;return v=new l(this,g),this.children.push(v),this},p.prototype.dummy=function(){var g;return g=new a(this),this.children.push(g),g},p.prototype.instruction=function(g,v){var y,b,w,_,D;if(g!=null&&(g=u(g)),v!=null&&(v=u(v)),Array.isArray(g))for(_=0,D=g.length;_<D;_++)y=g[_],this.instruction(y);else if(h(g))for(y in g)x.call(g,y)&&(b=g[y],this.instruction(y,b));else f(v)&&(v=v.apply()),w=new s(this,g,v),this.children.push(w);return this},p.prototype.instructionBefore=function(g,v){var y,b;return y=this.parent.children.indexOf(this),b=this.parent.children.splice(y),this.parent.instruction(g,v),Array.prototype.push.apply(this.parent.children,b),this},p.prototype.instructionAfter=function(g,v){var y,b;return y=this.parent.children.indexOf(this),b=this.parent.children.splice(y+1),this.parent.instruction(g,v),Array.prototype.push.apply(this.parent.children,b),this},p.prototype.declaration=function(g,v,y){var b,w;return b=this.document(),w=new r(b,g,v,y),b.children[0]instanceof r?b.children[0]=w:b.children.unshift(w),b.root()||b},p.prototype.doctype=function(g,v){var y,b,w,_,D,j,N,S,E,A;for(b=this.document(),w=new n(b,g,v),E=b.children,_=D=0,N=E.length;D<N;_=++D)if(y=E[_],y instanceof n)return b.children[_]=w,w;for(A=b.children,_=j=0,S=A.length;j<S;_=++j)if(y=A[_],y.isRoot)return b.children.splice(_,0,w),w;return b.children.push(w),w},p.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},p.prototype.root=function(){var g;for(g=this;g;){if(g.isDocument)return g.rootObject;if(g.isRoot)return g;g=g.parent}},p.prototype.document=function(){var g;for(g=this;g;){if(g.isDocument)return g;g=g.parent}},p.prototype.end=function(g){return this.document().end(g)},p.prototype.prev=function(){var g;for(g=this.parent.children.indexOf(this);g>0&&this.parent.children[g-1].isDummy;)g=g-1;if(g<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[g-1]},p.prototype.next=function(){var g;for(g=this.parent.children.indexOf(this);g<this.parent.children.length-1&&this.parent.children[g+1].isDummy;)g=g+1;if(g===-1||g===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[g+1]},p.prototype.importDocument=function(g){var v;return v=g.root().clone(),v.parent=this,v.isRoot=!1,this.children.push(v),this},p.prototype.debugInfo=function(g){var v,y;return g=g||this.name,g==null&&!((v=this.parent)!=null&&v.name)?"":g==null?"parent: <"+this.parent.name+">":(y=this.parent)!=null&&y.name?"node: <"+g+">, parent: <"+this.parent.name+">":"node: <"+g+">"},p.prototype.ele=function(g,v,y){return this.element(g,v,y)},p.prototype.nod=function(g,v,y){return this.node(g,v,y)},p.prototype.txt=function(g){return this.text(g)},p.prototype.dat=function(g){return this.cdata(g)},p.prototype.com=function(g){return this.comment(g)},p.prototype.ins=function(g,v){return this.instruction(g,v)},p.prototype.doc=function(){return this.document()},p.prototype.dec=function(g,v,y){return this.declaration(g,v,y)},p.prototype.dtd=function(g,v){return this.doctype(g,v)},p.prototype.e=function(g,v,y){return this.element(g,v,y)},p.prototype.n=function(g,v,y){return this.node(g,v,y)},p.prototype.t=function(g){return this.text(g)},p.prototype.d=function(g){return this.cdata(g)},p.prototype.c=function(g){return this.comment(g)},p.prototype.r=function(g){return this.raw(g)},p.prototype.i=function(g,v){return this.instruction(g,v)},p.prototype.u=function(){return this.up()},p.prototype.importXMLBuilder=function(g){return this.importDocument(g)},p}()}).call(ht)),E2.exports}var W2={exports:{}},Z5;function yz(){return Z5||(Z5=1,(function(){var e=function(r,n){return function(){return r.apply(n,arguments)}},t={}.hasOwnProperty;W2.exports=function(){function r(n){this.assertLegalChar=e(this.assertLegalChar,this);var a,i,s;n||(n={}),this.noDoubleEncoding=n.noDoubleEncoding,i=n.stringify||{};for(a in i)t.call(i,a)&&(s=i[a],this[a]=s)}return r.prototype.eleName=function(n){return n=""+n||"",this.assertLegalChar(n)},r.prototype.eleText=function(n){return n=""+n||"",this.assertLegalChar(this.elEscape(n))},r.prototype.cdata=function(n){return n=""+n||"",n=n.replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(n)},r.prototype.comment=function(n){if(n=""+n||"",n.match(/--/))throw new Error("Comment text cannot contain double-hypen: "+n);return this.assertLegalChar(n)},r.prototype.raw=function(n){return""+n||""},r.prototype.attName=function(n){return n=""+n||""},r.prototype.attValue=function(n){return n=""+n||"",this.attEscape(n)},r.prototype.insTarget=function(n){return""+n||""},r.prototype.insValue=function(n){if(n=""+n||"",n.match(/\?>/))throw new Error("Invalid processing instruction value: "+n);return n},r.prototype.xmlVersion=function(n){if(n=""+n||"",!n.match(/1\.[0-9]+/))throw new Error("Invalid version number: "+n);return n},r.prototype.xmlEncoding=function(n){if(n=""+n||"",!n.match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+n);return n},r.prototype.xmlStandalone=function(n){return n?"yes":"no"},r.prototype.dtdPubID=function(n){return""+n||""},r.prototype.dtdSysID=function(n){return""+n||""},r.prototype.dtdElementValue=function(n){return""+n||""},r.prototype.dtdAttType=function(n){return""+n||""},r.prototype.dtdAttDefault=function(n){return n!=null?""+n||"":n},r.prototype.dtdEntityValue=function(n){return""+n||""},r.prototype.dtdNData=function(n){return""+n||""},r.prototype.convertAttKey="@",r.prototype.convertPIKey="?",r.prototype.convertTextKey="#text",r.prototype.convertCDataKey="#cdata",r.prototype.convertCommentKey="#comment",r.prototype.convertRawKey="#raw",r.prototype.assertLegalChar=function(n){var a;if(a=n.match(/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/),a)throw new Error("Invalid character in string: "+n+" at index "+a.index);return n},r.prototype.elEscape=function(n){var a;return a=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,n.replace(a,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;")},r.prototype.attEscape=function(n){var a;return a=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,n.replace(a,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")},r}()}).call(ht)),W2.exports}var z2={exports:{}},H2={exports:{}},J5;function bz(){return J5||(J5=1,(function(){var e={}.hasOwnProperty;H2.exports=function(){function t(r){var n,a,i,s,l,c,u,d,f;r||(r={}),this.pretty=r.pretty||!1,this.allowEmpty=(a=r.allowEmpty)!=null?a:!1,this.pretty?(this.indent=(i=r.indent)!=null?i:"  ",this.newline=(s=r.newline)!=null?s:`
`,this.offset=(l=r.offset)!=null?l:0,this.dontprettytextnodes=(c=r.dontprettytextnodes)!=null?c:0):(this.indent="",this.newline="",this.offset=0,this.dontprettytextnodes=0),this.spacebeforeslash=(u=r.spacebeforeslash)!=null?u:"",this.spacebeforeslash===!0&&(this.spacebeforeslash=" "),this.newlinedefault=this.newline,this.prettydefault=this.pretty,d=r.writer||{};for(n in d)e.call(d,n)&&(f=d[n],this[n]=f)}return t.prototype.set=function(r){var n,a,i;r||(r={}),"pretty"in r&&(this.pretty=r.pretty),"allowEmpty"in r&&(this.allowEmpty=r.allowEmpty),this.pretty?(this.indent="indent"in r?r.indent:"  ",this.newline="newline"in r?r.newline:`
`,this.offset="offset"in r?r.offset:0,this.dontprettytextnodes="dontprettytextnodes"in r?r.dontprettytextnodes:0):(this.indent="",this.newline="",this.offset=0,this.dontprettytextnodes=0),this.spacebeforeslash="spacebeforeslash"in r?r.spacebeforeslash:"",this.spacebeforeslash===!0&&(this.spacebeforeslash=" "),this.newlinedefault=this.newline,this.prettydefault=this.pretty,a=r.writer||{};for(n in a)e.call(a,n)&&(i=a[n],this[n]=i);return this},t.prototype.space=function(r){var n;return this.pretty?(n=(r||0)+this.offset+1,n>0?new Array(n).join(this.indent):""):""},t}()}).call(ht)),H2.exports}var Q5;function MT(){return Q5||(Q5=1,(function(){var e,t,r,n,a,i,s,l,c,u,d,f,h,m,x=function(g,v){for(var y in v)p.call(v,y)&&(g[y]=v[y]);function b(){this.constructor=g}return b.prototype=v.prototype,g.prototype=new b,g.__super__=v.prototype,g},p={}.hasOwnProperty;s=Zb(),l=r1(),e=Xb(),t=Kb(),u=Yb(),f=n1(),h=a1(),d=i1(),c=RT(),r=Jb(),n=e1(),a=Qb(),i=t1(),m=bz(),z2.exports=function(g){x(v,g);function v(y){v.__super__.constructor.call(this,y)}return v.prototype.document=function(y){var b,w,_,D,j;for(this.textispresent=!1,D="",j=y.children,w=0,_=j.length;w<_;w++)b=j[w],!(b instanceof c)&&(D+=(function(){switch(!1){case!(b instanceof s):return this.declaration(b);case!(b instanceof l):return this.docType(b);case!(b instanceof t):return this.comment(b);case!(b instanceof d):return this.processingInstruction(b);default:return this.element(b,0)}}).call(this));return this.pretty&&D.slice(-this.newline.length)===this.newline&&(D=D.slice(0,-this.newline.length)),D},v.prototype.attribute=function(y){return" "+y.name+'="'+y.value+'"'},v.prototype.cdata=function(y,b){return this.space(b)+"<![CDATA["+y.text+"]]>"+this.newline},v.prototype.comment=function(y,b){return this.space(b)+"<!-- "+y.text+" -->"+this.newline},v.prototype.declaration=function(y,b){var w;return w=this.space(b),w+='<?xml version="'+y.version+'"',y.encoding!=null&&(w+=' encoding="'+y.encoding+'"'),y.standalone!=null&&(w+=' standalone="'+y.standalone+'"'),w+=this.spacebeforeslash+"?>",w+=this.newline,w},v.prototype.docType=function(y,b){var w,_,D,j,N;if(b||(b=0),j=this.space(b),j+="<!DOCTYPE "+y.root().name,y.pubID&&y.sysID?j+=' PUBLIC "'+y.pubID+'" "'+y.sysID+'"':y.sysID&&(j+=' SYSTEM "'+y.sysID+'"'),y.children.length>0){for(j+=" [",j+=this.newline,N=y.children,_=0,D=N.length;_<D;_++)w=N[_],j+=(function(){switch(!1){case!(w instanceof r):return this.dtdAttList(w,b+1);case!(w instanceof n):return this.dtdElement(w,b+1);case!(w instanceof a):return this.dtdEntity(w,b+1);case!(w instanceof i):return this.dtdNotation(w,b+1);case!(w instanceof e):return this.cdata(w,b+1);case!(w instanceof t):return this.comment(w,b+1);case!(w instanceof d):return this.processingInstruction(w,b+1);default:throw new Error("Unknown DTD node type: "+w.constructor.name)}}).call(this);j+="]"}return j+=this.spacebeforeslash+">",j+=this.newline,j},v.prototype.element=function(y,b){var w,_,D,j,N,S,E,A,T,L,O,V,W;b||(b=0),W=!1,this.textispresent?(this.newline="",this.pretty=!1):(this.newline=this.newlinedefault,this.pretty=this.prettydefault),V=this.space(b),A="",A+=V+"<"+y.name,T=y.attributes;for(E in T)p.call(T,E)&&(w=T[E],A+=this.attribute(w));if(y.children.length===0||y.children.every(function(B){return B.value===""}))this.allowEmpty?A+="></"+y.name+">"+this.newline:A+=this.spacebeforeslash+"/>"+this.newline;else if(this.pretty&&y.children.length===1&&y.children[0].value!=null)A+=">",A+=y.children[0].value,A+="</"+y.name+">"+this.newline;else{if(this.dontprettytextnodes){for(L=y.children,D=0,N=L.length;D<N;D++)if(_=L[D],_.value!=null){this.textispresent++,W=!0;break}}for(this.textispresent&&(this.newline="",this.pretty=!1,V=this.space(b)),A+=">"+this.newline,O=y.children,j=0,S=O.length;j<S;j++)_=O[j],A+=(function(){switch(!1){case!(_ instanceof e):return this.cdata(_,b+1);case!(_ instanceof t):return this.comment(_,b+1);case!(_ instanceof u):return this.element(_,b+1);case!(_ instanceof f):return this.raw(_,b+1);case!(_ instanceof h):return this.text(_,b+1);case!(_ instanceof d):return this.processingInstruction(_,b+1);case!(_ instanceof c):return"";default:throw new Error("Unknown XML node type: "+_.constructor.name)}}).call(this);W&&this.textispresent--,this.textispresent||(this.newline=this.newlinedefault,this.pretty=this.prettydefault),A+=V+"</"+y.name+">"+this.newline}return A},v.prototype.processingInstruction=function(y,b){var w;return w=this.space(b)+"<?"+y.target,y.value&&(w+=" "+y.value),w+=this.spacebeforeslash+"?>"+this.newline,w},v.prototype.raw=function(y,b){return this.space(b)+y.value+this.newline},v.prototype.text=function(y,b){return this.space(b)+y.value+this.newline},v.prototype.dtdAttList=function(y,b){var w;return w=this.space(b)+"<!ATTLIST "+y.elementName+" "+y.attributeName+" "+y.attributeType,y.defaultValueType!=="#DEFAULT"&&(w+=" "+y.defaultValueType),y.defaultValue&&(w+=' "'+y.defaultValue+'"'),w+=this.spacebeforeslash+">"+this.newline,w},v.prototype.dtdElement=function(y,b){return this.space(b)+"<!ELEMENT "+y.name+" "+y.value+this.spacebeforeslash+">"+this.newline},v.prototype.dtdEntity=function(y,b){var w;return w=this.space(b)+"<!ENTITY",y.pe&&(w+=" %"),w+=" "+y.name,y.value?w+=' "'+y.value+'"':(y.pubID&&y.sysID?w+=' PUBLIC "'+y.pubID+'" "'+y.sysID+'"':y.sysID&&(w+=' SYSTEM "'+y.sysID+'"'),y.nData&&(w+=" NDATA "+y.nData)),w+=this.spacebeforeslash+">"+this.newline,w},v.prototype.dtdNotation=function(y,b){var w;return w=this.space(b)+"<!NOTATION "+y.name,y.pubID&&y.sysID?w+=' PUBLIC "'+y.pubID+'" "'+y.sysID+'"':y.pubID?w+=' PUBLIC "'+y.pubID+'"':y.sysID&&(w+=' SYSTEM "'+y.sysID+'"'),w+=this.spacebeforeslash+">"+this.newline,w},v.prototype.openNode=function(y,b){var w,_,D,j;if(b||(b=0),y instanceof u){D=this.space(b)+"<"+y.name,j=y.attributes;for(_ in j)p.call(j,_)&&(w=j[_],D+=this.attribute(w));return D+=(y.children?">":"/>")+this.newline,D}else return D=this.space(b)+"<!DOCTYPE "+y.rootNodeName,y.pubID&&y.sysID?D+=' PUBLIC "'+y.pubID+'" "'+y.sysID+'"':y.sysID&&(D+=' SYSTEM "'+y.sysID+'"'),D+=(y.children?" [":">")+this.newline,D},v.prototype.closeNode=function(y,b){switch(b||(b=0),!1){case!(y instanceof u):return this.space(b)+"</"+y.name+">"+this.newline;case!(y instanceof l):return this.space(b)+"]>"+this.newline}},v}(m)}).call(ht)),z2.exports}var e6;function NLe(){return e6||(e6=1,(function(){var e,t,r,n,a=function(s,l){for(var c in l)i.call(l,c)&&(s[c]=l[c]);function u(){this.constructor=s}return u.prototype=l.prototype,s.prototype=new u,s.__super__=l.prototype,s},i={}.hasOwnProperty;n=Xl().isPlainObject,e=Wa(),r=yz(),t=MT(),S2.exports=function(s){a(l,s);function l(c){l.__super__.constructor.call(this,null),this.name="?xml",c||(c={}),c.writer||(c.writer=new t),this.options=c,this.stringify=new r(c),this.isDocument=!0}return l.prototype.end=function(c){var u;return c?n(c)&&(u=c,c=this.options.writer.set(u)):c=this.options.writer,c.document(this)},l.prototype.toString=function(c){return this.options.writer.set(c).document(this)},l}(e)}).call(ht)),S2.exports}var V2={exports:{}},t6;function SLe(){return t6||(t6=1,(function(){var e,t,r,n,a,i,s,l,c,u,d,f,h,m,x,p,g,v,y,b,w={}.hasOwnProperty;b=Xl(),v=b.isObject,g=b.isFunction,y=b.isPlainObject,p=b.getValue,u=Yb(),t=Xb(),r=Kb(),f=n1(),x=a1(),d=i1(),l=Zb(),c=r1(),n=Jb(),i=Qb(),a=e1(),s=t1(),e=vz(),m=yz(),h=MT(),V2.exports=function(){function _(D,j,N){var S;this.name="?xml",D||(D={}),D.writer?y(D.writer)&&(S=D.writer,D.writer=new h(S)):D.writer=new h(D),this.options=D,this.writer=D.writer,this.stringify=new m(D),this.onDataCallback=j||function(){},this.onEndCallback=N||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return _.prototype.node=function(D,j,N){var S,E;if(D==null)throw new Error("Missing node name.");if(this.root&&this.currentLevel===-1)throw new Error("Document can only have one root node. "+this.debugInfo(D));return this.openCurrent(),D=p(D),j===null&&N==null&&(S=[{},null],j=S[0],N=S[1]),j==null&&(j={}),j=p(j),v(j)||(E=[j,N],N=E[0],j=E[1]),this.currentNode=new u(this,D,j),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,N!=null&&this.text(N),this},_.prototype.element=function(D,j,N){return this.currentNode&&this.currentNode instanceof c?this.dtdElement.apply(this,arguments):this.node(D,j,N)},_.prototype.attribute=function(D,j){var N,S;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(D));if(D!=null&&(D=p(D)),v(D))for(N in D)w.call(D,N)&&(S=D[N],this.attribute(N,S));else g(j)&&(j=j.apply()),(!this.options.skipNullAttributes||j!=null)&&(this.currentNode.attributes[D]=new e(this,D,j));return this},_.prototype.text=function(D){var j;return this.openCurrent(),j=new x(this,D),this.onData(this.writer.text(j,this.currentLevel+1),this.currentLevel+1),this},_.prototype.cdata=function(D){var j;return this.openCurrent(),j=new t(this,D),this.onData(this.writer.cdata(j,this.currentLevel+1),this.currentLevel+1),this},_.prototype.comment=function(D){var j;return this.openCurrent(),j=new r(this,D),this.onData(this.writer.comment(j,this.currentLevel+1),this.currentLevel+1),this},_.prototype.raw=function(D){var j;return this.openCurrent(),j=new f(this,D),this.onData(this.writer.raw(j,this.currentLevel+1),this.currentLevel+1),this},_.prototype.instruction=function(D,j){var N,S,E,A,T;if(this.openCurrent(),D!=null&&(D=p(D)),j!=null&&(j=p(j)),Array.isArray(D))for(N=0,A=D.length;N<A;N++)S=D[N],this.instruction(S);else if(v(D))for(S in D)w.call(D,S)&&(E=D[S],this.instruction(S,E));else g(j)&&(j=j.apply()),T=new d(this,D,j),this.onData(this.writer.processingInstruction(T,this.currentLevel+1),this.currentLevel+1);return this},_.prototype.declaration=function(D,j,N){var S;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return S=new l(this,D,j,N),this.onData(this.writer.declaration(S,this.currentLevel+1),this.currentLevel+1),this},_.prototype.doctype=function(D,j,N){if(this.openCurrent(),D==null)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new c(this,j,N),this.currentNode.rootNodeName=D,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},_.prototype.dtdElement=function(D,j){var N;return this.openCurrent(),N=new a(this,D,j),this.onData(this.writer.dtdElement(N,this.currentLevel+1),this.currentLevel+1),this},_.prototype.attList=function(D,j,N,S,E){var A;return this.openCurrent(),A=new n(this,D,j,N,S,E),this.onData(this.writer.dtdAttList(A,this.currentLevel+1),this.currentLevel+1),this},_.prototype.entity=function(D,j){var N;return this.openCurrent(),N=new i(this,!1,D,j),this.onData(this.writer.dtdEntity(N,this.currentLevel+1),this.currentLevel+1),this},_.prototype.pEntity=function(D,j){var N;return this.openCurrent(),N=new i(this,!0,D,j),this.onData(this.writer.dtdEntity(N,this.currentLevel+1),this.currentLevel+1),this},_.prototype.notation=function(D,j){var N;return this.openCurrent(),N=new s(this,D,j),this.onData(this.writer.dtdNotation(N,this.currentLevel+1),this.currentLevel+1),this},_.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},_.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},_.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},_.prototype.openNode=function(D){if(!D.isOpen)return!this.root&&this.currentLevel===0&&D instanceof u&&(this.root=D),this.onData(this.writer.openNode(D,this.currentLevel),this.currentLevel),D.isOpen=!0},_.prototype.closeNode=function(D){if(!D.isClosed)return this.onData(this.writer.closeNode(D,this.currentLevel),this.currentLevel),D.isClosed=!0},_.prototype.onData=function(D,j){return this.documentStarted=!0,this.onDataCallback(D,j+1)},_.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},_.prototype.debugInfo=function(D){return D==null?"":"node: <"+D+">"},_.prototype.ele=function(){return this.element.apply(this,arguments)},_.prototype.nod=function(D,j,N){return this.node(D,j,N)},_.prototype.txt=function(D){return this.text(D)},_.prototype.dat=function(D){return this.cdata(D)},_.prototype.com=function(D){return this.comment(D)},_.prototype.ins=function(D,j){return this.instruction(D,j)},_.prototype.dec=function(D,j,N){return this.declaration(D,j,N)},_.prototype.dtd=function(D,j,N){return this.doctype(D,j,N)},_.prototype.e=function(D,j,N){return this.element(D,j,N)},_.prototype.n=function(D,j,N){return this.node(D,j,N)},_.prototype.t=function(D){return this.text(D)},_.prototype.d=function(D){return this.cdata(D)},_.prototype.c=function(D){return this.comment(D)},_.prototype.r=function(D){return this.raw(D)},_.prototype.i=function(D,j){return this.instruction(D,j)},_.prototype.att=function(){return this.currentNode&&this.currentNode instanceof c?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},_.prototype.a=function(){return this.currentNode&&this.currentNode instanceof c?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},_.prototype.ent=function(D,j){return this.entity(D,j)},_.prototype.pent=function(D,j){return this.pEntity(D,j)},_.prototype.not=function(D,j){return this.notation(D,j)},_}()}).call(ht)),V2.exports}var q2={exports:{}},r6;function ELe(){return r6||(r6=1,(function(){var e,t,r,n,a,i,s,l,c,u,d,f,h,m,x=function(g,v){for(var y in v)p.call(v,y)&&(g[y]=v[y]);function b(){this.constructor=g}return b.prototype=v.prototype,g.prototype=new b,g.__super__=v.prototype,g},p={}.hasOwnProperty;s=Zb(),l=r1(),e=Xb(),t=Kb(),u=Yb(),f=n1(),h=a1(),d=i1(),c=RT(),r=Jb(),n=e1(),a=Qb(),i=t1(),m=bz(),q2.exports=function(g){x(v,g);function v(y,b){v.__super__.constructor.call(this,b),this.stream=y}return v.prototype.document=function(y){var b,w,_,D,j,N,S,E;for(N=y.children,w=0,D=N.length;w<D;w++)b=N[w],b.isLastRootNode=!1;for(y.children[y.children.length-1].isLastRootNode=!0,S=y.children,E=[],_=0,j=S.length;_<j;_++)if(b=S[_],!(b instanceof c))switch(!1){case!(b instanceof s):E.push(this.declaration(b));break;case!(b instanceof l):E.push(this.docType(b));break;case!(b instanceof t):E.push(this.comment(b));break;case!(b instanceof d):E.push(this.processingInstruction(b));break;default:E.push(this.element(b))}return E},v.prototype.attribute=function(y){return this.stream.write(" "+y.name+'="'+y.value+'"')},v.prototype.cdata=function(y,b){return this.stream.write(this.space(b)+"<![CDATA["+y.text+"]]>"+this.endline(y))},v.prototype.comment=function(y,b){return this.stream.write(this.space(b)+"<!-- "+y.text+" -->"+this.endline(y))},v.prototype.declaration=function(y,b){return this.stream.write(this.space(b)),this.stream.write('<?xml version="'+y.version+'"'),y.encoding!=null&&this.stream.write(' encoding="'+y.encoding+'"'),y.standalone!=null&&this.stream.write(' standalone="'+y.standalone+'"'),this.stream.write(this.spacebeforeslash+"?>"),this.stream.write(this.endline(y))},v.prototype.docType=function(y,b){var w,_,D,j;if(b||(b=0),this.stream.write(this.space(b)),this.stream.write("<!DOCTYPE "+y.root().name),y.pubID&&y.sysID?this.stream.write(' PUBLIC "'+y.pubID+'" "'+y.sysID+'"'):y.sysID&&this.stream.write(' SYSTEM "'+y.sysID+'"'),y.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(y)),j=y.children,_=0,D=j.length;_<D;_++)switch(w=j[_],!1){case!(w instanceof r):this.dtdAttList(w,b+1);break;case!(w instanceof n):this.dtdElement(w,b+1);break;case!(w instanceof a):this.dtdEntity(w,b+1);break;case!(w instanceof i):this.dtdNotation(w,b+1);break;case!(w instanceof e):this.cdata(w,b+1);break;case!(w instanceof t):this.comment(w,b+1);break;case!(w instanceof d):this.processingInstruction(w,b+1);break;default:throw new Error("Unknown DTD node type: "+w.constructor.name)}this.stream.write("]")}return this.stream.write(this.spacebeforeslash+">"),this.stream.write(this.endline(y))},v.prototype.element=function(y,b){var w,_,D,j,N,S,E,A;b||(b=0),A=this.space(b),this.stream.write(A+"<"+y.name),S=y.attributes;for(N in S)p.call(S,N)&&(w=S[N],this.attribute(w));if(y.children.length===0||y.children.every(function(T){return T.value===""}))this.allowEmpty?this.stream.write("></"+y.name+">"):this.stream.write(this.spacebeforeslash+"/>");else if(this.pretty&&y.children.length===1&&y.children[0].value!=null)this.stream.write(">"),this.stream.write(y.children[0].value),this.stream.write("</"+y.name+">");else{for(this.stream.write(">"+this.newline),E=y.children,D=0,j=E.length;D<j;D++)switch(_=E[D],!1){case!(_ instanceof e):this.cdata(_,b+1);break;case!(_ instanceof t):this.comment(_,b+1);break;case!(_ instanceof u):this.element(_,b+1);break;case!(_ instanceof f):this.raw(_,b+1);break;case!(_ instanceof h):this.text(_,b+1);break;case!(_ instanceof d):this.processingInstruction(_,b+1);break;case!(_ instanceof c):break;default:throw new Error("Unknown XML node type: "+_.constructor.name)}this.stream.write(A+"</"+y.name+">")}return this.stream.write(this.endline(y))},v.prototype.processingInstruction=function(y,b){return this.stream.write(this.space(b)+"<?"+y.target),y.value&&this.stream.write(" "+y.value),this.stream.write(this.spacebeforeslash+"?>"+this.endline(y))},v.prototype.raw=function(y,b){return this.stream.write(this.space(b)+y.value+this.endline(y))},v.prototype.text=function(y,b){return this.stream.write(this.space(b)+y.value+this.endline(y))},v.prototype.dtdAttList=function(y,b){return this.stream.write(this.space(b)+"<!ATTLIST "+y.elementName+" "+y.attributeName+" "+y.attributeType),y.defaultValueType!=="#DEFAULT"&&this.stream.write(" "+y.defaultValueType),y.defaultValue&&this.stream.write(' "'+y.defaultValue+'"'),this.stream.write(this.spacebeforeslash+">"+this.endline(y))},v.prototype.dtdElement=function(y,b){return this.stream.write(this.space(b)+"<!ELEMENT "+y.name+" "+y.value),this.stream.write(this.spacebeforeslash+">"+this.endline(y))},v.prototype.dtdEntity=function(y,b){return this.stream.write(this.space(b)+"<!ENTITY"),y.pe&&this.stream.write(" %"),this.stream.write(" "+y.name),y.value?this.stream.write(' "'+y.value+'"'):(y.pubID&&y.sysID?this.stream.write(' PUBLIC "'+y.pubID+'" "'+y.sysID+'"'):y.sysID&&this.stream.write(' SYSTEM "'+y.sysID+'"'),y.nData&&this.stream.write(" NDATA "+y.nData)),this.stream.write(this.spacebeforeslash+">"+this.endline(y))},v.prototype.dtdNotation=function(y,b){return this.stream.write(this.space(b)+"<!NOTATION "+y.name),y.pubID&&y.sysID?this.stream.write(' PUBLIC "'+y.pubID+'" "'+y.sysID+'"'):y.pubID?this.stream.write(' PUBLIC "'+y.pubID+'"'):y.sysID&&this.stream.write(' SYSTEM "'+y.sysID+'"'),this.stream.write(this.spacebeforeslash+">"+this.endline(y))},v.prototype.endline=function(y){return y.isLastRootNode?"":this.newline},v}(m)}).call(ht)),q2.exports}(function(){var e,t,r,n,a,i,s;s=Xl(),a=s.assign,i=s.isFunction,e=NLe(),t=SLe(),n=MT(),r=ELe(),jh.create=function(l,c,u,d){var f,h;if(l==null)throw new Error("Root element needs a name.");return d=a({},c,u,d),f=new e(d),h=f.element(l),d.headless||(f.declaration(d),(d.pubID!=null||d.sysID!=null)&&f.doctype(d)),h},jh.begin=function(l,c,u){var d;return i(l)&&(d=[l,c],c=d[0],u=d[1],l={}),c?new t(l,c,u):new e(l)},jh.stringWriter=function(l){return new n(l)},jh.streamWriter=function(l,c){return new r(l,c)}}).call(ht);var n6=Xr,TLe=jh;gz.writeString=kLe;function kLe(e,t){var r=n6.invert(t),n={element:i,text:CLe};function a(c,u){return n[u.type](c,u)}function i(c,u){var d=c.element(s(u.name),u.attributes);u.children.forEach(function(f){a(d,f)})}function s(c){var u=/^\{(.*)\}(.*)$/.exec(c);if(u){var d=r[u[1]];return d+(d===""?"":":")+u[2]}else return c}function l(c){var u=TLe.create(s(c.name),{version:"1.0",encoding:"UTF-8",standalone:!0});return n6.forEach(t,function(d,f){var h="xmlns"+(f===""?"":":"+f);u.attribute(h,d)}),c.children.forEach(function(d){a(u,d)}),u.end()}return l(e)}function CLe(e,t){e.text(t.value)}var s1=Ff;Go.Element=s1.Element;Go.element=s1.element;Go.emptyElement=s1.emptyElement;Go.text=s1.text;Go.readString=UW.readString;Go.writeString=gz.writeString;var ALe=Xr,OLe=Tn,FLe=Go;jT.read=wz;jT.readXmlFromZipFile=ILe;var PLe={"http://schemas.openxmlformats.org/wordprocessingml/2006/main":"w","http://schemas.openxmlformats.org/officeDocument/2006/relationships":"r","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing":"wp","http://schemas.openxmlformats.org/drawingml/2006/main":"a","http://schemas.openxmlformats.org/drawingml/2006/picture":"pic","http://purl.oclc.org/ooxml/wordprocessingml/main":"w","http://purl.oclc.org/ooxml/officeDocument/relationships":"r","http://purl.oclc.org/ooxml/drawingml/wordprocessingDrawing":"wp","http://purl.oclc.org/ooxml/drawingml/main":"a","http://purl.oclc.org/ooxml/drawingml/picture":"pic","http://schemas.openxmlformats.org/package/2006/content-types":"content-types","http://schemas.openxmlformats.org/package/2006/relationships":"relationships","http://schemas.openxmlformats.org/markup-compatibility/2006":"mc","urn:schemas-microsoft-com:vml":"v","urn:schemas-microsoft-com:office:word":"office-word","http://schemas.microsoft.com/office/word/2010/wordml":"wordml"};function wz(e){return FLe.readString(e,PLe).then(function(t){return _z(t)[0]})}function ILe(e,t){return e.exists(t)?e.read(t,"utf-8").then(RLe).then(wz):OLe.resolve(null)}function RLe(e){return e.replace(/^\uFEFF/g,"")}function _z(e){return e.type==="element"?e.name==="mc:AlternateContent"?e.firstOrEmpty("mc:Fallback").children:(e.children=ALe.flatten(e.children.map(_z,!0)),[e]):[e]}var UT={},bl={},$T={};Object.defineProperty($T,"__esModule",{value:!0});var MLe=[{"Typeface name":"Symbol","Dingbat dec":"32","Dingbat hex":"20","Unicode dec":"32","Unicode hex":"20"},{"Typeface name":"Symbol","Dingbat dec":"33","Dingbat hex":"21","Unicode dec":"33","Unicode hex":"21"},{"Typeface name":"Symbol","Dingbat dec":"34","Dingbat hex":"22","Unicode dec":"8704","Unicode hex":"2200"},{"Typeface name":"Symbol","Dingbat dec":"35","Dingbat hex":"23","Unicode dec":"35","Unicode hex":"23"},{"Typeface name":"Symbol","Dingbat dec":"36","Dingbat hex":"24","Unicode dec":"8707","Unicode hex":"2203"},{"Typeface name":"Symbol","Dingbat dec":"37","Dingbat hex":"25","Unicode dec":"37","Unicode hex":"25"},{"Typeface name":"Symbol","Dingbat dec":"38","Dingbat hex":"26","Unicode dec":"38","Unicode hex":"26"},{"Typeface name":"Symbol","Dingbat dec":"39","Dingbat hex":"27","Unicode dec":"8717","Unicode hex":"220D"},{"Typeface name":"Symbol","Dingbat dec":"40","Dingbat hex":"28","Unicode dec":"40","Unicode hex":"28"},{"Typeface name":"Symbol","Dingbat dec":"41","Dingbat hex":"29","Unicode dec":"41","Unicode hex":"29"},{"Typeface name":"Symbol","Dingbat dec":"42","Dingbat hex":"2A","Unicode dec":"42","Unicode hex":"2A"},{"Typeface name":"Symbol","Dingbat dec":"43","Dingbat hex":"2B","Unicode dec":"43","Unicode hex":"2B"},{"Typeface name":"Symbol","Dingbat dec":"44","Dingbat hex":"2C","Unicode dec":"44","Unicode hex":"2C"},{"Typeface name":"Symbol","Dingbat dec":"45","Dingbat hex":"2D","Unicode dec":"8722","Unicode hex":"2212"},{"Typeface name":"Symbol","Dingbat dec":"46","Dingbat hex":"2E","Unicode dec":"46","Unicode hex":"2E"},{"Typeface name":"Symbol","Dingbat dec":"47","Dingbat hex":"2F","Unicode dec":"47","Unicode hex":"2F"},{"Typeface name":"Symbol","Dingbat dec":"48","Dingbat hex":"30","Unicode dec":"48","Unicode hex":"30"},{"Typeface name":"Symbol","Dingbat dec":"49","Dingbat hex":"31","Unicode dec":"49","Unicode hex":"31"},{"Typeface name":"Symbol","Dingbat dec":"50","Dingbat hex":"32","Unicode dec":"50","Unicode hex":"32"},{"Typeface name":"Symbol","Dingbat dec":"51","Dingbat hex":"33","Unicode dec":"51","Unicode hex":"33"},{"Typeface name":"Symbol","Dingbat dec":"52","Dingbat hex":"34","Unicode dec":"52","Unicode hex":"34"},{"Typeface name":"Symbol","Dingbat dec":"53","Dingbat hex":"35","Unicode dec":"53","Unicode hex":"35"},{"Typeface name":"Symbol","Dingbat dec":"54","Dingbat hex":"36","Unicode dec":"54","Unicode hex":"36"},{"Typeface name":"Symbol","Dingbat dec":"55","Dingbat hex":"37","Unicode dec":"55","Unicode hex":"37"},{"Typeface name":"Symbol","Dingbat dec":"56","Dingbat hex":"38","Unicode dec":"56","Unicode hex":"38"},{"Typeface name":"Symbol","Dingbat dec":"57","Dingbat hex":"39","Unicode dec":"57","Unicode hex":"39"},{"Typeface name":"Symbol","Dingbat dec":"58","Dingbat hex":"3A","Unicode dec":"58","Unicode hex":"3A"},{"Typeface name":"Symbol","Dingbat dec":"59","Dingbat hex":"3B","Unicode dec":"59","Unicode hex":"3B"},{"Typeface name":"Symbol","Dingbat dec":"60","Dingbat hex":"3C","Unicode dec":"60","Unicode hex":"3C"},{"Typeface name":"Symbol","Dingbat dec":"61","Dingbat hex":"3D","Unicode dec":"61","Unicode hex":"3D"},{"Typeface name":"Symbol","Dingbat dec":"62","Dingbat hex":"3E","Unicode dec":"62","Unicode hex":"3E"},{"Typeface name":"Symbol","Dingbat dec":"63","Dingbat hex":"3F","Unicode dec":"63","Unicode hex":"3F"},{"Typeface name":"Symbol","Dingbat dec":"64","Dingbat hex":"40","Unicode dec":"8773","Unicode hex":"2245"},{"Typeface name":"Symbol","Dingbat dec":"65","Dingbat hex":"41","Unicode dec":"913","Unicode hex":"391"},{"Typeface name":"Symbol","Dingbat dec":"66","Dingbat hex":"42","Unicode dec":"914","Unicode hex":"392"},{"Typeface name":"Symbol","Dingbat dec":"67","Dingbat hex":"43","Unicode dec":"935","Unicode hex":"3A7"},{"Typeface name":"Symbol","Dingbat dec":"68","Dingbat hex":"44","Unicode dec":"916","Unicode hex":"394"},{"Typeface name":"Symbol","Dingbat dec":"69","Dingbat hex":"45","Unicode dec":"917","Unicode hex":"395"},{"Typeface name":"Symbol","Dingbat dec":"70","Dingbat hex":"46","Unicode dec":"934","Unicode hex":"3A6"},{"Typeface name":"Symbol","Dingbat dec":"71","Dingbat hex":"47","Unicode dec":"915","Unicode hex":"393"},{"Typeface name":"Symbol","Dingbat dec":"72","Dingbat hex":"48","Unicode dec":"919","Unicode hex":"397"},{"Typeface name":"Symbol","Dingbat dec":"73","Dingbat hex":"49","Unicode dec":"921","Unicode hex":"399"},{"Typeface name":"Symbol","Dingbat dec":"74","Dingbat hex":"4A","Unicode dec":"977","Unicode hex":"3D1"},{"Typeface name":"Symbol","Dingbat dec":"75","Dingbat hex":"4B","Unicode dec":"922","Unicode hex":"39A"},{"Typeface name":"Symbol","Dingbat dec":"76","Dingbat hex":"4C","Unicode dec":"923","Unicode hex":"39B"},{"Typeface name":"Symbol","Dingbat dec":"77","Dingbat hex":"4D","Unicode dec":"924","Unicode hex":"39C"},{"Typeface name":"Symbol","Dingbat dec":"78","Dingbat hex":"4E","Unicode dec":"925","Unicode hex":"39D"},{"Typeface name":"Symbol","Dingbat dec":"79","Dingbat hex":"4F","Unicode dec":"927","Unicode hex":"39F"},{"Typeface name":"Symbol","Dingbat dec":"80","Dingbat hex":"50","Unicode dec":"928","Unicode hex":"3A0"},{"Typeface name":"Symbol","Dingbat dec":"81","Dingbat hex":"51","Unicode dec":"920","Unicode hex":"398"},{"Typeface name":"Symbol","Dingbat dec":"82","Dingbat hex":"52","Unicode dec":"929","Unicode hex":"3A1"},{"Typeface name":"Symbol","Dingbat dec":"83","Dingbat hex":"53","Unicode dec":"931","Unicode hex":"3A3"},{"Typeface name":"Symbol","Dingbat dec":"84","Dingbat hex":"54","Unicode dec":"932","Unicode hex":"3A4"},{"Typeface name":"Symbol","Dingbat dec":"85","Dingbat hex":"55","Unicode dec":"933","Unicode hex":"3A5"},{"Typeface name":"Symbol","Dingbat dec":"86","Dingbat hex":"56","Unicode dec":"962","Unicode hex":"3C2"},{"Typeface name":"Symbol","Dingbat dec":"87","Dingbat hex":"57","Unicode dec":"937","Unicode hex":"3A9"},{"Typeface name":"Symbol","Dingbat dec":"88","Dingbat hex":"58","Unicode dec":"926","Unicode hex":"39E"},{"Typeface name":"Symbol","Dingbat dec":"89","Dingbat hex":"59","Unicode dec":"936","Unicode hex":"3A8"},{"Typeface name":"Symbol","Dingbat dec":"90","Dingbat hex":"5A","Unicode dec":"918","Unicode hex":"396"},{"Typeface name":"Symbol","Dingbat dec":"91","Dingbat hex":"5B","Unicode dec":"91","Unicode hex":"5B"},{"Typeface name":"Symbol","Dingbat dec":"92","Dingbat hex":"5C","Unicode dec":"8756","Unicode hex":"2234"},{"Typeface name":"Symbol","Dingbat dec":"93","Dingbat hex":"5D","Unicode dec":"93","Unicode hex":"5D"},{"Typeface name":"Symbol","Dingbat dec":"94","Dingbat hex":"5E","Unicode dec":"8869","Unicode hex":"22A5"},{"Typeface name":"Symbol","Dingbat dec":"95","Dingbat hex":"5F","Unicode dec":"95","Unicode hex":"5F"},{"Typeface name":"Symbol","Dingbat dec":"96","Dingbat hex":"60","Unicode dec":"8254","Unicode hex":"203E"},{"Typeface name":"Symbol","Dingbat dec":"97","Dingbat hex":"61","Unicode dec":"945","Unicode hex":"3B1"},{"Typeface name":"Symbol","Dingbat dec":"98","Dingbat hex":"62","Unicode dec":"946","Unicode hex":"3B2"},{"Typeface name":"Symbol","Dingbat dec":"99","Dingbat hex":"63","Unicode dec":"967","Unicode hex":"3C7"},{"Typeface name":"Symbol","Dingbat dec":"100","Dingbat hex":"64","Unicode dec":"948","Unicode hex":"3B4"},{"Typeface name":"Symbol","Dingbat dec":"101","Dingbat hex":"65","Unicode dec":"949","Unicode hex":"3B5"},{"Typeface name":"Symbol","Dingbat dec":"102","Dingbat hex":"66","Unicode dec":"966","Unicode hex":"3C6"},{"Typeface name":"Symbol","Dingbat dec":"103","Dingbat hex":"67","Unicode dec":"947","Unicode hex":"3B3"},{"Typeface name":"Symbol","Dingbat dec":"104","Dingbat hex":"68","Unicode dec":"951","Unicode hex":"3B7"},{"Typeface name":"Symbol","Dingbat dec":"105","Dingbat hex":"69","Unicode dec":"953","Unicode hex":"3B9"},{"Typeface name":"Symbol","Dingbat dec":"106","Dingbat hex":"6A","Unicode dec":"981","Unicode hex":"3D5"},{"Typeface name":"Symbol","Dingbat dec":"107","Dingbat hex":"6B","Unicode dec":"954","Unicode hex":"3BA"},{"Typeface name":"Symbol","Dingbat dec":"108","Dingbat hex":"6C","Unicode dec":"955","Unicode hex":"3BB"},{"Typeface name":"Symbol","Dingbat dec":"109","Dingbat hex":"6D","Unicode dec":"956","Unicode hex":"3BC"},{"Typeface name":"Symbol","Dingbat dec":"110","Dingbat hex":"6E","Unicode dec":"957","Unicode hex":"3BD"},{"Typeface name":"Symbol","Dingbat dec":"111","Dingbat hex":"6F","Unicode dec":"959","Unicode hex":"3BF"},{"Typeface name":"Symbol","Dingbat dec":"112","Dingbat hex":"70","Unicode dec":"960","Unicode hex":"3C0"},{"Typeface name":"Symbol","Dingbat dec":"113","Dingbat hex":"71","Unicode dec":"952","Unicode hex":"3B8"},{"Typeface name":"Symbol","Dingbat dec":"114","Dingbat hex":"72","Unicode dec":"961","Unicode hex":"3C1"},{"Typeface name":"Symbol","Dingbat dec":"115","Dingbat hex":"73","Unicode dec":"963","Unicode hex":"3C3"},{"Typeface name":"Symbol","Dingbat dec":"116","Dingbat hex":"74","Unicode dec":"964","Unicode hex":"3C4"},{"Typeface name":"Symbol","Dingbat dec":"117","Dingbat hex":"75","Unicode dec":"965","Unicode hex":"3C5"},{"Typeface name":"Symbol","Dingbat dec":"118","Dingbat hex":"76","Unicode dec":"982","Unicode hex":"3D6"},{"Typeface name":"Symbol","Dingbat dec":"119","Dingbat hex":"77","Unicode dec":"969","Unicode hex":"3C9"},{"Typeface name":"Symbol","Dingbat dec":"120","Dingbat hex":"78","Unicode dec":"958","Unicode hex":"3BE"},{"Typeface name":"Symbol","Dingbat dec":"121","Dingbat hex":"79","Unicode dec":"968","Unicode hex":"3C8"},{"Typeface name":"Symbol","Dingbat dec":"122","Dingbat hex":"7A","Unicode dec":"950","Unicode hex":"3B6"},{"Typeface name":"Symbol","Dingbat dec":"123","Dingbat hex":"7B","Unicode dec":"123","Unicode hex":"7B"},{"Typeface name":"Symbol","Dingbat dec":"124","Dingbat hex":"7C","Unicode dec":"124","Unicode hex":"7C"},{"Typeface name":"Symbol","Dingbat dec":"125","Dingbat hex":"7D","Unicode dec":"125","Unicode hex":"7D"},{"Typeface name":"Symbol","Dingbat dec":"126","Dingbat hex":"7E","Unicode dec":"126","Unicode hex":"7E"},{"Typeface name":"Symbol","Dingbat dec":"160","Dingbat hex":"A0","Unicode dec":"8364","Unicode hex":"20AC"},{"Typeface name":"Symbol","Dingbat dec":"161","Dingbat hex":"A1","Unicode dec":"978","Unicode hex":"3D2"},{"Typeface name":"Symbol","Dingbat dec":"162","Dingbat hex":"A2","Unicode dec":"8242","Unicode hex":"2032"},{"Typeface name":"Symbol","Dingbat dec":"163","Dingbat hex":"A3","Unicode dec":"8804","Unicode hex":"2264"},{"Typeface name":"Symbol","Dingbat dec":"164","Dingbat hex":"A4","Unicode dec":"8260","Unicode hex":"2044"},{"Typeface name":"Symbol","Dingbat dec":"165","Dingbat hex":"A5","Unicode dec":"8734","Unicode hex":"221E"},{"Typeface name":"Symbol","Dingbat dec":"166","Dingbat hex":"A6","Unicode dec":"402","Unicode hex":"192"},{"Typeface name":"Symbol","Dingbat dec":"167","Dingbat hex":"A7","Unicode dec":"9827","Unicode hex":"2663"},{"Typeface name":"Symbol","Dingbat dec":"168","Dingbat hex":"A8","Unicode dec":"9830","Unicode hex":"2666"},{"Typeface name":"Symbol","Dingbat dec":"169","Dingbat hex":"A9","Unicode dec":"9829","Unicode hex":"2665"},{"Typeface name":"Symbol","Dingbat dec":"170","Dingbat hex":"AA","Unicode dec":"9824","Unicode hex":"2660"},{"Typeface name":"Symbol","Dingbat dec":"171","Dingbat hex":"AB","Unicode dec":"8596","Unicode hex":"2194"},{"Typeface name":"Symbol","Dingbat dec":"172","Dingbat hex":"AC","Unicode dec":"8592","Unicode hex":"2190"},{"Typeface name":"Symbol","Dingbat dec":"173","Dingbat hex":"AD","Unicode dec":"8593","Unicode hex":"2191"},{"Typeface name":"Symbol","Dingbat dec":"174","Dingbat hex":"AE","Unicode dec":"8594","Unicode hex":"2192"},{"Typeface name":"Symbol","Dingbat dec":"175","Dingbat hex":"AF","Unicode dec":"8595","Unicode hex":"2193"},{"Typeface name":"Symbol","Dingbat dec":"176","Dingbat hex":"B0","Unicode dec":"176","Unicode hex":"B0"},{"Typeface name":"Symbol","Dingbat dec":"177","Dingbat hex":"B1","Unicode dec":"177","Unicode hex":"B1"},{"Typeface name":"Symbol","Dingbat dec":"178","Dingbat hex":"B2","Unicode dec":"8243","Unicode hex":"2033"},{"Typeface name":"Symbol","Dingbat dec":"179","Dingbat hex":"B3","Unicode dec":"8805","Unicode hex":"2265"},{"Typeface name":"Symbol","Dingbat dec":"180","Dingbat hex":"B4","Unicode dec":"215","Unicode hex":"D7"},{"Typeface name":"Symbol","Dingbat dec":"181","Dingbat hex":"B5","Unicode dec":"8733","Unicode hex":"221D"},{"Typeface name":"Symbol","Dingbat dec":"182","Dingbat hex":"B6","Unicode dec":"8706","Unicode hex":"2202"},{"Typeface name":"Symbol","Dingbat dec":"183","Dingbat hex":"B7","Unicode dec":"8226","Unicode hex":"2022"},{"Typeface name":"Symbol","Dingbat dec":"184","Dingbat hex":"B8","Unicode dec":"247","Unicode hex":"F7"},{"Typeface name":"Symbol","Dingbat dec":"185","Dingbat hex":"B9","Unicode dec":"8800","Unicode hex":"2260"},{"Typeface name":"Symbol","Dingbat dec":"186","Dingbat hex":"BA","Unicode dec":"8801","Unicode hex":"2261"},{"Typeface name":"Symbol","Dingbat dec":"187","Dingbat hex":"BB","Unicode dec":"8776","Unicode hex":"2248"},{"Typeface name":"Symbol","Dingbat dec":"188","Dingbat hex":"BC","Unicode dec":"8230","Unicode hex":"2026"},{"Typeface name":"Symbol","Dingbat dec":"189","Dingbat hex":"BD","Unicode dec":"9168","Unicode hex":"23D0"},{"Typeface name":"Symbol","Dingbat dec":"190","Dingbat hex":"BE","Unicode dec":"9135","Unicode hex":"23AF"},{"Typeface name":"Symbol","Dingbat dec":"191","Dingbat hex":"BF","Unicode dec":"8629","Unicode hex":"21B5"},{"Typeface name":"Symbol","Dingbat dec":"192","Dingbat hex":"C0","Unicode dec":"8501","Unicode hex":"2135"},{"Typeface name":"Symbol","Dingbat dec":"193","Dingbat hex":"C1","Unicode dec":"8465","Unicode hex":"2111"},{"Typeface name":"Symbol","Dingbat dec":"194","Dingbat hex":"C2","Unicode dec":"8476","Unicode hex":"211C"},{"Typeface name":"Symbol","Dingbat dec":"195","Dingbat hex":"C3","Unicode dec":"8472","Unicode hex":"2118"},{"Typeface name":"Symbol","Dingbat dec":"196","Dingbat hex":"C4","Unicode dec":"8855","Unicode hex":"2297"},{"Typeface name":"Symbol","Dingbat dec":"197","Dingbat hex":"C5","Unicode dec":"8853","Unicode hex":"2295"},{"Typeface name":"Symbol","Dingbat dec":"198","Dingbat hex":"C6","Unicode dec":"8709","Unicode hex":"2205"},{"Typeface name":"Symbol","Dingbat dec":"199","Dingbat hex":"C7","Unicode dec":"8745","Unicode hex":"2229"},{"Typeface name":"Symbol","Dingbat dec":"200","Dingbat hex":"C8","Unicode dec":"8746","Unicode hex":"222A"},{"Typeface name":"Symbol","Dingbat dec":"201","Dingbat hex":"C9","Unicode dec":"8835","Unicode hex":"2283"},{"Typeface name":"Symbol","Dingbat dec":"202","Dingbat hex":"CA","Unicode dec":"8839","Unicode hex":"2287"},{"Typeface name":"Symbol","Dingbat dec":"203","Dingbat hex":"CB","Unicode dec":"8836","Unicode hex":"2284"},{"Typeface name":"Symbol","Dingbat dec":"204","Dingbat hex":"CC","Unicode dec":"8834","Unicode hex":"2282"},{"Typeface name":"Symbol","Dingbat dec":"205","Dingbat hex":"CD","Unicode dec":"8838","Unicode hex":"2286"},{"Typeface name":"Symbol","Dingbat dec":"206","Dingbat hex":"CE","Unicode dec":"8712","Unicode hex":"2208"},{"Typeface name":"Symbol","Dingbat dec":"207","Dingbat hex":"CF","Unicode dec":"8713","Unicode hex":"2209"},{"Typeface name":"Symbol","Dingbat dec":"208","Dingbat hex":"D0","Unicode dec":"8736","Unicode hex":"2220"},{"Typeface name":"Symbol","Dingbat dec":"209","Dingbat hex":"D1","Unicode dec":"8711","Unicode hex":"2207"},{"Typeface name":"Symbol","Dingbat dec":"210","Dingbat hex":"D2","Unicode dec":"174","Unicode hex":"AE"},{"Typeface name":"Symbol","Dingbat dec":"211","Dingbat hex":"D3","Unicode dec":"169","Unicode hex":"A9"},{"Typeface name":"Symbol","Dingbat dec":"212","Dingbat hex":"D4","Unicode dec":"8482","Unicode hex":"2122"},{"Typeface name":"Symbol","Dingbat dec":"213","Dingbat hex":"D5","Unicode dec":"8719","Unicode hex":"220F"},{"Typeface name":"Symbol","Dingbat dec":"214","Dingbat hex":"D6","Unicode dec":"8730","Unicode hex":"221A"},{"Typeface name":"Symbol","Dingbat dec":"215","Dingbat hex":"D7","Unicode dec":"8901","Unicode hex":"22C5"},{"Typeface name":"Symbol","Dingbat dec":"216","Dingbat hex":"D8","Unicode dec":"172","Unicode hex":"AC"},{"Typeface name":"Symbol","Dingbat dec":"217","Dingbat hex":"D9","Unicode dec":"8743","Unicode hex":"2227"},{"Typeface name":"Symbol","Dingbat dec":"218","Dingbat hex":"DA","Unicode dec":"8744","Unicode hex":"2228"},{"Typeface name":"Symbol","Dingbat dec":"219","Dingbat hex":"DB","Unicode dec":"8660","Unicode hex":"21D4"},{"Typeface name":"Symbol","Dingbat dec":"220","Dingbat hex":"DC","Unicode dec":"8656","Unicode hex":"21D0"},{"Typeface name":"Symbol","Dingbat dec":"221","Dingbat hex":"DD","Unicode dec":"8657","Unicode hex":"21D1"},{"Typeface name":"Symbol","Dingbat dec":"222","Dingbat hex":"DE","Unicode dec":"8658","Unicode hex":"21D2"},{"Typeface name":"Symbol","Dingbat dec":"223","Dingbat hex":"DF","Unicode dec":"8659","Unicode hex":"21D3"},{"Typeface name":"Symbol","Dingbat dec":"224","Dingbat hex":"E0","Unicode dec":"9674","Unicode hex":"25CA"},{"Typeface name":"Symbol","Dingbat dec":"225","Dingbat hex":"E1","Unicode dec":"12296","Unicode hex":"3008"},{"Typeface name":"Symbol","Dingbat dec":"226","Dingbat hex":"E2","Unicode dec":"174","Unicode hex":"AE"},{"Typeface name":"Symbol","Dingbat dec":"227","Dingbat hex":"E3","Unicode dec":"169","Unicode hex":"A9"},{"Typeface name":"Symbol","Dingbat dec":"228","Dingbat hex":"E4","Unicode dec":"8482","Unicode hex":"2122"},{"Typeface name":"Symbol","Dingbat dec":"229","Dingbat hex":"E5","Unicode dec":"8721","Unicode hex":"2211"},{"Typeface name":"Symbol","Dingbat dec":"230","Dingbat hex":"E6","Unicode dec":"9115","Unicode hex":"239B"},{"Typeface name":"Symbol","Dingbat dec":"231","Dingbat hex":"E7","Unicode dec":"9116","Unicode hex":"239C"},{"Typeface name":"Symbol","Dingbat dec":"232","Dingbat hex":"E8","Unicode dec":"9117","Unicode hex":"239D"},{"Typeface name":"Symbol","Dingbat dec":"233","Dingbat hex":"E9","Unicode dec":"9121","Unicode hex":"23A1"},{"Typeface name":"Symbol","Dingbat dec":"234","Dingbat hex":"EA","Unicode dec":"9122","Unicode hex":"23A2"},{"Typeface name":"Symbol","Dingbat dec":"235","Dingbat hex":"EB","Unicode dec":"9123","Unicode hex":"23A3"},{"Typeface name":"Symbol","Dingbat dec":"236","Dingbat hex":"EC","Unicode dec":"9127","Unicode hex":"23A7"},{"Typeface name":"Symbol","Dingbat dec":"237","Dingbat hex":"ED","Unicode dec":"9128","Unicode hex":"23A8"},{"Typeface name":"Symbol","Dingbat dec":"238","Dingbat hex":"EE","Unicode dec":"9129","Unicode hex":"23A9"},{"Typeface name":"Symbol","Dingbat dec":"239","Dingbat hex":"EF","Unicode dec":"9130","Unicode hex":"23AA"},{"Typeface name":"Symbol","Dingbat dec":"240","Dingbat hex":"F0","Unicode dec":"63743","Unicode hex":"F8FF"},{"Typeface name":"Symbol","Dingbat dec":"241","Dingbat hex":"F1","Unicode dec":"12297","Unicode hex":"3009"},{"Typeface name":"Symbol","Dingbat dec":"242","Dingbat hex":"F2","Unicode dec":"8747","Unicode hex":"222B"},{"Typeface name":"Symbol","Dingbat dec":"243","Dingbat hex":"F3","Unicode dec":"8992","Unicode hex":"2320"},{"Typeface name":"Symbol","Dingbat dec":"244","Dingbat hex":"F4","Unicode dec":"9134","Unicode hex":"23AE"},{"Typeface name":"Symbol","Dingbat dec":"245","Dingbat hex":"F5","Unicode dec":"8993","Unicode hex":"2321"},{"Typeface name":"Symbol","Dingbat dec":"246","Dingbat hex":"F6","Unicode dec":"9118","Unicode hex":"239E"},{"Typeface name":"Symbol","Dingbat dec":"247","Dingbat hex":"F7","Unicode dec":"9119","Unicode hex":"239F"},{"Typeface name":"Symbol","Dingbat dec":"248","Dingbat hex":"F8","Unicode dec":"9120","Unicode hex":"23A0"},{"Typeface name":"Symbol","Dingbat dec":"249","Dingbat hex":"F9","Unicode dec":"9124","Unicode hex":"23A4"},{"Typeface name":"Symbol","Dingbat dec":"250","Dingbat hex":"FA","Unicode dec":"9125","Unicode hex":"23A5"},{"Typeface name":"Symbol","Dingbat dec":"251","Dingbat hex":"FB","Unicode dec":"9126","Unicode hex":"23A6"},{"Typeface name":"Symbol","Dingbat dec":"252","Dingbat hex":"FC","Unicode dec":"9131","Unicode hex":"23AB"},{"Typeface name":"Symbol","Dingbat dec":"253","Dingbat hex":"FD","Unicode dec":"9132","Unicode hex":"23AC"},{"Typeface name":"Symbol","Dingbat dec":"254","Dingbat hex":"FE","Unicode dec":"9133","Unicode hex":"23AD"},{"Typeface name":"Webdings","Dingbat dec":"32","Dingbat hex":"20","Unicode dec":"32","Unicode hex":"20"},{"Typeface name":"Webdings","Dingbat dec":"33","Dingbat hex":"21","Unicode dec":"128375","Unicode hex":"1F577"},{"Typeface name":"Webdings","Dingbat dec":"34","Dingbat hex":"22","Unicode dec":"128376","Unicode hex":"1F578"},{"Typeface name":"Webdings","Dingbat dec":"35","Dingbat hex":"23","Unicode dec":"128370","Unicode hex":"1F572"},{"Typeface name":"Webdings","Dingbat dec":"36","Dingbat hex":"24","Unicode dec":"128374","Unicode hex":"1F576"},{"Typeface name":"Webdings","Dingbat dec":"37","Dingbat hex":"25","Unicode dec":"127942","Unicode hex":"1F3C6"},{"Typeface name":"Webdings","Dingbat dec":"38","Dingbat hex":"26","Unicode dec":"127894","Unicode hex":"1F396"},{"Typeface name":"Webdings","Dingbat dec":"39","Dingbat hex":"27","Unicode dec":"128391","Unicode hex":"1F587"},{"Typeface name":"Webdings","Dingbat dec":"40","Dingbat hex":"28","Unicode dec":"128488","Unicode hex":"1F5E8"},{"Typeface name":"Webdings","Dingbat dec":"41","Dingbat hex":"29","Unicode dec":"128489","Unicode hex":"1F5E9"},{"Typeface name":"Webdings","Dingbat dec":"42","Dingbat hex":"2A","Unicode dec":"128496","Unicode hex":"1F5F0"},{"Typeface name":"Webdings","Dingbat dec":"43","Dingbat hex":"2B","Unicode dec":"128497","Unicode hex":"1F5F1"},{"Typeface name":"Webdings","Dingbat dec":"44","Dingbat hex":"2C","Unicode dec":"127798","Unicode hex":"1F336"},{"Typeface name":"Webdings","Dingbat dec":"45","Dingbat hex":"2D","Unicode dec":"127895","Unicode hex":"1F397"},{"Typeface name":"Webdings","Dingbat dec":"46","Dingbat hex":"2E","Unicode dec":"128638","Unicode hex":"1F67E"},{"Typeface name":"Webdings","Dingbat dec":"47","Dingbat hex":"2F","Unicode dec":"128636","Unicode hex":"1F67C"},{"Typeface name":"Webdings","Dingbat dec":"48","Dingbat hex":"30","Unicode dec":"128469","Unicode hex":"1F5D5"},{"Typeface name":"Webdings","Dingbat dec":"49","Dingbat hex":"31","Unicode dec":"128470","Unicode hex":"1F5D6"},{"Typeface name":"Webdings","Dingbat dec":"50","Dingbat hex":"32","Unicode dec":"128471","Unicode hex":"1F5D7"},{"Typeface name":"Webdings","Dingbat dec":"51","Dingbat hex":"33","Unicode dec":"9204","Unicode hex":"23F4"},{"Typeface name":"Webdings","Dingbat dec":"52","Dingbat hex":"34","Unicode dec":"9205","Unicode hex":"23F5"},{"Typeface name":"Webdings","Dingbat dec":"53","Dingbat hex":"35","Unicode dec":"9206","Unicode hex":"23F6"},{"Typeface name":"Webdings","Dingbat dec":"54","Dingbat hex":"36","Unicode dec":"9207","Unicode hex":"23F7"},{"Typeface name":"Webdings","Dingbat dec":"55","Dingbat hex":"37","Unicode dec":"9194","Unicode hex":"23EA"},{"Typeface name":"Webdings","Dingbat dec":"56","Dingbat hex":"38","Unicode dec":"9193","Unicode hex":"23E9"},{"Typeface name":"Webdings","Dingbat dec":"57","Dingbat hex":"39","Unicode dec":"9198","Unicode hex":"23EE"},{"Typeface name":"Webdings","Dingbat dec":"58","Dingbat hex":"3A","Unicode dec":"9197","Unicode hex":"23ED"},{"Typeface name":"Webdings","Dingbat dec":"59","Dingbat hex":"3B","Unicode dec":"9208","Unicode hex":"23F8"},{"Typeface name":"Webdings","Dingbat dec":"60","Dingbat hex":"3C","Unicode dec":"9209","Unicode hex":"23F9"},{"Typeface name":"Webdings","Dingbat dec":"61","Dingbat hex":"3D","Unicode dec":"9210","Unicode hex":"23FA"},{"Typeface name":"Webdings","Dingbat dec":"62","Dingbat hex":"3E","Unicode dec":"128474","Unicode hex":"1F5DA"},{"Typeface name":"Webdings","Dingbat dec":"63","Dingbat hex":"3F","Unicode dec":"128499","Unicode hex":"1F5F3"},{"Typeface name":"Webdings","Dingbat dec":"64","Dingbat hex":"40","Unicode dec":"128736","Unicode hex":"1F6E0"},{"Typeface name":"Webdings","Dingbat dec":"65","Dingbat hex":"41","Unicode dec":"127959","Unicode hex":"1F3D7"},{"Typeface name":"Webdings","Dingbat dec":"66","Dingbat hex":"42","Unicode dec":"127960","Unicode hex":"1F3D8"},{"Typeface name":"Webdings","Dingbat dec":"67","Dingbat hex":"43","Unicode dec":"127961","Unicode hex":"1F3D9"},{"Typeface name":"Webdings","Dingbat dec":"68","Dingbat hex":"44","Unicode dec":"127962","Unicode hex":"1F3DA"},{"Typeface name":"Webdings","Dingbat dec":"69","Dingbat hex":"45","Unicode dec":"127964","Unicode hex":"1F3DC"},{"Typeface name":"Webdings","Dingbat dec":"70","Dingbat hex":"46","Unicode dec":"127981","Unicode hex":"1F3ED"},{"Typeface name":"Webdings","Dingbat dec":"71","Dingbat hex":"47","Unicode dec":"127963","Unicode hex":"1F3DB"},{"Typeface name":"Webdings","Dingbat dec":"72","Dingbat hex":"48","Unicode dec":"127968","Unicode hex":"1F3E0"},{"Typeface name":"Webdings","Dingbat dec":"73","Dingbat hex":"49","Unicode dec":"127958","Unicode hex":"1F3D6"},{"Typeface name":"Webdings","Dingbat dec":"74","Dingbat hex":"4A","Unicode dec":"127965","Unicode hex":"1F3DD"},{"Typeface name":"Webdings","Dingbat dec":"75","Dingbat hex":"4B","Unicode dec":"128739","Unicode hex":"1F6E3"},{"Typeface name":"Webdings","Dingbat dec":"76","Dingbat hex":"4C","Unicode dec":"128269","Unicode hex":"1F50D"},{"Typeface name":"Webdings","Dingbat dec":"77","Dingbat hex":"4D","Unicode dec":"127956","Unicode hex":"1F3D4"},{"Typeface name":"Webdings","Dingbat dec":"78","Dingbat hex":"4E","Unicode dec":"128065","Unicode hex":"1F441"},{"Typeface name":"Webdings","Dingbat dec":"79","Dingbat hex":"4F","Unicode dec":"128066","Unicode hex":"1F442"},{"Typeface name":"Webdings","Dingbat dec":"80","Dingbat hex":"50","Unicode dec":"127966","Unicode hex":"1F3DE"},{"Typeface name":"Webdings","Dingbat dec":"81","Dingbat hex":"51","Unicode dec":"127957","Unicode hex":"1F3D5"},{"Typeface name":"Webdings","Dingbat dec":"82","Dingbat hex":"52","Unicode dec":"128740","Unicode hex":"1F6E4"},{"Typeface name":"Webdings","Dingbat dec":"83","Dingbat hex":"53","Unicode dec":"127967","Unicode hex":"1F3DF"},{"Typeface name":"Webdings","Dingbat dec":"84","Dingbat hex":"54","Unicode dec":"128755","Unicode hex":"1F6F3"},{"Typeface name":"Webdings","Dingbat dec":"85","Dingbat hex":"55","Unicode dec":"128364","Unicode hex":"1F56C"},{"Typeface name":"Webdings","Dingbat dec":"86","Dingbat hex":"56","Unicode dec":"128363","Unicode hex":"1F56B"},{"Typeface name":"Webdings","Dingbat dec":"87","Dingbat hex":"57","Unicode dec":"128360","Unicode hex":"1F568"},{"Typeface name":"Webdings","Dingbat dec":"88","Dingbat hex":"58","Unicode dec":"128264","Unicode hex":"1F508"},{"Typeface name":"Webdings","Dingbat dec":"89","Dingbat hex":"59","Unicode dec":"127892","Unicode hex":"1F394"},{"Typeface name":"Webdings","Dingbat dec":"90","Dingbat hex":"5A","Unicode dec":"127893","Unicode hex":"1F395"},{"Typeface name":"Webdings","Dingbat dec":"91","Dingbat hex":"5B","Unicode dec":"128492","Unicode hex":"1F5EC"},{"Typeface name":"Webdings","Dingbat dec":"92","Dingbat hex":"5C","Unicode dec":"128637","Unicode hex":"1F67D"},{"Typeface name":"Webdings","Dingbat dec":"93","Dingbat hex":"5D","Unicode dec":"128493","Unicode hex":"1F5ED"},{"Typeface name":"Webdings","Dingbat dec":"94","Dingbat hex":"5E","Unicode dec":"128490","Unicode hex":"1F5EA"},{"Typeface name":"Webdings","Dingbat dec":"95","Dingbat hex":"5F","Unicode dec":"128491","Unicode hex":"1F5EB"},{"Typeface name":"Webdings","Dingbat dec":"96","Dingbat hex":"60","Unicode dec":"11156","Unicode hex":"2B94"},{"Typeface name":"Webdings","Dingbat dec":"97","Dingbat hex":"61","Unicode dec":"10004","Unicode hex":"2714"},{"Typeface name":"Webdings","Dingbat dec":"98","Dingbat hex":"62","Unicode dec":"128690","Unicode hex":"1F6B2"},{"Typeface name":"Webdings","Dingbat dec":"99","Dingbat hex":"63","Unicode dec":"11036","Unicode hex":"2B1C"},{"Typeface name":"Webdings","Dingbat dec":"100","Dingbat hex":"64","Unicode dec":"128737","Unicode hex":"1F6E1"},{"Typeface name":"Webdings","Dingbat dec":"101","Dingbat hex":"65","Unicode dec":"128230","Unicode hex":"1F4E6"},{"Typeface name":"Webdings","Dingbat dec":"102","Dingbat hex":"66","Unicode dec":"128753","Unicode hex":"1F6F1"},{"Typeface name":"Webdings","Dingbat dec":"103","Dingbat hex":"67","Unicode dec":"11035","Unicode hex":"2B1B"},{"Typeface name":"Webdings","Dingbat dec":"104","Dingbat hex":"68","Unicode dec":"128657","Unicode hex":"1F691"},{"Typeface name":"Webdings","Dingbat dec":"105","Dingbat hex":"69","Unicode dec":"128712","Unicode hex":"1F6C8"},{"Typeface name":"Webdings","Dingbat dec":"106","Dingbat hex":"6A","Unicode dec":"128745","Unicode hex":"1F6E9"},{"Typeface name":"Webdings","Dingbat dec":"107","Dingbat hex":"6B","Unicode dec":"128752","Unicode hex":"1F6F0"},{"Typeface name":"Webdings","Dingbat dec":"108","Dingbat hex":"6C","Unicode dec":"128968","Unicode hex":"1F7C8"},{"Typeface name":"Webdings","Dingbat dec":"109","Dingbat hex":"6D","Unicode dec":"128372","Unicode hex":"1F574"},{"Typeface name":"Webdings","Dingbat dec":"110","Dingbat hex":"6E","Unicode dec":"11044","Unicode hex":"2B24"},{"Typeface name":"Webdings","Dingbat dec":"111","Dingbat hex":"6F","Unicode dec":"128741","Unicode hex":"1F6E5"},{"Typeface name":"Webdings","Dingbat dec":"112","Dingbat hex":"70","Unicode dec":"128660","Unicode hex":"1F694"},{"Typeface name":"Webdings","Dingbat dec":"113","Dingbat hex":"71","Unicode dec":"128472","Unicode hex":"1F5D8"},{"Typeface name":"Webdings","Dingbat dec":"114","Dingbat hex":"72","Unicode dec":"128473","Unicode hex":"1F5D9"},{"Typeface name":"Webdings","Dingbat dec":"115","Dingbat hex":"73","Unicode dec":"10067","Unicode hex":"2753"},{"Typeface name":"Webdings","Dingbat dec":"116","Dingbat hex":"74","Unicode dec":"128754","Unicode hex":"1F6F2"},{"Typeface name":"Webdings","Dingbat dec":"117","Dingbat hex":"75","Unicode dec":"128647","Unicode hex":"1F687"},{"Typeface name":"Webdings","Dingbat dec":"118","Dingbat hex":"76","Unicode dec":"128653","Unicode hex":"1F68D"},{"Typeface name":"Webdings","Dingbat dec":"119","Dingbat hex":"77","Unicode dec":"9971","Unicode hex":"26F3"},{"Typeface name":"Webdings","Dingbat dec":"120","Dingbat hex":"78","Unicode dec":"10680","Unicode hex":"29B8"},{"Typeface name":"Webdings","Dingbat dec":"121","Dingbat hex":"79","Unicode dec":"8854","Unicode hex":"2296"},{"Typeface name":"Webdings","Dingbat dec":"122","Dingbat hex":"7A","Unicode dec":"128685","Unicode hex":"1F6AD"},{"Typeface name":"Webdings","Dingbat dec":"123","Dingbat hex":"7B","Unicode dec":"128494","Unicode hex":"1F5EE"},{"Typeface name":"Webdings","Dingbat dec":"124","Dingbat hex":"7C","Unicode dec":"9168","Unicode hex":"23D0"},{"Typeface name":"Webdings","Dingbat dec":"125","Dingbat hex":"7D","Unicode dec":"128495","Unicode hex":"1F5EF"},{"Typeface name":"Webdings","Dingbat dec":"126","Dingbat hex":"7E","Unicode dec":"128498","Unicode hex":"1F5F2"},{"Typeface name":"Webdings","Dingbat dec":"128","Dingbat hex":"80","Unicode dec":"128697","Unicode hex":"1F6B9"},{"Typeface name":"Webdings","Dingbat dec":"129","Dingbat hex":"81","Unicode dec":"128698","Unicode hex":"1F6BA"},{"Typeface name":"Webdings","Dingbat dec":"130","Dingbat hex":"82","Unicode dec":"128713","Unicode hex":"1F6C9"},{"Typeface name":"Webdings","Dingbat dec":"131","Dingbat hex":"83","Unicode dec":"128714","Unicode hex":"1F6CA"},{"Typeface name":"Webdings","Dingbat dec":"132","Dingbat hex":"84","Unicode dec":"128700","Unicode hex":"1F6BC"},{"Typeface name":"Webdings","Dingbat dec":"133","Dingbat hex":"85","Unicode dec":"128125","Unicode hex":"1F47D"},{"Typeface name":"Webdings","Dingbat dec":"134","Dingbat hex":"86","Unicode dec":"127947","Unicode hex":"1F3CB"},{"Typeface name":"Webdings","Dingbat dec":"135","Dingbat hex":"87","Unicode dec":"9975","Unicode hex":"26F7"},{"Typeface name":"Webdings","Dingbat dec":"136","Dingbat hex":"88","Unicode dec":"127938","Unicode hex":"1F3C2"},{"Typeface name":"Webdings","Dingbat dec":"137","Dingbat hex":"89","Unicode dec":"127948","Unicode hex":"1F3CC"},{"Typeface name":"Webdings","Dingbat dec":"138","Dingbat hex":"8A","Unicode dec":"127946","Unicode hex":"1F3CA"},{"Typeface name":"Webdings","Dingbat dec":"139","Dingbat hex":"8B","Unicode dec":"127940","Unicode hex":"1F3C4"},{"Typeface name":"Webdings","Dingbat dec":"140","Dingbat hex":"8C","Unicode dec":"127949","Unicode hex":"1F3CD"},{"Typeface name":"Webdings","Dingbat dec":"141","Dingbat hex":"8D","Unicode dec":"127950","Unicode hex":"1F3CE"},{"Typeface name":"Webdings","Dingbat dec":"142","Dingbat hex":"8E","Unicode dec":"128664","Unicode hex":"1F698"},{"Typeface name":"Webdings","Dingbat dec":"143","Dingbat hex":"8F","Unicode dec":"128480","Unicode hex":"1F5E0"},{"Typeface name":"Webdings","Dingbat dec":"144","Dingbat hex":"90","Unicode dec":"128738","Unicode hex":"1F6E2"},{"Typeface name":"Webdings","Dingbat dec":"145","Dingbat hex":"91","Unicode dec":"128176","Unicode hex":"1F4B0"},{"Typeface name":"Webdings","Dingbat dec":"146","Dingbat hex":"92","Unicode dec":"127991","Unicode hex":"1F3F7"},{"Typeface name":"Webdings","Dingbat dec":"147","Dingbat hex":"93","Unicode dec":"128179","Unicode hex":"1F4B3"},{"Typeface name":"Webdings","Dingbat dec":"148","Dingbat hex":"94","Unicode dec":"128106","Unicode hex":"1F46A"},{"Typeface name":"Webdings","Dingbat dec":"149","Dingbat hex":"95","Unicode dec":"128481","Unicode hex":"1F5E1"},{"Typeface name":"Webdings","Dingbat dec":"150","Dingbat hex":"96","Unicode dec":"128482","Unicode hex":"1F5E2"},{"Typeface name":"Webdings","Dingbat dec":"151","Dingbat hex":"97","Unicode dec":"128483","Unicode hex":"1F5E3"},{"Typeface name":"Webdings","Dingbat dec":"152","Dingbat hex":"98","Unicode dec":"10031","Unicode hex":"272F"},{"Typeface name":"Webdings","Dingbat dec":"153","Dingbat hex":"99","Unicode dec":"128388","Unicode hex":"1F584"},{"Typeface name":"Webdings","Dingbat dec":"154","Dingbat hex":"9A","Unicode dec":"128389","Unicode hex":"1F585"},{"Typeface name":"Webdings","Dingbat dec":"155","Dingbat hex":"9B","Unicode dec":"128387","Unicode hex":"1F583"},{"Typeface name":"Webdings","Dingbat dec":"156","Dingbat hex":"9C","Unicode dec":"128390","Unicode hex":"1F586"},{"Typeface name":"Webdings","Dingbat dec":"157","Dingbat hex":"9D","Unicode dec":"128441","Unicode hex":"1F5B9"},{"Typeface name":"Webdings","Dingbat dec":"158","Dingbat hex":"9E","Unicode dec":"128442","Unicode hex":"1F5BA"},{"Typeface name":"Webdings","Dingbat dec":"159","Dingbat hex":"9F","Unicode dec":"128443","Unicode hex":"1F5BB"},{"Typeface name":"Webdings","Dingbat dec":"160","Dingbat hex":"A0","Unicode dec":"128373","Unicode hex":"1F575"},{"Typeface name":"Webdings","Dingbat dec":"161","Dingbat hex":"A1","Unicode dec":"128368","Unicode hex":"1F570"},{"Typeface name":"Webdings","Dingbat dec":"162","Dingbat hex":"A2","Unicode dec":"128445","Unicode hex":"1F5BD"},{"Typeface name":"Webdings","Dingbat dec":"163","Dingbat hex":"A3","Unicode dec":"128446","Unicode hex":"1F5BE"},{"Typeface name":"Webdings","Dingbat dec":"164","Dingbat hex":"A4","Unicode dec":"128203","Unicode hex":"1F4CB"},{"Typeface name":"Webdings","Dingbat dec":"165","Dingbat hex":"A5","Unicode dec":"128466","Unicode hex":"1F5D2"},{"Typeface name":"Webdings","Dingbat dec":"166","Dingbat hex":"A6","Unicode dec":"128467","Unicode hex":"1F5D3"},{"Typeface name":"Webdings","Dingbat dec":"167","Dingbat hex":"A7","Unicode dec":"128366","Unicode hex":"1F56E"},{"Typeface name":"Webdings","Dingbat dec":"168","Dingbat hex":"A8","Unicode dec":"128218","Unicode hex":"1F4DA"},{"Typeface name":"Webdings","Dingbat dec":"169","Dingbat hex":"A9","Unicode dec":"128478","Unicode hex":"1F5DE"},{"Typeface name":"Webdings","Dingbat dec":"170","Dingbat hex":"AA","Unicode dec":"128479","Unicode hex":"1F5DF"},{"Typeface name":"Webdings","Dingbat dec":"171","Dingbat hex":"AB","Unicode dec":"128451","Unicode hex":"1F5C3"},{"Typeface name":"Webdings","Dingbat dec":"172","Dingbat hex":"AC","Unicode dec":"128450","Unicode hex":"1F5C2"},{"Typeface name":"Webdings","Dingbat dec":"173","Dingbat hex":"AD","Unicode dec":"128444","Unicode hex":"1F5BC"},{"Typeface name":"Webdings","Dingbat dec":"174","Dingbat hex":"AE","Unicode dec":"127917","Unicode hex":"1F3AD"},{"Typeface name":"Webdings","Dingbat dec":"175","Dingbat hex":"AF","Unicode dec":"127900","Unicode hex":"1F39C"},{"Typeface name":"Webdings","Dingbat dec":"176","Dingbat hex":"B0","Unicode dec":"127896","Unicode hex":"1F398"},{"Typeface name":"Webdings","Dingbat dec":"177","Dingbat hex":"B1","Unicode dec":"127897","Unicode hex":"1F399"},{"Typeface name":"Webdings","Dingbat dec":"178","Dingbat hex":"B2","Unicode dec":"127911","Unicode hex":"1F3A7"},{"Typeface name":"Webdings","Dingbat dec":"179","Dingbat hex":"B3","Unicode dec":"128191","Unicode hex":"1F4BF"},{"Typeface name":"Webdings","Dingbat dec":"180","Dingbat hex":"B4","Unicode dec":"127902","Unicode hex":"1F39E"},{"Typeface name":"Webdings","Dingbat dec":"181","Dingbat hex":"B5","Unicode dec":"128247","Unicode hex":"1F4F7"},{"Typeface name":"Webdings","Dingbat dec":"182","Dingbat hex":"B6","Unicode dec":"127903","Unicode hex":"1F39F"},{"Typeface name":"Webdings","Dingbat dec":"183","Dingbat hex":"B7","Unicode dec":"127916","Unicode hex":"1F3AC"},{"Typeface name":"Webdings","Dingbat dec":"184","Dingbat hex":"B8","Unicode dec":"128253","Unicode hex":"1F4FD"},{"Typeface name":"Webdings","Dingbat dec":"185","Dingbat hex":"B9","Unicode dec":"128249","Unicode hex":"1F4F9"},{"Typeface name":"Webdings","Dingbat dec":"186","Dingbat hex":"BA","Unicode dec":"128254","Unicode hex":"1F4FE"},{"Typeface name":"Webdings","Dingbat dec":"187","Dingbat hex":"BB","Unicode dec":"128251","Unicode hex":"1F4FB"},{"Typeface name":"Webdings","Dingbat dec":"188","Dingbat hex":"BC","Unicode dec":"127898","Unicode hex":"1F39A"},{"Typeface name":"Webdings","Dingbat dec":"189","Dingbat hex":"BD","Unicode dec":"127899","Unicode hex":"1F39B"},{"Typeface name":"Webdings","Dingbat dec":"190","Dingbat hex":"BE","Unicode dec":"128250","Unicode hex":"1F4FA"},{"Typeface name":"Webdings","Dingbat dec":"191","Dingbat hex":"BF","Unicode dec":"128187","Unicode hex":"1F4BB"},{"Typeface name":"Webdings","Dingbat dec":"192","Dingbat hex":"C0","Unicode dec":"128421","Unicode hex":"1F5A5"},{"Typeface name":"Webdings","Dingbat dec":"193","Dingbat hex":"C1","Unicode dec":"128422","Unicode hex":"1F5A6"},{"Typeface name":"Webdings","Dingbat dec":"194","Dingbat hex":"C2","Unicode dec":"128423","Unicode hex":"1F5A7"},{"Typeface name":"Webdings","Dingbat dec":"195","Dingbat hex":"C3","Unicode dec":"128377","Unicode hex":"1F579"},{"Typeface name":"Webdings","Dingbat dec":"196","Dingbat hex":"C4","Unicode dec":"127918","Unicode hex":"1F3AE"},{"Typeface name":"Webdings","Dingbat dec":"197","Dingbat hex":"C5","Unicode dec":"128379","Unicode hex":"1F57B"},{"Typeface name":"Webdings","Dingbat dec":"198","Dingbat hex":"C6","Unicode dec":"128380","Unicode hex":"1F57C"},{"Typeface name":"Webdings","Dingbat dec":"199","Dingbat hex":"C7","Unicode dec":"128223","Unicode hex":"1F4DF"},{"Typeface name":"Webdings","Dingbat dec":"200","Dingbat hex":"C8","Unicode dec":"128385","Unicode hex":"1F581"},{"Typeface name":"Webdings","Dingbat dec":"201","Dingbat hex":"C9","Unicode dec":"128384","Unicode hex":"1F580"},{"Typeface name":"Webdings","Dingbat dec":"202","Dingbat hex":"CA","Unicode dec":"128424","Unicode hex":"1F5A8"},{"Typeface name":"Webdings","Dingbat dec":"203","Dingbat hex":"CB","Unicode dec":"128425","Unicode hex":"1F5A9"},{"Typeface name":"Webdings","Dingbat dec":"204","Dingbat hex":"CC","Unicode dec":"128447","Unicode hex":"1F5BF"},{"Typeface name":"Webdings","Dingbat dec":"205","Dingbat hex":"CD","Unicode dec":"128426","Unicode hex":"1F5AA"},{"Typeface name":"Webdings","Dingbat dec":"206","Dingbat hex":"CE","Unicode dec":"128476","Unicode hex":"1F5DC"},{"Typeface name":"Webdings","Dingbat dec":"207","Dingbat hex":"CF","Unicode dec":"128274","Unicode hex":"1F512"},{"Typeface name":"Webdings","Dingbat dec":"208","Dingbat hex":"D0","Unicode dec":"128275","Unicode hex":"1F513"},{"Typeface name":"Webdings","Dingbat dec":"209","Dingbat hex":"D1","Unicode dec":"128477","Unicode hex":"1F5DD"},{"Typeface name":"Webdings","Dingbat dec":"210","Dingbat hex":"D2","Unicode dec":"128229","Unicode hex":"1F4E5"},{"Typeface name":"Webdings","Dingbat dec":"211","Dingbat hex":"D3","Unicode dec":"128228","Unicode hex":"1F4E4"},{"Typeface name":"Webdings","Dingbat dec":"212","Dingbat hex":"D4","Unicode dec":"128371","Unicode hex":"1F573"},{"Typeface name":"Webdings","Dingbat dec":"213","Dingbat hex":"D5","Unicode dec":"127779","Unicode hex":"1F323"},{"Typeface name":"Webdings","Dingbat dec":"214","Dingbat hex":"D6","Unicode dec":"127780","Unicode hex":"1F324"},{"Typeface name":"Webdings","Dingbat dec":"215","Dingbat hex":"D7","Unicode dec":"127781","Unicode hex":"1F325"},{"Typeface name":"Webdings","Dingbat dec":"216","Dingbat hex":"D8","Unicode dec":"127782","Unicode hex":"1F326"},{"Typeface name":"Webdings","Dingbat dec":"217","Dingbat hex":"D9","Unicode dec":"9729","Unicode hex":"2601"},{"Typeface name":"Webdings","Dingbat dec":"218","Dingbat hex":"DA","Unicode dec":"127784","Unicode hex":"1F328"},{"Typeface name":"Webdings","Dingbat dec":"219","Dingbat hex":"DB","Unicode dec":"127783","Unicode hex":"1F327"},{"Typeface name":"Webdings","Dingbat dec":"220","Dingbat hex":"DC","Unicode dec":"127785","Unicode hex":"1F329"},{"Typeface name":"Webdings","Dingbat dec":"221","Dingbat hex":"DD","Unicode dec":"127786","Unicode hex":"1F32A"},{"Typeface name":"Webdings","Dingbat dec":"222","Dingbat hex":"DE","Unicode dec":"127788","Unicode hex":"1F32C"},{"Typeface name":"Webdings","Dingbat dec":"223","Dingbat hex":"DF","Unicode dec":"127787","Unicode hex":"1F32B"},{"Typeface name":"Webdings","Dingbat dec":"224","Dingbat hex":"E0","Unicode dec":"127772","Unicode hex":"1F31C"},{"Typeface name":"Webdings","Dingbat dec":"225","Dingbat hex":"E1","Unicode dec":"127777","Unicode hex":"1F321"},{"Typeface name":"Webdings","Dingbat dec":"226","Dingbat hex":"E2","Unicode dec":"128715","Unicode hex":"1F6CB"},{"Typeface name":"Webdings","Dingbat dec":"227","Dingbat hex":"E3","Unicode dec":"128719","Unicode hex":"1F6CF"},{"Typeface name":"Webdings","Dingbat dec":"228","Dingbat hex":"E4","Unicode dec":"127869","Unicode hex":"1F37D"},{"Typeface name":"Webdings","Dingbat dec":"229","Dingbat hex":"E5","Unicode dec":"127864","Unicode hex":"1F378"},{"Typeface name":"Webdings","Dingbat dec":"230","Dingbat hex":"E6","Unicode dec":"128718","Unicode hex":"1F6CE"},{"Typeface name":"Webdings","Dingbat dec":"231","Dingbat hex":"E7","Unicode dec":"128717","Unicode hex":"1F6CD"},{"Typeface name":"Webdings","Dingbat dec":"232","Dingbat hex":"E8","Unicode dec":"9413","Unicode hex":"24C5"},{"Typeface name":"Webdings","Dingbat dec":"233","Dingbat hex":"E9","Unicode dec":"9855","Unicode hex":"267F"},{"Typeface name":"Webdings","Dingbat dec":"234","Dingbat hex":"EA","Unicode dec":"128710","Unicode hex":"1F6C6"},{"Typeface name":"Webdings","Dingbat dec":"235","Dingbat hex":"EB","Unicode dec":"128392","Unicode hex":"1F588"},{"Typeface name":"Webdings","Dingbat dec":"236","Dingbat hex":"EC","Unicode dec":"127891","Unicode hex":"1F393"},{"Typeface name":"Webdings","Dingbat dec":"237","Dingbat hex":"ED","Unicode dec":"128484","Unicode hex":"1F5E4"},{"Typeface name":"Webdings","Dingbat dec":"238","Dingbat hex":"EE","Unicode dec":"128485","Unicode hex":"1F5E5"},{"Typeface name":"Webdings","Dingbat dec":"239","Dingbat hex":"EF","Unicode dec":"128486","Unicode hex":"1F5E6"},{"Typeface name":"Webdings","Dingbat dec":"240","Dingbat hex":"F0","Unicode dec":"128487","Unicode hex":"1F5E7"},{"Typeface name":"Webdings","Dingbat dec":"241","Dingbat hex":"F1","Unicode dec":"128746","Unicode hex":"1F6EA"},{"Typeface name":"Webdings","Dingbat dec":"242","Dingbat hex":"F2","Unicode dec":"128063","Unicode hex":"1F43F"},{"Typeface name":"Webdings","Dingbat dec":"243","Dingbat hex":"F3","Unicode dec":"128038","Unicode hex":"1F426"},{"Typeface name":"Webdings","Dingbat dec":"244","Dingbat hex":"F4","Unicode dec":"128031","Unicode hex":"1F41F"},{"Typeface name":"Webdings","Dingbat dec":"245","Dingbat hex":"F5","Unicode dec":"128021","Unicode hex":"1F415"},{"Typeface name":"Webdings","Dingbat dec":"246","Dingbat hex":"F6","Unicode dec":"128008","Unicode hex":"1F408"},{"Typeface name":"Webdings","Dingbat dec":"247","Dingbat hex":"F7","Unicode dec":"128620","Unicode hex":"1F66C"},{"Typeface name":"Webdings","Dingbat dec":"248","Dingbat hex":"F8","Unicode dec":"128622","Unicode hex":"1F66E"},{"Typeface name":"Webdings","Dingbat dec":"249","Dingbat hex":"F9","Unicode dec":"128621","Unicode hex":"1F66D"},{"Typeface name":"Webdings","Dingbat dec":"250","Dingbat hex":"FA","Unicode dec":"128623","Unicode hex":"1F66F"},{"Typeface name":"Webdings","Dingbat dec":"251","Dingbat hex":"FB","Unicode dec":"128506","Unicode hex":"1F5FA"},{"Typeface name":"Webdings","Dingbat dec":"252","Dingbat hex":"FC","Unicode dec":"127757","Unicode hex":"1F30D"},{"Typeface name":"Webdings","Dingbat dec":"253","Dingbat hex":"FD","Unicode dec":"127759","Unicode hex":"1F30F"},{"Typeface name":"Webdings","Dingbat dec":"254","Dingbat hex":"FE","Unicode dec":"127758","Unicode hex":"1F30E"},{"Typeface name":"Webdings","Dingbat dec":"255","Dingbat hex":"FF","Unicode dec":"128330","Unicode hex":"1F54A"},{"Typeface name":"Wingdings","Dingbat dec":"32","Dingbat hex":"20","Unicode dec":"32","Unicode hex":"20"},{"Typeface name":"Wingdings","Dingbat dec":"33","Dingbat hex":"21","Unicode dec":"128393","Unicode hex":"1F589"},{"Typeface name":"Wingdings","Dingbat dec":"34","Dingbat hex":"22","Unicode dec":"9986","Unicode hex":"2702"},{"Typeface name":"Wingdings","Dingbat dec":"35","Dingbat hex":"23","Unicode dec":"9985","Unicode hex":"2701"},{"Typeface name":"Wingdings","Dingbat dec":"36","Dingbat hex":"24","Unicode dec":"128083","Unicode hex":"1F453"},{"Typeface name":"Wingdings","Dingbat dec":"37","Dingbat hex":"25","Unicode dec":"128365","Unicode hex":"1F56D"},{"Typeface name":"Wingdings","Dingbat dec":"38","Dingbat hex":"26","Unicode dec":"128366","Unicode hex":"1F56E"},{"Typeface name":"Wingdings","Dingbat dec":"39","Dingbat hex":"27","Unicode dec":"128367","Unicode hex":"1F56F"},{"Typeface name":"Wingdings","Dingbat dec":"40","Dingbat hex":"28","Unicode dec":"128383","Unicode hex":"1F57F"},{"Typeface name":"Wingdings","Dingbat dec":"41","Dingbat hex":"29","Unicode dec":"9990","Unicode hex":"2706"},{"Typeface name":"Wingdings","Dingbat dec":"42","Dingbat hex":"2A","Unicode dec":"128386","Unicode hex":"1F582"},{"Typeface name":"Wingdings","Dingbat dec":"43","Dingbat hex":"2B","Unicode dec":"128387","Unicode hex":"1F583"},{"Typeface name":"Wingdings","Dingbat dec":"44","Dingbat hex":"2C","Unicode dec":"128234","Unicode hex":"1F4EA"},{"Typeface name":"Wingdings","Dingbat dec":"45","Dingbat hex":"2D","Unicode dec":"128235","Unicode hex":"1F4EB"},{"Typeface name":"Wingdings","Dingbat dec":"46","Dingbat hex":"2E","Unicode dec":"128236","Unicode hex":"1F4EC"},{"Typeface name":"Wingdings","Dingbat dec":"47","Dingbat hex":"2F","Unicode dec":"128237","Unicode hex":"1F4ED"},{"Typeface name":"Wingdings","Dingbat dec":"48","Dingbat hex":"30","Unicode dec":"128448","Unicode hex":"1F5C0"},{"Typeface name":"Wingdings","Dingbat dec":"49","Dingbat hex":"31","Unicode dec":"128449","Unicode hex":"1F5C1"},{"Typeface name":"Wingdings","Dingbat dec":"50","Dingbat hex":"32","Unicode dec":"128462","Unicode hex":"1F5CE"},{"Typeface name":"Wingdings","Dingbat dec":"51","Dingbat hex":"33","Unicode dec":"128463","Unicode hex":"1F5CF"},{"Typeface name":"Wingdings","Dingbat dec":"52","Dingbat hex":"34","Unicode dec":"128464","Unicode hex":"1F5D0"},{"Typeface name":"Wingdings","Dingbat dec":"53","Dingbat hex":"35","Unicode dec":"128452","Unicode hex":"1F5C4"},{"Typeface name":"Wingdings","Dingbat dec":"54","Dingbat hex":"36","Unicode dec":"8987","Unicode hex":"231B"},{"Typeface name":"Wingdings","Dingbat dec":"55","Dingbat hex":"37","Unicode dec":"128430","Unicode hex":"1F5AE"},{"Typeface name":"Wingdings","Dingbat dec":"56","Dingbat hex":"38","Unicode dec":"128432","Unicode hex":"1F5B0"},{"Typeface name":"Wingdings","Dingbat dec":"57","Dingbat hex":"39","Unicode dec":"128434","Unicode hex":"1F5B2"},{"Typeface name":"Wingdings","Dingbat dec":"58","Dingbat hex":"3A","Unicode dec":"128435","Unicode hex":"1F5B3"},{"Typeface name":"Wingdings","Dingbat dec":"59","Dingbat hex":"3B","Unicode dec":"128436","Unicode hex":"1F5B4"},{"Typeface name":"Wingdings","Dingbat dec":"60","Dingbat hex":"3C","Unicode dec":"128427","Unicode hex":"1F5AB"},{"Typeface name":"Wingdings","Dingbat dec":"61","Dingbat hex":"3D","Unicode dec":"128428","Unicode hex":"1F5AC"},{"Typeface name":"Wingdings","Dingbat dec":"62","Dingbat hex":"3E","Unicode dec":"9991","Unicode hex":"2707"},{"Typeface name":"Wingdings","Dingbat dec":"63","Dingbat hex":"3F","Unicode dec":"9997","Unicode hex":"270D"},{"Typeface name":"Wingdings","Dingbat dec":"64","Dingbat hex":"40","Unicode dec":"128398","Unicode hex":"1F58E"},{"Typeface name":"Wingdings","Dingbat dec":"65","Dingbat hex":"41","Unicode dec":"9996","Unicode hex":"270C"},{"Typeface name":"Wingdings","Dingbat dec":"66","Dingbat hex":"42","Unicode dec":"128399","Unicode hex":"1F58F"},{"Typeface name":"Wingdings","Dingbat dec":"67","Dingbat hex":"43","Unicode dec":"128077","Unicode hex":"1F44D"},{"Typeface name":"Wingdings","Dingbat dec":"68","Dingbat hex":"44","Unicode dec":"128078","Unicode hex":"1F44E"},{"Typeface name":"Wingdings","Dingbat dec":"69","Dingbat hex":"45","Unicode dec":"9756","Unicode hex":"261C"},{"Typeface name":"Wingdings","Dingbat dec":"70","Dingbat hex":"46","Unicode dec":"9758","Unicode hex":"261E"},{"Typeface name":"Wingdings","Dingbat dec":"71","Dingbat hex":"47","Unicode dec":"9757","Unicode hex":"261D"},{"Typeface name":"Wingdings","Dingbat dec":"72","Dingbat hex":"48","Unicode dec":"9759","Unicode hex":"261F"},{"Typeface name":"Wingdings","Dingbat dec":"73","Dingbat hex":"49","Unicode dec":"128400","Unicode hex":"1F590"},{"Typeface name":"Wingdings","Dingbat dec":"74","Dingbat hex":"4A","Unicode dec":"9786","Unicode hex":"263A"},{"Typeface name":"Wingdings","Dingbat dec":"75","Dingbat hex":"4B","Unicode dec":"128528","Unicode hex":"1F610"},{"Typeface name":"Wingdings","Dingbat dec":"76","Dingbat hex":"4C","Unicode dec":"9785","Unicode hex":"2639"},{"Typeface name":"Wingdings","Dingbat dec":"77","Dingbat hex":"4D","Unicode dec":"128163","Unicode hex":"1F4A3"},{"Typeface name":"Wingdings","Dingbat dec":"78","Dingbat hex":"4E","Unicode dec":"128369","Unicode hex":"1F571"},{"Typeface name":"Wingdings","Dingbat dec":"79","Dingbat hex":"4F","Unicode dec":"127987","Unicode hex":"1F3F3"},{"Typeface name":"Wingdings","Dingbat dec":"80","Dingbat hex":"50","Unicode dec":"127985","Unicode hex":"1F3F1"},{"Typeface name":"Wingdings","Dingbat dec":"81","Dingbat hex":"51","Unicode dec":"9992","Unicode hex":"2708"},{"Typeface name":"Wingdings","Dingbat dec":"82","Dingbat hex":"52","Unicode dec":"9788","Unicode hex":"263C"},{"Typeface name":"Wingdings","Dingbat dec":"83","Dingbat hex":"53","Unicode dec":"127778","Unicode hex":"1F322"},{"Typeface name":"Wingdings","Dingbat dec":"84","Dingbat hex":"54","Unicode dec":"10052","Unicode hex":"2744"},{"Typeface name":"Wingdings","Dingbat dec":"85","Dingbat hex":"55","Unicode dec":"128326","Unicode hex":"1F546"},{"Typeface name":"Wingdings","Dingbat dec":"86","Dingbat hex":"56","Unicode dec":"10014","Unicode hex":"271E"},{"Typeface name":"Wingdings","Dingbat dec":"87","Dingbat hex":"57","Unicode dec":"128328","Unicode hex":"1F548"},{"Typeface name":"Wingdings","Dingbat dec":"88","Dingbat hex":"58","Unicode dec":"10016","Unicode hex":"2720"},{"Typeface name":"Wingdings","Dingbat dec":"89","Dingbat hex":"59","Unicode dec":"10017","Unicode hex":"2721"},{"Typeface name":"Wingdings","Dingbat dec":"90","Dingbat hex":"5A","Unicode dec":"9770","Unicode hex":"262A"},{"Typeface name":"Wingdings","Dingbat dec":"91","Dingbat hex":"5B","Unicode dec":"9775","Unicode hex":"262F"},{"Typeface name":"Wingdings","Dingbat dec":"92","Dingbat hex":"5C","Unicode dec":"128329","Unicode hex":"1F549"},{"Typeface name":"Wingdings","Dingbat dec":"93","Dingbat hex":"5D","Unicode dec":"9784","Unicode hex":"2638"},{"Typeface name":"Wingdings","Dingbat dec":"94","Dingbat hex":"5E","Unicode dec":"9800","Unicode hex":"2648"},{"Typeface name":"Wingdings","Dingbat dec":"95","Dingbat hex":"5F","Unicode dec":"9801","Unicode hex":"2649"},{"Typeface name":"Wingdings","Dingbat dec":"96","Dingbat hex":"60","Unicode dec":"9802","Unicode hex":"264A"},{"Typeface name":"Wingdings","Dingbat dec":"97","Dingbat hex":"61","Unicode dec":"9803","Unicode hex":"264B"},{"Typeface name":"Wingdings","Dingbat dec":"98","Dingbat hex":"62","Unicode dec":"9804","Unicode hex":"264C"},{"Typeface name":"Wingdings","Dingbat dec":"99","Dingbat hex":"63","Unicode dec":"9805","Unicode hex":"264D"},{"Typeface name":"Wingdings","Dingbat dec":"100","Dingbat hex":"64","Unicode dec":"9806","Unicode hex":"264E"},{"Typeface name":"Wingdings","Dingbat dec":"101","Dingbat hex":"65","Unicode dec":"9807","Unicode hex":"264F"},{"Typeface name":"Wingdings","Dingbat dec":"102","Dingbat hex":"66","Unicode dec":"9808","Unicode hex":"2650"},{"Typeface name":"Wingdings","Dingbat dec":"103","Dingbat hex":"67","Unicode dec":"9809","Unicode hex":"2651"},{"Typeface name":"Wingdings","Dingbat dec":"104","Dingbat hex":"68","Unicode dec":"9810","Unicode hex":"2652"},{"Typeface name":"Wingdings","Dingbat dec":"105","Dingbat hex":"69","Unicode dec":"9811","Unicode hex":"2653"},{"Typeface name":"Wingdings","Dingbat dec":"106","Dingbat hex":"6A","Unicode dec":"128624","Unicode hex":"1F670"},{"Typeface name":"Wingdings","Dingbat dec":"107","Dingbat hex":"6B","Unicode dec":"128629","Unicode hex":"1F675"},{"Typeface name":"Wingdings","Dingbat dec":"108","Dingbat hex":"6C","Unicode dec":"9899","Unicode hex":"26AB"},{"Typeface name":"Wingdings","Dingbat dec":"109","Dingbat hex":"6D","Unicode dec":"128318","Unicode hex":"1F53E"},{"Typeface name":"Wingdings","Dingbat dec":"110","Dingbat hex":"6E","Unicode dec":"9724","Unicode hex":"25FC"},{"Typeface name":"Wingdings","Dingbat dec":"111","Dingbat hex":"6F","Unicode dec":"128911","Unicode hex":"1F78F"},{"Typeface name":"Wingdings","Dingbat dec":"112","Dingbat hex":"70","Unicode dec":"128912","Unicode hex":"1F790"},{"Typeface name":"Wingdings","Dingbat dec":"113","Dingbat hex":"71","Unicode dec":"10065","Unicode hex":"2751"},{"Typeface name":"Wingdings","Dingbat dec":"114","Dingbat hex":"72","Unicode dec":"10066","Unicode hex":"2752"},{"Typeface name":"Wingdings","Dingbat dec":"115","Dingbat hex":"73","Unicode dec":"128927","Unicode hex":"1F79F"},{"Typeface name":"Wingdings","Dingbat dec":"116","Dingbat hex":"74","Unicode dec":"10731","Unicode hex":"29EB"},{"Typeface name":"Wingdings","Dingbat dec":"117","Dingbat hex":"75","Unicode dec":"9670","Unicode hex":"25C6"},{"Typeface name":"Wingdings","Dingbat dec":"118","Dingbat hex":"76","Unicode dec":"10070","Unicode hex":"2756"},{"Typeface name":"Wingdings","Dingbat dec":"119","Dingbat hex":"77","Unicode dec":"11049","Unicode hex":"2B29"},{"Typeface name":"Wingdings","Dingbat dec":"120","Dingbat hex":"78","Unicode dec":"8999","Unicode hex":"2327"},{"Typeface name":"Wingdings","Dingbat dec":"121","Dingbat hex":"79","Unicode dec":"11193","Unicode hex":"2BB9"},{"Typeface name":"Wingdings","Dingbat dec":"122","Dingbat hex":"7A","Unicode dec":"8984","Unicode hex":"2318"},{"Typeface name":"Wingdings","Dingbat dec":"123","Dingbat hex":"7B","Unicode dec":"127989","Unicode hex":"1F3F5"},{"Typeface name":"Wingdings","Dingbat dec":"124","Dingbat hex":"7C","Unicode dec":"127990","Unicode hex":"1F3F6"},{"Typeface name":"Wingdings","Dingbat dec":"125","Dingbat hex":"7D","Unicode dec":"128630","Unicode hex":"1F676"},{"Typeface name":"Wingdings","Dingbat dec":"126","Dingbat hex":"7E","Unicode dec":"128631","Unicode hex":"1F677"},{"Typeface name":"Wingdings","Dingbat dec":"127","Dingbat hex":"7F","Unicode dec":"9647","Unicode hex":"25AF"},{"Typeface name":"Wingdings","Dingbat dec":"128","Dingbat hex":"80","Unicode dec":"127243","Unicode hex":"1F10B"},{"Typeface name":"Wingdings","Dingbat dec":"129","Dingbat hex":"81","Unicode dec":"10112","Unicode hex":"2780"},{"Typeface name":"Wingdings","Dingbat dec":"130","Dingbat hex":"82","Unicode dec":"10113","Unicode hex":"2781"},{"Typeface name":"Wingdings","Dingbat dec":"131","Dingbat hex":"83","Unicode dec":"10114","Unicode hex":"2782"},{"Typeface name":"Wingdings","Dingbat dec":"132","Dingbat hex":"84","Unicode dec":"10115","Unicode hex":"2783"},{"Typeface name":"Wingdings","Dingbat dec":"133","Dingbat hex":"85","Unicode dec":"10116","Unicode hex":"2784"},{"Typeface name":"Wingdings","Dingbat dec":"134","Dingbat hex":"86","Unicode dec":"10117","Unicode hex":"2785"},{"Typeface name":"Wingdings","Dingbat dec":"135","Dingbat hex":"87","Unicode dec":"10118","Unicode hex":"2786"},{"Typeface name":"Wingdings","Dingbat dec":"136","Dingbat hex":"88","Unicode dec":"10119","Unicode hex":"2787"},{"Typeface name":"Wingdings","Dingbat dec":"137","Dingbat hex":"89","Unicode dec":"10120","Unicode hex":"2788"},{"Typeface name":"Wingdings","Dingbat dec":"138","Dingbat hex":"8A","Unicode dec":"10121","Unicode hex":"2789"},{"Typeface name":"Wingdings","Dingbat dec":"139","Dingbat hex":"8B","Unicode dec":"127244","Unicode hex":"1F10C"},{"Typeface name":"Wingdings","Dingbat dec":"140","Dingbat hex":"8C","Unicode dec":"10122","Unicode hex":"278A"},{"Typeface name":"Wingdings","Dingbat dec":"141","Dingbat hex":"8D","Unicode dec":"10123","Unicode hex":"278B"},{"Typeface name":"Wingdings","Dingbat dec":"142","Dingbat hex":"8E","Unicode dec":"10124","Unicode hex":"278C"},{"Typeface name":"Wingdings","Dingbat dec":"143","Dingbat hex":"8F","Unicode dec":"10125","Unicode hex":"278D"},{"Typeface name":"Wingdings","Dingbat dec":"144","Dingbat hex":"90","Unicode dec":"10126","Unicode hex":"278E"},{"Typeface name":"Wingdings","Dingbat dec":"145","Dingbat hex":"91","Unicode dec":"10127","Unicode hex":"278F"},{"Typeface name":"Wingdings","Dingbat dec":"146","Dingbat hex":"92","Unicode dec":"10128","Unicode hex":"2790"},{"Typeface name":"Wingdings","Dingbat dec":"147","Dingbat hex":"93","Unicode dec":"10129","Unicode hex":"2791"},{"Typeface name":"Wingdings","Dingbat dec":"148","Dingbat hex":"94","Unicode dec":"10130","Unicode hex":"2792"},{"Typeface name":"Wingdings","Dingbat dec":"149","Dingbat hex":"95","Unicode dec":"10131","Unicode hex":"2793"},{"Typeface name":"Wingdings","Dingbat dec":"150","Dingbat hex":"96","Unicode dec":"128610","Unicode hex":"1F662"},{"Typeface name":"Wingdings","Dingbat dec":"151","Dingbat hex":"97","Unicode dec":"128608","Unicode hex":"1F660"},{"Typeface name":"Wingdings","Dingbat dec":"152","Dingbat hex":"98","Unicode dec":"128609","Unicode hex":"1F661"},{"Typeface name":"Wingdings","Dingbat dec":"153","Dingbat hex":"99","Unicode dec":"128611","Unicode hex":"1F663"},{"Typeface name":"Wingdings","Dingbat dec":"154","Dingbat hex":"9A","Unicode dec":"128606","Unicode hex":"1F65E"},{"Typeface name":"Wingdings","Dingbat dec":"155","Dingbat hex":"9B","Unicode dec":"128604","Unicode hex":"1F65C"},{"Typeface name":"Wingdings","Dingbat dec":"156","Dingbat hex":"9C","Unicode dec":"128605","Unicode hex":"1F65D"},{"Typeface name":"Wingdings","Dingbat dec":"157","Dingbat hex":"9D","Unicode dec":"128607","Unicode hex":"1F65F"},{"Typeface name":"Wingdings","Dingbat dec":"158","Dingbat hex":"9E","Unicode dec":"8729","Unicode hex":"2219"},{"Typeface name":"Wingdings","Dingbat dec":"159","Dingbat hex":"9F","Unicode dec":"8226","Unicode hex":"2022"},{"Typeface name":"Wingdings","Dingbat dec":"160","Dingbat hex":"A0","Unicode dec":"11037","Unicode hex":"2B1D"},{"Typeface name":"Wingdings","Dingbat dec":"161","Dingbat hex":"A1","Unicode dec":"11096","Unicode hex":"2B58"},{"Typeface name":"Wingdings","Dingbat dec":"162","Dingbat hex":"A2","Unicode dec":"128902","Unicode hex":"1F786"},{"Typeface name":"Wingdings","Dingbat dec":"163","Dingbat hex":"A3","Unicode dec":"128904","Unicode hex":"1F788"},{"Typeface name":"Wingdings","Dingbat dec":"164","Dingbat hex":"A4","Unicode dec":"128906","Unicode hex":"1F78A"},{"Typeface name":"Wingdings","Dingbat dec":"165","Dingbat hex":"A5","Unicode dec":"128907","Unicode hex":"1F78B"},{"Typeface name":"Wingdings","Dingbat dec":"166","Dingbat hex":"A6","Unicode dec":"128319","Unicode hex":"1F53F"},{"Typeface name":"Wingdings","Dingbat dec":"167","Dingbat hex":"A7","Unicode dec":"9642","Unicode hex":"25AA"},{"Typeface name":"Wingdings","Dingbat dec":"168","Dingbat hex":"A8","Unicode dec":"128910","Unicode hex":"1F78E"},{"Typeface name":"Wingdings","Dingbat dec":"169","Dingbat hex":"A9","Unicode dec":"128961","Unicode hex":"1F7C1"},{"Typeface name":"Wingdings","Dingbat dec":"170","Dingbat hex":"AA","Unicode dec":"128965","Unicode hex":"1F7C5"},{"Typeface name":"Wingdings","Dingbat dec":"171","Dingbat hex":"AB","Unicode dec":"9733","Unicode hex":"2605"},{"Typeface name":"Wingdings","Dingbat dec":"172","Dingbat hex":"AC","Unicode dec":"128971","Unicode hex":"1F7CB"},{"Typeface name":"Wingdings","Dingbat dec":"173","Dingbat hex":"AD","Unicode dec":"128975","Unicode hex":"1F7CF"},{"Typeface name":"Wingdings","Dingbat dec":"174","Dingbat hex":"AE","Unicode dec":"128979","Unicode hex":"1F7D3"},{"Typeface name":"Wingdings","Dingbat dec":"175","Dingbat hex":"AF","Unicode dec":"128977","Unicode hex":"1F7D1"},{"Typeface name":"Wingdings","Dingbat dec":"176","Dingbat hex":"B0","Unicode dec":"11216","Unicode hex":"2BD0"},{"Typeface name":"Wingdings","Dingbat dec":"177","Dingbat hex":"B1","Unicode dec":"8982","Unicode hex":"2316"},{"Typeface name":"Wingdings","Dingbat dec":"178","Dingbat hex":"B2","Unicode dec":"11214","Unicode hex":"2BCE"},{"Typeface name":"Wingdings","Dingbat dec":"179","Dingbat hex":"B3","Unicode dec":"11215","Unicode hex":"2BCF"},{"Typeface name":"Wingdings","Dingbat dec":"180","Dingbat hex":"B4","Unicode dec":"11217","Unicode hex":"2BD1"},{"Typeface name":"Wingdings","Dingbat dec":"181","Dingbat hex":"B5","Unicode dec":"10026","Unicode hex":"272A"},{"Typeface name":"Wingdings","Dingbat dec":"182","Dingbat hex":"B6","Unicode dec":"10032","Unicode hex":"2730"},{"Typeface name":"Wingdings","Dingbat dec":"183","Dingbat hex":"B7","Unicode dec":"128336","Unicode hex":"1F550"},{"Typeface name":"Wingdings","Dingbat dec":"184","Dingbat hex":"B8","Unicode dec":"128337","Unicode hex":"1F551"},{"Typeface name":"Wingdings","Dingbat dec":"185","Dingbat hex":"B9","Unicode dec":"128338","Unicode hex":"1F552"},{"Typeface name":"Wingdings","Dingbat dec":"186","Dingbat hex":"BA","Unicode dec":"128339","Unicode hex":"1F553"},{"Typeface name":"Wingdings","Dingbat dec":"187","Dingbat hex":"BB","Unicode dec":"128340","Unicode hex":"1F554"},{"Typeface name":"Wingdings","Dingbat dec":"188","Dingbat hex":"BC","Unicode dec":"128341","Unicode hex":"1F555"},{"Typeface name":"Wingdings","Dingbat dec":"189","Dingbat hex":"BD","Unicode dec":"128342","Unicode hex":"1F556"},{"Typeface name":"Wingdings","Dingbat dec":"190","Dingbat hex":"BE","Unicode dec":"128343","Unicode hex":"1F557"},{"Typeface name":"Wingdings","Dingbat dec":"191","Dingbat hex":"BF","Unicode dec":"128344","Unicode hex":"1F558"},{"Typeface name":"Wingdings","Dingbat dec":"192","Dingbat hex":"C0","Unicode dec":"128345","Unicode hex":"1F559"},{"Typeface name":"Wingdings","Dingbat dec":"193","Dingbat hex":"C1","Unicode dec":"128346","Unicode hex":"1F55A"},{"Typeface name":"Wingdings","Dingbat dec":"194","Dingbat hex":"C2","Unicode dec":"128347","Unicode hex":"1F55B"},{"Typeface name":"Wingdings","Dingbat dec":"195","Dingbat hex":"C3","Unicode dec":"11184","Unicode hex":"2BB0"},{"Typeface name":"Wingdings","Dingbat dec":"196","Dingbat hex":"C4","Unicode dec":"11185","Unicode hex":"2BB1"},{"Typeface name":"Wingdings","Dingbat dec":"197","Dingbat hex":"C5","Unicode dec":"11186","Unicode hex":"2BB2"},{"Typeface name":"Wingdings","Dingbat dec":"198","Dingbat hex":"C6","Unicode dec":"11187","Unicode hex":"2BB3"},{"Typeface name":"Wingdings","Dingbat dec":"199","Dingbat hex":"C7","Unicode dec":"11188","Unicode hex":"2BB4"},{"Typeface name":"Wingdings","Dingbat dec":"200","Dingbat hex":"C8","Unicode dec":"11189","Unicode hex":"2BB5"},{"Typeface name":"Wingdings","Dingbat dec":"201","Dingbat hex":"C9","Unicode dec":"11190","Unicode hex":"2BB6"},{"Typeface name":"Wingdings","Dingbat dec":"202","Dingbat hex":"CA","Unicode dec":"11191","Unicode hex":"2BB7"},{"Typeface name":"Wingdings","Dingbat dec":"203","Dingbat hex":"CB","Unicode dec":"128618","Unicode hex":"1F66A"},{"Typeface name":"Wingdings","Dingbat dec":"204","Dingbat hex":"CC","Unicode dec":"128619","Unicode hex":"1F66B"},{"Typeface name":"Wingdings","Dingbat dec":"205","Dingbat hex":"CD","Unicode dec":"128597","Unicode hex":"1F655"},{"Typeface name":"Wingdings","Dingbat dec":"206","Dingbat hex":"CE","Unicode dec":"128596","Unicode hex":"1F654"},{"Typeface name":"Wingdings","Dingbat dec":"207","Dingbat hex":"CF","Unicode dec":"128599","Unicode hex":"1F657"},{"Typeface name":"Wingdings","Dingbat dec":"208","Dingbat hex":"D0","Unicode dec":"128598","Unicode hex":"1F656"},{"Typeface name":"Wingdings","Dingbat dec":"209","Dingbat hex":"D1","Unicode dec":"128592","Unicode hex":"1F650"},{"Typeface name":"Wingdings","Dingbat dec":"210","Dingbat hex":"D2","Unicode dec":"128593","Unicode hex":"1F651"},{"Typeface name":"Wingdings","Dingbat dec":"211","Dingbat hex":"D3","Unicode dec":"128594","Unicode hex":"1F652"},{"Typeface name":"Wingdings","Dingbat dec":"212","Dingbat hex":"D4","Unicode dec":"128595","Unicode hex":"1F653"},{"Typeface name":"Wingdings","Dingbat dec":"213","Dingbat hex":"D5","Unicode dec":"9003","Unicode hex":"232B"},{"Typeface name":"Wingdings","Dingbat dec":"214","Dingbat hex":"D6","Unicode dec":"8998","Unicode hex":"2326"},{"Typeface name":"Wingdings","Dingbat dec":"215","Dingbat hex":"D7","Unicode dec":"11160","Unicode hex":"2B98"},{"Typeface name":"Wingdings","Dingbat dec":"216","Dingbat hex":"D8","Unicode dec":"11162","Unicode hex":"2B9A"},{"Typeface name":"Wingdings","Dingbat dec":"217","Dingbat hex":"D9","Unicode dec":"11161","Unicode hex":"2B99"},{"Typeface name":"Wingdings","Dingbat dec":"218","Dingbat hex":"DA","Unicode dec":"11163","Unicode hex":"2B9B"},{"Typeface name":"Wingdings","Dingbat dec":"219","Dingbat hex":"DB","Unicode dec":"11144","Unicode hex":"2B88"},{"Typeface name":"Wingdings","Dingbat dec":"220","Dingbat hex":"DC","Unicode dec":"11146","Unicode hex":"2B8A"},{"Typeface name":"Wingdings","Dingbat dec":"221","Dingbat hex":"DD","Unicode dec":"11145","Unicode hex":"2B89"},{"Typeface name":"Wingdings","Dingbat dec":"222","Dingbat hex":"DE","Unicode dec":"11147","Unicode hex":"2B8B"},{"Typeface name":"Wingdings","Dingbat dec":"223","Dingbat hex":"DF","Unicode dec":"129128","Unicode hex":"1F868"},{"Typeface name":"Wingdings","Dingbat dec":"224","Dingbat hex":"E0","Unicode dec":"129130","Unicode hex":"1F86A"},{"Typeface name":"Wingdings","Dingbat dec":"225","Dingbat hex":"E1","Unicode dec":"129129","Unicode hex":"1F869"},{"Typeface name":"Wingdings","Dingbat dec":"226","Dingbat hex":"E2","Unicode dec":"129131","Unicode hex":"1F86B"},{"Typeface name":"Wingdings","Dingbat dec":"227","Dingbat hex":"E3","Unicode dec":"129132","Unicode hex":"1F86C"},{"Typeface name":"Wingdings","Dingbat dec":"228","Dingbat hex":"E4","Unicode dec":"129133","Unicode hex":"1F86D"},{"Typeface name":"Wingdings","Dingbat dec":"229","Dingbat hex":"E5","Unicode dec":"129135","Unicode hex":"1F86F"},{"Typeface name":"Wingdings","Dingbat dec":"230","Dingbat hex":"E6","Unicode dec":"129134","Unicode hex":"1F86E"},{"Typeface name":"Wingdings","Dingbat dec":"231","Dingbat hex":"E7","Unicode dec":"129144","Unicode hex":"1F878"},{"Typeface name":"Wingdings","Dingbat dec":"232","Dingbat hex":"E8","Unicode dec":"129146","Unicode hex":"1F87A"},{"Typeface name":"Wingdings","Dingbat dec":"233","Dingbat hex":"E9","Unicode dec":"129145","Unicode hex":"1F879"},{"Typeface name":"Wingdings","Dingbat dec":"234","Dingbat hex":"EA","Unicode dec":"129147","Unicode hex":"1F87B"},{"Typeface name":"Wingdings","Dingbat dec":"235","Dingbat hex":"EB","Unicode dec":"129148","Unicode hex":"1F87C"},{"Typeface name":"Wingdings","Dingbat dec":"236","Dingbat hex":"EC","Unicode dec":"129149","Unicode hex":"1F87D"},{"Typeface name":"Wingdings","Dingbat dec":"237","Dingbat hex":"ED","Unicode dec":"129151","Unicode hex":"1F87F"},{"Typeface name":"Wingdings","Dingbat dec":"238","Dingbat hex":"EE","Unicode dec":"129150","Unicode hex":"1F87E"},{"Typeface name":"Wingdings","Dingbat dec":"239","Dingbat hex":"EF","Unicode dec":"8678","Unicode hex":"21E6"},{"Typeface name":"Wingdings","Dingbat dec":"240","Dingbat hex":"F0","Unicode dec":"8680","Unicode hex":"21E8"},{"Typeface name":"Wingdings","Dingbat dec":"241","Dingbat hex":"F1","Unicode dec":"8679","Unicode hex":"21E7"},{"Typeface name":"Wingdings","Dingbat dec":"242","Dingbat hex":"F2","Unicode dec":"8681","Unicode hex":"21E9"},{"Typeface name":"Wingdings","Dingbat dec":"243","Dingbat hex":"F3","Unicode dec":"11012","Unicode hex":"2B04"},{"Typeface name":"Wingdings","Dingbat dec":"244","Dingbat hex":"F4","Unicode dec":"8691","Unicode hex":"21F3"},{"Typeface name":"Wingdings","Dingbat dec":"245","Dingbat hex":"F5","Unicode dec":"11009","Unicode hex":"2B01"},{"Typeface name":"Wingdings","Dingbat dec":"246","Dingbat hex":"F6","Unicode dec":"11008","Unicode hex":"2B00"},{"Typeface name":"Wingdings","Dingbat dec":"247","Dingbat hex":"F7","Unicode dec":"11011","Unicode hex":"2B03"},{"Typeface name":"Wingdings","Dingbat dec":"248","Dingbat hex":"F8","Unicode dec":"11010","Unicode hex":"2B02"},{"Typeface name":"Wingdings","Dingbat dec":"249","Dingbat hex":"F9","Unicode dec":"129196","Unicode hex":"1F8AC"},{"Typeface name":"Wingdings","Dingbat dec":"250","Dingbat hex":"FA","Unicode dec":"129197","Unicode hex":"1F8AD"},{"Typeface name":"Wingdings","Dingbat dec":"251","Dingbat hex":"FB","Unicode dec":"128502","Unicode hex":"1F5F6"},{"Typeface name":"Wingdings","Dingbat dec":"252","Dingbat hex":"FC","Unicode dec":"10003","Unicode hex":"2713"},{"Typeface name":"Wingdings","Dingbat dec":"253","Dingbat hex":"FD","Unicode dec":"128503","Unicode hex":"1F5F7"},{"Typeface name":"Wingdings","Dingbat dec":"254","Dingbat hex":"FE","Unicode dec":"128505","Unicode hex":"1F5F9"},{"Typeface name":"Wingdings 2","Dingbat dec":"32","Dingbat hex":"20","Unicode dec":"32","Unicode hex":"20"},{"Typeface name":"Wingdings 2","Dingbat dec":"33","Dingbat hex":"21","Unicode dec":"128394","Unicode hex":"1F58A"},{"Typeface name":"Wingdings 2","Dingbat dec":"34","Dingbat hex":"22","Unicode dec":"128395","Unicode hex":"1F58B"},{"Typeface name":"Wingdings 2","Dingbat dec":"35","Dingbat hex":"23","Unicode dec":"128396","Unicode hex":"1F58C"},{"Typeface name":"Wingdings 2","Dingbat dec":"36","Dingbat hex":"24","Unicode dec":"128397","Unicode hex":"1F58D"},{"Typeface name":"Wingdings 2","Dingbat dec":"37","Dingbat hex":"25","Unicode dec":"9988","Unicode hex":"2704"},{"Typeface name":"Wingdings 2","Dingbat dec":"38","Dingbat hex":"26","Unicode dec":"9984","Unicode hex":"2700"},{"Typeface name":"Wingdings 2","Dingbat dec":"39","Dingbat hex":"27","Unicode dec":"128382","Unicode hex":"1F57E"},{"Typeface name":"Wingdings 2","Dingbat dec":"40","Dingbat hex":"28","Unicode dec":"128381","Unicode hex":"1F57D"},{"Typeface name":"Wingdings 2","Dingbat dec":"41","Dingbat hex":"29","Unicode dec":"128453","Unicode hex":"1F5C5"},{"Typeface name":"Wingdings 2","Dingbat dec":"42","Dingbat hex":"2A","Unicode dec":"128454","Unicode hex":"1F5C6"},{"Typeface name":"Wingdings 2","Dingbat dec":"43","Dingbat hex":"2B","Unicode dec":"128455","Unicode hex":"1F5C7"},{"Typeface name":"Wingdings 2","Dingbat dec":"44","Dingbat hex":"2C","Unicode dec":"128456","Unicode hex":"1F5C8"},{"Typeface name":"Wingdings 2","Dingbat dec":"45","Dingbat hex":"2D","Unicode dec":"128457","Unicode hex":"1F5C9"},{"Typeface name":"Wingdings 2","Dingbat dec":"46","Dingbat hex":"2E","Unicode dec":"128458","Unicode hex":"1F5CA"},{"Typeface name":"Wingdings 2","Dingbat dec":"47","Dingbat hex":"2F","Unicode dec":"128459","Unicode hex":"1F5CB"},{"Typeface name":"Wingdings 2","Dingbat dec":"48","Dingbat hex":"30","Unicode dec":"128460","Unicode hex":"1F5CC"},{"Typeface name":"Wingdings 2","Dingbat dec":"49","Dingbat hex":"31","Unicode dec":"128461","Unicode hex":"1F5CD"},{"Typeface name":"Wingdings 2","Dingbat dec":"50","Dingbat hex":"32","Unicode dec":"128203","Unicode hex":"1F4CB"},{"Typeface name":"Wingdings 2","Dingbat dec":"51","Dingbat hex":"33","Unicode dec":"128465","Unicode hex":"1F5D1"},{"Typeface name":"Wingdings 2","Dingbat dec":"52","Dingbat hex":"34","Unicode dec":"128468","Unicode hex":"1F5D4"},{"Typeface name":"Wingdings 2","Dingbat dec":"53","Dingbat hex":"35","Unicode dec":"128437","Unicode hex":"1F5B5"},{"Typeface name":"Wingdings 2","Dingbat dec":"54","Dingbat hex":"36","Unicode dec":"128438","Unicode hex":"1F5B6"},{"Typeface name":"Wingdings 2","Dingbat dec":"55","Dingbat hex":"37","Unicode dec":"128439","Unicode hex":"1F5B7"},{"Typeface name":"Wingdings 2","Dingbat dec":"56","Dingbat hex":"38","Unicode dec":"128440","Unicode hex":"1F5B8"},{"Typeface name":"Wingdings 2","Dingbat dec":"57","Dingbat hex":"39","Unicode dec":"128429","Unicode hex":"1F5AD"},{"Typeface name":"Wingdings 2","Dingbat dec":"58","Dingbat hex":"3A","Unicode dec":"128431","Unicode hex":"1F5AF"},{"Typeface name":"Wingdings 2","Dingbat dec":"59","Dingbat hex":"3B","Unicode dec":"128433","Unicode hex":"1F5B1"},{"Typeface name":"Wingdings 2","Dingbat dec":"60","Dingbat hex":"3C","Unicode dec":"128402","Unicode hex":"1F592"},{"Typeface name":"Wingdings 2","Dingbat dec":"61","Dingbat hex":"3D","Unicode dec":"128403","Unicode hex":"1F593"},{"Typeface name":"Wingdings 2","Dingbat dec":"62","Dingbat hex":"3E","Unicode dec":"128408","Unicode hex":"1F598"},{"Typeface name":"Wingdings 2","Dingbat dec":"63","Dingbat hex":"3F","Unicode dec":"128409","Unicode hex":"1F599"},{"Typeface name":"Wingdings 2","Dingbat dec":"64","Dingbat hex":"40","Unicode dec":"128410","Unicode hex":"1F59A"},{"Typeface name":"Wingdings 2","Dingbat dec":"65","Dingbat hex":"41","Unicode dec":"128411","Unicode hex":"1F59B"},{"Typeface name":"Wingdings 2","Dingbat dec":"66","Dingbat hex":"42","Unicode dec":"128072","Unicode hex":"1F448"},{"Typeface name":"Wingdings 2","Dingbat dec":"67","Dingbat hex":"43","Unicode dec":"128073","Unicode hex":"1F449"},{"Typeface name":"Wingdings 2","Dingbat dec":"68","Dingbat hex":"44","Unicode dec":"128412","Unicode hex":"1F59C"},{"Typeface name":"Wingdings 2","Dingbat dec":"69","Dingbat hex":"45","Unicode dec":"128413","Unicode hex":"1F59D"},{"Typeface name":"Wingdings 2","Dingbat dec":"70","Dingbat hex":"46","Unicode dec":"128414","Unicode hex":"1F59E"},{"Typeface name":"Wingdings 2","Dingbat dec":"71","Dingbat hex":"47","Unicode dec":"128415","Unicode hex":"1F59F"},{"Typeface name":"Wingdings 2","Dingbat dec":"72","Dingbat hex":"48","Unicode dec":"128416","Unicode hex":"1F5A0"},{"Typeface name":"Wingdings 2","Dingbat dec":"73","Dingbat hex":"49","Unicode dec":"128417","Unicode hex":"1F5A1"},{"Typeface name":"Wingdings 2","Dingbat dec":"74","Dingbat hex":"4A","Unicode dec":"128070","Unicode hex":"1F446"},{"Typeface name":"Wingdings 2","Dingbat dec":"75","Dingbat hex":"4B","Unicode dec":"128071","Unicode hex":"1F447"},{"Typeface name":"Wingdings 2","Dingbat dec":"76","Dingbat hex":"4C","Unicode dec":"128418","Unicode hex":"1F5A2"},{"Typeface name":"Wingdings 2","Dingbat dec":"77","Dingbat hex":"4D","Unicode dec":"128419","Unicode hex":"1F5A3"},{"Typeface name":"Wingdings 2","Dingbat dec":"78","Dingbat hex":"4E","Unicode dec":"128401","Unicode hex":"1F591"},{"Typeface name":"Wingdings 2","Dingbat dec":"79","Dingbat hex":"4F","Unicode dec":"128500","Unicode hex":"1F5F4"},{"Typeface name":"Wingdings 2","Dingbat dec":"80","Dingbat hex":"50","Unicode dec":"128504","Unicode hex":"1F5F8"},{"Typeface name":"Wingdings 2","Dingbat dec":"81","Dingbat hex":"51","Unicode dec":"128501","Unicode hex":"1F5F5"},{"Typeface name":"Wingdings 2","Dingbat dec":"82","Dingbat hex":"52","Unicode dec":"9745","Unicode hex":"2611"},{"Typeface name":"Wingdings 2","Dingbat dec":"83","Dingbat hex":"53","Unicode dec":"11197","Unicode hex":"2BBD"},{"Typeface name":"Wingdings 2","Dingbat dec":"84","Dingbat hex":"54","Unicode dec":"9746","Unicode hex":"2612"},{"Typeface name":"Wingdings 2","Dingbat dec":"85","Dingbat hex":"55","Unicode dec":"11198","Unicode hex":"2BBE"},{"Typeface name":"Wingdings 2","Dingbat dec":"86","Dingbat hex":"56","Unicode dec":"11199","Unicode hex":"2BBF"},{"Typeface name":"Wingdings 2","Dingbat dec":"87","Dingbat hex":"57","Unicode dec":"128711","Unicode hex":"1F6C7"},{"Typeface name":"Wingdings 2","Dingbat dec":"88","Dingbat hex":"58","Unicode dec":"10680","Unicode hex":"29B8"},{"Typeface name":"Wingdings 2","Dingbat dec":"89","Dingbat hex":"59","Unicode dec":"128625","Unicode hex":"1F671"},{"Typeface name":"Wingdings 2","Dingbat dec":"90","Dingbat hex":"5A","Unicode dec":"128628","Unicode hex":"1F674"},{"Typeface name":"Wingdings 2","Dingbat dec":"91","Dingbat hex":"5B","Unicode dec":"128626","Unicode hex":"1F672"},{"Typeface name":"Wingdings 2","Dingbat dec":"92","Dingbat hex":"5C","Unicode dec":"128627","Unicode hex":"1F673"},{"Typeface name":"Wingdings 2","Dingbat dec":"93","Dingbat hex":"5D","Unicode dec":"8253","Unicode hex":"203D"},{"Typeface name":"Wingdings 2","Dingbat dec":"94","Dingbat hex":"5E","Unicode dec":"128633","Unicode hex":"1F679"},{"Typeface name":"Wingdings 2","Dingbat dec":"95","Dingbat hex":"5F","Unicode dec":"128634","Unicode hex":"1F67A"},{"Typeface name":"Wingdings 2","Dingbat dec":"96","Dingbat hex":"60","Unicode dec":"128635","Unicode hex":"1F67B"},{"Typeface name":"Wingdings 2","Dingbat dec":"97","Dingbat hex":"61","Unicode dec":"128614","Unicode hex":"1F666"},{"Typeface name":"Wingdings 2","Dingbat dec":"98","Dingbat hex":"62","Unicode dec":"128612","Unicode hex":"1F664"},{"Typeface name":"Wingdings 2","Dingbat dec":"99","Dingbat hex":"63","Unicode dec":"128613","Unicode hex":"1F665"},{"Typeface name":"Wingdings 2","Dingbat dec":"100","Dingbat hex":"64","Unicode dec":"128615","Unicode hex":"1F667"},{"Typeface name":"Wingdings 2","Dingbat dec":"101","Dingbat hex":"65","Unicode dec":"128602","Unicode hex":"1F65A"},{"Typeface name":"Wingdings 2","Dingbat dec":"102","Dingbat hex":"66","Unicode dec":"128600","Unicode hex":"1F658"},{"Typeface name":"Wingdings 2","Dingbat dec":"103","Dingbat hex":"67","Unicode dec":"128601","Unicode hex":"1F659"},{"Typeface name":"Wingdings 2","Dingbat dec":"104","Dingbat hex":"68","Unicode dec":"128603","Unicode hex":"1F65B"},{"Typeface name":"Wingdings 2","Dingbat dec":"105","Dingbat hex":"69","Unicode dec":"9450","Unicode hex":"24EA"},{"Typeface name":"Wingdings 2","Dingbat dec":"106","Dingbat hex":"6A","Unicode dec":"9312","Unicode hex":"2460"},{"Typeface name":"Wingdings 2","Dingbat dec":"107","Dingbat hex":"6B","Unicode dec":"9313","Unicode hex":"2461"},{"Typeface name":"Wingdings 2","Dingbat dec":"108","Dingbat hex":"6C","Unicode dec":"9314","Unicode hex":"2462"},{"Typeface name":"Wingdings 2","Dingbat dec":"109","Dingbat hex":"6D","Unicode dec":"9315","Unicode hex":"2463"},{"Typeface name":"Wingdings 2","Dingbat dec":"110","Dingbat hex":"6E","Unicode dec":"9316","Unicode hex":"2464"},{"Typeface name":"Wingdings 2","Dingbat dec":"111","Dingbat hex":"6F","Unicode dec":"9317","Unicode hex":"2465"},{"Typeface name":"Wingdings 2","Dingbat dec":"112","Dingbat hex":"70","Unicode dec":"9318","Unicode hex":"2466"},{"Typeface name":"Wingdings 2","Dingbat dec":"113","Dingbat hex":"71","Unicode dec":"9319","Unicode hex":"2467"},{"Typeface name":"Wingdings 2","Dingbat dec":"114","Dingbat hex":"72","Unicode dec":"9320","Unicode hex":"2468"},{"Typeface name":"Wingdings 2","Dingbat dec":"115","Dingbat hex":"73","Unicode dec":"9321","Unicode hex":"2469"},{"Typeface name":"Wingdings 2","Dingbat dec":"116","Dingbat hex":"74","Unicode dec":"9471","Unicode hex":"24FF"},{"Typeface name":"Wingdings 2","Dingbat dec":"117","Dingbat hex":"75","Unicode dec":"10102","Unicode hex":"2776"},{"Typeface name":"Wingdings 2","Dingbat dec":"118","Dingbat hex":"76","Unicode dec":"10103","Unicode hex":"2777"},{"Typeface name":"Wingdings 2","Dingbat dec":"119","Dingbat hex":"77","Unicode dec":"10104","Unicode hex":"2778"},{"Typeface name":"Wingdings 2","Dingbat dec":"120","Dingbat hex":"78","Unicode dec":"10105","Unicode hex":"2779"},{"Typeface name":"Wingdings 2","Dingbat dec":"121","Dingbat hex":"79","Unicode dec":"10106","Unicode hex":"277A"},{"Typeface name":"Wingdings 2","Dingbat dec":"122","Dingbat hex":"7A","Unicode dec":"10107","Unicode hex":"277B"},{"Typeface name":"Wingdings 2","Dingbat dec":"123","Dingbat hex":"7B","Unicode dec":"10108","Unicode hex":"277C"},{"Typeface name":"Wingdings 2","Dingbat dec":"124","Dingbat hex":"7C","Unicode dec":"10109","Unicode hex":"277D"},{"Typeface name":"Wingdings 2","Dingbat dec":"125","Dingbat hex":"7D","Unicode dec":"10110","Unicode hex":"277E"},{"Typeface name":"Wingdings 2","Dingbat dec":"126","Dingbat hex":"7E","Unicode dec":"10111","Unicode hex":"277F"},{"Typeface name":"Wingdings 2","Dingbat dec":"128","Dingbat hex":"80","Unicode dec":"9737","Unicode hex":"2609"},{"Typeface name":"Wingdings 2","Dingbat dec":"129","Dingbat hex":"81","Unicode dec":"127765","Unicode hex":"1F315"},{"Typeface name":"Wingdings 2","Dingbat dec":"130","Dingbat hex":"82","Unicode dec":"9789","Unicode hex":"263D"},{"Typeface name":"Wingdings 2","Dingbat dec":"131","Dingbat hex":"83","Unicode dec":"9790","Unicode hex":"263E"},{"Typeface name":"Wingdings 2","Dingbat dec":"132","Dingbat hex":"84","Unicode dec":"11839","Unicode hex":"2E3F"},{"Typeface name":"Wingdings 2","Dingbat dec":"133","Dingbat hex":"85","Unicode dec":"10013","Unicode hex":"271D"},{"Typeface name":"Wingdings 2","Dingbat dec":"134","Dingbat hex":"86","Unicode dec":"128327","Unicode hex":"1F547"},{"Typeface name":"Wingdings 2","Dingbat dec":"135","Dingbat hex":"87","Unicode dec":"128348","Unicode hex":"1F55C"},{"Typeface name":"Wingdings 2","Dingbat dec":"136","Dingbat hex":"88","Unicode dec":"128349","Unicode hex":"1F55D"},{"Typeface name":"Wingdings 2","Dingbat dec":"137","Dingbat hex":"89","Unicode dec":"128350","Unicode hex":"1F55E"},{"Typeface name":"Wingdings 2","Dingbat dec":"138","Dingbat hex":"8A","Unicode dec":"128351","Unicode hex":"1F55F"},{"Typeface name":"Wingdings 2","Dingbat dec":"139","Dingbat hex":"8B","Unicode dec":"128352","Unicode hex":"1F560"},{"Typeface name":"Wingdings 2","Dingbat dec":"140","Dingbat hex":"8C","Unicode dec":"128353","Unicode hex":"1F561"},{"Typeface name":"Wingdings 2","Dingbat dec":"141","Dingbat hex":"8D","Unicode dec":"128354","Unicode hex":"1F562"},{"Typeface name":"Wingdings 2","Dingbat dec":"142","Dingbat hex":"8E","Unicode dec":"128355","Unicode hex":"1F563"},{"Typeface name":"Wingdings 2","Dingbat dec":"143","Dingbat hex":"8F","Unicode dec":"128356","Unicode hex":"1F564"},{"Typeface name":"Wingdings 2","Dingbat dec":"144","Dingbat hex":"90","Unicode dec":"128357","Unicode hex":"1F565"},{"Typeface name":"Wingdings 2","Dingbat dec":"145","Dingbat hex":"91","Unicode dec":"128358","Unicode hex":"1F566"},{"Typeface name":"Wingdings 2","Dingbat dec":"146","Dingbat hex":"92","Unicode dec":"128359","Unicode hex":"1F567"},{"Typeface name":"Wingdings 2","Dingbat dec":"147","Dingbat hex":"93","Unicode dec":"128616","Unicode hex":"1F668"},{"Typeface name":"Wingdings 2","Dingbat dec":"148","Dingbat hex":"94","Unicode dec":"128617","Unicode hex":"1F669"},{"Typeface name":"Wingdings 2","Dingbat dec":"149","Dingbat hex":"95","Unicode dec":"8901","Unicode hex":"22C5"},{"Typeface name":"Wingdings 2","Dingbat dec":"150","Dingbat hex":"96","Unicode dec":"128900","Unicode hex":"1F784"},{"Typeface name":"Wingdings 2","Dingbat dec":"151","Dingbat hex":"97","Unicode dec":"10625","Unicode hex":"2981"},{"Typeface name":"Wingdings 2","Dingbat dec":"152","Dingbat hex":"98","Unicode dec":"9679","Unicode hex":"25CF"},{"Typeface name":"Wingdings 2","Dingbat dec":"153","Dingbat hex":"99","Unicode dec":"9675","Unicode hex":"25CB"},{"Typeface name":"Wingdings 2","Dingbat dec":"154","Dingbat hex":"9A","Unicode dec":"128901","Unicode hex":"1F785"},{"Typeface name":"Wingdings 2","Dingbat dec":"155","Dingbat hex":"9B","Unicode dec":"128903","Unicode hex":"1F787"},{"Typeface name":"Wingdings 2","Dingbat dec":"156","Dingbat hex":"9C","Unicode dec":"128905","Unicode hex":"1F789"},{"Typeface name":"Wingdings 2","Dingbat dec":"157","Dingbat hex":"9D","Unicode dec":"8857","Unicode hex":"2299"},{"Typeface name":"Wingdings 2","Dingbat dec":"158","Dingbat hex":"9E","Unicode dec":"10687","Unicode hex":"29BF"},{"Typeface name":"Wingdings 2","Dingbat dec":"159","Dingbat hex":"9F","Unicode dec":"128908","Unicode hex":"1F78C"},{"Typeface name":"Wingdings 2","Dingbat dec":"160","Dingbat hex":"A0","Unicode dec":"128909","Unicode hex":"1F78D"},{"Typeface name":"Wingdings 2","Dingbat dec":"161","Dingbat hex":"A1","Unicode dec":"9726","Unicode hex":"25FE"},{"Typeface name":"Wingdings 2","Dingbat dec":"162","Dingbat hex":"A2","Unicode dec":"9632","Unicode hex":"25A0"},{"Typeface name":"Wingdings 2","Dingbat dec":"163","Dingbat hex":"A3","Unicode dec":"9633","Unicode hex":"25A1"},{"Typeface name":"Wingdings 2","Dingbat dec":"164","Dingbat hex":"A4","Unicode dec":"128913","Unicode hex":"1F791"},{"Typeface name":"Wingdings 2","Dingbat dec":"165","Dingbat hex":"A5","Unicode dec":"128914","Unicode hex":"1F792"},{"Typeface name":"Wingdings 2","Dingbat dec":"166","Dingbat hex":"A6","Unicode dec":"128915","Unicode hex":"1F793"},{"Typeface name":"Wingdings 2","Dingbat dec":"167","Dingbat hex":"A7","Unicode dec":"128916","Unicode hex":"1F794"},{"Typeface name":"Wingdings 2","Dingbat dec":"168","Dingbat hex":"A8","Unicode dec":"9635","Unicode hex":"25A3"},{"Typeface name":"Wingdings 2","Dingbat dec":"169","Dingbat hex":"A9","Unicode dec":"128917","Unicode hex":"1F795"},{"Typeface name":"Wingdings 2","Dingbat dec":"170","Dingbat hex":"AA","Unicode dec":"128918","Unicode hex":"1F796"},{"Typeface name":"Wingdings 2","Dingbat dec":"171","Dingbat hex":"AB","Unicode dec":"128919","Unicode hex":"1F797"},{"Typeface name":"Wingdings 2","Dingbat dec":"172","Dingbat hex":"AC","Unicode dec":"128920","Unicode hex":"1F798"},{"Typeface name":"Wingdings 2","Dingbat dec":"173","Dingbat hex":"AD","Unicode dec":"11049","Unicode hex":"2B29"},{"Typeface name":"Wingdings 2","Dingbat dec":"174","Dingbat hex":"AE","Unicode dec":"11045","Unicode hex":"2B25"},{"Typeface name":"Wingdings 2","Dingbat dec":"175","Dingbat hex":"AF","Unicode dec":"9671","Unicode hex":"25C7"},{"Typeface name":"Wingdings 2","Dingbat dec":"176","Dingbat hex":"B0","Unicode dec":"128922","Unicode hex":"1F79A"},{"Typeface name":"Wingdings 2","Dingbat dec":"177","Dingbat hex":"B1","Unicode dec":"9672","Unicode hex":"25C8"},{"Typeface name":"Wingdings 2","Dingbat dec":"178","Dingbat hex":"B2","Unicode dec":"128923","Unicode hex":"1F79B"},{"Typeface name":"Wingdings 2","Dingbat dec":"179","Dingbat hex":"B3","Unicode dec":"128924","Unicode hex":"1F79C"},{"Typeface name":"Wingdings 2","Dingbat dec":"180","Dingbat hex":"B4","Unicode dec":"128925","Unicode hex":"1F79D"},{"Typeface name":"Wingdings 2","Dingbat dec":"181","Dingbat hex":"B5","Unicode dec":"128926","Unicode hex":"1F79E"},{"Typeface name":"Wingdings 2","Dingbat dec":"182","Dingbat hex":"B6","Unicode dec":"11050","Unicode hex":"2B2A"},{"Typeface name":"Wingdings 2","Dingbat dec":"183","Dingbat hex":"B7","Unicode dec":"11047","Unicode hex":"2B27"},{"Typeface name":"Wingdings 2","Dingbat dec":"184","Dingbat hex":"B8","Unicode dec":"9674","Unicode hex":"25CA"},{"Typeface name":"Wingdings 2","Dingbat dec":"185","Dingbat hex":"B9","Unicode dec":"128928","Unicode hex":"1F7A0"},{"Typeface name":"Wingdings 2","Dingbat dec":"186","Dingbat hex":"BA","Unicode dec":"9686","Unicode hex":"25D6"},{"Typeface name":"Wingdings 2","Dingbat dec":"187","Dingbat hex":"BB","Unicode dec":"9687","Unicode hex":"25D7"},{"Typeface name":"Wingdings 2","Dingbat dec":"188","Dingbat hex":"BC","Unicode dec":"11210","Unicode hex":"2BCA"},{"Typeface name":"Wingdings 2","Dingbat dec":"189","Dingbat hex":"BD","Unicode dec":"11211","Unicode hex":"2BCB"},{"Typeface name":"Wingdings 2","Dingbat dec":"190","Dingbat hex":"BE","Unicode dec":"11200","Unicode hex":"2BC0"},{"Typeface name":"Wingdings 2","Dingbat dec":"191","Dingbat hex":"BF","Unicode dec":"11201","Unicode hex":"2BC1"},{"Typeface name":"Wingdings 2","Dingbat dec":"192","Dingbat hex":"C0","Unicode dec":"11039","Unicode hex":"2B1F"},{"Typeface name":"Wingdings 2","Dingbat dec":"193","Dingbat hex":"C1","Unicode dec":"11202","Unicode hex":"2BC2"},{"Typeface name":"Wingdings 2","Dingbat dec":"194","Dingbat hex":"C2","Unicode dec":"11043","Unicode hex":"2B23"},{"Typeface name":"Wingdings 2","Dingbat dec":"195","Dingbat hex":"C3","Unicode dec":"11042","Unicode hex":"2B22"},{"Typeface name":"Wingdings 2","Dingbat dec":"196","Dingbat hex":"C4","Unicode dec":"11203","Unicode hex":"2BC3"},{"Typeface name":"Wingdings 2","Dingbat dec":"197","Dingbat hex":"C5","Unicode dec":"11204","Unicode hex":"2BC4"},{"Typeface name":"Wingdings 2","Dingbat dec":"198","Dingbat hex":"C6","Unicode dec":"128929","Unicode hex":"1F7A1"},{"Typeface name":"Wingdings 2","Dingbat dec":"199","Dingbat hex":"C7","Unicode dec":"128930","Unicode hex":"1F7A2"},{"Typeface name":"Wingdings 2","Dingbat dec":"200","Dingbat hex":"C8","Unicode dec":"128931","Unicode hex":"1F7A3"},{"Typeface name":"Wingdings 2","Dingbat dec":"201","Dingbat hex":"C9","Unicode dec":"128932","Unicode hex":"1F7A4"},{"Typeface name":"Wingdings 2","Dingbat dec":"202","Dingbat hex":"CA","Unicode dec":"128933","Unicode hex":"1F7A5"},{"Typeface name":"Wingdings 2","Dingbat dec":"203","Dingbat hex":"CB","Unicode dec":"128934","Unicode hex":"1F7A6"},{"Typeface name":"Wingdings 2","Dingbat dec":"204","Dingbat hex":"CC","Unicode dec":"128935","Unicode hex":"1F7A7"},{"Typeface name":"Wingdings 2","Dingbat dec":"205","Dingbat hex":"CD","Unicode dec":"128936","Unicode hex":"1F7A8"},{"Typeface name":"Wingdings 2","Dingbat dec":"206","Dingbat hex":"CE","Unicode dec":"128937","Unicode hex":"1F7A9"},{"Typeface name":"Wingdings 2","Dingbat dec":"207","Dingbat hex":"CF","Unicode dec":"128938","Unicode hex":"1F7AA"},{"Typeface name":"Wingdings 2","Dingbat dec":"208","Dingbat hex":"D0","Unicode dec":"128939","Unicode hex":"1F7AB"},{"Typeface name":"Wingdings 2","Dingbat dec":"209","Dingbat hex":"D1","Unicode dec":"128940","Unicode hex":"1F7AC"},{"Typeface name":"Wingdings 2","Dingbat dec":"210","Dingbat hex":"D2","Unicode dec":"128941","Unicode hex":"1F7AD"},{"Typeface name":"Wingdings 2","Dingbat dec":"211","Dingbat hex":"D3","Unicode dec":"128942","Unicode hex":"1F7AE"},{"Typeface name":"Wingdings 2","Dingbat dec":"212","Dingbat hex":"D4","Unicode dec":"128943","Unicode hex":"1F7AF"},{"Typeface name":"Wingdings 2","Dingbat dec":"213","Dingbat hex":"D5","Unicode dec":"128944","Unicode hex":"1F7B0"},{"Typeface name":"Wingdings 2","Dingbat dec":"214","Dingbat hex":"D6","Unicode dec":"128945","Unicode hex":"1F7B1"},{"Typeface name":"Wingdings 2","Dingbat dec":"215","Dingbat hex":"D7","Unicode dec":"128946","Unicode hex":"1F7B2"},{"Typeface name":"Wingdings 2","Dingbat dec":"216","Dingbat hex":"D8","Unicode dec":"128947","Unicode hex":"1F7B3"},{"Typeface name":"Wingdings 2","Dingbat dec":"217","Dingbat hex":"D9","Unicode dec":"128948","Unicode hex":"1F7B4"},{"Typeface name":"Wingdings 2","Dingbat dec":"218","Dingbat hex":"DA","Unicode dec":"128949","Unicode hex":"1F7B5"},{"Typeface name":"Wingdings 2","Dingbat dec":"219","Dingbat hex":"DB","Unicode dec":"128950","Unicode hex":"1F7B6"},{"Typeface name":"Wingdings 2","Dingbat dec":"220","Dingbat hex":"DC","Unicode dec":"128951","Unicode hex":"1F7B7"},{"Typeface name":"Wingdings 2","Dingbat dec":"221","Dingbat hex":"DD","Unicode dec":"128952","Unicode hex":"1F7B8"},{"Typeface name":"Wingdings 2","Dingbat dec":"222","Dingbat hex":"DE","Unicode dec":"128953","Unicode hex":"1F7B9"},{"Typeface name":"Wingdings 2","Dingbat dec":"223","Dingbat hex":"DF","Unicode dec":"128954","Unicode hex":"1F7BA"},{"Typeface name":"Wingdings 2","Dingbat dec":"224","Dingbat hex":"E0","Unicode dec":"128955","Unicode hex":"1F7BB"},{"Typeface name":"Wingdings 2","Dingbat dec":"225","Dingbat hex":"E1","Unicode dec":"128956","Unicode hex":"1F7BC"},{"Typeface name":"Wingdings 2","Dingbat dec":"226","Dingbat hex":"E2","Unicode dec":"128957","Unicode hex":"1F7BD"},{"Typeface name":"Wingdings 2","Dingbat dec":"227","Dingbat hex":"E3","Unicode dec":"128958","Unicode hex":"1F7BE"},{"Typeface name":"Wingdings 2","Dingbat dec":"228","Dingbat hex":"E4","Unicode dec":"128959","Unicode hex":"1F7BF"},{"Typeface name":"Wingdings 2","Dingbat dec":"229","Dingbat hex":"E5","Unicode dec":"128960","Unicode hex":"1F7C0"},{"Typeface name":"Wingdings 2","Dingbat dec":"230","Dingbat hex":"E6","Unicode dec":"128962","Unicode hex":"1F7C2"},{"Typeface name":"Wingdings 2","Dingbat dec":"231","Dingbat hex":"E7","Unicode dec":"128964","Unicode hex":"1F7C4"},{"Typeface name":"Wingdings 2","Dingbat dec":"232","Dingbat hex":"E8","Unicode dec":"128966","Unicode hex":"1F7C6"},{"Typeface name":"Wingdings 2","Dingbat dec":"233","Dingbat hex":"E9","Unicode dec":"128969","Unicode hex":"1F7C9"},{"Typeface name":"Wingdings 2","Dingbat dec":"234","Dingbat hex":"EA","Unicode dec":"128970","Unicode hex":"1F7CA"},{"Typeface name":"Wingdings 2","Dingbat dec":"235","Dingbat hex":"EB","Unicode dec":"10038","Unicode hex":"2736"},{"Typeface name":"Wingdings 2","Dingbat dec":"236","Dingbat hex":"EC","Unicode dec":"128972","Unicode hex":"1F7CC"},{"Typeface name":"Wingdings 2","Dingbat dec":"237","Dingbat hex":"ED","Unicode dec":"128974","Unicode hex":"1F7CE"},{"Typeface name":"Wingdings 2","Dingbat dec":"238","Dingbat hex":"EE","Unicode dec":"128976","Unicode hex":"1F7D0"},{"Typeface name":"Wingdings 2","Dingbat dec":"239","Dingbat hex":"EF","Unicode dec":"128978","Unicode hex":"1F7D2"},{"Typeface name":"Wingdings 2","Dingbat dec":"240","Dingbat hex":"F0","Unicode dec":"10041","Unicode hex":"2739"},{"Typeface name":"Wingdings 2","Dingbat dec":"241","Dingbat hex":"F1","Unicode dec":"128963","Unicode hex":"1F7C3"},{"Typeface name":"Wingdings 2","Dingbat dec":"242","Dingbat hex":"F2","Unicode dec":"128967","Unicode hex":"1F7C7"},{"Typeface name":"Wingdings 2","Dingbat dec":"243","Dingbat hex":"F3","Unicode dec":"10031","Unicode hex":"272F"},{"Typeface name":"Wingdings 2","Dingbat dec":"244","Dingbat hex":"F4","Unicode dec":"128973","Unicode hex":"1F7CD"},{"Typeface name":"Wingdings 2","Dingbat dec":"245","Dingbat hex":"F5","Unicode dec":"128980","Unicode hex":"1F7D4"},{"Typeface name":"Wingdings 2","Dingbat dec":"246","Dingbat hex":"F6","Unicode dec":"11212","Unicode hex":"2BCC"},{"Typeface name":"Wingdings 2","Dingbat dec":"247","Dingbat hex":"F7","Unicode dec":"11213","Unicode hex":"2BCD"},{"Typeface name":"Wingdings 2","Dingbat dec":"248","Dingbat hex":"F8","Unicode dec":"8251","Unicode hex":"203B"},{"Typeface name":"Wingdings 2","Dingbat dec":"249","Dingbat hex":"F9","Unicode dec":"8258","Unicode hex":"2042"},{"Typeface name":"Wingdings 3","Dingbat dec":"32","Dingbat hex":"20","Unicode dec":"32","Unicode hex":"20"},{"Typeface name":"Wingdings 3","Dingbat dec":"33","Dingbat hex":"21","Unicode dec":"11104","Unicode hex":"2B60"},{"Typeface name":"Wingdings 3","Dingbat dec":"34","Dingbat hex":"22","Unicode dec":"11106","Unicode hex":"2B62"},{"Typeface name":"Wingdings 3","Dingbat dec":"35","Dingbat hex":"23","Unicode dec":"11105","Unicode hex":"2B61"},{"Typeface name":"Wingdings 3","Dingbat dec":"36","Dingbat hex":"24","Unicode dec":"11107","Unicode hex":"2B63"},{"Typeface name":"Wingdings 3","Dingbat dec":"37","Dingbat hex":"25","Unicode dec":"11110","Unicode hex":"2B66"},{"Typeface name":"Wingdings 3","Dingbat dec":"38","Dingbat hex":"26","Unicode dec":"11111","Unicode hex":"2B67"},{"Typeface name":"Wingdings 3","Dingbat dec":"39","Dingbat hex":"27","Unicode dec":"11113","Unicode hex":"2B69"},{"Typeface name":"Wingdings 3","Dingbat dec":"40","Dingbat hex":"28","Unicode dec":"11112","Unicode hex":"2B68"},{"Typeface name":"Wingdings 3","Dingbat dec":"41","Dingbat hex":"29","Unicode dec":"11120","Unicode hex":"2B70"},{"Typeface name":"Wingdings 3","Dingbat dec":"42","Dingbat hex":"2A","Unicode dec":"11122","Unicode hex":"2B72"},{"Typeface name":"Wingdings 3","Dingbat dec":"43","Dingbat hex":"2B","Unicode dec":"11121","Unicode hex":"2B71"},{"Typeface name":"Wingdings 3","Dingbat dec":"44","Dingbat hex":"2C","Unicode dec":"11123","Unicode hex":"2B73"},{"Typeface name":"Wingdings 3","Dingbat dec":"45","Dingbat hex":"2D","Unicode dec":"11126","Unicode hex":"2B76"},{"Typeface name":"Wingdings 3","Dingbat dec":"46","Dingbat hex":"2E","Unicode dec":"11128","Unicode hex":"2B78"},{"Typeface name":"Wingdings 3","Dingbat dec":"47","Dingbat hex":"2F","Unicode dec":"11131","Unicode hex":"2B7B"},{"Typeface name":"Wingdings 3","Dingbat dec":"48","Dingbat hex":"30","Unicode dec":"11133","Unicode hex":"2B7D"},{"Typeface name":"Wingdings 3","Dingbat dec":"49","Dingbat hex":"31","Unicode dec":"11108","Unicode hex":"2B64"},{"Typeface name":"Wingdings 3","Dingbat dec":"50","Dingbat hex":"32","Unicode dec":"11109","Unicode hex":"2B65"},{"Typeface name":"Wingdings 3","Dingbat dec":"51","Dingbat hex":"33","Unicode dec":"11114","Unicode hex":"2B6A"},{"Typeface name":"Wingdings 3","Dingbat dec":"52","Dingbat hex":"34","Unicode dec":"11116","Unicode hex":"2B6C"},{"Typeface name":"Wingdings 3","Dingbat dec":"53","Dingbat hex":"35","Unicode dec":"11115","Unicode hex":"2B6B"},{"Typeface name":"Wingdings 3","Dingbat dec":"54","Dingbat hex":"36","Unicode dec":"11117","Unicode hex":"2B6D"},{"Typeface name":"Wingdings 3","Dingbat dec":"55","Dingbat hex":"37","Unicode dec":"11085","Unicode hex":"2B4D"},{"Typeface name":"Wingdings 3","Dingbat dec":"56","Dingbat hex":"38","Unicode dec":"11168","Unicode hex":"2BA0"},{"Typeface name":"Wingdings 3","Dingbat dec":"57","Dingbat hex":"39","Unicode dec":"11169","Unicode hex":"2BA1"},{"Typeface name":"Wingdings 3","Dingbat dec":"58","Dingbat hex":"3A","Unicode dec":"11170","Unicode hex":"2BA2"},{"Typeface name":"Wingdings 3","Dingbat dec":"59","Dingbat hex":"3B","Unicode dec":"11171","Unicode hex":"2BA3"},{"Typeface name":"Wingdings 3","Dingbat dec":"60","Dingbat hex":"3C","Unicode dec":"11172","Unicode hex":"2BA4"},{"Typeface name":"Wingdings 3","Dingbat dec":"61","Dingbat hex":"3D","Unicode dec":"11173","Unicode hex":"2BA5"},{"Typeface name":"Wingdings 3","Dingbat dec":"62","Dingbat hex":"3E","Unicode dec":"11174","Unicode hex":"2BA6"},{"Typeface name":"Wingdings 3","Dingbat dec":"63","Dingbat hex":"3F","Unicode dec":"11175","Unicode hex":"2BA7"},{"Typeface name":"Wingdings 3","Dingbat dec":"64","Dingbat hex":"40","Unicode dec":"11152","Unicode hex":"2B90"},{"Typeface name":"Wingdings 3","Dingbat dec":"65","Dingbat hex":"41","Unicode dec":"11153","Unicode hex":"2B91"},{"Typeface name":"Wingdings 3","Dingbat dec":"66","Dingbat hex":"42","Unicode dec":"11154","Unicode hex":"2B92"},{"Typeface name":"Wingdings 3","Dingbat dec":"67","Dingbat hex":"43","Unicode dec":"11155","Unicode hex":"2B93"},{"Typeface name":"Wingdings 3","Dingbat dec":"68","Dingbat hex":"44","Unicode dec":"11136","Unicode hex":"2B80"},{"Typeface name":"Wingdings 3","Dingbat dec":"69","Dingbat hex":"45","Unicode dec":"11139","Unicode hex":"2B83"},{"Typeface name":"Wingdings 3","Dingbat dec":"70","Dingbat hex":"46","Unicode dec":"11134","Unicode hex":"2B7E"},{"Typeface name":"Wingdings 3","Dingbat dec":"71","Dingbat hex":"47","Unicode dec":"11135","Unicode hex":"2B7F"},{"Typeface name":"Wingdings 3","Dingbat dec":"72","Dingbat hex":"48","Unicode dec":"11140","Unicode hex":"2B84"},{"Typeface name":"Wingdings 3","Dingbat dec":"73","Dingbat hex":"49","Unicode dec":"11142","Unicode hex":"2B86"},{"Typeface name":"Wingdings 3","Dingbat dec":"74","Dingbat hex":"4A","Unicode dec":"11141","Unicode hex":"2B85"},{"Typeface name":"Wingdings 3","Dingbat dec":"75","Dingbat hex":"4B","Unicode dec":"11143","Unicode hex":"2B87"},{"Typeface name":"Wingdings 3","Dingbat dec":"76","Dingbat hex":"4C","Unicode dec":"11151","Unicode hex":"2B8F"},{"Typeface name":"Wingdings 3","Dingbat dec":"77","Dingbat hex":"4D","Unicode dec":"11149","Unicode hex":"2B8D"},{"Typeface name":"Wingdings 3","Dingbat dec":"78","Dingbat hex":"4E","Unicode dec":"11150","Unicode hex":"2B8E"},{"Typeface name":"Wingdings 3","Dingbat dec":"79","Dingbat hex":"4F","Unicode dec":"11148","Unicode hex":"2B8C"},{"Typeface name":"Wingdings 3","Dingbat dec":"80","Dingbat hex":"50","Unicode dec":"11118","Unicode hex":"2B6E"},{"Typeface name":"Wingdings 3","Dingbat dec":"81","Dingbat hex":"51","Unicode dec":"11119","Unicode hex":"2B6F"},{"Typeface name":"Wingdings 3","Dingbat dec":"82","Dingbat hex":"52","Unicode dec":"9099","Unicode hex":"238B"},{"Typeface name":"Wingdings 3","Dingbat dec":"83","Dingbat hex":"53","Unicode dec":"8996","Unicode hex":"2324"},{"Typeface name":"Wingdings 3","Dingbat dec":"84","Dingbat hex":"54","Unicode dec":"8963","Unicode hex":"2303"},{"Typeface name":"Wingdings 3","Dingbat dec":"85","Dingbat hex":"55","Unicode dec":"8997","Unicode hex":"2325"},{"Typeface name":"Wingdings 3","Dingbat dec":"86","Dingbat hex":"56","Unicode dec":"9251","Unicode hex":"2423"},{"Typeface name":"Wingdings 3","Dingbat dec":"87","Dingbat hex":"57","Unicode dec":"9085","Unicode hex":"237D"},{"Typeface name":"Wingdings 3","Dingbat dec":"88","Dingbat hex":"58","Unicode dec":"8682","Unicode hex":"21EA"},{"Typeface name":"Wingdings 3","Dingbat dec":"89","Dingbat hex":"59","Unicode dec":"11192","Unicode hex":"2BB8"},{"Typeface name":"Wingdings 3","Dingbat dec":"90","Dingbat hex":"5A","Unicode dec":"129184","Unicode hex":"1F8A0"},{"Typeface name":"Wingdings 3","Dingbat dec":"91","Dingbat hex":"5B","Unicode dec":"129185","Unicode hex":"1F8A1"},{"Typeface name":"Wingdings 3","Dingbat dec":"92","Dingbat hex":"5C","Unicode dec":"129186","Unicode hex":"1F8A2"},{"Typeface name":"Wingdings 3","Dingbat dec":"93","Dingbat hex":"5D","Unicode dec":"129187","Unicode hex":"1F8A3"},{"Typeface name":"Wingdings 3","Dingbat dec":"94","Dingbat hex":"5E","Unicode dec":"129188","Unicode hex":"1F8A4"},{"Typeface name":"Wingdings 3","Dingbat dec":"95","Dingbat hex":"5F","Unicode dec":"129189","Unicode hex":"1F8A5"},{"Typeface name":"Wingdings 3","Dingbat dec":"96","Dingbat hex":"60","Unicode dec":"129190","Unicode hex":"1F8A6"},{"Typeface name":"Wingdings 3","Dingbat dec":"97","Dingbat hex":"61","Unicode dec":"129191","Unicode hex":"1F8A7"},{"Typeface name":"Wingdings 3","Dingbat dec":"98","Dingbat hex":"62","Unicode dec":"129192","Unicode hex":"1F8A8"},{"Typeface name":"Wingdings 3","Dingbat dec":"99","Dingbat hex":"63","Unicode dec":"129193","Unicode hex":"1F8A9"},{"Typeface name":"Wingdings 3","Dingbat dec":"100","Dingbat hex":"64","Unicode dec":"129194","Unicode hex":"1F8AA"},{"Typeface name":"Wingdings 3","Dingbat dec":"101","Dingbat hex":"65","Unicode dec":"129195","Unicode hex":"1F8AB"},{"Typeface name":"Wingdings 3","Dingbat dec":"102","Dingbat hex":"66","Unicode dec":"129104","Unicode hex":"1F850"},{"Typeface name":"Wingdings 3","Dingbat dec":"103","Dingbat hex":"67","Unicode dec":"129106","Unicode hex":"1F852"},{"Typeface name":"Wingdings 3","Dingbat dec":"104","Dingbat hex":"68","Unicode dec":"129105","Unicode hex":"1F851"},{"Typeface name":"Wingdings 3","Dingbat dec":"105","Dingbat hex":"69","Unicode dec":"129107","Unicode hex":"1F853"},{"Typeface name":"Wingdings 3","Dingbat dec":"106","Dingbat hex":"6A","Unicode dec":"129108","Unicode hex":"1F854"},{"Typeface name":"Wingdings 3","Dingbat dec":"107","Dingbat hex":"6B","Unicode dec":"129109","Unicode hex":"1F855"},{"Typeface name":"Wingdings 3","Dingbat dec":"108","Dingbat hex":"6C","Unicode dec":"129111","Unicode hex":"1F857"},{"Typeface name":"Wingdings 3","Dingbat dec":"109","Dingbat hex":"6D","Unicode dec":"129110","Unicode hex":"1F856"},{"Typeface name":"Wingdings 3","Dingbat dec":"110","Dingbat hex":"6E","Unicode dec":"129112","Unicode hex":"1F858"},{"Typeface name":"Wingdings 3","Dingbat dec":"111","Dingbat hex":"6F","Unicode dec":"129113","Unicode hex":"1F859"},{"Typeface name":"Wingdings 3","Dingbat dec":"112","Dingbat hex":"70","Unicode dec":"9650","Unicode hex":"25B2"},{"Typeface name":"Wingdings 3","Dingbat dec":"113","Dingbat hex":"71","Unicode dec":"9660","Unicode hex":"25BC"},{"Typeface name":"Wingdings 3","Dingbat dec":"114","Dingbat hex":"72","Unicode dec":"9651","Unicode hex":"25B3"},{"Typeface name":"Wingdings 3","Dingbat dec":"115","Dingbat hex":"73","Unicode dec":"9661","Unicode hex":"25BD"},{"Typeface name":"Wingdings 3","Dingbat dec":"116","Dingbat hex":"74","Unicode dec":"9664","Unicode hex":"25C0"},{"Typeface name":"Wingdings 3","Dingbat dec":"117","Dingbat hex":"75","Unicode dec":"9654","Unicode hex":"25B6"},{"Typeface name":"Wingdings 3","Dingbat dec":"118","Dingbat hex":"76","Unicode dec":"9665","Unicode hex":"25C1"},{"Typeface name":"Wingdings 3","Dingbat dec":"119","Dingbat hex":"77","Unicode dec":"9655","Unicode hex":"25B7"},{"Typeface name":"Wingdings 3","Dingbat dec":"120","Dingbat hex":"78","Unicode dec":"9699","Unicode hex":"25E3"},{"Typeface name":"Wingdings 3","Dingbat dec":"121","Dingbat hex":"79","Unicode dec":"9698","Unicode hex":"25E2"},{"Typeface name":"Wingdings 3","Dingbat dec":"122","Dingbat hex":"7A","Unicode dec":"9700","Unicode hex":"25E4"},{"Typeface name":"Wingdings 3","Dingbat dec":"123","Dingbat hex":"7B","Unicode dec":"9701","Unicode hex":"25E5"},{"Typeface name":"Wingdings 3","Dingbat dec":"124","Dingbat hex":"7C","Unicode dec":"128896","Unicode hex":"1F780"},{"Typeface name":"Wingdings 3","Dingbat dec":"125","Dingbat hex":"7D","Unicode dec":"128898","Unicode hex":"1F782"},{"Typeface name":"Wingdings 3","Dingbat dec":"126","Dingbat hex":"7E","Unicode dec":"128897","Unicode hex":"1F781"},{"Typeface name":"Wingdings 3","Dingbat dec":"128","Dingbat hex":"80","Unicode dec":"128899","Unicode hex":"1F783"},{"Typeface name":"Wingdings 3","Dingbat dec":"129","Dingbat hex":"81","Unicode dec":"11205","Unicode hex":"2BC5"},{"Typeface name":"Wingdings 3","Dingbat dec":"130","Dingbat hex":"82","Unicode dec":"11206","Unicode hex":"2BC6"},{"Typeface name":"Wingdings 3","Dingbat dec":"131","Dingbat hex":"83","Unicode dec":"11207","Unicode hex":"2BC7"},{"Typeface name":"Wingdings 3","Dingbat dec":"132","Dingbat hex":"84","Unicode dec":"11208","Unicode hex":"2BC8"},{"Typeface name":"Wingdings 3","Dingbat dec":"133","Dingbat hex":"85","Unicode dec":"11164","Unicode hex":"2B9C"},{"Typeface name":"Wingdings 3","Dingbat dec":"134","Dingbat hex":"86","Unicode dec":"11166","Unicode hex":"2B9E"},{"Typeface name":"Wingdings 3","Dingbat dec":"135","Dingbat hex":"87","Unicode dec":"11165","Unicode hex":"2B9D"},{"Typeface name":"Wingdings 3","Dingbat dec":"136","Dingbat hex":"88","Unicode dec":"11167","Unicode hex":"2B9F"},{"Typeface name":"Wingdings 3","Dingbat dec":"137","Dingbat hex":"89","Unicode dec":"129040","Unicode hex":"1F810"},{"Typeface name":"Wingdings 3","Dingbat dec":"138","Dingbat hex":"8A","Unicode dec":"129042","Unicode hex":"1F812"},{"Typeface name":"Wingdings 3","Dingbat dec":"139","Dingbat hex":"8B","Unicode dec":"129041","Unicode hex":"1F811"},{"Typeface name":"Wingdings 3","Dingbat dec":"140","Dingbat hex":"8C","Unicode dec":"129043","Unicode hex":"1F813"},{"Typeface name":"Wingdings 3","Dingbat dec":"141","Dingbat hex":"8D","Unicode dec":"129044","Unicode hex":"1F814"},{"Typeface name":"Wingdings 3","Dingbat dec":"142","Dingbat hex":"8E","Unicode dec":"129046","Unicode hex":"1F816"},{"Typeface name":"Wingdings 3","Dingbat dec":"143","Dingbat hex":"8F","Unicode dec":"129045","Unicode hex":"1F815"},{"Typeface name":"Wingdings 3","Dingbat dec":"144","Dingbat hex":"90","Unicode dec":"129047","Unicode hex":"1F817"},{"Typeface name":"Wingdings 3","Dingbat dec":"145","Dingbat hex":"91","Unicode dec":"129048","Unicode hex":"1F818"},{"Typeface name":"Wingdings 3","Dingbat dec":"146","Dingbat hex":"92","Unicode dec":"129050","Unicode hex":"1F81A"},{"Typeface name":"Wingdings 3","Dingbat dec":"147","Dingbat hex":"93","Unicode dec":"129049","Unicode hex":"1F819"},{"Typeface name":"Wingdings 3","Dingbat dec":"148","Dingbat hex":"94","Unicode dec":"129051","Unicode hex":"1F81B"},{"Typeface name":"Wingdings 3","Dingbat dec":"149","Dingbat hex":"95","Unicode dec":"129052","Unicode hex":"1F81C"},{"Typeface name":"Wingdings 3","Dingbat dec":"150","Dingbat hex":"96","Unicode dec":"129054","Unicode hex":"1F81E"},{"Typeface name":"Wingdings 3","Dingbat dec":"151","Dingbat hex":"97","Unicode dec":"129053","Unicode hex":"1F81D"},{"Typeface name":"Wingdings 3","Dingbat dec":"152","Dingbat hex":"98","Unicode dec":"129055","Unicode hex":"1F81F"},{"Typeface name":"Wingdings 3","Dingbat dec":"153","Dingbat hex":"99","Unicode dec":"129024","Unicode hex":"1F800"},{"Typeface name":"Wingdings 3","Dingbat dec":"154","Dingbat hex":"9A","Unicode dec":"129026","Unicode hex":"1F802"},{"Typeface name":"Wingdings 3","Dingbat dec":"155","Dingbat hex":"9B","Unicode dec":"129025","Unicode hex":"1F801"},{"Typeface name":"Wingdings 3","Dingbat dec":"156","Dingbat hex":"9C","Unicode dec":"129027","Unicode hex":"1F803"},{"Typeface name":"Wingdings 3","Dingbat dec":"157","Dingbat hex":"9D","Unicode dec":"129028","Unicode hex":"1F804"},{"Typeface name":"Wingdings 3","Dingbat dec":"158","Dingbat hex":"9E","Unicode dec":"129030","Unicode hex":"1F806"},{"Typeface name":"Wingdings 3","Dingbat dec":"159","Dingbat hex":"9F","Unicode dec":"129029","Unicode hex":"1F805"},{"Typeface name":"Wingdings 3","Dingbat dec":"160","Dingbat hex":"A0","Unicode dec":"129031","Unicode hex":"1F807"},{"Typeface name":"Wingdings 3","Dingbat dec":"161","Dingbat hex":"A1","Unicode dec":"129032","Unicode hex":"1F808"},{"Typeface name":"Wingdings 3","Dingbat dec":"162","Dingbat hex":"A2","Unicode dec":"129034","Unicode hex":"1F80A"},{"Typeface name":"Wingdings 3","Dingbat dec":"163","Dingbat hex":"A3","Unicode dec":"129033","Unicode hex":"1F809"},{"Typeface name":"Wingdings 3","Dingbat dec":"164","Dingbat hex":"A4","Unicode dec":"129035","Unicode hex":"1F80B"},{"Typeface name":"Wingdings 3","Dingbat dec":"165","Dingbat hex":"A5","Unicode dec":"129056","Unicode hex":"1F820"},{"Typeface name":"Wingdings 3","Dingbat dec":"166","Dingbat hex":"A6","Unicode dec":"129058","Unicode hex":"1F822"},{"Typeface name":"Wingdings 3","Dingbat dec":"167","Dingbat hex":"A7","Unicode dec":"129060","Unicode hex":"1F824"},{"Typeface name":"Wingdings 3","Dingbat dec":"168","Dingbat hex":"A8","Unicode dec":"129062","Unicode hex":"1F826"},{"Typeface name":"Wingdings 3","Dingbat dec":"169","Dingbat hex":"A9","Unicode dec":"129064","Unicode hex":"1F828"},{"Typeface name":"Wingdings 3","Dingbat dec":"170","Dingbat hex":"AA","Unicode dec":"129066","Unicode hex":"1F82A"},{"Typeface name":"Wingdings 3","Dingbat dec":"171","Dingbat hex":"AB","Unicode dec":"129068","Unicode hex":"1F82C"},{"Typeface name":"Wingdings 3","Dingbat dec":"172","Dingbat hex":"AC","Unicode dec":"129180","Unicode hex":"1F89C"},{"Typeface name":"Wingdings 3","Dingbat dec":"173","Dingbat hex":"AD","Unicode dec":"129181","Unicode hex":"1F89D"},{"Typeface name":"Wingdings 3","Dingbat dec":"174","Dingbat hex":"AE","Unicode dec":"129182","Unicode hex":"1F89E"},{"Typeface name":"Wingdings 3","Dingbat dec":"175","Dingbat hex":"AF","Unicode dec":"129183","Unicode hex":"1F89F"},{"Typeface name":"Wingdings 3","Dingbat dec":"176","Dingbat hex":"B0","Unicode dec":"129070","Unicode hex":"1F82E"},{"Typeface name":"Wingdings 3","Dingbat dec":"177","Dingbat hex":"B1","Unicode dec":"129072","Unicode hex":"1F830"},{"Typeface name":"Wingdings 3","Dingbat dec":"178","Dingbat hex":"B2","Unicode dec":"129074","Unicode hex":"1F832"},{"Typeface name":"Wingdings 3","Dingbat dec":"179","Dingbat hex":"B3","Unicode dec":"129076","Unicode hex":"1F834"},{"Typeface name":"Wingdings 3","Dingbat dec":"180","Dingbat hex":"B4","Unicode dec":"129078","Unicode hex":"1F836"},{"Typeface name":"Wingdings 3","Dingbat dec":"181","Dingbat hex":"B5","Unicode dec":"129080","Unicode hex":"1F838"},{"Typeface name":"Wingdings 3","Dingbat dec":"182","Dingbat hex":"B6","Unicode dec":"129082","Unicode hex":"1F83A"},{"Typeface name":"Wingdings 3","Dingbat dec":"183","Dingbat hex":"B7","Unicode dec":"129081","Unicode hex":"1F839"},{"Typeface name":"Wingdings 3","Dingbat dec":"184","Dingbat hex":"B8","Unicode dec":"129083","Unicode hex":"1F83B"},{"Typeface name":"Wingdings 3","Dingbat dec":"185","Dingbat hex":"B9","Unicode dec":"129176","Unicode hex":"1F898"},{"Typeface name":"Wingdings 3","Dingbat dec":"186","Dingbat hex":"BA","Unicode dec":"129178","Unicode hex":"1F89A"},{"Typeface name":"Wingdings 3","Dingbat dec":"187","Dingbat hex":"BB","Unicode dec":"129177","Unicode hex":"1F899"},{"Typeface name":"Wingdings 3","Dingbat dec":"188","Dingbat hex":"BC","Unicode dec":"129179","Unicode hex":"1F89B"},{"Typeface name":"Wingdings 3","Dingbat dec":"189","Dingbat hex":"BD","Unicode dec":"129084","Unicode hex":"1F83C"},{"Typeface name":"Wingdings 3","Dingbat dec":"190","Dingbat hex":"BE","Unicode dec":"129086","Unicode hex":"1F83E"},{"Typeface name":"Wingdings 3","Dingbat dec":"191","Dingbat hex":"BF","Unicode dec":"129085","Unicode hex":"1F83D"},{"Typeface name":"Wingdings 3","Dingbat dec":"192","Dingbat hex":"C0","Unicode dec":"129087","Unicode hex":"1F83F"},{"Typeface name":"Wingdings 3","Dingbat dec":"193","Dingbat hex":"C1","Unicode dec":"129088","Unicode hex":"1F840"},{"Typeface name":"Wingdings 3","Dingbat dec":"194","Dingbat hex":"C2","Unicode dec":"129090","Unicode hex":"1F842"},{"Typeface name":"Wingdings 3","Dingbat dec":"195","Dingbat hex":"C3","Unicode dec":"129089","Unicode hex":"1F841"},{"Typeface name":"Wingdings 3","Dingbat dec":"196","Dingbat hex":"C4","Unicode dec":"129091","Unicode hex":"1F843"},{"Typeface name":"Wingdings 3","Dingbat dec":"197","Dingbat hex":"C5","Unicode dec":"129092","Unicode hex":"1F844"},{"Typeface name":"Wingdings 3","Dingbat dec":"198","Dingbat hex":"C6","Unicode dec":"129094","Unicode hex":"1F846"},{"Typeface name":"Wingdings 3","Dingbat dec":"199","Dingbat hex":"C7","Unicode dec":"129093","Unicode hex":"1F845"},{"Typeface name":"Wingdings 3","Dingbat dec":"200","Dingbat hex":"C8","Unicode dec":"129095","Unicode hex":"1F847"},{"Typeface name":"Wingdings 3","Dingbat dec":"201","Dingbat hex":"C9","Unicode dec":"11176","Unicode hex":"2BA8"},{"Typeface name":"Wingdings 3","Dingbat dec":"202","Dingbat hex":"CA","Unicode dec":"11177","Unicode hex":"2BA9"},{"Typeface name":"Wingdings 3","Dingbat dec":"203","Dingbat hex":"CB","Unicode dec":"11178","Unicode hex":"2BAA"},{"Typeface name":"Wingdings 3","Dingbat dec":"204","Dingbat hex":"CC","Unicode dec":"11179","Unicode hex":"2BAB"},{"Typeface name":"Wingdings 3","Dingbat dec":"205","Dingbat hex":"CD","Unicode dec":"11180","Unicode hex":"2BAC"},{"Typeface name":"Wingdings 3","Dingbat dec":"206","Dingbat hex":"CE","Unicode dec":"11181","Unicode hex":"2BAD"},{"Typeface name":"Wingdings 3","Dingbat dec":"207","Dingbat hex":"CF","Unicode dec":"11182","Unicode hex":"2BAE"},{"Typeface name":"Wingdings 3","Dingbat dec":"208","Dingbat hex":"D0","Unicode dec":"11183","Unicode hex":"2BAF"},{"Typeface name":"Wingdings 3","Dingbat dec":"209","Dingbat hex":"D1","Unicode dec":"129120","Unicode hex":"1F860"},{"Typeface name":"Wingdings 3","Dingbat dec":"210","Dingbat hex":"D2","Unicode dec":"129122","Unicode hex":"1F862"},{"Typeface name":"Wingdings 3","Dingbat dec":"211","Dingbat hex":"D3","Unicode dec":"129121","Unicode hex":"1F861"},{"Typeface name":"Wingdings 3","Dingbat dec":"212","Dingbat hex":"D4","Unicode dec":"129123","Unicode hex":"1F863"},{"Typeface name":"Wingdings 3","Dingbat dec":"213","Dingbat hex":"D5","Unicode dec":"129124","Unicode hex":"1F864"},{"Typeface name":"Wingdings 3","Dingbat dec":"214","Dingbat hex":"D6","Unicode dec":"129125","Unicode hex":"1F865"},{"Typeface name":"Wingdings 3","Dingbat dec":"215","Dingbat hex":"D7","Unicode dec":"129127","Unicode hex":"1F867"},{"Typeface name":"Wingdings 3","Dingbat dec":"216","Dingbat hex":"D8","Unicode dec":"129126","Unicode hex":"1F866"},{"Typeface name":"Wingdings 3","Dingbat dec":"217","Dingbat hex":"D9","Unicode dec":"129136","Unicode hex":"1F870"},{"Typeface name":"Wingdings 3","Dingbat dec":"218","Dingbat hex":"DA","Unicode dec":"129138","Unicode hex":"1F872"},{"Typeface name":"Wingdings 3","Dingbat dec":"219","Dingbat hex":"DB","Unicode dec":"129137","Unicode hex":"1F871"},{"Typeface name":"Wingdings 3","Dingbat dec":"220","Dingbat hex":"DC","Unicode dec":"129139","Unicode hex":"1F873"},{"Typeface name":"Wingdings 3","Dingbat dec":"221","Dingbat hex":"DD","Unicode dec":"129140","Unicode hex":"1F874"},{"Typeface name":"Wingdings 3","Dingbat dec":"222","Dingbat hex":"DE","Unicode dec":"129141","Unicode hex":"1F875"},{"Typeface name":"Wingdings 3","Dingbat dec":"223","Dingbat hex":"DF","Unicode dec":"129143","Unicode hex":"1F877"},{"Typeface name":"Wingdings 3","Dingbat dec":"224","Dingbat hex":"E0","Unicode dec":"129142","Unicode hex":"1F876"},{"Typeface name":"Wingdings 3","Dingbat dec":"225","Dingbat hex":"E1","Unicode dec":"129152","Unicode hex":"1F880"},{"Typeface name":"Wingdings 3","Dingbat dec":"226","Dingbat hex":"E2","Unicode dec":"129154","Unicode hex":"1F882"},{"Typeface name":"Wingdings 3","Dingbat dec":"227","Dingbat hex":"E3","Unicode dec":"129153","Unicode hex":"1F881"},{"Typeface name":"Wingdings 3","Dingbat dec":"228","Dingbat hex":"E4","Unicode dec":"129155","Unicode hex":"1F883"},{"Typeface name":"Wingdings 3","Dingbat dec":"229","Dingbat hex":"E5","Unicode dec":"129156","Unicode hex":"1F884"},{"Typeface name":"Wingdings 3","Dingbat dec":"230","Dingbat hex":"E6","Unicode dec":"129157","Unicode hex":"1F885"},{"Typeface name":"Wingdings 3","Dingbat dec":"231","Dingbat hex":"E7","Unicode dec":"129159","Unicode hex":"1F887"},{"Typeface name":"Wingdings 3","Dingbat dec":"232","Dingbat hex":"E8","Unicode dec":"129158","Unicode hex":"1F886"},{"Typeface name":"Wingdings 3","Dingbat dec":"233","Dingbat hex":"E9","Unicode dec":"129168","Unicode hex":"1F890"},{"Typeface name":"Wingdings 3","Dingbat dec":"234","Dingbat hex":"EA","Unicode dec":"129170","Unicode hex":"1F892"},{"Typeface name":"Wingdings 3","Dingbat dec":"235","Dingbat hex":"EB","Unicode dec":"129169","Unicode hex":"1F891"},{"Typeface name":"Wingdings 3","Dingbat dec":"236","Dingbat hex":"EC","Unicode dec":"129171","Unicode hex":"1F893"},{"Typeface name":"Wingdings 3","Dingbat dec":"237","Dingbat hex":"ED","Unicode dec":"129172","Unicode hex":"1F894"},{"Typeface name":"Wingdings 3","Dingbat dec":"238","Dingbat hex":"EE","Unicode dec":"129174","Unicode hex":"1F896"},{"Typeface name":"Wingdings 3","Dingbat dec":"239","Dingbat hex":"EF","Unicode dec":"129173","Unicode hex":"1F895"},{"Typeface name":"Wingdings 3","Dingbat dec":"240","Dingbat hex":"F0","Unicode dec":"129175","Unicode hex":"1F897"}];$T.default=MLe;var ULe=ht&&ht.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(bl,"__esModule",{value:!0});bl.hex=bl.dec=bl.codePoint=void 0;var $Le=ULe($T),Dz={},LLe=String.fromCodePoint?String.fromCodePoint:HLe;for(var G2=0,a6=$Le.default;G2<a6.length;G2++){var Y2=a6[G2],i6=parseInt(Y2["Unicode dec"],10),BLe={codePoint:i6,string:LLe(i6)};Dz[Y2["Typeface name"].toUpperCase()+"_"+Y2["Dingbat dec"]]=BLe}function LT(e,t){return Dz[e.toUpperCase()+"_"+t]}bl.codePoint=LT;function WLe(e,t){return LT(e,parseInt(t,10))}bl.dec=WLe;function zLe(e,t){return LT(e,parseInt(t,16))}bl.hex=zLe;function HLe(e){if(e<=65535)return String.fromCharCode(e);var t=Math.floor((e-65536)/1024)+55296,r=(e-65536)%1024+56320;return String.fromCharCode(t,r)}var Kl={},s6=Xr;Kl.paragraph=VLe;Kl.run=qLe;Kl._elements=jz;Kl._elementsOfType=BT;Kl.getDescendantsOfType=GLe;Kl.getDescendants=Nz;function VLe(e){return BT("paragraph",e)}function qLe(e){return BT("run",e)}function BT(e,t){return jz(function(r){return r.type===e?t(r):r})}function jz(e){return function t(r){if(r.children){var n=s6.map(r.children,t);r=s6.extend(r,{children:n})}return e(r)}}function GLe(e,t){return Nz(e).filter(function(r){return r.type===t})}function Nz(e){var t=[];return Sz(e,function(r){t.push(r)}),t}function Sz(e,t){e.children&&e.children.forEach(function(r){Sz(r,t),t(r)})}var WT={};WT.uriToZipEntryName=YLe;WT.replaceFragment=XLe;function YLe(e,t){return t.charAt(0)==="/"?t.substr(1):e+"/"+t}function XLe(e,t){var r=e.indexOf("#");return r!==-1&&(e=e.substring(0,r)),e+"#"+t}UT.createBodyReader=ZLe;UT._readNumberingProperties=Tz;var o6=bl,ki=Xr,xr=Pt,Ez=fi.Result,so=fi.warning,KLe=Go,l6=Kl,c6=WT;function ZLe(e){return{readXmlElement:function(t){return new u6(e).readXmlElement(t)},readXmlElements:function(t){return new u6(e).readXmlElements(t)}}}function u6(e){var t=[],r=[],n=[],a=e.relationships,i=e.contentTypes,s=e.docxFile,l=e.files,c=e.numbering,u=e.styles;function d(H){var ne=H.map(f);return d6(ne)}function f(H){if(H.type==="element"){var ne=W[H.name];if(ne)return ne(H);if(!Object.prototype.hasOwnProperty.call(QLe,H.name)){var U=so("An unrecognised element was ignored: "+H.name);return dh([U])}}return Iu()}function h(H){return b(H).map(function(ne){return{type:"paragraphProperties",styleId:ne.styleId,styleName:ne.name,alignment:H.firstOrEmpty("w:jc").attributes["w:val"],numbering:Tz(ne.styleId,H.firstOrEmpty("w:numPr"),c),indent:m(H.firstOrEmpty("w:ind"))}})}function m(H){return{start:H.attributes["w:start"]||H.attributes["w:left"],end:H.attributes["w:end"]||H.attributes["w:right"],firstLine:H.attributes["w:firstLine"],hanging:H.attributes["w:hanging"]}}function x(H){return w(H).map(function(ne){var U=H.firstOrEmpty("w:sz").attributes["w:val"],le=/^[0-9]+$/.test(U)?parseInt(U,10)/2:null;return{type:"runProperties",styleId:ne.styleId,styleName:ne.name,verticalAlignment:H.firstOrEmpty("w:vertAlign").attributes["w:val"],font:H.firstOrEmpty("w:rFonts").attributes["w:ascii"],fontSize:le,isBold:g(H.first("w:b")),isUnderline:p(H.first("w:u")),isItalic:g(H.first("w:i")),isStrikethrough:g(H.first("w:strike")),isAllCaps:g(H.first("w:caps")),isSmallCaps:g(H.first("w:smallCaps")),highlight:y(H.firstOrEmpty("w:highlight").attributes["w:val"])}})}function p(H){if(H){var ne=H.attributes["w:val"];return ne!==void 0&&ne!=="false"&&ne!=="0"&&ne!=="none"}else return!1}function g(H){if(H){var ne=H.attributes["w:val"];return ne!=="false"&&ne!=="0"}else return!1}function v(H){return H!=="false"&&H!=="0"}function y(H){return!H||H==="none"?null:H}function b(H){return D(H,"w:pStyle","Paragraph",u.findParagraphStyleById)}function w(H){return D(H,"w:rStyle","Run",u.findCharacterStyleById)}function _(H){return D(H,"w:tblStyle","Table",u.findTableStyleById)}function D(H,ne,U,le){var re=[],X=H.first(ne),G=null,ce=null;if(X&&(G=X.attributes["w:val"],G)){var J=le(G);J?ce=J.name:re.push(pe(U,G))}return m0({styleId:G,name:ce},re)}function j(H){var ne=H.attributes["w:fldCharType"];if(ne==="begin")t.push({type:"begin",fldChar:H}),r=[];else if(ne==="end"){var U=t.pop();if(U.type==="begin"&&(U=S(U)),U.type==="checkbox")return Va(xr.checkbox({checked:U.checked}))}else if(ne==="separate"){var le=t.pop(),re=S(le);t.push(re)}return Iu()}function N(){var H=ki.last(t.filter(function(ne){return ne.type==="hyperlink"}));return H?H.options:null}function S(H){return E(r.join(""),H.type==="begin"?H.fldChar:KLe.emptyElement)}function E(H,ne){var U=/\s*HYPERLINK "(.*)"/.exec(H);if(U)return{type:"hyperlink",options:{href:U[1]}};var le=/\s*HYPERLINK\s+\\l\s+"(.*)"/.exec(H);if(le)return{type:"hyperlink",options:{anchor:le[1]}};var re=/\s*FORMCHECKBOX\s*/.exec(H);if(re){var X=ne.firstOrEmpty("w:ffData").firstOrEmpty("w:checkBox"),G=X.first("w:checked"),ce=G==null?g(X.first("w:default")):g(G);return{type:"checkbox",checked:ce}}return{type:"unknown"}}function A(H){return r.push(H.text()),Iu()}function T(H){var ne=H.attributes["w:font"],U=H.attributes["w:char"],le=o6.hex(ne,U);return le==null&&/^F0..$/.test(U)&&(le=o6.hex(ne,U.substring(2))),le==null?dh([so("A w:sym element with an unsupported character was ignored: char "+U+" in font "+ne)]):Va(new xr.Text(le.string))}function L(H){return function(ne){var U=ne.attributes["w:id"];return Va(new xr.NoteReference({noteType:H,noteId:U}))}}function O(H){return Va(xr.commentReference({commentId:H.attributes["w:id"]}))}function V(H){return d(H.children)}var W={"w:p":function(H){var ne=H.firstOrEmpty("w:pPr"),U=!!ne.firstOrEmpty("w:rPr").first("w:del");if(U)return H.children.forEach(function(re){n.push(re)}),Iu();var le=H.children;return n.length>0&&(le=n.concat(le),n=[]),Mn.map(h(ne),d(le),function(re,X){return new xr.Paragraph(X,re)}).insertExtra()},"w:r":function(H){return Mn.map(x(H.firstOrEmpty("w:rPr")),d(H.children),function(ne,U){var le=N();return le!==null&&(U=[new xr.Hyperlink(U,le)]),new xr.Run(U,ne)})},"w:fldChar":j,"w:instrText":A,"w:t":function(H){return Va(new xr.Text(H.text()))},"w:tab":function(H){return Va(new xr.Tab)},"w:noBreakHyphen":function(){return Va(new xr.Text(""))},"w:softHyphen":function(H){return Va(new xr.Text(""))},"w:sym":T,"w:hyperlink":function(H){var ne=H.attributes["r:id"],U=H.attributes["w:anchor"];return d(H.children).map(function(le){function re(G){var ce=H.attributes["w:tgtFrame"]||null;return new xr.Hyperlink(le,ki.extend({targetFrame:ce},G))}if(ne){var X=a.findTargetByRelationshipId(ne);return U&&(X=c6.replaceFragment(X,U)),re({href:X})}else return U?re({anchor:U}):le})},"w:tbl":B,"w:tr":F,"w:tc":I,"w:footnoteReference":L("footnote"),"w:endnoteReference":L("endnote"),"w:commentReference":O,"w:br":function(H){var ne=H.attributes["w:type"];return ne==null||ne==="textWrapping"?Va(xr.lineBreak):ne==="page"?Va(xr.pageBreak):ne==="column"?Va(xr.columnBreak):dh([so("Unsupported break type: "+ne)])},"w:bookmarkStart":function(H){var ne=H.attributes["w:name"];return ne==="_GoBack"?Iu():Va(new xr.BookmarkStart({name:ne}))},"mc:AlternateContent":function(H){return V(H.firstOrEmpty("mc:Fallback"))},"w:sdt":function(H){var ne=d(H.firstOrEmpty("w:sdtContent").children);return ne.map(function(U){var le=H.firstOrEmpty("w:sdtPr").first("wordml:checkbox");if(le){var re=le.first("wordml:checked"),X=!!re&&v(re.attributes["wordml:val"]),G=xr.checkbox({checked:X}),ce=!1,J=U.map(l6._elementsOfType(xr.types.text,function(ue){return ue.value.length>0&&!ce?(ce=!0,G):ue}));return ce?J:G}else return U})},"w:ins":V,"w:object":V,"w:smartTag":V,"w:drawing":V,"w:pict":function(H){return V(H).toExtra()},"v:roundrect":V,"v:shape":V,"v:textbox":V,"w:txbxContent":V,"wp:inline":z,"wp:anchor":z,"v:imagedata":ie,"v:group":V,"v:rect":V};return{readXmlElement:f,readXmlElements:d};function B(H){var ne=P(H.firstOrEmpty("w:tblPr"));return d(H.children).flatMap(C).flatMap(function(U){return ne.map(function(le){return xr.Table(U,le)})})}function P(H){return _(H).map(function(ne){return{styleId:ne.styleId,styleName:ne.name}})}function F(H){var ne=H.firstOrEmpty("w:trPr"),U=!!ne.first("w:del");if(U)return Iu();var le=!!ne.first("w:tblHeader");return d(H.children).map(function(re){return xr.TableRow(re,{isHeader:le})})}function I(H){return d(H.children).map(function(ne){var U=H.firstOrEmpty("w:tcPr"),le=U.firstOrEmpty("w:gridSpan").attributes["w:val"],re=le?parseInt(le,10):1,X=xr.TableCell(ne,{colSpan:re});return X._vMerge=R(U),X})}function R(H){var ne=H.first("w:vMerge");if(ne){var U=ne.attributes["w:val"];return U==="continue"||!U}else return null}function C(H){var ne=ki.any(H,function(re){return re.type!==xr.types.tableRow});if(ne)return k(H),m0(H,[so("unexpected non-row element in table, cell merging may be incorrect")]);var U=ki.any(H,function(re){return ki.any(re.children,function(X){return X.type!==xr.types.tableCell})});if(U)return k(H),m0(H,[so("unexpected non-cell element in table row, cell merging may be incorrect")]);var le={};return H.forEach(function(re){var X=0;re.children.forEach(function(G){G._vMerge&&le[X]?le[X].rowSpan++:(le[X]=G,G._vMerge=!1),X+=G.colSpan})}),H.forEach(function(re){re.children=re.children.filter(function(X){return!X._vMerge}),re.children.forEach(function(X){delete X._vMerge})}),Va(H)}function k(H){H.forEach(function(ne){var U=l6.getDescendantsOfType(ne,xr.types.tableCell);U.forEach(function(le){delete le._vMerge})})}function z(H){var ne=H.getElementsByTagName("a:graphic").getElementsByTagName("a:graphicData").getElementsByTagName("pic:pic").getElementsByTagName("pic:blipFill").getElementsByTagName("a:blip");return d6(ne.map(q.bind(null,H)))}function q(H,ne){var U=H.first("wp:docPr").attributes,le=K(U.descr)?U.title:U.descr,re=se(ne);return re===null?dh([so("Could not find image file for a:blip element")]):ae(re,le)}function K(H){return H==null||/^\s*$/.test(H)}function se(H){var ne=H.attributes["r:embed"],U=H.attributes["r:link"];if(ne)return ee(ne);if(U){var le=a.findTargetByRelationshipId(U);return{path:le,read:l.read.bind(l,le)}}else return null}function ie(H){var ne=H.attributes["r:id"];return ne?ae(ee(ne),H.attributes["o:title"]):dh([so("A v:imagedata element without a relationship ID was ignored")])}function ee(H){var ne=c6.uriToZipEntryName("word",a.findTargetByRelationshipId(H));return{path:ne,read:s.read.bind(s,ne)}}function ae(H,ne){var U=i.findContentType(H.path),le=xr.Image({readImage:H.read,altText:ne,contentType:U}),re=JLe[U]?[]:so("Image of type "+U+" is unlikely to display in web browsers");return m0(le,re)}function pe(H,ne){return so(H+" style with ID "+ne+" was referenced but not defined in the document")}}function Tz(e,t,r){var n=t.firstOrEmpty("w:ilvl").attributes["w:val"],a=t.firstOrEmpty("w:numId").attributes["w:val"];if(n!==void 0&&a!==void 0)return r.findLevel(a,n);if(e!=null){var i=r.findLevelByParagraphStyleId(e);if(i!=null)return i}return a!==void 0?r.findLevel(a,"0"):null}var JLe={"image/png":!0,"image/gif":!0,"image/jpeg":!0,"image/svg+xml":!0,"image/tiff":!0},QLe={"office-word:wrap":!0,"v:shadow":!0,"v:shapetype":!0,"w:annotationRef":!0,"w:bookmarkEnd":!0,"w:sectPr":!0,"w:proofErr":!0,"w:lastRenderedPageBreak":!0,"w:commentRangeStart":!0,"w:commentRangeEnd":!0,"w:del":!0,"w:footnoteRef":!0,"w:endnoteRef":!0,"w:pPr":!0,"w:rPr":!0,"w:tblPr":!0,"w:tblGrid":!0,"w:trPr":!0,"w:tcPr":!0};function dh(e){return new Mn(null,null,e)}function Iu(){return new Mn(null)}function Va(e){return new Mn(e)}function m0(e,t){return new Mn(e,null,t)}function Mn(e,t,r){this.value=e||[],this.extra=t||[],this._result=new Ez({element:this.value,extra:t},r),this.messages=this._result.messages}Mn.prototype.toExtra=function(){return new Mn(null,o1(this.extra,this.value),this.messages)};Mn.prototype.insertExtra=function(){var e=this.extra;return e&&e.length?new Mn(o1(this.value,e),null,this.messages):this};Mn.prototype.map=function(e){var t=this._result.map(function(r){return e(r.element)});return new Mn(t.value,this.extra,t.messages)};Mn.prototype.flatMap=function(e){var t=this._result.flatMap(function(r){return e(r.element)._result});return new Mn(t.value.element,o1(this.extra,t.value.extra),t.messages)};Mn.map=function(e,t,r){return new Mn(r(e.value,t.value),o1(e.extra,t.extra),e.messages.concat(t.messages))};function d6(e){var t=Ez.combine(ki.pluck(e,"_result"));return new Mn(ki.flatten(ki.pluck(t.value,"element")),ki.filter(ki.flatten(ki.pluck(t.value,"extra")),eBe),t.messages)}function o1(e,t){return ki.flatten([e,t])}function eBe(e){return e}var kz={};kz.DocumentXmlReader=nBe;var tBe=Pt,rBe=fi.Result;function nBe(e){var t=e.bodyReader;function r(n){var a=n.first("w:body");if(a==null)throw new Error("Could not find the body element: are you sure this is a docx file?");var i=t.readXmlElements(a.children).map(function(s){return new tBe.Document(s,{notes:e.notes,comments:e.comments})});return new rBe(i.value,i.messages)}return{convertXmlToDocument:r}}var l1={};l1.readRelationships=aBe;l1.defaultValue=new zT([]);l1.Relationships=zT;function aBe(e){var t=[];return e.children.forEach(function(r){if(r.name==="relationships:Relationship"){var n={relationshipId:r.attributes.Id,target:r.attributes.Target,type:r.attributes.Type};t.push(n)}}),new zT(t)}function zT(e){var t={};e.forEach(function(n){t[n.relationshipId]=n.target});var r={};return e.forEach(function(n){r[n.type]||(r[n.type]=[]),r[n.type].push(n.target)}),{findTargetByRelationshipId:function(n){return t[n]},findTargetsByType:function(n){return r[n]||[]}}}var HT={};HT.readContentTypesFromXml=sBe;var iBe={png:"png",gif:"gif",jpeg:"jpeg",jpg:"jpeg",tif:"tiff",tiff:"tiff",bmp:"bmp"};HT.defaultContentTypes=Cz({},{});function sBe(e){var t={},r={};return e.children.forEach(function(n){if(n.name==="content-types:Default"&&(t[n.attributes.Extension]=n.attributes.ContentType),n.name==="content-types:Override"){var a=n.attributes.PartName;a.charAt(0)==="/"&&(a=a.substring(1)),r[a]=n.attributes.ContentType}}),Cz(r,t)}function Cz(e,t){return{findContentType:function(r){var n=e[r];if(n)return n;var a=r.split("."),i=a[a.length-1];if(t.hasOwnProperty(i))return t[i];var s=iBe[i.toLowerCase()];return s?"image/"+s:null}}}var c1={},p0=Xr;c1.readNumberingXml=oBe;c1.Numbering=VT;c1.defaultNumbering=new VT({},{});function VT(e,t,r){var n=p0.flatten(p0.values(t).map(function(l){return p0.values(l.levels)})),a=p0.indexBy(n.filter(function(l){return l.paragraphStyleId!=null}),"paragraphStyleId");function i(l,c){var u=e[l];if(u){var d=t[u.abstractNumId];if(d){if(d.numStyleLink==null)return t[u.abstractNumId].levels[c];var f=r.findNumberingStyleById(d.numStyleLink);return i(f.numId,c)}else return null}else return null}function s(l){return a[l]||null}return{findLevel:i,findLevelByParagraphStyleId:s}}function oBe(e,t){if(!t||!t.styles)throw new Error("styles is missing");var r=lBe(e),n=uBe(e);return new VT(n,r,t.styles)}function lBe(e){var t={};return e.getElementsByTagName("w:abstractNum").forEach(function(r){var n=r.attributes["w:abstractNumId"];t[n]=cBe(r)}),t}function cBe(e){var t={},r=null;e.getElementsByTagName("w:lvl").forEach(function(a){var i=a.attributes["w:ilvl"],s=a.firstOrEmpty("w:numFmt").attributes["w:val"],l=s!=="bullet",c=a.firstOrEmpty("w:pStyle").attributes["w:val"];i===void 0?r={isOrdered:l,level:"0",paragraphStyleId:c}:t[i]={isOrdered:l,level:i,paragraphStyleId:c}}),r!==null&&t[r.level]===void 0&&(t[r.level]=r);var n=e.firstOrEmpty("w:numStyleLink").attributes["w:val"];return{levels:t,numStyleLink:n}}function uBe(e){var t={};return e.getElementsByTagName("w:num").forEach(function(r){var n=r.attributes["w:numId"],a=r.first("w:abstractNumId").attributes["w:val"];t[n]={abstractNumId:a}}),t}var u1={};u1.readStylesXml=dBe;u1.Styles=cp;u1.defaultStyles=new cp({},{});function cp(e,t,r,n){return{findParagraphStyleById:function(a){return e[a]},findCharacterStyleById:function(a){return t[a]},findTableStyleById:function(a){return r[a]},findNumberingStyleById:function(a){return n[a]}}}cp.EMPTY=new cp({},{},{},{});function dBe(e){var t={},r={},n={},a={},i={paragraph:t,character:r,table:n,numbering:a};return e.getElementsByTagName("w:style").forEach(function(s){var l=fBe(s),c=i[l.type];c&&c[l.styleId]===void 0&&(c[l.styleId]=l)}),new cp(t,r,n,a)}function fBe(e){var t=e.attributes["w:type"];if(t==="numbering")return mBe(t,e);var r=Az(e),n=hBe(e);return{type:t,styleId:r,name:n}}function hBe(e){var t=e.first("w:name");return t?t.attributes["w:val"]:null}function mBe(e,t){var r=Az(t),n=t.firstOrEmpty("w:pPr").firstOrEmpty("w:numPr").firstOrEmpty("w:numId").attributes["w:val"];return{type:e,numId:n,styleId:r}}function Az(e){return e.attributes["w:styleId"]}var qT={},pBe=Pt,xBe=fi.Result;qT.createFootnotesReader=Oz.bind(ht,"footnote");qT.createEndnotesReader=Oz.bind(ht,"endnote");function Oz(e,t){function r(i){return xBe.combine(i.getElementsByTagName("w:"+e).filter(n).map(a))}function n(i){var s=i.attributes["w:type"];return s!=="continuationSeparator"&&s!=="separator"}function a(i){var s=i.attributes["w:id"];return t.readXmlElements(i.children).map(function(l){return pBe.Note({noteType:e,noteId:s,body:l})})}return r}var Fz={},gBe=Pt,vBe=fi.Result;function yBe(e){function t(n){return vBe.combine(n.getElementsByTagName("w:comment").map(r))}function r(n){var a=n.attributes["w:id"];function i(s){return(n.attributes[s]||"").trim()||null}return e.readXmlElements(n.children).map(function(s){return gBe.comment({commentId:a,body:s,authorName:i("w:author"),authorInitials:i("w:initials")})})}return t}Fz.createCommentsReader=yBe;var Pz={},bBe=Tn;Pz.Files=wBe;function wBe(){function e(t){return bBe.reject(new Error("could not open external image: '"+t+`'
cannot open linked files from a web browser`))}return{read:e}}wT.read=TBe;wT._findPartPaths=Rz;var _Be=Tn,DBe=Pt,X2=fi.Result,Tv=mx,Iz=jT.readXmlFromZipFile,jBe=UT.createBodyReader,NBe=kz.DocumentXmlReader,Yd=l1,f6=HT,h6=c1,m6=u1,p6=qT,SBe=Fz,EBe=Pz.Files;function TBe(e,t,r){t=t||{},r=r||{};var n=new EBe({externalFileAccess:r.externalFileAccess,relativeToFile:t.path});return _Be.props({contentTypes:CBe(e),partPaths:Rz(e),docxFile:e,files:n}).also(function(a){return{styles:OBe(e,a.partPaths.styles)}}).also(function(a){return{numbering:ABe(e,a.partPaths.numbering,a.styles)}}).also(function(a){return{footnotes:x0(a.partPaths.footnotes,a,function(i,s){return s?p6.createFootnotesReader(i)(s):new X2([])}),endnotes:x0(a.partPaths.endnotes,a,function(i,s){return s?p6.createEndnotesReader(i)(s):new X2([])}),comments:x0(a.partPaths.comments,a,function(i,s){return s?SBe.createCommentsReader(i)(s):new X2([])})}}).also(function(a){return{notes:a.footnotes.flatMap(function(i){return a.endnotes.map(function(s){return new DBe.Notes(i.concat(s))})})}}).then(function(a){return x0(a.partPaths.mainDocument,a,function(i,s){return a.notes.flatMap(function(l){return a.comments.flatMap(function(c){var u=new NBe({bodyReader:i,notes:l,comments:c});return u.convertXmlToDocument(s)})})})})}function Rz(e){return FBe(e).then(function(t){var r=x6({docxFile:e,relationships:t,relationshipType:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",basePath:"",fallbackPath:"word/document.xml"});if(!e.exists(r))throw new Error("Could not find main document part. Are you sure this is a valid .docx file?");return If({filename:Mz(r),readElement:Yd.readRelationships,defaultValue:Yd.defaultValue})(e).then(function(n){function a(i){return x6({docxFile:e,relationships:n,relationshipType:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/"+i,basePath:Tv.splitPath(r).dirname,fallbackPath:"word/"+i+".xml"})}return{mainDocument:r,comments:a("comments"),endnotes:a("endnotes"),footnotes:a("footnotes"),numbering:a("numbering"),styles:a("styles")}})})}function x6(e){var t=e.docxFile,r=e.relationships,n=e.relationshipType,a=e.basePath,i=e.fallbackPath,s=r.findTargetsByType(n),l=s.map(function(u){return kBe(Tv.joinPath(a,u),"/")}),c=l.filter(function(u){return t.exists(u)});return c.length===0?i:c[0]}function kBe(e,t){return e.substring(0,t.length)===t?e.substring(t.length):e}function If(e){return function(t){return Iz(t,e.filename).then(function(r){return r?e.readElement(r):e.defaultValue})}}function x0(e,t,r){var n=If({filename:Mz(e),readElement:Yd.readRelationships,defaultValue:Yd.defaultValue});return n(t.docxFile).then(function(a){var i=new jBe({relationships:a,contentTypes:t.contentTypes,docxFile:t.docxFile,numbering:t.numbering,styles:t.styles,files:t.files});return Iz(t.docxFile,e).then(function(s){return r(i,s)})})}function Mz(e){var t=Tv.splitPath(e);return Tv.joinPath(t.dirname,"_rels",t.basename+".rels")}var CBe=If({filename:"[Content_Types].xml",readElement:f6.readContentTypesFromXml,defaultValue:f6.defaultContentTypes});function ABe(e,t,r){return If({filename:t,readElement:function(n){return h6.readNumberingXml(n,{styles:r})},defaultValue:h6.defaultNumbering})(e)}function OBe(e,t){return If({filename:t,readElement:m6.readStylesXml,defaultValue:m6.defaultStyles})(e)}var FBe=If({filename:"_rels/.rels",readElement:Yd.readRelationships,defaultValue:Yd.defaultValue}),GT={},PBe=Xr,IBe=Tn,up=Go;GT.writeStyleMap=MBe;GT.readStyleMap=LBe;var RBe="http://schemas.zwobble.org/mammoth/style-map",kv="mammoth/style-map",Uz="/"+kv;function MBe(e,t){return e.write(kv,t),UBe(e).then(function(){return $Be(e)})}function UBe(e){var t="word/_rels/document.xml.rels",r="http://schemas.openxmlformats.org/package/2006/relationships",n="{"+r+"}Relationship";return e.read(t,"utf8").then(up.readString).then(function(a){var i=a.children;$z(i,n,"Id",{Id:"rMammothStyleMap",Type:RBe,Target:Uz});var s={"":r};return e.write(t,up.writeString(a,s))})}function $Be(e){var t="[Content_Types].xml",r="http://schemas.openxmlformats.org/package/2006/content-types",n="{"+r+"}Override";return e.read(t,"utf8").then(up.readString).then(function(a){var i=a.children;$z(i,n,"PartName",{PartName:Uz,ContentType:"text/prs.mammoth.style-map"});var s={"":r};return e.write(t,up.writeString(a,s))})}function $z(e,t,r,n){var a=PBe.find(e,function(i){return i.name===t&&i.attributes[r]===n[r]});a?a.attributes=n:e.push(up.element(t,n))}function LBe(e){return e.exists(kv)?e.read(kv,"utf8"):IBe.resolve(null)}var YT={},lc={},oo={},el={},g6;function Lz(){if(g6)return el;g6=1;var e=f1();function t(c,u,d){return n(e.element(c,u,{fresh:!1}),d)}function r(c,u,d){var f=e.element(c,u,{fresh:!0});return n(f,d)}function n(c,u){return{type:"element",tag:c,children:u||[]}}function a(c){return{type:"text",value:c}}var i={type:"forceWrite"};el.freshElement=r,el.nonFreshElement=t,el.elementWithTag=n,el.text=a,el.forceWrite=i;var s={br:!0,hr:!0,img:!0,input:!0};function l(c){return c.children.length===0&&s[c.tag.tagName]}return el.isVoidElement=l,el}var K2,v6;function BBe(){if(v6)return K2;v6=1;var e=Xr,t=Lz();function r(p){return n(u(p))}function n(p){var g=[];return p.map(a).forEach(function(v){c(g,v)}),g}function a(p){return i[p.type](p)}var i={element:s,text:l,forceWrite:l};function s(p){return t.elementWithTag(p.tag,n(p.children))}function l(p){return p}function c(p,g){var v=p[p.length-1];g.type==="element"&&!g.tag.fresh&&v&&v.type==="element"&&g.tag.matchesElement(v.tag)?(g.tag.separator&&c(v.children,t.text(g.tag.separator)),g.children.forEach(function(y){c(v.children,y)})):p.push(g)}function u(p){return d(p,function(g){return f[g.type](g)})}function d(p,g){return e.flatten(e.map(p,g),!0)}var f={element:m,text:x,forceWrite:h};function h(p){return[p]}function m(p){var g=u(p.children);return g.length===0&&!t.isVoidElement(p)?[]:[t.elementWithTag(p.tag,g)]}function x(p){return p.value.length===0?[]:[p]}return K2=r,K2}var y6;function d1(){if(y6)return oo;y6=1;var e=Lz();oo.freshElement=e.freshElement,oo.nonFreshElement=e.nonFreshElement,oo.elementWithTag=e.elementWithTag,oo.text=e.text,oo.forceWrite=e.forceWrite,oo.simplify=BBe();function t(s,l){l.forEach(function(c){r(s,c)})}function r(s,l){n[l.type](s,l)}var n={element:a,text:i,forceWrite:function(){}};function a(s,l){e.isVoidElement(l)?s.selfClosing(l.tag.tagName,l.tag.attributes):(s.open(l.tag.tagName,l.tag.attributes),t(s,l.children),s.close(l.tag.tagName))}function i(s,l){s.text(l.value)}return oo.write=t,oo}var b6;function f1(){if(b6)return lc;b6=1;var e=Xr,t=d1();lc.topLevelElement=r,lc.elements=n,lc.element=i;function r(l,c){return n([i(l,c,{fresh:!0})])}function n(l){return new a(l.map(function(c){return e.isString(c)?i(c):c}))}function a(l){this._elements=l}a.prototype.wrap=function(c){for(var u=c(),d=this._elements.length-1;d>=0;d--)u=this._elements[d].wrapNodes(u);return u};function i(l,c,u){return u=u||{},new s(l,c,u)}function s(l,c,u){var d={};e.isArray(l)?(l.forEach(function(f){d[f]=!0}),l=l[0]):d[l]=!0,this.tagName=l,this.tagNames=d,this.attributes=c||{},this.fresh=u.fresh,this.separator=u.separator}return s.prototype.matchesElement=function(l){return this.tagNames[l.tagName]&&e.isEqual(this.attributes||{},l.attributes||{})},s.prototype.wrap=function(c){return this.wrapNodes(c())},s.prototype.wrapNodes=function(c){return[t.elementWithTag(this,c)]},lc.empty=n([]),lc.ignore={wrap:function(){return[]}},lc}var XT={};(function(e){var t=Xr,r=Tn,n=d1();e.imgElement=a;function a(i){return function(s,l){return r.when(i(s)).then(function(c){var u={};return s.altText&&(u.alt=s.altText),t.extend(u,c),[n.freshElement("img",u)]})}}e.inline=e.imgElement,e.dataUri=a(function(i){return i.readAsBase64String().then(function(s){return{src:"data:"+i.contentType+";base64,"+s}})})})(XT);var Bz={},Wz={},zz=Xr;Wz.writer=WBe;function WBe(e){return e=e||{},e.prettyPrint?zBe():Hz()}var g0={div:!0,p:!0,ul:!0,li:!0};function zBe(){var e=0,t="  ",r=[],n=!0,a=!1,i=Hz();function s(x,p){g0[x]&&h(),r.push(x),i.open(x,p),g0[x]&&e++,n=!1}function l(x){g0[x]&&(e--,h()),r.pop(),i.close(x)}function c(x){f();var p=m()?x:x.replace(`
`,`
`+t);i.text(p)}function u(x,p){h(),i.selfClosing(x,p)}function d(){return r.length===0||g0[r[r.length-1]]}function f(){a||(h(),a=!0)}function h(){if(a=!1,!n&&d()&&!m()){i._append(`
`);for(var x=0;x<e;x++)i._append(t)}}function m(){return zz.some(r,function(x){return x==="pre"})}return{asString:i.asString,open:s,close:l,text:c,selfClosing:u}}function Hz(){var e=[];function t(c,u){var d=a(u);e.push("<"+c+d+">")}function r(c){e.push("</"+c+">")}function n(c,u){var d=a(u);e.push("<"+c+d+" />")}function a(c){return zz.map(c,function(u,d){return" "+d+'="'+VBe(u)+'"'}).join("")}function i(c){e.push(HBe(c))}function s(c){e.push(c)}function l(){return e.join("")}return{asString:l,open:t,close:r,text:i,selfClosing:n,_append:s}}function HBe(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function VBe(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var Vz={},qBe=Xr;function w6(e){return Cv(e,e)}function Cv(e,t){return function(){return{start:e,end:t}}}function GBe(e){var t=e.href||"";return t?{start:"[",end:"]("+t+")",anchorPosition:"before"}:{}}function YBe(e){var t=e.src||"",r=e.alt||"";return t||r?{start:"!["+r+"]("+t+")"}:{}}function _6(e){return function(t,r){return{start:r?`
`:"",end:r?"":`
`,list:{isOrdered:e.isOrdered,indent:r?r.indent+1:0,count:0}}}}function XBe(e,t,r){t=t||{indent:0,isOrdered:!1,count:0},t.count++,r.hasClosed=!1;var n=t.isOrdered?t.count+".":"-",a=Gz("	",t.indent)+n+" ";return{start:a,end:function(){if(!r.hasClosed)return r.hasClosed=!0,`
`}}}var qz={p:Cv("",`

`),br:Cv("",`  
`),ul:_6({isOrdered:!1}),ol:_6({isOrdered:!0}),li:XBe,strong:w6("__"),em:w6("*"),a:GBe,img:YBe};(function(){for(var e=1;e<=6;e++)qz["h"+e]=Cv(Gz("#",e)+" ",`

`)})();function Gz(e,t){return new Array(t+1).join(e)}function KBe(){var e=[],t=[],r=null,n={};function a(d,f){f=f||{};var h=qz[d]||function(){return{}},m=h(f,r,n);t.push({end:m.end,list:r}),m.list&&(r=m.list);var x=m.anchorPosition==="before";x&&i(f),e.push(m.start||""),x||i(f)}function i(d){d.id&&e.push('<a id="'+d.id+'"></a>')}function s(d){var f=t.pop();r=f.list;var h=qBe.isFunction(f.end)?f.end():f.end;e.push(h||"")}function l(d,f){a(d,f),s()}function c(d){e.push(ZBe(d))}function u(){return e.join("")}return{asString:u,open:a,close:s,text:c,selfClosing:l}}Vz.writer=KBe;function ZBe(e){return e.replace(/\\/g,"\\\\").replace(/([\`\*_\{\}\[\]\(\)\#\+\-\.\!])/g,"\\$1")}var JBe=Wz,QBe=Vz;Bz.writer=e9e;function e9e(e){return e=e||{},e.outputFormat==="markdown"?QBe.writer():JBe.writer(e)}var il=Xr,D6=Tn,F0=Pt,yi=f1(),Tj=fi,t9e=XT,It=d1(),r9e=Bz;YT.DocumentConverter=n9e;function n9e(e){return{convertToHtml:function(t){var r=il.indexBy(t.type===F0.types.document?t.comments:[],"commentId"),n=new a9e(e,r);return n.convertToHtml(t)}}}function a9e(e,t){var r=1,n=[],a=[];e=il.extend({ignoreEmptyParagraphs:!0},e);var i=e.idPrefix===void 0?"":e.idPrefix,s=e.ignoreEmptyParagraphs,l=yi.topLevelElement("p"),c=e.styleMap||[];function u(P){var F=[],I=f(P,F,{}),R=[];Yz(I,function(k){k.type==="deferred"&&R.push(k)});var C={};return D6.mapSeries(R,function(k){return k.value().then(function(z){C[k.id]=z})}).then(function(){function k(q){return Z2(q,function(K){return K.type==="deferred"?C[K.id]:K.children?[il.extend({},K,{children:k(K.children)})]:[K]})}var z=r9e.writer({prettyPrint:e.prettyPrint,outputFormat:e.outputFormat});return It.write(z,It.simplify(k(I))),new Tj.Result(z.asString(),F)})}function d(P,F,I){return Z2(P,function(R){return f(R,F,I)})}function f(P,F,I){if(!I)throw new Error("options not set");var R=B[P.type];return R?R(P,F,I):[]}function h(P,F,I){return m(P,F).wrap(function(){var R=d(P.children,F,I);return s?R:[It.forceWrite].concat(R)})}function m(P,F){var I=v(P);return I?I.to:(P.styleId&&F.push(j6("paragraph",P)),l)}function x(P,F,I){var R=function(){return d(P.children,F,I)},C=[];if(P.highlight!==null){var k=g({type:"highlight",color:P.highlight});k&&C.push(k)}P.isSmallCaps&&C.push(p("smallCaps")),P.isAllCaps&&C.push(p("allCaps")),P.isStrikethrough&&C.push(p("strikethrough","s")),P.isUnderline&&C.push(p("underline")),P.verticalAlignment===F0.verticalAlignment.subscript&&C.push(yi.element("sub",{},{fresh:!1})),P.verticalAlignment===F0.verticalAlignment.superscript&&C.push(yi.element("sup",{},{fresh:!1})),P.isItalic&&C.push(p("italic","em")),P.isBold&&C.push(p("bold","strong"));var z=yi.empty,q=v(P);return q?z=q.to:P.styleId&&F.push(j6("run",P)),C.push(z),C.forEach(function(K){R=K.wrap.bind(K,R)}),R()}function p(P,F){var I=g({type:P});return I||(F?yi.element(F,{},{fresh:!1}):yi.empty)}function g(P,F){var I=v(P);return I?I.to:F}function v(P){for(var F=0;F<c.length;F++)if(c[F].from.matches(P))return c[F]}function y(P){return function(F,I){return D6.attempt(function(){return P(F,I)}).caught(function(R){return I.push(Tj.error(R)),[]})}}function b(P){return _(P.noteType,P.noteId)}function w(P){return D(P.noteType,P.noteId)}function _(P,F){return j(P+"-"+F)}function D(P,F){return j(P+"-ref-"+F)}function j(P){return i+P}var N=yi.elements([yi.element("table",{},{fresh:!0})]);function S(P,F,I){return g(P,N).wrap(function(){return E(P,F,I)})}function E(P,F,I){var R=il.findIndex(P.children,function(q){return!q.type===F0.types.tableRow||!q.isHeader});R===-1&&(R=P.children.length);var C;if(R===0)C=d(P.children,F,il.extend({},I,{isTableHeader:!1}));else{var k=d(P.children.slice(0,R),F,il.extend({},I,{isTableHeader:!0})),z=d(P.children.slice(R),F,il.extend({},I,{isTableHeader:!1}));C=[It.freshElement("thead",{},k),It.freshElement("tbody",{},z)]}return[It.forceWrite].concat(C)}function A(P,F,I){var R=d(P.children,F,I);return[It.freshElement("tr",{},[It.forceWrite].concat(R))]}function T(P,F,I){var R=I.isTableHeader?"th":"td",C=d(P.children,F,I),k={};return P.colSpan!==1&&(k.colspan=P.colSpan.toString()),P.rowSpan!==1&&(k.rowspan=P.rowSpan.toString()),[It.freshElement(R,k,[It.forceWrite].concat(C))]}function L(P,F,I){return g(P,yi.ignore).wrap(function(){var R=t[P.commentId],C=a.length+1,k="["+o9e(R)+C+"]";return a.push({label:k,comment:R}),[It.freshElement("a",{href:"#"+_("comment",P.commentId),id:D("comment",P.commentId)},[It.text(k)])]})}function O(P,F,I){var R=P.label,C=P.comment,k=d(C.body,F,I).concat([It.nonFreshElement("p",{},[It.text(" "),It.freshElement("a",{href:"#"+D("comment",C.commentId)},[It.text("")])])]);return[It.freshElement("dt",{id:_("comment",C.commentId)},[It.text("Comment "+R)]),It.freshElement("dd",{},k)]}function V(P,F,I){return W(P).wrap(function(){return[]})}function W(P){var F=v(P);return F?F.to:P.breakType==="line"?yi.topLevelElement("br"):yi.empty}var B={document:function(P,F,I){var R=d(P.children,F,I),C=n.map(function(z){return P.notes.resolve(z)}),k=d(C,F,I);return R.concat([It.freshElement("ol",{},k),It.freshElement("dl",{},Z2(a,function(z){return O(z,F,I)}))])},paragraph:h,run:x,text:function(P,F,I){return[It.text(P.value)]},tab:function(P,F,I){return[It.text("	")]},hyperlink:function(P,F,I){var R=P.anchor?"#"+j(P.anchor):P.href,C={href:R};P.targetFrame!=null&&(C.target=P.targetFrame);var k=d(P.children,F,I);return[It.nonFreshElement("a",C,k)]},checkbox:function(P){var F={type:"checkbox"};return P.checked&&(F.checked="checked"),[It.freshElement("input",F)]},bookmarkStart:function(P,F,I){var R=It.freshElement("a",{id:j(P.name)},[It.forceWrite]);return[R]},noteReference:function(P,F,I){n.push(P);var R=It.freshElement("a",{href:"#"+b(P),id:w(P)},[It.text("["+r+++"]")]);return[It.freshElement("sup",{},[R])]},note:function(P,F,I){var R=d(P.body,F,I),C=It.elementWithTag(yi.element("p",{},{fresh:!1}),[It.text(" "),It.freshElement("a",{href:"#"+w(P)},[It.text("")])]),k=R.concat([C]);return It.freshElement("li",{id:b(P)},k)},commentReference:L,comment:O,image:s9e(y(e.convertImage||t9e.dataUri)),table:S,tableRow:A,tableCell:T,break:V};return{convertToHtml:u}}var i9e=1;function s9e(e){return function(t,r,n){return[{type:"deferred",id:i9e++,value:function(){return e(t,r,n)}}]}}function j6(e,t){return Tj.warning("Unrecognised "+e+" style: '"+t.styleName+"' (Style ID: "+t.styleId+")")}function Z2(e,t){return il.flatten(e.map(t),!0)}function Yz(e,t){e.forEach(function(r){t(r),r.children&&Yz(r.children,t)})}var o9e=YT.commentAuthorLabel=function(t){return t.authorInitials||""},Xz={},l9e=Pt;function Kz(e){if(e.type==="text")return e.value;if(e.type===l9e.types.tab)return"	";var t=e.type==="paragraph"?`

`:"";return(e.children||[]).map(Kz).join("")+t}Xz.convertElementToRawText=Kz;var h1={},Ds={},Zz={},Jz={exports:{}},Xd=Jz.exports=function(e,t){this._tokens=e,this._startIndex=t||0};Xd.prototype.head=function(){return this._tokens[this._startIndex]};Xd.prototype.tail=function(e){return new Xd(this._tokens,this._startIndex+1)};Xd.prototype.toArray=function(){return this._tokens.slice(this._startIndex)};Xd.prototype.end=function(){return this._tokens[this._tokens.length-1]};Xd.prototype.to=function(e){var t=this.head().source,r=e.head()||e.end();return t.to(r.source)};var c9e=Jz.exports,u9e=c9e;Zz.Parser=function(e){var t=function(r,n){return r(new u9e(n))};return{parseTokens:t}};var KT={},Qz={};(function(e){e.none=Object.create({value:function(){throw new Error("Called value on none")},isNone:function(){return!0},isSome:function(){return!1},map:function(){return e.none},flatMap:function(){return e.none},filter:function(){return e.none},toArray:function(){return[]},orElse:t,valueOrElse:t});function t(n){return typeof n=="function"?n():n}e.some=function(n){return new r(n)};var r=function(n){this._value=n};r.prototype.value=function(){return this._value},r.prototype.isNone=function(){return!1},r.prototype.isSome=function(){return!0},r.prototype.map=function(n){return new r(n(this._value))},r.prototype.flatMap=function(n){return n(this._value)},r.prototype.filter=function(n){return n(this._value)?this:e.none},r.prototype.toArray=function(){return[this._value]},r.prototype.orElse=function(n){return this},r.prototype.valueOrElse=function(n){return this._value},e.isOption=function(n){return n===e.none||n instanceof r},e.fromNullable=function(n){return n==null?e.none:new r(n)}})(Qz);var ZT={failure:function(e,t){if(e.length<1)throw new Error("Failure must have errors");return new ea({status:"failure",remaining:t,errors:e})},error:function(e,t){if(e.length<1)throw new Error("Failure must have errors");return new ea({status:"error",remaining:t,errors:e})},success:function(e,t,r){return new ea({status:"success",value:e,source:r,remaining:t,errors:[]})},cut:function(e){return new ea({status:"cut",remaining:e,errors:[]})}},ea=function(e){this._value=e.value,this._status=e.status,this._hasValue=e.value!==void 0,this._remaining=e.remaining,this._source=e.source,this._errors=e.errors};ea.prototype.map=function(e){return this._hasValue?new ea({value:e(this._value,this._source),status:this._status,remaining:this._remaining,source:this._source,errors:this._errors}):this};ea.prototype.changeRemaining=function(e){return new ea({value:this._value,status:this._status,remaining:e,source:this._source,errors:this._errors})};ea.prototype.isSuccess=function(){return this._status==="success"||this._status==="cut"};ea.prototype.isFailure=function(){return this._status==="failure"};ea.prototype.isError=function(){return this._status==="error"};ea.prototype.isCut=function(){return this._status==="cut"};ea.prototype.value=function(){return this._value};ea.prototype.remaining=function(){return this._remaining};ea.prototype.source=function(){return this._source};ea.prototype.errors=function(){return this._errors};var JT={};JT.error=function(e){return new m1(e)};var m1=function(e){this.expected=e.expected,this.actual=e.actual,this._location=e.location};m1.prototype.describe=function(){var e=this._location?this._location.describe()+`:
`:"";return e+"Expected "+this.expected+`
but got `+this.actual};m1.prototype.lineNumber=function(){return this._location.lineNumber()};m1.prototype.characterNumber=function(){return this._location.characterNumber()};var eH={};eH.fromArray=function(e){var t=0,r=function(){return t<e.length};return new Kc({hasNext:r,next:function(){if(r())return e[t++];throw new Error("No more elements")}})};var Kc=function(e){this._iterator=e};Kc.prototype.map=function(e){var t=this._iterator;return new Kc({hasNext:function(){return t.hasNext()},next:function(){return e(t.next())}})};Kc.prototype.filter=function(e){var t=this._iterator,r=!1,n=!1,a,i=function(){if(!r)for(r=!0,n=!1;t.hasNext()&&!n;)a=t.next(),n=e(a)};return new Kc({hasNext:function(){return i(),n},next:function(){i();var s=a;return r=!1,s}})};Kc.prototype.first=function(){var e=this._iterator;return this._iterator.hasNext()?e.next():null};Kc.prototype.toArray=function(){for(var e=[];this._iterator.hasNext();)e.push(this._iterator.next());return e};(function(e){var t=Xr,r=Qz,n=ZT,a=JT,i=eH;e.token=function(h,m){var x=m!==void 0;return function(p){var g=p.head();if(g&&g.name===h&&(!x||g.value===m))return n.success(g.value,p.tail(),g.source);var v=d({name:h,value:m});return f(p,v)}},e.tokenOfType=function(h){return e.token(h)},e.firstOf=function(h,m){return t.isArray(m)||(m=Array.prototype.slice.call(arguments,1)),function(x){return i.fromArray(m).map(function(p){return p(x)}).filter(function(p){return p.isSuccess()||p.isError()}).first()||f(x,h)}},e.then=function(h,m){return function(x){var p=h(x);return p.map||console.log(p),p.map(m)}},e.sequence=function(){var h=Array.prototype.slice.call(arguments,0),m=function(p){var g=t.foldl(h,function(y,b){var w=y.result,_=y.hasCut;if(!w.isSuccess())return{result:w,hasCut:_};var D=b(w.remaining());if(D.isCut())return{result:w,hasCut:!0};if(D.isSuccess()){var j;b.isCaptured?j=w.value().withValue(b,D.value()):j=w.value();var N=D.remaining(),S=p.to(N);return{result:n.success(j,N,S),hasCut:_}}else return _?{result:n.error(D.errors(),D.remaining()),hasCut:_}:{result:D,hasCut:_}},{result:n.success(new s,p),hasCut:!1}).result,v=p.to(g.remaining());return g.map(function(y){return y.withValue(e.sequence.source,v)})};m.head=function(){var p=t.find(h,x);return e.then(m,e.sequence.extract(p))},m.map=function(p){return e.then(m,function(g){return p.apply(this,g.toArray())})};function x(p){return p.isCaptured}return m};var s=function(h,m){this._values=h||{},this._valuesArray=m||[]};s.prototype.withValue=function(h,m){if(h.captureName&&h.captureName in this._values)throw new Error('Cannot add second value for capture "'+h.captureName+'"');var x=t.clone(this._values);x[h.captureName]=m;var p=this._valuesArray.concat([m]);return new s(x,p)},s.prototype.get=function(h){if(h.captureName in this._values)return this._values[h.captureName];throw new Error('No value for capture "'+h.captureName+'"')},s.prototype.toArray=function(){return this._valuesArray},e.sequence.capture=function(h,m){var x=function(){return h.apply(this,arguments)};return x.captureName=m,x.isCaptured=!0,x},e.sequence.extract=function(h){return function(m){return m.get(h)}},e.sequence.applyValues=function(h){var m=Array.prototype.slice.call(arguments,1);return function(x){var p=m.map(function(g){return x.get(g)});return h.apply(this,p)}},e.sequence.source={captureName:"source"},e.sequence.cut=function(){return function(h){return n.cut(h)}},e.optional=function(h){return function(m){var x=h(m);return x.isSuccess()?x.map(r.some):x.isFailure()?n.success(r.none,m):x}},e.zeroOrMoreWithSeparator=function(h,m){return u(h,m,!1)},e.oneOrMoreWithSeparator=function(h,m){return u(h,m,!0)};var l=e.zeroOrMore=function(h){return function(m){for(var x=[],p;(p=h(m))&&p.isSuccess();)m=p.remaining(),x.push(p.value());return p.isError()?p:n.success(x,m)}};e.oneOrMore=function(h){return e.oneOrMoreWithSeparator(h,c)};function c(h){return n.success(null,h)}var u=function(h,m,x){return function(p){var g=h(p);if(g.isSuccess()){var v=e.sequence.capture(h,"main"),y=l(e.then(e.sequence(m,v),e.sequence.extract(v))),b=y(g.remaining());return n.success([g.value()].concat(b.value()),b.remaining())}else return x||g.isError()?g:n.success([],p)}};e.leftAssociative=function(h,m,x){var p;x?p=[{func:x,rule:m}]:p=m,p=p.map(function(v){return e.then(v.rule,function(y){return function(b,w){return v.func(b,y,w)}})});var g=e.firstOf.apply(null,["rules"].concat(p));return function(v){var y=v,b=h(v);if(!b.isSuccess())return b;for(var w=g(b.remaining());w.isSuccess();){var _=w.remaining(),D=y.to(w.remaining()),j=w.value();b=n.success(j(b.value(),D),_,D),w=g(b.remaining())}return w.isError()?w:b}},e.leftAssociative.firstOf=function(){return Array.prototype.slice.call(arguments,0)},e.nonConsuming=function(h){return function(m){return h(m).changeRemaining(m)}};var d=function(h){return h.value?h.name+' "'+h.value+'"':h.name};function f(h,m){var x,p=h.head();return p?x=a.error({expected:m,actual:d(p),location:p.source}):x=a.error({expected:m,actual:"end of tokens"}),n.failure([x],h)}})(KT);var tH={exports:{}};tH.exports=function(e,t){var r={asString:function(){return e},range:function(n,a){return new Zc(e,t,n,a)}};return r};var Zc=function(e,t,r,n){this._string=e,this._description=t,this._startIndex=r,this._endIndex=n};Zc.prototype.to=function(e){return new Zc(this._string,this._description,this._startIndex,e._endIndex)};Zc.prototype.describe=function(){var e=this._position(),t=this._description?this._description+`
`:"";return t+"Line number: "+e.lineNumber+`
Character number: `+e.characterNumber};Zc.prototype.lineNumber=function(){return this._position().lineNumber};Zc.prototype.characterNumber=function(){return this._position().characterNumber};Zc.prototype._position=function(){for(var e=this,t=0,r=function(){return e._string.indexOf(`
`,t)},n=1;r()!==-1&&r()<this._startIndex;)t=r()+1,n+=1;var a=this._startIndex-t+1;return{lineNumber:n,characterNumber:a}};var rH=tH.exports,nH=function(e,t,r){this.name=e,this.value=t,r&&(this.source=r)},aH={};(function(e){var t=KT,r=ZT;e.parser=function(i,s,l){var c={rule:h,leftAssociative:m,rightAssociative:x},u=new n(l.map(f)),d=t.firstOf(i,s);function f(v){return{name:v.name,rule:a(v.ruleBuilder.bind(null,c))}}function h(){return p(u)}function m(v){return p(u.untilExclusive(v))}function x(v){return p(u.untilInclusive(v))}function p(v){return g.bind(null,v)}function g(v,y){var b=d(y);return b.isSuccess()?v.apply(b):b}return c};function n(i){function s(f){return new n(i.slice(0,c().indexOf(f)))}function l(f){return new n(i.slice(0,c().indexOf(f)+1))}function c(){return i.map(function(f){return f.name})}function u(f){for(var h,m;;)if(h=d(f.remaining()),h.isSuccess())m=f.source().to(h.source()),f=r.success(h.value()(f.value(),m),h.remaining(),m);else return h.isFailure()?f:h}function d(f){return t.firstOf("infix",i.map(function(h){return h.rule}))(f)}return{apply:u,untilExclusive:s,untilInclusive:l}}e.infix=function(i,s){function l(c){return e.infix(i,function(u){var d=s(u);return function(f){var h=d(f);return h.map(function(m){return function(x,p){return c(x,m,p)}})}})}return{name:i,ruleBuilder:s,map:l}};var a=function(i){var s;return function(l){return s||(s=i()),s(l)}}})(aH);var iH={},J2=nH,d9e=rH;iH.RegexTokeniser=f9e;function f9e(e){e=e.map(function(a){return{name:a.name,regex:new RegExp(a.regex.source,"g")}});function t(a,i){for(var s=new d9e(a,i),l=0,c=[];l<a.length;){var u=r(a,l,s);l=u.endIndex,c.push(u.token)}return c.push(n(a,s)),c}function r(a,i,s){for(var l=0;l<e.length;l++){var c=e[l].regex;c.lastIndex=i;var u=c.exec(a);if(u){var f=i+u[0].length;if(u.index===i&&f>i){var d=u[1],h=new J2(e[l].name,d,s.range(i,f));return{token:h,endIndex:f}}}}var f=i+1,h=new J2("unrecognisedCharacter",a.substring(i,f),s.range(i,f));return{token:h,endIndex:f}}function n(a,i){return new J2("end",null,i.range(a.length,a.length))}return{tokenise:t}}Ds.Parser=Zz.Parser;Ds.rules=KT;Ds.errors=JT;Ds.results=ZT;Ds.StringSource=rH;Ds.Token=nH;Ds.bottomUp=aH;Ds.RegexTokeniser=iH.RegexTokeniser;Ds.rule=function(e){var t;return function(r){return t||(t=e()),t(r)}};var Ln={};Ln.paragraph=h9e;Ln.run=m9e;Ln.table=p9e;Ln.bold=new js("bold");Ln.italic=new js("italic");Ln.underline=new js("underline");Ln.strikethrough=new js("strikethrough");Ln.allCaps=new js("allCaps");Ln.smallCaps=new js("smallCaps");Ln.highlight=x9e;Ln.commentReference=new js("commentReference");Ln.lineBreak=new p1({breakType:"line"});Ln.pageBreak=new p1({breakType:"page"});Ln.columnBreak=new p1({breakType:"column"});Ln.equalTo=v9e;Ln.startsWith=y9e;function h9e(e){return new js("paragraph",e)}function m9e(e){return new js("run",e)}function p9e(e){return new js("table",e)}function x9e(e){return new sH(e)}function js(e,t){t=t||{},this._elementType=e,this._styleId=t.styleId,this._styleName=t.styleName,t.list&&(this._listIndex=t.list.levelIndex,this._listIsOrdered=t.list.isOrdered)}js.prototype.matches=function(e){return e.type===this._elementType&&(this._styleId===void 0||e.styleId===this._styleId)&&(this._styleName===void 0||e.styleName&&this._styleName.operator(this._styleName.operand,e.styleName))&&(this._listIndex===void 0||g9e(e,this._listIndex,this._listIsOrdered))&&(this._breakType===void 0||this._breakType===e.breakType)};function sH(e){e=e||{},this._color=e.color}sH.prototype.matches=function(e){return e.type==="highlight"&&(this._color===void 0||e.color===this._color)};function p1(e){e=e||{},this._breakType=e.breakType}p1.prototype.matches=function(e){return e.type==="break"&&(this._breakType===void 0||e.breakType===this._breakType)};function g9e(e,t,r){return e.numbering&&e.numbering.level==t&&e.numbering.isOrdered==r}function v9e(e){return{operator:b9e,operand:e}}function y9e(e){return{operator:w9e,operand:e}}function b9e(e,t){return e.toUpperCase()===t.toUpperCase()}function w9e(e,t){return t.toUpperCase().indexOf(e.toUpperCase())===0}var oH={},_9e=Ds,D9e=_9e.RegexTokeniser;oH.tokenise=j9e;var N6="'((?:\\\\.|[^'])*)";function j9e(e){var t="(?:[a-zA-Z\\-_]|\\\\.)",r=new D9e([{name:"identifier",regex:new RegExp("("+t+"(?:"+t+"|[0-9])*)")},{name:"dot",regex:/\./},{name:"colon",regex:/:/},{name:"gt",regex:/>/},{name:"whitespace",regex:/\s+/},{name:"arrow",regex:/=>/},{name:"equals",regex:/=/},{name:"startsWith",regex:/\^=/},{name:"open-paren",regex:/\(/},{name:"close-paren",regex:/\)/},{name:"open-square-bracket",regex:/\[/},{name:"close-square-bracket",regex:/\]/},{name:"string",regex:new RegExp(N6+"'")},{name:"unterminated-string",regex:new RegExp(N6)},{name:"integer",regex:/([0-9]+)/},{name:"choice",regex:/\|/},{name:"bang",regex:/(!)/}]);return r.tokenise(e)}var N9e=Xr,Fe=Ds,Hn=Ln,P0=f1(),S9e=oH.tokenise,Q2=fi;h1.readHtmlPath=C9e;h1.readDocumentMatcher=k9e;h1.readStyle=E9e;function E9e(e){return QT(U9e,e)}function T9e(){return Fe.rules.sequence(Fe.rules.sequence.capture(lH()),Fe.rules.tokenOfType("whitespace"),Fe.rules.tokenOfType("arrow"),Fe.rules.sequence.capture(Fe.rules.optional(Fe.rules.sequence(Fe.rules.tokenOfType("whitespace"),Fe.rules.sequence.capture(cH())).head())),Fe.rules.tokenOfType("end")).map(function(e,t){return{from:e,to:t.valueOrElse(P0.empty)}})}function k9e(e){return QT(lH(),e)}function lH(){var e=Fe.rules.sequence,t=function(D,j){return Fe.rules.then(Fe.rules.token("identifier",D),function(){return j})},r=t("p",Hn.paragraph),n=t("r",Hn.run),a=Fe.rules.firstOf("p or r or table",r,n),i=Fe.rules.sequence(Fe.rules.tokenOfType("dot"),Fe.rules.sequence.cut(),Fe.rules.sequence.capture(x1)).map(function(D){return{styleId:D}}),s=Fe.rules.firstOf("style name matcher",Fe.rules.then(Fe.rules.sequence(Fe.rules.tokenOfType("equals"),Fe.rules.sequence.cut(),Fe.rules.sequence.capture(Xu)).head(),function(D){return{styleName:Hn.equalTo(D)}}),Fe.rules.then(Fe.rules.sequence(Fe.rules.tokenOfType("startsWith"),Fe.rules.sequence.cut(),Fe.rules.sequence.capture(Xu)).head(),function(D){return{styleName:Hn.startsWith(D)}})),l=Fe.rules.sequence(Fe.rules.tokenOfType("open-square-bracket"),Fe.rules.sequence.cut(),Fe.rules.token("identifier","style-name"),Fe.rules.sequence.capture(s),Fe.rules.tokenOfType("close-square-bracket")).head(),c=Fe.rules.firstOf("list type",t("ordered-list",{isOrdered:!0}),t("unordered-list",{isOrdered:!1})),u=e(Fe.rules.tokenOfType("colon"),e.capture(c),e.cut(),Fe.rules.tokenOfType("open-paren"),e.capture(A9e),Fe.rules.tokenOfType("close-paren")).map(function(D,j){return{list:{isOrdered:D.isOrdered,levelIndex:j-1}}});function d(D){var j=Fe.rules.firstOf.apply(Fe.rules.firstOf,["matcher suffix"].concat(D)),N=Fe.rules.zeroOrMore(j);return Fe.rules.then(N,function(S){var E={};return S.forEach(function(A){N9e.extend(E,A)}),E})}var f=e(e.capture(a),e.capture(d([i,l,u]))).map(function(D,j){return D(j)}),h=e(Fe.rules.token("identifier","table"),e.capture(d([i,l]))).map(function(D){return Hn.table(D)}),m=t("b",Hn.bold),x=t("i",Hn.italic),p=t("u",Hn.underline),g=t("strike",Hn.strikethrough),v=t("all-caps",Hn.allCaps),y=t("small-caps",Hn.smallCaps),b=e(Fe.rules.token("identifier","highlight"),Fe.rules.sequence.capture(Fe.rules.optional(Fe.rules.sequence(Fe.rules.tokenOfType("open-square-bracket"),Fe.rules.sequence.cut(),Fe.rules.token("identifier","color"),Fe.rules.tokenOfType("equals"),Fe.rules.sequence.capture(Xu),Fe.rules.tokenOfType("close-square-bracket")).head()))).map(function(D){return Hn.highlight({color:D.valueOrElse(void 0)})}),w=t("comment-reference",Hn.commentReference),_=e(Fe.rules.token("identifier","br"),e.cut(),Fe.rules.tokenOfType("open-square-bracket"),Fe.rules.token("identifier","type"),Fe.rules.tokenOfType("equals"),e.capture(Xu),Fe.rules.tokenOfType("close-square-bracket")).map(function(D){switch(D){case"line":return Hn.lineBreak;case"page":return Hn.pageBreak;case"column":return Hn.columnBreak}});return Fe.rules.firstOf("element type",f,h,m,x,p,g,v,y,b,w,_)}function C9e(e){return QT(cH(),e)}function cH(){var e=Fe.rules.sequence.capture,t=Fe.rules.tokenOfType("whitespace"),r=Fe.rules.then(Fe.rules.optional(Fe.rules.sequence(Fe.rules.tokenOfType("colon"),Fe.rules.token("identifier","fresh"))),function(s){return s.map(function(){return!0}).valueOrElse(!1)}),n=Fe.rules.then(Fe.rules.optional(Fe.rules.sequence(Fe.rules.tokenOfType("colon"),Fe.rules.token("identifier","separator"),Fe.rules.tokenOfType("open-paren"),e(Xu),Fe.rules.tokenOfType("close-paren")).head()),function(s){return s.valueOrElse("")}),a=Fe.rules.oneOrMoreWithSeparator(x1,Fe.rules.tokenOfType("choice")),i=Fe.rules.sequence(e(a),e(Fe.rules.zeroOrMore(I9e)),e(r),e(n)).map(function(s,l,c,u){var d={},f={};return l.forEach(function(h){h.append&&d[h.name]?d[h.name]+=" "+h.value:d[h.name]=h.value}),c&&(f.fresh=!0),u&&(f.separator=u),P0.element(s,d,f)});return Fe.rules.firstOf("html path",Fe.rules.then(Fe.rules.tokenOfType("bang"),function(){return P0.ignore}),Fe.rules.then(Fe.rules.zeroOrMoreWithSeparator(i,Fe.rules.sequence(t,Fe.rules.tokenOfType("gt"),t)),P0.elements))}var x1=Fe.rules.then(Fe.rules.tokenOfType("identifier"),uH),A9e=Fe.rules.tokenOfType("integer"),Xu=Fe.rules.then(Fe.rules.tokenOfType("string"),uH),O9e={n:`
`,r:"\r",t:"	"};function uH(e){return e.replace(/\\(.)/g,function(t,r){return O9e[r]||r})}var F9e=Fe.rules.sequence(Fe.rules.tokenOfType("open-square-bracket"),Fe.rules.sequence.cut(),Fe.rules.sequence.capture(x1),Fe.rules.tokenOfType("equals"),Fe.rules.sequence.capture(Xu),Fe.rules.tokenOfType("close-square-bracket")).map(function(e,t){return{name:e,value:t,append:!1}}),P9e=Fe.rules.sequence(Fe.rules.tokenOfType("dot"),Fe.rules.sequence.cut(),Fe.rules.sequence.capture(x1)).map(function(e){return{name:"class",value:e,append:!0}}),I9e=Fe.rules.firstOf("attribute or class",F9e,P9e);function QT(e,t){var r=S9e(t),n=Fe.Parser(),a=n.parseTokens(e,r);return a.isSuccess()?Q2.success(a.value()):new Q2.Result(null,[Q2.warning(R9e(t,a))])}function R9e(e,t){return"Did not understand this style mapping, so ignored it: "+e+`
`+t.errors().map(M9e).join(`
`)}function M9e(e){return"Error was at character number "+e.characterNumber()+": Expected "+e.expected+" but got "+e.actual}var U9e=T9e(),g1={};g1.readOptions=B9e;var dH=Xr,$9e=g1._defaultStyleMap=["p.Heading1 => h1:fresh","p.Heading2 => h2:fresh","p.Heading3 => h3:fresh","p.Heading4 => h4:fresh","p.Heading5 => h5:fresh","p.Heading6 => h6:fresh","p[style-name='Heading 1'] => h1:fresh","p[style-name='Heading 2'] => h2:fresh","p[style-name='Heading 3'] => h3:fresh","p[style-name='Heading 4'] => h4:fresh","p[style-name='Heading 5'] => h5:fresh","p[style-name='Heading 6'] => h6:fresh","p[style-name='heading 1'] => h1:fresh","p[style-name='heading 2'] => h2:fresh","p[style-name='heading 3'] => h3:fresh","p[style-name='heading 4'] => h4:fresh","p[style-name='heading 5'] => h5:fresh","p[style-name='heading 6'] => h6:fresh","p.Heading => h1:fresh","p[style-name='Heading'] => h1:fresh","r[style-name='Strong'] => strong","p[style-name='footnote text'] => p:fresh","r[style-name='footnote reference'] =>","p[style-name='endnote text'] => p:fresh","r[style-name='endnote reference'] =>","p[style-name='annotation text'] => p:fresh","r[style-name='annotation reference'] =>","p[style-name='Footnote'] => p:fresh","r[style-name='Footnote anchor'] =>","p[style-name='Endnote'] => p:fresh","r[style-name='Endnote anchor'] =>","p:unordered-list(1) => ul > li:fresh","p:unordered-list(2) => ul|ol > li > ul > li:fresh","p:unordered-list(3) => ul|ol > li > ul|ol > li > ul > li:fresh","p:unordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh","p:unordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh","p:ordered-list(1) => ol > li:fresh","p:ordered-list(2) => ul|ol > li > ol > li:fresh","p:ordered-list(3) => ul|ol > li > ul|ol > li > ol > li:fresh","p:ordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh","p:ordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh","r[style-name='Hyperlink'] =>","p[style-name='Normal'] => p:fresh","p.Body => p:fresh","p[style-name='Body'] => p:fresh"],L9e=g1._standardOptions={externalFileAccess:!1,transformDocument:W9e,includeDefaultStyleMap:!0,includeEmbeddedStyleMap:!0};function B9e(e){return e=e||{},dH.extend({},L9e,e,{customStyleMap:S6(e.styleMap),readStyleMap:function(){var t=this.customStyleMap;return this.includeEmbeddedStyleMap&&(t=t.concat(S6(this.embeddedStyleMap))),this.includeDefaultStyleMap&&(t=t.concat($9e)),t}})}function S6(e){return e?dH.isString(e)?e.split(`
`).map(function(t){return t.trim()}).filter(function(t){return t!==""&&t.charAt(0)!=="#"}):e:[]}function W9e(e){return e}var fH={},E6=Tn,z9e=mx;fH.openZip=H9e;function H9e(e){return e.arrayBuffer?E6.resolve(z9e.openArrayBuffer(e.arrayBuffer)):E6.reject(new Error("Could not find file in options"))}var hH={},V9e=f1(),q9e=d1();hH.element=G9e;function G9e(e){return function(t){return q9e.elementWithTag(V9e.element(e),[t])}}var Y9e=Xr,mH=wT,ek=GT,X9e=YT.DocumentConverter,K9e=Xz.convertElementToRawText,Z9e=h1.readStyle,J9e=g1.readOptions,v1=fH,Q9e=fi.Result;_s.convertToHtml=e7e;_s.convertToMarkdown=t7e;_s.convert=tk;_s.extractRawText=i7e;_s.images=XT;_s.transforms=Kl;_s.underline=hH;_s.embedStyleMap=s7e;_s.readEmbeddedStyleMap=r7e;function e7e(e,t){return tk(e,t)}function t7e(e,t){var r=Object.create(t||{});return r.outputFormat="markdown",tk(e,r)}function tk(e,t){return t=J9e(t),v1.openZip(e).tap(function(r){return ek.readStyleMap(r).then(function(n){t.embeddedStyleMap=n})}).then(function(r){return mH.read(r,e,t).then(function(n){return n.map(t.transformDocument)}).then(function(n){return n7e(n,t)})})}function r7e(e){return v1.openZip(e).then(ek.readStyleMap)}function n7e(e,t){var r=a7e(t.readStyleMap()),n=Y9e.extend({},t,{styleMap:r.value}),a=new X9e(n);return e.flatMapThen(function(i){return r.flatMapThen(function(s){return a.convertToHtml(i)})})}function a7e(e){return Q9e.combine((e||[]).map(Z9e)).map(function(t){return t.filter(function(r){return!!r})})}function i7e(e){return v1.openZip(e).then(mH.read).then(function(t){return t.map(K9e)})}function s7e(e,t){return v1.openZip(e).tap(function(r){return ek.writeStyleMap(r,t)}).then(function(r){return r.toArrayBuffer()}).then(function(r){return{toArrayBuffer:function(){return r},toBuffer:function(){return Buffer.from(r)}}})}_s.styleMapping=function(){throw new Error(`Use a raw string instead of mammoth.styleMapping e.g. "p[style-name='Title'] => h1" instead of mammoth.styleMapping("p[style-name='Title'] => h1")`)};const o7e=({fileUrl:e,fileName:t})=>{const[r,n]=M.useState(""),[a,i]=M.useState(!0),[s,l]=M.useState(null);return M.useEffect(()=>{e&&(async()=>{try{i(!0),l(null);const u=await fetch(e);if(!u.ok)throw new Error("Failed to load file");const d=await u.arrayBuffer(),f=await _s.convertToHtml({arrayBuffer:d},{styleMap:["p[style-name='Heading 1'] => h1:fresh","p[style-name='Heading 2'] => h2:fresh","p[style-name='Heading 3'] => h3:fresh","p[style-name='Title'] => h1.title:fresh","r[style-name='Strong'] => strong","r[style-name='Emphasis'] => em"]});f.messages&&f.messages.length>0&&console.warn("Mammoth conversion warnings:",f.messages),n(f.value||"<p>Document is empty</p>"),i(!1)}catch(u){console.error("Word preview error:",u),l(u.message),i(!1)}})()},[e]),a?o.jsx("div",{className:"flex items-center justify-center h-full min-h-[400px]",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2"}),o.jsx("p",{className:"text-text-secondary",children:"Loading Word document..."})]})}):s?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full min-h-[400px] text-center",children:[o.jsx(Y,{name:"AlertCircle",size:48,className:"text-error mb-4"}),o.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-2",children:"Failed to load Word document"}),o.jsx("p",{className:"text-text-secondary",children:s})]}):o.jsx("div",{className:"h-full",children:o.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-8 max-h-[600px] overflow-auto",children:[o.jsx("style",{children:`
          .word-preview-content {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
          }
          .word-preview-content h1 {
            font-size: 2em;
            font-weight: bold;
            margin: 1em 0 0.5em 0;
            color: var(--text-primary);
          }
          .word-preview-content h2 {
            font-size: 1.5em;
            font-weight: bold;
            margin: 0.83em 0 0.5em 0;
            color: var(--text-primary);
          }
          .word-preview-content h3 {
            font-size: 1.17em;
            font-weight: bold;
            margin: 1em 0 0.5em 0;
            color: var(--text-primary);
          }
          .word-preview-content p {
            margin: 0.5em 0;
          }
          .word-preview-content ul, .word-preview-content ol {
            margin: 0.5em 0;
            padding-left: 2em;
          }
          .word-preview-content li {
            margin: 0.25em 0;
          }
          .word-preview-content table {
            border-collapse: collapse;
            margin: 1em 0;
            width: 100%;
          }
          .word-preview-content table td, .word-preview-content table th {
            border: 1px solid var(--border);
            padding: 0.5em;
          }
          .word-preview-content table th {
            background-color: var(--background);
            font-weight: bold;
          }
          .word-preview-content strong {
            font-weight: bold;
          }
          .word-preview-content em {
            font-style: italic;
          }
          .word-preview-content a {
            color: var(--primary);
            text-decoration: underline;
          }
          .word-preview-content img {
            max-width: 100%;
            height: auto;
            margin: 1em 0;
          }
        `}),o.jsx("div",{className:"word-preview-content",dangerouslySetInnerHTML:{__html:r}})]})})},e_="https://hibiz-tr-rocket-dev-05c28b6796db.herokuapp.com/",l7e=({documents:e=[],loading:t=!1,dealId:r,onUploadDocument:n,onDeleteDocument:a,readOnly:i=!1})=>{const[s,l]=M.useState(!1),[c,u]=M.useState(!1),[d,f]=M.useState(!1),[h,m]=M.useState(null),[x,p]=M.useState(null),g=M.useRef(null),v=[{value:"proposal",label:"Proposal",icon:"FileText",color:"text-blue-600"},{value:"contract",label:"Contract",icon:"FileCheck",color:"text-green-600"},{value:"presentation",label:"Presentation",icon:"Presentation",color:"text-purple-600"},{value:"other",label:"Other",icon:"File",color:"text-gray-600"}],y=I=>(Sr==null||Sr.getFileExtension(I),Sr==null?void 0:Sr.getFileIcon(I)),b=I=>{var R;!I||(I==null?void 0:I.length)===0||(R=Array.from(I))==null||R.forEach(C=>{w(C)})},w=async(I,R="other")=>{if(!r||!I)return;const C=10*1024*1024;if((I==null?void 0:I.size)>C){alert("File size must be less than 10MB");return}l(!0);try{await(n==null?void 0:n(I,R))}catch(k){alert("Failed to upload document: "+((k==null?void 0:k.message)||"Unknown error"))}finally{l(!1)}},_=async I=>{if(window.confirm(`Are you sure you want to delete "${I==null?void 0:I.name}"?`))try{const R=localStorage.getItem("access_token"),C=await fetch(`${e_}/api/v1/deals/documents/${I==null?void 0:I.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${R}`,"Content-Type":"application/json"}});if(!C.ok){const k=await C.json();throw new Error(k.detail||"Delete failed")}await(a==null?void 0:a(I==null?void 0:I.id))}catch(R){alert("Failed to delete document: "+((R==null?void 0:R.message)||"Unknown error"))}},D=async I=>{var R,C;try{const k=localStorage.getItem("access_token"),z=await fetch(`${e_}/api/v1/deals/documents/${I==null?void 0:I.id}/download`,{headers:{Authorization:`Bearer ${k}`}});if(!z.ok)throw new Error("Download failed");const q=await z.blob(),K=window.URL.createObjectURL(q),se=document.createElement("a");se.href=K,se.download=(I==null?void 0:I.name)||"download",(R=document.body)==null||R.appendChild(se),se==null||se.click(),(C=document.body)==null||C.removeChild(se),window.URL.revokeObjectURL(K)}catch(k){alert("Failed to download document: "+((k==null?void 0:k.message)||"Unknown error"))}},j=async I=>{try{m(I);const R=localStorage.getItem("access_token"),C=await fetch(`${e_}/api/v1/deals/documents/${I==null?void 0:I.id}/download`,{headers:{Authorization:`Bearer ${R}`}});if(!C.ok)throw new Error("Preview failed");const k=await C.blob(),z=window.URL.createObjectURL(k);p(z),f(!0)}catch(R){alert("Failed to preview document: "+((R==null?void 0:R.message)||"Unknown error"))}},N=()=>{f(!1),x&&(window.URL.revokeObjectURL(x),p(null)),m(null)},S=I=>{const R=I.split(".").pop().toLowerCase();return["jpg","jpeg","png","gif","svg","webp"].includes(R)},E=I=>I.split(".").pop().toLowerCase()==="pdf",A=I=>{const R=I.split(".").pop().toLowerCase();return["txt","log","md","json","xml","yml","yaml"].includes(R)},T=I=>I.split(".").pop().toLowerCase()==="csv",L=I=>{const R=I.split(".").pop().toLowerCase();return["xlsx","xls"].includes(R)},O=I=>{const R=I.split(".").pop().toLowerCase();return["docx","doc"].includes(R)},V=I=>{var C;I==null||I.preventDefault(),u(!1);const R=(C=I==null?void 0:I.dataTransfer)==null?void 0:C.files;b(R)},W=I=>{I==null||I.preventDefault(),u(!0)},B=I=>{I==null||I.preventDefault(),u(!1)},P=I=>{var C;if(!I)return"Unknown date";const R=new Date(I);return R==null?void 0:R.toLocaleDateString("en-US",{month:"short",day:"numeric",year:(R==null?void 0:R.getFullYear())!==((C=new Date)==null?void 0:C.getFullYear())?"numeric":void 0})},F=I=>{if(!I)return"Unknown size";const R=parseInt(I);if(isNaN(R))return I;if(R===0)return"0 Bytes";const C=1024,k=["Bytes","KB","MB","GB"],z=Math.floor(Math.log(R)/Math.log(C));return parseFloat((R/Math.pow(C,z)).toFixed(2))+" "+k[z]};return o.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[o.jsx("div",{className:"p-6 border-b border-border",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Documents"}),r&&!i&&o.jsxs("button",{onClick:()=>{var I;return(I=g==null?void 0:g.current)==null?void 0:I.click()},disabled:s,className:"flex items-center space-x-2 px-3 py-1 bg-primary text-white rounded-lg hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150 text-sm",children:[o.jsx(Y,{name:"Upload",size:16}),o.jsx("span",{children:"Upload"})]})]})}),r?o.jsxs(o.Fragment,{children:[!i&&o.jsxs("div",{className:"p-6 border-b border-border",children:[o.jsxs("div",{onDrop:V,onDragOver:W,onDragLeave:B,onClick:()=>{var I;return(I=g==null?void 0:g.current)==null?void 0:I.click()},className:`border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors duration-150 ${c?"border-primary bg-primary-50":"border-border hover:border-border-hover hover:bg-background"}`,children:[o.jsx(Y,{name:"Upload",size:24,className:`mx-auto mb-2 ${c?"text-primary":"text-text-tertiary"}`}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Drop files here or click to browse"}),o.jsx("p",{className:"text-xs text-text-tertiary mt-1",children:"Maximum file size: 10MB"})]}),o.jsx("input",{ref:g,type:"file",multiple:!0,onChange:I=>{var R;return b((R=I==null?void 0:I.target)==null?void 0:R.files)},className:"hidden",accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.jpg,.jpeg,.png,.gif,.txt,.csv,.log,.md,.json,.xml,.yml,.yaml,.zip,.rar"})]}),o.jsxs("div",{className:"p-6",children:[s&&o.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-blue-50 border border-blue-200 rounded-lg mb-4",children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),o.jsx("span",{className:"text-sm text-blue-800",children:"Uploading document..."})]}),t?o.jsxs("div",{className:"flex items-center justify-center py-8",children:[o.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"}),o.jsx("span",{className:"ml-2 text-text-secondary",children:"Loading documents..."})]}):(e==null?void 0:e.length)===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Y,{name:"FileText",size:32,className:"text-text-tertiary mx-auto mb-2"}),o.jsx("p",{className:"text-text-secondary",children:"No documents uploaded"}),o.jsx("p",{className:"text-sm text-text-tertiary mt-1",children:"Upload your first document to get started"})]}):o.jsx("div",{className:"space-y-3",children:e==null?void 0:e.map(I=>{var C;const R=y(I==null?void 0:I.name);return o.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-background rounded-lg border border-border hover:border-border-hover transition-colors duration-150",children:[o.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:o.jsx(Y,{name:R,size:20,className:"text-blue-600"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary truncate",children:I==null?void 0:I.name}),(I==null?void 0:I.documentType)&&(I==null?void 0:I.documentType)!=="other"&&o.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-800 text-xs rounded-full",children:((C=v==null?void 0:v.find(k=>(k==null?void 0:k.value)===(I==null?void 0:I.documentType)))==null?void 0:C.label)||(I==null?void 0:I.documentType)})]}),o.jsxs("div",{className:"flex items-center space-x-2 text-xs text-text-tertiary",children:[o.jsx("span",{children:F(I==null?void 0:I.file_size)}),o.jsx("span",{children:""}),o.jsx("span",{children:P(I==null?void 0:I.created_at)})]})]}),o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("button",{onClick:()=>j(I),className:"p-2 text-text-tertiary hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-150",title:"Preview",children:o.jsx(Y,{name:"Eye",size:16})}),o.jsx("button",{onClick:()=>D(I),className:"p-2 text-text-tertiary hover:text-primary hover:bg-primary-50 rounded-lg transition-colors duration-150",title:"Download",children:o.jsx(Y,{name:"Download",size:16})}),!i&&o.jsx("button",{onClick:()=>_(I),className:"p-2 text-text-tertiary hover:text-error hover:bg-error-50 rounded-lg transition-colors duration-150",title:"Delete",children:o.jsx(Y,{name:"Trash2",size:16})})]})]},I==null?void 0:I.id)})})]})]}):o.jsx("div",{className:"p-6",children:o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Y,{name:"FileText",size:32,className:"text-text-tertiary mx-auto mb-2"}),o.jsx("p",{className:"text-text-secondary",children:"Save the deal first to upload documents"}),o.jsx("p",{className:"text-sm text-text-tertiary mt-1",children:"Documents can be added after creating the deal"})]})}),d&&h&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[9999] p-4",children:o.jsxs("div",{className:"bg-white dark:bg-surface rounded-lg shadow-xl w-full max-w-6xl max-h-[90vh] flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border flex-shrink-0",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Y,{name:y(h==null?void 0:h.name),size:24,className:"text-primary"}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:h==null?void 0:h.name}),o.jsxs("p",{className:"text-sm text-text-secondary",children:[F(h==null?void 0:h.file_size),"  ",P(h==null?void 0:h.created_at)]})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:()=>D(h),className:"p-2 text-text-secondary hover:text-primary hover:bg-primary-50 rounded-lg transition-colors duration-150",title:"Download",children:o.jsx(Y,{name:"Download",size:20})}),o.jsx("button",{onClick:N,className:"p-2 text-text-secondary hover:text-text-primary hover:bg-surface-hover rounded-lg transition-colors duration-150",title:"Close",children:o.jsx(Y,{name:"X",size:20})})]})]}),o.jsx("div",{className:"flex-1 overflow-auto p-4 bg-gray-50 dark:bg-gray-900",children:S(h==null?void 0:h.name)?o.jsx("div",{className:"flex items-center justify-center h-full",children:o.jsx("img",{src:x,alt:h==null?void 0:h.name,className:"max-w-full max-h-full object-contain rounded-lg shadow-lg"})}):E(h==null?void 0:h.name)?o.jsx("iframe",{src:x,className:"w-full h-full min-h-[600px] rounded-lg shadow-lg",title:h==null?void 0:h.name}):A(h==null?void 0:h.name)?o.jsx(QCe,{fileUrl:x,fileName:h==null?void 0:h.name}):T(h==null?void 0:h.name)?o.jsx(tAe,{fileUrl:x,fileName:h==null?void 0:h.name}):L(h==null?void 0:h.name)?o.jsx(nUe,{fileUrl:x,fileName:h==null?void 0:h.name}):O(h==null?void 0:h.name)?o.jsx(o7e,{fileUrl:x,fileName:h==null?void 0:h.name}):o.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[o.jsx(Y,{name:"FileText",size:64,className:"text-text-tertiary mb-4"}),o.jsx("h4",{className:"text-xl font-semibold text-text-primary mb-2",children:"Preview not available"}),o.jsx("p",{className:"text-text-secondary mb-4",children:"Preview is not available for this file type."}),o.jsxs("button",{onClick:()=>D(h),className:"btn-primary flex items-center space-x-2",children:[o.jsx(Y,{name:"Download",size:16}),o.jsx("span",{children:"Download File"})]})]})})]})})]})},c7e=({deals:e,stages:t,onViewDeal:r,onEditDeal:n,onCloneDeal:a,onDeleteDeal:i})=>{const{hasAnyPermission:s}=Vt();M.useEffect(()=>{Gr.loadConfiguration()},[]);const l=c=>Gr.formatCurrency(c);return e.length===0?o.jsxs("div",{className:"text-center py-8 xs:py-12",children:[o.jsx(Y,{name:"Package",size:40,className:"xs:w-12 xs:h-12 text-text-tertiary mx-auto mb-4"}),o.jsx("h3",{className:"text-base xs:text-lg font-medium text-text-primary mb-2",children:"No deals found"}),o.jsx("p",{className:"text-text-secondary text-sm xs:text-base",children:"Try adjusting your filters or create a new deal"})]}):o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 xs:gap-4 sm:gap-6",children:e.map(c=>{const u=t.find(d=>d.value===c.stage);return o.jsxs("div",{className:"bg-surface rounded-lg border border-border p-3 xs:p-4 sm:p-6 hover:shadow-md transition-shadow duration-200 cursor-pointer",onClick:()=>r(c),children:[o.jsxs("div",{className:"mb-3 xs:mb-4",children:[o.jsx("h3",{className:"text-base xs:text-lg font-semibold text-text-primary mb-1 xs:mb-2 line-clamp-2",children:c.name||"Untitled Deal"}),o.jsx("p",{className:"text-xs xs:text-sm text-text-secondary line-clamp-2 min-h-[2rem] xs:min-h-[2.5rem]",children:c.description||"No description"})]}),o.jsxs("div",{className:"mb-3 xs:mb-4",children:[o.jsx("div",{className:"text-xl xs:text-2xl font-bold text-text-primary",children:l(c.value||0)}),o.jsxs("div",{className:"text-xs xs:text-sm text-text-secondary",children:[c.probability||0,"% probability"]})]}),o.jsx("div",{className:"mb-3 xs:mb-4",children:o.jsx("span",{className:`px-2 xs:px-3 py-1 text-xs font-medium rounded-full ${(u==null?void 0:u.color)||"bg-gray-100 text-gray-800"}`,children:(u==null?void 0:u.label)||c.stage})}),o.jsxs("div",{className:"space-y-1.5 xs:space-y-2 text-xs text-text-secondary",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{children:"Created:"}),o.jsx("span",{children:new Date(c.created_at).toLocaleDateString()})]}),c.updated_at&&o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{children:"Updated:"}),o.jsx("span",{children:new Date(c.updated_at).toLocaleDateString()})]}),c.contact_name&&o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{children:"Contact:"}),o.jsx("span",{className:"truncate ml-2",children:c.contact_name})]}),c.company_name&&o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{children:"Company:"}),o.jsx("span",{className:"truncate ml-2",children:c.company_name})]})]}),o.jsx("div",{className:"mt-3 xs:mt-4 pt-3 xs:pt-4 border-t border-border",children:o.jsxs("div",{className:"flex items-center justify-center space-x-1.5 xs:space-x-2",children:[s(["deals.edit_all","deals.edit_own"])&&o.jsxs("button",{onClick:d=>{d.stopPropagation(),n(c)},className:"flex items-center space-x-1 px-2 xs:px-3 py-1.5 xs:py-2 min-h-touch text-primary hover:bg-primary-50 rounded-lg transition-colors duration-150",title:"Edit deal",children:[o.jsx(Y,{name:"Edit",size:14,className:"xs:w-4 xs:h-4"}),o.jsx("span",{className:"text-xs xs:text-sm font-medium",children:"Edit"})]}),o.jsxs("button",{onClick:d=>{d.stopPropagation(),a(c)},className:"flex items-center space-x-1 px-2 xs:px-3 py-1.5 xs:py-2 min-h-touch text-text-secondary hover:bg-surface-hover rounded-lg transition-colors duration-150",title:"Clone deal",children:[o.jsx(Y,{name:"Copy",size:14,className:"xs:w-4 xs:h-4"}),o.jsx("span",{className:"text-xs xs:text-sm font-medium",children:"Clone"})]}),s(["deals.delete_all","deals.delete_own"])&&o.jsxs("button",{onClick:d=>{d.stopPropagation(),i(c)},className:"flex items-center space-x-1 px-2 xs:px-3 py-1.5 xs:py-2 min-h-touch text-error hover:bg-error-50 rounded-lg transition-colors duration-150",title:"Delete deal",children:[o.jsx(Y,{name:"Trash2",size:14,className:"xs:w-4 xs:h-4"}),o.jsx("span",{className:"text-xs xs:text-sm font-medium hidden xs:inline",children:"Delete"})]})]})})]},c.id)})})},pH=({deals:e,onClose:t,filters:r})=>{const[n,a]=M.useState("csv"),[i,s]=M.useState(!1),l=async()=>{s(!0);try{const h=await gt.exportDeals(r||{}),m=c(h);n==="csv"?u(m):n==="json"&&d(m),setTimeout(()=>{s(!1),t()},500)}catch(h){console.error("Export failed:",h),s(!1),alert("Export failed. Please try again.")}},c=h=>h.map(m=>{var p;const x=g=>{if(!g)return"";const v=g.first_name||"",y=g.last_name||"";return`${v} ${y}`.trim()};return{name:m.name||"",stage:m.stage||"",value:m.value||0,probability:m.probability||0,expected_close_date:m.expected_close_date||"",company:((p=m.company)==null?void 0:p.name)||"",contact:x(m.contact),owner:x(m.owner),description:m.description||"",source:m.source||"",next_action:m.next_action||"",created_at:m.created_at||"",updated_at:m.updated_at||"",...m.custom_fields||{}}}),u=h=>{const p=[["Name","Stage","Value","Probability (%)","Expected Close Date","Company","Contact","Owner","Description","Source","Next Action","Created At","Updated At"].join(","),...h.map(b=>[f(b.name),f(b.stage),b.value,b.probability,f(b.expected_close_date),f(b.company),f(b.contact),f(b.owner),f(b.description),f(b.source),f(b.next_action),f(b.created_at),f(b.updated_at)].join(","))].join(`
`),g=new Blob([p],{type:"text/csv;charset=utf-8;"}),v=document.createElement("a"),y=URL.createObjectURL(g);v.setAttribute("href",y),v.setAttribute("download",`deals_export_${new Date().toISOString().split("T")[0]}.csv`),v.style.visibility="hidden",document.body.appendChild(v),v.click(),document.body.removeChild(v)},d=h=>{const m=JSON.stringify(h,null,2),x=new Blob([m],{type:"application/json;charset=utf-8;"}),p=document.createElement("a"),g=URL.createObjectURL(x);p.setAttribute("href",g),p.setAttribute("download",`deals_export_${new Date().toISOString().split("T")[0]}.json`),p.style.visibility="hidden",document.body.appendChild(p),p.click(),document.body.removeChild(p)},f=h=>{if(h==null)return"";const m=String(h);return m.includes(",")||m.includes('"')||m.includes(`
`)?`"${m.replace(/"/g,'""')}"`:m};return o.jsx("div",{className:"fixed inset-0 z-1100 overflow-y-auto",children:o.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[o.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:o.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50"})}),o.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:""}),o.jsxs("div",{className:"inline-block align-bottom bg-surface rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[o.jsxs("div",{className:"px-6 py-4 border-b border-border flex justify-between items-center",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Export Deals"}),o.jsx("button",{onClick:t,className:"text-text-secondary hover:text-text-primary transition-colors duration-150",children:o.jsx(Y,{name:"X",size:20})})]}),o.jsx("div",{className:"px-6 py-5",children:o.jsxs("div",{className:"mb-6",children:[o.jsxs("p",{className:"text-text-secondary mb-4",children:["Exporting ",e==null?void 0:e.length," ",(e==null?void 0:e.length)===1?"deal":"deals",r&&Object.keys(r).length>0&&" with applied filters"]}),o.jsxs("div",{className:"mb-6",children:[o.jsx("div",{className:"block text-sm font-medium text-text-primary mb-2",children:"Export Format"}),o.jsxs("div",{className:"flex space-x-4",children:[o.jsxs("label",{className:"inline-flex items-center",children:[o.jsx("input",{type:"radio",value:"csv",checked:n==="csv",onChange:()=>a("csv"),className:"h-4 w-4 text-primary border-border focus:ring-primary"}),o.jsx("span",{className:"ml-2 text-text-secondary",children:"CSV"})]}),o.jsxs("label",{className:"inline-flex items-center",children:[o.jsx("input",{type:"radio",value:"json",checked:n==="json",onChange:()=>a("json"),className:"h-4 w-4 text-primary border-border focus:ring-primary"}),o.jsx("span",{className:"ml-2 text-text-secondary",children:"JSON"})]})]})]}),o.jsxs("div",{className:"bg-surface-hover border border-border rounded-lg p-4",children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary mb-2",children:"Export includes:"}),o.jsxs("ul",{className:"text-sm text-text-secondary space-y-1",children:[o.jsxs("li",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:"Check",size:14,className:"text-success"}),o.jsx("span",{children:"Deal information (name, stage, value, probability)"})]}),o.jsxs("li",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:"Check",size:14,className:"text-success"}),o.jsx("span",{children:"Associated company and contact details"})]}),o.jsxs("li",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:"Check",size:14,className:"text-success"}),o.jsx("span",{children:"Owner and timeline information"})]}),o.jsxs("li",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:"Check",size:14,className:"text-success"}),o.jsx("span",{children:"Descriptions and next actions"})]})]})]})]})}),o.jsxs("div",{className:"px-6 py-4 bg-surface-hover border-t border-border flex justify-end space-x-3",children:[o.jsx("button",{onClick:t,disabled:i,className:"px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-out disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),o.jsx("button",{onClick:l,disabled:i,className:"btn-primary inline-flex items-center disabled:opacity-50 disabled:cursor-not-allowed",children:i?o.jsxs(o.Fragment,{children:[o.jsx(Y,{name:"Loader",size:16,className:"animate-spin mr-2"}),"Exporting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Y,{name:"Download",size:16,className:"mr-2"}),"Export ",n.toUpperCase()]})})]})]})]})})};pH.propTypes={deals:ke.array.isRequired,onClose:ke.func.isRequired,filters:ke.object};const lo={async getDealActivities(e){try{const{data:t,error:r}=await be.get(`/api/v1/deals/${e}/activities`);if(r)throw r;return t||[]}catch(t){throw console.error("Error fetching deal activities:",t),t}},async createDealActivity(e,t){try{const r={type:t.type,subject:t.subject,description:t.description||null,duration_minutes:t.duration_minutes||null,outcome:t.outcome||null,contact_id:t.contact_id||null,deal_id:e,custom_fields:t.custom_fields||void 0},{data:n,error:a}=await be.post("/api/v1/activities",r);if(a)throw a;return n}catch(r){throw console.error("Error creating deal activity:",r),r}},async deleteDealActivity(e){try{const{data:t,error:r}=await be.delete(`/api/v1/activities/${e}`);if(r)throw r;return!0}catch(t){throw console.error("Error deleting deal activity:",t),t}},subscribeToDealActivities(e,t){return{unsubscribe:()=>{}}},async createActivity(e){return this.createDealActivity(e.dealId,e)},async deleteActivity(e){return this.deleteDealActivity(e)},subscribeToActivityChanges(e,t){return this.subscribeToDealActivities(e,t)},unsubscribeFromActivityChanges(e){e&&e.unsubscribe&&e.unsubscribe()}},t_=()=>{var tc,Cx,Ax;const{dealId:e}=Kj(),t=Il(),{user:r,hasPermission:n,hasAnyPermission:a}=Vt(),[i,s]=M.useState(null),[l,c]=M.useState([]),[u,d]=M.useState([]),[f,h]=M.useState([]),[m,x]=M.useState([]),[p,g]=M.useState([]),[v,y]=M.useState(!1),[b,w]=M.useState(!0),[_,D]=M.useState(!1),[j,N]=M.useState(!1),[S,E]=M.useState(!0),[A,T]=M.useState(!1),[L,O]=M.useState(!1),[V,W]=M.useState(!1),[B,P]=M.useState(null),[F,I]=M.useState(!1),[R,C]=M.useState(!1),[k,z]=M.useState("all"),[q,K]=M.useState(""),[se,ie]=M.useState("created_at"),[ee,ae]=M.useState("desc");M.useEffect(()=>{Gr.loadConfiguration()},[]);const pe=Ae=>Gr.formatCurrency(Ae),[H,ne]=M.useState(1),[U,le]=M.useState(10),[re,X]=M.useState(null),[G,ce]=M.useState(null),J=[{value:"lead",label:"Lead",color:"bg-gray-100 text-gray-800"},{value:"qualified",label:"Qualified",color:"bg-blue-100 text-blue-800"},{value:"proposal",label:"Proposal",color:"bg-yellow-100 text-yellow-800"},{value:"negotiation",label:"Negotiation",color:"bg-orange-100 text-orange-800"},{value:"closed_won",label:"Closed Won",color:"bg-green-100 text-green-800"},{value:"closed_lost",label:"Closed Lost",color:"bg-red-100 text-red-800"}],ue=l.filter(Ae=>{const Ye=k==="all"||Ae.stage===k,$e=!q||(Ae.name||"").toLowerCase().includes(q.toLowerCase())||(Ae.description||"").toLowerCase().includes(q.toLowerCase())||(Ae.company_name||"").toLowerCase().includes(q.toLowerCase())||(Ae.contact_name||"").toLowerCase().includes(q.toLowerCase());return Ye&&$e}),me=[...ue].sort((Ae,Ye)=>{let $e,ct;switch(se){case"name":$e=(Ae.name||"").toLowerCase(),ct=(Ye.name||"").toLowerCase();break;case"value":$e=Ae.value||0,ct=Ye.value||0;break;case"probability":$e=Ae.probability||0,ct=Ye.probability||0;break;case"created_at":$e=new Date(Ae.created_at||0).getTime(),ct=new Date(Ye.created_at||0).getTime();break;case"stage":const pr={lead:1,qualified:2,proposal:3,negotiation:4,closed_won:5,closed_lost:6};$e=pr[Ae.stage]||0,ct=pr[Ye.stage]||0;break;default:return 0}return ee==="asc"?$e>ct?1:$e<ct?-1:0:$e<ct?1:$e>ct?-1:0}),te=me.length,oe=Math.ceil(te/U),ge=(H-1)*U,ye=ge+U,Ce=me.slice(ge,ye);M.useEffect(()=>{ne(1)},[k,q]);const Ie=Ae=>{ne(Ae)},rt=Ae=>{le(Ae),ne(1)},Pe=Ae=>{se===Ae?ae(ee==="asc"?"desc":"asc"):(ie(Ae),ae("asc")),ne(1)};M.useEffect(()=>{if(!r)return;(async()=>{E(!0),P(null);try{const[Ye,$e,ct]=await Promise.all([gt==null?void 0:gt.getUserDeals(),Ct==null?void 0:Ct.getUserContacts(),Zt==null?void 0:Zt.getAllCompanies()]);c(Ye||[]),d($e||[]),h(ct||[]),e&&e!=="new"?(w(!1),N(!0),y(!1),await Ke(e)):e==="new"?(w(!1),N(!1),y(!0),s(null)):(w(!0),N(!1),y(!1))}catch(Ye){console.error("Error loading initial data:",Ye),P("Failed to load data. Please refresh the page.")}finally{E(!1)}})()},[e,r]);const Ke=async Ae=>{var Ye,$e,ct,pr,eo;try{const Z=await(gt==null?void 0:gt.getDealById(Ae));if(!Z){P("Deal not found"),E(!1);return}s(Z),await Promise.all([lt(Ae),nt(Ae)]),nr(Ae)}catch(Z){console.error("Error loading deal:",Z),(Z==null?void 0:Z.code)==="PGRST116"||(Ye=Z==null?void 0:Z.message)!=null&&Ye.includes("not found")?P("Deal not found. It may have been deleted or you may not have permission to view it."):($e=Z==null?void 0:Z.message)!=null&&$e.toLowerCase().includes("permission")||(ct=Z==null?void 0:Z.message)!=null&&ct.toLowerCase().includes("policy")?P("Permission denied. You may not have access to view this deal."):((pr=Z==null?void 0:Z.message)!=null&&pr.includes("company")||(eo=Z==null?void 0:Z.message)!=null&&eo.includes("schema cache"))&&P("Could not load deal information. Please check your database connection and try refreshing the page.")}finally{E(!1)}},lt=async Ae=>{O(!0);try{const Ye=await(lo==null?void 0:lo.getDealActivities(Ae));x(Ye||[])}catch(Ye){console.error("Error loading activities:",Ye)}finally{O(!1)}},nt=async Ae=>{W(!0);try{const Ye=await(Sr==null?void 0:Sr.getDealDocuments(Ae));g(Ye||[])}catch(Ye){console.error("Error loading documents:",Ye)}finally{W(!1)}},nr=Ae=>{const Ye=lo==null?void 0:lo.subscribeToActivityChanges(Ae,ct=>{za(ct)});X(Ye);const $e=Sr==null?void 0:Sr.subscribeToDocumentChanges(Ae,ct=>{Bn(ct)});ce($e)},za=M.useCallback(Ae=>{const{eventType:Ye,new:$e,old:ct}=Ae;x(pr=>{switch(Ye){case"INSERT":return[{id:$e==null?void 0:$e.id,type:$e==null?void 0:$e.type,title:$e==null?void 0:$e.subject,description:$e==null?void 0:$e.description,timestamp:$e==null?void 0:$e.created_at,user:"Unknown User",dealId:$e==null?void 0:$e.deal_id},...pr];case"DELETE":return pr==null?void 0:pr.filter(Z=>(Z==null?void 0:Z.id)!==(ct==null?void 0:ct.id));case"UPDATE":return pr==null?void 0:pr.map(Z=>(Z==null?void 0:Z.id)===($e==null?void 0:$e.id)?{...Z,...$e}:Z);default:return pr}})},[]),Bn=M.useCallback(Ae=>{const{eventType:Ye,new:$e,old:ct}=Ae;g(pr=>{switch(Ye){case"INSERT":return[{id:$e==null?void 0:$e.id,name:$e==null?void 0:$e.name,size:Sr==null?void 0:Sr.formatFileSize($e==null?void 0:$e.file_size),type:Sr==null?void 0:Sr.getFileExtension($e==null?void 0:$e.name),uploadedAt:$e==null?void 0:$e.created_at,uploadedBy:"Unknown User",dealId:$e==null?void 0:$e.deal_id,fileUrl:$e==null?void 0:$e.file_url},...pr];case"DELETE":return pr==null?void 0:pr.filter(Z=>(Z==null?void 0:Z.id)!==(ct==null?void 0:ct.id));default:return pr}})},[]);M.useEffect(()=>()=>{re&&(lo==null||lo.unsubscribeFromActivityChanges(re)),G&&(Sr==null||Sr.unsubscribeFromDocumentChanges(G))},[re,G]);const at=()=>{s(null),y(!0),w(!1),t("/deal-management/new")},bt=async Ae=>{N(!0),y(!1),w(!1),t(`/deal-management/${Ae.id}`);try{const Ye=await(gt==null?void 0:gt.getDealById(Ae.id));s(Ye)}catch(Ye){console.error("Error loading full deal data:",Ye),s(Ae)}},Mt=()=>{N(!1),y(!0)},St=()=>{y(!1),N(!1),w(!0),s(null),P(null),t("/deal-management")},Ha=async Ae=>{var Ye,$e,ct,pr,eo;if(!(r!=null&&r.id)){P("You must be logged in to save deals");return}T(!0),P(null);try{let Z;if(i!=null&&i.id)Z=await(gt==null?void 0:gt.updateDeal(i==null?void 0:i.id,{...Ae,owner_id:r==null?void 0:r.id})),Z&&(s(Z),c(he=>he.map(de=>de.id===Z.id?Z:de)),Ue.success(`Deal "${Z.name||"Untitled Deal"}" updated successfully!`));else if(Z=await(gt==null?void 0:gt.createDeal({...Ae,owner_id:r==null?void 0:r.id})),Z!=null&&Z.id)Ue.success(`Deal "${Ae.name||"Untitled Deal"}" created successfully!`),c(he=>[Z,...he]);else throw new Error("Deal created but no ID returned");T(!1),St()}catch(Z){if(console.error("Error saving deal:",Z),(Z==null?void 0:Z.code)==="23503"){const he="The selected company or contact is no longer available. Please refresh the page and select valid options.";P(he),Ue.error(he)}else if((Z==null?void 0:Z.code)==="PGRST116"||(Ye=Z==null?void 0:Z.message)!=null&&Ye.includes("not found")){const he="Deal not found. It may have been deleted by another user.";P(he),Ue.error(he),t("/deal-management");return}else if(($e=Z==null?void 0:Z.message)!=null&&$e.toLowerCase().includes("permission")||(ct=Z==null?void 0:Z.message)!=null&&ct.toLowerCase().includes("policy")){const he="Permission denied. You may not have access to modify this deal.";P(he),Ue.error(he)}else if((pr=Z==null?void 0:Z.message)!=null&&pr.includes("company")||(eo=Z==null?void 0:Z.message)!=null&&eo.includes("schema cache")){const he="There was an issue accessing company information. Please refresh the page and try again.";P(he),Ue.error(he)}else{const he=(Z==null?void 0:Z.message)||"Failed to save deal. Please try again.";P(he),Ue.error(he)}}finally{T(!1)}},kn=async()=>{if(!(!(i!=null&&i.id)||!(r!=null&&r.id))){try{await(gt==null?void 0:gt.deleteDeal(i==null?void 0:i.id)),Ue.success(`Deal "${i.name||"Untitled Deal"}" deleted successfully!`),c(Ae=>Ae.filter(Ye=>Ye.id!==i.id)),t("/deal-management")}catch(Ae){console.error("Error deleting deal:",Ae);const Ye="Failed to delete deal. Please try again.";P(Ye),Ue.error(Ye)}I(!1)}},Cn=async()=>{if(!(!i||!(r!=null&&r.id)))try{const Ae={name:`${i==null?void 0:i.name} (Copy)`,description:i==null?void 0:i.description,value:i==null?void 0:i.value,stage:"lead",probability:10,contact_id:i==null?void 0:i.contact_id,company_id:i==null?void 0:i.company_id,lead_source:i==null?void 0:i.lead_source,owner_id:r==null?void 0:r.id};let Ye=await(gt==null?void 0:gt.createDeal(Ae));Ye!=null&&Ye.id&&(Ue.success(`Deal "${Ae.name}" cloned successfully!`),c($e=>[Ye,...$e]),t(`/deal-management/${Ye==null?void 0:Ye.id}`))}catch(Ae){console.error("Error cloning deal:",Ae);const Ye="Failed to clone deal. Please try again.";P(Ye),Ue.error(Ye)}},Ql=()=>{if(ue.length===0){P("No deals to export"),setTimeout(()=>P(null),3e3);return}C(!0)},Wf=async(Ae,Ye="other")=>{if(i!=null&&i.id)try{const $e=await(Sr==null?void 0:Sr.uploadDocument(Ae,i==null?void 0:i.id,Ye));g(ct=>[$e,...ct])}catch($e){throw console.error("Error uploading document:",$e),P("Failed to upload document. Please try again."),$e}},ec=async Ae=>{try{g(Ye=>Ye==null?void 0:Ye.filter($e=>($e==null?void 0:$e.id)!==Ae))}catch(Ye){console.error("Error deleting document:",Ye),P("Failed to delete document. Please try again.")}};return S?o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(ii,{}),o.jsx("main",{className:"pt-14 xs:pt-16 sm:pt-16",children:o.jsx("div",{className:"px-3 xs:px-4 sm:px-6 py-4 xs:py-6 sm:py-8",children:o.jsx("div",{className:"max-w-7xl mx-auto",children:o.jsx("div",{className:"flex items-center justify-center h-96",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),o.jsx("span",{className:"text-text-secondary text-sm xs:text-base",children:"Loading deal..."})]})})})})})]}):B&&!i&&!b?o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(ii,{}),o.jsx("main",{className:"pt-14 xs:pt-16 sm:pt-16",children:o.jsx("div",{className:"px-3 xs:px-4 sm:px-6 py-4 xs:py-6 sm:py-8",children:o.jsxs("div",{className:"max-w-7xl mx-auto",children:[o.jsx("div",{className:"hidden sm:block",children:o.jsx(Hs,{})}),o.jsxs("div",{className:"text-center py-8 xs:py-12",children:[o.jsx(Y,{name:"AlertCircle",size:40,className:"xs:w-12 xs:h-12 text-text-tertiary mx-auto mb-4"}),o.jsx("h2",{className:"text-lg xs:text-xl font-semibold text-text-primary mb-2",children:i===null&&e!=="new"?"Deal Not Found":"Error"}),o.jsx("p",{className:"text-text-secondary mb-4 xs:mb-6 text-sm xs:text-base px-4",children:B}),o.jsx("button",{onClick:()=>t("/sales-dashboard"),className:"btn-primary min-h-touch",children:"Back to Dashboard"})]})]})})})]}):o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(ii,{}),o.jsx("main",{className:"pt-14 xs:pt-16 sm:pt-16",children:o.jsx("div",{className:"px-3 xs:px-4 sm:px-6 py-4 xs:py-6 sm:py-8",children:o.jsxs("div",{className:"max-w-7xl mx-auto",children:[o.jsx("div",{className:"hidden sm:block",children:o.jsx(Hs,{})}),B&&o.jsxs("div",{className:"bg-error-50 border border-error-200 text-error p-3 xs:p-4 rounded-lg flex items-center justify-between mb-4 xs:mb-6",children:[o.jsxs("div",{className:"flex items-center space-x-2 min-w-0 flex-1",children:[o.jsx(Y,{name:"AlertCircle",size:20,className:"flex-shrink-0"}),o.jsx("span",{className:"text-xs xs:text-sm break-words",children:B})]}),o.jsx("button",{onClick:()=>P(null),className:"text-error hover:text-error-600 min-h-touch min-w-touch flex items-center justify-center -m-1 flex-shrink-0",children:o.jsx(Y,{name:"X",size:16})})]}),o.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-4 xs:mb-6 sm:mb-8",children:[o.jsxs("div",{className:"mb-3 xs:mb-4 lg:mb-0",children:[o.jsx("h1",{className:"text-xl xs:text-2xl sm:text-3xl font-bold text-text-primary mb-1 xs:mb-2",children:b?"Deal Management":(i==null?void 0:i.name)||"New Deal"}),o.jsx("div",{className:"flex flex-wrap items-center gap-x-2 xs:gap-x-4 text-xs xs:text-sm text-text-secondary",children:b?o.jsx("span",{className:"hidden xs:inline",children:"Manage all your deals"}):o.jsxs(o.Fragment,{children:[(i==null?void 0:i.id)&&o.jsxs(o.Fragment,{children:[o.jsxs("span",{className:"hidden sm:inline",children:["Deal ID: #",i==null?void 0:i.id]}),o.jsx("span",{className:"hidden sm:inline",children:""})]}),(i==null?void 0:i.created_at)&&o.jsxs(o.Fragment,{children:[o.jsxs("span",{children:["Created: ",(tc=new Date(i.created_at))==null?void 0:tc.toLocaleDateString()]}),o.jsx("span",{className:"hidden xs:inline",children:""})]}),(i==null?void 0:i.updated_at)&&o.jsxs("span",{className:"hidden xs:inline",children:["Last updated: ",(Cx=new Date(i.updated_at))==null?void 0:Cx.toLocaleDateString()]})]})})]}),o.jsx("div",{className:"flex items-center space-x-2 xs:space-x-3",children:b?o.jsxs(o.Fragment,{children:[n("deals.export")&&o.jsxs("button",{onClick:Ql,disabled:ue.length===0,className:"flex items-center space-x-1.5 xs:space-x-2 px-3 xs:px-4 py-2 min-h-touch border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-out disabled:opacity-50 disabled:cursor-not-allowed text-sm xs:text-base",title:"Export deals",children:[o.jsx(Y,{name:"Download",size:16,className:"flex-shrink-0"}),o.jsx("span",{className:"hidden sm:inline",children:"Export"})]}),n("deals.create")&&o.jsxs("button",{onClick:at,className:"btn-primary flex items-center space-x-1.5 xs:space-x-2 min-h-touch text-sm xs:text-base",children:[o.jsx(Y,{name:"Plus",size:16,className:"flex-shrink-0"}),o.jsx("span",{className:"hidden xs:inline",children:"Create Deal"}),o.jsx("span",{className:"xs:hidden",children:"Create"})]})]}):o.jsxs("button",{onClick:St,className:"btn-secondary flex items-center space-x-1.5 xs:space-x-2 min-h-touch text-sm xs:text-base",children:[o.jsx(Y,{name:"ArrowLeft",size:16,className:"flex-shrink-0"}),o.jsx("span",{className:"hidden xs:inline",children:"Back to List"}),o.jsx("span",{className:"xs:hidden",children:"Back"})]})})]}),b?o.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[o.jsx("div",{className:"p-3 xs:p-4 sm:p-6 border-b border-border",children:o.jsxs("div",{className:"relative",children:[o.jsx(Y,{name:"Search",size:18,className:"absolute left-2.5 xs:left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary flex-shrink-0"}),o.jsx("input",{type:"text",placeholder:"Search deals...",value:q,onChange:Ae=>K(Ae.target.value),className:"w-full pl-8 xs:pl-10 pr-8 xs:pr-10 py-2 xs:py-2.5 sm:py-3 min-h-touch border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary text-text-primary placeholder-text-tertiary text-sm xs:text-base"}),q&&o.jsx("button",{onClick:()=>K(""),className:"absolute right-2 xs:right-3 top-1/2 transform -translate-y-1/2 text-text-tertiary hover:text-text-primary min-h-touch min-w-touch flex items-center justify-center -m-1",children:o.jsx(Y,{name:"X",size:16})})]})}),o.jsxs("div",{className:"p-3 xs:p-4 sm:p-6 border-b border-border",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 xs:gap-4",children:[o.jsx("h2",{className:"text-base xs:text-lg font-semibold text-text-primary",children:"All Deals"}),o.jsxs("div",{className:"flex flex-wrap items-center gap-2 xs:gap-3 sm:gap-4",children:[o.jsxs("div",{className:"flex items-center space-x-1.5 xs:space-x-2",children:[o.jsx("span",{className:"text-xs xs:text-sm text-text-secondary whitespace-nowrap",children:"Show:"}),o.jsxs("select",{value:U,onChange:Ae=>rt(Number(Ae.target.value)),className:"text-xs xs:text-sm border border-border rounded-md px-1.5 xs:px-2 py-1 min-h-touch bg-surface",children:[o.jsx("option",{value:10,children:"10"}),o.jsx("option",{value:25,children:"25"}),o.jsx("option",{value:50,children:"50"}),o.jsx("option",{value:100,children:"100"})]})]}),o.jsxs("div",{className:"flex items-center bg-gray-100 rounded-lg p-0.5 xs:p-1",children:[o.jsxs("button",{onClick:()=>D(!1),className:`flex items-center space-x-1 px-2 xs:px-3 py-1.5 min-h-touch rounded-md text-xs xs:text-sm font-medium transition-colors ${_?"text-text-secondary hover:text-text-primary":"bg-white text-primary shadow-sm"}`,children:[o.jsx(Y,{name:"List",size:16}),o.jsx("span",{className:"hidden sm:inline",children:"List"})]}),o.jsxs("button",{onClick:()=>D(!0),className:`flex items-center space-x-1 px-2 xs:px-3 py-1.5 min-h-touch rounded-md text-xs xs:text-sm font-medium transition-colors ${_?"bg-white text-primary shadow-sm":"text-text-secondary hover:text-text-primary"}`,children:[o.jsx(Y,{name:"Grid",size:16}),o.jsx("span",{className:"hidden sm:inline",children:"Grid"})]})]}),o.jsxs("div",{className:"text-xs xs:text-sm text-text-secondary whitespace-nowrap",children:[ue.length," deal",ue.length!==1?"s":"",(k!=="all"||q)&&` (${l.length} total)`]})]})]}),o.jsx("div",{className:"mt-3 xs:mt-4",children:o.jsxs("div",{className:"flex flex-wrap gap-1.5 xs:gap-2 -mx-3 px-3 xs:mx-0 xs:px-0 overflow-x-auto scrollbar-hide",children:[o.jsxs("button",{onClick:()=>z("all"),className:`px-2.5 xs:px-3 py-1.5 min-h-touch text-xs xs:text-sm font-medium rounded-md transition-colors whitespace-nowrap flex-shrink-0 ${k==="all"?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["All Stages (",l.length,")"]}),J.map(Ae=>{const Ye=l.filter($e=>$e.stage===Ae.value).length;return o.jsxs("button",{onClick:()=>z(Ae.value),className:`px-2.5 xs:px-3 py-1.5 min-h-touch text-xs xs:text-sm font-medium rounded-md transition-colors whitespace-nowrap flex-shrink-0 ${k===Ae.value?"bg-primary text-white":`${Ae.color} hover:opacity-80`}`,children:[Ae.label," (",Ye,")"]},Ae.value)})]})})]}),S?o.jsxs("div",{className:"p-6 xs:p-8 text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),o.jsx("p",{className:"text-text-secondary text-sm xs:text-base",children:"Loading deals..."})]}):ue.length===0?o.jsxs("div",{className:"p-6 xs:p-8 text-center",children:[o.jsx(Y,{name:"Package",size:40,className:"xs:w-12 xs:h-12 text-text-tertiary mx-auto mb-4"}),o.jsx("h3",{className:"text-base xs:text-lg font-medium text-text-primary mb-2",children:k==="all"?"No deals yet":`No deals in ${(Ax=J.find(Ae=>Ae.value===k))==null?void 0:Ax.label} stage`}),o.jsx("p",{className:"text-text-secondary mb-4 text-sm xs:text-base",children:k==="all"?"Create your first deal to get started":"Try selecting a different stage or create a new deal"}),k==="all"&&n("deals.create")&&o.jsx("button",{onClick:at,className:"btn-primary min-h-touch",children:"Create Deal"})]}):_?o.jsxs("div",{className:"p-3 xs:p-4 sm:p-6",children:[o.jsx(c7e,{deals:Ce,stages:J,onViewDeal:bt,onEditDeal:Ae=>{bt(Ae),setTimeout(()=>Mt(),100)},onCloneDeal:Ae=>{s(Ae),Cn()},onDeleteDeal:Ae=>{s(Ae),I(!0)}}),ue.length>0&&o.jsx("div",{className:"mt-4 xs:mt-6 pt-4 xs:pt-6 border-t border-border",children:o.jsx(Im,{currentPage:H,totalPages:oe,totalItems:te,itemsPerPage:U,onPageChange:Ie})})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"hidden md:block overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider cursor-pointer hover:bg-surface-hover transition-colors",onClick:()=>Pe("name"),children:o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("span",{children:"Deal"}),se==="name"&&o.jsx(Y,{name:ee==="asc"?"ArrowUp":"ArrowDown",size:14,className:"text-primary"})]})}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider cursor-pointer hover:bg-surface-hover transition-colors",onClick:()=>Pe("stage"),children:o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("span",{children:"Stage"}),se==="stage"&&o.jsx(Y,{name:ee==="asc"?"ArrowUp":"ArrowDown",size:14,className:"text-primary"})]})}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider cursor-pointer hover:bg-surface-hover transition-colors",onClick:()=>Pe("value"),children:o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("span",{children:"Value"}),se==="value"&&o.jsx(Y,{name:ee==="asc"?"ArrowUp":"ArrowDown",size:14,className:"text-primary"})]})}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider cursor-pointer hover:bg-surface-hover transition-colors",onClick:()=>Pe("probability"),children:o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("span",{children:"Probability"}),se==="probability"&&o.jsx(Y,{name:ee==="asc"?"ArrowUp":"ArrowDown",size:14,className:"text-primary"})]})}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider cursor-pointer hover:bg-surface-hover transition-colors",onClick:()=>Pe("created_at"),children:o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("span",{children:"Created"}),se==="created_at"&&o.jsx(Y,{name:ee==="asc"?"ArrowUp":"ArrowDown",size:14,className:"text-primary"})]})}),o.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-border",children:Ce.map(Ae=>{var Ye,$e;return o.jsxs("tr",{className:"hover:bg-surface-hover transition-colors duration-150 cursor-pointer",onClick:()=>bt(Ae),children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-medium text-text-primary",children:Ae.name||"Untitled Deal"}),o.jsx("div",{className:"text-sm text-text-secondary truncate max-w-xs",children:Ae.description||"No description"})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${((Ye=J.find(ct=>ct.value===Ae.stage))==null?void 0:Ye.color)||"bg-gray-100 text-gray-800"}`,children:(($e=J.find(ct=>ct.value===Ae.stage))==null?void 0:$e.label)||Ae.stage})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-primary",children:pe(Ae.value||0)}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-primary",children:[Ae.probability||0,"%"]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-secondary",children:new Date(Ae.created_at).toLocaleDateString()}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:o.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[a(["deals.edit_all","deals.edit_own"])&&o.jsx("button",{onClick:ct=>{ct.stopPropagation(),bt(Ae),setTimeout(()=>Mt(),100)},className:"p-2 text-primary hover:bg-primary-50 rounded-lg transition-colors duration-150",title:"Edit deal",children:o.jsx(Y,{name:"Edit",size:16})}),o.jsx("button",{onClick:ct=>{ct.stopPropagation(),s(Ae),Cn()},className:"p-2 text-text-secondary hover:bg-surface-hover rounded-lg transition-colors duration-150",title:"Clone deal",children:o.jsx(Y,{name:"Copy",size:16})}),a(["deals.delete_all","deals.delete_own"])&&o.jsx("button",{onClick:ct=>{ct.stopPropagation(),s(Ae),I(!0)},className:"p-2 text-error hover:bg-error-50 rounded-lg transition-colors duration-150",title:"Delete deal",children:o.jsx(Y,{name:"Trash2",size:16})})]})})]},Ae.id)})})]})}),o.jsx("div",{className:"md:hidden p-3 xs:p-4",children:o.jsx("div",{className:"space-y-3",children:Ce.map(Ae=>{var Ye,$e;return o.jsxs("div",{className:"bg-surface rounded-lg border border-border p-3 xs:p-4",onClick:()=>bt(Ae),children:[o.jsx("div",{className:"flex items-start justify-between mb-3",children:o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h3",{className:"text-sm xs:text-base font-medium text-text-primary truncate mb-1",children:Ae.name||"Untitled Deal"}),o.jsx("p",{className:"text-xs xs:text-sm text-text-secondary line-clamp-2 mb-2",children:Ae.description||"No description"}),o.jsx("span",{className:`inline-block px-2 py-1 text-xs font-medium rounded-full ${((Ye=J.find(ct=>ct.value===Ae.stage))==null?void 0:Ye.color)||"bg-gray-100 text-gray-800"}`,children:(($e=J.find(ct=>ct.value===Ae.stage))==null?void 0:$e.label)||Ae.stage})]})}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 xs:gap-3 mb-3 text-xs xs:text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-text-tertiary",children:"Value:"}),o.jsx("span",{className:"ml-1 text-text-primary font-medium",children:pe(Ae.value||0)})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-text-tertiary",children:"Probability:"}),o.jsxs("span",{className:"ml-1 text-text-primary font-medium",children:[Ae.probability||0,"%"]})]}),o.jsxs("div",{className:"col-span-2",children:[o.jsx("span",{className:"text-text-tertiary",children:"Created:"}),o.jsx("span",{className:"ml-1 text-text-primary",children:new Date(Ae.created_at).toLocaleDateString()})]})]}),o.jsxs("div",{className:"flex items-center space-x-2 pt-3 border-t border-border",children:[a(["deals.edit_all","deals.edit_own"])&&o.jsxs("button",{onClick:ct=>{ct.stopPropagation(),bt(Ae),setTimeout(()=>Mt(),100)},className:"flex-1 flex items-center justify-center space-x-1.5 px-3 py-2 min-h-touch text-xs xs:text-sm text-primary bg-primary-50 hover:bg-primary-100 rounded-lg transition-colors",children:[o.jsx(Y,{name:"Edit",size:14}),o.jsx("span",{children:"Edit"})]}),o.jsxs("button",{onClick:ct=>{ct.stopPropagation(),s(Ae),Cn()},className:"flex-1 flex items-center justify-center space-x-1.5 px-3 py-2 min-h-touch text-xs xs:text-sm text-text-secondary bg-surface-hover hover:bg-gray-200 rounded-lg transition-colors",children:[o.jsx(Y,{name:"Copy",size:14}),o.jsx("span",{children:"Clone"})]}),a(["deals.delete_all","deals.delete_own"])&&o.jsx("button",{onClick:ct=>{ct.stopPropagation(),s(Ae),I(!0)},className:"flex items-center justify-center px-3 py-2 min-h-touch min-w-touch text-error bg-error-50 hover:bg-error-100 rounded-lg transition-colors",children:o.jsx(Y,{name:"Trash2",size:14})})]})]},Ae.id)})})}),ue.length>0&&o.jsx("div",{className:"px-3 xs:px-4 sm:px-6 py-3 xs:py-4 border-t border-border",children:o.jsx(Im,{currentPage:H,totalPages:oe,totalItems:te,itemsPerPage:U,onPageChange:Ie})})]})]}):o.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-12 gap-4 xs:gap-6 sm:gap-8",children:[o.jsx("div",{className:"xl:col-span-8",children:S?o.jsx("div",{className:"bg-surface rounded-lg border border-border p-8",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),o.jsx("p",{className:"text-text-secondary",children:"Loading deal..."})]})}):j?o.jsx(ZCe,{deal:i,contacts:u,companies:f,stages:J,onEdit:a(["deals.edit_all","deals.edit_own"])?Mt:null}):o.jsx(KCe,{deal:i,contacts:u,companies:f,stages:J,onSubmit:Ha,onCancel:St,isSaving:A})}),!S&&o.jsx("div",{className:"xl:col-span-4 space-y-6",children:o.jsx(l7e,{documents:p,loading:V,dealId:i==null?void 0:i.id,onUploadDocument:j?null:Wf,onDeleteDocument:j?null:ec,readOnly:j})})]})]})})}),F&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-3 xs:p-4",children:o.jsxs("div",{className:"bg-surface rounded-lg p-4 xs:p-6 max-w-md w-full",children:[o.jsxs("div",{className:"flex items-center space-x-2 xs:space-x-3 mb-3 xs:mb-4",children:[o.jsx("div",{className:"w-10 h-10 bg-error-50 rounded-full flex items-center justify-center flex-shrink-0",children:o.jsx(Y,{name:"AlertTriangle",size:20,className:"text-error"})}),o.jsx("h3",{className:"text-base xs:text-lg font-semibold text-text-primary",children:"Delete Deal"})]}),o.jsxs("p",{className:"text-text-secondary mb-4 xs:mb-6 text-sm xs:text-base",children:['Are you sure you want to delete "',i==null?void 0:i.name,'"? This action cannot be undone.']}),o.jsxs("div",{className:"flex flex-col xs:flex-row space-y-2 xs:space-y-0 xs:space-x-3",children:[o.jsx("button",{onClick:()=>I(!1),className:"flex-1 px-4 py-2 min-h-touch border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-colors duration-150 text-sm xs:text-base",children:"Cancel"}),o.jsx("button",{onClick:kn,className:"flex-1 px-4 py-2 min-h-touch bg-error text-white rounded-lg hover:bg-error-600 transition-colors duration-150 text-sm xs:text-base",children:"Delete Deal"})]})]})}),R&&o.jsx(pH,{deals:ue,onClose:()=>C(!1),filters:{stage:k!=="all"?k:null}})]})},xH=6048e5,u7e=864e5,v0=43200,T6=1440,k6=Symbol.for("constructDateFrom");function $o(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&k6 in e?e[k6](t):e instanceof Date?new e.constructor(t):new Date(t)}function Nn(e,t){return $o(t||e,e)}let d7e={};function yx(){return d7e}function dp(e,t){var l,c,u,d;const r=yx(),n=(t==null?void 0:t.weekStartsOn)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,a=Nn(e,t==null?void 0:t.in),i=a.getDay(),s=(i<n?7:0)+i-n;return a.setDate(a.getDate()-s),a.setHours(0,0,0,0),a}function Av(e,t){return dp(e,{...t,weekStartsOn:1})}function gH(e,t){const r=Nn(e,t==null?void 0:t.in),n=r.getFullYear(),a=$o(r,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const i=Av(a),s=$o(r,0);s.setFullYear(n,0,4),s.setHours(0,0,0,0);const l=Av(s);return r.getTime()>=i.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function Ov(e){const t=Nn(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function y1(e,...t){const r=$o.bind(null,e||t.find(n=>typeof n=="object"));return t.map(r)}function C6(e,t){const r=Nn(e,t==null?void 0:t.in);return r.setHours(0,0,0,0),r}function f7e(e,t,r){const[n,a]=y1(r==null?void 0:r.in,e,t),i=C6(n),s=C6(a),l=+i-Ov(i),c=+s-Ov(s);return Math.round((l-c)/u7e)}function h7e(e,t){const r=gH(e,t),n=$o(e,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),Av(n)}function I0(e,t){const r=+Nn(e)-+Nn(t);return r<0?-1:r>0?1:r}function m7e(e){return $o(e,Date.now())}function p7e(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function x7e(e){return!(!p7e(e)&&typeof e!="number"||isNaN(+Nn(e)))}function g7e(e,t,r){const[n,a]=y1(r==null?void 0:r.in,e,t),i=n.getFullYear()-a.getFullYear(),s=n.getMonth()-a.getMonth();return i*12+s}function v7e(e){return t=>{const n=(e?Math[e]:Math.trunc)(t);return n===0?0:n}}function y7e(e,t){return+Nn(e)-+Nn(t)}function b7e(e,t){const r=Nn(e,t==null?void 0:t.in);return r.setHours(23,59,59,999),r}function w7e(e,t){const r=Nn(e,t==null?void 0:t.in),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function _7e(e,t){const r=Nn(e,t==null?void 0:t.in);return+b7e(r,t)==+w7e(r,t)}function D7e(e,t,r){const[n,a,i]=y1(r==null?void 0:r.in,e,e,t),s=I0(a,i),l=Math.abs(g7e(a,i));if(l<1)return 0;a.getMonth()===1&&a.getDate()>27&&a.setDate(30),a.setMonth(a.getMonth()-s*l);let c=I0(a,i)===-s;_7e(n)&&l===1&&I0(n,i)===1&&(c=!1);const u=s*(l-+c);return u===0?0:u}function j7e(e,t,r){const n=y7e(e,t)/1e3;return v7e(r==null?void 0:r.roundingMethod)(n)}function N7e(e,t){const r=Nn(e,t==null?void 0:t.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const S7e={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},E7e=(e,t,r)=>{let n;const a=S7e[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function r_(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const T7e={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},k7e={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},C7e={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},A7e={date:r_({formats:T7e,defaultWidth:"full"}),time:r_({formats:k7e,defaultWidth:"full"}),dateTime:r_({formats:C7e,defaultWidth:"full"})},O7e={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},F7e=(e,t,r,n)=>O7e[e];function fh(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const s=e.defaultFormattingWidth||e.defaultWidth,l=r!=null&&r.width?String(r.width):s;a=e.formattingValues[l]||e.formattingValues[s]}else{const s=e.defaultWidth,l=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[l]||e.values[s]}const i=e.argumentCallback?e.argumentCallback(t):t;return a[i]}}const P7e={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},I7e={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},R7e={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},M7e={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},U7e={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},$7e={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},L7e=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},B7e={ordinalNumber:L7e,era:fh({values:P7e,defaultWidth:"wide"}),quarter:fh({values:I7e,defaultWidth:"wide",argumentCallback:e=>e-1}),month:fh({values:R7e,defaultWidth:"wide"}),day:fh({values:M7e,defaultWidth:"wide"}),dayPeriod:fh({values:U7e,defaultWidth:"wide",formattingValues:$7e,defaultFormattingWidth:"wide"})};function hh(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;const s=i[0],l=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?z7e(l,f=>f.test(s)):W7e(l,f=>f.test(s));let u;u=e.valueCallback?e.valueCallback(c):c,u=r.valueCallback?r.valueCallback(u):u;const d=t.slice(s.length);return{value:u,rest:d}}}function W7e(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function z7e(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function H7e(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],i=t.match(e.parsePattern);if(!i)return null;let s=e.valueCallback?e.valueCallback(i[0]):i[0];s=r.valueCallback?r.valueCallback(s):s;const l=t.slice(a.length);return{value:s,rest:l}}}const V7e=/^(\d+)(th|st|nd|rd)?/i,q7e=/\d+/i,G7e={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Y7e={any:[/^b/i,/^(a|c)/i]},X7e={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},K7e={any:[/1/i,/2/i,/3/i,/4/i]},Z7e={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},J7e={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Q7e={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},eWe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},tWe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},rWe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},nWe={ordinalNumber:H7e({matchPattern:V7e,parsePattern:q7e,valueCallback:e=>parseInt(e,10)}),era:hh({matchPatterns:G7e,defaultMatchWidth:"wide",parsePatterns:Y7e,defaultParseWidth:"any"}),quarter:hh({matchPatterns:X7e,defaultMatchWidth:"wide",parsePatterns:K7e,defaultParseWidth:"any",valueCallback:e=>e+1}),month:hh({matchPatterns:Z7e,defaultMatchWidth:"wide",parsePatterns:J7e,defaultParseWidth:"any"}),day:hh({matchPatterns:Q7e,defaultMatchWidth:"wide",parsePatterns:eWe,defaultParseWidth:"any"}),dayPeriod:hh({matchPatterns:tWe,defaultMatchWidth:"any",parsePatterns:rWe,defaultParseWidth:"any"})},vH={code:"en-US",formatDistance:E7e,formatLong:A7e,formatRelative:F7e,localize:B7e,match:nWe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function aWe(e,t){const r=Nn(e,t==null?void 0:t.in);return f7e(r,N7e(r))+1}function iWe(e,t){const r=Nn(e,t==null?void 0:t.in),n=+Av(r)-+h7e(r);return Math.round(n/xH)+1}function yH(e,t){var d,f,h,m;const r=Nn(e,t==null?void 0:t.in),n=r.getFullYear(),a=yx(),i=(t==null?void 0:t.firstWeekContainsDate)??((f=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??a.firstWeekContainsDate??((m=(h=a.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??1,s=$o((t==null?void 0:t.in)||e,0);s.setFullYear(n+1,0,i),s.setHours(0,0,0,0);const l=dp(s,t),c=$o((t==null?void 0:t.in)||e,0);c.setFullYear(n,0,i),c.setHours(0,0,0,0);const u=dp(c,t);return+r>=+l?n+1:+r>=+u?n:n-1}function sWe(e,t){var l,c,u,d;const r=yx(),n=(t==null?void 0:t.firstWeekContainsDate)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,a=yH(e,t),i=$o((t==null?void 0:t.in)||e,0);return i.setFullYear(a,0,n),i.setHours(0,0,0,0),dp(i,t)}function oWe(e,t){const r=Nn(e,t==null?void 0:t.in),n=+dp(r,t)-+sWe(r,t);return Math.round(n/xH)+1}function Xt(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const tl={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Xt(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Xt(r+1,2)},d(e,t){return Xt(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Xt(e.getHours()%12||12,t.length)},H(e,t){return Xt(e.getHours(),t.length)},m(e,t){return Xt(e.getMinutes(),t.length)},s(e,t){return Xt(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return Xt(a,t.length)}},Ru={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},A6={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return tl.y(e,t)},Y:function(e,t,r,n){const a=yH(e,n),i=a>0?a:1-a;if(t==="YY"){const s=i%100;return Xt(s,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):Xt(i,t.length)},R:function(e,t){const r=gH(e);return Xt(r,t.length)},u:function(e,t){const r=e.getFullYear();return Xt(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Xt(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Xt(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return tl.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Xt(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const a=oWe(e,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):Xt(a,t.length)},I:function(e,t,r){const n=iWe(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Xt(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):tl.d(e,t)},D:function(e,t,r){const n=aWe(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Xt(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return Xt(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return Xt(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return Xt(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let a;switch(n===12?a=Ru.noon:n===0?a=Ru.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let a;switch(n>=17?a=Ru.evening:n>=12?a=Ru.afternoon:n>=4?a=Ru.morning:a=Ru.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return tl.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):tl.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Xt(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Xt(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):tl.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):tl.s(e,t)},S:function(e,t){return tl.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return F6(n);case"XXXX":case"XX":return mc(n);case"XXXXX":case"XXX":default:return mc(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return F6(n);case"xxxx":case"xx":return mc(n);case"xxxxx":case"xxx":default:return mc(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+O6(n,":");case"OOOO":default:return"GMT"+mc(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+O6(n,":");case"zzzz":default:return"GMT"+mc(n,":")}},t:function(e,t,r){const n=Math.trunc(+e/1e3);return Xt(n,t.length)},T:function(e,t,r){return Xt(+e,t.length)}};function O6(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),i=n%60;return i===0?r+String(a):r+String(a)+t+Xt(i,2)}function F6(e,t){return e%60===0?(e>0?"-":"+")+Xt(Math.abs(e)/60,2):mc(e,t)}function mc(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Xt(Math.trunc(n/60),2),i=Xt(n%60,2);return r+a+t+i}const P6=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},bH=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},lWe=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return P6(e,t);let i;switch(n){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",P6(n,t)).replace("{{time}}",bH(a,t))},cWe={p:bH,P:lWe},uWe=/^D+$/,dWe=/^Y+$/,fWe=["D","DD","YY","YYYY"];function hWe(e){return uWe.test(e)}function mWe(e){return dWe.test(e)}function pWe(e,t,r){const n=xWe(e,t,r);if(console.warn(n),fWe.includes(e))throw new RangeError(n)}function xWe(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const gWe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,vWe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,yWe=/^'([^]*?)'?$/,bWe=/''/g,wWe=/[a-zA-Z]/;function Si(e,t,r){var d,f,h,m;const n=yx(),a=n.locale??vH,i=n.firstWeekContainsDate??((f=(d=n.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??1,s=n.weekStartsOn??((m=(h=n.locale)==null?void 0:h.options)==null?void 0:m.weekStartsOn)??0,l=Nn(e,r==null?void 0:r.in);if(!x7e(l))throw new RangeError("Invalid time value");let c=t.match(vWe).map(x=>{const p=x[0];if(p==="p"||p==="P"){const g=cWe[p];return g(x,a.formatLong)}return x}).join("").match(gWe).map(x=>{if(x==="''")return{isToken:!1,value:"'"};const p=x[0];if(p==="'")return{isToken:!1,value:_We(x)};if(A6[p])return{isToken:!0,value:x};if(p.match(wWe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:x}});a.localize.preprocessor&&(c=a.localize.preprocessor(l,c));const u={firstWeekContainsDate:i,weekStartsOn:s,locale:a};return c.map(x=>{if(!x.isToken)return x.value;const p=x.value;(mWe(p)||hWe(p))&&pWe(p,t,String(e));const g=A6[p[0]];return g(l,p,a.localize,u)}).join("")}function _We(e){const t=e.match(yWe);return t?t[1].replace(bWe,"'"):e}function DWe(e,t,r){const n=yx(),a=(r==null?void 0:r.locale)??n.locale??vH,i=2520,s=I0(e,t);if(isNaN(s))throw new RangeError("Invalid time value");const l=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:s}),[c,u]=y1(r==null?void 0:r.in,...s>0?[t,e]:[e,t]),d=j7e(u,c),f=(Ov(u)-Ov(c))/1e3,h=Math.round((d-f)/60);let m;if(h<2)return r!=null&&r.includeSeconds?d<5?a.formatDistance("lessThanXSeconds",5,l):d<10?a.formatDistance("lessThanXSeconds",10,l):d<20?a.formatDistance("lessThanXSeconds",20,l):d<40?a.formatDistance("halfAMinute",0,l):d<60?a.formatDistance("lessThanXMinutes",1,l):a.formatDistance("xMinutes",1,l):h===0?a.formatDistance("lessThanXMinutes",1,l):a.formatDistance("xMinutes",h,l);if(h<45)return a.formatDistance("xMinutes",h,l);if(h<90)return a.formatDistance("aboutXHours",1,l);if(h<T6){const x=Math.round(h/60);return a.formatDistance("aboutXHours",x,l)}else{if(h<i)return a.formatDistance("xDays",1,l);if(h<v0){const x=Math.round(h/T6);return a.formatDistance("xDays",x,l)}else if(h<v0*2)return m=Math.round(h/v0),a.formatDistance("aboutXMonths",m,l)}if(m=D7e(u,c),m<12){const x=Math.round(h/v0);return a.formatDistance("xMonths",x,l)}else{const x=m%12,p=Math.trunc(m/12);return x<3?a.formatDistance("aboutXYears",p,l):x<9?a.formatDistance("overXYears",p,l):a.formatDistance("almostXYears",p+1,l)}}function rk(e,t){return DWe(e,m7e(e),t)}const jWe=({contacts:e,selectedContact:t,selectedContacts:r,onContactSelect:n,onContactMultiSelect:a,onDeleteContact:i})=>{const s=l=>{if(!l)return"Never contacted";try{const c=new Date(l);return rk(c,{addSuffix:!0})}catch{return"Invalid date"}};return(e==null?void 0:e.length)===0?o.jsx("div",{className:"p-6 text-center",children:o.jsx("p",{className:"text-text-secondary",children:"No contacts found"})}):o.jsx("div",{className:"overflow-y-auto max-h-[calc(100vh-220px)]",children:e==null?void 0:e.map(l=>{var c,u,d;return o.jsx("div",{className:`border-b border-border last:border-b-0 p-4 cursor-pointer transition-colors duration-150 ease-out ${t&&(t==null?void 0:t.id)===(l==null?void 0:l.id)?"bg-primary-50":"hover:bg-surface-hover"}`,onClick:()=>{n==null||n(l)},children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0 mr-3",children:o.jsx("input",{type:"checkbox",checked:(r==null?void 0:r.includes(l==null?void 0:l.id))||!1,onChange:f=>{f==null||f.stopPropagation(),a==null||a(l==null?void 0:l.id)},onClick:f=>{f==null||f.stopPropagation()},className:"h-4 w-4 text-primary border-border rounded focus:ring-primary cursor-pointer"})}),o.jsx("div",{className:"flex-shrink-0 mr-3",children:o.jsxs("div",{className:"relative",children:[o.jsx(Io,{src:(l==null?void 0:l.avatar_url)||"/assets/images/no_image.png",alt:`${(l==null?void 0:l.first_name)||""} ${(l==null?void 0:l.last_name)||""}`,className:"w-10 h-10 rounded-full object-cover"}),o.jsx("span",{className:`absolute bottom-0 right-0 w-3 h-3 rounded-full border-2 border-surface ${(l==null?void 0:l.status)==="active"?"bg-success":"bg-text-tertiary"}`})]})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsx("h3",{className:"text-sm font-medium text-text-primary truncate",children:(l==null?void 0:l.full_name)||((c=`${(l==null?void 0:l.first_name)||""} ${(l==null?void 0:l.last_name)||""}`)==null?void 0:c.trim())||"Unnamed Contact"}),o.jsxs("div",{className:"flex items-center ml-2",children:[((u=l==null?void 0:l.deals)==null?void 0:u.some(f=>(f==null?void 0:f.stage)==="negotiation"||(f==null?void 0:f.stage)==="proposal"))&&o.jsx("span",{className:"w-2 h-2 bg-warning rounded-full mr-1",title:"Has active deals"}),o.jsx("button",{onClick:f=>{f==null||f.stopPropagation(),window.confirm("Are you sure you want to delete this contact?")&&(i==null||i(l==null?void 0:l.id))},className:"text-text-tertiary hover:text-error transition-colors duration-150 ease-out",title:"Delete contact",children:o.jsx(Y,{name:"Trash2",size:14})})]})]}),o.jsx("p",{className:"text-xs text-text-secondary truncate",children:((d=l==null?void 0:l.company)==null?void 0:d.name)||"No Company"}),o.jsxs("div",{className:"flex items-center mt-1",children:[o.jsx(Y,{name:"Clock",size:12,className:"text-text-tertiary mr-1"}),o.jsx("span",{className:"text-xs text-text-tertiary",children:s(l==null?void 0:l.last_contact_date)})]})]})]})},l==null?void 0:l.id)})})},NWe=({contacts:e,onContactSelect:t,onDeleteContact:r})=>{const n=a=>{if(!a)return"Never contacted";try{const i=new Date(a);return rk(i,{addSuffix:!0})}catch{return"Invalid date"}};return(e==null?void 0:e.length)===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"w-16 h-16 bg-primary-50 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(Y,{name:"Users",size:24,className:"text-primary"})}),o.jsx("h3",{className:"text-xl font-semibold text-text-primary mb-2",children:"No Contacts Found"}),o.jsx("p",{className:"text-text-secondary",children:"Try adjusting your search or filters, or add a new contact."})]}):o.jsx("div",{className:"grid grid-cols-1 xs:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 xs:gap-4",children:e==null?void 0:e.map(a=>{var i,s,l;return o.jsxs("div",{className:"bg-surface rounded-lg border border-border shadow-sm hover:shadow-md transition-all duration-200 cursor-pointer group overflow-hidden min-h-touch",onClick:()=>t==null?void 0:t(a),children:[o.jsxs("div",{className:"relative p-4 xs:p-6 pb-3 xs:pb-4 bg-gradient-to-br from-primary-50 to-primary-100 dark:from-gray-800 dark:to-gray-750",children:[o.jsx("button",{onClick:c=>{c==null||c.stopPropagation(),window.confirm("Are you sure you want to delete this contact?")&&(r==null||r(a==null?void 0:a.id))},className:"absolute top-2 right-2 xs:top-3 xs:right-3 p-2 min-h-touch min-w-touch flex items-center justify-center rounded-lg bg-surface/80 backdrop-blur-sm text-text-tertiary hover:text-error hover:bg-error-50 dark:hover:bg-error-900/50 transition-all duration-150 opacity-100 xs:opacity-0 group-hover:opacity-100",title:"Delete contact","aria-label":"Delete contact",children:o.jsx(Y,{name:"Trash2",size:16})}),o.jsx("div",{className:"flex justify-center mb-2 xs:mb-3",children:o.jsxs("div",{className:"relative",children:[o.jsx(Io,{src:(a==null?void 0:a.avatar_url)||"/assets/images/no_image.png",alt:`${(a==null?void 0:a.first_name)||""} ${(a==null?void 0:a.last_name)||""}`,className:"w-16 h-16 xs:w-20 xs:h-20 rounded-full object-cover border-4 border-surface shadow-md"}),o.jsx("span",{className:`absolute bottom-0 right-0 w-3 h-3 xs:w-4 xs:h-4 rounded-full border-2 border-surface ${(a==null?void 0:a.status)==="active"?"bg-success":"bg-text-tertiary"}`})]})}),o.jsx("h3",{className:"text-center text-base xs:text-lg font-semibold text-gray-900 dark:text-white truncate px-2",children:(a==null?void 0:a.full_name)||((i=`${(a==null?void 0:a.first_name)||""} ${(a==null?void 0:a.last_name)||""}`)==null?void 0:i.trim())||"Unnamed Contact"})]}),o.jsxs("div",{className:"p-3 xs:p-4 space-y-2 xs:space-y-3",children:[((s=a==null?void 0:a.company)==null?void 0:s.name)&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:"Briefcase",size:14,className:"text-text-tertiary flex-shrink-0"}),a!=null&&a.company_id?o.jsx(Ur,{to:`/company-management/${a.company_id}`,className:"text-sm text-primary hover:underline truncate",onClick:c=>c.stopPropagation(),children:a.company.name}):o.jsx("span",{className:"text-sm text-text-secondary truncate",children:a.company.name})]}),(a==null?void 0:a.email)&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:"Mail",size:14,className:"text-text-tertiary flex-shrink-0"}),o.jsx("span",{className:"text-sm text-text-secondary truncate",children:a==null?void 0:a.email})]}),(a==null?void 0:a.phone)&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:"Phone",size:14,className:"text-text-tertiary flex-shrink-0"}),o.jsx("span",{className:"text-sm text-text-secondary truncate",children:a==null?void 0:a.phone})]}),o.jsxs("div",{className:"flex items-center space-x-2 pt-2 border-t border-border",children:[o.jsx(Y,{name:"Clock",size:14,className:"text-text-tertiary flex-shrink-0"}),o.jsx("span",{className:"text-xs text-text-tertiary truncate",children:n(a==null?void 0:a.last_contact_date)})]}),((l=a==null?void 0:a.deals)==null?void 0:l.some(c=>(c==null?void 0:c.stage)==="negotiation"||(c==null?void 0:c.stage)==="proposal"))&&o.jsxs("div",{className:"flex items-center space-x-2 pt-1",children:[o.jsx("div",{className:"w-2 h-2 bg-warning rounded-full"}),o.jsx("span",{className:"text-xs text-warning font-medium",children:"Has active deals"})]})]})]},a==null?void 0:a.id)})})},wH=({isOpen:e,onClose:t,onActivityAdded:r,onActivityUpdated:n,prefilledData:a={},templateData:i=null,editingActivity:s=null})=>{const{user:l}=Vt(),[c,u]=M.useState(!1),[d,f]=M.useState([]),[h,m]=M.useState([]),[x,p]=M.useState([]),[g,v]=M.useState({}),[y,b]=M.useState(!1),[w,_]=M.useState({}),[D,j]=M.useState({});M.useEffect(()=>{Gr.loadConfiguration()},[]);const N=B=>Gr.formatCurrency(B),S=M.useCallback(()=>({type:"note",subject:"",description:"",contact_id:"",deal_id:"",duration_minutes:"",scheduled_at:"",user_id:(l==null?void 0:l.id)||""}),[l]),E=M.useCallback((B,P,F)=>{var k;if(!B)return B;let I=B;I=I.replace(/{user_name}/g,l!=null&&l.first_name&&(l!=null&&l.last_name)?`${l.first_name} ${l.last_name}`:(l==null?void 0:l.email)||"User"),P?(I=I.replace(/{contact_name}/g,`${P.first_name} ${P.last_name}`),I=I.replace(/{company_name}/g,((k=P.company)==null?void 0:k.name)||"Company")):(I=I.replace(/{contact_name}/g,"[Contact Name]"),I=I.replace(/{company_name}/g,"[Company Name]")),F&&(I=I.replace(/{deal_title}/g,F.title||"[Deal Title]"),I=I.replace(/{deal_value}/g,F.value?N(F.value):"[Deal Value]"));const R=new Date,C=new Date(R.getTime()+7*24*60*60*1e3);return I=I.replace(/{today}/g,R.toLocaleDateString()),I=I.replace(/{follow_up_date}/g,C.toLocaleDateString()),I=I.replace(/{topic}/g,"[Discussion Topic]"),I=I.replace(/{next_action}/g,"[Next Action]"),I},[l]),A=async()=>{b(!0);try{const P=(await as.getAllFields({entity_type:"activity",is_active:!0})||[]).filter(F=>F.placement==="form"||F.placement==="both");p(P)}catch(B){console.error("Error loading custom fields:",B),p([])}finally{b(!1)}},T=(B,P)=>{v(F=>({...F,[B]:P}))};M.useEffect(()=>{if(e)if((async()=>{try{const[P,F]=await Promise.all([Ct.getUserContacts(),gt.getUserDeals()]);f(P||[]),m(F||[]),await A()}catch(P){console.error("Error loading modal data:",P),j({submit:"Failed to load contacts and deals."})}})(),s){const P={type:s.type||"note",subject:s.title||s.subject||"",description:s.description||"",contact_id:s.contact_id||"",deal_id:s.deal_id||"",duration_minutes:s.duration?parseInt(s.duration):"",scheduled_at:s.scheduled_at||"",user_id:s.user_id||(l==null?void 0:l.id)||""};if(_(P),s.custom_fields){const F={};Object.entries(s.custom_fields).forEach(([I,R])=>{(R==null?void 0:R.value)!==null&&(R==null?void 0:R.value)!==void 0&&(F[I]=R.value)}),v(F)}else v({})}else{const P={...S(),...a};if(i){const F=d.find(R=>R.id===P.contact_id),I=h.find(R=>R.id===P.deal_id);P.type=i.type,P.subject=E(i.template.subject,F,I),P.description=E(i.template.description,F,I),P.duration_minutes=i.template.duration_minutes,P.priority=i.template.priority}_(P),v({})}else _({}),v({}),j({})},[e,s]);const L=(B,P)=>{const F={...w,[B]:P};if(i&&(B==="contact_id"||B==="deal_id")){const I=d.find(C=>C.id===(B==="contact_id"?P:w.contact_id)),R=h.find(C=>C.id===(B==="deal_id"?P:w.deal_id));F.subject=E(i.template.subject,I,R),F.description=E(i.template.description,I,R)}_(F)},O=async B=>{B.preventDefault(),u(!0),j({});try{const P=["type","subject"],F={};if(P.forEach(R=>{var C;(C=w[R])!=null&&C.trim()||(F[R]=`${R.replace("_"," ")} is required`)}),["call","meeting"].includes(w.type)&&w.duration_minutes&&(isNaN(w.duration_minutes)||parseInt(w.duration_minutes)<=0)&&(F.duration_minutes="Please enter a valid duration"),Object.keys(F).length>0){j(F),u(!1);return}const I={...w,duration_minutes:w.duration_minutes?parseInt(w.duration_minutes):null,scheduled_at:w.scheduled_at||null,user_id:l==null?void 0:l.id,contact_id:w.contact_id&&w.contact_id!==""?w.contact_id:null,deal_id:w.deal_id&&w.deal_id!==""?w.deal_id:null,custom_fields:Object.keys(g).length>0?g:void 0};if(s){const R=await ei.updateActivity(s.id,I);n&&n(R)}else{const R=await ei.createActivity(I);r(R)}t()}catch(P){console.error(`Error ${s?"updating":"creating"} activity:`,P),j({submit:P.message||`Failed to ${s?"update":"create"} activity. Please try again.`})}finally{u(!1)}},V=(B,P)=>{D[B]&&j(F=>{const I={...F};return delete I[B],I}),L(B,P)},W=[{value:"note",label:"Note",icon:"FileText"},{value:"call",label:"Call",icon:"Phone"},{value:"email",label:"Email",icon:"Mail"},{value:"meeting",label:"Meeting",icon:"Calendar"},{value:"task",label:"Task",icon:"CheckSquare"}];return e?o.jsxs("div",{className:"fixed inset-0 z-[9999] overflow-hidden","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:[o.jsx("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-75 transition-opacity",onClick:t,"aria-hidden":"true"}),o.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:o.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:o.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl w-full max-w-3xl my-8 transform transition-all",children:[o.jsx("div",{className:"bg-primary px-6 py-5 rounded-t-xl text-white font-semibold text-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-10 h-10 bg-white bg-opacity-20 rounded-lg flex items-center justify-center",children:o.jsx(Y,{name:"Activity",size:20,className:"text-white"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xl font-bold text-white",id:"modal-title",children:s?"Edit Activity":"Add New Activity"}),i&&!s&&o.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[o.jsx(Y,{name:"FileTemplate",size:14,className:"text-white text-opacity-80"}),o.jsxs("span",{className:"text-sm text-white text-opacity-80",children:["Using template: ",i.name]})]})]})]}),o.jsx("button",{onClick:t,className:"text-white hover:bg-white hover:bg-opacity-20 rounded-lg p-2 transition-colors duration-150","aria-label":"Close",children:o.jsx(Y,{name:"X",size:20})})]})}),o.jsxs("div",{className:"bg-white px-6 py-6 max-h-[calc(100vh-200px)] overflow-y-auto",children:[D.submit&&o.jsxs("div",{className:"mb-6 bg-error-50 border-l-4 border-error text-error p-4 rounded-r-lg flex items-start space-x-3",children:[o.jsx(Y,{name:"AlertCircle",size:20,className:"flex-shrink-0 mt-0.5"}),o.jsx("span",{children:D.submit})]}),o.jsxs("form",{onSubmit:O,className:"space-y-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Activity Type ",o.jsx("span",{className:"text-error",children:"*"})]}),o.jsx("div",{className:"grid grid-cols-5 gap-3",children:W.map(B=>o.jsx("button",{type:"button",onClick:()=>V("type",B.value),className:`group relative p-4 border-2 rounded-xl transition-all duration-200 ${w.type===B.value?"border-primary bg-primary-50 shadow-md scale-105":"border-gray-200 hover:border-primary-300 hover:bg-gray-50"}`,children:o.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[o.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center transition-colors ${w.type===B.value?"bg-primary text-white":"bg-gray-100 text-gray-600 group-hover:bg-primary-100 group-hover:text-primary"}`,children:o.jsx(Y,{name:B.icon,size:20})}),o.jsx("span",{className:`text-sm font-medium ${w.type===B.value?"text-primary":"text-gray-700"}`,children:B.label})]})},B.value))})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Subject ",o.jsx("span",{className:"text-error",children:"*"})]}),o.jsx("input",{type:"text",value:w.subject||"",onChange:B=>V("subject",B.target.value),className:`w-full px-4 py-2.5 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all ${D.subject?"border-error":"border-gray-200"}`,placeholder:"Enter activity subject...",required:!0}),D.subject&&o.jsxs("p",{className:"text-sm text-error mt-1 flex items-center space-x-1",children:[o.jsx(Y,{name:"AlertCircle",size:14}),o.jsx("span",{children:D.subject})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Description"}),o.jsx("textarea",{value:w.description||"",onChange:B=>V("description",B.target.value),rows:4,className:"w-full px-4 py-2.5 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all resize-none",placeholder:"Add details about this activity..."})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Related Contact"}),o.jsxs("div",{className:"relative",children:[o.jsx(Y,{name:"User",size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),o.jsxs("select",{value:w.contact_id||"",onChange:B=>V("contact_id",B.target.value),className:"w-full pl-10 pr-4 py-2.5 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all appearance-none bg-white",children:[o.jsx("option",{value:"",children:"Select Contact"}),d.map(B=>o.jsxs("option",{value:B.id,children:[B.first_name," ",B.last_name]},B.id))]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Related Deal"}),o.jsxs("div",{className:"relative",children:[o.jsx(Y,{name:"TrendingUp",size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),o.jsxs("select",{value:w.deal_id||"",onChange:B=>V("deal_id",B.target.value),className:"w-full pl-10 pr-4 py-2.5 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all appearance-none bg-white",children:[o.jsx("option",{value:"",children:"Select Deal"}),h.map(B=>o.jsx("option",{value:B.id,children:B.name},B.id))]})]})]})]}),["call","meeting"].includes(w.type)&&o.jsx("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-xl p-4",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[o.jsx(Y,{name:"Clock",size:14,className:"inline mr-1"}),"Duration (minutes)"]}),o.jsx("input",{type:"number",min:"1",value:w.duration_minutes||"",onChange:B=>V("duration_minutes",B.target.value),className:`w-full px-4 py-2.5 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all ${D.duration_minutes?"border-error":"border-gray-200"}`,placeholder:"30"}),D.duration_minutes&&o.jsx("p",{className:"text-sm text-error mt-1",children:D.duration_minutes})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[o.jsx(Y,{name:"Calendar",size:14,className:"inline mr-1"}),"Date & Time"]}),o.jsx("input",{type:"datetime-local",value:w.scheduled_at||"",onChange:B=>V("scheduled_at",B.target.value),className:"w-full px-4 py-2.5 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all"})]})]})}),x.length>0&&o.jsxs("div",{className:"border-t-2 border-gray-100 pt-6",children:[o.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-4 flex items-center space-x-2",children:[o.jsx(Y,{name:"Settings",size:16}),o.jsx("span",{children:"Custom Fields"})]}),o.jsx(vb,{fields:x,values:g,onChange:T,loading:y})]})]})]}),o.jsx("div",{className:"bg-gray-50 px-6 py-4 rounded-b-xl border-t-2 border-gray-100",children:o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx("button",{type:"button",onClick:t,className:"px-6 py-2.5 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 font-medium transition-colors duration-150",disabled:c,children:"Cancel"}),o.jsx("button",{type:"submit",onClick:O,className:"px-6 py-2.5 bg-primary text-white rounded-lg hover:bg-primary-600 font-medium shadow-md hover:shadow-lg transition-all duration-150 flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:c,children:c?o.jsxs(o.Fragment,{children:[o.jsx(Y,{name:"Loader2",size:16,className:"animate-spin"}),o.jsx("span",{children:s?"Updating...":"Creating..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(Y,{name:s?"Check":"Plus",size:16}),o.jsx("span",{children:s?"Update Activity":"Create Activity"})]})})]})})]})})})]}):null},SWe=({activities:e,contact:t,onActivityAdded:r,onActivityUpdated:n,loading:a=!1})=>{const[i,s]=M.useState("all"),[l,c]=M.useState(!1),[u,d]=M.useState(null),f=_=>{switch(_){case"email":return"Mail";case"call":return"Phone";case"meeting":return"Calendar";case"note":return"FileText";case"task":return"CheckSquare";default:return"Activity"}},h=_=>{switch(_){case"email":return"bg-primary-50 text-primary";case"call":return"bg-success-50 text-success";case"meeting":return"bg-secondary-50 text-secondary";case"note":return"bg-warning-50 text-warning";case"task":return"bg-accent-50 text-accent";default:return"bg-gray-100 text-gray-600"}},m=_=>Si(new Date(_),"MMM d, yyyy h:mm a"),x=async _=>{try{return r&&r(_),_}catch(D){throw console.error("Error handling activity:",D),D}},p=async _=>{try{return n&&n(_),_}catch(D){throw console.error("Error handling activity update:",D),D}},g=async _=>{try{const D=await ei.getActivityById(_.id);d(D),c(!0)}catch(D){console.error("Error fetching activity for editing:",D),d(_),c(!0)}},v=()=>{d(null),c(!0)},y=()=>{c(!1),d(null)},w=[...i==="all"?e:e==null?void 0:e.filter(_=>(_==null?void 0:_.type)===i)].sort((_,D)=>new Date(D.scheduled_at||D.created_at)-new Date(_.scheduled_at||_.created_at));return o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Activity Timeline"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs("select",{value:i,onChange:_=>{var D;return s((D=_==null?void 0:_.target)==null?void 0:D.value)},className:"text-sm border border-border rounded-md py-1 px-2 text-text-primary bg-surface focus:outline-none focus:ring-1 focus:ring-primary focus:border-primary",children:[o.jsx("option",{value:"all",children:"All Activities"}),o.jsx("option",{value:"email",children:"Emails"}),o.jsx("option",{value:"call",children:"Calls"}),o.jsx("option",{value:"meeting",children:"Meetings"}),o.jsx("option",{value:"note",children:"Notes"}),o.jsx("option",{value:"task",children:"Tasks"})]}),o.jsxs("button",{className:"inline-flex items-center space-x-2 px-3 py-1 border border-border rounded-md text-text-secondary hover:text-primary hover:border-primary transition-all duration-150 ease-out text-sm",onClick:v,children:[o.jsx(Y,{name:"Plus",size:14}),o.jsx("span",{children:"Log Activity"})]})]})]}),a?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),o.jsx("p",{className:"text-text-secondary",children:"Loading activities..."})]}):(w==null?void 0:w.length)>0?o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute left-6 top-0 bottom-0 w-px bg-border"}),o.jsx("div",{className:"space-y-6",children:w==null?void 0:w.map(_=>o.jsxs("div",{className:"relative pl-14",children:[o.jsx("div",{className:`absolute left-0 w-12 h-12 rounded-full flex items-center justify-center ${h(_==null?void 0:_.type)}`,children:o.jsx(Y,{name:f(_==null?void 0:_.type),size:20})}),o.jsxs("div",{className:"card p-4",children:[o.jsxs("div",{className:"flex justify-between items-start mb-2",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("h4",{className:"font-medium text-text-primary",children:[(_==null?void 0:_.type)==="email"&&"Email: ",(_==null?void 0:_.type)==="call"&&"Call: ",(_==null?void 0:_.type)==="meeting"&&"Meeting: ",(_==null?void 0:_.subject)||(_==null?void 0:_.summary)]}),o.jsxs("div",{className:"flex items-center space-x-2 text-sm text-text-tertiary mt-1",children:[o.jsx("span",{children:m((_==null?void 0:_.scheduled_at)||(_==null?void 0:_.created_at))}),(_==null?void 0:_.duration_minutes)&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsxs("span",{children:[_==null?void 0:_.duration_minutes," minutes"]})]}),(_==null?void 0:_.user)&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsxs("span",{className:"flex items-center space-x-1",children:[o.jsx(Y,{name:"User",size:12}),o.jsx("span",{children:typeof _.user=="string"?_.user:`${_.user.first_name} ${_.user.last_name}`})]})]})]})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>g(_),className:"text-text-tertiary hover:text-text-primary",title:"Edit activity",children:o.jsx(Y,{name:"Edit",size:14})}),o.jsx("button",{className:"text-text-tertiary hover:text-error",title:"Delete activity",children:o.jsx(Y,{name:"Trash2",size:14})})]})]}),(_==null?void 0:_.description)&&o.jsx("div",{className:"text-text-primary text-sm mt-2",children:_==null?void 0:_.description}),(_==null?void 0:_.summary)&&!(_!=null&&_.subject)&&o.jsx("div",{className:"text-text-primary text-sm mt-2",children:_==null?void 0:_.summary})]})]},_==null?void 0:_.id))})]}):o.jsxs("div",{className:"text-center py-12 border border-dashed border-border rounded-lg",children:[o.jsx(Y,{name:"Calendar",size:32,className:"text-text-tertiary mx-auto mb-3"}),o.jsx("h4",{className:"text-lg font-medium text-text-primary mb-1",children:"No activities found"}),o.jsx("p",{className:"text-text-secondary mb-4",children:i==="all"?"There are no activities recorded for this contact yet.":`There are no ${i} activities recorded for this contact.`}),o.jsxs("button",{className:"btn-primary inline-flex items-center space-x-2",onClick:v,children:[o.jsx(Y,{name:"Plus",size:16}),o.jsx("span",{children:"Log an Activity"})]})]}),l&&o.jsx(wH,{isOpen:l,onClose:y,onActivityAdded:x,onActivityUpdated:p,editingActivity:u,prefilledData:t?{contact_id:t.id}:{}})]})},EWe=({deals:e,contactName:t,loading:r=!1})=>{const n=s=>{var l;return(l=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}))==null?void 0:l.format(s)},a=s=>{var l;switch(s){case"discovery":return"Discovery";case"proposal":return"Proposal";case"negotiation":return"Negotiation";case"closed-won":return"Closed Won";case"closed-lost":return"Closed Lost";default:return((l=s==null?void 0:s.charAt(0))==null?void 0:l.toUpperCase())+(s==null?void 0:s.slice(1))}},i=s=>{switch(s){case"discovery":return"bg-primary-50 text-primary";case"proposal":return"bg-secondary-50 text-secondary";case"negotiation":return"bg-warning-50 text-warning";case"closed-won":return"bg-success-50 text-success";case"closed-lost":return"bg-error-50 text-error";default:return"bg-gray-100 text-gray-600"}};return o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Deals"}),o.jsxs(Ur,{to:"/deal-management",className:"inline-flex items-center space-x-2 px-3 py-1 border border-border rounded-md text-text-secondary hover:text-primary hover:border-primary transition-all duration-150 ease-out text-sm",children:[o.jsx(Y,{name:"Plus",size:14}),o.jsx("span",{children:"Add Deal"})]})]}),r?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),o.jsx("p",{className:"text-text-secondary",children:"Loading deals..."})]}):(e==null?void 0:e.length)>0?o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-border",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 bg-surface-hover text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Deal Name"}),o.jsx("th",{className:"px-4 py-3 bg-surface-hover text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Stage"}),o.jsx("th",{className:"px-4 py-3 bg-surface-hover text-right text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Value"}),o.jsx("th",{className:"px-4 py-3 bg-surface-hover text-right text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-surface divide-y divide-border",children:e==null?void 0:e.map(s=>o.jsxs("tr",{className:"hover:bg-surface-hover",children:[o.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:o.jsx("div",{className:"text-sm font-medium text-text-primary",children:s==null?void 0:s.name})}),o.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:o.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${i(s==null?void 0:s.stage)}`,children:a(s==null?void 0:s.stage)})}),o.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-right text-sm text-text-primary font-medium",children:n(s==null?void 0:s.value)}),o.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-right text-sm",children:o.jsx(Ur,{to:`/deal-management?deal=${s==null?void 0:s.id}`,className:"text-primary hover:text-primary-700",children:"View Details"})})]},s==null?void 0:s.id))})]})}):o.jsxs("div",{className:"text-center py-12 border border-dashed border-border rounded-lg",children:[o.jsx(Y,{name:"Target",size:32,className:"text-text-tertiary mx-auto mb-3"}),o.jsx("h4",{className:"text-lg font-medium text-text-primary mb-1",children:"No deals found"}),o.jsxs("p",{className:"text-text-secondary mb-4",children:[t," doesn't have any deals associated yet."]}),o.jsxs(Ur,{to:"/deal-management",className:"btn-primary inline-flex items-center space-x-2",children:[o.jsx(Y,{name:"Plus",size:16}),o.jsx("span",{children:"Create a Deal"})]})]})]})},y0={async getContactNotes(e){try{const{data:t,error:r}=await be.get(`/api/v1/notes/contact/${e}`);if(r)throw r;return t||[]}catch(t){throw console.error("Error fetching contact notes:",t),t}},async createNote(e){try{const{data:t,error:r}=await be.post("/api/v1/notes",e);if(r)throw r;return t}catch(t){throw console.error("Error creating note:",t),t}},async updateNote(e,t){try{const{data:r,error:n}=await be.put(`/api/v1/notes/${e}`,t);if(n)throw n;return r}catch(r){throw console.error("Error updating note:",r),r}},async deleteNote(e){try{const{data:t,error:r}=await be.delete(`/api/v1/notes/${e}`);if(r)throw r;return t}catch(t){throw console.error("Error deleting note:",t),t}}},TWe=({contact:e,onNotesCountChange:t})=>{const{user:r}=Vt(),[n,a]=M.useState([]),[i,s]=M.useState(!0),[l,c]=M.useState(""),[u,d]=M.useState(!1),[f,h]=M.useState(null),[m,x]=M.useState({title:"",content:""});M.useEffect(()=>{t&&t(n.length)},[n.length,t]),M.useEffect(()=>{(async()=>{if(e!=null&&e.id)try{s(!0),c("");const _=await y0.getContactNotes(e.id);a(_)}catch(_){console.error("Error loading notes:",_),c("Failed to load notes. Please try again.")}finally{s(!1)}})()},[e==null?void 0:e.id]);const p=async()=>{if(!m.content.trim()){c("Note content is required");return}try{c("");const w={title:m.title.trim()||null,content:m.content.trim(),contact_id:e.id},_=await y0.createNote(w);a([_,...n]),x({title:"",content:""}),d(!1)}catch(w){console.error("Error creating note:",w),c("Failed to create note. Please try again.")}},g=async()=>{if(!f.content.trim()){c("Note content is required");return}try{c("");const w={title:f.title.trim()||null,content:f.content.trim()},_=await y0.updateNote(f.id,w);a(n.map(D=>D.id===f.id?_:D)),h(null)}catch(w){console.error("Error updating note:",w),c("Failed to update note. Please try again.")}},v=async w=>{if(window.confirm("Are you sure you want to delete this note?"))try{c(""),await y0.deleteNote(w),a(n.filter(_=>_.id!==w))}catch(_){console.error("Error deleting note:",_),c("Failed to delete note. Please try again.")}},y=w=>{try{return Si(new Date(w),"MMM d, yyyy  h:mm a")}catch{return"Invalid date"}},b=w=>(r==null?void 0:r.id)===w.created_by;return i?o.jsxs("div",{className:"flex items-center justify-center py-8",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),o.jsx("span",{className:"ml-3 text-text-secondary",children:"Loading notes..."})]}):o.jsxs("div",{className:"space-y-6",children:[l&&o.jsxs("div",{className:"bg-error-50 border border-error-200 text-error p-4 rounded-lg flex items-center space-x-2",children:[o.jsx(Y,{name:"AlertCircle",size:20}),o.jsx("span",{children:l}),o.jsx("button",{onClick:()=>c(""),className:"ml-auto text-error hover:text-error-600",children:o.jsx(Y,{name:"X",size:16})})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("h3",{className:"text-lg font-semibold text-text-primary",children:["Notes (",n.length,")"]}),o.jsxs("button",{onClick:()=>d(!0),className:"btn-primary inline-flex items-center space-x-2",children:[o.jsx(Y,{name:"Plus",size:16}),o.jsx("span",{children:"Add Note"})]})]}),u&&o.jsx("div",{className:"card p-4 border-2 border-primary-200",children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("input",{type:"text",placeholder:"Note title (optional)",value:m.title,onChange:w=>x({...m,title:w.target.value}),className:"input-field"}),o.jsx("textarea",{placeholder:"Write your note here...",value:m.content,onChange:w=>x({...m,content:w.target.value}),className:"input-field h-32 resize-none",autoFocus:!0}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx("button",{onClick:()=>{d(!1),x({title:"",content:""}),c("")},className:"px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary transition-colors",children:"Cancel"}),o.jsx("button",{onClick:p,className:"btn-primary",children:"Save Note"})]})]})}),n.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Y,{name:"FileText",size:32,className:"text-text-tertiary mx-auto mb-3"}),o.jsx("p",{className:"text-text-secondary",children:"No notes available"}),o.jsx("p",{className:"text-text-tertiary text-sm mt-1",children:"Add a note to keep track of important information about this contact"})]}):o.jsx("div",{className:"space-y-4",children:n.map(w=>o.jsx("div",{className:"card p-4",children:(f==null?void 0:f.id)===w.id?o.jsxs("div",{className:"space-y-4",children:[o.jsx("input",{type:"text",placeholder:"Note title (optional)",value:f.title||"",onChange:_=>h({...f,title:_.target.value}),className:"input-field"}),o.jsx("textarea",{placeholder:"Write your note here...",value:f.content,onChange:_=>h({...f,content:_.target.value}),className:"input-field h-32 resize-none"}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx("button",{onClick:()=>{h(null),c("")},className:"px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary transition-colors",children:"Cancel"}),o.jsx("button",{onClick:g,className:"btn-primary",children:"Save Changes"})]})]}):o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between items-start mb-3",children:[o.jsxs("div",{className:"flex-1",children:[w.title&&o.jsx("h4",{className:"font-medium text-text-primary mb-1",children:w.title}),o.jsxs("div",{className:"flex items-center text-sm text-text-secondary",children:[o.jsx("span",{children:w.author?`${w.author.first_name} ${w.author.last_name}`:"Unknown User"}),o.jsx("span",{className:"mx-2",children:""}),o.jsx("span",{children:y(w.created_at)}),w.updated_at!==w.created_at&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"mx-2",children:""}),o.jsx("span",{className:"text-text-tertiary",children:"edited"})]})]})]}),b(w)&&o.jsxs("div",{className:"flex space-x-2 ml-4",children:[o.jsx("button",{onClick:()=>h({...w}),className:"text-text-tertiary hover:text-primary transition-colors",title:"Edit note",children:o.jsx(Y,{name:"Edit",size:16})}),o.jsx("button",{onClick:()=>v(w.id),className:"text-text-tertiary hover:text-error transition-colors",title:"Delete note",children:o.jsx(Y,{name:"Trash2",size:16})})]})]}),o.jsx("p",{className:"text-text-primary whitespace-pre-wrap",children:w.content})]})},w.id))})]})},es={getTemplates:async(e={})=>{try{const t=new URLSearchParams;e.search&&t.append("search",e.search),e.category&&t.append("category",e.category),e.status&&t.append("status",e.status),e.limit&&t.append("limit",e.limit),e.offset&&t.append("offset",e.offset);const r=`/api/v1/email-templates${t.toString()?"?"+t.toString():""}`,{data:n,error:a}=await be.get(r);if(a)throw a;return n}catch(t){throw console.error("Error fetching email templates:",t),t}},getTemplate:async e=>{try{const{data:t,error:r}=await be.get(`/api/v1/email-templates/${e}`);if(r)throw r;return t}catch(t){throw console.error("Error fetching email template:",t),t}},createTemplate:async e=>{try{const{data:t,error:r}=await be.post("/api/v1/email-templates",e);if(r)throw r;return t}catch(t){throw console.error("Error creating email template:",t),t}},updateTemplate:async(e,t)=>{try{const{data:r,error:n}=await be.put(`/api/v1/email-templates/${e}`,t);if(n)throw n;return r}catch(r){throw console.error("Error updating email template:",r),r}},deleteTemplate:async e=>{try{const{data:t,error:r}=await be.delete(`/api/v1/email-templates/${e}`);if(r)throw r;return t}catch(t){throw console.error("Error deleting email template:",t),t}},previewTemplate:async(e,t,r=null,n=null,a=null,i=null)=>{try{const{data:s,error:l}=await be.post("/api/v1/email-templates/preview",{template_id:e,merge_data:t,contact_id:r,deal_id:n,activity_id:a,task_id:i});if(l)throw l;return s}catch(s){throw console.error("Error previewing email template:",s),s}},sendEmail:async e=>{try{if(e instanceof FormData){const{data:r,error:n}=await be.post("/api/v1/email-templates/send-with-attachments",e,{headers:{"Content-Type":"multipart/form-data"}});if(n)throw n;return r}else{const{data:r,error:n}=await be.post("/api/v1/email-templates/send",e);if(n)throw n;return r}}catch(t){throw console.error("Error sending email:",t),t}},getMergeFields:async()=>{try{const{data:e,error:t}=await be.get("/api/v1/email-templates/merge-fields");if(t)throw t;return e}catch(e){throw console.error("Error fetching merge fields:",e),e}},getEmailLogs:async(e={})=>{try{const t=new URLSearchParams;e.templateId&&t.append("template_id",e.templateId),e.status&&t.append("status",e.status),e.limit&&t.append("limit",e.limit),e.offset&&t.append("offset",e.offset);const r=`/api/v1/email-templates/logs${t.toString()?"?"+t.toString():""}`,{data:n,error:a}=await be.get(r);if(a)throw a;return n}catch(t){throw console.error("Error fetching email logs:",t),t}},processMergeFields:(e,t)=>{if(!e||!t)return e;let r=e;return Object.entries(t).forEach(([n,a])=>{const i=new RegExp(`{{${n}}}`,"g");r=r.replace(i,a||"")}),r},validateTemplate:(e,t)=>{const r=/{{([^}]+)}}/g,n=`${e} ${t}`,a=[];let i;for(;(i=r.exec(n))!==null;)a.includes(i[1])||a.push(i[1]);return a},getCategories:()=>[{value:"general",label:"General"},{value:"onboarding",label:"Onboarding"},{value:"followup",label:"Follow-up"},{value:"closing",label:"Deal Closing"},{value:"nurturing",label:"Lead Nurturing"},{value:"reminder",label:"Reminders"}],getStatuses:()=>[{value:"draft",label:"Draft"},{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}]},kWe="AIzaSyAqVlX6UAVc9AqppYlv4ZuS52TX0jU1SgM",CWe="https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent";class AWe{async generateEmailContent(t,r="",n=""){var a,i,s,l,c,u,d;try{const f=r.trim()||n.trim();let h;f?h=this.createEnhancementPrompt(t,r,n):h=this.createTemplatePrompt(t);const m=await Wr.post(`${CWe}?key=${kWe}`,{contents:[{parts:[{text:h}]}],generationConfig:{temperature:.7,topK:40,topP:.95,maxOutputTokens:1024}},{headers:{"Content-Type":"application/json"}});if(!m.data||!m.data.candidates||!m.data.candidates[0])throw console.error("Invalid response structure:",m.data),new Error("Invalid response from Gemini API");const x=m.data.candidates[0];if(!x.content||!x.content.parts||!x.content.parts[0])throw console.error("Invalid content structure:",x),new Error("Invalid content structure from Gemini API");const p=x.content.parts[0].text;return this.parseEmailContent(p)}catch(f){if(console.error("Gemini API Error:",f),console.error("Error response:",(a=f.response)==null?void 0:a.data),((i=f.response)==null?void 0:i.status)===400){const h=((l=(s=f.response.data)==null?void 0:s.error)==null?void 0:l.message)||"Invalid request";throw new Error(`Invalid request to Gemini API: ${h}`)}else throw((c=f.response)==null?void 0:c.status)===403?new Error("Gemini API key is invalid or has no quota remaining."):((u=f.response)==null?void 0:u.status)===429?new Error("Too many requests to Gemini API. Please try again later."):((d=f.response)==null?void 0:d.status)===404?new Error("Gemini API endpoint not found. The model may have been updated."):new Error(`Failed to generate email content: ${f.message}`)}}createEnhancementPrompt(t,r,n){return`You are a professional email assistant. Please enhance and improve the following email content while maintaining the original intent and message.

Contact Information:
- Name: ${(t==null?void 0:t.first_name)||""} ${(t==null?void 0:t.last_name)||""}
- Company: ${(t==null?void 0:t.company_name)||"their company"}
- Email: ${(t==null?void 0:t.email)||""}

Current Email Content:
Subject: "${r}"
Body: "${n}"

Please enhance this email by:
1. Making the subject line more compelling and professional
2. Improving the body content for clarity, professionalism, and engagement
3. Adding appropriate greetings and closing if missing
4. Ensuring proper business email etiquette
5. Maintaining the original intent and key messages

Respond in this exact JSON format:
{
  "subject": "Enhanced subject line here",
  "body": "Enhanced email body here with proper formatting and professional tone"
}`}createTemplatePrompt(t){return`You are a professional email assistant. Create a professional business email template for a CRM system.

Contact Information:
- Name: ${(t==null?void 0:t.first_name)||"the contact"} ${(t==null?void 0:t.last_name)||""}
- Company: ${(t==null?void 0:t.company_name)||"their company"}
- Email: ${(t==null?void 0:t.email)||""}

Please create a professional business email that:
1. Has a compelling and relevant subject line
2. Includes a proper greeting using the contact's name
3. Has a professional introduction or opening
4. Includes a clear purpose/call to action
5. Has an appropriate professional closing
6. Is suitable for business relationship building or follow-up

The tone should be:
- Professional but friendly
- Clear and concise
- Appropriate for business communication
- Personalized using the contact information

Respond in this exact JSON format:
{
  "subject": "Professional subject line here",
  "body": "Complete professional email body here with proper greeting, content, and closing"
}`}parseEmailContent(t){try{const r=t.match(/\{[\s\S]*\}/);if(r){const i=JSON.parse(r[0]);return{subject:i.subject||"Professional Follow-up",body:i.body||"Thank you for your time. I look forward to hearing from you soon."}}const n=t.match(/["'']?subject["'']?\s*:\s*["'']([^"'']+)["'']/i),a=t.match(/["'']?body["'']?\s*:\s*["'']([^"'']+)["'']/i);return{subject:n?n[1]:"Professional Follow-up",body:a?a[1]:"Thank you for your time. I look forward to hearing from you soon."}}catch(r){return console.error("Error parsing Gemini response:",r),{subject:"Professional Follow-up",body:"Thank you for your time. I look forward to hearing from you soon."}}}}const OWe=new AWe,FWe=({contact:e,onClose:t,onSend:r})=>{const[n,a]=M.useState({to:e==null?void 0:e.email,subject:"",body:"",cc:"",bcc:""}),[i,s]=M.useState([]),[l,c]=M.useState(""),[u,d]=M.useState(!1),[f,h]=M.useState(!1),[m,x]=M.useState(!1),[p,g]=M.useState(null),[v,y]=M.useState(!1),[b,w]=M.useState(""),[_,D]=M.useState([]),[j,N]=M.useState([]),[S,E]=M.useState(null),[A,T]=M.useState([]),[L,O]=M.useState(null),[V,W]=M.useState([]),[B,P]=M.useState(null),[F,I]=M.useState({hasContactFields:!1,hasDealFields:!1,hasActivityFields:!1,hasTaskFields:!1});M.useEffect(()=>{C(),k(),R()},[e]);const R=async()=>{try{const G=await mo.getCompanyEmail();w(G)}catch(G){console.error("Failed to load company email:",G),w("noreply@company.com")}},C=async()=>{try{const G=await es.getTemplates();s(G.templates||[])}catch(G){console.error("Failed to load templates:",G)}},k=async()=>{if(e!=null&&e.id)try{const ce=(await gt.getUserDeals()).filter(oe=>{var ge;return oe.contact_id===e.id||((ge=oe.contact)==null?void 0:ge.id)===e.id});if(ce&&ce.length>0){const oe=ce.sort((ge,ye)=>new Date(ye.created_at)-new Date(ge.created_at));N(oe),E(oe[0])}const ue=(await ei.getUserActivities(100)).filter(oe=>{var ge;return oe.contact_id===e.id||((ge=oe.contact)==null?void 0:ge.id)===e.id});if(ue&&ue.length>0){const oe=ue.sort((ge,ye)=>new Date(ye.created_at)-new Date(ge.created_at));T(oe),O(oe[0])}const te=(await tCe.getUserTasks()).filter(oe=>{var ge;return oe.contact_id===e.id||((ge=oe.contact)==null?void 0:ge.id)===e.id});if(te&&te.length>0){const oe=te.sort((ge,ye)=>new Date(ye.created_at)-new Date(ge.created_at));W(oe),P(oe[0])}}catch(G){console.error("Failed to load related entities:",G)}},z=G=>{if(!G)return;const ce=(G.subject||"")+" "+(G.content||""),J=/\{\{deal_name\}\}/i.test(ce)||/\{\{deal_value\}\}/i.test(ce)||/\{\{deal_stage\}\}/i.test(ce)||/\{\{custom_budget_range\}\}/i.test(ce)||/\{\{custom_deal_priority[_0-9]*\}\}/i.test(ce)||/\{\{custom_deal_or_no_deal\}\}/i.test(ce),ue=/\{\{custom_detailed_desc\}\}/i.test(ce)||/\{\{custom_football\}\}/i.test(ce),me=/\{\{custom_followup_date\}\}/i.test(ce);I({hasContactFields:!0,hasDealFields:J,hasActivityFields:ue,hasTaskFields:me})},q=G=>{const{name:ce,value:J}=G==null?void 0:G.target;a({...n,[ce]:J})},K=async G=>{var ce;if(c(G),!G){I({hasContactFields:!1,hasDealFields:!1,hasActivityFields:!1,hasTaskFields:!1});return}try{const J=i.find(te=>te.id===G);J&&z(J);const ue={first_name:(e==null?void 0:e.first_name)||"",last_name:(e==null?void 0:e.last_name)||"",full_name:`${(e==null?void 0:e.first_name)||""} ${(e==null?void 0:e.last_name)||""}`.trim(),email:(e==null?void 0:e.email)||"",phone:(e==null?void 0:e.phone)||"",company_name:((ce=e==null?void 0:e.company)==null?void 0:ce.name)||"",position:(e==null?void 0:e.position)||""},me=await es.previewTemplate(G,ue,(e==null?void 0:e.id)||null,(S==null?void 0:S.id)||null,(L==null?void 0:L.id)||null,(B==null?void 0:B.id)||null);a(te=>({...te,subject:me.subject,body:me.content}))}catch(J){console.error("Failed to load template:",J),alert("Failed to load template")}},se=async G=>{const ce=j.find(J=>J.id===G);E(ce||null),l&&await K(l)},ie=async G=>{const ce=A.find(J=>J.id===G);O(ce||null),l&&await K(l)},ee=async G=>{const ce=V.find(J=>J.id===G);P(ce||null),l&&await K(l)},ae=async G=>{var ce,J,ue,me;G==null||G.preventDefault(),h(!0);try{let te;if(_.length>0){const ge=new FormData;ge.append("to",n.to),ge.append("subject",n.subject),ge.append("content",n.body),n.cc&&n.cc.split(",").map(Ce=>Ce.trim()).forEach(Ce=>{ge.append("cc",Ce)}),n.bcc&&n.bcc.split(",").map(Ce=>Ce.trim()).forEach(Ce=>{ge.append("bcc",Ce)}),_.forEach(ye=>{ge.append("attachments",ye.file)}),te=ge}else te={to:n.to,subject:n.subject,content:n.body,cc:n.cc?n.cc.split(",").map(ge=>ge.trim()):void 0,bcc:n.bcc?n.bcc.split(",").map(ge=>ge.trim()):void 0,template_id:l||void 0,merge_data:{first_name:(e==null?void 0:e.first_name)||"",last_name:(e==null?void 0:e.last_name)||"",full_name:`${(e==null?void 0:e.first_name)||""} ${(e==null?void 0:e.last_name)||""}`.trim(),email:(e==null?void 0:e.email)||"",phone:(e==null?void 0:e.phone)||"",company_name:((ce=e==null?void 0:e.company)==null?void 0:ce.name)||"",position:(e==null?void 0:e.position)||""}};const oe=await es.sendEmail(te);oe!=null&&oe.success&&(oe!=null&&oe.sender_email),r({...n,timestamp:(J=new Date)==null?void 0:J.toISOString(),contactId:e==null?void 0:e.id,status:oe!=null&&oe.success?"sent":"failed",sender_email:oe==null?void 0:oe.sender_email,attachments:_.map(ge=>({name:ge.name,size:ge.size,type:ge.type}))}),t()}catch(te){console.error("Email sending failed:",te);let oe="Failed to send email. Please try again.";(me=(ue=te.response)==null?void 0:ue.data)!=null&&me.detail?oe=`Failed to send email: ${te.response.data.detail}`:te.message&&(oe=`Failed to send email: ${te.message}`),alert(oe)}finally{h(!1)}},pe=async()=>{var G,ce;try{x(!0);const J=await OWe.generateEmailContent(e,n.subject,n.body);g(J),y(!0)}catch(J){console.error(" Failed to generate email content:",J),console.error("Error details:",{message:J.message,response:(G=J.response)==null?void 0:G.data,status:(ce=J.response)==null?void 0:ce.status});let ue="Failed to generate email content.";J.message.includes("not configured")?ue=" Gemini API key is not configured. Please restart the dev server.":J.message.includes("invalid")?ue=" Gemini API key is invalid. Please check your configuration.":J.message.includes("quota")?ue=" Gemini API quota exceeded. Please try again later.":ue=`Failed to generate email: ${J.message}`,alert(ue)}finally{x(!1)}},H=()=>{p&&(a({...n,subject:p.subject,body:p.body}),y(!1),g(null))},ne=()=>{y(!1),g(null)},U=G=>{const ce=Array.from(G.target.files);if(ce.length===0)return;const J=10*1024*1024,ue=ce.filter(te=>te.size>J?(alert(`File "${te.name}" is too large. Maximum size is 10MB.`),!1):!0);if(ue.length===0)return;const me=ue.map(te=>({file:te,name:te.name,size:te.size,type:te.type,id:Math.random().toString(36).substr(2,9)}));D(te=>[...te,...me]),G.target.value=""},le=G=>{D(ce=>ce.filter(J=>J.id!==G))},re=G=>{if(G===0)return"0 Bytes";const ce=1024,J=["Bytes","KB","MB","GB"],ue=Math.floor(Math.log(G)/Math.log(ce));return Math.round(G/Math.pow(ce,ue)*100)/100+" "+J[ue]},X=G=>G.startsWith("image/")?"Image":G.includes("pdf")||G.includes("word")||G.includes("document")?"FileText":G.includes("sheet")||G.includes("excel")?"Table":G.includes("presentation")||G.includes("powerpoint")?"Presentation":G.includes("zip")||G.includes("rar")||G.includes("7z")?"Archive":"File";return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-1100 overflow-y-auto",children:o.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[o.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:o.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50"})}),o.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:""}),o.jsx("div",{className:"inline-block align-bottom bg-surface rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full md:max-w-2xl",children:o.jsxs("form",{onSubmit:ae,children:[o.jsxs("div",{className:"px-6 py-4 border-b border-border flex justify-between items-center",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Compose Email"}),o.jsx("button",{type:"button",onClick:t,className:"text-text-secondary hover:text-text-primary",children:o.jsx(Y,{name:"X",size:20})})]}),o.jsx("div",{className:"px-6 py-5",children:o.jsxs("div",{className:"space-y-4",children:[b&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"From"}),o.jsxs("div",{className:"flex items-center px-3 py-2 bg-surface-secondary rounded-lg border border-border",children:[o.jsx(Y,{name:"Mail",size:16,className:"text-text-tertiary mr-2"}),o.jsx("span",{className:"text-sm text-text-primary",children:b}),o.jsx("span",{className:"ml-2 text-xs text-text-tertiary",children:"(Company Email)"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"To"}),o.jsx("div",{className:"flex items-center",children:o.jsx("input",{type:"email",name:"to",value:n==null?void 0:n.to,onChange:q,className:"input-field",readOnly:!0})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Email Template (Optional)"}),o.jsxs("select",{value:l,onChange:G=>K(G.target.value),className:"input-field",children:[o.jsx("option",{value:"",children:"Select a template..."}),i.map(G=>o.jsxs("option",{value:G.id,children:[G.name," ",G.status==="draft"?"(Draft)":G.status==="inactive"?"(Inactive)":""]},G.id))]}),l&&o.jsxs("p",{className:"text-xs text-text-tertiary mt-1",children:["Template content will be merged with contact information",S&&` and deal "${S.name}"`]})]}),l&&F.hasDealFields&&j.length>0&&o.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[o.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2 flex items-center gap-2",children:[o.jsx(Y,{name:"Briefcase",size:16}),"Select Deal for Merge Fields"]}),o.jsxs("select",{value:(S==null?void 0:S.id)||"",onChange:G=>se(G.target.value),className:"input-field",children:[o.jsx("option",{value:"",children:"No deal selected"}),j.map(G=>{var ce;return o.jsxs("option",{value:G.id,children:[G.name," - $",((ce=G.value)==null?void 0:ce.toLocaleString())||"0"," (",G.stage,")"]},G.id)})]}),o.jsx("p",{className:"text-xs text-text-tertiary mt-2",children:"This template contains deal merge fields. Select which deal to use."})]}),l&&F.hasActivityFields&&A.length>0&&o.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4",children:[o.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2 flex items-center gap-2",children:[o.jsx(Y,{name:"Calendar",size:16}),"Select Activity for Merge Fields"]}),o.jsxs("select",{value:(L==null?void 0:L.id)||"",onChange:G=>ie(G.target.value),className:"input-field",children:[o.jsx("option",{value:"",children:"No activity selected"}),A.map(G=>o.jsxs("option",{value:G.id,children:[G.subject," - ",G.type," (",new Date(G.created_at).toLocaleDateString(),")"]},G.id))]}),o.jsx("p",{className:"text-xs text-text-tertiary mt-2",children:"This template contains activity merge fields. Select which activity to use."})]}),l&&F.hasTaskFields&&V.length>0&&o.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-lg p-4",children:[o.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2 flex items-center gap-2",children:[o.jsx(Y,{name:"CheckSquare",size:16}),"Select Task for Merge Fields"]}),o.jsxs("select",{value:(B==null?void 0:B.id)||"",onChange:G=>ee(G.target.value),className:"input-field",children:[o.jsx("option",{value:"",children:"No task selected"}),V.map(G=>o.jsxs("option",{value:G.id,children:[G.title," - ",G.status," (",G.due_date?new Date(G.due_date).toLocaleDateString():"No due date",")"]},G.id))]}),o.jsx("p",{className:"text-xs text-text-tertiary mt-2",children:"This template contains task merge fields. Select which task to use."})]}),u&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Cc"}),o.jsx("input",{type:"text",name:"cc",value:n==null?void 0:n.cc,onChange:q,placeholder:"email@example.com, another@example.com",className:"input-field"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Bcc"}),o.jsx("input",{type:"text",name:"bcc",value:n==null?void 0:n.bcc,onChange:q,placeholder:"email@example.com, another@example.com",className:"input-field"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Subject"}),o.jsx("input",{type:"text",name:"subject",value:n==null?void 0:n.subject,onChange:q,placeholder:"Enter email subject",className:"input-field",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Message"}),o.jsx("textarea",{name:"body",value:n==null?void 0:n.body,onChange:q,rows:8,placeholder:"Write your message here...",className:"input-field",required:!0})]}),_.length>0&&o.jsxs("div",{className:"border border-border rounded-lg p-4 bg-surface-hover",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("label",{className:"block text-sm font-medium text-text-primary",children:["Attachments (",_.length,")"]}),o.jsxs("span",{className:"text-xs text-text-tertiary",children:["Total: ",re(_.reduce((G,ce)=>G+ce.size,0))]})]}),o.jsx("div",{className:"space-y-2",children:_.map(G=>o.jsxs("div",{className:"flex items-center justify-between p-2 bg-surface border border-border rounded-lg hover:border-primary transition-colors",children:[o.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(Y,{name:X(G.type),size:20,className:"text-primary"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-sm font-medium text-text-primary truncate",children:G.name}),o.jsx("p",{className:"text-xs text-text-tertiary",children:re(G.size)})]})]}),o.jsx("button",{type:"button",onClick:()=>le(G.id),className:"ml-2 p-1 text-error hover:bg-error-light rounded transition-colors",title:"Remove attachment",children:o.jsx(Y,{name:"X",size:16})})]},G.id))})]})]})}),o.jsxs("div",{className:"px-6 py-4 border-t border-border flex justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("button",{type:"button",onClick:()=>d(!u),className:"text-text-secondary hover:text-text-primary text-sm",children:[u?"Hide":"Show"," Cc/Bcc"]}),o.jsx("button",{type:"button",onClick:pe,disabled:m,className:"inline-flex items-center px-3 py-1.5 bg-gradient-to-r from-purple-500 to-indigo-500 text-white rounded-md hover:from-purple-600 hover:to-indigo-600 transition-all duration-150 ease-out text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:m?o.jsxs(o.Fragment,{children:[o.jsx(Y,{name:"Loader",size:14,className:"animate-spin mr-1.5"}),"Generating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Y,{name:"Sparkles",size:14,className:"mr-1.5"}),"Generate Email"]})}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"file",id:"file-attachment",multiple:!0,onChange:U,className:"hidden",accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.csv,.zip,.rar,.7z"}),o.jsxs("label",{htmlFor:"file-attachment",className:"inline-flex items-center px-3 py-1.5 text-text-secondary hover:text-text-primary hover:bg-surface-hover rounded-md cursor-pointer transition-all duration-150 ease-out",title:"Attach files (PDF, DOC, XLS, etc.)",children:[o.jsx(Y,{name:"Paperclip",size:16}),_.length>0&&o.jsx("span",{className:"ml-1 text-xs bg-primary text-white rounded-full px-1.5 py-0.5",children:_.length})]})]}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"file",id:"image-attachment",multiple:!0,onChange:U,className:"hidden",accept:"image/*"}),o.jsx("label",{htmlFor:"image-attachment",className:"inline-flex items-center px-3 py-1.5 text-text-secondary hover:text-text-primary hover:bg-surface-hover rounded-md cursor-pointer transition-all duration-150 ease-out",title:"Attach images",children:o.jsx(Y,{name:"Image",size:16})})]})]}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-out",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:f||!(n!=null&&n.subject)||!(n!=null&&n.body),className:`btn-primary inline-flex items-center ${f||!(n!=null&&n.subject)||!(n!=null&&n.body)?"opacity-50 cursor-not-allowed":""}`,children:f?o.jsxs(o.Fragment,{children:[o.jsx(Y,{name:"Loader",size:16,className:"animate-spin mr-2"}),"Sending..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Y,{name:"Send",size:16,className:"mr-2"}),"Send Email"]})})]})]})]})})]})}),v&&p&&o.jsx("div",{className:"fixed inset-0 z-1200 overflow-y-auto",children:o.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[o.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:o.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50"})}),o.jsxs("div",{className:"inline-block align-bottom bg-surface rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[o.jsx("div",{className:"bg-surface px-6 py-4 border-b border-border",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(Y,{name:"Sparkles",size:20,className:"text-purple-500 mr-2"}),o.jsx("h3",{className:"text-lg font-medium text-text-primary",children:"Generated Email Content"})]}),o.jsx("button",{onClick:ne,className:"text-text-secondary hover:text-text-primary",children:o.jsx(Y,{name:"X",size:20})})]})}),o.jsx("div",{className:"bg-surface px-6 py-4 max-h-96 overflow-y-auto",children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Generated Subject:"}),o.jsx("div",{className:"p-3 bg-surface-secondary border border-border rounded-lg",children:o.jsx("p",{className:"text-text-primary",children:p.subject})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Generated Body:"}),o.jsx("div",{className:"p-3 bg-surface-secondary border border-border rounded-lg",children:o.jsx("div",{className:"text-text-primary whitespace-pre-wrap",children:p.body})})]})]})}),o.jsx("div",{className:"bg-surface px-6 py-4 border-t border-border",children:o.jsxs("div",{className:"flex space-x-3 justify-end",children:[o.jsx("button",{onClick:ne,className:"px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-out",children:"Discard"}),o.jsxs("button",{onClick:H,className:"btn-primary inline-flex items-center",children:[o.jsx(Y,{name:"Check",size:16,className:"mr-2"}),"Use This Content"]})]})})]})]})})]})},PWe=({contact:e,onEdit:t,onDelete:r,onContactUpdate:n})=>{var S,E,A,T,L,O,V,W,B;const[a,i]=M.useState("overview"),[s,l]=M.useState(!1),[c,u]=M.useState([]),[d,f]=M.useState(!1),[h,m]=M.useState([]),[x,p]=M.useState(!1),[g,v]=M.useState(0),{hasAnyPermission:y}=Vt();if(!e)return null;M.useEffect(()=>{(async()=>{if(e!=null&&e.id)try{f(!0);const I=(await ei.getUserActivities()).filter(R=>R.contact_id===e.id);u(I)}catch(F){console.error("Error fetching contact activities:",F),u([])}finally{f(!1)}})()},[e==null?void 0:e.id]),M.useEffect(()=>{(async()=>{if(e!=null&&e.id)try{p(!0);const I=(await gt.getUserDeals()).filter(R=>R.contact_id===e.id);m(I)}catch(F){console.error("Error fetching contact deals:",F),m([])}finally{p(!1)}})()},[e==null?void 0:e.id]);const b=P=>{if(u(F=>[P,...F]),n){const F={...e,activities:[P,...e.activities||[]]};n(F)}},w=P=>{var F;if(u(I=>I.map(R=>R.id===P.id?P:R)),n){const I={...e,activities:(F=e.activities)==null?void 0:F.map(R=>R.id===P.id?P:R)};n(I)}},_=P=>{if(!P)return"Never contacted";try{return Si(new Date(P),"MMM d, yyyy")}catch{return"Invalid date"}},D=P=>{switch(P){case"linkedin":return"Linkedin";case"twitter":return"Twitter";case"facebook":return"Facebook";default:return"Link"}},N=(()=>{const P={};return e!=null&&e.social_linkedin&&(P.linkedin=e==null?void 0:e.social_linkedin),e!=null&&e.social_twitter&&(P.twitter=e==null?void 0:e.social_twitter),P})();return o.jsxs("div",{className:"bg-surface rounded-lg border border-border shadow-sm",children:[o.jsx("div",{className:"p-6 border-b border-border",children:o.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsxs("div",{className:"relative mr-4",children:[o.jsx(Io,{src:(e==null?void 0:e.avatar_url)||"/assets/images/no_image.png",alt:`${(e==null?void 0:e.first_name)||""} ${(e==null?void 0:e.last_name)||""}`,className:"w-16 h-16 rounded-full object-cover"}),o.jsx("span",{className:`absolute bottom-0 right-0 w-4 h-4 rounded-full border-2 border-surface ${(e==null?void 0:e.status)==="active"?"bg-success":"bg-text-tertiary"}`})]}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-bold text-text-primary",children:(e==null?void 0:e.full_name)||((S=`${(e==null?void 0:e.first_name)||""} ${(e==null?void 0:e.last_name)||""}`)==null?void 0:S.trim())||"Unnamed Contact"}),o.jsxs("div",{className:"flex items-center text-text-secondary",children:[o.jsx("span",{children:(e==null?void 0:e.position)||"No position"}),(e==null?void 0:e.company)&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"mx-2",children:""}),e!=null&&e.company_id?o.jsxs(Ur,{to:`/company-management/${e.company_id}`,className:"text-primary hover:underline flex items-center space-x-1",onClick:P=>P.stopPropagation(),children:[o.jsx(Y,{name:"Building2",size:14}),o.jsx("span",{children:e.company.name})]}):o.jsx("span",{children:e.company.name})]})]}),o.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:((E=e==null?void 0:e.tags)==null?void 0:E.map((P,F)=>o.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-50 text-primary",children:P},`${P}-${F}`)))||null})]})]}),o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsxs("button",{onClick:()=>l(!0),className:"inline-flex items-center space-x-2 px-3 py-2 border border-border rounded-lg text-text-secondary hover:text-primary hover:border-primary transition-all duration-150 ease-out",children:[o.jsx(Y,{name:"Mail",size:16}),o.jsx("span",{children:"Email"})]}),y(["contacts.edit_all","contacts.edit_own"])&&o.jsxs("button",{onClick:t,className:"inline-flex items-center space-x-2 px-3 py-2 border border-border rounded-lg text-text-secondary hover:text-primary hover:border-primary transition-all duration-150 ease-out",children:[o.jsx(Y,{name:"Edit",size:16}),o.jsx("span",{children:"Edit"})]}),y(["contacts.delete_all","contacts.delete_own"])&&o.jsx("div",{className:"relative group",children:o.jsx("div",{className:"py-1",children:o.jsxs("button",{onClick:r,className:"flex w-full items-center px-4 py-2 text-sm text-error hover:bg-surface-hover",children:[o.jsx(Y,{name:"Trash2",size:16,className:"mr-2"}),"Delete"]})})})]})]})}),o.jsx("div",{className:"border-b border-border",children:o.jsxs("nav",{className:"flex overflow-x-auto",children:[o.jsx("button",{onClick:()=>i("overview"),className:`px-4 py-3 text-sm font-medium whitespace-nowrap ${a==="overview"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:"Overview"}),o.jsxs("button",{onClick:()=>i("activity"),className:`px-4 py-3 text-sm font-medium whitespace-nowrap ${a==="activity"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:["Activity (",c.length,")"]}),o.jsxs("button",{onClick:()=>i("deals"),className:`px-4 py-3 text-sm font-medium whitespace-nowrap ${a==="deals"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:["Deals (",h.length,")"]}),o.jsxs("button",{onClick:()=>i("notes"),className:`px-4 py-3 text-sm font-medium whitespace-nowrap ${a==="notes"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:["Notes (",g,")"]})]})}),o.jsxs("div",{className:"p-6",children:[a==="overview"&&o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"card p-5",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Contact Information"}),o.jsxs("div",{className:"space-y-4",children:[(e==null?void 0:e.email)&&o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center mb-1",children:[o.jsx(Y,{name:"Mail",size:16,className:"text-text-tertiary mr-2"}),o.jsx("span",{className:"text-sm text-text-secondary",children:"Email"})]}),o.jsx("a",{href:`mailto:${e==null?void 0:e.email}`,className:"text-primary hover:underline",children:e==null?void 0:e.email})]}),(e==null?void 0:e.phone)&&o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center mb-1",children:[o.jsx(Y,{name:"Phone",size:16,className:"text-text-tertiary mr-2"}),o.jsx("span",{className:"text-sm text-text-secondary",children:"Phone"})]}),o.jsx("a",{href:`tel:${e==null?void 0:e.phone}`,className:"text-text-primary",children:e==null?void 0:e.phone})]}),(e==null?void 0:e.mobile)&&o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center mb-1",children:[o.jsx(Y,{name:"Smartphone",size:16,className:"text-text-tertiary mr-2"}),o.jsx("span",{className:"text-sm text-text-secondary",children:"Mobile"})]}),o.jsx("a",{href:`tel:${e==null?void 0:e.mobile}`,className:"text-text-primary",children:e==null?void 0:e.mobile})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center mb-1",children:[o.jsx(Y,{name:"Building",size:16,className:"text-text-tertiary mr-2"}),o.jsx("span",{className:"text-sm text-text-secondary",children:"Company"})]}),o.jsx("span",{className:"text-text-primary",children:((A=e==null?void 0:e.company)==null?void 0:A.name)||"No Company"})]}),(e==null?void 0:e.position)&&o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center mb-1",children:[o.jsx(Y,{name:"Briefcase",size:16,className:"text-text-tertiary mr-2"}),o.jsx("span",{className:"text-sm text-text-secondary",children:"Position"})]}),o.jsx("span",{className:"text-text-primary",children:e==null?void 0:e.position})]}),(e==null?void 0:e.department)&&o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center mb-1",children:[o.jsx(Y,{name:"Users",size:16,className:"text-text-tertiary mr-2"}),o.jsx("span",{className:"text-sm text-text-secondary",children:"Department"})]}),o.jsx("span",{className:"text-text-primary",children:e==null?void 0:e.department})]}),(e==null?void 0:e.lead_source)&&o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center mb-1",children:[o.jsx(Y,{name:"Target",size:16,className:"text-text-tertiary mr-2"}),o.jsx("span",{className:"text-sm text-text-secondary",children:"Lead Source"})]}),o.jsx("span",{className:"text-text-primary capitalize",children:(T=e==null?void 0:e.lead_source)==null?void 0:T.replace("_"," ")})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center mb-1",children:[o.jsx(Y,{name:"Calendar",size:16,className:"text-text-tertiary mr-2"}),o.jsx("span",{className:"text-sm text-text-secondary",children:"Last Contacted"})]}),o.jsx("span",{className:"text-text-primary",children:_(e==null?void 0:e.last_contact_date)})]})]})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"card p-5",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Social Profiles"}),((L=Object.keys(N))==null?void 0:L.length)>0?o.jsx("div",{className:"space-y-3",children:(O=Object.entries(N))==null?void 0:O.map(([P,F])=>{var I;return o.jsxs("a",{href:F!=null&&F.startsWith("http")?F:`https://${F}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-text-primary hover:text-primary transition-colors duration-150 ease-out",children:[o.jsx(Y,{name:D(P),size:16,className:"mr-2"}),o.jsx("span",{children:((I=P==null?void 0:P.charAt(0))==null?void 0:I.toUpperCase())+(P==null?void 0:P.slice(1))}),o.jsx(Y,{name:"ExternalLink",size:14,className:"ml-2"})]},P)})}):o.jsx("p",{className:"text-text-secondary text-sm",children:"No social profiles added"})]}),o.jsxs("div",{className:"card p-5",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Additional Information"}),e!=null&&e.custom_fields&&((V=Object.keys(e==null?void 0:e.custom_fields))==null?void 0:V.length)>0?o.jsx("div",{className:"space-y-3",children:(W=Object.entries(e==null?void 0:e.custom_fields))==null?void 0:W.map(([P,F])=>{var C,k,z,q,K;const I=typeof F=="object"&&F!==null&&"value"in F?F.value:F,R=(K=(q=(z=(k=(C=P==null?void 0:P.replace(/_/g," "))==null?void 0:C.replace(/([A-Z])/g," $1"))==null?void 0:k.trim())==null?void 0:z.split(" "))==null?void 0:q.map(se=>se.charAt(0).toUpperCase()+se.slice(1).toLowerCase()))==null?void 0:K.join(" ");return I==null||I===""?null:o.jsxs("div",{className:"pb-3 border-b border-border last:border-0",children:[o.jsx("div",{className:"text-sm font-medium text-text-secondary mb-1",children:R}),o.jsx("div",{className:"text-text-primary",children:typeof I=="boolean"?I?"Yes":"No":Array.isArray(I)?I.join(", "):String(I)})]},P)})}):o.jsx("p",{className:"text-text-secondary text-sm",children:"No additional information"})]})]})]}),a==="activity"&&o.jsx(SWe,{activities:c,contact:e,onActivityAdded:b,onActivityUpdated:w,loading:d}),a==="deals"&&o.jsx(EWe,{deals:h,contactName:(e==null?void 0:e.full_name)||((B=`${(e==null?void 0:e.first_name)||""} ${(e==null?void 0:e.last_name)||""}`)==null?void 0:B.trim())||"Unnamed Contact",loading:x}),a==="notes"&&o.jsx(TWe,{contact:e,onNotesCountChange:v})]}),s&&o.jsx(FWe,{contact:e,onClose:()=>l(!1),onSend:P=>{l(!1)}})]})},IWe=({contact:e=null,onSubmit:t,onCancel:r})=>{const{user:n}=Vt(),[a,i]=M.useState(!1),[s,l]=M.useState([]),[c,u]=M.useState([]),[d,f]=M.useState({}),[h,m]=M.useState(!1),[x,p]=M.useState({first_name:"",last_name:"",email:"",phone:"",mobile:"",position:"",department:"",company_id:"",companyName:"",status:"active",lead_source:"website",social_linkedin:"",social_twitter:"",owner_id:(n==null?void 0:n.id)||""}),[g,v]=M.useState({});M.useEffect(()=>{if(y(),b(),e)if(p({first_name:(e==null?void 0:e.first_name)||"",last_name:(e==null?void 0:e.last_name)||"",email:(e==null?void 0:e.email)||"",phone:(e==null?void 0:e.phone)||"",mobile:(e==null?void 0:e.mobile)||"",position:(e==null?void 0:e.position)||"",department:(e==null?void 0:e.department)||"",company_id:(e==null?void 0:e.company_id)||"",companyName:"",status:(e==null?void 0:e.status)||"active",lead_source:(e==null?void 0:e.lead_source)||"website",social_linkedin:(e==null?void 0:e.social_linkedin)||"",social_twitter:(e==null?void 0:e.social_twitter)||"",owner_id:(e==null?void 0:e.owner_id)||(n==null?void 0:n.id)||""}),e!=null&&e.custom_fields){const E={};Object.entries(e.custom_fields).forEach(([A,T])=>{(T==null?void 0:T.value)!==null&&(T==null?void 0:T.value)!==void 0&&(E[A]=T.value)}),f(E)}else e!=null&&e.id&&w(e.id)},[e,n]);const y=async()=>{try{const E=await(Zt==null?void 0:Zt.getAllCompanies());l(E||[])}catch(E){console.error("Error loading companies:",E),v({submit:"Failed to load companies. Please try refreshing the page."})}},b=async()=>{m(!0);try{const A=(await as.getAllFields({entity_type:"contact",is_active:!0})||[]).filter(T=>T.placement==="form"||T.placement==="both");u(A)}catch(E){console.error("Error loading custom fields:",E),u([])}finally{m(!1)}},w=async E=>{try{const A=await as.getEntityCustomFields("contact",E),T={};A.forEach(L=>{L.current_value!==null&&L.current_value!==void 0&&(T[L.field_key]=L.current_value)}),f(T)}catch(A){console.error("Error loading custom field values:",A),f({})}},_=async E=>{var A;E==null||E.preventDefault(),i(!0),v({});try{const T=["first_name","last_name","email"],L={};if(T==null||T.forEach(V=>{var W;(W=x==null?void 0:x[V])!=null&&W.trim()||(L[V]=`${V==null?void 0:V.replace("_"," ")} is required`)}),x!=null&&x.email&&!/\S+@\S+\.\S+/.test(x==null?void 0:x.email)&&(L.email="Please enter a valid email address"),((A=Object.keys(L))==null?void 0:A.length)>0){v(L),i(!1);return}const O={...x,custom_fields:Object.keys(d).length>0?d:void 0};await(t==null?void 0:t(O))}catch(T){console.error("Error saving contact:",T),v({submit:(T==null?void 0:T.message)||"Failed to save contact. Please try again."})}finally{i(!1)}},D=(E,A)=>{p(T=>({...T,[E]:A})),g!=null&&g[E]&&v(T=>{const L={...T};return L==null||delete L[E],L})},j=(E,A)=>{E&&(f(T=>({...T,[E]:A})),g!=null&&g[E]&&v(T=>{const L={...T};return delete L[E],L}))},N=[{value:"website",label:"Website"},{value:"referral",label:"Referral"},{value:"cold_call",label:"Cold Call"},{value:"email_campaign",label:"Email Campaign"},{value:"social_media",label:"Social Media"},{value:"event",label:"Event"},{value:"partner",label:"Partner"},{value:"other",label:"Other"}],S=[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}];return o.jsxs("form",{onSubmit:_,className:"space-y-6",children:[(g==null?void 0:g.submit)&&o.jsxs("div",{className:"bg-error-50 border border-error-200 text-error p-4 rounded-lg flex items-center space-x-2",children:[o.jsx(Y,{name:"AlertCircle",size:20}),o.jsx("span",{children:g==null?void 0:g.submit})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"First Name *"}),o.jsx("input",{type:"text",value:x==null?void 0:x.first_name,onChange:E=>{var A;return D("first_name",(A=E==null?void 0:E.target)==null?void 0:A.value)},className:`w-full px-3 py-2 border rounded-lg bg-surface text-text-primary placeholder-text-tertiary focus:ring-primary focus:border-primary ${g!=null&&g.first_name?"border-error":"border-border"}`,placeholder:"John",required:!0}),(g==null?void 0:g.first_name)&&o.jsx("p",{className:"text-sm text-error mt-1",children:g==null?void 0:g.first_name})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Last Name *"}),o.jsx("input",{type:"text",value:x==null?void 0:x.last_name,onChange:E=>{var A;return D("last_name",(A=E==null?void 0:E.target)==null?void 0:A.value)},className:`w-full px-3 py-2 border rounded-lg bg-surface text-text-primary placeholder-text-tertiary focus:ring-primary focus:border-primary ${g!=null&&g.last_name?"border-error":"border-border"}`,placeholder:"Doe",required:!0}),(g==null?void 0:g.last_name)&&o.jsx("p",{className:"text-sm text-error mt-1",children:g==null?void 0:g.last_name})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Email Address *"}),o.jsx("input",{type:"email",value:x==null?void 0:x.email,onChange:E=>{var A;return D("email",(A=E==null?void 0:E.target)==null?void 0:A.value)},className:`w-full px-3 py-2 border rounded-lg bg-surface text-text-primary placeholder-text-tertiary focus:ring-primary focus:border-primary ${g!=null&&g.email?"border-error":"border-border"}`,placeholder:"john.doe@company.com",required:!0}),(g==null?void 0:g.email)&&o.jsx("p",{className:"text-sm text-error mt-1",children:g==null?void 0:g.email})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Phone Number"}),o.jsx("input",{type:"tel",value:x==null?void 0:x.phone,onChange:E=>{var A;return D("phone",(A=E==null?void 0:E.target)==null?void 0:A.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary placeholder-text-tertiary focus:ring-primary focus:border-primary",placeholder:"+1 (555) 123-4567"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Position"}),o.jsx("input",{type:"text",value:x==null?void 0:x.position,onChange:E=>{var A;return D("position",(A=E==null?void 0:E.target)==null?void 0:A.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary placeholder-text-tertiary focus:ring-primary focus:border-primary",placeholder:"Sales Manager"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Department"}),o.jsx("input",{type:"text",value:x==null?void 0:x.department,onChange:E=>{var A;return D("department",(A=E==null?void 0:E.target)==null?void 0:A.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary placeholder-text-tertiary focus:ring-primary focus:border-primary",placeholder:"Sales"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Company"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("select",{value:x==null?void 0:x.company_id,onChange:E=>{var A;return D("company_id",(A=E==null?void 0:E.target)==null?void 0:A.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary focus:ring-primary focus:border-primary",children:[o.jsx("option",{value:"",children:"Select Existing Company"}),s==null?void 0:s.map(E=>o.jsx("option",{value:E==null?void 0:E.id,children:E==null?void 0:E.name},E==null?void 0:E.id))]}),o.jsx("input",{type:"text",value:x==null?void 0:x.companyName,onChange:E=>{var A;return D("companyName",(A=E==null?void 0:E.target)==null?void 0:A.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary placeholder-text-tertiary focus:ring-primary focus:border-primary",placeholder:"Or enter new company name"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Status"}),o.jsx("select",{value:x==null?void 0:x.status,onChange:E=>{var A;return D("status",(A=E==null?void 0:E.target)==null?void 0:A.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary focus:ring-primary focus:border-primary",children:S==null?void 0:S.map(E=>o.jsx("option",{value:E==null?void 0:E.value,children:E==null?void 0:E.label},E==null?void 0:E.value))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Lead Source"}),o.jsx("select",{value:x==null?void 0:x.lead_source,onChange:E=>{var A;return D("lead_source",(A=E==null?void 0:E.target)==null?void 0:A.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary focus:ring-primary focus:border-primary",children:N==null?void 0:N.map(E=>o.jsx("option",{value:E==null?void 0:E.value,children:E==null?void 0:E.label},E==null?void 0:E.value))})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"LinkedIn URL"}),o.jsx("input",{type:"url",value:x==null?void 0:x.social_linkedin,onChange:E=>{var A;return D("social_linkedin",(A=E==null?void 0:E.target)==null?void 0:A.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary placeholder-text-tertiary focus:ring-primary focus:border-primary",placeholder:"https://linkedin.com/in/johndoe"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Twitter URL"}),o.jsx("input",{type:"url",value:x==null?void 0:x.social_twitter,onChange:E=>{var A;return D("social_twitter",(A=E==null?void 0:E.target)==null?void 0:A.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary placeholder-text-tertiary focus:ring-primary focus:border-primary",placeholder:"https://twitter.com/johndoe"})]})]}),h&&o.jsx("div",{className:"pt-6 border-t border-border",children:o.jsxs("div",{className:"text-center py-4 text-gray-500",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),o.jsx("p",{className:"mt-2",children:"Loading custom fields..."})]})}),!h&&Array.isArray(c)&&c.length>0&&o.jsx("div",{className:"pt-6 border-t border-border",children:o.jsx(vb,{fields:c,values:d||{},onChange:j,errors:g||{}})}),o.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-border",children:[o.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-text-secondary hover:text-text-primary dark:hover:text-text-primary transition-colors duration-150",disabled:a,children:"Cancel"}),o.jsxs("button",{type:"submit",disabled:a,className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors duration-150 ease-smooth flex items-center space-x-2",children:[a&&o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),o.jsx("span",{children:e?"Update Contact":"Create Contact"})]})]})]})},RWe=({onImport:e,onClose:t})=>{var b;const[r,n]=M.useState(1),[a,i]=M.useState(null),[s,l]=M.useState({firstName:"",lastName:"",email:"",phone:"",company:"",position:""}),[c,u]=M.useState([]),[d,f]=M.useState(!1),[h,m]=M.useState([]),[x,p]=M.useState(null),g=w=>{var D,j;const _=(j=(D=w==null?void 0:w.target)==null?void 0:D.files)==null?void 0:j[0];_&&(i(_),p(null),f(!0),Rm.parse(_,{header:!0,skipEmptyLines:!0,complete:N=>{try{if(N.errors&&N.errors.length>0){console.error("CSV parsing errors:",N.errors),p("Error parsing file. Please check the format."),f(!1);return}if(!N.data||N.data.length===0){p("The file is empty or has no valid data."),f(!1);return}const S=Object.keys(N.data[0]||{});m(S),u(N.data);const E={firstName:"",lastName:"",email:"",phone:"",company:"",position:""};S.forEach(A=>{const T=A.toLowerCase().trim();T.includes("first")&&T.includes("name")?E.firstName=A:T.includes("last")&&T.includes("name")?E.lastName=A:T.includes("email")?E.email=A:T.includes("phone")||T.includes("mobile")?E.phone=A:T.includes("company")||T.includes("organization")?E.company=A:(T.includes("position")||T.includes("title")||T.includes("job"))&&(E.position=A)}),l(E),n(2),f(!1)}catch(S){console.error("Error processing file:",S),p("Failed to process the file. Please try again."),f(!1)}},error:N=>{console.error("Papa Parse error:",N),p("Failed to parse the file. Please ensure it's a valid CSV file."),f(!1)}}))},v=(w,_)=>{l({...s,[w]:_})},y=async()=>{f(!0),p(null);try{const w=c.filter(_=>{const D=_==null?void 0:_[s==null?void 0:s.firstName],j=_==null?void 0:_[s==null?void 0:s.lastName];return D&&j&&D.trim()&&j.trim()}).map(_=>{const D={first_name:((_==null?void 0:_[s==null?void 0:s.firstName])||"").trim(),last_name:((_==null?void 0:_[s==null?void 0:s.lastName])||"").trim(),status:"active"},j=((_==null?void 0:_[s==null?void 0:s.email])||"").trim();j&&(D.email=j);const N=((_==null?void 0:_[s==null?void 0:s.phone])||"").trim();N&&(D.phone=N);const S=((_==null?void 0:_[s==null?void 0:s.company])||"").trim();S&&(D.company_name=S);const E=((_==null?void 0:_[s==null?void 0:s.position])||"").trim();return E&&(D.position=E),D});if(w.length===0){p("No valid contacts found. Please ensure firstName and lastName are provided for all contacts."),f(!1);return}await e(w),f(!1),t()}catch(w){console.error("Error preparing import data:",w),p("Failed to prepare import data. Please try again."),f(!1)}};return o.jsx("div",{className:"fixed inset-0 z-1100 overflow-y-auto",children:o.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[o.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:o.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50"})}),o.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:""}),o.jsxs("div",{className:"inline-block align-bottom bg-surface rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full md:max-w-2xl",children:[o.jsxs("div",{className:"px-6 py-4 border-b border-border flex justify-between items-center",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Import Contacts"}),o.jsx("button",{onClick:t,className:"text-text-secondary hover:text-text-primary",children:o.jsx(Y,{name:"X",size:20})})]}),o.jsxs("div",{className:"px-6 py-5",children:[r===1&&o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("div",{className:"w-16 h-16 bg-primary-50 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(Y,{name:"Upload",size:24,className:"text-primary"})}),o.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Upload Contact File"}),o.jsx("p",{className:"text-text-secondary mb-4",children:"Upload a CSV file with your contacts data."})]}),x&&o.jsx("div",{className:"mb-4 p-3 bg-error-50 border border-error-200 rounded-lg text-error text-sm",children:x}),d&&o.jsxs("div",{className:"mb-4 p-3 bg-primary-50 border border-primary-200 rounded-lg text-primary text-sm flex items-center justify-center",children:[o.jsx(Y,{name:"Loader",size:16,className:"animate-spin mr-2"}),"Parsing file..."]}),o.jsxs("div",{className:"border-2 border-dashed border-border rounded-lg p-8 mb-6",children:[o.jsx("input",{type:"file",id:"contactFile",accept:".csv",onChange:g,className:"hidden",disabled:d}),o.jsxs("label",{htmlFor:"contactFile",className:`cursor-pointer flex flex-col items-center justify-center ${d?"opacity-50 cursor-not-allowed":""}`,children:[o.jsx(Y,{name:"FileText",size:36,className:"text-text-tertiary mb-3"}),o.jsx("span",{className:"text-text-primary font-medium mb-1",children:"Drag and drop your file here or click to browse"}),o.jsx("span",{className:"text-sm text-text-tertiary",children:"Supports CSV files"}),a&&!d&&o.jsxs("span",{className:"text-sm text-primary mt-2",children:["Selected: ",a.name]})]})]}),o.jsxs("div",{className:"text-sm text-text-secondary",children:[o.jsx("p",{className:"mb-2",children:"Your file should include the following columns:"}),o.jsxs("ul",{className:"list-disc list-inside space-y-1 text-left",children:[o.jsx("li",{children:"First Name"}),o.jsx("li",{children:"Last Name"}),o.jsx("li",{children:"Email Address"}),o.jsx("li",{children:"Phone Number (optional)"}),o.jsx("li",{children:"Company Name"}),o.jsx("li",{children:"Position/Title (optional)"})]})]})]}),r===2&&o.jsxs("div",{children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Map Fields"}),o.jsx("p",{className:"text-text-secondary",children:"Match your file columns to the appropriate contact fields."})]}),x&&o.jsx("div",{className:"mb-4 p-3 bg-error-50 border border-error-200 rounded-lg text-error text-sm",children:x}),o.jsx("div",{className:"space-y-4 mb-6",children:o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"First Name* (Required)"}),o.jsxs("select",{value:s==null?void 0:s.firstName,onChange:w=>{var _;return v("firstName",(_=w==null?void 0:w.target)==null?void 0:_.value)},className:"input-field",children:[o.jsx("option",{value:"",children:"Select column"}),h.map(w=>o.jsx("option",{value:w,children:w},w))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Last Name* (Required)"}),o.jsxs("select",{value:s==null?void 0:s.lastName,onChange:w=>{var _;return v("lastName",(_=w==null?void 0:w.target)==null?void 0:_.value)},className:"input-field",children:[o.jsx("option",{value:"",children:"Select column"}),h.map(w=>o.jsx("option",{value:w,children:w},w))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Email (Optional)"}),o.jsxs("select",{value:s==null?void 0:s.email,onChange:w=>{var _;return v("email",(_=w==null?void 0:w.target)==null?void 0:_.value)},className:"input-field",children:[o.jsx("option",{value:"",children:"Select column"}),h.map(w=>o.jsx("option",{value:w,children:w},w))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Phone (Optional)"}),o.jsxs("select",{value:s==null?void 0:s.phone,onChange:w=>{var _;return v("phone",(_=w==null?void 0:w.target)==null?void 0:_.value)},className:"input-field",children:[o.jsx("option",{value:"",children:"Select column"}),h.map(w=>o.jsx("option",{value:w,children:w},w))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Company (Optional)"}),o.jsxs("select",{value:s==null?void 0:s.company,onChange:w=>{var _;return v("company",(_=w==null?void 0:w.target)==null?void 0:_.value)},className:"input-field",children:[o.jsx("option",{value:"",children:"Select column"}),h.map(w=>o.jsx("option",{value:w,children:w},w))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Position (Optional)"}),o.jsxs("select",{value:s==null?void 0:s.position,onChange:w=>{var _;return v("position",(_=w==null?void 0:w.target)==null?void 0:_.value)},className:"input-field",children:[o.jsx("option",{value:"",children:"Select column"}),h.map(w=>o.jsx("option",{value:w,children:w},w))]})]})]})}),o.jsxs("div",{className:"border border-border rounded-lg overflow-hidden mb-6",children:[o.jsxs("div",{className:"px-4 py-3 bg-surface-hover text-sm font-medium text-text-primary",children:["Preview (",c==null?void 0:c.length," records)"]}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-border",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 bg-surface-hover text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"First Name"}),o.jsx("th",{className:"px-4 py-3 bg-surface-hover text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Last Name"}),o.jsx("th",{className:"px-4 py-3 bg-surface-hover text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Email"}),o.jsx("th",{className:"px-4 py-3 bg-surface-hover text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Company"})]})}),o.jsx("tbody",{className:"bg-surface divide-y divide-border",children:(b=c==null?void 0:c.slice(0,3))==null?void 0:b.map((w,_)=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-text-primary",children:(w==null?void 0:w[s==null?void 0:s.firstName])||"-"}),o.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-text-primary",children:(w==null?void 0:w[s==null?void 0:s.lastName])||"-"}),o.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-text-primary",children:(w==null?void 0:w[s==null?void 0:s.email])||"-"}),o.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-text-primary",children:(w==null?void 0:w[s==null?void 0:s.company])||"-"})]},_))})]})})]})]})]}),o.jsxs("div",{className:"px-6 py-4 border-t border-border flex justify-between",children:[r===1?o.jsx("button",{onClick:t,className:"px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-out",children:"Cancel"}):o.jsxs("button",{onClick:()=>n(1),className:"inline-flex items-center px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-out",children:[o.jsx(Y,{name:"ArrowLeft",size:16,className:"mr-2"}),"Back"]}),r===1?o.jsx("button",{disabled:!a,className:`btn-primary ${a?"":"opacity-50 cursor-not-allowed"}`,children:"Next"}):o.jsx("button",{onClick:y,disabled:d||!(s!=null&&s.firstName)||!(s!=null&&s.lastName),className:`btn-primary inline-flex items-center ${d||!(s!=null&&s.firstName)||!(s!=null&&s.lastName)?"opacity-50 cursor-not-allowed":""}`,children:d?o.jsxs(o.Fragment,{children:[o.jsx(Y,{name:"Loader",size:16,className:"animate-spin mr-2"}),"Importing..."]}):o.jsx(o.Fragment,{children:"Import Contacts"})})]})]})]})})},MWe=({contacts:e,onClose:t})=>{const[r,n]=M.useState("csv"),[a,i]=M.useState({basicInfo:!0,contactDetails:!0,companyInfo:!0,deals:!0,activities:!1,notes:!1,customFields:!1}),[s,l]=M.useState(!1),c=d=>{i({...a,[d]:!(a!=null&&a[d])})},u=()=>{l(!0),setTimeout(()=>{l(!1),t()},1e3)};return o.jsx("div",{className:"fixed inset-0 z-1100 overflow-y-auto",children:o.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[o.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:o.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50"})}),o.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:""}),o.jsxs("div",{className:"inline-block align-bottom bg-surface rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[o.jsxs("div",{className:"px-6 py-4 border-b border-border flex justify-between items-center",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Export Contacts"}),o.jsx("button",{onClick:t,className:"text-text-secondary hover:text-text-primary",children:o.jsx(Y,{name:"X",size:20})})]}),o.jsx("div",{className:"px-6 py-5",children:o.jsxs("div",{className:"mb-6",children:[o.jsxs("p",{className:"text-text-secondary mb-4",children:["Exporting ",e==null?void 0:e.length," ",(e==null?void 0:e.length)===1?"contact":"contacts"]}),o.jsxs("div",{className:"mb-6",children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Export Format"}),o.jsxs("div",{className:"flex space-x-4",children:[o.jsxs("label",{className:"inline-flex items-center",children:[o.jsx("input",{type:"radio",value:"csv",checked:r==="csv",onChange:()=>n("csv"),className:"h-4 w-4 text-primary border-border focus:ring-primary"}),o.jsx("span",{className:"ml-2 text-text-secondary",children:"CSV"})]}),o.jsxs("label",{className:"inline-flex items-center",children:[o.jsx("input",{type:"radio",value:"excel",checked:r==="excel",onChange:()=>n("excel"),className:"h-4 w-4 text-primary border-border focus:ring-primary"}),o.jsx("span",{className:"ml-2 text-text-secondary",children:"Excel"})]}),o.jsxs("label",{className:"inline-flex items-center",children:[o.jsx("input",{type:"radio",value:"vcf",checked:r==="vcf",onChange:()=>n("vcf"),className:"h-4 w-4 text-primary border-border focus:ring-primary"}),o.jsx("span",{className:"ml-2 text-text-secondary",children:"vCard"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Fields to Export"}),o.jsxs("div",{className:"space-y-2 border border-border rounded-lg p-4",children:[o.jsxs("label",{className:"flex items-center justify-between py-1 border-b border-border",children:[o.jsx("span",{className:"text-text-primary",children:"Basic Information (Name, Email)"}),o.jsx("input",{type:"checkbox",checked:a==null?void 0:a.basicInfo,onChange:()=>c("basicInfo"),disabled:!0,className:"h-4 w-4 text-primary border-border rounded focus:ring-primary"})]}),o.jsxs("label",{className:"flex items-center justify-between py-1 border-b border-border",children:[o.jsx("span",{className:"text-text-secondary",children:"Contact Details (Phone)"}),o.jsx("input",{type:"checkbox",checked:a==null?void 0:a.contactDetails,onChange:()=>c("contactDetails"),className:"h-4 w-4 text-primary border-border rounded focus:ring-primary"})]}),o.jsxs("label",{className:"flex items-center justify-between py-1 border-b border-border",children:[o.jsx("span",{className:"text-text-secondary",children:"Company Information"}),o.jsx("input",{type:"checkbox",checked:a==null?void 0:a.companyInfo,onChange:()=>c("companyInfo"),className:"h-4 w-4 text-primary border-border rounded focus:ring-primary"})]}),o.jsxs("label",{className:"flex items-center justify-between py-1 border-b border-border",children:[o.jsx("span",{className:"text-text-secondary",children:"Deals"}),o.jsx("input",{type:"checkbox",checked:a==null?void 0:a.deals,onChange:()=>c("deals"),className:"h-4 w-4 text-primary border-border rounded focus:ring-primary"})]}),o.jsxs("label",{className:"flex items-center justify-between py-1 border-b border-border",children:[o.jsx("span",{className:"text-text-secondary",children:"Activities"}),o.jsx("input",{type:"checkbox",checked:a==null?void 0:a.activities,onChange:()=>c("activities"),className:"h-4 w-4 text-primary border-border rounded focus:ring-primary"})]}),o.jsxs("label",{className:"flex items-center justify-between py-1 border-b border-border",children:[o.jsx("span",{className:"text-text-secondary",children:"Notes"}),o.jsx("input",{type:"checkbox",checked:a==null?void 0:a.notes,onChange:()=>c("notes"),className:"h-4 w-4 text-primary border-border rounded focus:ring-primary"})]}),o.jsxs("label",{className:"flex items-center justify-between py-1",children:[o.jsx("span",{className:"text-text-secondary",children:"Custom Fields"}),o.jsx("input",{type:"checkbox",checked:a==null?void 0:a.customFields,onChange:()=>c("customFields"),className:"h-4 w-4 text-primary border-border rounded focus:ring-primary"})]})]})]})]})}),o.jsxs("div",{className:"px-6 py-4 border-t border-border flex justify-end space-x-3",children:[o.jsx("button",{onClick:t,className:"px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-out",children:"Cancel"}),o.jsx("button",{onClick:u,disabled:s,className:"btn-primary inline-flex items-center",children:s?o.jsxs(o.Fragment,{children:[o.jsx(Y,{name:"Loader",size:16,className:"animate-spin mr-2"}),"Exporting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Y,{name:"Download",size:16,className:"mr-2"}),"Export"]})})]})]})]})})},UWe=({contact1:e,contact2:t,onMerge:r,onClose:n})=>{var c,u,d,f;const[a,i]=M.useState({id:Date.now(),firstName:e==null?void 0:e.firstName,lastName:e==null?void 0:e.lastName,email:e==null?void 0:e.email,phone:e==null?void 0:e.phone,company:e==null?void 0:e.company,position:e==null?void 0:e.position,avatar:e==null?void 0:e.avatar,lastContactDate:(c=new Date)==null?void 0:c.toISOString(),status:e==null?void 0:e.status,tags:[...new Set([...e.tags,...t.tags])],deals:[...e==null?void 0:e.deals,...t==null?void 0:t.deals],notes:e!=null&&e.notes&&(t!=null&&t.notes)?`${e==null?void 0:e.notes}

${t==null?void 0:t.notes}`:(e==null?void 0:e.notes)||(t==null?void 0:t.notes),socialProfiles:{...e==null?void 0:e.socialProfiles,...t==null?void 0:t.socialProfiles},activities:[...e==null?void 0:e.activities,...t==null?void 0:t.activities].sort((h,m)=>new Date(m.date)-new Date(h.date)),customFields:{...e==null?void 0:e.customFields}}),s=(h,m)=>{i({...a,[h]:m})},l=(h,m,x,p)=>o.jsxs("div",{className:"py-3 border-b border-border last:border-b-0",children:[o.jsx("div",{className:"text-sm font-medium text-text-secondary mb-2",children:m}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[o.jsx("div",{className:`flex-1 p-3 rounded-lg border ${(a==null?void 0:a[h])===x?"border-primary bg-primary-50":"border-border hover:border-primary-100 cursor-pointer"}`,onClick:()=>s(h,x),children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-1",children:h==="avatar"?o.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden",children:o.jsx(Io,{src:x,alt:"Contact 1",className:"w-full h-full object-cover"})}):o.jsx("span",{className:"text-text-primary",children:x||"-"})}),(a==null?void 0:a[h])===x&&o.jsx(Y,{name:"Check",size:16,className:"text-primary"})]})}),o.jsx("div",{className:`flex-1 p-3 rounded-lg border ${(a==null?void 0:a[h])===p?"border-primary bg-primary-50":"border-border hover:border-primary-100 cursor-pointer"}`,onClick:()=>s(h,p),children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-1",children:h==="avatar"?o.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden",children:o.jsx(Io,{src:p,alt:"Contact 2",className:"w-full h-full object-cover"})}):o.jsx("span",{className:"text-text-primary",children:p||"-"})}),(a==null?void 0:a[h])===p&&o.jsx(Y,{name:"Check",size:16,className:"text-primary"})]})})]})]});return o.jsx("div",{className:"fixed inset-0 z-1100 overflow-y-auto",children:o.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[o.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:o.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50"})}),o.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:""}),o.jsxs("div",{className:"inline-block align-bottom bg-surface rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full md:max-w-2xl",children:[o.jsxs("div",{className:"px-6 py-4 border-b border-border flex justify-between items-center",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Merge Duplicate Contacts"}),o.jsx("button",{onClick:n,className:"text-text-secondary hover:text-text-primary",children:o.jsx(Y,{name:"X",size:20})})]}),o.jsx("div",{className:"px-6 py-5",children:o.jsxs("div",{className:"mb-6",children:[o.jsx("p",{className:"text-text-secondary mb-4",children:"Select which information to keep for the merged contact."}),o.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[o.jsx("div",{}),o.jsx("div",{className:"text-center text-sm font-medium text-text-primary",children:"Contact 1"}),o.jsx("div",{className:"text-center text-sm font-medium text-text-primary",children:"Contact 2"})]}),o.jsxs("div",{className:"border border-border rounded-lg divide-y divide-border",children:[l("avatar","Profile Picture",e==null?void 0:e.avatar,t==null?void 0:t.avatar),l("firstName","First Name",e==null?void 0:e.firstName,t==null?void 0:t.firstName),l("lastName","Last Name",e==null?void 0:e.lastName,t==null?void 0:t.lastName),l("email","Email",e==null?void 0:e.email,t==null?void 0:t.email),l("phone","Phone",e==null?void 0:e.phone,t==null?void 0:t.phone),l("company","Company",e==null?void 0:e.company,t==null?void 0:t.company),l("position","Position",e==null?void 0:e.position,t==null?void 0:t.position)]}),o.jsx("div",{className:"mt-6",children:o.jsx("div",{className:"bg-primary-50 border border-primary-100 rounded-lg p-4 text-sm text-primary",children:o.jsxs("div",{className:"flex items-start",children:[o.jsx(Y,{name:"Info",size:16,className:"mr-2 mt-0.5"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium mb-1",children:"Additional Information"}),o.jsx("p",{children:"The following data will be combined from both contacts:"}),o.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[o.jsxs("li",{children:["Tags (",(u=a==null?void 0:a.tags)==null?void 0:u.length," total)"]}),o.jsxs("li",{children:["Deals (",(d=a==null?void 0:a.deals)==null?void 0:d.length," total)"]}),o.jsxs("li",{children:["Activities (",(f=a==null?void 0:a.activities)==null?void 0:f.length," total)"]}),o.jsx("li",{children:"Notes (will be concatenated)"}),o.jsx("li",{children:"Social profiles (will be merged)"})]})]})]})})})]})}),o.jsxs("div",{className:"px-6 py-4 border-t border-border flex justify-end space-x-3",children:[o.jsx("button",{onClick:n,className:"px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-out",children:"Cancel"}),o.jsxs("button",{onClick:()=>r(a),className:"btn-primary inline-flex items-center",children:[o.jsx(Y,{name:"GitMerge",size:16,className:"mr-2"}),"Merge Contacts"]})]})]})]})})},$We=()=>{const{user:e}=Vt(),[t,r]=M.useState([]),[n,a]=M.useState(!0),[i,s]=M.useState(null),[l,c]=M.useState([]),[u,d]=M.useState(""),[f,h]=M.useState(!1),[m,x]=M.useState(!1),[p,g]=M.useState(!1),[v,y]=M.useState(!1),[b,w]=M.useState(!1),[_,D]=M.useState("all"),[j,N]=M.useState("grid"),[S,E]=M.useState(""),[A,T]=M.useState(""),L=async()=>{var K,se;try{a(!0),E("");let ie=[];if(u?ie=await(Ct==null?void 0:Ct.searchContacts(u)):ie=await(Ct==null?void 0:Ct.getUserContacts()),r(ie||[]),(ie==null?void 0:ie.length)>0&&j==="split"&&!i)try{const ee=await(Ct==null?void 0:Ct.getContactById(ie[0].id));s(ee)}catch(ee){console.error("Error loading full contact data:",ee),s(ie==null?void 0:ie[0])}}catch(ie){console.error("Error loading contacts:",ie),(K=ie==null?void 0:ie.message)!=null&&K.includes("Failed to fetch")||(se=ie==null?void 0:ie.message)!=null&&se.includes("NetworkError")?E("Cannot connect to database. Your Supabase project may be paused or inactive. Please check your Supabase dashboard and resume your project if needed."):E("Failed to load contacts. Please try again.")}finally{a(!1)}};M.useEffect(()=>{e&&L()},[e,u,_]),M.useEffect(()=>{if(S||A){const K=setTimeout(()=>{E(""),T("")},5e3);return()=>clearTimeout(K)}},[S,A]);const O=t==null?void 0:t.filter(K=>_==="active"?(K==null?void 0:K.status)==="active":_==="inactive"?(K==null?void 0:K.status)==="inactive":_==="my"?(K==null?void 0:K.owner_id)===(e==null?void 0:e.id):!0),V=async K=>{try{if(K!=null&&K.id){const se=await(Ct==null?void 0:Ct.getContactById(K.id));s(se)}else s(K);N("split"),h(!1),x(!1)}catch(se){console.error("Error in handleContactSelect:",se),s(K),N("split"),h(!1),x(!1),E("Could not load full contact details. Showing basic information.")}},W=K=>{try{c(se=>se!=null&&se.includes(K)?se==null?void 0:se.filter(ee=>ee!==K):[...se||[],K])}catch(se){console.error("Error in handleContactMultiSelect:",se),E("Something went wrong while selecting contacts. Please try again.")}},B=()=>{N("grid"),s(null),h(!1),x(!1)},P=()=>{s(null),h(!0),x(!1),N("split")},F=async()=>{if(h(!1),x(!0),i!=null&&i.id)try{const K=await(Ct==null?void 0:Ct.getContactById(i.id));s(K)}catch(K){console.error("Error loading full contact data:",K)}},I=async K=>{var se,ie,ee,ae,pe,H;try{E("");let ne;if(f){let U=K.company_id;if((se=K.companyName)!=null&&se.trim()&&!U)try{const X=await(Zt==null?void 0:Zt.searchCompanies((ie=K.companyName)==null?void 0:ie.trim())),G=X==null?void 0:X.find(ce=>{var J,ue,me;return((J=ce.name)==null?void 0:J.toLowerCase())===((me=(ue=K.companyName)==null?void 0:ue.trim())==null?void 0:me.toLowerCase())});G?U=G.id:U=(await(Zt==null?void 0:Zt.createCompany({name:(ee=K.companyName)==null?void 0:ee.trim()}))).id}catch(X){throw console.error("Error handling company:",X),new Error(`Failed to create company "${K.companyName}": ${X.message}`)}const{companyName:le,...re}={...K,company_id:U||null,owner_id:e==null?void 0:e.id};Object.keys(re).forEach(X=>{re[X]===""&&["company_id"].includes(X)&&(re[X]=null)}),ne=await(Ct==null?void 0:Ct.createContact(re)),T(`Contact "${ne==null?void 0:ne.first_name} ${ne==null?void 0:ne.last_name}" created successfully!`)}else if(m&&i){let U=K.company_id;if((ae=K.companyName)!=null&&ae.trim()&&!U)try{const X=await(Zt==null?void 0:Zt.searchCompanies((pe=K.companyName)==null?void 0:pe.trim())),G=X==null?void 0:X.find(ce=>{var J,ue,me;return((J=ce.name)==null?void 0:J.toLowerCase())===((me=(ue=K.companyName)==null?void 0:ue.trim())==null?void 0:me.toLowerCase())});G?U=G.id:U=(await(Zt==null?void 0:Zt.createCompany({name:(H=K.companyName)==null?void 0:H.trim()}))).id}catch(X){throw console.error("Error handling company:",X),new Error(`Failed to create company "${K.companyName}": ${X.message}`)}const{companyName:le,...re}={...K,company_id:U||null,owner_id:K.owner_id||(e==null?void 0:e.id)};Object.keys(re).forEach(X=>{re[X]===""&&["company_id"].includes(X)&&(re[X]=null)}),ne=await(Ct==null?void 0:Ct.updateContact(i==null?void 0:i.id,re)),T(`Contact "${ne==null?void 0:ne.first_name} ${ne==null?void 0:ne.last_name}" updated successfully!`)}s(ne),h(!1),x(!1),L()}catch(ne){console.error("Error saving contact:",ne);let U="Failed to save contact. Please try again.";ne!=null&&ne.message&&(Array.isArray(ne.message)?U=ne.message.map(le=>le.msg||le.message||le).join(", "):typeof ne.message=="string"&&(U=ne.message)),E(U)}},R=()=>{h(!1),x(!1),i===null&&(t==null?void 0:t.length)>0&&s(t==null?void 0:t[0])},C=async K=>{const se=t==null?void 0:t.find(ae=>(ae==null?void 0:ae.id)===K),ie=se?`${se.first_name} ${se.last_name}`:"this contact";if(window.confirm(`Are you sure you want to delete ${ie}?

This action cannot be undone`))try{E(""),await(Ct==null?void 0:Ct.deleteContact(K)),T("Contact deleted successfully!");const ae=t==null?void 0:t.filter(pe=>(pe==null?void 0:pe.id)!==K);r(ae),i&&(i==null?void 0:i.id)===K&&s((ae==null?void 0:ae.length)>0?ae==null?void 0:ae[0]:null),c(pe=>pe==null?void 0:pe.filter(H=>H!==K))}catch(ae){console.error("Error deleting contact:",ae),E("Failed to delete contact. Please try again.")}},k=async()=>{if(window.confirm(`Are you sure you want to delete ${l==null?void 0:l.length} contact(s)?

This action cannot be undone and will permanently remove:
 All contact information
 All associated activities
 All associated deals
 All notes and tasks`))try{E(""),await(Ct==null?void 0:Ct.deleteContacts(l)),T(`${l==null?void 0:l.length} contact(s) deleted successfully!`);const se=t==null?void 0:t.filter(ie=>!(l!=null&&l.includes(ie==null?void 0:ie.id)));r(se),i&&(l!=null&&l.includes(i==null?void 0:i.id))&&s((se==null?void 0:se.length)>0?se==null?void 0:se[0]:null),c([])}catch(se){console.error("Error deleting contacts:",se),E("Failed to delete contacts. Please try again.")}},z=K=>{const se=t.map(ie=>ie.id===K.id?K:ie);r(se),i&&i.id===K.id&&s(K)},q=async K=>{var se;try{E(""),a(!0);const ie=await(Ct==null?void 0:Ct.importContacts(K));if((ie==null?void 0:ie.error_count)>0&&((se=ie==null?void 0:ie.errors)==null?void 0:se.length)>0){console.error("Import errors:",ie.errors),E(`Import failed with ${ie.error_count} errors: ${ie.errors.join(", ")}`),a(!1);return}g(!1),await L(),T(`${(ie==null?void 0:ie.imported_count)||(K==null?void 0:K.length)} contact(s) imported successfully!`),a(!1)}catch(ie){console.error("Error importing contacts:",ie),E((ie==null?void 0:ie.message)||"Failed to import contacts. Please try again."),a(!1)}};return o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(ii,{}),o.jsx("main",{className:"pt-14 xs:pt-16 sm:pt-16",children:o.jsx("div",{className:"px-3 xs:px-4 sm:px-6 py-4 xs:py-6 sm:py-8",children:o.jsxs("div",{className:"max-w-7xl mx-auto",children:[o.jsx("div",{className:"hidden sm:block",children:o.jsx(Hs,{})}),o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 xs:mb-6 gap-3 sm:gap-0",children:[o.jsxs("div",{className:"w-full sm:w-auto",children:[o.jsx("h1",{className:"text-xl xs:text-2xl md:text-3xl font-bold text-text-primary",children:"Contact Management"}),o.jsx("p",{className:"text-xs xs:text-sm text-text-secondary mt-1 hidden xs:block",children:"Manage your customer relationships and communication history"})]}),o.jsxs("div",{className:"flex flex-wrap gap-2 xs:gap-3 w-full sm:w-auto",children:[o.jsxs("div",{className:"inline-flex items-center border border-border rounded-lg bg-surface flex-shrink-0",children:[o.jsxs("button",{onClick:()=>N("grid"),className:`inline-flex items-center space-x-1 xs:space-x-2 px-2.5 xs:px-3 py-2 min-h-touch rounded-l-lg transition-all duration-150 ${j==="grid"?"bg-primary text-white":"text-text-secondary hover:text-text-primary hover:bg-surface-hover"}`,title:"Grid View","aria-label":"Grid View",children:[o.jsx(Y,{name:"Grid",size:16,className:"xs:w-[18px] xs:h-[18px]"}),o.jsx("span",{className:"hidden sm:inline text-sm",children:"Grid"})]}),o.jsxs("button",{onClick:()=>N("split"),className:`inline-flex items-center space-x-1 xs:space-x-2 px-2.5 xs:px-3 py-2 min-h-touch rounded-r-lg transition-all duration-150 ${j==="split"?"bg-primary text-white":"text-text-secondary hover:text-text-primary hover:bg-surface-hover"}`,title:"List View","aria-label":"List View",children:[o.jsx(Y,{name:"List",size:16,className:"xs:w-[18px] xs:h-[18px]"}),o.jsx("span",{className:"hidden sm:inline text-sm",children:"List"})]})]}),pc.hasPermission(e==null?void 0:e.role,"contacts","create")&&o.jsxs("button",{onClick:P,className:"btn-primary inline-flex items-center space-x-1.5 xs:space-x-2 px-3 xs:px-4 py-2 min-h-touch text-sm xs:text-base flex-shrink-0",children:[o.jsx(Y,{name:"UserPlus",size:16,className:"xs:w-[18px] xs:h-[18px]"}),o.jsx("span",{className:"hidden xs:inline",children:"Add Contact"}),o.jsx("span",{className:"xs:hidden",children:"Add"})]}),pc.hasPermission(e==null?void 0:e.role,"contacts","import_export")&&o.jsxs("button",{onClick:()=>g(!0),className:"inline-flex items-center space-x-1.5 xs:space-x-2 px-3 xs:px-4 py-2 min-h-touch border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-out text-sm xs:text-base flex-shrink-0",children:[o.jsx(Y,{name:"Upload",size:16,className:"xs:w-[18px] xs:h-[18px]"}),o.jsx("span",{children:"Import"})]})]})]}),A&&o.jsxs("div",{className:"bg-success-50 border border-success-200 text-success p-4 rounded-lg flex items-center space-x-2 mb-6",children:[o.jsx(Y,{name:"CheckCircle",size:20}),o.jsx("span",{children:A}),o.jsx("button",{onClick:()=>T(""),className:"ml-auto text-success hover:text-success-600",children:o.jsx(Y,{name:"X",size:16})})]}),S&&o.jsxs("div",{className:"bg-error-50 border border-error-200 text-error p-4 rounded-lg flex items-center space-x-2 mb-6",children:[o.jsx(Y,{name:"AlertCircle",size:20}),o.jsx("span",{children:S}),o.jsx("button",{onClick:()=>E(""),className:"ml-auto text-error hover:text-error-600",children:o.jsx(Y,{name:"X",size:16})})]}),o.jsxs("div",{className:"mb-4 xs:mb-6",children:[o.jsxs("div",{className:"relative mb-3 xs:mb-4",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-2.5 xs:pl-3 flex items-center pointer-events-none",children:o.jsx(Y,{name:"Search",size:16,className:"xs:w-[18px] xs:h-[18px] text-text-tertiary"})}),o.jsx("input",{type:"text",placeholder:"Search contacts...",value:u,onChange:K=>{var se;return d((se=K==null?void 0:K.target)==null?void 0:se.value)},className:"input-field pl-8 xs:pl-10 text-sm xs:text-base min-h-touch"})]}),o.jsxs("div",{className:"flex border-b border-border overflow-x-auto -mx-3 px-3 xs:mx-0 xs:px-0 scrollbar-hide",children:[o.jsx("button",{onClick:()=>D("all"),className:`px-3 xs:px-4 py-2 text-xs xs:text-sm font-medium whitespace-nowrap min-h-touch flex items-center ${_==="all"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:"All Contacts"}),o.jsx("button",{onClick:()=>D("active"),className:`px-3 xs:px-4 py-2 text-xs xs:text-sm font-medium whitespace-nowrap min-h-touch flex items-center ${_==="active"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:"Active"}),o.jsx("button",{onClick:()=>D("inactive"),className:`px-3 xs:px-4 py-2 text-xs xs:text-sm font-medium whitespace-nowrap min-h-touch flex items-center ${_==="inactive"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:"Inactive"}),o.jsx("button",{onClick:()=>D("my"),className:`px-3 xs:px-4 py-2 text-xs xs:text-sm font-medium whitespace-nowrap min-h-touch flex items-center ${_==="my"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:"My Contacts"})]})]}),n?o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),o.jsx("span",{className:"text-text-secondary",children:"Loading contacts..."})]})}):j==="grid"?o.jsx("div",{className:"bg-surface rounded-lg border border-border shadow-sm p-3 xs:p-4 sm:p-6",children:o.jsx(NWe,{contacts:O,onContactSelect:V,onDeleteContact:C})}):o.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 xs:gap-6",children:[o.jsx("div",{className:"w-full lg:w-1/3 xl:w-1/4",children:o.jsxs("div",{className:"bg-surface rounded-lg border border-border shadow-sm",children:[o.jsxs("div",{className:"p-4 border-b border-border flex items-center justify-between",children:[o.jsxs("button",{onClick:B,className:"flex items-center space-x-2 text-text-secondary hover:text-text-primary transition-colors",title:"Back to grid view",children:[o.jsx(Y,{name:"ArrowLeft",size:16}),o.jsx("span",{className:"text-sm",children:"Back to Grid"})]}),(l==null?void 0:l.length)>0&&o.jsxs("div",{className:"flex space-x-2",children:[pc.hasPermission(e==null?void 0:e.role,"contacts","import_export")&&o.jsx("button",{onClick:()=>y(!0),className:"text-text-secondary hover:text-text-primary",title:"Export Selected",children:o.jsx(Y,{name:"Download",size:16})}),pc.hasPermission(e==null?void 0:e.role,"contacts","delete_own")&&o.jsx("button",{onClick:k,className:"text-error hover:text-error-600",title:"Delete Selected",children:o.jsx(Y,{name:"Trash2",size:16})}),(l==null?void 0:l.length)===2&&pc.hasPermission(e==null?void 0:e.role,"contacts","merge_duplicates")&&o.jsx("button",{onClick:()=>w(!0),className:"text-text-secondary hover:text-text-primary",title:"Merge Contacts",children:o.jsx(Y,{name:"GitMerge",size:16})})]})]}),o.jsx(jWe,{contacts:O,selectedContact:i,selectedContacts:l,onContactSelect:V,onContactMultiSelect:W,onDeleteContact:C})]})}),o.jsx("div",{className:"w-full lg:w-2/3 xl:w-3/4",children:f||m?o.jsx(IWe,{contact:m?i:null,onSubmit:I,onCancel:R,isEditing:m}):i?o.jsx(PWe,{contact:i,onEdit:F,onDelete:()=>C(i==null?void 0:i.id),onContactUpdate:z}):o.jsxs("div",{className:"bg-surface rounded-lg border border-border shadow-sm p-8 text-center",children:[o.jsx("div",{className:"w-16 h-16 bg-primary-50 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(Y,{name:"Users",size:24,className:"text-primary"})}),o.jsx("h3",{className:"text-xl font-semibold text-text-primary mb-2",children:"No Contact Selected"}),o.jsx("p",{className:"text-text-secondary mb-6",children:"Select a contact from the list or add a new one to get started."}),o.jsxs("button",{onClick:P,className:"btn-primary inline-flex items-center space-x-2",children:[o.jsx(Y,{name:"UserPlus",size:18}),o.jsx("span",{children:"Add New Contact"})]})]})})]})]})})}),p&&o.jsx(RWe,{onImport:q,onClose:()=>g(!1)}),v&&o.jsx(MWe,{contacts:t==null?void 0:t.filter(K=>l==null?void 0:l.includes(K==null?void 0:K.id)),onClose:()=>y(!1)}),b&&(l==null?void 0:l.length)===2&&o.jsx(UWe,{contact1:t==null?void 0:t.find(K=>(K==null?void 0:K.id)===(l==null?void 0:l[0])),contact2:t==null?void 0:t.find(K=>(K==null?void 0:K.id)===(l==null?void 0:l[1])),onMerge:K=>{const se=t==null?void 0:t.filter(ie=>!(l!=null&&l.includes(ie==null?void 0:ie.id)));r([...se,K]),s(K),c([]),w(!1)},onClose:()=>w(!1)})]})},I6=({companies:e,onCompanySelect:t,onDeleteCompany:r,onEditCompany:n,selectedCompanies:a=[],onMultiSelect:i,onSelectAll:s,compact:l=!1})=>{const{hasPermission:c}=Vt(),u=h=>{if(!h)return"Never";try{const m=new Date(h);return rk(m,{addSuffix:!0})}catch{return"Invalid date"}},d=h=>({technology:"Laptop",healthcare:"Heart",finance:"DollarSign",retail:"ShoppingCart",manufacturing:"Settings",education:"GraduationCap","real estate":"Home",consulting:"Briefcase",media:"Tv",transportation:"Truck"})[h==null?void 0:h.toLowerCase()]||"Building2",f=h=>({small:"bg-blue-100 text-blue-700",medium:"bg-green-100 text-green-700",large:"bg-purple-100 text-purple-700",enterprise:"bg-orange-100 text-orange-700"})[h==null?void 0:h.toLowerCase()]||"bg-gray-100 text-gray-700";return(e==null?void 0:e.length)===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"w-16 h-16 bg-primary-50 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(Y,{name:"Building2",size:24,className:"text-primary"})}),o.jsx("h3",{className:"text-xl font-semibold text-text-primary mb-2",children:"No Companies Found"}),o.jsx("p",{className:"text-text-secondary",children:"Try adjusting your search or filters, or add a new company."})]}):o.jsx("div",{className:l?"space-y-3":"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:e==null?void 0:e.map(h=>{var m,x;return o.jsx("div",{className:`bg-surface rounded-lg border border-border shadow-sm hover:shadow-md transition-all duration-200 cursor-pointer group overflow-hidden ${l?"flex items-center p-4":""}`,onClick:()=>t==null?void 0:t(h),children:l?o.jsxs(o.Fragment,{children:[i&&o.jsx("div",{className:"mr-3",onClick:p=>p.stopPropagation(),children:o.jsx("input",{type:"checkbox",checked:a==null?void 0:a.includes(h==null?void 0:h.id),onChange:()=>i(h==null?void 0:h.id),className:"w-4 h-4 text-primary border-border rounded focus:ring-primary"})}),o.jsx("div",{className:"w-10 h-10 bg-primary-50 rounded-lg flex items-center justify-center mr-3 flex-shrink-0",children:o.jsx(Y,{name:d(h==null?void 0:h.industry),size:20,className:"text-primary"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h4",{className:"font-semibold text-text-primary truncate",children:h==null?void 0:h.name}),o.jsxs("p",{className:"text-sm text-text-secondary truncate",children:[(h==null?void 0:h.industry)||"No industry","  ",(h==null?void 0:h.size)||"Unknown size"]})]}),o.jsxs("div",{className:"flex items-center space-x-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[(c("companies.edit_all")||c("companies.edit_own"))&&o.jsx("button",{onClick:p=>{p.stopPropagation(),n==null||n(h)},className:"p-1.5 rounded-lg text-text-tertiary hover:text-primary hover:bg-primary-50 transition-colors",title:"Edit company",children:o.jsx(Y,{name:"Edit2",size:16})}),(c("companies.delete_all")||c("companies.delete_own"))&&o.jsx("button",{onClick:p=>{p.stopPropagation(),window.confirm("Are you sure you want to delete this company?")&&(r==null||r(h==null?void 0:h.id))},className:"p-1.5 rounded-lg text-text-tertiary hover:text-error hover:bg-error-50 transition-colors",title:"Delete company",children:o.jsx(Y,{name:"Trash2",size:16})})]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"relative p-6 pb-4 bg-gradient-to-br from-primary-50 to-primary-100 dark:from-gray-800 dark:to-gray-750",children:[o.jsxs("div",{className:"absolute top-3 right-3 flex items-center space-x-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[(c("companies.edit_all")||c("companies.edit_own"))&&o.jsx("button",{onClick:p=>{p.stopPropagation(),n==null||n(h)},className:"p-1.5 rounded-lg bg-surface/80 backdrop-blur-sm text-text-tertiary hover:text-primary hover:bg-primary-50 dark:hover:bg-primary-900/50 transition-all",title:"Edit company",children:o.jsx(Y,{name:"Edit2",size:16})}),(c("companies.delete_all")||c("companies.delete_own"))&&o.jsx("button",{onClick:p=>{p.stopPropagation(),window.confirm("Are you sure you want to delete this company?")&&(r==null||r(h==null?void 0:h.id))},className:"p-1.5 rounded-lg bg-surface/80 backdrop-blur-sm text-text-tertiary hover:text-error hover:bg-error-50 dark:hover:bg-error-900/50 transition-all",title:"Delete company",children:o.jsx(Y,{name:"Trash2",size:16})})]}),i&&o.jsx("div",{className:"absolute top-3 left-3",onClick:p=>p.stopPropagation(),children:o.jsx("input",{type:"checkbox",checked:a==null?void 0:a.includes(h==null?void 0:h.id),onChange:()=>i(h==null?void 0:h.id),className:"w-4 h-4 text-primary border-border rounded focus:ring-primary"})}),o.jsx("div",{className:"flex justify-center mb-3",children:o.jsx("div",{className:"relative",children:h!=null&&h.logo_url?o.jsx(Io,{src:h.logo_url,alt:h.name,className:"w-20 h-20 rounded-full object-cover border-4 border-surface shadow-md"}):o.jsx("div",{className:"w-20 h-20 rounded-full bg-surface border-4 border-surface shadow-md flex items-center justify-center",children:o.jsx(Y,{name:d(h==null?void 0:h.industry),size:32,className:"text-primary"})})})}),o.jsx("h3",{className:"text-center text-lg font-semibold text-gray-900 dark:text-white truncate px-8",children:(h==null?void 0:h.name)||"Unnamed Company"}),(h==null?void 0:h.industry)&&o.jsx("div",{className:"flex justify-center mt-2",children:o.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-surface border border-border",children:h.industry})})]}),o.jsxs("div",{className:"p-4 space-y-3",children:[(h==null?void 0:h.size)&&o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Size:"}),o.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${f(h.size)}`,children:h.size})]}),((h==null?void 0:h.city)||(h==null?void 0:h.state)||(h==null?void 0:h.country))&&o.jsxs("div",{className:"flex items-start space-x-2",children:[o.jsx(Y,{name:"MapPin",size:14,className:"text-text-tertiary flex-shrink-0 mt-0.5"}),o.jsx("span",{className:"text-sm text-text-secondary truncate",children:[h==null?void 0:h.city,h==null?void 0:h.state,h==null?void 0:h.country].filter(Boolean).join(", ")})]}),(h==null?void 0:h.website)&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:"Globe",size:14,className:"text-text-tertiary flex-shrink-0"}),o.jsx("a",{href:h.website.startsWith("http")?h.website:`https://${h.website}`,target:"_blank",rel:"noopener noreferrer",onClick:p=>p.stopPropagation(),className:"text-sm text-primary hover:underline truncate",children:h.website.replace(/^https?:\/\//i,"")})]}),(h==null?void 0:h.phone)&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:"Phone",size:14,className:"text-text-tertiary flex-shrink-0"}),o.jsx("span",{className:"text-sm text-text-secondary truncate",children:h.phone})]}),(h==null?void 0:h.email)&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:"Mail",size:14,className:"text-text-tertiary flex-shrink-0"}),o.jsx("span",{className:"text-sm text-text-secondary truncate",children:h.email})]}),(h==null?void 0:h.revenue)&&o.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-border",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Revenue:"}),o.jsxs("span",{className:"text-sm font-semibold text-success",children:["$",h.revenue.toLocaleString()]})]}),o.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-border text-xs",children:[o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(Y,{name:"Users",size:12,className:"text-text-tertiary"}),o.jsxs("span",{className:"text-text-secondary",children:[((m=h==null?void 0:h.contacts)==null?void 0:m.length)||0," contacts"]})]}),o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(Y,{name:"Target",size:12,className:"text-text-tertiary"}),o.jsxs("span",{className:"text-text-secondary",children:[((x=h==null?void 0:h.deals)==null?void 0:x.length)||0," deals"]})]})]}),o.jsx("div",{className:"flex items-center justify-center pt-2 border-t border-border",children:o.jsxs("span",{className:"text-xs text-text-tertiary",children:["Created ",u(h==null?void 0:h.created_at)]})})]})]})},h==null?void 0:h.id)})})},LWe=({company:e,onEdit:t,onDelete:r,onClose:n})=>{const[a,i]=M.useState("overview"),[s,l]=M.useState([]),[c,u]=M.useState(!1),[d,f]=M.useState([]),[h,m]=M.useState(!1),{hasPermission:x}=Vt();if(!e)return null;M.useEffect(()=>{(async()=>{if(e!=null&&e.id)try{u(!0);const _=(await Ct.getUserContacts()).filter(D=>D.company_id===e.id);l(_)}catch(w){console.error("Error fetching company contacts:",w),l([])}finally{u(!1)}})()},[e==null?void 0:e.id]),M.useEffect(()=>{(async()=>{if(e!=null&&e.id)try{m(!0);const _=(await gt.getUserDeals()).filter(D=>D.company_id===e.id);f(_)}catch(w){console.error("Error fetching company deals:",w),f([])}finally{m(!1)}})()},[e==null?void 0:e.id]);const p=b=>{if(!b)return"N/A";try{return Si(new Date(b),"MMM d, yyyy")}catch{return"Invalid date"}},v=(()=>{const b=d.reduce((S,E)=>{const A=typeof E.value=="string"?parseFloat(E.value):E.value||0;return S+(isNaN(A)?0:A)},0),w=d.filter(S=>S.stage&&S.stage.toLowerCase()==="closed_won").length,_=d.filter(S=>S.stage&&S.stage.toLowerCase()==="closed_lost").length,D=d.filter(S=>!S.stage||!["closed_won","closed_lost"].includes(S.stage.toLowerCase())).length,j=w+_,N=j>0?(w/j*100).toFixed(1):0;return{totalValue:b,wonDeals:w,lostDeals:_,activeDeals:D,winRate:N}})(),y=b=>({technology:"Laptop",healthcare:"Heart",finance:"DollarSign",retail:"ShoppingCart",manufacturing:"Settings",education:"GraduationCap","real estate":"Home",consulting:"Briefcase",media:"Tv",transportation:"Truck"})[b==null?void 0:b.toLowerCase()]||"Building2";return o.jsxs("div",{className:"h-full flex flex-col",children:[o.jsxs("div",{className:"flex-shrink-0 p-6 border-b border-border bg-gradient-to-br from-primary-50 to-primary-100 dark:from-gray-800 dark:to-gray-750",children:[o.jsxs("div",{className:"flex items-start justify-between mb-4",children:[o.jsxs("div",{className:"flex items-start space-x-4 flex-1",children:[e!=null&&e.logo_url?o.jsx(Io,{src:e.logo_url,alt:e.name,className:"w-20 h-20 rounded-lg object-cover border-4 border-surface shadow-md"}):o.jsx("div",{className:"w-20 h-20 rounded-lg bg-surface border-4 border-surface shadow-md flex items-center justify-center",children:o.jsx(Y,{name:y(e==null?void 0:e.industry),size:32,className:"text-primary"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:(e==null?void 0:e.name)||"Unnamed Company"}),(e==null?void 0:e.industry)&&o.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-surface border border-border",children:e.industry})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[(x("companies.edit_all")||x("companies.edit_own"))&&o.jsx("button",{onClick:t,className:"p-2 text-text-secondary hover:text-primary hover:bg-primary-50 rounded-lg transition-colors",title:"Edit company",children:o.jsx(Y,{name:"Edit2",size:20})}),(x("companies.delete_all")||x("companies.delete_own"))&&o.jsx("button",{onClick:r,className:"p-2 text-text-secondary hover:text-error hover:bg-error-50 rounded-lg transition-colors",title:"Delete company",children:o.jsx(Y,{name:"Trash2",size:20})}),o.jsx("button",{onClick:n,className:"p-2 text-text-secondary hover:text-text-primary rounded-lg transition-colors",title:"Close",children:o.jsx(Y,{name:"X",size:20})})]})]}),o.jsxs("div",{className:"grid grid-cols-4 gap-4 mt-4",children:[o.jsxs("div",{className:"bg-surface rounded-lg p-3 border border-border",children:[o.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Contacts"}),o.jsx("div",{className:"text-xl font-bold text-text-primary",children:s.length})]}),o.jsxs("div",{className:"bg-surface rounded-lg p-3 border border-border",children:[o.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Deals"}),o.jsx("div",{className:"text-xl font-bold text-text-primary",children:d.length})]}),o.jsxs("div",{className:"bg-surface rounded-lg p-3 border border-border",children:[o.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Deal Value"}),o.jsxs("div",{className:"text-xl font-bold text-success",children:["$",v.totalValue.toLocaleString()]})]}),o.jsxs("div",{className:"bg-surface rounded-lg p-3 border border-border",children:[o.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Win Rate"}),o.jsxs("div",{className:"text-xl font-bold text-text-primary",children:[v.winRate,"%"]})]})]})]}),o.jsx("div",{className:"flex-shrink-0 border-b border-border bg-surface",children:o.jsx("div",{className:"px-6",children:o.jsxs("div",{className:"flex space-x-6",children:[o.jsx("button",{onClick:()=>i("overview"),className:`py-3 px-1 border-b-2 transition-colors ${a==="overview"?"border-primary text-primary font-medium":"border-transparent text-text-secondary hover:text-text-primary"}`,children:"Overview"}),o.jsxs("button",{onClick:()=>i("contacts"),className:`py-3 px-1 border-b-2 transition-colors ${a==="contacts"?"border-primary text-primary font-medium":"border-transparent text-text-secondary hover:text-text-primary"}`,children:["Contacts (",s.length,")"]}),o.jsxs("button",{onClick:()=>i("deals"),className:`py-3 px-1 border-b-2 transition-colors ${a==="deals"?"border-primary text-primary font-medium":"border-transparent text-text-secondary hover:text-text-primary"}`,children:["Deals (",d.length,")"]}),o.jsx("button",{onClick:()=>i("insights"),className:`py-3 px-1 border-b-2 transition-colors ${a==="insights"?"border-primary text-primary font-medium":"border-transparent text-text-secondary hover:text-text-primary"}`,children:"Insights"})]})})}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[a==="overview"&&o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[o.jsx(Y,{name:"Building2",size:20,className:"mr-2"}),"Company Information"]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[(e==null?void 0:e.size)&&o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"Company Size"}),o.jsx("div",{className:"text-text-primary",children:e.size})]}),(e==null?void 0:e.revenue)&&o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"Annual Revenue"}),o.jsxs("div",{className:"text-text-primary",children:["$",e.revenue.toLocaleString()]})]}),(e==null?void 0:e.website)&&o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"Website"}),o.jsxs("a",{href:e.website.startsWith("http")?e.website:`https://${e.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline flex items-center space-x-1",children:[o.jsx(Y,{name:"Globe",size:14}),o.jsx("span",{children:e.website.replace(/^https?:\/\//i,"")})]})]}),(e==null?void 0:e.created_at)&&o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"Added"}),o.jsx("div",{className:"text-text-primary",children:p(e.created_at)})]})]})]}),o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[o.jsx(Y,{name:"Phone",size:20,className:"mr-2"}),"Contact Information"]}),o.jsxs("div",{className:"space-y-3",children:[(e==null?void 0:e.phone)&&o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Y,{name:"Phone",size:16,className:"text-text-tertiary"}),o.jsx("a",{href:`tel:${e.phone}`,className:"text-primary hover:underline",children:e.phone})]}),(e==null?void 0:e.email)&&o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Y,{name:"Mail",size:16,className:"text-text-tertiary"}),o.jsx("a",{href:`mailto:${e.email}`,className:"text-primary hover:underline",children:e.email})]}),((e==null?void 0:e.address)||(e==null?void 0:e.city)||(e==null?void 0:e.state)||(e==null?void 0:e.country))&&o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx(Y,{name:"MapPin",size:16,className:"text-text-tertiary mt-0.5"}),o.jsxs("div",{className:"text-text-primary",children:[(e==null?void 0:e.address)&&o.jsx("div",{children:e.address}),((e==null?void 0:e.city)||(e==null?void 0:e.state)||(e==null?void 0:e.zip_code))&&o.jsx("div",{children:[e==null?void 0:e.city,e==null?void 0:e.state,e==null?void 0:e.zip_code].filter(Boolean).join(", ")}),(e==null?void 0:e.country)&&o.jsx("div",{children:e.country})]})]})]})]}),(e==null?void 0:e.description)&&o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[o.jsx(Y,{name:"FileText",size:20,className:"mr-2"}),"Description"]}),o.jsx("p",{className:"text-text-secondary whitespace-pre-wrap",children:e.description})]}),(e==null?void 0:e.custom_fields)&&Object.keys(e.custom_fields).length>0&&o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[o.jsx(Y,{name:"Settings",size:20,className:"mr-2"}),"Additional Information"]}),o.jsx("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(e.custom_fields).map(([b,w])=>o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-text-secondary mb-1",children:w.name||b}),o.jsx("div",{className:"text-text-primary",children:w.value!==null&&w.value!==void 0?String(w.value):"N/A"})]},b))})]})]}),a==="contacts"&&o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Associated Contacts"}),x("contacts.create")&&o.jsxs(Ur,{to:"/contact-management",className:"text-primary hover:underline text-sm flex items-center space-x-1",children:[o.jsx(Y,{name:"Plus",size:14}),o.jsx("span",{children:"Add Contact"})]})]}),c?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):s.length>0?o.jsx("div",{className:"space-y-3",children:s.map(b=>o.jsx(Ur,{to:`/contact-management?contactId=${b.id}`,className:"block p-4 bg-surface border border-border rounded-lg hover:shadow-md transition-all",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Io,{src:(b==null?void 0:b.avatar_url)||"/assets/images/no_image.png",alt:b.full_name,className:"w-10 h-10 rounded-full object-cover"}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-text-primary",children:b.full_name}),o.jsx("div",{className:"text-sm text-text-secondary",children:b.position||"No position"})]})]}),o.jsxs("div",{className:"flex items-center space-x-4 text-sm text-text-secondary",children:[b.email&&o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(Y,{name:"Mail",size:14}),o.jsx("span",{children:b.email})]}),b.phone&&o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(Y,{name:"Phone",size:14}),o.jsx("span",{children:b.phone})]})]})]})},b.id))}):o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Y,{name:"Users",size:32,className:"text-text-tertiary mx-auto mb-2"}),o.jsx("p",{className:"text-text-secondary",children:"No contacts associated with this company"})]})]}),a==="deals"&&o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Associated Deals"}),x("deals.create")&&o.jsxs(Ur,{to:"/deal-management/new",className:"text-primary hover:underline text-sm flex items-center space-x-1",children:[o.jsx(Y,{name:"Plus",size:14}),o.jsx("span",{children:"Add Deal"})]})]}),h?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):d.length>0?o.jsx("div",{className:"space-y-3",children:d.map(b=>{var w,_;return o.jsxs(Ur,{to:`/deal-management/${b.id}`,className:"block p-4 bg-surface border border-border rounded-lg hover:shadow-md transition-all",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("div",{className:"font-medium text-text-primary",children:b.name}),o.jsxs("div",{className:"text-success font-semibold",children:["$",((w=b.value)==null?void 0:w.toLocaleString())||0]})]}),o.jsxs("div",{className:"flex items-center justify-between text-sm text-text-secondary",children:[o.jsx("span",{className:"capitalize",children:(_=b.stage)==null?void 0:_.replace("_"," ")}),o.jsx("span",{children:p(b.expected_close_date)})]})]},b.id)})}):o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Y,{name:"Target",size:32,className:"text-text-tertiary mx-auto mb-2"}),o.jsx("p",{className:"text-text-secondary",children:"No deals associated with this company"})]})]}),a==="insights"&&o.jsxs("div",{className:"space-y-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Company Insights"}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"p-4 bg-success-50 border border-success-200 rounded-lg",children:[o.jsx("div",{className:"text-sm text-success-700 mb-1",children:"Won Deals"}),o.jsx("div",{className:"text-2xl font-bold text-success",children:v.wonDeals})]}),o.jsxs("div",{className:"p-4 bg-error-50 border border-error-200 rounded-lg",children:[o.jsx("div",{className:"text-sm text-error-700 mb-1",children:"Lost Deals"}),o.jsx("div",{className:"text-2xl font-bold text-error",children:v.lostDeals})]}),o.jsxs("div",{className:"p-4 bg-primary-50 border border-primary-200 rounded-lg",children:[o.jsx("div",{className:"text-sm text-primary-700 mb-1",children:"Active Deals"}),o.jsx("div",{className:"text-2xl font-bold text-primary",children:v.activeDeals})]}),o.jsxs("div",{className:"p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[o.jsx("div",{className:"text-sm text-orange-700 mb-1",children:"Total Deal Value"}),o.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:["$",v.totalValue.toLocaleString()]})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Engagement Summary"}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Total Contacts:"}),o.jsx("span",{className:"font-medium text-text-primary",children:s.length})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Total Deals:"}),o.jsx("span",{className:"font-medium text-text-primary",children:d.length})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Win Rate:"}),o.jsxs("span",{className:"font-medium text-text-primary",children:[v.winRate,"%"]})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Average Deal Value:"}),o.jsxs("span",{className:"font-medium text-text-primary",children:["$",d.length>0?(v.totalValue/d.length).toLocaleString(void 0,{maximumFractionDigits:0}):0]})]})]})]})]})]})]})},BWe=({company:e=null,onSubmit:t,onCancel:r})=>{const{user:n}=Vt(),[a,i]=M.useState(!1),[s,l]=M.useState([]),[c,u]=M.useState({}),[d,f]=M.useState(!1),[h,m]=M.useState({name:"",industry:"",size:"",website:"",phone:"",email:"",address:"",city:"",state:"",zip_code:"",country:"",description:"",revenue:"",owner_id:(n==null?void 0:n.id)||""}),[x,p]=M.useState({}),g=["Technology","Healthcare","Finance","Retail","Manufacturing","Education","Real Estate","Consulting","Media","Transportation","Energy","Hospitality","Telecommunications","Agriculture","Construction","Legal","Other"],v=["Small (1-50)","Medium (51-250)","Large (251-1000)","Enterprise (1000+)"];M.useEffect(()=>{if(y(),e)if(m({name:(e==null?void 0:e.name)||"",industry:(e==null?void 0:e.industry)||"",size:(e==null?void 0:e.size)||"",website:(e==null?void 0:e.website)||"",phone:(e==null?void 0:e.phone)||"",email:(e==null?void 0:e.email)||"",address:(e==null?void 0:e.address)||"",city:(e==null?void 0:e.city)||"",state:(e==null?void 0:e.state)||"",zip_code:(e==null?void 0:e.zip_code)||"",country:(e==null?void 0:e.country)||"",description:(e==null?void 0:e.description)||"",revenue:(e==null?void 0:e.revenue)||"",owner_id:(e==null?void 0:e.owner_id)||(n==null?void 0:n.id)||""}),e!=null&&e.custom_fields){const N={};Object.entries(e.custom_fields).forEach(([S,E])=>{(E==null?void 0:E.value)!==null&&(E==null?void 0:E.value)!==void 0&&(N[S]=E.value)}),u(N)}else e!=null&&e.id&&b(e.id)},[e,n]);const y=async()=>{f(!0);try{const N=await as.getAllFields({entity_type:"company",is_active:!0}),S=N==null?void 0:N.filter(E=>E.placement==="form"||E.placement==="both");l(S||[])}catch(N){console.error("Error loading custom fields:",N)}finally{f(!1)}},b=async N=>{try{const S=await as.getEntityCustomFields("company",N),E={};S==null||S.forEach(A=>{E[A.field_key]=A.current_value}),u(E)}catch(S){console.error("Error loading custom field values:",S)}},w=N=>{const{name:S,value:E}=N.target;m(A=>({...A,[S]:E})),x[S]&&p(A=>({...A,[S]:null}))},_=(N,S)=>{u(E=>({...E,[N]:S}))},D=()=>{var S;const N={};return(S=h.name)!=null&&S.trim()||(N.name="Company name is required"),h.email&&!h.email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)&&(N.email="Please enter a valid email address"),h.website&&!h.website.match(/^[a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0-9]?\.[a-zA-Z]{2,}$/)&&h.website.match(/^https?:\/\//),h.revenue&&isNaN(h.revenue)&&(N.revenue="Revenue must be a number"),s==null||s.forEach(E=>{const A=E.field_key||E.id;E.is_required&&!c[A]&&(N[`custom_${A}`]=`${E.name} is required`)}),N},j=async N=>{N.preventDefault();const S=D();if(Object.keys(S).length>0){p(S);return}i(!0);try{const E={...h,revenue:h.revenue?parseInt(h.revenue):null,custom_fields:c};await t(E)}catch(E){console.error("Error submitting form:",E),p({submit:(E==null?void 0:E.message)||"Failed to save company"})}finally{i(!1)}};return o.jsxs("form",{onSubmit:j,className:"p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:e?"Edit Company":"Add New Company"}),o.jsx("button",{type:"button",onClick:r,className:"p-2 text-text-tertiary hover:text-text-primary transition-colors",children:o.jsx(Y,{name:"X",size:20})})]}),x.submit&&o.jsxs("div",{className:"mb-6 p-4 bg-error-50 border border-error-200 rounded-lg flex items-start space-x-3",children:[o.jsx(Y,{name:"AlertCircle",size:20,className:"text-error flex-shrink-0 mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-error font-medium",children:"Error"}),o.jsx("p",{className:"text-error-600 text-sm",children:x.submit})]})]}),o.jsxs("div",{className:"space-y-6 max-h-[calc(100vh-250px)] overflow-y-auto pr-2",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[o.jsx(Y,{name:"Building2",size:20,className:"mr-2"}),"Basic Information"]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"md:col-span-2",children:[o.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["Company Name ",o.jsx("span",{className:"text-error",children:"*"})]}),o.jsx("input",{type:"text",name:"name",value:h.name,onChange:w,placeholder:"Acme Corporation",className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary ${x.name?"border-error":"border-border"}`}),x.name&&o.jsx("p",{className:"text-error text-sm mt-1",children:x.name})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Industry"}),o.jsxs("select",{name:"industry",value:h.industry,onChange:w,className:"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",children:[o.jsx("option",{value:"",children:"Select Industry"}),g.map(N=>o.jsx("option",{value:N,children:N},N))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Company Size"}),o.jsxs("select",{name:"size",value:h.size,onChange:w,className:"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",children:[o.jsx("option",{value:"",children:"Select Size"}),v.map(N=>o.jsx("option",{value:N,children:N},N))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Website"}),o.jsx("input",{type:"text",name:"website",value:h.website,onChange:w,placeholder:"www.example.com",className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary ${x.website?"border-error":"border-border"}`}),x.website&&o.jsx("p",{className:"text-error text-sm mt-1",children:x.website})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Annual Revenue ($)"}),o.jsx("input",{type:"number",name:"revenue",value:h.revenue,onChange:w,placeholder:"1000000",className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary ${x.revenue?"border-error":"border-border"}`}),x.revenue&&o.jsx("p",{className:"text-error text-sm mt-1",children:x.revenue})]})]})]}),o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[o.jsx(Y,{name:"Phone",size:20,className:"mr-2"}),"Contact Information"]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Phone"}),o.jsx("input",{type:"tel",name:"phone",value:h.phone,onChange:w,placeholder:"+1 (555) 123-4567",className:"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Email"}),o.jsx("input",{type:"email",name:"email",value:h.email,onChange:w,placeholder:"info@company.com",className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary ${x.email?"border-error":"border-border"}`}),x.email&&o.jsx("p",{className:"text-error text-sm mt-1",children:x.email})]})]})]}),o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[o.jsx(Y,{name:"MapPin",size:20,className:"mr-2"}),"Address"]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Street Address"}),o.jsx("input",{type:"text",name:"address",value:h.address,onChange:w,placeholder:"123 Business St, Suite 100",className:"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"City"}),o.jsx("input",{type:"text",name:"city",value:h.city,onChange:w,placeholder:"San Francisco",className:"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"State / Province"}),o.jsx("input",{type:"text",name:"state",value:h.state,onChange:w,placeholder:"CA",className:"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Zip / Postal Code"}),o.jsx("input",{type:"text",name:"zip_code",value:h.zip_code,onChange:w,placeholder:"94102",className:"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Country"}),o.jsx("input",{type:"text",name:"country",value:h.country,onChange:w,placeholder:"United States",className:"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]})]})]}),o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[o.jsx(Y,{name:"FileText",size:20,className:"mr-2"}),"Description"]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Company Description / Notes"}),o.jsx("textarea",{name:"description",value:h.description,onChange:w,placeholder:"Add any additional information about the company...",rows:4,className:"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary resize-none"})]})]}),(s==null?void 0:s.length)>0&&o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[o.jsx(Y,{name:"Settings",size:20,className:"mr-2"}),"Additional Information"]}),d?o.jsx("div",{className:"text-center py-4",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"})}):o.jsx(vb,{fields:s,values:c,onChange:_,errors:x})]})]}),o.jsxs("div",{className:"flex items-center justify-end space-x-3 mt-6 pt-6 border-t border-border",children:[o.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 border border-border rounded-lg text-text-secondary hover:bg-surface-hover transition-colors",disabled:a,children:"Cancel"}),o.jsxs("button",{type:"submit",className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",disabled:a,children:[a&&o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),o.jsx("span",{children:a?"Saving...":e?"Update Company":"Create Company"})]})]})]})},WWe=({filters:e,onApplyFilters:t,onClearFilters:r,onClose:n})=>{var g,v;const[a,i]=M.useState(e),s=["Technology","Healthcare","Finance","Retail","Manufacturing","Education","Real Estate","Consulting","Media","Transportation","Energy","Hospitality","Telecommunications","Agriculture","Construction","Legal","Other"],l=["Small (1-50)","Medium (51-250)","Large (251-1000)","Enterprise (1000+)"],c=y=>{i(b=>({...b,industry:b.industry.includes(y)?b.industry.filter(w=>w!==y):[...b.industry,y]}))},u=y=>{i(b=>({...b,size:b.size.includes(y)?b.size.filter(w=>w!==y):[...b.size,y]}))},d=y=>{y&&!a.location.includes(y)&&i(b=>({...b,location:[...b.location,y]}))},f=y=>{i(b=>({...b,location:b.location.filter(w=>w!==y)}))},h=(y,b)=>{i(w=>({...w,revenueRange:{...w.revenueRange,[y]:b?parseInt(b):null}}))},m=()=>{t(a)},x=()=>{i({industry:[],size:[],location:[],revenueRange:null}),r()},p=a.industry.length>0||a.size.length>0||a.location.length>0||a.revenueRange&&(a.revenueRange.min||a.revenueRange.max);return o.jsxs("div",{className:"mb-6 p-6 bg-surface border border-border rounded-lg",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-text-primary flex items-center",children:[o.jsx(Y,{name:"Filter",size:20,className:"mr-2"}),"Filter Companies"]}),o.jsx("button",{onClick:n,className:"p-1 text-text-tertiary hover:text-text-primary transition-colors",children:o.jsx(Y,{name:"X",size:20})})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Industry"}),o.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:s.map(y=>o.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-surface-hover p-2 rounded transition-colors",children:[o.jsx("input",{type:"checkbox",checked:a.industry.includes(y),onChange:()=>c(y),className:"w-4 h-4 text-primary border-border rounded focus:ring-primary"}),o.jsx("span",{className:"text-sm text-text-secondary",children:y})]},y))})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Company Size"}),o.jsx("div",{className:"space-y-2",children:l.map(y=>o.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-surface-hover p-2 rounded transition-colors",children:[o.jsx("input",{type:"checkbox",checked:a.size.includes(y),onChange:()=>u(y),className:"w-4 h-4 text-primary border-border rounded focus:ring-primary"}),o.jsx("span",{className:"text-sm text-text-secondary",children:y})]},y))})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Location"}),o.jsxs("div",{className:"space-y-3",children:[o.jsx("input",{type:"text",placeholder:"Enter city or state",onKeyPress:y=>{y.key==="Enter"&&(d(y.target.value),y.target.value="")},className:"w-full px-3 py-2 border border-border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary"}),a.location.length>0&&o.jsx("div",{className:"flex flex-wrap gap-2",children:a.location.map(y=>o.jsxs("span",{className:"inline-flex items-center space-x-1 px-2 py-1 bg-primary-50 text-primary text-xs rounded-full",children:[o.jsx("span",{children:y}),o.jsx("button",{onClick:()=>f(y),className:"hover:text-primary-700",children:o.jsx(Y,{name:"X",size:12})})]},y))})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Revenue Range ($)"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-secondary mb-1 block",children:"Minimum"}),o.jsx("input",{type:"number",placeholder:"0",value:((g=a.revenueRange)==null?void 0:g.min)||"",onChange:y=>h("min",y.target.value),className:"w-full px-3 py-2 border border-border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-secondary mb-1 block",children:"Maximum"}),o.jsx("input",{type:"number",placeholder:"No limit",value:((v=a.revenueRange)==null?void 0:v.max)||"",onChange:y=>h("max",y.target.value),className:"w-full px-3 py-2 border border-border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary"})]})]})]})]}),o.jsxs("div",{className:"flex items-center justify-between mt-6 pt-6 border-t border-border",children:[o.jsx("button",{onClick:x,disabled:!p,className:"text-text-secondary hover:text-text-primary disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Clear All Filters"}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("button",{onClick:n,className:"px-4 py-2 border border-border rounded-lg text-text-secondary hover:bg-surface-hover transition-colors",children:"Cancel"}),o.jsx("button",{onClick:m,className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-600 transition-colors",children:"Apply Filters"})]})]})]})},zWe=({stats:e,className:t=""})=>{if(!e)return null;const r=Object.entries(e.industries||{}).sort(([,i],[,s])=>s-i).slice(0,5),n=Object.entries(e.sizes||{}).sort(([,i],[,s])=>s-i).slice(0,4),a=i=>{const s=["bg-blue-100 text-blue-700","bg-green-100 text-green-700","bg-purple-100 text-purple-700","bg-orange-100 text-orange-700","bg-pink-100 text-pink-700"];return s[i%s.length]};return o.jsxs("div",{className:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 ${t}`,children:[o.jsxs("div",{className:"bg-surface border border-border rounded-lg p-4 hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("div",{className:"p-2 bg-primary-50 rounded-lg",children:o.jsx(Y,{name:"Building2",size:20,className:"text-primary"})}),o.jsx("span",{className:"text-xs text-text-tertiary",children:"Total"})]}),o.jsx("div",{className:"text-2xl font-bold text-text-primary",children:e.total||0}),o.jsx("div",{className:"text-sm text-text-secondary",children:"Companies"})]}),o.jsxs("div",{className:"bg-surface border border-border rounded-lg p-4 hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("div",{className:"p-2 bg-success-50 rounded-lg",children:o.jsx(Y,{name:"TrendingUp",size:20,className:"text-success"})}),o.jsx("span",{className:"text-xs text-text-tertiary",children:"Last 30 days"})]}),o.jsx("div",{className:"text-2xl font-bold text-text-primary",children:e.recentlyAdded||0}),o.jsx("div",{className:"text-sm text-text-secondary",children:"Recently Added"})]}),o.jsxs("div",{className:"bg-surface border border-border rounded-lg p-4 hover:shadow-md transition-shadow",children:[o.jsx("div",{className:"flex items-center justify-between mb-3",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"p-2 bg-purple-50 rounded-lg",children:o.jsx(Y,{name:"Briefcase",size:20,className:"text-purple-600"})}),o.jsx("span",{className:"text-sm font-medium text-text-primary",children:"Top Industries"})]})}),o.jsx("div",{className:"space-y-2",children:r.length>0?r.slice(0,3).map(([i,s],l)=>o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${a(l)}`,children:i}),o.jsx("span",{className:"text-text-secondary",children:s})]},i)):o.jsx("p",{className:"text-xs text-text-tertiary",children:"No data"})})]}),o.jsxs("div",{className:"bg-surface border border-border rounded-lg p-4 hover:shadow-md transition-shadow",children:[o.jsx("div",{className:"flex items-center justify-between mb-3",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"p-2 bg-orange-50 rounded-lg",children:o.jsx(Y,{name:"Users",size:20,className:"text-orange-600"})}),o.jsx("span",{className:"text-sm font-medium text-text-primary",children:"By Size"})]})}),o.jsx("div",{className:"space-y-2",children:n.length>0?n.map(([i,s])=>o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-xs text-text-secondary capitalize",children:i}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"w-20 bg-border rounded-full h-1.5 overflow-hidden",children:o.jsx("div",{className:"bg-primary h-full rounded-full transition-all",style:{width:`${s/e.total*100}%`}})}),o.jsx("span",{className:"text-xs font-medium text-text-primary w-6 text-right",children:s})]})]},i)):o.jsx("p",{className:"text-xs text-text-tertiary",children:"No data"})})]})]})},HWe=({onClose:e,onSuccess:t})=>{const[r,n]=M.useState(null),[a,i]=M.useState([]),[s,l]=M.useState(!1),[c,u]=M.useState(""),[d,f]=M.useState({current:0,total:0}),h=p=>{const g=p.target.files[0];if(g){if(!g.name.endsWith(".csv")&&!g.name.endsWith(".xlsx")){u("Please upload a CSV file");return}n(g),u(""),Rm.parse(g,{header:!0,preview:5,complete:v=>{i(v.data)},error:v=>{u("Failed to parse file: "+v.message)}})}},m=async()=>{if(!r){u("Please select a file");return}l(!0),u(""),Rm.parse(r,{header:!0,skipEmptyLines:!0,complete:async p=>{const g=p.data;f({current:0,total:g.length});try{const v=[];for(let y=0;y<g.length;y++){const b=g[y],w={name:b.name||b.Name||b.company_name,industry:b.industry||b.Industry||null,size:b.size||b.Size||b.company_size||null,website:b.website||b.Website||null,phone:b.phone||b.Phone||null,email:b.email||b.Email||null,address:b.address||b.Address||null,city:b.city||b.City||null,state:b.state||b.State||null,zip_code:b.zip_code||b["Zip Code"]||null,country:b.country||b.Country||null,description:b.description||b.Description||null,revenue:b.revenue||b.Revenue?parseInt(b.revenue||b.Revenue):null};if(w.name)try{const _=await Zt.createCompany(w);v.push(_),f({current:y+1,total:g.length})}catch(_){console.error(`Failed to import company ${w.name}:`,_)}}l(!1),t(v)}catch(v){console.error("Import error:",v),u("Failed to import companies: "+v.message),l(!1)}},error:p=>{u("Failed to parse file: "+p.message),l(!1)}})},x=()=>{const p=`name,industry,size,website,phone,email,address,city,state,zip_code,country,revenue,description
Acme Corporation,Technology,Large (251-1000),www.acme.com,+1-555-123-4567,info@acme.com,123 Tech St,San Francisco,CA,94102,United States,5000000,Leading technology company
Example Inc,Healthcare,Medium (51-250),www.example.com,+1-555-987-6543,contact@example.com,456 Health Ave,Boston,MA,02101,United States,2000000,Healthcare provider`,g=new Blob([p],{type:"text/csv"}),v=window.URL.createObjectURL(g),y=document.createElement("a");y.href=v,y.download="companies_import_template.csv",y.click(),window.URL.revokeObjectURL(v)};return o.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-surface rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-hidden",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border",children:[o.jsxs("h2",{className:"text-xl font-bold text-text-primary flex items-center",children:[o.jsx(Y,{name:"Upload",size:24,className:"mr-2"}),"Import Companies"]}),o.jsx("button",{onClick:e,className:"p-2 text-text-tertiary hover:text-text-primary transition-colors",disabled:s,children:o.jsx(Y,{name:"X",size:20})})]}),o.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-180px)]",children:[o.jsxs("div",{className:"mb-6 p-4 bg-primary-50 border border-primary-200 rounded-lg",children:[o.jsxs("h3",{className:"font-semibold text-primary mb-2 flex items-center",children:[o.jsx(Y,{name:"Info",size:18,className:"mr-2"}),"Instructions"]}),o.jsxs("ul",{className:"text-sm text-primary-700 space-y-1 ml-6 list-disc",children:[o.jsx("li",{children:"Upload a CSV file with company information"}),o.jsx("li",{children:"Required field: name (company name)"}),o.jsx("li",{children:"Optional fields: industry, size, website, phone, email, address, city, state, zip_code, country, revenue, description"}),o.jsx("li",{children:"Download the template below for reference"})]})]}),o.jsx("div",{className:"mb-6",children:o.jsxs("button",{onClick:x,className:"inline-flex items-center space-x-2 px-4 py-2 border border-border rounded-lg text-text-secondary hover:bg-surface-hover transition-colors",children:[o.jsx(Y,{name:"Download",size:18}),o.jsx("span",{children:"Download CSV Template"})]})}),o.jsxs("div",{className:"mb-6",children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Select CSV File"}),o.jsx("div",{className:"relative",children:o.jsx("input",{type:"file",accept:".csv",onChange:h,disabled:s,className:`block w-full text-sm text-text-secondary\r
                  file:mr-4 file:py-2 file:px-4\r
                  file:rounded-lg file:border-0\r
                  file:text-sm file:font-medium\r
                  file:bg-primary file:text-white\r
                  hover:file:bg-primary-600\r
                  file:cursor-pointer cursor-pointer\r
                  disabled:opacity-50 disabled:cursor-not-allowed`})}),r&&o.jsxs("p",{className:"mt-2 text-sm text-text-secondary",children:["Selected: ",r.name]})]}),c&&o.jsxs("div",{className:"mb-6 p-4 bg-error-50 border border-error-200 rounded-lg flex items-start space-x-3",children:[o.jsx(Y,{name:"AlertCircle",size:20,className:"text-error flex-shrink-0 mt-0.5"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-error font-medium",children:"Error"}),o.jsx("p",{className:"text-error-600 text-sm",children:c})]})]}),a.length>0&&!s&&o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"text-sm font-medium text-text-primary mb-3",children:"Preview (first 5 rows)"}),o.jsx("div",{className:"overflow-x-auto border border-border rounded-lg",children:o.jsxs("table",{className:"min-w-full divide-y divide-border",children:[o.jsx("thead",{className:"bg-surface-hover",children:o.jsx("tr",{children:Object.keys(a[0]).map(p=>o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:p},p))})}),o.jsx("tbody",{className:"divide-y divide-border",children:a.map((p,g)=>o.jsx("tr",{className:"hover:bg-surface-hover",children:Object.values(p).map((v,y)=>o.jsx("td",{className:"px-4 py-3 text-sm text-text-primary whitespace-nowrap",children:v||"-"},y))},g))})]})})]}),s&&o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Importing companies..."}),o.jsxs("span",{className:"text-sm font-medium text-text-primary",children:[d.current," / ",d.total]})]}),o.jsx("div",{className:"w-full bg-border rounded-full h-2 overflow-hidden",children:o.jsx("div",{className:"bg-primary h-full rounded-full transition-all duration-300",style:{width:`${d.current/d.total*100}%`}})})]})]}),o.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-border",children:[o.jsx("button",{onClick:e,disabled:s,className:"px-4 py-2 border border-border rounded-lg text-text-secondary hover:bg-surface-hover transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),o.jsxs("button",{onClick:m,disabled:!r||s,className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[s&&o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),o.jsx("span",{children:s?"Importing...":"Import Companies"})]})]})]})})},VWe=({companies:e,onClose:t})=>{const[r,n]=M.useState("csv"),[a,i]=M.useState(["name","industry","size","website","phone","email","city","state","country"]),[s,l]=M.useState(!1),c=[{key:"name",label:"Company Name"},{key:"industry",label:"Industry"},{key:"size",label:"Company Size"},{key:"website",label:"Website"},{key:"phone",label:"Phone"},{key:"email",label:"Email"},{key:"address",label:"Street Address"},{key:"city",label:"City"},{key:"state",label:"State"},{key:"zip_code",label:"Zip Code"},{key:"country",label:"Country"},{key:"revenue",label:"Revenue"},{key:"description",label:"Description"},{key:"created_at",label:"Created Date"},{key:"updated_at",label:"Updated Date"}],u=m=>{i(x=>x.includes(m)?x.filter(p=>p!==m):[...x,m])},d=()=>{a.length===c.length?i([]):i(c.map(m=>m.key))},f=(m,x)=>m==null?"":x==="created_at"||x==="updated_at"?new Date(m).toLocaleDateString():String(m),h=()=>{if(a.length===0){alert("Please select at least one field to export");return}l(!0);try{const m=e.map(x=>{const p={};return a.forEach(g=>{const v=c.find(y=>y.key===g);p[(v==null?void 0:v.label)||g]=f(x[g],g)}),p});if(r==="csv"){const x=Rm.unparse(m),p=new Blob([x],{type:"text/csv;charset=utf-8;"}),g=window.URL.createObjectURL(p),v=document.createElement("a");v.href=g,v.download=`companies_export_${new Date().toISOString().split("T")[0]}.csv`,v.click(),window.URL.revokeObjectURL(g)}else if(r==="json"){const x=JSON.stringify(m,null,2),p=new Blob([x],{type:"application/json"}),g=window.URL.createObjectURL(p),v=document.createElement("a");v.href=g,v.download=`companies_export_${new Date().toISOString().split("T")[0]}.json`,v.click(),window.URL.revokeObjectURL(g)}setTimeout(()=>{l(!1),t()},500)}catch(m){console.error("Export error:",m),alert("Failed to export companies. Please try again."),l(!1)}};return o.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border",children:[o.jsxs("h2",{className:"text-xl font-bold text-text-primary flex items-center",children:[o.jsx(Y,{name:"Download",size:24,className:"mr-2"}),"Export Companies"]}),o.jsx("button",{onClick:t,className:"p-2 text-text-tertiary hover:text-text-primary transition-colors",disabled:s,children:o.jsx(Y,{name:"X",size:20})})]}),o.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-180px)]",children:[o.jsx("div",{className:"mb-6 p-4 bg-primary-50 border border-primary-200 rounded-lg",children:o.jsxs("p",{className:"text-sm text-primary-700",children:[o.jsx(Y,{name:"Info",size:16,className:"inline mr-2"}),"Exporting ",o.jsx("span",{className:"font-semibold",children:e.length})," companies"]})}),o.jsxs("div",{className:"mb-6",children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-3",children:"Export Format"}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("button",{onClick:()=>n("csv"),className:`p-4 border-2 rounded-lg transition-all ${r==="csv"?"border-primary bg-primary-50":"border-border hover:border-primary/50"}`,children:[o.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[o.jsx(Y,{name:"FileText",size:20,className:r==="csv"?"text-primary":"text-text-secondary"}),o.jsx("span",{className:`font-medium ${r==="csv"?"text-primary":"text-text-secondary"}`,children:"CSV"})]}),o.jsx("p",{className:"text-xs text-text-tertiary mt-1",children:"Spreadsheet format"})]}),o.jsxs("button",{onClick:()=>n("json"),className:`p-4 border-2 rounded-lg transition-all ${r==="json"?"border-primary bg-primary-50":"border-border hover:border-primary/50"}`,children:[o.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[o.jsx(Y,{name:"Code",size:20,className:r==="json"?"text-primary":"text-text-secondary"}),o.jsx("span",{className:`font-medium ${r==="json"?"text-primary":"text-text-secondary"}`,children:"JSON"})]}),o.jsx("p",{className:"text-xs text-text-tertiary mt-1",children:"Data format"})]})]})]}),o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary",children:"Select Fields to Export"}),o.jsx("button",{onClick:d,className:"text-sm text-primary hover:underline",children:a.length===c.length?"Deselect All":"Select All"})]}),o.jsx("div",{className:"grid grid-cols-2 gap-3 max-h-64 overflow-y-auto p-3 border border-border rounded-lg",children:c.map(m=>o.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-surface-hover p-2 rounded transition-colors",children:[o.jsx("input",{type:"checkbox",checked:a.includes(m.key),onChange:()=>u(m.key),className:"w-4 h-4 text-primary border-border rounded focus:ring-primary"}),o.jsx("span",{className:"text-sm text-text-secondary",children:m.label})]},m.key))}),o.jsxs("p",{className:"text-xs text-text-tertiary mt-2",children:[a.length," of ",c.length," fields selected"]})]})]}),o.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-border",children:[o.jsx("button",{onClick:t,disabled:s,className:"px-4 py-2 border border-border rounded-lg text-text-secondary hover:bg-surface-hover transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),o.jsxs("button",{onClick:h,disabled:a.length===0||s,className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[s&&o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),o.jsx(Y,{name:"Download",size:18}),o.jsx("span",{children:s?"Exporting...":`Export ${r.toUpperCase()}`})]})]})]})})},R6=()=>{const{companyId:e}=Kj(),t=Il(),{user:r,hasPermission:n}=Vt(),[a,i]=M.useState([]),[s,l]=M.useState(!0),[c,u]=M.useState(null),[d,f]=M.useState([]),[h,m]=M.useState(""),[x,p]=M.useState(!1),[g,v]=M.useState(!1),[y,b]=M.useState(!1),[w,_]=M.useState(!1),[D,j]=M.useState("grid"),[N,S]=M.useState(!1),[E,A]=M.useState({industry:[],size:[],location:[],revenueRange:null}),[T,L]=M.useState(null),O=async()=>{try{l(!0);let ae=[];if(h?ae=await Zt.searchCompanies(h):Object.values(E).some(pe=>pe&&(Array.isArray(pe)?pe.length>0:!0))?ae=await Zt.filterCompanies(E):ae=await Zt.getAllCompanies(),i(ae||[]),e&&!c){const pe=await Zt.getCompanyById(e);pe&&(u(pe),j("split"))}}catch(ae){console.error("Error loading companies:",ae),Ue.error("Failed to load companies. Please try again.")}finally{l(!1)}},V=async()=>{try{const ae=await Zt.getCompanyStats();L(ae)}catch(ae){console.error("Error loading company statistics:",ae)}};M.useEffect(()=>{r&&(O(),V())},[r,h,E,e]);const W=a==null?void 0:a.filter(ae=>!0),B=async ae=>{try{if(ae!=null&&ae.id){const pe=await Zt.getCompanyById(ae.id);u(pe),t(`/company-management/${ae.id}`)}else u(ae);j("split"),p(!1),v(!1)}catch(pe){console.error("Error in handleCompanySelect:",pe),u(ae),j("split"),Ue.error("Could not load full company details.")}},P=ae=>{f(pe=>pe!=null&&pe.includes(ae)?pe==null?void 0:pe.filter(ne=>ne!==ae):[...pe||[],ae])},F=()=>{(d==null?void 0:d.length)===(W==null?void 0:W.length)?f([]):f(W==null?void 0:W.map(ae=>ae==null?void 0:ae.id))},I=()=>{u(null),p(!0),v(!1),j("split")},R=ae=>{u(ae),v(!0),p(!1),j("split")},C=async ae=>{try{if(g&&(c!=null&&c.id)){const pe=await Zt.updateCompany(c.id,ae);Ue.success("Company updated successfully!"),u(pe),v(!1)}else{const pe=await Zt.createCompany(ae);Ue.success("Company created successfully!"),u(pe),p(!1)}O(),V()}catch(pe){throw console.error("Error saving company:",pe),Ue.error((pe==null?void 0:pe.message)||"Failed to save company. Please try again."),pe}},k=async ae=>{if(window.confirm("Are you sure you want to delete this company? This action cannot be undone."))try{await Zt.deleteCompany(ae),Ue.success("Company deleted successfully!"),(c==null?void 0:c.id)===ae&&(u(null),j("grid"),t("/company-management")),O(),V()}catch(pe){console.error("Error deleting company:",pe),Ue.error("Failed to delete company. Please try again.")}},z=async()=>{if(d.length===0){Ue.error("Please select companies to delete");return}if(window.confirm(`Are you sure you want to delete ${d.length} companies? This action cannot be undone.`))try{await Promise.all(d.map(ae=>Zt.deleteCompany(ae))),Ue.success(`${d.length} companies deleted successfully!`),f([]),u(null),j("grid"),O(),V()}catch(ae){console.error("Error bulk deleting companies:",ae),Ue.error("Failed to delete some companies. Please try again.")}},q=()=>{p(!1),v(!1),c||(j("grid"),t("/company-management"))},K=()=>{O(),V(),b(!1),Ue.success("Companies imported successfully!")},se=ae=>{A(ae),S(!1)},ie=()=>{A({industry:[],size:[],location:[],revenueRange:null})},ee=Object.values(E).some(ae=>ae&&(Array.isArray(ae)?ae.length>0:!0));return o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(ii,{}),o.jsx("main",{className:"pt-14 xs:pt-16 sm:pt-16",children:o.jsxs("div",{className:"px-3 xs:px-4 sm:px-6 py-4 xs:py-6 sm:py-6",children:[o.jsx("div",{className:"hidden sm:block",children:o.jsx(Hs,{})}),o.jsx("div",{className:"mb-4 xs:mb-6",children:o.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3 xs:gap-4 mb-3 xs:mb-4",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl xs:text-2xl sm:text-3xl font-bold text-text-primary",children:"Company Management"}),o.jsx("p",{className:"text-text-secondary mt-1 text-xs xs:text-sm hidden xs:block",children:"Manage your company relationships and information"})]}),o.jsxs("div",{className:"flex items-center gap-2 xs:gap-3 flex-wrap",children:[o.jsxs("div",{className:"inline-flex items-center border border-border rounded-lg flex-shrink-0",children:[o.jsx("button",{onClick:()=>{j("grid"),u(null),p(!1),v(!1),t("/company-management")},className:`px-2.5 xs:px-3 py-2 min-h-touch rounded-l-lg transition-colors ${D==="grid"?"bg-primary text-white":"text-text-secondary hover:bg-surface-hover"}`,title:"Grid View",children:o.jsx(Y,{name:"Grid",size:16,className:"xs:w-[18px] xs:h-[18px]"})}),o.jsx("button",{onClick:()=>j("split"),className:`px-2.5 xs:px-3 py-2 min-h-touch rounded-r-lg border-l border-border transition-colors ${D==="split"?"bg-primary text-white":"text-text-secondary hover:bg-surface-hover"}`,title:"Split View",children:o.jsx(Y,{name:"List",size:16,className:"xs:w-[18px] xs:h-[18px]"})})]}),o.jsxs("button",{onClick:()=>S(!N),className:`inline-flex items-center space-x-1.5 xs:space-x-2 px-3 xs:px-4 py-2 min-h-touch rounded-lg border transition-colors text-xs xs:text-sm flex-shrink-0 ${ee||N?"border-primary bg-primary-50 text-primary":"border-border text-text-secondary hover:bg-surface-hover"}`,children:[o.jsx(Y,{name:"Filter",size:16,className:"xs:w-[18px] xs:h-[18px] flex-shrink-0"}),o.jsx("span",{className:"hidden sm:inline",children:"Filters"}),ee&&o.jsx("span",{className:"bg-primary text-white text-xs rounded-full w-5 h-5 flex items-center justify-center flex-shrink-0",children:E.industry.length+E.size.length+E.location.length})]}),n("companies.import_export")&&o.jsxs("button",{onClick:()=>b(!0),className:"inline-flex items-center space-x-1.5 xs:space-x-2 px-3 xs:px-4 py-2 min-h-touch rounded-lg border border-border text-text-secondary hover:bg-surface-hover transition-colors text-xs xs:text-sm flex-shrink-0",children:[o.jsx(Y,{name:"Upload",size:16,className:"xs:w-[18px] xs:h-[18px] flex-shrink-0"}),o.jsx("span",{className:"hidden sm:inline",children:"Import"})]}),n("companies.import_export")&&o.jsxs("button",{onClick:()=>_(!0),className:"inline-flex items-center space-x-1.5 xs:space-x-2 px-3 xs:px-4 py-2 min-h-touch rounded-lg border border-border text-text-secondary hover:bg-surface-hover transition-colors text-xs xs:text-sm flex-shrink-0",children:[o.jsx(Y,{name:"Download",size:16,className:"xs:w-[18px] xs:h-[18px] flex-shrink-0"}),o.jsx("span",{className:"hidden sm:inline",children:"Export"})]}),n("companies.create")&&o.jsxs("button",{onClick:I,className:"inline-flex items-center space-x-1.5 xs:space-x-2 px-3 xs:px-4 py-2 min-h-touch bg-primary text-white rounded-lg hover:bg-primary-600 transition-colors text-xs xs:text-sm flex-shrink-0",children:[o.jsx(Y,{name:"Plus",size:16,className:"xs:w-[18px] xs:h-[18px] flex-shrink-0"}),o.jsx("span",{className:"hidden xs:inline",children:"Add Company"}),o.jsx("span",{className:"xs:hidden",children:"Add"})]})]})]})}),T&&o.jsx(zWe,{stats:T,className:"mb-4 xs:mb-6"}),o.jsx("div",{className:"mb-4 xs:mb-6",children:o.jsxs("div",{className:"relative",children:[o.jsx(Y,{name:"Search",size:18,className:"absolute left-2.5 xs:left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary flex-shrink-0"}),o.jsx("input",{type:"text",placeholder:"Search companies...",value:h,onChange:ae=>m(ae.target.value),className:"w-full pl-8 xs:pl-10 pr-8 xs:pr-10 py-2 xs:py-2.5 sm:py-3 min-h-touch bg-surface border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm xs:text-base"}),h&&o.jsx("button",{onClick:()=>m(""),className:"absolute right-2 xs:right-3 top-1/2 transform -translate-y-1/2 text-text-tertiary hover:text-text-primary min-h-touch min-w-touch flex items-center justify-center -m-1",children:o.jsx(Y,{name:"X",size:16})})]})}),N&&o.jsx(WWe,{filters:E,onApplyFilters:se,onClearFilters:ie,onClose:()=>S(!1)}),d.length>0&&o.jsxs("div",{className:"mb-3 xs:mb-4 p-3 xs:p-4 bg-primary-50 border border-primary-200 rounded-lg flex flex-col xs:flex-row items-start xs:items-center justify-between gap-2 xs:gap-0",children:[o.jsxs("span",{className:"text-text-primary font-medium text-sm xs:text-base",children:[d.length," companies selected"]}),o.jsxs("div",{className:"flex items-center space-x-2 xs:space-x-3 w-full xs:w-auto",children:[o.jsx("button",{onClick:()=>f([]),className:"px-2.5 xs:px-3 py-1.5 min-h-touch text-text-secondary hover:text-text-primary transition-colors text-xs xs:text-sm flex-1 xs:flex-none",children:"Clear Selection"}),(n("companies.delete_all")||n("companies.delete_own"))&&o.jsx("button",{onClick:z,className:"px-2.5 xs:px-3 py-1.5 min-h-touch bg-error text-white rounded-lg hover:bg-error-600 transition-colors text-xs xs:text-sm flex-1 xs:flex-none",children:"Delete Selected"})]})]}),s?o.jsx("div",{className:"flex items-center justify-center py-8 xs:py-12",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):D==="grid"?o.jsx(I6,{companies:W,onCompanySelect:B,onDeleteCompany:k,onEditCompany:R,selectedCompanies:d,onMultiSelect:P,onSelectAll:F}):o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-4 xs:gap-6",children:[o.jsx("div",{className:"lg:col-span-4 space-y-3 xs:space-y-4",children:o.jsx(I6,{companies:W,onCompanySelect:B,onDeleteCompany:k,onEditCompany:R,selectedCompanies:d,onMultiSelect:P,compact:!0})}),o.jsx("div",{className:"lg:col-span-8",children:o.jsx("div",{className:"bg-surface rounded-lg border border-border shadow-sm",children:x||g?o.jsx(BWe,{company:g?c:null,onSubmit:C,onCancel:q}):c?o.jsx(LWe,{company:c,onEdit:()=>R(c),onDelete:()=>k(c.id),onClose:()=>{u(null),j("grid"),t("/company-management")}}):o.jsxs("div",{className:"p-8 xs:p-12 text-center",children:[o.jsx("div",{className:"w-12 h-12 xs:w-16 xs:h-16 bg-primary-50 rounded-full flex items-center justify-center mx-auto mb-3 xs:mb-4",children:o.jsx(Y,{name:"Building2",size:24,className:"xs:w-8 xs:h-8 text-primary"})}),o.jsx("h3",{className:"text-lg xs:text-xl font-semibold text-text-primary mb-2",children:"Select a Company"}),o.jsx("p",{className:"text-text-secondary text-sm xs:text-base",children:"Choose a company from the list to view details"})]})})})]})]})}),y&&o.jsx(HWe,{onClose:()=>b(!1),onSuccess:K}),w&&o.jsx(VWe,{companies:W,onClose:()=>_(!1)})]})},qWe=({campaigns:e,allCampaigns:t,statuses:r,types:n,selectedStatusFilter:a,selectedTypeFilter:i,searchQuery:s,sortField:l,sortDirection:c,currentPage:u,itemsPerPage:d,totalItems:f,totalPages:h,onStatusFilterChange:m,onTypeFilterChange:x,onSearchChange:p,onSort:g,onPageChange:v,onItemsPerPageChange:y,onViewCampaign:b,onEditCampaign:w,onDeleteCampaign:_})=>{const{user:D,hasPermission:j,hasAnyPermission:N}=Vt(),S=B=>!!(j("campaigns.edit_all")||j("campaigns.edit_own")&&B.owner_id===(D==null?void 0:D.id)),E=B=>!!(j("campaigns.delete_all")||j("campaigns.delete_own")&&B.owner_id===(D==null?void 0:D.id)),A=B=>Gr.formatCurrency(B),T=B=>B?new Date(B).toLocaleDateString():"Not set",L=B=>{var P;return((P=r.find(F=>F.value===B))==null?void 0:P.color)||"bg-gray-100 text-gray-800"},O=B=>{var P;return((P=r.find(F=>F.value===B))==null?void 0:P.label)||B},V=B=>{var P;return((P=n.find(F=>F.value===B))==null?void 0:P.icon)||"Mail"},W=B=>{var P;return((P=n.find(F=>F.value===B))==null?void 0:P.label)||B};return o.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[o.jsx("div",{className:"p-3 xs:p-4 sm:p-6 border-b border-border",children:o.jsxs("div",{className:"relative",children:[o.jsx(Y,{name:"Search",size:18,className:"absolute left-2.5 xs:left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary"}),o.jsx("input",{type:"text",placeholder:"Search campaigns...",value:s,onChange:B=>p(B.target.value),className:"w-full pl-8 xs:pl-10 pr-10 xs:pr-12 py-2.5 xs:py-3 min-h-touch border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary text-text-primary placeholder-text-tertiary text-sm xs:text-base"}),s&&o.jsx("button",{onClick:()=>p(""),className:"absolute right-2.5 xs:right-3 top-1/2 transform -translate-y-1/2 text-text-tertiary hover:text-text-primary min-h-touch min-w-touch flex items-center justify-center","aria-label":"Clear search",children:o.jsx(Y,{name:"X",size:16})})]})}),o.jsxs("div",{className:"p-3 xs:p-4 sm:p-6 border-b border-border",children:[o.jsxs("div",{className:"flex flex-col xs:flex-row items-start xs:items-center justify-between mb-3 xs:mb-4 gap-2 xs:gap-0",children:[o.jsx("h2",{className:"text-base xs:text-lg font-semibold text-text-primary",children:"All Campaigns"}),o.jsxs("div",{className:"flex flex-col xs:flex-row items-start xs:items-center gap-2 xs:gap-4 w-full xs:w-auto",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"text-xs xs:text-sm text-text-secondary whitespace-nowrap",children:"Show:"}),o.jsxs("select",{value:d,onChange:B=>y(Number(B.target.value)),className:"text-xs xs:text-sm border border-border rounded-md px-2 py-1.5 min-h-touch bg-surface",children:[o.jsx("option",{value:10,children:"10"}),o.jsx("option",{value:25,children:"25"}),o.jsx("option",{value:50,children:"50"}),o.jsx("option",{value:100,children:"100"})]})]}),o.jsxs("div",{className:"text-xs xs:text-sm text-text-secondary whitespace-nowrap",children:[f," campaign",f!==1?"s":"",(a!=="all"||i!=="all"||s)&&o.jsxs("span",{className:"hidden sm:inline",children:[" (",Array.isArray(t)?t.length:0," total)"]})]})]})]}),o.jsxs("div",{className:"mb-3 xs:mb-4",children:[o.jsx("label",{className:"block text-xs xs:text-sm font-medium text-text-secondary mb-2",children:"Filter by Status:"}),o.jsxs("div",{className:"flex flex-wrap gap-1.5 xs:gap-2 -mx-3 px-3 xs:mx-0 xs:px-0 overflow-x-auto scrollbar-hide",children:[o.jsxs("button",{onClick:()=>m("all"),className:`px-2.5 xs:px-3 py-1.5 min-h-touch text-xs xs:text-sm font-medium rounded-md transition-colors whitespace-nowrap flex-shrink-0 ${a==="all"?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["All Statuses (",Array.isArray(t)?t.length:0,")"]}),r.map(B=>{const P=Array.isArray(t)?t.filter(F=>F.status===B.value).length:0;return o.jsxs("button",{onClick:()=>m(B.value),className:`px-2.5 xs:px-3 py-1.5 min-h-touch text-xs xs:text-sm font-medium rounded-md transition-colors whitespace-nowrap flex-shrink-0 ${a===B.value?"bg-primary text-white":`${B.color} hover:opacity-80`}`,children:[B.label," (",P,")"]},B.value)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Filter by Type:"}),o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsx("button",{onClick:()=>x("all"),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${i==="all"?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All Types"}),n.map(B=>{const P=Array.isArray(t)?t.filter(F=>F.type===B.value).length:0;return o.jsxs("button",{onClick:()=>x(B.value),className:`flex items-center space-x-2 px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${i===B.value?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[o.jsx(Y,{name:B.icon,size:14}),o.jsxs("span",{children:[B.label," (",P,")"]})]},B.value)})]})]})]}),e.length===0?o.jsxs("div",{className:"p-8 text-center",children:[o.jsx(Y,{name:"Megaphone",size:48,className:"text-text-tertiary mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:a==="all"&&i==="all"&&!s?"No campaigns yet":"No campaigns found"}),o.jsx("p",{className:"text-text-secondary mb-4",children:a==="all"&&i==="all"&&!s?"Create your first campaign to get started":"Try adjusting your filters or search query"})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider cursor-pointer hover:bg-surface-hover transition-colors",onClick:()=>g("name"),children:o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("span",{children:"Campaign"}),l==="name"&&o.jsx(Y,{name:c==="asc"?"ArrowUp":"ArrowDown",size:14,className:"text-primary"})]})}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Type"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Status"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider cursor-pointer hover:bg-surface-hover transition-colors",onClick:()=>g("budget"),children:o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("span",{children:"Budget"}),l==="budget"&&o.jsx(Y,{name:c==="asc"?"ArrowUp":"ArrowDown",size:14,className:"text-primary"})]})}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider cursor-pointer hover:bg-surface-hover transition-colors",onClick:()=>g("start_date"),children:o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("span",{children:"Start Date"}),l==="start_date"&&o.jsx(Y,{name:c==="asc"?"ArrowUp":"ArrowDown",size:14,className:"text-primary"})]})}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Performance"}),o.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-border",children:e.map(B=>{var P;return o.jsxs("tr",{className:"hover:bg-surface-hover transition-colors duration-150 cursor-pointer",onClick:()=>b(B),children:[o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-medium text-text-primary",children:B.name||"Untitled Campaign"}),o.jsx("div",{className:"text-sm text-text-secondary truncate max-w-xs",children:B.description||"No description"})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:V(B.type),size:16,className:"text-text-secondary"}),o.jsx("span",{className:"text-sm text-text-primary",children:W(B.type)})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${L(B.status)}`,children:O(B.status)})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-primary",children:A(B.budget||0)}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-secondary",children:T(B.start_date)}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex flex-col space-y-1",children:[o.jsxs("div",{className:"text-xs text-text-secondary",children:["Sent: ",B.sent_count||0]}),o.jsxs("div",{className:"text-xs text-text-secondary",children:["Open: ",((P=B.open_rate)==null?void 0:P.toFixed(1))||0,"%"]})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:o.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[S(B)&&o.jsx("button",{onClick:F=>{F.stopPropagation(),w(B)},className:"p-2 text-primary hover:bg-primary-50 rounded-lg transition-colors duration-150",title:"Edit campaign",children:o.jsx(Y,{name:"Edit",size:16})}),E(B)&&o.jsx("button",{onClick:F=>{F.stopPropagation(),_(B)},className:"p-2 text-error hover:bg-error-50 rounded-lg transition-colors duration-150",title:"Delete campaign",children:o.jsx(Y,{name:"Trash2",size:16})})]})})]},B.id)})})]})}),f>0&&o.jsx("div",{className:"px-6 py-4 border-t border-border",children:o.jsx(Im,{currentPage:u,totalPages:h,totalItems:f,itemsPerPage:d,onPageChange:v})})]})]})},GWe=({campaign:e,statuses:t,types:r})=>{var l,c,u,d;const n=f=>Gr.formatCurrency(f),a=f=>f?new Date(f).toLocaleDateString():"Not set",i=f=>f?new Date(f).toLocaleString():"Not set",s=()=>{if(!(e!=null&&e.budget)||e.budget===0)return 0;const f=e.actual_cost||e.budget,h=e.actual_revenue||0;return f===0?0:((h-f)/f*100).toFixed(1)};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Basic Information"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Campaign Name"}),o.jsx("p",{className:"text-text-primary text-base font-medium",children:(e==null?void 0:e.name)||"N/A"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Campaign Type"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:((l=r.find(f=>f.value===(e==null?void 0:e.type)))==null?void 0:l.icon)||"Megaphone",size:16,className:"text-text-tertiary"}),o.jsx("span",{className:"text-text-primary text-base",children:((c=r.find(f=>f.value===(e==null?void 0:e.type)))==null?void 0:c.label)||(e==null?void 0:e.type)||"N/A"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Status"}),o.jsx("span",{className:`inline-block px-3 py-1 text-sm font-medium rounded-full ${((u=t.find(f=>f.value===(e==null?void 0:e.status)))==null?void 0:u.color)||"bg-gray-100 text-gray-800"}`,children:((d=t.find(f=>f.value===(e==null?void 0:e.status)))==null?void 0:d.label)||(e==null?void 0:e.status)||"N/A"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Owner"}),o.jsx("p",{className:"text-text-primary text-base",children:(e==null?void 0:e.owner_name)||"Unassigned"})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Description"}),o.jsx("p",{className:"text-text-primary text-base",children:(e==null?void 0:e.description)||"No description provided"})]})]})]}),o.jsxs("div",{className:"border-t border-border pt-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Timeline"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Start Date"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:"Calendar",size:16,className:"text-text-tertiary"}),o.jsx("span",{className:"text-text-primary text-base",children:a(e==null?void 0:e.start_date)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"End Date"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:"Calendar",size:16,className:"text-text-tertiary"}),o.jsx("span",{className:"text-text-primary text-base",children:a(e==null?void 0:e.end_date)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Created At"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:"Clock",size:16,className:"text-text-tertiary"}),o.jsx("span",{className:"text-text-primary text-base",children:i(e==null?void 0:e.created_at)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Last Updated"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:"Clock",size:16,className:"text-text-tertiary"}),o.jsx("span",{className:"text-text-primary text-base",children:i(e==null?void 0:e.updated_at)})]})]})]})]}),(e==null?void 0:e.type)==="email"&&o.jsxs("div",{className:"border-t border-border pt-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[o.jsx(Y,{name:"Mail",size:20,className:"mr-2"}),"Email Campaign Details"]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Email Template"}),o.jsx("p",{className:"text-text-primary text-base",children:(e==null?void 0:e.email_template_name)||(e==null?void 0:e.email_template_id)||"Not selected"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Email Subject"}),o.jsx("p",{className:"text-text-primary text-base",children:(e==null?void 0:e.email_subject)||"Not set"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"From Name"}),o.jsx("p",{className:"text-text-primary text-base",children:(e==null?void 0:e.email_from_name)||"System default"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"From Email"}),o.jsx("p",{className:"text-text-primary text-base",children:(e==null?void 0:e.email_from_email)||"System default"})]})]})]}),o.jsxs("div",{className:"border-t border-border pt-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Budget & ROI"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[o.jsx("label",{className:"block text-sm font-medium text-blue-700 mb-2",children:"Budget"}),o.jsx("div",{className:"text-2xl font-semibold text-blue-900",children:n((e==null?void 0:e.budget)||0)})]}),o.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[o.jsx("label",{className:"block text-sm font-medium text-purple-700 mb-2",children:"Actual Revenue"}),o.jsx("div",{className:"text-2xl font-semibold text-purple-900",children:n((e==null?void 0:e.actual_revenue)||0)})]}),o.jsxs("div",{className:`rounded-lg p-4 ${s()>=0?"bg-green-50":"bg-red-50"}`,children:[o.jsx("label",{className:`block text-sm font-medium mb-2 ${s()>=0?"text-green-700":"text-red-700"}`,children:"ROI"}),o.jsxs("div",{className:`text-2xl font-semibold ${s()>=0?"text-green-900":"text-red-900"}`,children:[s(),"%"]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Actual Cost"}),o.jsx("div",{className:"text-lg font-medium text-text-primary",children:n((e==null?void 0:e.actual_cost)||0)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Expected Revenue"}),o.jsx("div",{className:"text-lg font-medium text-text-primary",children:n((e==null?void 0:e.expected_revenue)||0)})]})]})]})]})},Mr={async getCampaigns(e={}){try{const t=new URLSearchParams;e.status&&t.append("status",e.status),e.type&&t.append("type",e.type),e.ownerId&&t.append("owner_id",e.ownerId),e.dateRange&&t.append("date_range",e.dateRange);const r=t.toString(),n=r?`/api/v1/campaigns?${r}`:"/api/v1/campaigns",{data:a,error:i}=await be.get(n);if(i)throw console.error(" API error:",i),i;return a&&typeof a=="object"&&Array.isArray(a.campaigns)?a.campaigns:Array.isArray(a)?a:[]}catch(t){throw console.error("Error fetching campaigns:",t),t}},async getCampaignById(e){try{const{data:t,error:r}=await be.get(`/api/v1/campaigns/${e}`);if(r){if(r.status===404)return null;throw r}return t}catch(t){throw console.error("Error fetching campaign:",t),t}},async createCampaign(e){try{const t={name:e.name,type:e.type,status:e.status||"draft",description:e.description||null,start_date:e.start_date||null,end_date:e.end_date||null,budget:e.budget||0,expected_revenue:e.expected_revenue||0,email_template_id:e.email_template_id||null,owner_id:e.owner_id||null},{data:r,error:n}=await be.post("/api/v1/campaigns",t);if(n)throw console.error("API returned error:",n),n;return r}catch(t){throw console.error("Error creating campaign:",t),t}},async updateCampaign(e,t){try{const{data:r,error:n}=await be.put(`/api/v1/campaigns/${e}`,t);if(n)throw console.error("API returned error:",n),n;return r}catch(r){throw console.error("Error updating campaign:",r),r}},async deleteCampaign(e){try{const{data:t,error:r}=await be.delete(`/api/v1/campaigns/${e}`);if(r)throw r;return!0}catch(t){throw console.error("Error deleting campaign:",t),t}},async deleteCampaigns(e){try{return await Promise.all(e.map(t=>this.deleteCampaign(t))),!0}catch(t){throw t}},async getCampaignStatistics(e={}){try{const t=new URLSearchParams;e.dateRange&&t.append("date_range",e.dateRange),e.ownerId&&t.append("owner_id",e.ownerId);const r=t.toString(),n=r?`/api/v1/campaigns/statistics?${r}`:"/api/v1/campaigns/statistics",{data:a,error:i}=await be.get(n);if(i)throw i;return a}catch(t){throw console.error("Error fetching campaign statistics:",t),t}},async addAudience(e,t){try{const{data:r,error:n}=await be.post(`/api/v1/campaigns/${e}/audience`,t);if(n)throw n;return r}catch(r){throw console.error("Error adding audience to campaign:",r),r}},async getCampaignAudience(e,t={}){try{const r=new URLSearchParams;t.status&&r.append("status",t.status),t.skip!==void 0&&r.append("skip",t.skip),t.limit!==void 0&&r.append("limit",t.limit);const n=r.toString(),a=n?`/api/v1/campaigns/${e}/audience?${n}`:`/api/v1/campaigns/${e}/audience`,{data:i,error:s}=await be.get(a);if(s)throw s;return i&&typeof i=="object"&&Array.isArray(i.audience)?i.audience:i&&typeof i=="object"&&Array.isArray(i.campaign_contacts)?i.campaign_contacts:Array.isArray(i)?i:[]}catch(r){throw console.error("Error fetching campaign audience:",r),r}},async removeAudienceMember(e,t){try{const{data:r,error:n}=await be.delete(`/api/v1/campaigns/${e}/audience/${t}`);if(n)throw n;return r}catch(r){throw console.error("Error removing audience member:",r),r}},async executeCampaign(e,t={}){try{const{data:r,error:n}=await be.post(`/api/v1/campaigns/${e}/execute`,t);if(n)throw n;return r}catch(r){throw console.error("Error executing campaign:",r),r}},async sendToPendingAudience(e){try{const{data:t,error:r}=await be.post(`/api/v1/campaigns/${e}/send-pending`);if(r)throw r;return t}catch(t){throw console.error("Error sending to pending audience:",t),t}},async resendToMember(e,t){try{const{data:r,error:n}=await be.post(`/api/v1/campaigns/${e}/audience/${t}/resend`);if(n)throw n;return r}catch(r){throw console.error("Error resending to member:",r),r}},async getCampaignMetrics(e){try{const{data:t,error:r}=await be.get(`/api/v1/campaigns/${e}/metrics`);if(r)throw r;return t}catch(t){throw console.error("Error fetching campaign metrics:",t),t}},async getCampaignAnalytics(e,t=30){try{const{data:r,error:n}=await be.get(`/api/v1/campaigns/${e}/analytics?days=${t}`);if(n)throw n;return r&&typeof r=="object"&&Array.isArray(r.analytics)?r.analytics:r&&typeof r=="object"&&Array.isArray(r.metrics)?r.metrics:Array.isArray(r)?r:[]}catch(r){throw console.error("Error fetching campaign analytics:",r),r}},async getCampaignConversions(e){try{const{data:t,error:r}=await be.get(`/api/v1/campaigns/${e}/conversions`);if(r)throw r;return t&&typeof t=="object"&&Array.isArray(t.conversions)?t.conversions:Array.isArray(t)?t:[]}catch(t){throw console.error("Error fetching campaign conversions:",t),t}},async getProspects(e={}){try{const t=new URLSearchParams;e.status&&t.append("status",e.status),e.campaignId&&t.append("campaign_id",e.campaignId),e.assignedTo&&t.append("assigned_to",e.assignedTo),e.source&&t.append("source",e.source);const r=t.toString(),n=r?`/api/v1/prospects?${r}`:"/api/v1/prospects",{data:a,error:i}=await be.get(n);if(i)throw i;return a&&typeof a=="object"&&Array.isArray(a.prospects)?a.prospects:Array.isArray(a)?a:[]}catch(t){throw console.error("Error fetching prospects:",t),t}},async getCampaignProspects(e,t={}){try{const r=new URLSearchParams;t.status&&r.append("status",t.status),t.skip!==void 0&&r.append("skip",t.skip),t.limit!==void 0&&r.append("limit",t.limit);const n=r.toString(),a=n?`/api/v1/campaigns/${e}/prospects?${n}`:`/api/v1/campaigns/${e}/prospects`,{data:i,error:s}=await be.get(a);if(s)throw console.error(" API error:",s),s;return i&&typeof i=="object"&&Array.isArray(i.prospects)?i.prospects:Array.isArray(i)?i:[]}catch(r){throw console.error("Error fetching campaign prospects:",r),r}},async getProspectById(e){try{const{data:t,error:r}=await be.get(`/api/v1/prospects/${e}`);if(r){if(r.status===404)return null;throw r}return t}catch(t){throw console.error("Error fetching prospect:",t),t}},async createProspect(e){try{const{data:t,error:r}=await be.post("/api/v1/prospects",e);if(r)throw console.error("API returned error:",r),r;return t}catch(t){throw console.error("Error creating prospect:",t),t}},async updateProspect(e,t){try{const{data:r,error:n}=await be.put(`/api/v1/prospects/${e}`,t);if(n)throw console.error("API returned error:",n),n;return r}catch(r){throw console.error("Error updating prospect:",r),r}},async deleteProspect(e){try{const{data:t,error:r}=await be.delete(`/api/v1/prospects/${e}`);if(r)throw r;return!0}catch(t){throw console.error("Error deleting prospect:",t),t}},async convertProspectToContact(e,t={}){try{const{data:r,error:n}=await be.post(`/api/v1/prospects/${e}/convert`,t);if(n)throw console.error("API returned error:",n),n;return r}catch(r){throw console.error("Error converting prospect:",r),r}},async bulkImportProspects(e){try{const{data:t,error:r}=await be.post("/api/v1/prospects/bulk-import",e);if(r)throw r;return t}catch(t){throw console.error("Error importing prospects:",t),t}},async exportProspects(e={}){try{const t=new URLSearchParams;e.status&&t.append("status",e.status),e.campaignId&&t.append("campaign_id",e.campaignId);const r=t.toString(),n=r?`/api/v1/prospects/export?${r}`:"/api/v1/prospects/export",{data:a,error:i}=await be.get(n);if(i)throw i;return a||[]}catch(t){throw console.error("Error exporting prospects:",t),t}},async searchCampaigns(e){try{const{data:t,error:r}=await be.get(`/api/v1/campaigns?search=${encodeURIComponent(e)}`);if(r)throw r;return t||[]}catch(t){throw console.error("Error searching campaigns:",t),t}},async cloneCampaign(e){try{const t=await this.getCampaignById(e);if(!t)throw new Error("Campaign not found");const r={name:`${t.name} (Copy)`,type:t.type,status:"draft",description:t.description,budget:t.budget,expected_revenue:t.expected_revenue,email_template_id:t.email_template_id};return await this.createCampaign(r)}catch(t){throw console.error("Error cloning campaign:",t),t}}},YWe=({prospect:e,onClose:t,onUpdate:r,onConvert:n})=>{var x,p,g;const{hasAnyPermission:a}=Vt(),[i,s]=M.useState(!1),[l,c]=M.useState({first_name:e.first_name||"",last_name:e.last_name||"",email:e.email||"",phone:e.phone||"",company_name:e.company_name||"",job_title:e.job_title||"",industry:e.industry||"",description:e.description||"",notes:e.notes||"",status:(e.status||"new").toLowerCase(),lead_score:e.lead_score||0,source:(e.source||"manual_entry").toLowerCase(),source_details:e.source_details||"",linkedin_url:e.linkedin_url||"",twitter_handle:e.twitter_handle||"",website:e.website||"",city:e.city||"",state:e.state||"",country:e.country||""}),u=[{value:"new",label:"New"},{value:"converted",label:"Converted"},{value:"rejected",label:"Rejected"}],[d,f]=M.useState({}),h=async v=>{var b,w,_,D,j;v.preventDefault(),f({});const y={};if((b=l.first_name)!=null&&b.trim()||(y.first_name="First name is required"),!((w=l.email)!=null&&w.trim())&&!((_=l.phone)!=null&&_.trim())&&(y.contact="Either email or phone number is required"),(D=l.email)!=null&&D.trim()&&(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l.email.trim())||(y.email="Please enter a valid email address")),(j=l.phone)!=null&&j.trim()&&l.phone.replace(/\D/g,"").length!==10&&(y.phone="Phone number must be exactly 10 digits"),Object.keys(y).length>0){f(y);return}await r(e.id,l),s(!1)},m=v=>{const{name:y,value:b}=v.target;c(w=>({...w,[y]:b})),d[y]&&f(w=>{const _={...w};return delete _[y],_})};return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-surface rounded-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"sticky top-0 bg-surface px-6 py-4 border-b border-border flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-primary font-medium text-lg",children:(((x=l.first_name)==null?void 0:x[0])||"")+(((p=l.last_name)==null?void 0:p[0])||"")})}),o.jsxs("div",{children:[o.jsxs("h3",{className:"text-xl font-semibold text-text-primary",children:[l.first_name," ",l.last_name]}),o.jsx("p",{className:"text-sm text-text-secondary",children:l.job_title||"No title"})]})]}),o.jsx("button",{onClick:t,className:"p-2 text-text-secondary hover:text-text-primary hover:bg-surface-hover rounded-lg transition-colors",children:o.jsx(Y,{name:"X",size:20})})]}),o.jsx("div",{className:"p-6",children:i?o.jsxs("form",{onSubmit:h,className:"space-y-6",children:[d.contact&&o.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-600 p-4 rounded-lg flex items-start space-x-2",children:[o.jsx(Y,{name:"AlertCircle",size:20,className:"flex-shrink-0 mt-0.5"}),o.jsx("div",{children:d.contact&&o.jsx("p",{children:d.contact})})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:["First Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",name:"first_name",value:l.first_name,onChange:m,className:`w-full px-3 py-2 border ${d.first_name?"border-red-500":"border-border"} rounded-lg focus:ring-2 focus:ring-primary focus:border-primary`}),d.first_name&&o.jsx("p",{className:"text-sm text-red-500 mt-1",children:d.first_name})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Last Name"}),o.jsx("input",{type:"text",name:"last_name",value:l.last_name,onChange:m,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:["Email ",o.jsx("span",{className:"text-gray-500 text-xs",children:"(Email or Phone required)"})]}),o.jsx("input",{type:"text",name:"email",value:l.email,onChange:m,placeholder:"email@example.com",className:`w-full px-3 py-2 border ${d.contact||d.email?"border-red-500":"border-border"} rounded-lg focus:ring-2 focus:ring-primary focus:border-primary`}),d.email&&o.jsx("p",{className:"text-sm text-red-500 mt-1",children:d.email})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:["Phone ",o.jsx("span",{className:"text-gray-500 text-xs",children:"(Email or Phone required)"})]}),o.jsx("input",{type:"tel",name:"phone",value:l.phone,onChange:m,placeholder:"10 digit phone number",className:`w-full px-3 py-2 border ${d.contact||d.phone?"border-red-500":"border-border"} rounded-lg focus:ring-2 focus:ring-primary focus:border-primary`}),d.phone&&o.jsx("p",{className:"text-sm text-red-500 mt-1",children:d.phone})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Company Name"}),o.jsx("input",{type:"text",name:"company_name",value:l.company_name,onChange:m,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Job Title"}),o.jsx("input",{type:"text",name:"job_title",value:l.job_title,onChange:m,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Industry"}),o.jsx("input",{type:"text",name:"industry",value:l.industry,onChange:m,placeholder:"e.g., Technology, Healthcare",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Website"}),o.jsx("input",{type:"url",name:"website",value:l.website,onChange:m,placeholder:"https://example.com",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"LinkedIn URL"}),o.jsx("input",{type:"url",name:"linkedin_url",value:l.linkedin_url,onChange:m,placeholder:"https://linkedin.com/in/...",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Twitter Handle"}),o.jsx("input",{type:"text",name:"twitter_handle",value:l.twitter_handle,onChange:m,placeholder:"@username",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"City"}),o.jsx("input",{type:"text",name:"city",value:l.city,onChange:m,placeholder:"e.g., San Francisco",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"State"}),o.jsx("input",{type:"text",name:"state",value:l.state,onChange:m,placeholder:"e.g., California",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Country"}),o.jsx("input",{type:"text",name:"country",value:l.country,onChange:m,placeholder:"e.g., United States",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Status"}),o.jsx("select",{name:"status",value:l.status,onChange:m,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",disabled:l.status==="converted",children:u.map(v=>o.jsx("option",{value:v.value,children:v.label},v.value))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Lead Score (0-100)"}),o.jsx("input",{type:"number",name:"lead_score",value:l.lead_score,onChange:m,min:"0",max:"100",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Description"}),o.jsx("textarea",{name:"description",value:l.description,onChange:m,rows:"3",placeholder:"Brief description of the prospect...",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary resize-none"})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Notes"}),o.jsx("textarea",{name:"notes",value:l.notes,onChange:m,rows:"4",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]})]}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsx("button",{type:"button",onClick:()=>s(!1),className:"flex-1 btn-secondary",children:"Cancel"}),o.jsx("button",{type:"submit",className:"flex-1 btn-primary",children:"Save Changes"})]})]}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-4",children:"Contact Information"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Email"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:"Mail",size:16,className:"text-text-tertiary"}),o.jsx("span",{className:"text-text-primary",children:e.email})]})]}),e.phone&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Phone"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:"Phone",size:16,className:"text-text-tertiary"}),o.jsx("span",{className:"text-text-primary",children:e.phone})]})]}),e.company_name&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Company"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:"Building",size:16,className:"text-text-tertiary"}),o.jsx("span",{className:"text-text-primary",children:e.company_name})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Status"}),o.jsx("span",{className:"text-text-primary",children:e.status})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Lead Score"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 max-w-[120px]",children:o.jsx("div",{className:`h-2 rounded-full ${e.lead_score>=75?"bg-green-500":e.lead_score>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${e.lead_score||0}%`}})}),o.jsx("span",{className:"text-text-primary font-medium",children:e.lead_score||0})]})]}),e.source&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Source"}),o.jsx("span",{className:"text-text-primary",children:e.source})]})]})]}),e.notes&&o.jsxs("div",{children:[o.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-2",children:"Notes"}),o.jsx("p",{className:"text-text-secondary",children:e.notes})]}),e.status==="converted"&&e.converted_to_contact_id&&o.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx(Y,{name:"CheckCircle",size:20,className:"text-green-600 mt-0.5"}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-semibold text-green-900 mb-1",children:"Converted to Contact"}),o.jsxs("p",{className:"text-sm text-green-700",children:["Contact ID: ",e.converted_to_contact_id.slice(0,8)]}),e.converted_at&&o.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["Converted on ",new Date(e.converted_at).toLocaleString()]})]})]})}),o.jsxs("div",{className:"flex space-x-3 pt-4 border-t border-border",children:[a(["prospects.edit_all","prospects.edit_own"])&&o.jsxs("button",{onClick:()=>s(!0),className:"flex-1 btn-secondary flex items-center justify-center space-x-2",children:[o.jsx(Y,{name:"Edit",size:16}),o.jsx("span",{children:"Edit Prospect"})]}),((g=e.status)==null?void 0:g.toLowerCase())!=="converted"&&a(["prospects.convert"])&&o.jsxs("button",{onClick:n,className:"flex-1 btn-primary flex items-center justify-center space-x-2",children:[o.jsx(Y,{name:"UserPlus",size:16}),o.jsx("span",{children:"Convert to Contact"})]})]})]})})]})})},XWe=({prospect:e,onClose:t,onConvert:r})=>{const[n,a]=M.useState(!1),[i,s]=M.useState({notes:"",create_activity:!0}),l=async()=>{var u,d;if(!n){a(!0);try{const f=await Mr.convertProspectToContact(e.id,i);Ue.success("Prospect converted to contact successfully!"),r(f)}catch(f){console.error("Error converting prospect:",f),(u=f==null?void 0:f.message)!=null&&u.includes("duplicate")||(d=f==null?void 0:f.message)!=null&&d.includes("already exists")?Ue.error("A contact with this email already exists"):Ue.error("Failed to convert prospect. Please try again.")}finally{a(!1)}}},c=u=>{const{name:d,value:f,type:h,checked:m}=u.target;s(x=>({...x,[d]:h==="checkbox"?m:f}))};return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-surface rounded-lg max-w-2xl w-full",children:[o.jsx("div",{className:"px-6 py-4 border-b border-border",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center",children:o.jsx(Y,{name:"UserPlus",size:20,className:"text-primary"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Convert Prospect to Contact"}),o.jsxs("p",{className:"text-sm text-text-secondary",children:[e.first_name," ",e.last_name]})]})]}),o.jsx("button",{onClick:t,disabled:n,className:"p-2 text-text-secondary hover:text-text-primary hover:bg-surface-hover rounded-lg transition-colors disabled:opacity-50",children:o.jsx(Y,{name:"X",size:20})})]})}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[o.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-3",children:"Prospect Information"}),o.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-blue-700 font-medium",children:"Name:"}),o.jsxs("span",{className:"text-blue-900 ml-2",children:[e.first_name," ",e.last_name]})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-blue-700 font-medium",children:"Email:"}),o.jsx("span",{className:"text-blue-900 ml-2",children:e.email})]}),e.phone&&o.jsxs("div",{children:[o.jsx("span",{className:"text-blue-700 font-medium",children:"Phone:"}),o.jsx("span",{className:"text-blue-900 ml-2",children:e.phone})]}),e.company&&o.jsxs("div",{children:[o.jsx("span",{className:"text-blue-700 font-medium",children:"Company:"}),o.jsx("span",{className:"text-blue-900 ml-2",children:e.company})]}),e.job_title&&o.jsxs("div",{children:[o.jsx("span",{className:"text-blue-700 font-medium",children:"Title:"}),o.jsx("span",{className:"text-blue-900 ml-2",children:e.job_title})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-blue-700 font-medium",children:"Lead Score:"}),o.jsx("span",{className:"text-blue-900 ml-2",children:e.lead_score||0})]})]})]}),o.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx(Y,{name:"Info",size:20,className:"text-green-600 mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:"text-sm font-semibold text-green-900 mb-1",children:"What happens when you convert?"}),o.jsxs("ul",{className:"text-sm text-green-700 space-y-1 list-disc list-inside",children:[o.jsx("li",{children:"A new contact will be created with the prospect's information"}),o.jsx("li",{children:'The prospect status will be changed to "Converted"'}),o.jsx("li",{children:"Campaign associations will be maintained"}),o.jsx("li",{children:"An activity log entry will be created (if enabled below)"})]})]})]})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Conversion Notes (Optional)"}),o.jsx("textarea",{name:"notes",value:i.notes,onChange:c,rows:"3",placeholder:"Add any notes about this conversion...",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",disabled:n})]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",id:"create_activity",name:"create_activity",checked:i.create_activity,onChange:c,className:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary",disabled:n}),o.jsx("label",{htmlFor:"create_activity",className:"ml-2 text-sm text-text-primary",children:"Create activity log entry for this conversion"})]})]}),o.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx(Y,{name:"AlertTriangle",size:20,className:"text-yellow-600 mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:"text-sm font-semibold text-yellow-900 mb-1",children:"Important Note"}),o.jsx("p",{className:"text-sm text-yellow-700",children:"This action cannot be undone. The prospect will be marked as converted and a new contact record will be created."})]})]})})]}),o.jsxs("div",{className:"px-6 py-4 border-t border-border flex space-x-3",children:[o.jsx("button",{onClick:t,disabled:n,className:"flex-1 btn-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),o.jsx("button",{onClick:l,disabled:n,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:n?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),o.jsx("span",{children:"Converting..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(Y,{name:"UserPlus",size:16}),o.jsx("span",{children:"Convert to Contact"})]})})]})]})})},KWe=({campaignId:e,onClose:t,onSubmit:r})=>{const[n,a]=M.useState({first_name:"",last_name:"",email:"",phone:"",company_name:"",job_title:"",industry:"",description:"",notes:"",status:"new",lead_score:0,source:"manual_entry",source_details:"",linkedin_url:"",twitter_handle:"",website:"",city:"",state:"",country:""}),[i,s]=M.useState(!1),[l,c]=M.useState({}),u=[{value:"new",label:"New"},{value:"converted",label:"Converted"},{value:"rejected",label:"Rejected"}],d=[{value:"email_campaign",label:"Email Campaign"},{value:"web_form",label:"Web Form"},{value:"phone",label:"Phone"},{value:"social_media",label:"Social Media"},{value:"manual_entry",label:"Manual Entry"},{value:"referral",label:"Referral"},{value:"other",label:"Other"}],f=m=>{const{name:x,value:p}=m.target;a(g=>({...g,[x]:p})),l[x]&&c(g=>{const v={...g};return delete v[x],v})},h=async m=>{var x,p,g,v,y;m.preventDefault(),s(!0),c({});try{const b={};if((x=n.first_name)!=null&&x.trim()||(b.first_name="First name is required"),!((p=n.email)!=null&&p.trim())&&!((g=n.phone)!=null&&g.trim())&&(b.contact="Either email or phone number is required"),(v=n.email)!=null&&v.trim()&&(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.email.trim())||(b.email="Please enter a valid email address")),(y=n.phone)!=null&&y.trim()&&n.phone.replace(/\D/g,"").length!==10&&(b.phone="Phone number must be exactly 10 digits"),Object.keys(b).length>0){c(b),s(!1);return}await r({...n,campaign_id:e})}catch(b){c({submit:b.message||"Failed to create prospect"})}finally{s(!1)}};return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4",children:o.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-hidden flex flex-col relative z-[10000]",children:[o.jsxs("div",{className:"bg-white dark:bg-gray-800 px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-10 h-10 bg-indigo-100 dark:bg-indigo-900 rounded-full flex items-center justify-center",children:o.jsx(Y,{name:"UserPlus",size:20,className:"text-indigo-600 dark:text-indigo-400"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Add New Prospect"}),o.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Create a new prospect for this campaign"})]})]}),o.jsx("button",{onClick:t,disabled:i,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors disabled:opacity-50",children:o.jsx(Y,{name:"X",size:20})})]}),o.jsx("form",{onSubmit:h,className:"flex-1 overflow-y-auto p-6",children:o.jsxs("div",{className:"space-y-5",children:[(l.submit||l.contact)&&o.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-600 dark:text-red-400 p-4 rounded-lg flex items-start space-x-2",children:[o.jsx(Y,{name:"AlertCircle",size:20,className:"flex-shrink-0 mt-0.5"}),o.jsxs("div",{children:[l.submit&&o.jsx("p",{children:l.submit}),l.contact&&o.jsx("p",{children:l.contact})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:["First Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",name:"first_name",value:n.first_name,onChange:f,className:`w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border ${l.first_name?"border-red-500":"border-gray-300 dark:border-gray-600"} rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors`,disabled:i}),l.first_name&&o.jsx("p",{className:"text-sm text-red-500 mt-1",children:l.first_name})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Last Name"}),o.jsx("input",{type:"text",name:"last_name",value:n.last_name,onChange:f,className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",disabled:i})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:["Email ",o.jsx("span",{className:"text-gray-500 text-xs",children:"(Email or Phone required)"})]}),o.jsx("input",{type:"text",name:"email",value:n.email,onChange:f,placeholder:"email@example.com",className:`w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border ${l.contact||l.email?"border-red-500":"border-gray-300 dark:border-gray-600"} rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors`,disabled:i}),l.email&&o.jsx("p",{className:"text-sm text-red-500 mt-1",children:l.email})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:["Phone ",o.jsx("span",{className:"text-gray-500 text-xs",children:"(Email or Phone required)"})]}),o.jsx("input",{type:"tel",name:"phone",value:n.phone,onChange:f,placeholder:"10 digit phone number",className:`w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border ${l.contact||l.phone?"border-red-500":"border-gray-300 dark:border-gray-600"} rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors`,disabled:i}),l.phone&&o.jsx("p",{className:"text-sm text-red-500 mt-1",children:l.phone})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Company Name"}),o.jsx("input",{type:"text",name:"company_name",value:n.company_name,onChange:f,className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",disabled:i})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Job Title"}),o.jsx("input",{type:"text",name:"job_title",value:n.job_title,onChange:f,className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",disabled:i})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Status"}),o.jsx("select",{name:"status",value:n.status,onChange:f,className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white transition-colors",disabled:i,children:u.map(m=>o.jsx("option",{value:m.value,children:m.label},m.value))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Lead Score (0-100)"}),o.jsx("input",{type:"number",name:"lead_score",value:n.lead_score,onChange:f,min:"0",max:"100",className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",disabled:i})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Source"}),o.jsx("select",{name:"source",value:n.source,onChange:f,className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white transition-colors",disabled:i,children:d.map(m=>o.jsx("option",{value:m.value,children:m.label},m.value))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Industry"}),o.jsx("input",{type:"text",name:"industry",value:n.industry,onChange:f,placeholder:"e.g., Technology, Healthcare",className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",disabled:i})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Website"}),o.jsx("input",{type:"url",name:"website",value:n.website,onChange:f,placeholder:"https://example.com",className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",disabled:i})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"LinkedIn URL"}),o.jsx("input",{type:"url",name:"linkedin_url",value:n.linkedin_url,onChange:f,placeholder:"https://linkedin.com/in/...",className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",disabled:i})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Twitter Handle"}),o.jsx("input",{type:"text",name:"twitter_handle",value:n.twitter_handle,onChange:f,placeholder:"@username",className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",disabled:i})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"City"}),o.jsx("input",{type:"text",name:"city",value:n.city,onChange:f,placeholder:"e.g., San Francisco",className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",disabled:i})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"State"}),o.jsx("input",{type:"text",name:"state",value:n.state,onChange:f,placeholder:"e.g., California",className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",disabled:i})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Country"}),o.jsx("input",{type:"text",name:"country",value:n.country,onChange:f,placeholder:"e.g., United States",className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",disabled:i})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Source Details"}),o.jsx("input",{type:"text",name:"source_details",value:n.source_details,onChange:f,placeholder:"Additional context about the source...",className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",disabled:i})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Description"}),o.jsx("textarea",{name:"description",value:n.description,onChange:f,rows:"3",placeholder:"Brief description of the prospect...",className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors resize-none",disabled:i})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Notes"}),o.jsx("textarea",{name:"notes",value:n.notes,onChange:f,rows:"3",placeholder:"Add any additional notes about this prospect...",className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors resize-none",disabled:i})]})]})]})}),o.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex space-x-3",children:[o.jsx("button",{type:"button",onClick:t,disabled:i,className:"flex-1 px-4 py-2.5 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),o.jsx("button",{type:"submit",onClick:h,disabled:i,className:"flex-1 px-4 py-2.5 bg-indigo-600 hover:bg-indigo-700 dark:bg-indigo-500 dark:hover:bg-indigo-600 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:i?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),o.jsx("span",{children:"Creating..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(Y,{name:"UserPlus",size:16}),o.jsx("span",{children:"Create Prospect"})]})})]})]})})},ZWe=({prospect:e,campaignId:t,onClose:r,onSuccess:n})=>{const[a,i]=M.useState(!1),[s,l]=M.useState({name:`Deal - ${e.first_name} ${e.last_name}`,value:"",stage:"lead",probability:10,description:`Deal created from campaign prospect: ${e.first_name} ${e.last_name}`,expected_close_date:""}),c=[{value:"lead",label:"Lead",probability:10},{value:"qualified",label:"Qualified",probability:25},{value:"proposal",label:"Proposal",probability:50},{value:"negotiation",label:"Negotiation",probability:75},{value:"closed_won",label:"Closed Won",probability:100},{value:"closed_lost",label:"Closed Lost",probability:0}],u=f=>{const{name:h,value:m}=f.target;if(h==="stage"){const x=c.find(p=>p.value===m);l(p=>({...p,[h]:m,probability:x?x.probability:p.probability}))}else l(x=>({...x,[h]:m}))},d=async f=>{f.preventDefault(),i(!0);try{let h=e.contact_id;if(!h){const{data:g}=await be.get(`/api/v1/contacts?email=${e.email}`);g&&g.length>0&&(h=g[0].id)}if(!h){Ue.error("Could not find the contact for this prospect. Please convert the prospect first."),i(!1);return}const m={name:s.name,value:parseFloat(s.value)||0,stage:s.stage,probability:parseInt(s.probability),description:s.description,expected_close_date:s.expected_close_date||null,contact_id:h},{data:x,error:p}=await be.post("/api/v1/deals",m);if(p)throw p;try{const{error:g}=await be.post(`/api/v1/campaigns/${t}/prospects/${e.id}/link-deal`,{deal_id:x.id,conversion_value:parseFloat(s.value)||0});if(g)if(g.status===404)try{await be.post(`/api/v1/campaigns/${t}/audience`,{contact_ids:[],prospect_ids:[e.id]});const{error:v}=await be.post(`/api/v1/campaigns/${t}/prospects/${e.id}/link-deal`,{deal_id:x.id,conversion_value:parseFloat(s.value)||0});v&&(console.error(" Error linking deal after adding to audience:",v),Ue.warning("Deal created but could not link to campaign."))}catch(v){console.error(" Error adding prospect to audience:",v),Ue.warning("Deal created but could not link to campaign.")}else console.error(" Error linking deal to campaign:",g),Ue.warning("Deal created but could not link to campaign.")}catch(g){console.error(" Error linking deal to campaign:",g),Ue.warning("Deal created but could not link to campaign.")}Ue.success("Deal created successfully and linked to campaign!"),n(x),r()}catch(h){console.error("Error creating deal:",h),Ue.error((h==null?void 0:h.detail)||"Failed to create deal. Please try again.")}finally{i(!1)}};return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-surface rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsx("div",{className:"sticky top-0 bg-surface px-6 py-4 border-b border-border",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:o.jsx(Y,{name:"DollarSign",size:20,className:"text-green-600"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Create Deal from Prospect"}),o.jsxs("p",{className:"text-sm text-text-secondary",children:[e.first_name," ",e.last_name]})]})]}),o.jsx("button",{onClick:r,disabled:a,className:"p-2 text-text-secondary hover:text-text-primary hover:bg-surface-hover rounded-lg transition-colors disabled:opacity-50",children:o.jsx(Y,{name:"X",size:20})})]})}),o.jsx("form",{onSubmit:d,className:"p-6",children:o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[o.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Prospect Information"}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-blue-700",children:"Email:"}),o.jsx("span",{className:"text-blue-900 ml-2",children:e.email})]}),e.phone&&o.jsxs("div",{children:[o.jsx("span",{className:"text-blue-700",children:"Phone:"}),o.jsx("span",{className:"text-blue-900 ml-2",children:e.phone})]}),e.company&&o.jsxs("div",{children:[o.jsx("span",{className:"text-blue-700",children:"Company:"}),o.jsx("span",{className:"text-blue-900 ml-2",children:e.company})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-blue-700",children:"Lead Score:"}),o.jsx("span",{className:"text-blue-900 ml-2",children:e.lead_score||0})]})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:["Deal Name ",o.jsx("span",{className:"text-error",children:"*"})]}),o.jsx("input",{type:"text",name:"name",value:s.name,onChange:u,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",required:!0,disabled:a})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:["Deal Value ",o.jsx("span",{className:"text-error",children:"*"})]}),o.jsxs("div",{className:"relative",children:[o.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary",children:"$"}),o.jsx("input",{type:"number",name:"value",value:s.value,onChange:u,step:"0.01",min:"0",placeholder:"0.00",className:"w-full pl-8 pr-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",required:!0,disabled:a})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Deal Stage"}),o.jsx("select",{name:"stage",value:s.stage,onChange:u,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",disabled:a,children:c.map(f=>o.jsx("option",{value:f.value,children:f.label},f.value))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Probability (%)"}),o.jsx("input",{type:"number",name:"probability",value:s.probability,onChange:u,min:"0",max:"100",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",disabled:a})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Expected Close Date"}),o.jsx("input",{type:"date",name:"expected_close_date",value:s.expected_close_date,onChange:u,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",disabled:a})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Description"}),o.jsx("textarea",{name:"description",value:s.description,onChange:u,rows:"3",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",disabled:a})]}),o.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx(Y,{name:"Info",size:20,className:"text-green-600 mt-0.5"}),o.jsx("div",{className:"flex-1 text-sm text-green-700",children:"This deal will be created and linked to this campaign. It will appear in the Conversions tab with revenue tracking."})]})}),o.jsxs("div",{className:"flex space-x-3 pt-4 border-t border-border",children:[o.jsx("button",{type:"button",onClick:r,disabled:a,className:"flex-1 btn-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:a,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:a?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),o.jsx("span",{children:"Creating..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(Y,{name:"DollarSign",size:16}),o.jsx("span",{children:"Create Deal"})]})})]})]})})]})})},JWe=({campaignId:e})=>{const{hasAnyPermission:t}=Vt(),[r,n]=M.useState([]),[a,i]=M.useState(!0),[s,l]=M.useState(null),[c,u]=M.useState(null),[d,f]=M.useState(!1),[h,m]=M.useState(!1),[x,p]=M.useState(!1),[g,v]=M.useState(!1),[y,b]=M.useState("all"),[w,_]=M.useState(""),D=[{value:"new",label:"New",color:"bg-blue-100 text-blue-800"},{value:"converted",label:"Converted",color:"bg-green-100 text-green-800"},{value:"rejected",label:"Rejected",color:"bg-red-100 text-red-800"}];M.useEffect(()=>{e&&j()},[e]);const j=async()=>{i(!0),l(null);try{const F=await Mr.getCampaignProspects(e);n(F||[])}catch(F){console.error("Error loading prospects:",F),l("Failed to load prospects. Please try again.")}finally{i(!1)}},N=F=>{u(F),f(!0)},S=F=>{u(F),m(!0)},E=async F=>{m(!1),u(null),Ue.success("Prospect converted to contact successfully!"),await j()},A=async(F,I)=>{try{await Mr.updateProspect(F,I),Ue.success("Prospect updated successfully!"),await j()}catch(R){console.error("Error updating prospect:",R),Ue.error("Failed to update prospect. Please try again.")}},T=async F=>{try{const I=await Mr.createProspect(F);try{await Mr.addAudience(e,{contact_ids:[],prospect_ids:[I.id]})}catch(R){console.error(" Failed to add prospect to campaign audience:",R)}Ue.success("Prospect created successfully!"),await j(),p(!1)}catch(I){throw console.error("Error creating prospect:",I),Ue.error("Failed to create prospect. Please try again."),I}},L=F=>{u(F),v(!0)},O=async F=>{await j()},V=async F=>{if(window.confirm(`Are you sure you want to delete ${F.first_name} ${F.last_name}? This action cannot be undone.`))try{await Mr.deleteProspect(F.id),Ue.success("Prospect deleted successfully!"),await j()}catch(I){console.error("Error deleting prospect:",I),Ue.error("Failed to delete prospect. Please try again.")}},W=F=>{var R;const I=(F||"").toLowerCase();return((R=D.find(C=>C.value===I))==null?void 0:R.color)||"bg-gray-100 text-gray-800"},B=F=>{var R;const I=(F||"").toLowerCase();return((R=D.find(C=>C.value===I))==null?void 0:R.label)||F},P=r.filter(F=>{const I=(F.status||"").toLowerCase(),R=y==="all"||I===y,C=!w||(F.first_name||"").toLowerCase().includes(w.toLowerCase())||(F.last_name||"").toLowerCase().includes(w.toLowerCase())||(F.email||"").toLowerCase().includes(w.toLowerCase())||(F.company_name||"").toLowerCase().includes(w.toLowerCase());return R&&C});return a?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),o.jsx("p",{className:"text-text-secondary",children:"Loading prospects..."})]}):s?o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Y,{name:"AlertCircle",size:48,className:"text-error mx-auto mb-4"}),o.jsx("p",{className:"text-error mb-4",children:s}),o.jsx("button",{onClick:j,className:"btn-primary",children:"Retry"})]}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Campaign Prospects"}),o.jsxs("p",{className:"text-sm text-text-secondary",children:[P.length," prospect",P.length!==1?"s":"",(y!=="all"||w)&&` (${r.length} total)`]})]}),t(["prospects.create"])&&o.jsxs("button",{onClick:()=>p(!0),className:"btn-primary flex items-center space-x-2",children:[o.jsx(Y,{name:"UserPlus",size:16}),o.jsx("span",{children:"Add Prospect"})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx(Y,{name:"Search",size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary"}),o.jsx("input",{type:"text",placeholder:"Search prospects by name, email, or company...",value:w,onChange:F=>_(F.target.value),className:"w-full pl-10 pr-4 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary text-text-primary placeholder-text-tertiary"}),w&&o.jsx("button",{onClick:()=>_(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-text-tertiary hover:text-text-primary",children:o.jsx(Y,{name:"X",size:16})})]}),o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsxs("button",{onClick:()=>b("all"),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${y==="all"?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["All (",r.length,")"]}),D.map(F=>{const I=r.filter(R=>(R.status||"").toLowerCase()===F.value).length;return o.jsxs("button",{onClick:()=>b(F.value),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${y===F.value?"bg-primary text-white":`${F.color} hover:opacity-80`}`,children:[F.label," (",I,")"]},F.value)})]})]}),P.length===0?o.jsxs("div",{className:"text-center py-12 bg-surface rounded-lg border border-border",children:[o.jsx(Y,{name:"Users",size:48,className:"text-text-tertiary mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:y==="all"&&!w?"No prospects yet":"No prospects found"}),o.jsx("p",{className:"text-text-secondary",children:y==="all"&&!w?"Prospects from this campaign will appear here":"Try adjusting your filters or search query"})]}):o.jsx("div",{className:"bg-surface rounded-lg border border-border overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Prospect"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Contact Info"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Company"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Status"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Lead Score"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Source"}),o.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-border",children:P.map(F=>{var I,R;return o.jsxs("tr",{className:"hover:bg-surface-hover transition-colors duration-150 cursor-pointer",onClick:()=>N(F),children:[o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-primary font-medium",children:(((I=F.first_name)==null?void 0:I[0])||"")+(((R=F.last_name)==null?void 0:R[0])||"")})}),o.jsxs("div",{children:[o.jsxs("div",{className:"text-sm font-medium text-text-primary",children:[F.first_name," ",F.last_name]}),o.jsxs("div",{className:"text-xs text-text-tertiary",children:["ID: ",F.id.slice(0,8)]})]})]})}),o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"text-sm",children:[F.email&&o.jsxs("div",{className:"flex items-center space-x-2 text-text-secondary",children:[o.jsx(Y,{name:"Mail",size:14}),o.jsx("span",{children:F.email})]}),F.phone&&o.jsxs("div",{className:"flex items-center space-x-2 text-text-secondary mt-1",children:[o.jsx(Y,{name:"Phone",size:14}),o.jsx("span",{children:F.phone})]})]})}),o.jsx("td",{className:"px-6 py-4 text-sm text-text-primary",children:F.company_name||"-"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${W(F.status)}`,children:B(F.status)})}),o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 max-w-[80px]",children:o.jsx("div",{className:`h-2 rounded-full transition-all ${F.lead_score>=75?"bg-green-500":F.lead_score>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${F.lead_score||0}%`}})}),o.jsx("span",{className:"text-sm font-medium text-text-primary",children:F.lead_score||0})]})}),o.jsx("td",{className:"px-6 py-4 text-sm text-text-secondary",children:F.source||"-"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:o.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[(F.status||"").toLowerCase()==="converted"&&o.jsx("button",{onClick:C=>{C.stopPropagation(),L(F)},className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors duration-150",title:"Create deal from this prospect",children:o.jsx(Y,{name:"DollarSign",size:16})}),(F.status||"").toLowerCase()!=="converted"&&t(["prospects.convert"])&&o.jsx("button",{onClick:C=>{C.stopPropagation(),S(F)},className:"p-2 text-primary hover:bg-primary-50 rounded-lg transition-colors duration-150",title:"Convert to contact",children:o.jsx(Y,{name:"UserPlus",size:16})}),o.jsx("button",{onClick:C=>{C.stopPropagation(),N(F)},className:"p-2 text-text-secondary hover:bg-surface-hover rounded-lg transition-colors duration-150",title:"View details",children:o.jsx(Y,{name:"Eye",size:16})}),o.jsx("button",{onClick:C=>{C.stopPropagation(),V(F)},className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors duration-150",title:"Delete prospect",children:o.jsx(Y,{name:"Trash2",size:16})})]})})]},F.id)})})]})})}),d&&c&&o.jsx(YWe,{prospect:c,onClose:()=>{f(!1),u(null)},onUpdate:A,onConvert:()=>{f(!1),m(!0)}}),h&&c&&o.jsx(XWe,{prospect:c,onClose:()=>{m(!1),u(null)},onConvert:E}),x&&o.jsx(KWe,{campaignId:e,onClose:()=>p(!1),onSubmit:T}),g&&c&&o.jsx(ZWe,{prospect:c,campaignId:e,onClose:()=>{v(!1),u(null)},onSuccess:O})]})},QWe=({campaignId:e})=>{var h,m,x,p,g,v,y,b,w,_;const[t,r]=M.useState(null),[n,a]=M.useState([]),[i,s]=M.useState(!0),[l,c]=M.useState(null),[u,d]=M.useState(30);M.useEffect(()=>{e&&f()},[e,u]);const f=async()=>{s(!0),c(null);try{const[D,j]=await Promise.all([Mr.getCampaignMetrics(e),Mr.getCampaignAnalytics(e,u)]);r(D),a(j||[])}catch(D){console.error("Error loading performance data:",D),c("Failed to load performance data. Please try again.")}finally{s(!1)}};return i?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),o.jsx("p",{className:"text-text-secondary",children:"Loading performance data..."})]}):l?o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Y,{name:"AlertCircle",size:48,className:"text-error mx-auto mb-4"}),o.jsx("p",{className:"text-error mb-4",children:l}),o.jsx("button",{onClick:f,className:"btn-primary",children:"Retry"})]}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Performance Analytics"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Time Range:"}),o.jsxs("select",{value:u,onChange:D=>d(Number(D.target.value)),className:"text-sm border border-border rounded-md px-3 py-1.5 bg-surface",children:[o.jsx("option",{value:7,children:"Last 7 days"}),o.jsx("option",{value:30,children:"Last 30 days"}),o.jsx("option",{value:60,children:"Last 60 days"}),o.jsx("option",{value:90,children:"Last 90 days"})]})]})]}),t&&o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("span",{className:"text-sm font-medium text-blue-700",children:"Open Rate"}),o.jsx(Y,{name:"Mail",size:16,className:"text-blue-600"})]}),o.jsxs("div",{className:"text-2xl font-semibold text-blue-900",children:[((h=t.open_rate)==null?void 0:h.toFixed(1))||0,"%"]}),o.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[t.opened_count||0," / ",t.sent_count||0]})]}),o.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("span",{className:"text-sm font-medium text-green-700",children:"Click Rate"}),o.jsx(Y,{name:"MousePointer",size:16,className:"text-green-600"})]}),o.jsxs("div",{className:"text-2xl font-semibold text-green-900",children:[((m=t.click_rate)==null?void 0:m.toFixed(1))||0,"%"]}),o.jsxs("div",{className:"text-xs text-green-600 mt-1",children:[t.clicked_count||0," / ",t.sent_count||0]})]}),o.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("span",{className:"text-sm font-medium text-purple-700",children:"Conversion Rate"}),o.jsx(Y,{name:"TrendingUp",size:16,className:"text-purple-600"})]}),o.jsxs("div",{className:"text-2xl font-semibold text-purple-900",children:[((x=t.conversion_rate)==null?void 0:x.toFixed(1))||0,"%"]}),o.jsxs("div",{className:"text-xs text-purple-600 mt-1",children:[t.converted_count||0," conversions"]})]}),o.jsxs("div",{className:`border rounded-lg p-4 ${(t.roi||0)>=0?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("span",{className:`text-sm font-medium ${(t.roi||0)>=0?"text-green-700":"text-red-700"}`,children:"ROI"}),o.jsx(Y,{name:"DollarSign",size:16,className:(t.roi||0)>=0?"text-green-600":"text-red-600"})]}),o.jsxs("div",{className:`text-2xl font-semibold ${(t.roi||0)>=0?"text-green-900":"text-red-900"}`,children:[((p=t.roi)==null?void 0:p.toFixed(1))||0,"%"]})]})]}),n.length>0&&o.jsxs("div",{className:"bg-surface rounded-lg border border-border p-6",children:[o.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-4",children:"Engagement Trends"}),o.jsx(pa,{width:"100%",height:300,children:o.jsxs(tv,{data:n,children:[o.jsx(rs,{strokeDasharray:"3 3"}),o.jsx(Ea,{dataKey:"period_start",tickFormatter:D=>new Date(D).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),o.jsx(Ta,{}),o.jsx(Rr,{labelFormatter:D=>new Date(D).toLocaleDateString()}),o.jsx(vl,{}),o.jsx(Gn,{type:"monotone",dataKey:"open_rate",name:"Open Rate (%)",stroke:"#3b82f6",strokeWidth:2}),o.jsx(Gn,{type:"monotone",dataKey:"click_rate",name:"Click Rate (%)",stroke:"#10b981",strokeWidth:2}),o.jsx(Gn,{type:"monotone",dataKey:"conversion_rate",name:"Conversion Rate (%)",stroke:"#8b5cf6",strokeWidth:2})]})})]}),t&&o.jsxs("div",{className:"bg-surface rounded-lg border border-border p-6",children:[o.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-4",children:"Engagement Funnel"}),o.jsx(pa,{width:"100%",height:300,children:o.jsxs(td,{data:[{name:"Sent",count:t.sent_count||0,percentage:100},{name:"Delivered",count:t.delivered_count||0,percentage:t.sent_count>0?(t.delivered_count/t.sent_count*100).toFixed(1):0},{name:"Opened",count:t.opened_count||0,percentage:t.sent_count>0?(t.opened_count/t.sent_count*100).toFixed(1):0},{name:"Clicked",count:t.clicked_count||0,percentage:t.sent_count>0?(t.clicked_count/t.sent_count*100).toFixed(1):0},{name:"Responded",count:t.responded_count||0,percentage:t.sent_count>0?(t.responded_count/t.sent_count*100).toFixed(1):0},{name:"Converted",count:t.converted_count||0,percentage:t.sent_count>0?(t.converted_count/t.sent_count*100).toFixed(1):0}],children:[o.jsx(rs,{strokeDasharray:"3 3"}),o.jsx(Ea,{dataKey:"name"}),o.jsx(Ta,{}),o.jsx(Rr,{formatter:(D,j)=>j==="percentage"?[`${D}%`,"Percentage"]:[D,"Count"]}),o.jsx(vl,{}),o.jsx(ai,{dataKey:"count",name:"Count",fill:"#3b82f6"})]})})]}),t&&o.jsxs("div",{className:"bg-surface rounded-lg border border-border overflow-hidden",children:[o.jsx("div",{className:"px-6 py-4 border-b border-border",children:o.jsx("h4",{className:"text-lg font-semibold text-text-primary",children:"Detailed Metrics"})}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Metric"}),o.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Count"}),o.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Rate"})]})}),o.jsxs("tbody",{className:"bg-white divide-y divide-border",children:[o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 text-sm text-text-primary",children:"Sent"}),o.jsx("td",{className:"px-6 py-4 text-sm text-right font-medium text-text-primary",children:t.sent_count||0}),o.jsx("td",{className:"px-6 py-4 text-sm text-right text-text-secondary",children:"-"})]}),o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 text-sm text-text-primary",children:"Delivered"}),o.jsx("td",{className:"px-6 py-4 text-sm text-right font-medium text-text-primary",children:t.delivered_count||0}),o.jsxs("td",{className:"px-6 py-4 text-sm text-right text-text-secondary",children:[t.sent_count>0?(t.delivered_count/t.sent_count*100).toFixed(1):0,"%"]})]}),o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 text-sm text-text-primary",children:"Opened"}),o.jsx("td",{className:"px-6 py-4 text-sm text-right font-medium text-primary",children:t.opened_count||0}),o.jsxs("td",{className:"px-6 py-4 text-sm text-right text-primary font-medium",children:[((g=t.open_rate)==null?void 0:g.toFixed(1))||0,"%"]})]}),o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 text-sm text-text-primary",children:"Clicked"}),o.jsx("td",{className:"px-6 py-4 text-sm text-right font-medium text-text-primary",children:t.clicked_count||0}),o.jsxs("td",{className:"px-6 py-4 text-sm text-right text-text-secondary",children:[((v=t.click_rate)==null?void 0:v.toFixed(1))||0,"%"]})]}),o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 text-sm text-text-primary",children:"Bounced"}),o.jsx("td",{className:"px-6 py-4 text-sm text-right font-medium text-yellow-600",children:t.bounced_count||0}),o.jsxs("td",{className:"px-6 py-4 text-sm text-right text-yellow-600",children:[((y=t.bounce_rate)==null?void 0:y.toFixed(1))||0,"%"]})]}),o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 text-sm text-text-primary",children:"Unsubscribed"}),o.jsx("td",{className:"px-6 py-4 text-sm text-right font-medium text-red-600",children:t.unsubscribed_count||0}),o.jsxs("td",{className:"px-6 py-4 text-sm text-right text-red-600",children:[((b=t.unsubscribe_rate)==null?void 0:b.toFixed(1))||0,"%"]})]}),o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 text-sm text-text-primary",children:"Responded"}),o.jsx("td",{className:"px-6 py-4 text-sm text-right font-medium text-text-primary",children:t.responded_count||0}),o.jsxs("td",{className:"px-6 py-4 text-sm text-right text-text-secondary",children:[((w=t.response_rate)==null?void 0:w.toFixed(1))||0,"%"]})]}),o.jsxs("tr",{className:"bg-green-50",children:[o.jsx("td",{className:"px-6 py-4 text-sm font-medium text-green-900",children:"Converted"}),o.jsx("td",{className:"px-6 py-4 text-sm text-right font-semibold text-green-900",children:t.converted_count||0}),o.jsxs("td",{className:"px-6 py-4 text-sm text-right font-semibold text-green-900",children:[((_=t.conversion_rate)==null?void 0:_.toFixed(1))||0,"%"]})]})]})]})})]})]})},eze=({campaignId:e,onClose:t,onSuccess:r})=>{const[n,a]=M.useState([]),[i,s]=M.useState([]),[l,c]=M.useState(!0),[u,d]=M.useState(!1),[f,h]=M.useState("contacts"),[m,x]=M.useState(""),[p,g]=M.useState([]);M.useEffect(()=>{v()},[]);const v=async()=>{c(!0);try{const[E,A]=await Promise.all([Ct.getUserContacts(),Mr.getProspects()]);a(Array.isArray(E)?E:[]),s(Array.isArray(A)?A:[])}catch(E){console.error("Error loading data:",E),Ue.error("Failed to load contacts and prospects")}finally{c(!1)}},y=E=>{g(A=>A.includes(E)?A.filter(T=>T!==E):[...A,E])},b=()=>{const A=(f==="contacts"?_:D).map(T=>T.id);A.every(T=>p.includes(T))?g(T=>T.filter(L=>!A.includes(L))):g(T=>{const L=[...T];return A.forEach(O=>{L.includes(O)||L.push(O)}),L})},w=async()=>{if(p.length===0){Ue.error("Please select at least one contact or prospect");return}d(!0);try{const E=p.filter(T=>n.some(L=>L.id===T)),A=p.filter(T=>i.some(L=>L.id===T));await Mr.addAudience(e,{contact_ids:E,prospect_ids:A}),Ue.success(`Added ${p.length} member${p.length!==1?"s":""} to campaign audience`),r(),t()}catch(E){console.error("Error adding audience:",E),Ue.error("Failed to add audience members. Please try again.")}finally{d(!1)}},_=n.filter(E=>{if(!m)return!0;const A=m.toLowerCase(),T=typeof E.company=="object"&&E.company!==null?E.company.name||"":E.company||"";return(E.first_name||"").toLowerCase().includes(A)||(E.last_name||"").toLowerCase().includes(A)||(E.email||"").toLowerCase().includes(A)||T.toLowerCase().includes(A)}),D=i.filter(E=>{if(!m)return!0;const A=m.toLowerCase(),T=E.company_name||E.company||"";return(E.first_name||"").toLowerCase().includes(A)||(E.last_name||"").toLowerCase().includes(A)||(E.email||"").toLowerCase().includes(A)||T.toLowerCase().includes(A)}),j=f==="contacts"?_:D,N=j.map(E=>E.id),S=N.length>0&&N.every(E=>p.includes(E));return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-surface rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[o.jsxs("div",{className:"px-6 py-4 border-b border-border flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center",children:o.jsx(Y,{name:"Users",size:20,className:"text-primary"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Add Campaign Audience"}),o.jsxs("p",{className:"text-sm text-text-secondary",children:[p.length," selected"]})]})]}),o.jsx("button",{onClick:t,disabled:u,className:"p-2 text-text-secondary hover:text-text-primary hover:bg-surface-hover rounded-lg transition-colors disabled:opacity-50",children:o.jsx(Y,{name:"X",size:20})})]}),o.jsx("div",{className:"border-b border-border",children:o.jsxs("div",{className:"px-6 flex space-x-4",children:[o.jsxs("button",{onClick:()=>h("contacts"),className:`py-3 px-4 font-medium border-b-2 transition-colors ${f==="contacts"?"border-primary text-primary":"border-transparent text-text-secondary hover:text-text-primary"}`,children:["Contacts (",n.length,")"]}),o.jsxs("button",{onClick:()=>h("prospects"),className:`py-3 px-4 font-medium border-b-2 transition-colors ${f==="prospects"?"border-primary text-primary":"border-transparent text-text-secondary hover:text-text-primary"}`,children:["Prospects (",i.length,")"]})]})}),o.jsx("div",{className:"px-6 py-4 border-b border-border",children:o.jsxs("div",{className:"relative",children:[o.jsx(Y,{name:"Search",size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary"}),o.jsx("input",{type:"text",placeholder:`Search ${f}...`,value:m,onChange:E=>x(E.target.value),className:"w-full pl-10 pr-4 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"}),m&&o.jsx("button",{onClick:()=>x(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-text-tertiary hover:text-text-primary",children:o.jsx(Y,{name:"X",size:16})})]})}),o.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:l?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),o.jsx("p",{className:"text-text-secondary",children:"Loading..."})]}):j.length===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Y,{name:"Users",size:48,className:"text-text-tertiary mx-auto mb-4"}),o.jsx("p",{className:"text-text-secondary",children:m?`No ${f} found matching "${m}"`:`No ${f} available`})]}):o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center space-x-3 py-2 px-3 bg-gray-50 rounded-lg",children:[o.jsx("input",{type:"checkbox",checked:S,onChange:b,className:"w-4 h-4 text-primary border-border rounded focus:ring-2 focus:ring-primary"}),o.jsxs("span",{className:"text-sm font-medium text-text-primary",children:["Select All (",j.length,")"]})]}),j.map(E=>{var T,L;const A=f==="contacts"?typeof E.company=="object"&&E.company!==null?E.company.name:E.company:E.company_name||E.company;return o.jsxs("div",{onClick:()=>y(E.id),className:`flex items-center space-x-3 p-3 border rounded-lg cursor-pointer transition-colors ${p.includes(E.id)?"border-primary bg-primary-50":"border-border hover:bg-surface-hover"}`,children:[o.jsx("input",{type:"checkbox",checked:p.includes(E.id),onChange:()=>{},className:"w-4 h-4 text-primary border-border rounded focus:ring-2 focus:ring-primary"}),o.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center flex-shrink-0",children:o.jsx("span",{className:"text-primary font-medium text-sm",children:(((T=E.first_name)==null?void 0:T[0])||"")+(((L=E.last_name)==null?void 0:L[0])||"")})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"text-sm font-medium text-text-primary",children:[E.first_name," ",E.last_name]}),o.jsxs("div",{className:"text-xs text-text-secondary truncate",children:[E.email||"No email",A&&`  ${A}`]})]}),f==="prospects"&&o.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${E.status==="qualified"?"bg-green-100 text-green-800":E.status==="contacted"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:E.status})]},E.id)})]})}),o.jsxs("div",{className:"px-6 py-4 border-t border-border flex space-x-3",children:[o.jsx("button",{type:"button",onClick:t,disabled:u,className:"flex-1 btn-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),o.jsx("button",{type:"button",onClick:w,disabled:u||p.length===0,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:u?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),o.jsx("span",{children:"Adding..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(Y,{name:"UserPlus",size:16}),o.jsxs("span",{children:["Add ",p.length>0?`(${p.length})`:""]})]})})]})]})})},tze=({campaignId:e})=>{const{hasAnyPermission:t}=Vt(),[r,n]=M.useState([]),[a,i]=M.useState(!0),[s,l]=M.useState(null),[c,u]=M.useState("all"),[d,f]=M.useState(!1),[h,m]=M.useState(null),[x,p]=M.useState(!1),[g,v]=M.useState(null),y=[{value:"pending",label:"Pending",color:"bg-gray-100 text-gray-800"},{value:"sent",label:"Sent",color:"bg-blue-100 text-blue-800"},{value:"delivered",label:"Delivered",color:"bg-green-100 text-green-800"},{value:"opened",label:"Opened",color:"bg-purple-100 text-purple-800"},{value:"clicked",label:"Clicked",color:"bg-yellow-100 text-yellow-800"},{value:"responded",label:"Responded",color:"bg-indigo-100 text-indigo-800"},{value:"bounced",label:"Bounced",color:"bg-red-100 text-red-800"},{value:"converted",label:"Converted",color:"bg-green-100 text-green-800"}];M.useEffect(()=>{e&&b()},[e]);const b=async()=>{i(!0),l(null);try{const A=await Mr.getCampaignAudience(e);n(A||[])}catch(A){console.error("Error loading audience:",A),l("Failed to load audience. Please try again.")}finally{i(!1)}},w=async(A,T)=>{if(confirm(`Remove ${T} from this campaign?`)){m(A);try{await Mr.removeAudienceMember(e,A),Ue.success(`${T} removed from campaign`),b()}catch(L){console.error("Error removing audience member:",L),Ue.error(L.message||"Failed to remove audience member")}finally{m(null)}}},_=async()=>{const A=r.filter(T=>T.status==="pending").length;if(A===0){Ue.error("No pending audience members to send to");return}if(confirm(`Send campaign to ${A} new audience member(s)?`)){p(!0);try{const T=await Mr.sendToPendingAudience(e);Ue.success(T.message||`Sent to ${T.sent_count} member(s)`),b()}catch(T){console.error("Error sending to new members:",T),Ue.error(T.message||"Failed to send to new members")}finally{p(!1)}}},D=async(A,T)=>{if(confirm(`Resend campaign to ${T}?`)){v(A);try{const L=await Mr.resendToMember(e,A);Ue.success(L.message||`Campaign resent to ${T}`),b()}catch(L){console.error("Error resending to member:",L),Ue.error(L.message||"Failed to resend campaign")}finally{v(null)}}},j=async(A,T)=>{if(confirm(`Send campaign to ${T}?`)){v(A);try{const L=await Mr.resendToMember(e,A);Ue.success(L.message||`Campaign sent to ${T}`),b()}catch(L){console.error("Error sending to member:",L),Ue.error(L.message||"Failed to send campaign")}finally{v(null)}}},N=A=>{var T;return((T=y.find(L=>L.value===A))==null?void 0:T.color)||"bg-gray-100 text-gray-800"},S=A=>{var T;return((T=y.find(L=>L.value===A))==null?void 0:T.label)||A},E=r.filter(A=>c==="all"||A.status===c);return a?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),o.jsx("p",{className:"text-text-secondary",children:"Loading audience..."})]}):s?o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Y,{name:"AlertCircle",size:48,className:"text-error mx-auto mb-4"}),o.jsx("p",{className:"text-error mb-4",children:s}),o.jsx("button",{onClick:b,className:"btn-primary",children:"Retry"})]}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Campaign Audience"}),o.jsxs("p",{className:"text-sm text-text-secondary",children:[E.length," member",E.length!==1?"s":"",c!=="all"&&` (${r.length} total)`,r.filter(A=>A.status==="pending").length>0&&o.jsxs("span",{className:"ml-2 text-orange-600 font-medium",children:["(",r.filter(A=>A.status==="pending").length," pending)"]})]})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[r.filter(A=>A.status==="pending").length>0&&o.jsx("button",{onClick:_,disabled:x,className:"btn-secondary flex items-center space-x-2 disabled:opacity-50",children:x?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"}),o.jsx("span",{children:"Sending..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(Y,{name:"Send",size:16}),o.jsx("span",{children:"Send to New Members"})]})}),o.jsxs("button",{onClick:()=>f(!0),className:"btn-primary flex items-center space-x-2",children:[o.jsx(Y,{name:"UserPlus",size:16}),o.jsx("span",{children:"Add Audience"})]})]})]}),o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsxs("button",{onClick:()=>u("all"),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${c==="all"?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["All (",r.length,")"]}),y.map(A=>{const T=r.filter(L=>L.status===A.value).length;return o.jsxs("button",{onClick:()=>u(A.value),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${c===A.value?"bg-primary text-white":`${A.color} hover:opacity-80`}`,children:[A.label," (",T,")"]},A.value)})]}),E.length===0?o.jsxs("div",{className:"text-center py-12 bg-surface rounded-lg border border-border",children:[o.jsx(Y,{name:"Users",size:48,className:"text-text-tertiary mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:c==="all"?"No audience members yet":"No members with this status"}),o.jsx("p",{className:"text-text-secondary",children:c==="all"?"Add contacts or prospects to this campaign":"Try selecting a different status"})]}):o.jsx("div",{className:"bg-surface rounded-lg border border-border overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Name"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Type"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Email"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Status"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Sent At"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Opened At"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Clicked At"}),o.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-border",children:E.map((A,T)=>o.jsxs("tr",{className:"hover:bg-surface-hover transition-colors",children:[o.jsx("td",{className:"px-6 py-4",children:o.jsx("div",{className:"text-sm font-medium text-text-primary",children:A.name||"Unknown"})}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${A.recipient_type==="contact"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:A.recipient_type==="contact"?"Contact":"Prospect"})}),o.jsx("td",{className:"px-6 py-4 text-sm text-text-secondary",children:A.email||"-"}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${N(A.status)}`,children:S(A.status)})}),o.jsx("td",{className:"px-6 py-4 text-sm text-text-secondary",children:A.sent_at?new Date(A.sent_at).toLocaleDateString():"-"}),o.jsx("td",{className:"px-6 py-4 text-sm text-text-secondary",children:A.opened_at?new Date(A.opened_at).toLocaleDateString():"-"}),o.jsx("td",{className:"px-6 py-4 text-sm text-text-secondary",children:A.clicked_at?new Date(A.clicked_at).toLocaleDateString():"-"}),o.jsx("td",{className:"px-6 py-4 text-right",children:o.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[A.status==="pending"&&o.jsx("button",{onClick:()=>j(A.campaign_contact_id,A.name),disabled:g===A.campaign_contact_id,className:"text-green-600 hover:text-green-700 disabled:opacity-50 disabled:cursor-not-allowed",title:"Send campaign to this member",children:g===A.campaign_contact_id?o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-green-600 inline-block"}):o.jsx(Y,{name:"Send",size:16})}),["sent","bounced","failed","delivered"].includes(A.status)&&o.jsx("button",{onClick:()=>D(A.campaign_contact_id,A.name),disabled:g===A.campaign_contact_id,className:"text-primary hover:text-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",title:"Resend campaign",children:g===A.campaign_contact_id?o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary inline-block"}):o.jsx(Y,{name:"RefreshCw",size:16})}),o.jsx("button",{onClick:()=>w(A.campaign_contact_id,A.name),disabled:h===A.campaign_contact_id,className:"text-error hover:text-red-700 disabled:opacity-50 disabled:cursor-not-allowed",title:"Remove from campaign",children:h===A.campaign_contact_id?o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-error inline-block"}):o.jsx(Y,{name:"Trash2",size:16})})]})})]},T))})]})})}),d&&o.jsx(eze,{campaignId:e,onClose:()=>f(!1),onSuccess:()=>{b(),f(!1)}})]})},rze=({campaign:e})=>{const[t,r]=M.useState(!1),[n,a]=M.useState(!1),[i,s]=M.useState(""),[l,c]=M.useState(""),u=async()=>{if(e!=null&&e.id){if(e.type==="email"){if(!e.email_template_id){Ue.error("Campaign must have an email template selected");return}if(!e.email_subject){Ue.error("Campaign must have an email subject");return}}if(n){const h=i.split(",").map(p=>p.trim()).filter(p=>p);if(h.length===0){Ue.error("Please enter at least one test email recipient");return}const m=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,x=h.filter(p=>!m.test(p));if(x.length>0){Ue.error(`Invalid email addresses: ${x.join(", ")}`);return}}r(!0);try{const h={send_test_email:n,test_email_recipients:n?i.split(",").map(x=>x.trim()).filter(x=>x):[],schedule_for:l||null},m=await Mr.executeCampaign(e.id,h);n?Ue.success("Test emails sent successfully!"):l?Ue.success(`Campaign scheduled for ${new Date(l).toLocaleString()}`):Ue.success(`Campaign executed! Sent to ${m.sent_count||0} recipients`),a(!1),s(""),c("")}catch(h){console.error("Error executing campaign:",h),Ue.error(h.message||"Failed to execute campaign")}finally{r(!1)}}},d=(e==null?void 0:e.status)!=="completed"&&(e==null?void 0:e.status)!=="cancelled",f=(e==null?void 0:e.type)==="email";return o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx(Y,{name:"Info",size:20,className:"text-blue-600 mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Campaign Execution"}),o.jsx("p",{className:"text-sm text-blue-800",children:f?"This will send emails to all members in the campaign audience using the configured email template and settings.":"Execute this campaign to engage with your audience."})]})]})}),o.jsxs("div",{className:"bg-surface border border-border rounded-lg p-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[o.jsx(Y,{name:"CheckCircle",size:20,className:"mr-2"}),"Pre-flight Checklist"]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Y,{name:(e==null?void 0:e.status)==="draft"||(e==null?void 0:e.status)==="active"?"CheckCircle":"XCircle",size:20,className:(e==null?void 0:e.status)==="draft"||(e==null?void 0:e.status)==="active"?"text-green-600":"text-red-600"}),o.jsxs("span",{className:"text-text-secondary",children:["Campaign status: ",o.jsx("span",{className:"font-medium text-text-primary",children:e==null?void 0:e.status})]})]}),f&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Y,{name:e!=null&&e.email_template_id?"CheckCircle":"XCircle",size:20,className:e!=null&&e.email_template_id?"text-green-600":"text-red-600"}),o.jsxs("span",{className:"text-text-secondary",children:["Email template: ",e!=null&&e.email_template_id?o.jsx("span",{className:"font-medium text-text-primary",children:(e==null?void 0:e.email_template_name)||"Selected"}):o.jsx("span",{className:"font-medium text-red-600",children:"Not selected"})]})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Y,{name:e!=null&&e.email_subject?"CheckCircle":"XCircle",size:20,className:e!=null&&e.email_subject?"text-green-600":"text-red-600"}),o.jsxs("span",{className:"text-text-secondary",children:["Email subject: ",e!=null&&e.email_subject?o.jsx("span",{className:"font-medium text-text-primary",children:e==null?void 0:e.email_subject}):o.jsx("span",{className:"font-medium text-red-600",children:"Not set"})]})]})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Y,{name:d?"CheckCircle":"XCircle",size:20,className:d?"text-green-600":"text-red-600"}),o.jsxs("span",{className:"text-text-secondary",children:["Can execute: ",o.jsx("span",{className:`font-medium ${d?"text-green-600":"text-red-600"}`,children:d?"Yes":"No (campaign is completed or cancelled)"})]})]})]})]}),d&&o.jsxs("div",{className:"bg-surface border border-border rounded-lg p-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[o.jsx(Y,{name:"Settings",size:20,className:"mr-2"}),"Execution Options"]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx("input",{type:"checkbox",id:"send-test-email",checked:n,onChange:h=>a(h.target.checked),className:"mt-1 h-4 w-4 text-primary border-border rounded focus:ring-2 focus:ring-primary"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("label",{htmlFor:"send-test-email",className:"block text-sm font-medium text-text-primary cursor-pointer",children:"Send Test Email First"}),o.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"Send a test email to verify everything looks correct before sending to your entire audience"}),n&&o.jsxs("div",{className:"mt-3",children:[o.jsx("label",{htmlFor:"test-recipients",className:"block text-sm font-medium text-text-secondary mb-2",children:"Test Email Recipients (comma-separated)"}),o.jsx("input",{type:"text",id:"test-recipients",value:i,onChange:h=>s(h.target.value),placeholder:"email1@example.com, email2@example.com",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]})]})]}),!n&&o.jsxs("div",{children:[o.jsx("label",{htmlFor:"schedule-for",className:"block text-sm font-medium text-text-secondary mb-2",children:"Schedule for Later (Optional)"}),o.jsx("input",{type:"datetime-local",id:"schedule-for",value:l,onChange:h=>c(h.target.value),min:new Date().toISOString().slice(0,16),className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"}),o.jsx("p",{className:"text-sm text-text-tertiary mt-1",children:"Leave empty to send immediately, or select a date and time to schedule for later"})]})]})]}),d&&o.jsx("div",{className:"bg-surface border border-border rounded-lg p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-1",children:["Ready to ",n?"Send Test":l?"Schedule Campaign":"Execute Campaign","?"]}),o.jsx("p",{className:"text-sm text-text-secondary",children:n?"Test emails will be sent to the specified recipients":l?"Campaign will be scheduled for the specified date and time":"This will immediately send to all audience members"})]}),o.jsx("button",{onClick:u,disabled:t||f&&(!(e!=null&&e.email_template_id)||!(e!=null&&e.email_subject)),className:"btn-primary flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:t?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),o.jsx("span",{children:"Processing..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(Y,{name:n?"Send":l?"Clock":"Send",size:16}),o.jsx("span",{children:n?"Send Test":l?"Schedule":"Execute Campaign"})]})})]})}),!d&&o.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx(Y,{name:"AlertTriangle",size:20,className:"text-yellow-600 mt-0.5"}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-semibold text-yellow-900 mb-1",children:"Campaign Cannot Be Executed"}),o.jsxs("p",{className:"text-sm text-yellow-800",children:['This campaign has a status of "',e==null?void 0:e.status,'" and cannot be executed. Only campaigns with "draft" or "active" status can be executed.']})]})]})})]})},nze=({campaign:e,statuses:t,types:r,onEdit:n,onDelete:a})=>{var c,u,d,f,h;const[i,s]=M.useState("overview"),l=[{id:"overview",label:"Overview",icon:"Info"},{id:"prospects",label:"Prospects",icon:"Users"},{id:"audience",label:"Audience",icon:"Target"},{id:"execute",label:"Execute",icon:"Send"},{id:"performance",label:"Performance",icon:"TrendingUp"}];return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[o.jsxs("div",{className:"px-6 py-4 border-b border-border flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"w-12 h-12 bg-primary-50 rounded-lg flex items-center justify-center",children:o.jsx(Y,{name:((c=r.find(m=>m.value===(e==null?void 0:e.type)))==null?void 0:c.icon)||"Megaphone",size:24,className:"text-primary"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:e==null?void 0:e.name}),o.jsxs("p",{className:"text-sm text-text-secondary",children:[(u=r.find(m=>m.value===(e==null?void 0:e.type)))==null?void 0:u.label," Campaign"]})]})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[n&&o.jsxs("button",{onClick:n,className:"btn-primary flex items-center space-x-2",children:[o.jsx(Y,{name:"Edit",size:16}),o.jsx("span",{children:"Edit Campaign"})]}),a&&o.jsxs("button",{onClick:a,className:"btn-secondary text-error hover:bg-error-50 flex items-center space-x-2",children:[o.jsx(Y,{name:"Trash2",size:16}),o.jsx("span",{children:"Delete"})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 divide-y md:divide-y-0 md:divide-x divide-border",children:[o.jsxs("div",{className:"px-6 py-4",children:[o.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"Status"}),o.jsx("span",{className:`inline-block px-3 py-1 text-sm font-medium rounded-full ${((d=t.find(m=>m.value===(e==null?void 0:e.status)))==null?void 0:d.color)||"bg-gray-100 text-gray-800"}`,children:((f=t.find(m=>m.value===(e==null?void 0:e.status)))==null?void 0:f.label)||(e==null?void 0:e.status)})]}),o.jsxs("div",{className:"px-6 py-4",children:[o.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"Sent"}),o.jsx("div",{className:"text-2xl font-semibold text-text-primary",children:(e==null?void 0:e.sent_count)||0})]}),o.jsxs("div",{className:"px-6 py-4",children:[o.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"Open Rate"}),o.jsxs("div",{className:"text-2xl font-semibold text-text-primary",children:[((h=e==null?void 0:e.open_rate)==null?void 0:h.toFixed(1))||0,"%"]})]}),o.jsxs("div",{className:"px-6 py-4",children:[o.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"Conversions"}),o.jsx("div",{className:"text-2xl font-semibold text-primary",children:(e==null?void 0:e.converted_count)||0})]})]})]}),o.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[o.jsx("div",{className:"border-b border-border",children:o.jsx("nav",{className:"flex space-x-1 px-6","aria-label":"Tabs",children:l.map(m=>o.jsxs("button",{onClick:()=>s(m.id),className:`flex items-center space-x-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors ${i===m.id?"border-primary text-primary":"border-transparent text-text-secondary hover:text-text-primary hover:border-gray-300"}`,children:[o.jsx(Y,{name:m.icon,size:16}),o.jsx("span",{children:m.label})]},m.id))})}),o.jsxs("div",{className:"p-6",children:[i==="overview"&&o.jsx(GWe,{campaign:e,statuses:t,types:r}),i==="execute"&&o.jsx(rze,{campaign:e}),i==="audience"&&o.jsx(tze,{campaignId:e==null?void 0:e.id}),i==="performance"&&o.jsx(QWe,{campaignId:e==null?void 0:e.id}),i==="prospects"&&o.jsx(JWe,{campaignId:e==null?void 0:e.id})]})]})]})},aze=({campaign:e=null,types:t=[],statuses:r=[],onSubmit:n,onCancel:a,isSaving:i=!1})=>{const{user:s}=Vt(),[l,c]=M.useState({name:"",type:"email",status:"draft",description:"",start_date:"",end_date:"",budget:"",expected_revenue:"",email_template_id:"",email_subject:"",email_from_name:"",email_from_email:"",owner_id:(s==null?void 0:s.id)||""}),[u,d]=M.useState({}),[f,h]=M.useState([]),[m,x]=M.useState(!1);M.useEffect(()=>{(async()=>{try{x(!0);const b=await es.getTemplates({status:"active"});h(b.templates||[])}catch(b){console.error("Failed to load email templates:",b)}finally{x(!1)}})()},[]),M.useEffect(()=>{var y,b;c(e?{name:e.name||"",type:e.type||"email",status:e.status||"draft",description:e.description||"",start_date:e.start_date||"",end_date:e.end_date||"",budget:((y=e.budget)==null?void 0:y.toString())||"",expected_revenue:((b=e.expected_revenue)==null?void 0:b.toString())||"",email_template_id:e.email_template_id||"",email_subject:e.email_subject||"",email_from_name:e.email_from_name||"",email_from_email:e.email_from_email||"",owner_id:e.owner_id||(s==null?void 0:s.id)||""}:{name:"",type:"email",status:"draft",description:"",start_date:"",end_date:"",budget:"",expected_revenue:"",email_template_id:"",email_subject:"",email_from_name:"",email_from_email:"",owner_id:(s==null?void 0:s.id)||""})},[e,s==null?void 0:s.id]);const p=y=>{const{name:b,value:w}=y.target;c(_=>({..._,[b]:w})),u[b]&&d(_=>({..._,[b]:null}))},g=()=>{var b,w;const y={};return(b=l.name)!=null&&b.trim()||(y.name="Campaign name is required"),l.type||(y.type="Campaign type is required"),l.type==="email"&&(l.email_template_id||(y.email_template_id="Email template is required for email campaigns"),(w=l.email_subject)!=null&&w.trim()||(y.email_subject="Email subject is required for email campaigns")),l.budget&&isNaN(parseFloat(l.budget))&&(y.budget="Budget must be a valid number"),l.expected_revenue&&isNaN(parseFloat(l.expected_revenue))&&(y.expected_revenue="Expected revenue must be a valid number"),l.start_date&&l.end_date&&l.start_date>l.end_date&&(y.end_date="End date must be after start date"),d(y),Object.keys(y).length===0},v=y=>{var w,_,D;if(y.preventDefault(),!g())return;const b={name:l.name.trim(),type:l.type,status:l.status,description:l.description.trim()||null,start_date:l.start_date||null,end_date:l.end_date||null,budget:l.budget?parseFloat(l.budget):0,expected_revenue:l.expected_revenue?parseFloat(l.expected_revenue):0,email_template_id:l.email_template_id||null,email_subject:((w=l.email_subject)==null?void 0:w.trim())||null,email_from_name:((_=l.email_from_name)==null?void 0:_.trim())||null,email_from_email:((D=l.email_from_email)==null?void 0:D.trim())||null,owner_id:l.owner_id||(s==null?void 0:s.id)};n(b)};return o.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[o.jsx("div",{className:"px-6 py-4 border-b border-border",children:o.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:e?"Edit Campaign":"Create New Campaign"})}),o.jsxs("form",{onSubmit:v,className:"p-6",children:[o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Basic Information"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-text-secondary mb-2",children:"Campaign Name *"}),o.jsx("input",{type:"text",id:"name",name:"name",value:l.name,onChange:p,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary ${u.name?"border-error":"border-border"}`,placeholder:"Enter campaign name",required:!0}),u.name&&o.jsx("p",{className:"mt-1 text-sm text-error",children:u.name})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"type",className:"block text-sm font-medium text-text-secondary mb-2",children:"Campaign Type *"}),o.jsx("select",{id:"type",name:"type",value:l.type,onChange:p,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary ${u.type?"border-error":"border-border"}`,required:!0,children:t.map(y=>o.jsx("option",{value:y.value,children:y.label},y.value))}),u.type&&o.jsx("p",{className:"mt-1 text-sm text-error",children:u.type})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-text-secondary mb-2",children:"Status *"}),o.jsx("select",{id:"status",name:"status",value:l.status,onChange:p,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",required:!0,children:r.map(y=>o.jsx("option",{value:y.value,children:y.label},y.value))})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-text-secondary mb-2",children:"Description"}),o.jsx("textarea",{id:"description",name:"description",value:l.description,onChange:p,rows:"3",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"Enter campaign description"})]})]})]}),o.jsxs("div",{className:"border-t border-border pt-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Timeline"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"start_date",className:"block text-sm font-medium text-text-secondary mb-2",children:"Start Date"}),o.jsx("input",{type:"date",id:"start_date",name:"start_date",value:l.start_date,onChange:p,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"end_date",className:"block text-sm font-medium text-text-secondary mb-2",children:"End Date"}),o.jsx("input",{type:"date",id:"end_date",name:"end_date",value:l.end_date,onChange:p,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary ${u.end_date?"border-error":"border-border"}`}),u.end_date&&o.jsx("p",{className:"mt-1 text-sm text-error",children:u.end_date})]})]})]}),o.jsxs("div",{className:"border-t border-border pt-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Budget & Revenue"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"budget",className:"block text-sm font-medium text-text-secondary mb-2",children:"Budget"}),o.jsx("input",{type:"number",id:"budget",name:"budget",value:l.budget,onChange:p,step:"0.01",min:"0",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary ${u.budget?"border-error":"border-border"}`,placeholder:"0.00"}),u.budget&&o.jsx("p",{className:"mt-1 text-sm text-error",children:u.budget})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"expected_revenue",className:"block text-sm font-medium text-text-secondary mb-2",children:"Expected Revenue"}),o.jsx("input",{type:"number",id:"expected_revenue",name:"expected_revenue",value:l.expected_revenue,onChange:p,step:"0.01",min:"0",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary ${u.expected_revenue?"border-error":"border-border"}`,placeholder:"0.00"}),u.expected_revenue&&o.jsx("p",{className:"mt-1 text-sm text-error",children:u.expected_revenue})]})]})]}),l.type==="email"&&o.jsxs("div",{className:"border-t border-border pt-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:[o.jsx(Y,{name:"Mail",size:20,className:"inline mr-2"}),"Email Campaign Settings"]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"email_template_id",className:"block text-sm font-medium text-text-secondary mb-2",children:"Email Template *"}),o.jsxs("select",{id:"email_template_id",name:"email_template_id",value:l.email_template_id,onChange:p,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary ${u.email_template_id?"border-error":"border-border"}`,required:l.type==="email",disabled:m,children:[o.jsx("option",{value:"",children:m?"Loading templates...":"Select an email template"}),f.map(y=>o.jsxs("option",{value:y.id,children:[y.name," (",y.category,")"]},y.id))]}),u.email_template_id&&o.jsx("p",{className:"mt-1 text-sm text-error",children:u.email_template_id}),f.length===0&&!m&&o.jsx("p",{className:"mt-1 text-sm text-text-tertiary",children:"No active email templates found. Create one first."})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"email_subject",className:"block text-sm font-medium text-text-secondary mb-2",children:"Email Subject *"}),o.jsx("input",{type:"text",id:"email_subject",name:"email_subject",value:l.email_subject,onChange:p,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary ${u.email_subject?"border-error":"border-border"}`,placeholder:"Enter email subject",required:l.type==="email"}),u.email_subject&&o.jsx("p",{className:"mt-1 text-sm text-error",children:u.email_subject})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"email_from_name",className:"block text-sm font-medium text-text-secondary mb-2",children:"From Name"}),o.jsx("input",{type:"text",id:"email_from_name",name:"email_from_name",value:l.email_from_name,onChange:p,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"e.g., Sales Team"}),o.jsx("p",{className:"mt-1 text-xs text-text-tertiary",children:"Optional - defaults to system sender"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"email_from_email",className:"block text-sm font-medium text-text-secondary mb-2",children:"From Email"}),o.jsx("input",{type:"email",id:"email_from_email",name:"email_from_email",value:l.email_from_email,onChange:p,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"e.g., sales@company.com"}),o.jsx("p",{className:"mt-1 text-xs text-text-tertiary",children:"Optional - defaults to system sender"})]})]})]})]})]}),o.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6 mt-6 border-t border-border",children:[o.jsx("button",{type:"button",onClick:a,disabled:i,className:"btn-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:i,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:i?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),o.jsx("span",{children:"Saving..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(Y,{name:e?"Save":"Plus",size:16}),o.jsx("span",{children:e?"Update Campaign":"Create Campaign"})]})})]})]})]})},n_=()=>{const{campaignId:e}=Kj(),t=Il(),{user:r,hasPermission:n,hasAnyPermission:a}=Vt(),[i,s]=M.useState(null),[l,c]=M.useState([]),[u,d]=M.useState(!1),[f,h]=M.useState(!0),[m,x]=M.useState(!1),[p,g]=M.useState(!0),[v,y]=M.useState(!1),[b,w]=M.useState(null),[_,D]=M.useState(!1),[j,N]=M.useState("all"),[S,E]=M.useState("all"),[A,T]=M.useState(""),[L,O]=M.useState("created_at"),[V,W]=M.useState("desc"),[B,P]=M.useState(1),[F,I]=M.useState(10),R=[{value:"draft",label:"Draft",color:"bg-gray-100 text-gray-800"},{value:"scheduled",label:"Scheduled",color:"bg-blue-100 text-blue-800"},{value:"active",label:"Active",color:"bg-green-100 text-green-800"},{value:"paused",label:"Paused",color:"bg-yellow-100 text-yellow-800"},{value:"completed",label:"Completed",color:"bg-purple-100 text-purple-800"},{value:"cancelled",label:"Cancelled",color:"bg-red-100 text-red-800"}],C=[{value:"email",label:"Email",icon:"Mail"},{value:"web_form",label:"Web Form",icon:"Globe"},{value:"phone",label:"Phone",icon:"Phone"},{value:"social_media",label:"Social Media",icon:"Share2"},{value:"manual_entry",label:"Manual Entry",icon:"Edit"}],z=[...(Array.isArray(l)?l:[]).filter(J=>{const ue=j==="all"||J.status===j,me=S==="all"||J.type===S,te=!A||(J.name||"").toLowerCase().includes(A.toLowerCase())||(J.description||"").toLowerCase().includes(A.toLowerCase());return ue&&me&&te})].sort((J,ue)=>{let me,te;switch(L){case"name":me=(J.name||"").toLowerCase(),te=(ue.name||"").toLowerCase();break;case"start_date":me=new Date(J.start_date||0).getTime(),te=new Date(ue.start_date||0).getTime();break;case"budget":me=J.budget||0,te=ue.budget||0;break;case"created_at":me=new Date(J.created_at||0).getTime(),te=new Date(ue.created_at||0).getTime();break;default:return 0}return V==="asc"?me>te?1:me<te?-1:0:me<te?1:me>te?-1:0}),q=z.length,K=Math.ceil(q/F),se=(B-1)*F,ie=se+F,ee=z.slice(se,ie);M.useEffect(()=>{P(1)},[j,S,A]);const ae=J=>{P(J)},pe=J=>{I(J),P(1)},H=J=>{L===J?W(V==="asc"?"desc":"asc"):(O(J),W("asc")),P(1)};M.useEffect(()=>{if(!r)return;(async()=>{g(!0),w(null);try{const ue=await Mr.getCampaigns();c(Array.isArray(ue)?ue:[]),e&&e!=="new"?(h(!1),x(!0),d(!1),await ne(e)):e==="new"?(h(!1),x(!1),d(!0),s(null)):(h(!0),x(!1),d(!1))}catch(ue){console.error("Error loading initial data:",ue),w("Failed to load data. Please refresh the page."),c([])}finally{g(!1)}})()},[e,r]);const ne=async J=>{try{const ue=await Mr.getCampaignById(J);if(!ue){w("Campaign not found"),g(!1);return}s(ue)}catch(ue){console.error("Error loading campaign:",ue),w("Failed to load campaign. Please try again.")}finally{g(!1)}},U=()=>{s(null),d(!0),h(!1),t("/campaign-management/new")},le=async J=>{x(!0),d(!1),h(!1),t(`/campaign-management/${J.id}`);try{const ue=await Mr.getCampaignById(J.id);s(ue)}catch(ue){console.error("Error loading full campaign data:",ue),s(J)}},re=()=>{x(!1),d(!0)},X=()=>{d(!1),x(!1),h(!0),s(null),w(null),t("/campaign-management")},G=async J=>{if(!(r!=null&&r.id)){w("You must be logged in to save campaigns");return}y(!0),w(null);try{let ue;if(i!=null&&i.id)ue=await Mr.updateCampaign(i.id,{...J,owner_id:r.id}),ue&&(s(ue),c(me=>me.map(te=>te.id===ue.id?ue:te)),Ue.success(`Campaign "${ue.name}" updated successfully!`));else if(ue=await Mr.createCampaign({...J,owner_id:r.id}),ue!=null&&ue.id)Ue.success(`Campaign "${J.name}" created successfully!`),c(me=>[ue,...me]);else throw new Error("Campaign created but no ID returned");y(!1),X()}catch(ue){console.error("Error saving campaign:",ue);const me=(ue==null?void 0:ue.message)||"Failed to save campaign. Please try again.";w(me),Ue.error(me)}finally{y(!1)}},ce=async()=>{if(!(!(i!=null&&i.id)||!(r!=null&&r.id))){try{await Mr.deleteCampaign(i.id),Ue.success(`Campaign "${i.name}" deleted successfully!`),c(J=>J.filter(ue=>ue.id!==i.id)),t("/campaign-management")}catch(J){console.error("Error deleting campaign:",J);const ue="Failed to delete campaign. Please try again.";w(ue),Ue.error(ue)}D(!1)}};return p?o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(ii,{}),o.jsx("main",{className:"pt-16",children:o.jsx("div",{className:"px-6 py-8",children:o.jsx("div",{className:"max-w-7xl mx-auto",children:o.jsx("div",{className:"flex items-center justify-center h-96",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),o.jsx("span",{className:"text-text-secondary",children:"Loading campaigns..."})]})})})})})]}):b&&!i&&!f?o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(ii,{}),o.jsx("main",{className:"pt-16",children:o.jsx("div",{className:"px-6 py-8",children:o.jsxs("div",{className:"max-w-7xl mx-auto",children:[o.jsx(Hs,{}),o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Y,{name:"AlertCircle",size:48,className:"text-text-tertiary mx-auto mb-4"}),o.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:i===null&&e!=="new"?"Campaign Not Found":"Error"}),o.jsx("p",{className:"text-text-secondary mb-6",children:b}),o.jsx("button",{onClick:()=>t("/campaign-management"),className:"btn-primary",children:"Back to Campaigns"})]})]})})})]}):o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(ii,{}),o.jsx("main",{className:"pt-14 xs:pt-16 sm:pt-16",children:o.jsx("div",{className:"px-3 xs:px-4 sm:px-6 py-4 xs:py-6 sm:py-8",children:o.jsxs("div",{className:"max-w-7xl mx-auto",children:[o.jsx("div",{className:"hidden sm:block",children:o.jsx(Hs,{})}),b&&o.jsxs("div",{className:"bg-error-50 border border-error-200 text-error p-3 xs:p-4 rounded-lg flex items-start xs:items-center justify-between mb-4 xs:mb-6 gap-2",children:[o.jsxs("div",{className:"flex items-start xs:items-center space-x-2 flex-1 min-w-0",children:[o.jsx(Y,{name:"AlertCircle",size:20,className:"flex-shrink-0 mt-0.5 xs:mt-0"}),o.jsx("span",{className:"text-sm xs:text-base break-words",children:b})]}),o.jsx("button",{onClick:()=>w(null),className:"text-error hover:text-error-600 flex-shrink-0 min-h-touch min-w-touch flex items-center justify-center -m-1","aria-label":"Close error",children:o.jsx(Y,{name:"X",size:16})})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 xs:mb-6 sm:mb-8 gap-3 sm:gap-0",children:[o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("h1",{className:"text-xl xs:text-2xl sm:text-3xl font-bold text-text-primary mb-1 xs:mb-2 truncate",children:f?"Campaign Management":(i==null?void 0:i.name)||"New Campaign"}),o.jsx("div",{className:"flex flex-wrap items-center gap-x-2 xs:gap-x-4 gap-y-1 text-xs xs:text-sm text-text-secondary",children:f?o.jsx("span",{children:"Manage all your marketing campaigns"}):o.jsxs(o.Fragment,{children:[(i==null?void 0:i.id)&&o.jsxs(o.Fragment,{children:[o.jsxs("span",{className:"hidden xs:inline",children:["Campaign ID: #",i.id.slice(0,8)]}),o.jsx("span",{className:"xs:inline hidden xs:inline",children:""})]}),(i==null?void 0:i.created_at)&&o.jsxs(o.Fragment,{children:[o.jsxs("span",{className:"hidden sm:inline",children:["Created: ",new Date(i.created_at).toLocaleDateString()]}),o.jsx("span",{className:"hidden sm:inline",children:""})]}),(i==null?void 0:i.updated_at)&&o.jsxs("span",{className:"hidden sm:inline",children:["Last updated: ",new Date(i.updated_at).toLocaleDateString()]})]})})]}),o.jsx("div",{className:"flex items-center space-x-2 xs:space-x-3 flex-shrink-0 w-full sm:w-auto",children:f?o.jsx(o.Fragment,{children:n("campaigns.create")&&o.jsxs("button",{onClick:U,className:"btn-primary flex items-center space-x-1.5 xs:space-x-2 px-3 xs:px-4 py-2 min-h-touch text-sm xs:text-base flex-1 sm:flex-initial justify-center",children:[o.jsx(Y,{name:"Plus",size:16}),o.jsx("span",{className:"hidden xs:inline",children:"Create Campaign"}),o.jsx("span",{className:"xs:hidden",children:"Create"})]})}):o.jsxs("button",{onClick:X,className:"btn-secondary flex items-center space-x-1.5 xs:space-x-2 px-3 xs:px-4 py-2 min-h-touch text-sm xs:text-base",children:[o.jsx(Y,{name:"ArrowLeft",size:16}),o.jsx("span",{children:"Back to List"})]})})]}),f?o.jsx(qWe,{campaigns:ee,allCampaigns:l,statuses:R,types:C,selectedStatusFilter:j,selectedTypeFilter:S,searchQuery:A,sortField:L,sortDirection:V,currentPage:B,itemsPerPage:F,totalItems:q,totalPages:K,onStatusFilterChange:N,onTypeFilterChange:E,onSearchChange:T,onSort:H,onPageChange:ae,onItemsPerPageChange:pe,onViewCampaign:le,onEditCampaign:J=>{le(J),setTimeout(()=>re(),100)},onDeleteCampaign:J=>{s(J),D(!0)}}):o.jsx("div",{children:p?o.jsx("div",{className:"bg-surface rounded-lg border border-border p-8",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),o.jsx("p",{className:"text-text-secondary",children:"Loading campaign..."})]})}):m?o.jsx(nze,{campaign:i,statuses:R,types:C,onEdit:n("campaigns.edit_all")||n("campaigns.edit_own")&&(i==null?void 0:i.owner_id)===(r==null?void 0:r.id)?re:null,onDelete:n("campaigns.delete_all")||n("campaigns.delete_own")&&(i==null?void 0:i.owner_id)===(r==null?void 0:r.id)?()=>D(!0):null}):o.jsx(aze,{campaign:i,types:C,statuses:R,onSubmit:G,onCancel:X,isSaving:v})})]})})}),_&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-surface rounded-lg p-6 max-w-md w-full mx-4",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[o.jsx("div",{className:"w-10 h-10 bg-error-50 rounded-full flex items-center justify-center",children:o.jsx(Y,{name:"AlertTriangle",size:20,className:"text-error"})}),o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Delete Campaign"})]}),o.jsxs("p",{className:"text-text-secondary mb-6",children:['Are you sure you want to delete "',i==null?void 0:i.name,'"? This action cannot be undone.']}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsx("button",{onClick:()=>D(!1),className:"flex-1 px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-colors duration-150",children:"Cancel"}),o.jsx("button",{onClick:ce,className:"flex-1 px-4 py-2 bg-error text-white rounded-lg hover:bg-error-600 transition-colors duration-150",children:"Delete Campaign"})]})]})})]})};class ize{constructor(){this.exportInProgress=!1}generateCSV(t,r,n){const a=[r.join(","),...t.map(i=>r.map(s=>{const l=i[s.toLowerCase().replace(" ","_")]||i[s]||"";return typeof l=="string"&&(l.includes(",")||l.includes('"'))?`"${l.replace(/"/g,'""')}"`:l}).join(","))].join(`
`);this.downloadFile(a,n,"text/csv")}async exportAnalyticsCSV(t,r){try{this.exportInProgress=!0;const a=`pipeline_analytics_${Si(new Date,"yyyy-MM-dd_HH-mm-ss")}.csv`,i=[];i.push("PIPELINE ANALYTICS REPORT"),i.push(`Generated: ${Si(new Date,"PPpp")}`),i.push(`Date Range: ${r.dateRange||"All Time"}`),i.push(`Sales Rep: ${r.repName||"All Representatives"}`),i.push(""),t.velocityMetrics&&t.velocityMetrics.length>0&&(i.push("KEY METRICS"),i.push("Metric,Value,Change,Trend"),t.velocityMetrics.forEach(l=>{i.push(`${l.metric},${l.value},${l.change||"N/A"},${l.trend||"N/A"}`)}),i.push("")),t.revenueTrendData&&t.revenueTrendData.length>0&&(i.push("REVENUE TRENDS (Monthly)"),i.push("Month,Actual Revenue,Forecast,Target"),t.revenueTrendData.forEach(l=>{i.push(`${l.month},$${l.actual},$${l.forecast},$${l.target}`)}),i.push("")),t.pipelineFunnelData&&t.pipelineFunnelData.length>0&&(i.push("PIPELINE FUNNEL"),i.push("Stage,Value,Deal Count"),t.pipelineFunnelData.forEach(l=>{i.push(`${l.name},$${l.value},${l.count}`)}),i.push("")),t.winRateData&&t.winRateData.length>0&&(i.push("WIN RATE BY QUARTER"),i.push("Period,Win Rate %"),t.winRateData.forEach(l=>{i.push(`${l.period},${l.winRate}%`)}),i.push(""));const s=i.join(`
`);return this.downloadFile(s,a,"text/csv"),{success:!0,filename:a}}catch(n){throw console.error("CSV Export failed:",n),new Error("Failed to export CSV: "+n.message)}finally{this.exportInProgress=!1}}async exportAnalyticsJSON(t,r){try{this.exportInProgress=!0;const a=`pipeline_analytics_${Si(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`,i={metadata:{exportDate:new Date().toISOString(),dateRange:r.dateRange||"all",salesRep:r.repName||"all",appliedFilters:r},analytics:{keyMetrics:t.velocityMetrics||[],revenueTrends:t.revenueTrendData||[],pipelineFunnel:t.pipelineFunnelData||[],winRates:t.winRateData||[],forecastData:t.forecastData||[],performanceData:t.repPerformanceData||[]},summary:{totalRevenue:t.revenueTrendData?t.revenueTrendData.reduce((l,c)=>l+c.actual,0):0,totalDeals:t.pipelineFunnelData?t.pipelineFunnelData.reduce((l,c)=>l+c.count,0):0,avgWinRate:t.winRateData&&t.winRateData.length>0?t.winRateData.reduce((l,c)=>l+c.winRate,0)/t.winRateData.length:0}},s=JSON.stringify(i,null,2);return this.downloadFile(s,a,"application/json"),{success:!0,filename:a}}catch(n){throw console.error("JSON Export failed:",n),new Error("Failed to export JSON: "+n.message)}finally{this.exportInProgress=!1}}async exportAnalyticsPDF(t,r,n={}){try{this.exportInProgress=!0;const a=await Zu(()=>import("./html2canvas.esm-CBrSDip1.js"),__vite__mapDeps([])).then(h=>h.default),i=await Zu(()=>import("./jspdf.es.min-CY8FTPTr.js"),__vite__mapDeps([0,1,2,3])).then(h=>h.jsPDF),l=`pipeline_analytics_${Si(new Date,"yyyy-MM-dd_HH-mm-ss")}.pdf`,c=new i("p","mm","a4"),u=c.internal.pageSize.getWidth(),d=c.internal.pageSize.getHeight();let f=20;if(c.setFontSize(20),c.text("Pipeline Analytics Report",20,f),f+=15,c.setFontSize(12),c.text(`Generated: ${Si(new Date,"PPpp")}`,20,f),f+=7,c.text(`Date Range: ${r.dateRange||"All Time"}`,20,f),f+=7,c.text(`Sales Rep: ${r.repName||"All Representatives"}`,20,f),f+=15,t.velocityMetrics&&t.velocityMetrics.length>0){c.setFontSize(14),c.text("Key Performance Metrics",20,f),f+=10,c.setFontSize(10);const h=t.velocityMetrics.map(p=>[p.metric,p.value,p.change||"N/A",p.trend||"N/A"]),m=["Metric","Value","Change","Trend"];let x=f;m.forEach((p,g)=>{c.text(p,20+g*40,x)}),x+=7,h.forEach(p=>{p.forEach((g,v)=>{c.text(String(g),20+v*40,x)}),x+=6}),f=x+10}if(n.revenueChart&&n.revenueChart.current)try{const h=await a(n.revenueChart.current,{backgroundColor:"white",scale:2}),m=h.toDataURL("image/png"),x=u-40,p=h.height*x/h.width;f+p>d-20&&(c.addPage(),f=20),c.setFontSize(14),c.text("Revenue Trends",20,f),f+=10,c.addImage(m,"PNG",20,f,x,p),f+=p+15}catch(h){console.warn("Could not capture revenue chart:",h)}if(t.revenueTrendData&&t.revenueTrendData.length>0){f+50>d-20&&(c.addPage(),f=20),c.setFontSize(14),c.text("Revenue Summary",20,f),f+=10,c.setFontSize(10);const h=t.revenueTrendData.reduce((x,p)=>x+p.actual,0),m=h/t.revenueTrendData.length;c.text(`Total Revenue: $${h.toLocaleString()}`,20,f),f+=7,c.text(`Average Monthly: $${m.toLocaleString()}`,20,f),f+=7,c.text(`Reporting Period: ${t.revenueTrendData.length} months`,20,f)}return c.save(l),{success:!0,filename:l}}catch(a){throw console.error("PDF Export failed:",a),new Error("Failed to export PDF: "+a.message)}finally{this.exportInProgress=!1}}async exportAnalyticsExcel(t,r){try{this.exportInProgress=!0;const n=await Zu(()=>Promise.resolve().then(()=>rUe),void 0),i=`pipeline_analytics_${Si(new Date,"yyyy-MM-dd_HH-mm-ss")}.xlsx`,s=n.utils.book_new(),l=[["Pipeline Analytics Report"],["Generated",Si(new Date,"PPpp")],["Date Range",r.dateRange||"All Time"],["Sales Rep",r.repName||"All Representatives"],[""],["Summary Metrics"]];t.velocityMetrics&&t.velocityMetrics.length>0&&(l.push(["Metric","Value","Change","Trend"]),t.velocityMetrics.forEach(u=>{l.push([u.metric,u.value,u.change||"N/A",u.trend||"N/A"])}));const c=n.utils.aoa_to_sheet(l);if(n.utils.book_append_sheet(s,c,"Summary"),t.revenueTrendData&&t.revenueTrendData.length>0){const u=[["Month","Actual Revenue","Forecast","Target"],...t.revenueTrendData.map(f=>[f.month,f.actual,f.forecast,f.target])],d=n.utils.aoa_to_sheet(u);n.utils.book_append_sheet(s,d,"Revenue Trends")}if(t.pipelineFunnelData&&t.pipelineFunnelData.length>0){const u=[["Stage","Value","Deal Count","Conversion Rate"],...t.pipelineFunnelData.map((f,h,m)=>[f.name,f.value,f.count,h<m.length-1?`${(f.count/m[0].count*100).toFixed(1)}%`:"Final Stage"])],d=n.utils.aoa_to_sheet(u);n.utils.book_append_sheet(s,d,"Pipeline Funnel")}if(t.winRateData&&t.winRateData.length>0){const u=[["Period","Win Rate %"],...t.winRateData.map(f=>[f.period,f.winRate])],d=n.utils.aoa_to_sheet(u);n.utils.book_append_sheet(s,d,"Win Rates")}return Object.keys(s.Sheets).forEach(u=>{const d=s.Sheets[u],f=n.utils.decode_range(d["!ref"]),h=[];for(let m=f.s.c;m<=f.e.c;m++){let x=10;for(let p=f.s.r;p<=f.e.r;p++){const g=n.utils.encode_cell({r:p,c:m}),v=d[g];if(v&&v.v){const y=String(v.v).length;y>x&&(x=y)}}h.push({wch:Math.min(x+2,50)})}d["!cols"]=h}),n.writeFile(s,i),{success:!0,filename:i}}catch(n){throw console.error("Excel Export failed:",n),new Error("Failed to export Excel: "+n.message)}finally{this.exportInProgress=!1}}async scheduleEmailReport(t,r,n){try{this.exportInProgress=!0;const a={type:"scheduled_report",data:t,filters:r,emailSettings:n,scheduledFor:n.schedule||"weekly"},s=`email_report_config_${Si(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`,l=JSON.stringify({message:"Email reporting would be configured with these settings",...a},null,2);return this.downloadFile(l,s,"application/json"),{success:!0,message:"Email report configuration saved. Contact your administrator to set up email delivery.",filename:s}}catch(a){throw console.error("Email scheduling failed:",a),new Error("Failed to schedule email report: "+a.message)}finally{this.exportInProgress=!1}}downloadFile(t,r,n){const a=new Blob([t],{type:n}),i=URL.createObjectURL(a),s=document.createElement("a");s.href=i,s.download=r,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)}isExporting(){return this.exportInProgress}}const mh=new ize,sze=({analyticsData:e,filters:t,chartRefs:r={},isOpen:n,onClose:a,className:i=""})=>{const[s,l]=M.useState({type:null,loading:!1,success:!1,error:null}),[c,u]=M.useState({recipient:"",schedule:"weekly",format:"pdf"}),[d,f]=M.useState(!1),h=async p=>{l({type:p,loading:!0,success:!1,error:null});try{const g=t||{dateRange:"all",ownerId:"all"};let v;switch(p){case"csv":v=await mh.exportAnalyticsCSV(e,g);break;case"excel":v=await mh.exportAnalyticsExcel(e,g);break;case"pdf":v=await mh.exportAnalyticsPDF(e,g,r);break;case"json":v=await mh.exportAnalyticsJSON(e,g);break;default:throw new Error("Unknown export type")}l({type:p,loading:!1,success:!0,error:null}),setTimeout(()=>{l({type:null,loading:!1,success:!1,error:null})},3e3)}catch(g){l({type:p,loading:!1,success:!1,error:g.message}),setTimeout(()=>{l({type:null,loading:!1,success:!1,error:null})},5e3)}},m=async()=>{if(!c.recipient){l({type:"email",loading:!1,success:!1,error:"Please enter a recipient email address"});return}l({type:"email",loading:!0,success:!1,error:null});try{const p=await mh.scheduleEmailReport(e,t,c);l({type:"email",loading:!1,success:!0,error:null}),f(!1),u({recipient:"",schedule:"weekly",format:"pdf"}),setTimeout(()=>{l({type:null,loading:!1,success:!1,error:null})},3e3)}catch(p){l({type:"email",loading:!1,success:!1,error:p.message})}},x=[{id:"excel",label:"Export as Excel",icon:"FileSpreadsheet",description:"Comprehensive data in multiple sheets",color:"text-green-600",bgColor:"bg-green-50",hoverColor:"hover:bg-green-100"},{id:"pdf",label:"Export as PDF",icon:"FileText",description:"Professional report with charts",color:"text-red-600",bgColor:"bg-red-50",hoverColor:"hover:bg-red-100"},{id:"csv",label:"Export as CSV",icon:"Download",description:"Raw data for analysis",color:"text-blue-600",bgColor:"bg-blue-50",hoverColor:"hover:bg-blue-100"},{id:"json",label:"Export as JSON",icon:"Code",description:"Structured data for developers",color:"text-purple-600",bgColor:"bg-purple-50",hoverColor:"hover:bg-purple-100"}];return n?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 z-40",onClick:a}),o.jsxs("div",{className:`absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-xl border border-gray-200 z-50 ${i}`,children:[o.jsxs("div",{className:"p-4 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Export Analytics"}),o.jsx("button",{onClick:a,className:"text-text-secondary hover:text-text-primary transition-colors",children:o.jsx(Y,{name:"X",size:20})})]}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Choose your preferred export format"})]}),o.jsx("div",{className:"p-4 space-y-2",children:x.map(p=>o.jsxs("button",{onClick:()=>h(p.id),disabled:s.loading&&s.type===p.id,className:`w-full flex items-center p-3 rounded-lg border-2 border-transparent transition-all duration-200 ${s.loading&&s.type===p.id?"opacity-50 cursor-not-allowed bg-gray-50":`${p.bgColor} ${p.hoverColor} hover:border-gray-200`}`,children:[o.jsx("div",{className:`p-2 rounded-lg ${p.bgColor} mr-3`,children:s.loading&&s.type===p.id?o.jsx(Y,{name:"Loader2",size:20,className:"animate-spin text-gray-600"}):o.jsx(Y,{name:p.icon,size:20,className:p.color})}),o.jsxs("div",{className:"flex-1 text-left",children:[o.jsx("div",{className:"font-medium text-gray-900",children:p.label}),o.jsx("div",{className:"text-sm text-gray-600",children:p.description})]}),s.success&&s.type===p.id&&o.jsx(Y,{name:"Check",size:16,className:"text-green-600"})]},p.id))}),s.error&&o.jsx("div",{className:"p-4 border-t border-gray-200",children:o.jsxs("div",{className:"flex items-center text-red-600",children:[o.jsx(Y,{name:"AlertCircle",size:16,className:"mr-2"}),o.jsx("span",{className:"text-sm",children:s.error})]})}),s.success&&o.jsx("div",{className:"p-4 border-t border-gray-200",children:o.jsxs("div",{className:"flex items-center text-green-600",children:[o.jsx(Y,{name:"CheckCircle",size:16,className:"mr-2"}),o.jsx("span",{className:"text-sm",children:"Export completed successfully!"})]})}),o.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50 rounded-b-lg",children:o.jsxs("div",{className:"text-xs text-gray-500",children:[o.jsxs("p",{className:"flex items-center",children:[o.jsx(Y,{name:"Info",size:12,className:"mr-1"}),"Reports include current filter settings"]}),o.jsxs("p",{className:"mt-1",children:["Data range: ",t.dateRange||"All Time","  Rep: ",t.repName||"All Representatives"]})]})})]}),d&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50",onClick:()=>f(!1)}),o.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-60 p-4",children:o.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Schedule Email Report"}),o.jsx("button",{onClick:()=>f(!1),className:"text-text-secondary hover:text-text-primary",children:o.jsx(Y,{name:"X",size:20})})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Recipient Email"}),o.jsx("input",{type:"email",value:c.recipient,onChange:p=>u(g=>({...g,recipient:p.target.value})),placeholder:"Enter email address",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Schedule"}),o.jsxs("select",{value:c.schedule,onChange:p=>u(g=>({...g,schedule:p.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"daily",children:"Daily"}),o.jsx("option",{value:"weekly",children:"Weekly"}),o.jsx("option",{value:"monthly",children:"Monthly"}),o.jsx("option",{value:"quarterly",children:"Quarterly"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Format"}),o.jsxs("select",{value:c.format,onChange:p=>u(g=>({...g,format:p.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"pdf",children:"PDF Report"}),o.jsx("option",{value:"excel",children:"Excel Spreadsheet"}),o.jsx("option",{value:"both",children:"Both PDF & Excel"})]})]})]}),o.jsxs("div",{className:"flex space-x-3 mt-6",children:[o.jsx("button",{onClick:()=>f(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),o.jsx("button",{onClick:m,disabled:s.loading&&s.type==="email",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:s.loading&&s.type==="email"?o.jsxs("span",{className:"flex items-center justify-center",children:[o.jsx(Y,{name:"Loader2",size:16,className:"animate-spin mr-2"}),"Setting up..."]}):"Schedule Report"})]})]})})})]})]}):null},oze=()=>{var ce;const[e,t]=M.useState("all"),[r,n]=M.useState(!1),[a,i]=M.useState("previous30days"),[s,l]=M.useState("all"),[c,u]=M.useState("overview"),[d,f]=M.useState(!1),[h,m]=M.useState(null),[x,p]=M.useState(!1),[g,v]=M.useState(null),[y,b]=M.useState(new Date),[w,_]=M.useState([]),[D,j]=M.useState([]),[N,S]=M.useState([]),[E,A]=M.useState([]),[T,L]=M.useState([]),[O,V]=M.useState([]),[W,B]=M.useState([]),[P,F]=M.useState(!0),[I,R]=M.useState(null),[C,k]=M.useState(!1),[z,q]=M.useState({reps:[],dateRanges:[]}),K=M.useRef(null),se=M.useRef(null),ie=M.useRef(null),ee=M.useMemo(()=>[{value:"all",label:"All Time"},{value:"thisquarter",label:"This Quarter"},{value:"lastquarter",label:"Last Quarter"},{value:"thisyear",label:"This Year"},{value:"lastyear",label:"Last Year"}],[]),ae=M.useMemo(()=>[{value:"all",label:"All Representatives"},...z.reps||[]],[z.reps]),pe=M.useMemo(()=>({velocityMetrics:T,revenueTrendData:D,pipelineFunnelData:w,winRateData:E,forecastData:W,repPerformanceData:O}),[T,D,w,E,W,O]),H=M.useMemo(()=>{const J=ae.find(me=>me.value===s),ue=ee.find(me=>me.value===e);return{dateRange:e,dateRangeLabel:(ue==null?void 0:ue.label)||e,repId:s,repName:(J==null?void 0:J.label)||s,appliedAt:new Date().toISOString(),compareMode:r,compareDateRange:r?a:null}},[e,s,ae,ee,r,a]),ne={revenue:K,pipeline:se,performance:ie};M.useEffect(()=>{(async()=>{try{await Gr.loadConfiguration();const ue=await gt.getFilterOptions();q(ue),k(!0)}catch{k(!0)}})()},[]),M.useEffect(()=>{if(!C)return;(async()=>{var ue;try{F(!0),b(new Date);const me={dateRange:e!=="all"?e:void 0,ownerId:s!=="all"?s:void 0},[te,oe,ge,ye]=await Promise.all([gt.getPipelineDeals(me),gt.getRevenueData(me),gt.getPerformanceMetrics(me),gt.getWinRateData(me)]),Ce=te&&typeof te=="object"?Object.values(te).map(at=>({name:(at==null?void 0:at.title)||"Unknown Stage",value:((at==null?void 0:at.deals)||[]).reduce((bt,Mt)=>{const St=typeof(Mt==null?void 0:Mt.value)=="string"?parseFloat(Mt.value):(Mt==null?void 0:Mt.value)||0;return bt+(isNaN(St)?0:St)},0),count:((at==null?void 0:at.deals)||[]).length,deals:(at==null?void 0:at.deals)||[],fill:(at==null?void 0:at.id)==="lead"?"#3B82F6":(at==null?void 0:at.id)==="qualified"?"#6366F1":(at==null?void 0:at.id)==="proposal"?"#8B5CF6":(at==null?void 0:at.id)==="negotiation"?"#A855F7":(at==null?void 0:at.id)==="closed_won"?"#10B981":"#EF4444"})):[];_(Ce),j(Array.isArray(oe)?oe:[]),A(Array.isArray(ye)?ye:[]);const Ie=Array.isArray(oe)?oe.map((at,bt)=>({...at,aiPrediction:((at==null?void 0:at.forecast)||0)*(1+(Math.random()-.5)*.1),confidence:Math.random()*20+75})):[];if(B(Ie),r&&Array.isArray(oe)){const at=oe.map(bt=>({...bt,actual:((bt==null?void 0:bt.actual)||0)*(.8+Math.random()*.4),forecast:((bt==null?void 0:bt.forecast)||0)*(.85+Math.random()*.3)}));S(at)}const rt=Object.values(te).flatMap(at=>(at==null?void 0:at.deals)||[]),Pe=rt.reduce((at,bt)=>{const Mt=typeof(bt==null?void 0:bt.value)=="string"?parseFloat(bt.value):(bt==null?void 0:bt.value)||0;return at+(isNaN(Mt)?0:Mt)},0),Ke=rt.length>0?Pe/rt.length:(ge==null?void 0:ge.avgDealSize)||0,nt=(()=>{if(!ye||ye.length===0)return 0;const at=ye.reduce((Mt,St)=>Mt+(St.won||0),0),bt=ye.reduce((Mt,St)=>Mt+(St.total||0),0);return bt>0?at/bt*100:0})(),za=(at=>{const bt=Object.values(at).flatMap(St=>(St==null?void 0:St.deals)||[]).filter(St=>(St==null?void 0:St.stage)==="closed_won"&&(St==null?void 0:St.close_date)&&(St==null?void 0:St.created_at));if(bt.length===0)return 0;const Mt=bt.reduce((St,Ha)=>{const kn=new Date(Ha.created_at),Cn=new Date(Ha.close_date),Ql=Math.round((Cn-kn)/(1e3*60*60*24));return St+Math.max(Ql,0)},0);return Math.round(Mt/bt.length)})(te),Bn=za>0?((ge==null?void 0:ge.achieved)||0)/za:0;if(L([{metric:"Avg Deal Size",value:Ke,change:null,trend:"neutral"},{metric:"Win Rate",value:`${nt.toFixed(1)}%`,change:null,trend:nt>=50?"up":"down"}]),s==="all"){const at=z.reps||[];if(at.length>0){const bt=at.map(async St=>{try{const Ha={dateRange:me.dateRange,ownerId:St.value},kn=await gt.getPerformanceMetrics(Ha),Cn=await gt.getPipelineDeals(Ha),Ql=Object.values(Cn).reduce((Wf,ec)=>{var tc;return Wf+(((tc=ec==null?void 0:ec.deals)==null?void 0:tc.length)||0)},0);return{name:St.label,revenue:kn.achieved||0,deals:Ql,quota:kn.quota||0,attainment:kn.percentage||0,avgDealSize:kn.avgDealSize||0,conversionRate:kn.conversionRate||0}}catch{return{name:St.label,revenue:0,deals:0,quota:0,attainment:0,avgDealSize:0,conversionRate:0}}}),Mt=await Promise.all(bt);V(Mt)}else{const bt=Ce.reduce((Mt,St)=>Mt+St.count,0);V([{name:"Current User",revenue:ge.achieved||0,deals:bt,quota:ge.quota||0,attainment:ge.percentage||0,avgDealSize:ge.avgDealSize||0,conversionRate:ge.conversionRate||0}])}}else{const at=(ue=z.reps)==null?void 0:ue.find(Mt=>Mt.value===s),bt=Ce.reduce((Mt,St)=>Mt+St.count,0);V([{name:(at==null?void 0:at.label)||"Selected Rep",revenue:ge.achieved||0,deals:bt,quota:ge.quota||0,attainment:ge.percentage||0,avgDealSize:ge.avgDealSize||0,conversionRate:ge.conversionRate||0}])}}catch{R("Failed to load analytics data. Please try again.")}finally{F(!1)}})()},[e,r,a,s,C]),M.useEffect(()=>{if(g){const J=setInterval(()=>{},g*60*1e3);return()=>clearInterval(J)}},[g]);const U=(J,ue)=>{m({data:J,chartType:ue,timestamp:new Date}),p(!0)};if(P)return o.jsxs("div",{className:"min-h-screen bg-background flex justify-center items-center",children:[o.jsx(wq,{className:"h-10 w-10 animate-spin text-primary"}),o.jsx("p",{className:"ml-4 text-text-secondary",children:"Loading analytics data..."})]});if(I)return o.jsx("div",{className:"min-h-screen bg-background flex justify-center items-center",children:o.jsx("p",{className:"text-error text-lg",children:I})});const le=[{id:"overview",label:"Overview",icon:"BarChart3"},{id:"pipeline",label:"Pipeline",icon:"TrendingUp"},{id:"performance",label:"Performance",icon:"Target"}],re=J=>{try{return Gr.formatCurrency(J)}catch{return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(J)}},X=J=>J.metric==="Avg Deal Size"?re(J.value):J.metric==="Pipeline Velocity"?`${re(J.value)}/day`:J.value,G=({active:J,payload:ue,label:me})=>J&&ue&&(ue!=null&&ue.length)?o.jsxs("div",{className:"bg-surface border border-border rounded-lg shadow-lg p-3",children:[o.jsx("p",{className:"text-sm font-normal text-text-primary mb-2",children:me}),ue==null?void 0:ue.map((te,oe)=>o.jsxs("p",{className:"text-sm",style:{color:te==null?void 0:te.color},children:[te==null?void 0:te.name,": ",typeof(te==null?void 0:te.value)=="number"&&(te==null?void 0:te.value)>1e3?re(te==null?void 0:te.value):te==null?void 0:te.value]},oe))]}):null;return o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(ii,{}),o.jsx("main",{className:"pt-16",children:o.jsx("div",{className:"px-6 py-8",children:o.jsxs("div",{className:"max-w-7xl mx-auto",children:[o.jsx(Hs,{}),o.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-8",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold text-text-primary mb-2",children:"Pipeline Analytics"}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("p",{className:"text-text-secondary",children:"Comprehensive sales performance insights and forecasting"}),o.jsxs("div",{className:"flex items-center space-x-2 text-xs text-text-tertiary",children:[o.jsx(Y,{name:"RefreshCw",size:12,className:g?"animate-spin":""}),o.jsxs("span",{children:["Last updated: ",y.toLocaleTimeString()]})]})]})]}),o.jsx("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-3 sm:space-y-0 sm:space-x-3 mt-4 lg:mt-0",children:o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:()=>f(!d),className:"btn-primary flex items-center space-x-2 relative",children:[o.jsx(Y,{name:"Download",size:16}),o.jsx("span",{children:"Export"}),o.jsx(Y,{name:"ChevronDown",size:14,className:`transition-transform duration-200 ${d?"rotate-180":""}`})]}),o.jsx(sze,{analyticsData:pe,filters:H,chartRefs:ne,isOpen:d,onClose:()=>f(!1)})]})})]}),o.jsx("div",{className:"card p-6 mb-8",children:o.jsxs("div",{className:`grid gap-4 ${r?"grid-cols-1 md:grid-cols-2 lg:grid-cols-4":"grid-cols-1 md:grid-cols-2 lg:grid-cols-3"}`,children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-normal text-text-primary mb-2",children:"Date Range"}),o.jsx("select",{value:e,onChange:J=>{var ue;return t((ue=J==null?void 0:J.target)==null?void 0:ue.value)},className:"input-field",children:ee==null?void 0:ee.map(J=>o.jsx("option",{value:J==null?void 0:J.value,children:J==null?void 0:J.label},J==null?void 0:J.value))})]}),r&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-normal text-text-primary mb-2",children:"Compare With"}),o.jsxs("select",{value:a,onChange:J=>{var ue;return i((ue=J==null?void 0:J.target)==null?void 0:ue.value)},className:"input-field",children:[o.jsx("option",{value:"previous30days",children:"Previous 30 Days"}),o.jsx("option",{value:"previous90days",children:"Previous 90 Days"}),o.jsx("option",{value:"previousquarter",children:"Previous Quarter"}),o.jsx("option",{value:"previousyear",children:"Previous Year"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-normal text-text-primary mb-2",children:"Sales Rep"}),o.jsx("select",{value:s,onChange:J=>{var ue;return l((ue=J==null?void 0:J.target)==null?void 0:ue.value)},className:"input-field",children:ae==null?void 0:ae.map(J=>o.jsx("option",{value:J==null?void 0:J.value,children:J==null?void 0:J.label},J==null?void 0:J.value))})]}),o.jsx("div",{className:"flex items-end",children:o.jsx("div",{className:"w-full text-center text-sm text-text-secondary",children:"Filters applied automatically"})})]})}),o.jsx("div",{className:"border-b border-border mb-8",children:o.jsx("nav",{className:"flex space-x-8",children:le==null?void 0:le.map(J=>o.jsxs("button",{onClick:()=>u(J==null?void 0:J.id),className:`flex items-center space-x-2 py-4 px-1 border-b-2 font-normal text-sm transition-colors duration-150 ${c===(J==null?void 0:J.id)?"border-primary text-primary":"border-transparent text-text-secondary hover:text-text-primary hover:border-border-dark"}`,children:[o.jsx(Y,{name:J==null?void 0:J.icon,size:16}),o.jsx("span",{children:J==null?void 0:J.label})]},J==null?void 0:J.id))})}),c==="overview"&&o.jsxs("div",{className:"space-y-8",children:[o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:T==null?void 0:T.map(J=>o.jsxs("div",{className:"card p-6 hover:shadow-lg transition-shadow duration-200",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"text-sm font-normal text-text-secondary",children:J==null?void 0:J.metric}),(J==null?void 0:J.change)&&o.jsxs("div",{className:`flex items-center space-x-1 ${(J==null?void 0:J.trend)==="up"?"text-success":(J==null?void 0:J.trend)==="down"?"text-error":"text-text-tertiary"}`,children:[o.jsx(Y,{name:(J==null?void 0:J.trend)==="up"?"TrendingUp":(J==null?void 0:J.trend)==="down"?"TrendingDown":"Minus",size:14}),o.jsx("span",{className:"text-xs font-normal",children:J==null?void 0:J.change})]})]}),o.jsx("div",{className:"space-y-2",children:o.jsx("p",{className:"text-2xl font-bold text-text-primary",children:X(J)})})]},J==null?void 0:J.metric))}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[o.jsxs("div",{className:"card p-6",children:[o.jsx("div",{className:"flex items-center justify-between mb-6",children:o.jsx("h3",{className:"text-lg font-normal text-text-primary",children:"Pipeline Funnel by stage"})}),o.jsx("div",{className:"h-80",ref:se,children:o.jsx(pa,{width:"100%",height:"100%",children:o.jsxs(Zke,{children:[o.jsx(Rr,{content:o.jsx(G,{})}),o.jsx(Wl,{dataKey:"value",data:w,isAnimationActive:!0,onClick:J=>U(J,"funnel-stage"),className:"cursor-pointer",children:o.jsx(ls,{position:"center",fill:"#fff",stroke:"none"})})]})})}),o.jsx("div",{className:"mt-4 text-xs text-text-tertiary",children:"Click on any stage to view detailed deal breakdown"})]}),o.jsxs("div",{className:"card p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsx("h3",{className:"text-lg font-normal text-text-primary",children:"Revenue Trend"}),o.jsxs("div",{className:"flex items-center space-x-3",children:[r&&o.jsxs("div",{className:"flex items-center space-x-2 text-xs text-text-tertiary",children:[o.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),o.jsx("span",{children:"Current"}),o.jsx("div",{className:"w-3 h-3 bg-gray-400 rounded-full"}),o.jsx("span",{children:"Previous"})]}),o.jsxs("button",{onClick:()=>U(D,"revenue-trend"),className:"text-sm text-primary hover:text-primary-700 flex items-center space-x-1",children:[o.jsx(Y,{name:"Maximize2",size:14}),o.jsx("span",{children:"Expand"})]})]})]}),o.jsx("div",{className:"h-80",ref:K,children:o.jsx(pa,{width:"100%",height:"100%",children:o.jsxs(tv,{data:D,children:[o.jsx(rs,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),o.jsx(Ea,{dataKey:"month",stroke:"#6B7280"}),o.jsx(Ta,{stroke:"#6B7280",tickFormatter:J=>`$${J/1e3}k`}),o.jsx(Rr,{content:o.jsx(G,{})}),o.jsx(Gn,{type:"monotone",dataKey:"actual",stroke:"#3B82F6",strokeWidth:3,name:"Actual"}),o.jsx(Gn,{type:"monotone",dataKey:"forecast",stroke:"#6366F1",strokeWidth:2,strokeDasharray:"5 5",name:"Forecast"}),o.jsx(Gn,{type:"monotone",dataKey:"target",stroke:"#10B981",strokeWidth:2,name:"Target"}),r&&N.length>0&&o.jsx(Gn,{type:"monotone",dataKey:"actual",data:N,stroke:"#9CA3AF",strokeWidth:2,name:"Previous Period",strokeDasharray:"3 3"})]})})})]})]}),o.jsxs("div",{className:"card p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsx("h3",{className:"text-lg font-normal text-text-primary",children:"Win Rate Analysis"}),o.jsx("div",{className:"text-sm text-text-secondary",children:"Quarterly Performance"})]}),o.jsx("div",{className:"h-80",children:o.jsx(pa,{width:"100%",height:"100%",children:o.jsxs(td,{data:E,children:[o.jsx(rs,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),o.jsx(Ea,{dataKey:"period",stroke:"#6B7280",tick:{fontSize:12}}),o.jsx(Ta,{stroke:"#6B7280",tickFormatter:J=>`${J}%`,domain:[0,100],ticks:[0,25,50,75,100],tick:{fontSize:12}}),o.jsx(Rr,{content:({active:J,payload:ue})=>{var me;if(J&&ue&&ue[0]){const te=ue[0].payload,oe=te.total&&te.total>0;return o.jsxs("div",{className:"bg-white p-3 border border-border rounded-lg shadow-lg",children:[o.jsx("p",{className:"font-semibold text-text-primary mb-1",children:te.period}),oe?o.jsxs(o.Fragment,{children:[o.jsxs("p",{className:"text-xl font-bold text-primary",children:[(me=te.winRate)==null?void 0:me.toFixed(1),"%"]}),o.jsxs("p",{className:"text-sm text-text-secondary mt-1",children:[te.won," won, ",te.lost," lost"]}),o.jsxs("p",{className:"text-xs text-text-tertiary",children:[te.total," total deals"]})]}):o.jsx("p",{className:"text-sm text-text-tertiary",children:"No closed deals"})]})}return null}}),o.jsx(ai,{dataKey:"winRate",name:"Win Rate %",radius:[8,8,0,0],children:E==null?void 0:E.map((J,ue)=>{const me=J.total&&J.total>0;let te="#e5e7eb";return me&&(J.winRate>=70?te="#10b981":J.winRate>=50?te="#3b82f6":J.winRate>=30?te="#f59e0b":te="#ef4444"),o.jsx(Ao,{fill:te},`cell-${ue}`)})})]})})}),o.jsxs("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-gray-800 rounded-lg border border-blue-200 dark:border-gray-700",children:[o.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-text-secondary mb-1",children:"Overall Win Rate"}),o.jsx("p",{className:"text-2xl font-bold text-primary",children:(()=>{const J=(E==null?void 0:E.reduce((me,te)=>me+(te.won||0),0))||0,ue=(E==null?void 0:E.reduce((me,te)=>me+(te.total||0),0))||0;return ue>0?`${(J/ue*100).toFixed(1)}%`:"0%"})()}),o.jsxs("p",{className:"text-xs text-text-tertiary mt-1",children:[E==null?void 0:E.reduce((J,ue)=>J+(ue.won||0),0)," won / ",E==null?void 0:E.reduce((J,ue)=>J+(ue.total||0),0)," closed"]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-text-secondary mb-1",children:"Best Quarter"}),o.jsx("p",{className:"text-2xl font-bold text-success",children:(()=>{const J=(E==null?void 0:E.filter(me=>me.total>0))||[];return J.length===0?"N/A":J.reduce((me,te)=>te.winRate>me.winRate?te:me).period})()}),o.jsx("p",{className:"text-xs text-text-tertiary mt-1",children:(()=>{var me;const J=(E==null?void 0:E.filter(te=>te.total>0))||[];return J.length===0?"No data":`${(me=J.reduce((te,oe)=>oe.winRate>te.winRate?oe:te).winRate)==null?void 0:me.toFixed(1)}% win rate`})()})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-text-secondary mb-1",children:"Active Quarters"}),o.jsxs("p",{className:"text-2xl font-bold text-text-primary",children:[(E==null?void 0:E.filter(J=>J.total>0).length)||0,"/4"]}),o.jsx("p",{className:"text-xs text-text-tertiary mt-1",children:"with closed deals"})]})]}),o.jsx("div",{className:"mt-3 pt-3 border-t border-blue-300 dark:border-gray-600",children:o.jsxs("div",{className:"flex items-center space-x-4 text-xs",children:[o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("div",{className:"w-3 h-3 bg-green-500 rounded"}),o.jsx("span",{className:"text-text-tertiary",children:"70% Great"})]}),o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded"}),o.jsx("span",{className:"text-text-tertiary",children:"50-70% Good"})]}),o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded"}),o.jsx("span",{className:"text-text-tertiary",children:"30-50% Fair"})]}),o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("div",{className:"w-3 h-3 bg-red-500 rounded"}),o.jsx("span",{className:"text-text-tertiary",children:"<30% Poor"})]}),o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("div",{className:"w-3 h-3 bg-gray-300 rounded"}),o.jsx("span",{className:"text-text-tertiary",children:"No data"})]})]})})]})]})]}),c==="pipeline"&&o.jsx("div",{className:"space-y-8",children:o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[o.jsxs("div",{className:"lg:col-span-2 card p-6",children:[o.jsx("h3",{className:"text-lg font-normal text-text-primary mb-6",children:"Pipeline Value by Stage"}),o.jsx("div",{className:"h-80",ref:ie,children:o.jsx(pa,{width:"100%",height:"100%",children:o.jsxs(td,{data:w,children:[o.jsx(rs,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),o.jsx(Ea,{dataKey:"name",stroke:"#6B7280"}),o.jsx(Ta,{stroke:"#6B7280"}),o.jsx(Rr,{content:o.jsx(G,{})}),o.jsx(ai,{dataKey:"value",fill:"#3B82F6"})]})})})]}),o.jsxs("div",{className:"card p-6",children:[o.jsx("h3",{className:"text-lg font-normal text-text-primary mb-6",children:"Pipeline Health"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Total Pipeline"}),o.jsx("span",{className:"text-lg font-normal text-text-primary",children:re((w||[]).reduce((J,ue)=>J+((ue==null?void 0:ue.value)||0),0))})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Weighted Pipeline"}),o.jsx("span",{className:"text-lg font-normal text-text-primary",children:re((w||[]).reduce((J,ue)=>{const me=((ue==null?void 0:ue.deals)||[]).reduce((te,oe)=>te+((oe==null?void 0:oe.value)||0)*(((oe==null?void 0:oe.probability)||0)/100),0);return J+me},0))})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Best Case"}),o.jsx("span",{className:"text-lg font-normal text-success",children:re((w||[]).reduce((J,ue)=>{const me=((ue==null?void 0:ue.deals)||[]).reduce((te,oe)=>te+(((oe==null?void 0:oe.probability)||0)>=70&&(oe==null?void 0:oe.value)||0),0);return J+me},0))})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Worst Case"}),o.jsx("span",{className:"text-lg font-normal text-error",children:re((w||[]).reduce((J,ue)=>{const me=((ue==null?void 0:ue.deals)||[]).reduce((te,oe)=>te+(((oe==null?void 0:oe.probability)||0)<=30&&(oe==null?void 0:oe.value)||0),0);return J+me},0))})]}),o.jsx("div",{className:"pt-4 border-t border-border",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Coverage Ratio"}),o.jsxs("span",{className:"text-lg font-normal text-primary",children:[(()=>{const J=(w||[]).reduce((te,oe)=>te+((oe==null?void 0:oe.value)||0),0),ue=(D||[]).reduce((te,oe)=>te+((oe==null?void 0:oe.target)||0),0),me=ue>0?ue:25e5;return(J/me).toFixed(1)})(),"x"]})]})})]})]})]})}),c==="performance"&&o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{className:"card p-6",children:[o.jsx("h3",{className:"text-lg font-normal text-text-primary mb-6",children:"Sales Representative Performance"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-border",children:[o.jsx("th",{className:"text-left py-3 px-4 text-sm font-normal text-text-secondary",children:"Representative"}),o.jsx("th",{className:"text-right py-3 px-4 text-sm font-normal text-text-secondary",children:"Revenue"}),o.jsx("th",{className:"text-right py-3 px-4 text-sm font-normal text-text-secondary",children:"Deals"}),o.jsx("th",{className:"text-right py-3 px-4 text-sm font-normal text-text-secondary",children:"Quota"}),o.jsx("th",{className:"text-right py-3 px-4 text-sm font-normal text-text-secondary",children:"Attainment"}),o.jsx("th",{className:"text-right py-3 px-4 text-sm font-normal text-text-secondary",children:"Progress"})]})}),o.jsx("tbody",{children:O==null?void 0:O.map(J=>o.jsxs("tr",{className:"border-b border-border-light hover:bg-surface-hover",children:[o.jsx("td",{className:"py-3 px-4 text-sm font-normal text-text-primary",children:J==null?void 0:J.name}),o.jsx("td",{className:"py-3 px-4 text-sm text-text-primary text-right",children:re(J==null?void 0:J.revenue)}),o.jsx("td",{className:"py-3 px-4 text-sm text-text-primary text-right",children:J==null?void 0:J.deals}),o.jsx("td",{className:"py-3 px-4 text-sm text-text-primary text-right",children:re(J==null?void 0:J.quota)}),o.jsxs("td",{className:"py-3 px-4 text-sm text-text-primary text-right",children:[J==null?void 0:J.attainment,"%"]}),o.jsx("td",{className:"py-3 px-4 text-right",children:o.jsx("div",{className:"w-20 bg-border-light rounded-full h-2",children:o.jsx("div",{className:`h-2 rounded-full ${(J==null?void 0:J.attainment)>=100?"bg-success":(J==null?void 0:J.attainment)>=80?"bg-warning":"bg-primary"}`,style:{width:`${Math.min(J==null?void 0:J.attainment,100)}%`}})})})]},J==null?void 0:J.name))})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[o.jsxs("div",{className:"card p-6",children:[o.jsx("h3",{className:"text-lg font-normal text-text-primary mb-6",children:"Quota Attainment"}),o.jsx("div",{className:"h-80",children:o.jsx(pa,{width:"100%",height:"100%",children:o.jsxs(td,{data:O,children:[o.jsx(rs,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),o.jsx(Ea,{dataKey:"name",stroke:"#6B7280",angle:-45,textAnchor:"end",height:80}),o.jsx(Ta,{stroke:"#6B7280",tickFormatter:J=>`${J}%`}),o.jsx(Rr,{content:o.jsx(G,{})}),o.jsx(ai,{dataKey:"attainment",fill:"#3B82F6",name:"Attainment %"})]})})})]}),o.jsxs("div",{className:"card p-6",children:[o.jsx("h3",{className:"text-lg font-normal text-text-primary mb-6",children:"Revenue by Rep"}),o.jsx("div",{className:"h-80",children:o.jsx(pa,{width:"100%",height:"100%",children:o.jsxs(rv,{children:[o.jsx(Bi,{data:O,cx:"50%",cy:"50%",outerRadius:100,fill:"#3B82F6",dataKey:"revenue",label:({cx:J,cy:ue,midAngle:me,innerRadius:te,outerRadius:oe,percent:ge,name:ye})=>{if(ge<.05)return null;const Ce=Math.PI/180,Ie=oe+25,rt=J+Ie*Math.cos(-me*Ce),Pe=ue+Ie*Math.sin(-me*Ce);return o.jsx("text",{x:rt,y:Pe,fill:"#64748b",textAnchor:rt>J?"start":"end",dominantBaseline:"central",fontSize:"12",children:`${ye}: ${(ge*100).toFixed(0)}%`})},labelLine:{stroke:"#cbd5e1",strokeWidth:1},children:O==null?void 0:O.map((J,ue)=>o.jsx(Ao,{fill:`hsl(${220+ue*30}, 70%, ${50+ue*10}%)`},`cell-${ue}`))}),o.jsx(Rr,{content:o.jsx(G,{})})]})})})]})]})]}),c==="forecasting"&&o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"card p-6 text-center",children:[o.jsx("h3",{className:"text-sm font-normal text-text-secondary mb-2",children:"Total Forecast"}),o.jsx("p",{className:"text-3xl font-normal text-primary mb-1",children:re((D||[]).reduce((J,ue)=>J+((ue==null?void 0:ue.forecast)||0),0))}),o.jsxs("p",{className:"text-sm text-success flex items-center justify-center space-x-1",children:[o.jsx(Y,{name:"TrendingUp",size:14}),o.jsx("span",{children:"Based on expected close dates"})]})]}),o.jsxs("div",{className:"card p-6 text-center",children:[o.jsx("h3",{className:"text-sm font-normal text-text-secondary mb-2",children:"Total Actual Revenue"}),o.jsx("p",{className:"text-3xl font-normal text-secondary mb-1",children:re((D||[]).reduce((J,ue)=>J+((ue==null?void 0:ue.actual)||0),0))}),o.jsx("p",{className:"text-sm text-text-secondary",children:"From closed won deals"})]}),o.jsxs("div",{className:"card p-6 text-center",children:[o.jsx("h3",{className:"text-sm font-normal text-text-secondary mb-2",children:"Overall Win Rate"}),o.jsx("p",{className:"text-3xl font-normal text-accent mb-1",children:((ce=T==null?void 0:T.find(J=>J.metric==="Win Rate"))==null?void 0:ce.value)||"0%"}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Of all deals"})]})]}),o.jsxs("div",{className:"card p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsx("h3",{className:"text-lg font-normal text-text-primary",children:"AI-Enhanced Revenue Forecast"}),o.jsxs("div",{className:"flex items-center space-x-2 text-xs text-text-tertiary",children:[o.jsx(Y,{name:"Zap",size:12,className:"text-blue-500"}),o.jsx("span",{children:"AI Predictions"})]})]}),o.jsx("div",{className:"h-80",children:o.jsx(pa,{width:"100%",height:"100%",children:o.jsxs(tv,{data:W,children:[o.jsx(rs,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),o.jsx(Ea,{dataKey:"month",stroke:"#6B7280"}),o.jsx(Ta,{stroke:"#6B7280",tickFormatter:J=>`$${J/1e3}k`}),o.jsx(Rr,{content:o.jsx(G,{})}),o.jsx(Gn,{type:"monotone",dataKey:"actual",stroke:"#3B82F6",strokeWidth:3,name:"Actual Revenue"}),o.jsx(Gn,{type:"monotone",dataKey:"forecast",stroke:"#6366F1",strokeWidth:2,strokeDasharray:"5 5",name:"Traditional Forecast"}),o.jsx(Gn,{type:"monotone",dataKey:"aiPrediction",stroke:"#8B5CF6",strokeWidth:2,name:"AI Prediction"}),o.jsx(Gn,{type:"monotone",dataKey:"target",stroke:"#10B981",strokeWidth:2,name:"Target"})]})})}),o.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg text-sm",children:o.jsxs("div",{className:"flex items-start space-x-2",children:[o.jsx(Y,{name:"Info",size:16,className:"text-blue-600 mt-0.5"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-blue-800 font-medium",children:"AI Forecast Insights"}),o.jsxs("p",{className:"text-blue-700 mt-1",children:["Our AI model suggests a ",Math.round(Math.random()*10+5),"% increase in closing probability based on recent activity patterns and market conditions."]})]})]})})]}),o.jsx("div",{className:"card p-6 bg-gradient-to-r from-purple-50 to-indigo-50 border-purple-200",children:o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center flex-shrink-0 mt-1",children:o.jsx(Y,{name:"Sparkles",size:16,className:"text-purple-600"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-3",children:"AI-Powered Recommendations"}),o.jsxs("div",{className:"space-y-3 text-sm text-text-secondary",children:[o.jsxs("div",{className:"flex items-start space-x-2",children:[o.jsx(Y,{name:"Target",size:14,className:"text-green-600 mt-0.5"}),o.jsxs("p",{children:[o.jsx("strong",{children:"Focus Area:"})," Deals in negotiation stage are 23% more likely to close with increased follow-up frequency."]})]}),o.jsxs("div",{className:"flex items-start space-x-2",children:[o.jsx(Y,{name:"TrendingUp",size:14,className:"text-blue-600 mt-0.5"}),o.jsxs("p",{children:[o.jsx("strong",{children:"Opportunity:"})," Enterprise segment shows 40% higher conversion rates. Consider reallocating resources."]})]}),o.jsxs("div",{className:"flex items-start space-x-2",children:[o.jsx(Y,{name:"Clock",size:14,className:"text-orange-600 mt-0.5"}),o.jsxs("p",{children:[o.jsx("strong",{children:"Timing:"})," Optimal contact time for your prospects is Tuesday-Thursday, 10-11 AM based on response patterns."]})]}),o.jsxs("div",{className:"flex items-start space-x-2",children:[o.jsx(Y,{name:"AlertTriangle",size:14,className:"text-red-600 mt-0.5"}),o.jsxs("p",{children:[o.jsx("strong",{children:"Risk Alert:"})," 3 high-value deals have been in negotiation for over 30 days. Consider intervention strategies."]})]})]})]})]})})]})]})})}),x&&h&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4 overflow-y-auto",children:o.jsxs("div",{className:"bg-white dark:bg-surface rounded-lg shadow-xl w-full max-w-4xl my-8 flex flex-col max-h-[calc(100vh-4rem)]",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border flex-shrink-0",children:[o.jsxs("h2",{className:"text-xl font-semibold text-text-primary",children:["Detailed Analysis - ",h.chartType.replace("-"," ").toUpperCase()]}),o.jsx("button",{onClick:()=>p(!1),className:"p-2 text-text-secondary hover:text-text-primary hover:bg-surface-hover rounded-lg transition-colors duration-150",children:o.jsx(Y,{name:"X",size:20})})]}),o.jsxs("div",{className:"p-6 overflow-y-auto flex-1",children:[h.chartType==="funnel-stage"&&o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold mb-4",children:[h.data.name," Stage Details"]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[o.jsxs("div",{className:"card p-4",children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Total Value"}),o.jsx("p",{className:"text-xl font-bold text-text-primary",children:re(h.data.value)})]}),o.jsxs("div",{className:"card p-4",children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Deal Count"}),o.jsx("p",{className:"text-xl font-bold text-text-primary",children:h.data.count})]}),o.jsxs("div",{className:"card p-4",children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Avg Deal Size"}),o.jsx("p",{className:"text-xl font-bold text-text-primary",children:re(h.data.value/h.data.count)})]})]}),h.data.deals&&o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium mb-3",children:"Deals in this stage:"}),o.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:h.data.deals.slice(0,10).map((J,ue)=>o.jsxs("div",{className:"flex items-center justify-between p-3 bg-surface rounded-lg",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-text-primary",children:J.title||`Deal ${ue+1}`}),o.jsx("p",{className:"text-sm text-text-secondary",children:J.company||"Company Name"})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("p",{className:"font-medium text-text-primary",children:re(J.value)}),o.jsxs("p",{className:"text-xs text-text-tertiary",children:[Math.floor(Math.random()*30+1)," days in stage"]})]})]},ue))})]})]}),h.chartType==="revenue-trend"&&o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Revenue Trend Analysis"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"card p-4",children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Total Revenue"}),o.jsx("p",{className:"text-xl font-bold text-text-primary",children:re(h.data.reduce((J,ue)=>J+(ue.actual||0),0))})]}),o.jsxs("div",{className:"card p-4",children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Growth Rate"}),o.jsxs("p",{className:"text-xl font-bold text-success",children:["+",Math.floor(Math.random()*20+5),"%"]})]})]}),o.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[o.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Key Insights"}),o.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[o.jsx("li",{children:" Strongest performance in Q2 with 32% growth"}),o.jsx("li",{children:" Seasonal patterns show peak sales in March and November"}),o.jsx("li",{children:" Enterprise deals drive 68% of total revenue"}),o.jsx("li",{children:" Forecast accuracy has improved by 15% this quarter"})]})]})]})]})]}),o.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-border bg-surface flex-shrink-0",children:[o.jsx("button",{onClick:()=>p(!1),className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors duration-150",children:"Close"}),o.jsx("button",{className:"btn-primary",children:"Export Details"})]})]})}),d&&o.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>f(!1)})]})},lze=({activity:e,isLast:t,isSelected:r,onSelectionChange:n,showCheckbox:a=!1,onEdit:i,onDelete:s})=>{var b,w,_,D,j,N,S;const[l,c]=M.useState(!1),{hasAnyPermission:u}=Vt();M.useEffect(()=>{Gr.loadConfiguration()},[]);const d=E=>Gr.formatCurrency(E),f=E=>{E.stopPropagation(),n(E.target.checked)},h=()=>(e==null?void 0:e.contact)||"N/A",m=()=>(e==null?void 0:e.company)||"N/A",x=()=>(e==null?void 0:e.user)||"System",p=E=>{switch(E){case"email":return"Mail";case"call":return"Phone";case"meeting":return"Calendar";case"deal_update":return"TrendingUp";case"task":return"CheckSquare";default:return"Activity"}},g=E=>{switch(E){case"email":return"text-blue-700 bg-blue-100 border border-blue-200";case"call":return"text-green-700 bg-green-100 border border-green-200";case"meeting":return"text-purple-700 bg-purple-100 border border-purple-200";case"deal_update":return"text-orange-700 bg-orange-100 border border-orange-200";case"task":return"text-indigo-700 bg-indigo-100 border border-indigo-200";default:return"text-gray-700 bg-gray-100 border border-gray-200"}},v=E=>{switch(E){case"high":return"text-error bg-error-50";case"medium":return"text-warning bg-warning-50";case"low":return"text-success bg-success-50";default:return"text-text-secondary bg-gray-50"}},y=E=>{const T=new Date-E,L=Math.floor(T/(1e3*60*60)),O=Math.floor(L/24);return L<1?"Just now":L<24?`${L}h ago`:O<7?`${O}d ago`:E==null?void 0:E.toLocaleDateString()};return o.jsxs("div",{className:"relative",children:[!t&&o.jsx("div",{className:"absolute left-6 top-16 w-0.5 h-full bg-border"}),o.jsxs("div",{className:"flex space-x-4",children:[o.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${g(e==null?void 0:e.type)} flex-shrink-0 shadow-sm`,children:o.jsx(Y,{name:p(e==null?void 0:e.type),size:20})}),o.jsxs("div",{className:"flex-1 bg-white rounded-lg border border-border shadow-sm hover:shadow-md transition-shadow duration-200",children:[o.jsx("div",{className:"p-6 border-b border-border",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[a&&o.jsx("input",{type:"checkbox",checked:r,onChange:f,className:"rounded border-border text-primary focus:ring-primary"}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary line-clamp-1",children:(e==null?void 0:e.title)||"Untitled Activity"}),o.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium capitalize ${v(e==null?void 0:e.priority)} whitespace-nowrap`,children:(e==null?void 0:e.type)||"note"}),((b=e==null?void 0:e.deal)==null?void 0:b.value)&&o.jsx("span",{className:"px-3 py-1 bg-success-50 text-success rounded-full text-xs font-medium whitespace-nowrap",children:d(e.deal.value)})]}),o.jsxs("div",{className:"flex items-center space-x-4 text-sm text-text-tertiary",children:[o.jsxs("span",{className:"flex items-center space-x-1",children:[o.jsx(Y,{name:"Clock",size:14}),o.jsx("span",{children:y(e==null?void 0:e.timestamp)})]}),(e==null?void 0:e.duration)&&o.jsxs("span",{className:"flex items-center space-x-1",children:[o.jsx(Y,{name:"Timer",size:14}),o.jsx("span",{children:e.duration})]}),x()!=="System"&&o.jsxs("span",{className:"flex items-center space-x-1",children:[o.jsx(Y,{name:"User",size:14}),o.jsx("span",{children:x()})]})]})]})]}),o.jsxs("div",{className:"flex items-center space-x-1 flex-shrink-0",children:[u(["activities.edit_all","activities.edit_own"])&&o.jsx("button",{onClick:()=>i&&i(e),className:"p-2 text-text-tertiary hover:text-primary hover:bg-primary-50 rounded transition-colors duration-150",title:"Edit activity",children:o.jsx(Y,{name:"Edit2",size:16})}),u(["activities.delete_all","activities.delete_own"])&&o.jsx("button",{onClick:()=>s&&s(e.id),className:"p-2 text-text-tertiary hover:text-error hover:bg-error-50 rounded transition-colors duration-150",title:"Delete activity",children:o.jsx(Y,{name:"Trash2",size:16})})]})]})}),o.jsx("div",{className:"px-6 py-4 bg-surface-50",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center shadow-sm",children:o.jsx("span",{className:"text-sm font-bold text-black",children:h().split(" ").map(E=>E[0]).join("").substr(0,2)})}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-text-primary",children:h()}),o.jsxs("div",{className:"text-sm text-text-secondary flex items-center space-x-1",children:[o.jsx(Y,{name:"Building",size:12}),o.jsx("span",{children:m()})]})]})]}),o.jsx("div",{className:"flex items-center space-x-2",children:o.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${g(e==null?void 0:e.type)}`,children:[o.jsx(Y,{name:p(e==null?void 0:e.type),size:12,className:"mr-1"}),((w=e==null?void 0:e.type)==null?void 0:w.replace("_"," "))||"note"]})})]})}),(e==null?void 0:e.description)&&o.jsxs("div",{className:"px-6 py-4",children:[o.jsx("p",{className:"text-text-primary text-sm leading-relaxed",children:l?e==null?void 0:e.description:`${(_=e==null?void 0:e.description)==null?void 0:_.substring(0,200)}${((D=e==null?void 0:e.description)==null?void 0:D.length)>200?"...":""}`}),((j=e==null?void 0:e.description)==null?void 0:j.length)>200&&o.jsxs("button",{onClick:()=>c(!l),className:"text-primary text-sm font-medium hover:text-primary-600 mt-2 transition-colors flex items-center space-x-1",children:[o.jsx("span",{children:l?"Show less":"Read more"}),o.jsx(Y,{name:l?"ChevronUp":"ChevronDown",size:14})]})]}),l&&o.jsxs("div",{className:"space-y-4 border-t border-border pt-4",children:[(e==null?void 0:e.attachments)&&((N=e==null?void 0:e.attachments)==null?void 0:N.length)>0&&o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary mb-2",children:"Attachments"}),o.jsx("div",{className:"space-y-2",children:(S=e==null?void 0:e.attachments)==null?void 0:S.map((E,A)=>o.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[o.jsx(Y,{name:"Paperclip",size:14,className:"text-text-tertiary"}),o.jsx("span",{className:"text-primary hover:text-primary-700 cursor-pointer",children:E})]},A))})]}),(e==null?void 0:e.type)==="deal_update"&&(e==null?void 0:e.previousStage)&&o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary mb-2",children:"Stage Progression"}),o.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[o.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded",children:e==null?void 0:e.previousStage}),o.jsx(Y,{name:"ArrowRight",size:14,className:"text-text-tertiary"}),o.jsx("span",{className:"px-2 py-1 bg-primary-50 text-primary rounded",children:e==null?void 0:e.currentStage}),o.jsxs("span",{className:"text-text-secondary ml-2",children:["(",e==null?void 0:e.probability,"% probability)"]})]})]}),(e==null?void 0:e.type)==="meeting"&&o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(e==null?void 0:e.location)&&o.jsxs("div",{children:[o.jsx("span",{className:"font-medium text-text-primary",children:"Location:"}),o.jsx("span",{className:"text-text-secondary ml-2",children:e==null?void 0:e.location})]}),(e==null?void 0:e.attendees)&&o.jsxs("div",{children:[o.jsx("span",{className:"font-medium text-text-primary",children:"Attendees:"}),o.jsxs("span",{className:"text-text-secondary ml-2",children:[e==null?void 0:e.attendees," people"]})]})]}),(e==null?void 0:e.type)==="call"&&o.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"font-medium text-text-primary",children:"Type:"}),o.jsx("span",{className:"text-text-secondary ml-2 capitalize",children:e==null?void 0:e.callType})]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium text-text-primary",children:"Status:"}),o.jsx("span",{className:"text-text-secondary ml-2 capitalize",children:e==null?void 0:e.status})]})]})]})]})]})]})},cze=({selectedFilters:e,onFiltersChange:t})=>{const[r,n]=M.useState([{value:"all",label:"All Contacts"}]),[a,i]=M.useState(!1);M.useEffect(()=>{(async()=>{try{i(!0);const f=await Ct.getContactsForActivityFilters(),h=[{value:"all",label:"All Contacts"},...f.map(m=>({value:m.id,label:`${m.first_name} ${m.last_name}`,activityCount:m.activity_count||0}))];n(h)}catch(f){console.error("Error loading contacts:",f),n([{value:"all",label:"All Contacts"}])}finally{i(!1)}})()},[]);const s=[{value:"all",label:"All Activities",icon:"Activity"},{value:"email",label:"Emails",icon:"Mail"},{value:"call",label:"Calls",icon:"Phone"},{value:"meeting",label:"Meetings",icon:"Calendar"},{value:"deal_update",label:"Deal Updates",icon:"TrendingUp"},{value:"task",label:"Tasks",icon:"CheckSquare"}],l=[{value:"all",label:"All Time"},{value:"today",label:"Today"},{value:"week",label:"This Week"},{value:"month",label:"This Month"}],c=[{value:"all",label:"All Channels",icon:"Globe"},{value:"gmail",label:"Gmail",icon:"Mail"},{value:"twilio",label:"Phone",icon:"Phone"},{value:"calendar",label:"Calendar",icon:"Calendar"},{value:"system",label:"System",icon:"Settings"}],u=(d,f)=>{t({...e,[d]:f})};return o.jsxs("div",{className:"space-y-6 pb-4",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Contact"}),o.jsx("div",{className:"space-y-2",children:a?o.jsxs("div",{className:"flex items-center space-x-2 text-sm text-text-secondary",children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"}),o.jsx("span",{children:"Loading contacts..."})]}):r==null?void 0:r.map(d=>o.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"teamMember",value:d==null?void 0:d.value,checked:(e==null?void 0:e.teamMember)===(d==null?void 0:d.value),onChange:f=>{var h;return u("teamMember",(h=f==null?void 0:f.target)==null?void 0:h.value)},className:"w-4 h-4 text-primary border-border focus:ring-primary-500"}),o.jsxs("div",{className:"flex items-center justify-between w-full",children:[o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:d==null?void 0:d.label}),(d==null?void 0:d.value)!=="all"&&(d==null?void 0:d.activityCount)!==void 0&&o.jsx("div",{className:"text-xs text-text-tertiary",children:o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(Y,{name:"Activity",size:10}),o.jsxs("span",{children:[d.activityCount," activities"]})]})})]}),(d==null?void 0:d.value)!=="all"&&(d==null?void 0:d.activityCount)!==void 0&&o.jsx("div",{className:"text-xs bg-primary-100 text-primary-700 px-2 py-1 rounded-full",children:d.activityCount})]})]},d==null?void 0:d.value))})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Activity Type"}),o.jsx("div",{className:"space-y-2",children:s==null?void 0:s.map(d=>o.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"activityType",value:d==null?void 0:d.value,checked:(e==null?void 0:e.activityType)===(d==null?void 0:d.value),onChange:f=>{var h;return u("activityType",(h=f==null?void 0:f.target)==null?void 0:h.value)},className:"w-4 h-4 text-primary border-border focus:ring-primary-500"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:d==null?void 0:d.icon,size:16,className:"text-text-secondary"}),o.jsx("span",{className:"text-sm text-text-secondary",children:d==null?void 0:d.label})]})]},d==null?void 0:d.value))})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Date Range"}),o.jsx("div",{className:"space-y-2",children:l==null?void 0:l.map(d=>o.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"dateRange",value:d==null?void 0:d.value,checked:(e==null?void 0:e.dateRange)===(d==null?void 0:d.value),onChange:f=>{var h;return u("dateRange",(h=f==null?void 0:f.target)==null?void 0:h.value)},className:"w-4 h-4 text-primary border-border focus:ring-primary-500"}),o.jsx("span",{className:"text-sm text-text-secondary",children:d==null?void 0:d.label})]},d==null?void 0:d.value))})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Communication Channel"}),o.jsx("div",{className:"space-y-2",children:c==null?void 0:c.map(d=>o.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"channel",value:d==null?void 0:d.value,checked:(e==null?void 0:e.channel)===(d==null?void 0:d.value),onChange:f=>{var h;return u("channel",(h=f==null?void 0:f.target)==null?void 0:h.value)},className:"w-4 h-4 text-primary border-border focus:ring-primary-500"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:d==null?void 0:d.icon,size:16,className:"text-text-secondary"}),o.jsx("span",{className:"text-sm text-text-secondary",children:d==null?void 0:d.label})]})]},d==null?void 0:d.value))})]}),o.jsxs("div",{className:"pt-4 border-t border-border",children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Quick Actions"}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("button",{className:"w-full flex items-center space-x-2 px-3 py-2 text-sm text-text-secondary hover:text-primary hover:bg-primary-50 rounded-lg transition-all duration-150 ease-out",children:[o.jsx(Y,{name:"Filter",size:16}),o.jsx("span",{children:"Save Current Filter"})]}),o.jsxs("button",{className:"w-full flex items-center space-x-2 px-3 py-2 text-sm text-text-secondary hover:text-primary hover:bg-primary-50 rounded-lg transition-all duration-150 ease-out",children:[o.jsx(Y,{name:"RefreshCw",size:16}),o.jsx("span",{children:"Refresh Timeline"})]}),o.jsxs("button",{className:"w-full flex items-center space-x-2 px-3 py-2 text-sm text-text-secondary hover:text-primary hover:bg-primary-50 rounded-lg transition-all duration-150 ease-out",children:[o.jsx(Y,{name:"Settings",size:16}),o.jsx("span",{children:"Timeline Settings"})]})]})]})]})},uze=({activities:e})=>{var n;const t=M.useMemo(()=>{if(!e.length)return null;const a=e.reduce((x,p)=>(x[p.type]=(x[p.type]||0)+1,x),{}),i=Object.entries(a).map(([x,p])=>({type:x.charAt(0).toUpperCase()+x.slice(1).replace("_"," "),count:p})),l=Array.from({length:30},(x,p)=>{const g=new Date;return g.setDate(g.getDate()-p),g.toISOString().split("T")[0]}).reverse().map(x=>{const p=e.filter(g=>g.timestamp.toISOString().split("T")[0]===x).length;return{date:new Date(x).toLocaleDateString("en-US",{month:"short",day:"numeric"}),activities:p}}),c=e.reduce((x,p)=>(x[p.channel]=(x[p.channel]||0)+1,x),{}),u=Object.entries(c).map(([x,p])=>({channel:x.charAt(0).toUpperCase()+x.slice(1),count:p,fill:r(x)})),d=Math.floor(Math.random()*4)+1,f=Math.floor(Math.random()*20)+5,h=e.filter(x=>x.status==="completed").length,m=e.length>0?Math.round(h/e.length*100):0;return{typeChartData:i,trendData:l,channelChartData:u,avgResponseTime:d,responseTimeImprovement:f,completionRate:m,totalActivities:e.length,todayActivities:e.filter(x=>x.timestamp.toDateString()===new Date().toDateString()).length}},[e]),r=a=>({gmail:"#4285F4",twilio:"#F22F46",calendar:"#34A853",system:"#9AA0A6"})[a]||"#9AA0A6";return t?o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[o.jsx("div",{className:"w-10 h-10 bg-blue-50 rounded-lg flex items-center justify-center",children:o.jsx(Y,{name:"Activity",size:20,className:"text-blue-600"})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Total Activities"}),o.jsx("p",{className:"text-2xl font-bold text-text-primary",children:t.totalActivities})]})]})}),o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[o.jsx("div",{className:"w-10 h-10 bg-green-50 rounded-lg flex items-center justify-center",children:o.jsx(Y,{name:"TrendingUp",size:20,className:"text-green-600"})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Today's Activities"}),o.jsx("p",{className:"text-2xl font-bold text-text-primary",children:t.todayActivities})]})]})}),o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[o.jsx("div",{className:"w-10 h-10 bg-purple-50 rounded-lg flex items-center justify-center",children:o.jsx(Y,{name:"Clock",size:20,className:"text-purple-600"})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Avg Response Time"}),o.jsxs("p",{className:"text-2xl font-bold text-text-primary",children:[t.avgResponseTime,"h"]}),o.jsxs("p",{className:"text-xs text-green-600",children:[" ",t.responseTimeImprovement,"% this month"]})]})]})}),o.jsx("div",{className:"card p-6",children:o.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[o.jsx("div",{className:"w-10 h-10 bg-orange-50 rounded-lg flex items-center justify-center",children:o.jsx(Y,{name:"CheckCircle",size:20,className:"text-orange-600"})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Completion Rate"}),o.jsxs("p",{className:"text-2xl font-bold text-text-primary",children:[t.completionRate,"%"]})]})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[o.jsxs("div",{className:"card p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-6",children:"Activity Volume by Type"}),o.jsx("div",{className:"h-80",children:o.jsx(pa,{width:"100%",height:"100%",children:o.jsxs(td,{data:t.typeChartData,children:[o.jsx(rs,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),o.jsx(Ea,{dataKey:"type",stroke:"#6B7280",fontSize:12}),o.jsx(Ta,{stroke:"#6B7280",fontSize:12}),o.jsx(Rr,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #E5E7EB",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),o.jsx(ai,{dataKey:"count",fill:"#3B82F6",radius:[4,4,0,0]})]})})})]}),o.jsxs("div",{className:"card p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-6",children:"Channel Distribution"}),o.jsx("div",{className:"h-80",children:o.jsx(pa,{width:"100%",height:"100%",children:o.jsxs(rv,{children:[o.jsx(Bi,{data:t.channelChartData,cx:"50%",cy:"50%",labelLine:!1,label:({channel:a,percent:i})=>`${a} (${(i*100).toFixed(0)}%)`,outerRadius:80,fill:"#8884d8",dataKey:"count",children:t.channelChartData.map((a,i)=>o.jsx(Ao,{fill:a.fill},`cell-${i}`))}),o.jsx(Rr,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #E5E7EB",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}})]})})})]})]}),o.jsxs("div",{className:"card p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-6",children:"Activity Trend (Last 30 Days)"}),o.jsx("div",{className:"h-80",children:o.jsx(pa,{width:"100%",height:"100%",children:o.jsxs(tv,{data:t.trendData,children:[o.jsx(rs,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),o.jsx(Ea,{dataKey:"date",stroke:"#6B7280",fontSize:12}),o.jsx(Ta,{stroke:"#6B7280",fontSize:12}),o.jsx(Rr,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #E5E7EB",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),o.jsx(Gn,{type:"monotone",dataKey:"activities",stroke:"#3B82F6",strokeWidth:3,dot:{fill:"#3B82F6",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#3B82F6",strokeWidth:2}})]})})})]}),o.jsx("div",{className:"card p-6 bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200",children:o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-1",children:o.jsx(Y,{name:"Zap",size:16,className:"text-blue-600"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"AI Insights"}),o.jsxs("div",{className:"space-y-3 text-sm text-text-secondary",children:[o.jsxs("p",{children:[" Your email response time has improved by ",t.responseTimeImprovement,"% this month. Keep up the great work!"]}),o.jsx("p",{children:" Peak activity hours are between 9-11 AM. Consider scheduling important calls during this time."}),o.jsxs("p",{children:[" ",((n=t.typeChartData[0])==null?void 0:n.type)||"Emails"," make up the majority of your activities. Consider automating routine tasks."]}),o.jsxs("p",{children:[" Your completion rate is ",t.completionRate,"%. ",t.completionRate>80?"Excellent!":"Consider setting reminders for follow-ups."]})]})]})]})})]}):o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"w-16 h-16 bg-primary-50 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(Y,{name:"BarChart3",size:32,className:"text-primary"})}),o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"No data available"}),o.jsx("p",{className:"text-text-secondary",children:"Add some activities to see insights and analytics."})]})},dze=({selectedCount:e,selectedIds:t,onBulkAction:r,onClearSelection:n})=>{const a=i=>{r(i,t)};return o.jsxs("div",{className:"bg-primary-50 border border-primary-200 rounded-lg p-4 mb-6 flex items-center justify-between",children:[o.jsx("div",{className:"flex items-center space-x-3",children:o.jsxs("div",{className:"flex items-center space-x-2 text-primary",children:[o.jsx(Y,{name:"CheckSquare",size:20}),o.jsxs("span",{className:"font-medium",children:[e," activities selected"]})]})}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("button",{onClick:()=>a("export"),className:"flex items-center space-x-2 px-3 py-1.5 bg-white border border-primary-300 rounded-md text-primary hover:bg-primary-50 transition-colors duration-150",children:[o.jsx(Y,{name:"Download",size:16}),o.jsx("span",{children:"Export"})]}),o.jsxs("button",{onClick:()=>a("delete"),className:"flex items-center space-x-2 px-3 py-1.5 bg-red-50 border border-red-300 rounded-md text-red-600 hover:bg-red-100 transition-colors duration-150",children:[o.jsx(Y,{name:"Trash2",size:16}),o.jsx("span",{children:"Delete"})]}),o.jsxs("button",{onClick:n,className:"flex items-center space-x-2 px-3 py-1.5 text-text-secondary hover:text-text-primary transition-colors duration-150",children:[o.jsx(Y,{name:"X",size:16}),o.jsx("span",{children:"Clear"})]})]})]})},fze={getBuiltInTemplates(){return[{id:"follow-up-email",name:"Follow-up Email",description:"Standard follow-up email template",type:"email",icon:"Mail",category:"communication",template:{subject:"Follow up on our conversation",description:`Hi {contact_name},

I wanted to follow up on our conversation about {topic}. Do you have any questions or would you like to schedule a call to discuss next steps?

Best regards,
{user_name}`,priority:"medium",duration_minutes:15}},{id:"discovery-call",name:"Discovery Call",description:"Initial discovery call template",type:"call",icon:"Phone",category:"sales",template:{subject:"Discovery call with {contact_name}",description:`Discovery call to understand {company_name}'s needs and challenges.

Topics to cover:
- Current situation
- Pain points
- Goals and objectives
- Timeline
- Budget considerations`,priority:"high",duration_minutes:30}},{id:"demo-meeting",name:"Product Demo",description:"Product demonstration meeting",type:"meeting",icon:"Monitor",category:"sales",template:{subject:"Product demo for {company_name}",description:`Product demonstration meeting with {contact_name} from {company_name}.

Demo agenda:
- Overview of our solution
- Key features relevant to their needs
- Q&A session
- Next steps discussion`,priority:"high",duration_minutes:45}},{id:"proposal-review",name:"Proposal Review",description:"Review proposal with client",type:"meeting",icon:"FileText",category:"sales",template:{subject:"Proposal review meeting",description:`Review and discuss the proposal with {contact_name}.

Agenda:
- Walk through proposal details
- Address questions and concerns
- Discuss terms and conditions
- Timeline for decision`,priority:"high",duration_minutes:60}},{id:"check-in-call",name:"Check-in Call",description:"Regular customer check-in",type:"call",icon:"Phone",category:"support",template:{subject:"Regular check-in with {contact_name}",description:`Scheduled check-in call to ensure customer satisfaction and identify any issues or opportunities.

Discussion points:
- How things are going
- Any challenges or concerns
- Feedback on our service
- Upcoming needs or projects`,priority:"medium",duration_minutes:20}},{id:"thank-you-email",name:"Thank You Email",description:"Post-meeting thank you",type:"email",icon:"Heart",category:"communication",template:{subject:"Thank you for your time",description:`Hi {contact_name},

Thank you for taking the time to meet with me today. I appreciate your insights about {company_name}'s needs.

As discussed, I'll {next_action} and get back to you by {follow_up_date}.

Please don't hesitate to reach out if you have any questions.

Best regards,
{user_name}`,priority:"low",duration_minutes:10}},{id:"contract-negotiation",name:"Contract Negotiation",description:"Contract terms discussion meeting",type:"meeting",icon:"FileCheck",category:"sales",template:{subject:"Contract negotiation with {company_name}",description:`Meeting to discuss and negotiate contract terms with {contact_name}.

Agenda:
- Review contract terms
- Discuss pricing and payment terms
- Address legal requirements
- Finalize implementation timeline
- Next steps for signing`,priority:"high",duration_minutes:90}},{id:"onboarding-kickoff",name:"Onboarding Kickoff",description:"Customer onboarding initialization",type:"meeting",icon:"Users",category:"support",template:{subject:"Welcome to {company_name} - Onboarding kickoff",description:`Onboarding kickoff meeting with {contact_name} to begin implementation.

Agenda:
- Welcome and introductions
- Project timeline overview
- Resource requirements
- Communication protocols
- Initial setup steps`,priority:"high",duration_minutes:60}}]},getTemplatesByCategory(e){return this.getBuiltInTemplates().filter(t=>t.category===e)},getTemplatesByType(e){return this.getBuiltInTemplates().filter(t=>t.type===e)},getTemplateById(e){return this.getBuiltInTemplates().find(t=>t.id===e)},getAvailableVariables(){return{contact_name:"Contact's full name",company_name:"Company name",user_name:"Current user's name",deal_title:"Deal title",deal_value:"Deal value (formatted)",today:"Today's date",follow_up_date:"One week from today",topic:"Discussion topic (placeholder)",next_action:"Next action item (placeholder)"}},substituteVariables(e,t={}){var i;if(!e)return e;let r=e;if(t.user){const s=t.user.first_name&&t.user.last_name?`${t.user.first_name} ${t.user.last_name}`:t.user.email||"User";r=r.replace(/{user_name}/g,s)}t.contact&&(r=r.replace(/{contact_name}/g,`${t.contact.first_name} ${t.contact.last_name}`),r=r.replace(/{company_name}/g,((i=t.contact.company)==null?void 0:i.name)||"[Company Name]")),t.deal&&(r=r.replace(/{deal_title}/g,t.deal.title||"[Deal Title]"),r=r.replace(/{deal_value}/g,t.deal.value?`$${t.deal.value.toLocaleString()}`:"[Deal Value]"));const n=new Date,a=new Date(n.getTime()+7*24*60*60*1e3);return r=r.replace(/{today}/g,n.toLocaleDateString()),r=r.replace(/{follow_up_date}/g,a.toLocaleDateString()),r=r.replace(/{contact_name}/g,"[Contact Name]"),r=r.replace(/{company_name}/g,"[Company Name]"),r=r.replace(/{user_name}/g,"[User Name]"),r=r.replace(/{topic}/g,"[Discussion Topic]"),r=r.replace(/{next_action}/g,"[Next Action]"),r}},hze=({isOpen:e,onClose:t,onTemplateSelected:r})=>{const[n,a]=M.useState(null),[i,s]=M.useState("all"),l=fze.getBuiltInTemplates(),c=["all","communication","sales","support"],u=i==="all"?l:l.filter(h=>h.category===i),d=h=>{switch(h){case"email":return"text-blue-600 bg-blue-50";case"call":return"text-green-600 bg-green-50";case"meeting":return"text-purple-600 bg-purple-50";default:return"text-gray-600 bg-gray-50"}},f=h=>{r(h)};return e?o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border",children:[o.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Activity Templates"}),o.jsx("button",{onClick:t,className:"p-2 text-text-secondary hover:text-text-primary hover:bg-surface-hover rounded-lg transition-colors duration-150",children:o.jsx(Y,{name:"X",size:20})})]}),o.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-200px)]",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("p",{className:"text-text-secondary text-sm mb-4",children:"Select a template to quickly create an activity with pre-filled content. Template variables will be automatically substituted with actual data."}),o.jsx("div",{className:"flex flex-wrap gap-2",children:c.map(h=>o.jsx("button",{onClick:()=>s(h),className:`px-3 py-1 text-sm rounded-full transition-colors duration-150 ${i===h?"bg-primary text-white":"bg-surface text-text-secondary hover:bg-surface-hover"}`,children:h.charAt(0).toUpperCase()+h.slice(1)},h))})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:u.map(h=>o.jsxs("div",{className:`border border-border rounded-lg p-4 cursor-pointer transition-all duration-150 hover:shadow-md ${(n==null?void 0:n.id)===h.id?"border-primary bg-primary-50":"hover:border-border-dark"}`,onClick:()=>a(h),children:[o.jsxs("div",{className:"flex items-start space-x-3 mb-3",children:[o.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${d(h.type)}`,children:o.jsx(Y,{name:h.icon,size:20})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"font-medium text-text-primary mb-1",children:h.name}),o.jsx("p",{className:"text-sm text-text-secondary",children:h.description})]})]}),o.jsxs("div",{className:"flex items-center justify-between text-xs text-text-tertiary",children:[o.jsx("span",{className:"px-2 py-1 bg-surface rounded-full",children:h.type.charAt(0).toUpperCase()+h.type.slice(1)}),o.jsxs("span",{children:[h.template.duration_minutes," min"]})]})]},h.id))}),n&&o.jsxs("div",{className:"mt-6 space-y-4",children:[o.jsxs("div",{className:"p-4 border border-border rounded-lg bg-surface",children:[o.jsx("h4",{className:"font-medium text-text-primary mb-3",children:"Template Preview"}),o.jsxs("div",{className:"space-y-3 text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"font-medium text-text-secondary",children:"Subject:"}),o.jsx("p",{className:"text-text-primary mt-1",children:n.template.subject})]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium text-text-secondary",children:"Description:"}),o.jsx("p",{className:"text-text-primary mt-1 whitespace-pre-line",children:n.template.description})]}),o.jsxs("div",{className:"flex items-center space-x-4 text-text-tertiary",children:[o.jsxs("span",{children:["Priority: ",n.template.priority]}),o.jsxs("span",{children:["Duration: ",n.template.duration_minutes," minutes"]})]})]})]}),o.jsxs("div",{className:"p-4 border border-border rounded-lg bg-blue-50",children:[o.jsxs("h4",{className:"font-medium text-blue-900 mb-2 flex items-center",children:[o.jsx(Y,{name:"Info",size:16,className:"mr-2"}),"Template Variables"]}),o.jsxs("div",{className:"text-xs text-blue-800 space-y-1",children:[o.jsxs("p",{children:[o.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"{contact_name}"})," - Contact's full name"]}),o.jsxs("p",{children:[o.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"{company_name}"})," - Company name"]}),o.jsxs("p",{children:[o.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"{user_name}"})," - Your name"]}),o.jsxs("p",{children:[o.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"{today}"})," - Today's date"]}),o.jsxs("p",{children:[o.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"{follow_up_date}"})," - One week from today"]})]})]})]})]}),o.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-border bg-surface",children:[o.jsx("button",{onClick:t,className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors duration-150",children:"Cancel"}),o.jsx("button",{onClick:()=>n&&f(n),disabled:!n,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:"Use Template"})]})]})}):null},mze=({activities:e,selectedActivities:t,onActivitySelection:r,onEdit:n,onDelete:a,onSelectAll:i})=>{const{hasAnyPermission:s}=Vt(),l=f=>{switch(f){case"email":return"Mail";case"call":return"Phone";case"meeting":return"Calendar";case"deal_update":return"TrendingUp";case"task":return"CheckSquare";case"note":return"FileText";default:return"Activity"}},c=f=>{switch(f){case"email":return"text-blue-600 bg-blue-50";case"call":return"text-green-600 bg-green-50";case"meeting":return"text-purple-600 bg-purple-50";case"deal_update":return"text-orange-600 bg-orange-50";case"task":return"text-indigo-600 bg-indigo-50";case"note":return"text-gray-600 bg-gray-50";default:return"text-gray-600 bg-gray-50"}},u=f=>{const h=new Date(f),m=new Date,x=m-h,p=Math.floor(x/(1e3*60*60)),g=Math.floor(p/24);return p<1?"Just now":p<24?`${p}h ago`:g<7?`${g}d ago`:h.toLocaleDateString("en-US",{month:"short",day:"numeric",year:h.getFullYear()!==m.getFullYear()?"numeric":void 0})},d=(f,h=100)=>f?f.length>h?f.substring(0,h)+"...":f:"";return o.jsx("div",{className:"bg-white rounded-lg border border-border shadow-sm overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-border",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left w-10",children:o.jsx("input",{type:"checkbox",checked:t.size===e.length&&e.length>0,onChange:i,className:"rounded border-border text-primary focus:ring-primary"})}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider w-16",children:"Type"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider",children:"Subject"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider",children:"Contact"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider",children:"Company"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider",children:"Date"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider",children:"Owner"}),o.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-text-secondary uppercase tracking-wider w-24",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y divide-border",children:e.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:"8",className:"px-4 py-12 text-center",children:o.jsxs("div",{className:"flex flex-col items-center justify-center",children:[o.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:o.jsx(Y,{name:"Activity",size:32,className:"text-gray-400"})}),o.jsx("p",{className:"text-text-secondary text-sm",children:"No activities found"})]})})}):e.map(f=>{var h,m;return o.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[o.jsx("td",{className:"px-4 py-4",children:o.jsx("input",{type:"checkbox",checked:t.has(f.id),onChange:x=>r(f.id,x.target.checked),className:"rounded border-border text-primary focus:ring-primary"})}),o.jsx("td",{className:"px-4 py-4",children:o.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${c(f.type)}`,children:o.jsx(Y,{name:l(f.type),size:16})})}),o.jsx("td",{className:"px-4 py-4",children:o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"text-sm font-medium text-text-primary line-clamp-1",children:f.title||"Untitled"}),f.description&&o.jsx("span",{className:"text-xs text-text-tertiary line-clamp-1 mt-1",children:d(f.description,80)})]})}),o.jsx("td",{className:"px-4 py-4",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[f.contactAvatar?o.jsx("img",{src:f.contactAvatar,alt:f.contact,className:"w-6 h-6 rounded-full"}):o.jsx("div",{className:"w-6 h-6 rounded-full bg-primary-100 flex items-center justify-center",children:o.jsx("span",{className:"text-xs font-medium text-primary",children:((h=f.contact)==null?void 0:h.charAt(0))||"N"})}),o.jsx("span",{className:"text-sm text-text-secondary truncate max-w-[150px]",children:f.contact||"N/A"})]})}),o.jsx("td",{className:"px-4 py-4",children:o.jsx("span",{className:"text-sm text-text-secondary truncate block max-w-[150px]",children:f.company||"N/A"})}),o.jsx("td",{className:"px-4 py-4",children:o.jsxs("div",{className:"flex items-center space-x-1 text-sm text-text-tertiary",children:[o.jsx(Y,{name:"Clock",size:14}),o.jsx("span",{children:u(f.timestamp)})]})}),o.jsx("td",{className:"px-4 py-4",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[f.avatar?o.jsx("img",{src:f.avatar,alt:f.user,className:"w-6 h-6 rounded-full"}):o.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center",children:o.jsx("span",{className:"text-xs font-medium text-gray-600",children:((m=f.user)==null?void 0:m.charAt(0))||"U"})}),o.jsx("span",{className:"text-sm text-text-secondary truncate max-w-[100px]",children:f.user||"System"})]})}),o.jsx("td",{className:"px-4 py-4",children:o.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[s(["activities.edit_all","activities.edit_own"])&&o.jsx("button",{onClick:()=>n(f),className:"p-1.5 text-text-tertiary hover:text-primary hover:bg-primary-50 rounded transition-colors duration-150",title:"Edit",children:o.jsx(Y,{name:"Edit2",size:16})}),s(["activities.delete_all","activities.delete_own"])&&o.jsx("button",{onClick:()=>a(f.id),className:"p-1.5 text-text-tertiary hover:text-error hover:bg-error-50 rounded transition-colors duration-150",title:"Delete",children:o.jsx(Y,{name:"Trash2",size:16})})]})})]},f.id)})})]})})})};function Gs(e,t){if(e==null)return{};var r,n,a=_l(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function mn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lI(n.key),n)}}function pn(e,t,r){return t&&M6(e.prototype,t),r&&M6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fv(e){return Fv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Fv(e)}function _H(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_H=function(){return!!e})()}function pze(e,t){if(t&&(Co(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return x1e(e)}function ua(e,t,r){return t=Fv(t),pze(e,_H()?Reflect.construct(t,r||[],Fv(e).constructor):t.apply(e,r))}function da(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&q0(e,t)}function DH(e){if(Array.isArray(e))return e}function xze(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return l}}function kj(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function nk(e,t){if(e){if(typeof e=="string")return kj(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?kj(e,t):void 0}}function jH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Oi(e,t){return DH(e)||xze(e,t)||nk(e,t)||jH()}function NH(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=NH(e[t]))&&(n&&(n+=" "),n+=r);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}function Br(){for(var e,t,r=0,n="";r<arguments.length;)(e=arguments[r++])&&(t=NH(e))&&(n&&(n+=" "),n+=t);return n}var gze=function(e,t,r,n,a,i,s,l){if(!e){var c;if(t===void 0)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[r,n,a,i,s,l],d=0;c=new Error(t.replace(/%s/g,function(){return u[d++]})),c.name="Invariant Violation"}throw c.framesToPop=1,c}},vze=gze;const fp=At(vze);var yze=function(){};function bze(e,t){var r={};return Object.keys(e).forEach(function(n){r[R0(n)]=yze}),r}function U6(e,t){return e[t]!==void 0}function R0(e){return"default"+e.charAt(0).toUpperCase()+e.substr(1)}function wze(e){return!!e&&(typeof e!="function"||e.prototype&&e.prototype.isReactComponent)}function SH(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);e!=null&&this.setState(e)}function EH(e){function t(r){var n=this.constructor.getDerivedStateFromProps(e,r);return n??null}this.setState(t.bind(this))}function TH(e,t){try{var r=this.props,n=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(r,n)}finally{this.props=r,this.state=n}}SH.__suppressDeprecationWarning=!0;EH.__suppressDeprecationWarning=!0;TH.__suppressDeprecationWarning=!0;function _ze(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if(typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function")return e;var r=null,n=null,a=null;if(typeof t.componentWillMount=="function"?r="componentWillMount":typeof t.UNSAFE_componentWillMount=="function"&&(r="UNSAFE_componentWillMount"),typeof t.componentWillReceiveProps=="function"?n="componentWillReceiveProps":typeof t.UNSAFE_componentWillReceiveProps=="function"&&(n="UNSAFE_componentWillReceiveProps"),typeof t.componentWillUpdate=="function"?a="componentWillUpdate":typeof t.UNSAFE_componentWillUpdate=="function"&&(a="UNSAFE_componentWillUpdate"),r!==null||n!==null||a!==null){var i=e.displayName||e.name,s=typeof e.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+i+" uses "+s+" but also contains the following legacy lifecycles:"+(r!==null?`
  `+r:"")+(n!==null?`
  `+n:"")+(a!==null?`
  `+a:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof e.getDerivedStateFromProps=="function"&&(t.componentWillMount=SH,t.componentWillReceiveProps=EH),typeof t.getSnapshotBeforeUpdate=="function"){if(typeof t.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=TH;var l=t.componentDidUpdate;t.componentDidUpdate=function(u,d,f){var h=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:f;l.call(this,u,d,h)}}return e}var Dze="/Users/jquense/src/uncontrollable/src/uncontrollable.js";function kH(e,t,r){r===void 0&&(r=[]);var n=e.displayName||e.name||"Component",a=wze(e),i=Object.keys(t),s=i.map(R0);a||!r.length||fp(!1);var l=function(u){tN(d,u);function d(){for(var h,m=arguments.length,x=new Array(m),p=0;p<m;p++)x[p]=arguments[p];h=u.call.apply(u,[this].concat(x))||this,h.handlers=Object.create(null),i.forEach(function(v){var y=t[v],b=function(_){if(h.props[y]){var D;h._notifying=!0;for(var j=arguments.length,N=new Array(j>1?j-1:0),S=1;S<j;S++)N[S-1]=arguments[S];(D=h.props)[y].apply(D,[_].concat(N)),h._notifying=!1}h.unmounted||h.setState(function(E){var A,T=E.values;return{values:Xe(Object.create(null),T,(A={},A[v]=_,A))}})};h.handlers[y]=b}),r.length&&(h.attachRef=function(v){h.inner=v});var g=Object.create(null);return i.forEach(function(v){g[v]=h.props[R0(v)]}),h.state={values:g,prevProps:{}},h}var f=d.prototype;return f.shouldComponentUpdate=function(){return!this._notifying},d.getDerivedStateFromProps=function(m,x){var p=x.values,g=x.prevProps,v={values:Xe(Object.create(null),p),prevProps:{}};return i.forEach(function(y){v.prevProps[y]=m[y],!U6(m,y)&&U6(g,y)&&(v.values[y]=m[R0(y)])}),v},f.componentWillUnmount=function(){this.unmounted=!0},f.render=function(){var m=this,x=this.props,p=x.innerRef,g=_l(x,["innerRef"]);s.forEach(function(y){delete g[y]});var v={};return i.forEach(function(y){var b=m.props[y];v[y]=b!==void 0?b:m.state.values[y]}),Q.createElement(e,Xe({},g,v,this.handlers,{ref:p||this.attachRef}))},d}(Q.Component);_ze(l),l.displayName="Uncontrolled("+n+")",l.propTypes=Xe({innerRef:function(){}},bze(t)),r.forEach(function(u){l.prototype[u]=function(){var f;return(f=this.inner)[u].apply(f,arguments)}});var c=l;return Q.forwardRef&&(c=Q.forwardRef(function(u,d){return Q.createElement(l,Xe({},u,{innerRef:d,__source:{fileName:Dze,lineNumber:128},__self:this}))}),c.propTypes=l.propTypes),c.ControlledComponent=e,c.deferControlTo=function(u,d,f){return d===void 0&&(d={}),kH(u,Xe({},t,d),f)},c}var Pv="milliseconds",hp="seconds",mp="minutes",pp="hours",Jc="day",Kd="week",xp="month",Qc="year",eu="decade",tu="century",CH={milliseconds:1,seconds:1e3,minutes:60*1e3,hours:60*60*1e3,day:24*60*60*1e3,week:7*24*60*60*1e3},jze={month:1,year:12,decade:10*12,century:100*12};function Nze(e){return[31,Sze(e),31,30,31,30,31,31,30,31,30,31]}function Sze(e){return e%4===0&&e%100!==0||e%400===0?29:28}function hs(e,t,r){switch(e=new Date(e),r){case Pv:case hp:case mp:case pp:case Jc:case Kd:return Eze(e,t*CH[r]);case xp:case Qc:case eu:case tu:return Tze(e,t*jze[r])}throw new TypeError('Invalid units: "'+r+'"')}function Eze(e,t){var r=new Date(+e+t);return kze(e,r)}function Tze(e,t){var r=e.getFullYear(),n=e.getMonth(),a=e.getDate(),i=r*12+n+t,s=Math.trunc(i/12),l=i%12,c=Math.min(a,Nze(s)[l]),u=new Date(e);return u.setFullYear(s),u.setDate(1),u.setMonth(l),u.setDate(c),u}function kze(e,t){var r=e.getTimezoneOffset(),n=t.getTimezoneOffset(),a=n-r;return new Date(+t+a*CH.minutes)}function gp(e,t,r){return hs(e,-t,r)}function Un(e,t,r){switch(e=new Date(e),t){case tu:case eu:case Qc:e=Rv(e,0);case xp:e=IH(e,1);case Kd:case Jc:e=bp(e,0);case pp:e=Zd(e,0);case mp:e=yp(e,0);case hp:e=vp(e,0)}return t===eu&&(e=gp(e,ru(e)%10,"year")),t===tu&&(e=gp(e,ru(e)%100,"year")),t===Kd&&(e=RH(e,0,r)),e}function Iv(e,t,r){switch(e=new Date(e),e=Un(e,t,r),t){case tu:case eu:case Qc:case xp:case Kd:e=hs(e,1,t),e=gp(e,1,Jc),e.setHours(23,59,59,999);break;case Jc:e.setHours(23,59,59,999);break;case pp:case mp:case hp:e=hs(e,1,t),e=gp(e,1,Pv)}return e}var bx=Mf(function(e,t){return e===t}),ak=Mf(function(e,t){return e!==t}),b1=Mf(function(e,t){return e>t}),wx=Mf(function(e,t){return e>=t}),ik=Mf(function(e,t){return e<t}),Rf=Mf(function(e,t){return e<=t});function AH(){return new Date(Math.min.apply(Math,arguments))}function OH(){return new Date(Math.max.apply(Math,arguments))}function FH(e,t,r,n){return n=n||"day",(!t||wx(e,t,n))&&(!r||Rf(e,r,n))}var vp=Zl("Milliseconds"),yp=Zl("Seconds"),Zd=Zl("Minutes"),bp=Zl("Hours"),PH=Zl("Day"),IH=Zl("Date"),Rv=Zl("Month"),ru=Zl("FullYear");function Cze(e,t){return t===void 0?ru(Un(e,eu)):hs(e,t+10,Qc)}function Aze(e,t){return t===void 0?ru(Un(e,tu)):hs(e,t+100,Qc)}function RH(e,t,r){var n=(PH(e)+7-(r||0))%7;return t===void 0?n:hs(e,t-n,Jc)}function Oze(e,t,r,n){var a,i,s;switch(r){case Pv:case hp:case mp:case pp:case Jc:case Kd:a=t.getTime()-e.getTime();break;case xp:case Qc:case eu:case tu:a=(ru(t)-ru(e))*12+Rv(t)-Rv(e);break;default:throw new TypeError('Invalid units: "'+r+'"')}switch(r){case Pv:i=1;break;case hp:i=1e3;break;case mp:i=1e3*60;break;case pp:i=1e3*60*60;break;case Jc:i=1e3*60*60*24;break;case Kd:i=1e3*60*60*24*7;break;case xp:i=1;break;case Qc:i=12;break;case eu:i=120;break;case tu:i=1200;break;default:throw new TypeError('Invalid units: "'+r+'"')}return s=a/i,n?s:Math.round(s)}function Zl(e){var t=function(r){switch(r){case"Milliseconds":return 36e5;case"Seconds":return 3600;case"Minutes":return 60;case"Hours":return 1;default:return null}}(e);return function(r,n){if(n===void 0)return r["get"+e]();var a=new Date(r);return a["set"+e](n),t&&a["get"+e]()!=n&&(e==="Hours"||n>=t&&a.getHours()-r.getHours()<Math.floor(n/t))&&a["set"+e](n+t),a}}function Mf(e){return function(t,r,n){return e(+Un(t,n),+Un(r,n))}}const $6=Object.freeze(Object.defineProperty({__proto__:null,add:hs,century:Aze,date:IH,day:PH,decade:Cze,diff:Oze,endOf:Iv,eq:bx,gt:b1,gte:wx,hours:bp,inRange:FH,lt:ik,lte:Rf,max:OH,milliseconds:vp,min:AH,minutes:Zd,month:Rv,neq:ak,seconds:yp,startOf:Un,subtract:gp,weekday:RH,year:ru},Symbol.toStringTag,{value:"Module"}));function Fze(e){if(Array.isArray(e))return kj(e)}function MH(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Pze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M0(e){return Fze(e)||MH(e)||nk(e)||Pze()}var Ize=$N,Rze=bf,Mze=U$,Uze=Math.ceil,$ze=Math.max;function Lze(e,t,r){(r?Rze(e,t,r):t===void 0)?t=1:t=$ze(Mze(t),0);var n=e==null?0:e.length;if(!n||t<1)return[];for(var a=0,i=0,s=Array(Uze(n/t));a<n;)s[i++]=Ize(e,a,a+=t);return s}var Bze=Lze;const Wze=At(Bze);function _x(e){return e&&e.ownerDocument||document}function zze(e){var t=_x(e);return t&&t.defaultView||window}function Hze(e,t){return zze(e).getComputedStyle(e,t)}var Vze=/([A-Z])/g;function qze(e){return e.replace(Vze,"-$1").toLowerCase()}var Gze=/^ms-/;function b0(e){return qze(e).replace(Gze,"-ms-")}var Yze=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function Xze(e){return!!(e&&Yze.test(e))}function $u(e,t){var r="",n="";if(typeof t=="string")return e.style.getPropertyValue(b0(t))||Hze(e).getPropertyValue(b0(t));Object.keys(t).forEach(function(a){var i=t[a];!i&&i!==0?e.style.removeProperty(b0(a)):Xze(a)?n+=a+"("+i+") ":r+=b0(a)+": "+i+";"}),n&&(r+="transform: "+n+";"),e.style.cssText+=";"+r}function wp(e,t){if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return e===t||!!(e.compareDocumentPosition(t)&16)}function Kze(e){return"nodeType"in e&&e.nodeType===document.DOCUMENT_NODE}function sk(e){return"window"in e&&e.window===e?e:Kze(e)&&e.defaultView||!1}function UH(e){var t=e==="pageXOffset"?"scrollLeft":"scrollTop";function r(n,a){var i=sk(n);if(a===void 0)return i?i[e]:n[t];i?i.scrollTo(i[e],a):n[t]=a}return r}const $H=UH("pageXOffset"),LH=UH("pageYOffset");function Fc(e){var t=_x(e),r={top:0,left:0,height:0,width:0},n=t&&t.documentElement;return!n||!wp(n,e)||(e.getBoundingClientRect!==void 0&&(r=e.getBoundingClientRect()),r={top:r.top+LH(n)-(n.clientTop||0),left:r.left+$H(n)-(n.clientLeft||0),width:r.width,height:r.height}),r}var Zze=function(t){return!!t&&"offsetParent"in t};function Jze(e){for(var t=_x(e),r=e&&e.offsetParent;Zze(r)&&r.nodeName!=="HTML"&&$u(r,"position")==="static";)r=r.offsetParent;return r||t.documentElement}var Qze=function(t){return t.nodeName&&t.nodeName.toLowerCase()};function BH(e,t){var r={top:0,left:0},n;if($u(e,"position")==="fixed")n=e.getBoundingClientRect();else{var a=t||Jze(e);n=Fc(e),Qze(a)!=="html"&&(r=Fc(a));var i=String($u(a,"borderTopWidth")||0);r.top+=parseInt(i,10)-LH(a)||0;var s=String($u(a,"borderLeftWidth")||0);r.left+=parseInt(s,10)-$H(a)||0}var l=String($u(e,"marginTop")||0),c=String($u(e,"marginLeft")||0);return Xe({},n,{top:n.top-r.top-(parseInt(l,10)||0),left:n.left-r.left-(parseInt(c,10)||0)})}const ok=!!(typeof window<"u"&&window.document&&window.document.createElement);var L6=new Date().getTime();function eHe(e){var t=new Date().getTime(),r=Math.max(0,16-(t-L6)),n=setTimeout(e,r);return L6=t,n}var tHe=["","webkit","moz","o","ms"],Cj="clearTimeout",Aj=eHe,B6=function(t,r){return t+(t?r[0].toUpperCase()+r.substr(1):r)+"AnimationFrame"};ok&&tHe.some(function(e){var t=B6(e,"request");return t in window&&(Cj=B6(e,"cancel"),Aj=function(n){return window[t](n)}),!!Aj});var W6=function(t){typeof window[Cj]=="function"&&window[Cj](t)},WH=Aj,a_;function rHe(e,t){if(!a_){var r=document.body,n=r.matches||r.matchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector;a_=function(i,s){return n.call(i,s)}}return a_(e,t)}var nHe=Function.prototype.bind.call(Function.prototype.call,[].slice);function aHe(e,t){return nHe(e.querySelectorAll(t))}var Oj=!1,Fj=!1;try{var i_={get passive(){return Oj=!0},get once(){return Fj=Oj=!0}};ok&&(window.addEventListener("test",i_,i_),window.removeEventListener("test",i_,!0))}catch{}function iHe(e,t,r,n){if(n&&typeof n!="boolean"&&!Fj){var a=n.once,i=n.capture,s=r;!Fj&&a&&(s=r.__once||function l(c){this.removeEventListener(t,l,i),r.call(this,c)},r.__once=s),e.addEventListener(t,s,Oj?n:i)}e.addEventListener(t,r,n)}function sHe(e){const t=M.useRef(e);return M.useEffect(()=>{t.current=e},[e]),t}function z6(e){const t=sHe(e);return M.useCallback(function(...r){return t.current&&t.current(...r)},[t])}function H6(){return M.useState(null)}function oHe(){const e=M.useRef(!0),t=M.useRef(()=>e.current);return M.useEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),t.current}function lHe(e){const t=oHe();return[e[0],M.useCallback(r=>{if(t())return e[1](r)},[t,e[1]])]}var Pa="top",Wi="bottom",zi="right",Ia="left",lk="auto",Dx=[Pa,Wi,zi,Ia],Jd="start",_p="end",cHe="clippingParents",zH="viewport",ph="popper",uHe="reference",V6=Dx.reduce(function(e,t){return e.concat([t+"-"+Jd,t+"-"+_p])},[]),ck=[].concat(Dx,[lk]).reduce(function(e,t){return e.concat([t,t+"-"+Jd,t+"-"+_p])},[]),dHe="beforeRead",fHe="read",hHe="afterRead",mHe="beforeMain",pHe="main",xHe="afterMain",gHe="beforeWrite",vHe="write",yHe="afterWrite",bHe=[dHe,fHe,hHe,mHe,pHe,xHe,gHe,vHe,yHe];function Bs(e){return e.split("-")[0]}function ci(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function nu(e){var t=ci(e).Element;return e instanceof t||e instanceof Element}function Ws(e){var t=ci(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function uk(e){if(typeof ShadowRoot>"u")return!1;var t=ci(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}var Pc=Math.max,Mv=Math.min,Qd=Math.round;function Pj(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function HH(){return!/^((?!chrome|android).)*safari/i.test(Pj())}function ef(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!1);var n=e.getBoundingClientRect(),a=1,i=1;t&&Ws(e)&&(a=e.offsetWidth>0&&Qd(n.width)/e.offsetWidth||1,i=e.offsetHeight>0&&Qd(n.height)/e.offsetHeight||1);var s=nu(e)?ci(e):window,l=s.visualViewport,c=!HH()&&r,u=(n.left+(c&&l?l.offsetLeft:0))/a,d=(n.top+(c&&l?l.offsetTop:0))/i,f=n.width/a,h=n.height/i;return{width:f,height:h,top:d,right:u+f,bottom:d+h,left:u,x:u,y:d}}function dk(e){var t=ef(e),r=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:n}}function VH(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&uk(r)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function Fl(e){return e?(e.nodeName||"").toLowerCase():null}function Lo(e){return ci(e).getComputedStyle(e)}function wHe(e){return["table","td","th"].indexOf(Fl(e))>=0}function Jl(e){return((nu(e)?e.ownerDocument:e.document)||window.document).documentElement}function w1(e){return Fl(e)==="html"?e:e.assignedSlot||e.parentNode||(uk(e)?e.host:null)||Jl(e)}function q6(e){return!Ws(e)||Lo(e).position==="fixed"?null:e.offsetParent}function _He(e){var t=/firefox/i.test(Pj()),r=/Trident/i.test(Pj());if(r&&Ws(e)){var n=Lo(e);if(n.position==="fixed")return null}var a=w1(e);for(uk(a)&&(a=a.host);Ws(a)&&["html","body"].indexOf(Fl(a))<0;){var i=Lo(a);if(i.transform!=="none"||i.perspective!=="none"||i.contain==="paint"||["transform","perspective"].indexOf(i.willChange)!==-1||t&&i.willChange==="filter"||t&&i.filter&&i.filter!=="none")return a;a=a.parentNode}return null}function jx(e){for(var t=ci(e),r=q6(e);r&&wHe(r)&&Lo(r).position==="static";)r=q6(r);return r&&(Fl(r)==="html"||Fl(r)==="body"&&Lo(r).position==="static")?t:r||_He(e)||t}function fk(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function zh(e,t,r){return Pc(e,Mv(t,r))}function DHe(e,t,r){var n=zh(e,t,r);return n>r?r:n}function qH(){return{top:0,right:0,bottom:0,left:0}}function GH(e){return Object.assign({},qH(),e)}function YH(e,t){return t.reduce(function(r,n){return r[n]=e,r},{})}var jHe=function(t,r){return t=typeof t=="function"?t(Object.assign({},r.rects,{placement:r.placement})):t,GH(typeof t!="number"?t:YH(t,Dx))};function NHe(e){var t,r=e.state,n=e.name,a=e.options,i=r.elements.arrow,s=r.modifiersData.popperOffsets,l=Bs(r.placement),c=fk(l),u=[Ia,zi].indexOf(l)>=0,d=u?"height":"width";if(!(!i||!s)){var f=jHe(a.padding,r),h=dk(i),m=c==="y"?Pa:Ia,x=c==="y"?Wi:zi,p=r.rects.reference[d]+r.rects.reference[c]-s[c]-r.rects.popper[d],g=s[c]-r.rects.reference[c],v=jx(i),y=v?c==="y"?v.clientHeight||0:v.clientWidth||0:0,b=p/2-g/2,w=f[m],_=y-h[d]-f[x],D=y/2-h[d]/2+b,j=zh(w,D,_),N=c;r.modifiersData[n]=(t={},t[N]=j,t.centerOffset=j-D,t)}}function SHe(e){var t=e.state,r=e.options,n=r.element,a=n===void 0?"[data-popper-arrow]":n;a!=null&&(typeof a=="string"&&(a=t.elements.popper.querySelector(a),!a)||VH(t.elements.popper,a)&&(t.elements.arrow=a))}const EHe={name:"arrow",enabled:!0,phase:"main",fn:NHe,effect:SHe,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function tf(e){return e.split("-")[1]}var THe={top:"auto",right:"auto",bottom:"auto",left:"auto"};function kHe(e,t){var r=e.x,n=e.y,a=t.devicePixelRatio||1;return{x:Qd(r*a)/a||0,y:Qd(n*a)/a||0}}function G6(e){var t,r=e.popper,n=e.popperRect,a=e.placement,i=e.variation,s=e.offsets,l=e.position,c=e.gpuAcceleration,u=e.adaptive,d=e.roundOffsets,f=e.isFixed,h=s.x,m=h===void 0?0:h,x=s.y,p=x===void 0?0:x,g=typeof d=="function"?d({x:m,y:p}):{x:m,y:p};m=g.x,p=g.y;var v=s.hasOwnProperty("x"),y=s.hasOwnProperty("y"),b=Ia,w=Pa,_=window;if(u){var D=jx(r),j="clientHeight",N="clientWidth";if(D===ci(r)&&(D=Jl(r),Lo(D).position!=="static"&&l==="absolute"&&(j="scrollHeight",N="scrollWidth")),D=D,a===Pa||(a===Ia||a===zi)&&i===_p){w=Wi;var S=f&&D===_&&_.visualViewport?_.visualViewport.height:D[j];p-=S-n.height,p*=c?1:-1}if(a===Ia||(a===Pa||a===Wi)&&i===_p){b=zi;var E=f&&D===_&&_.visualViewport?_.visualViewport.width:D[N];m-=E-n.width,m*=c?1:-1}}var A=Object.assign({position:l},u&&THe),T=d===!0?kHe({x:m,y:p},ci(r)):{x:m,y:p};if(m=T.x,p=T.y,c){var L;return Object.assign({},A,(L={},L[w]=y?"0":"",L[b]=v?"0":"",L.transform=(_.devicePixelRatio||1)<=1?"translate("+m+"px, "+p+"px)":"translate3d("+m+"px, "+p+"px, 0)",L))}return Object.assign({},A,(t={},t[w]=y?p+"px":"",t[b]=v?m+"px":"",t.transform="",t))}function CHe(e){var t=e.state,r=e.options,n=r.gpuAcceleration,a=n===void 0?!0:n,i=r.adaptive,s=i===void 0?!0:i,l=r.roundOffsets,c=l===void 0?!0:l,u={placement:Bs(t.placement),variation:tf(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:a,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,G6(Object.assign({},u,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:s,roundOffsets:c})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,G6(Object.assign({},u,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const AHe={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:CHe,data:{}};var w0={passive:!0};function OHe(e){var t=e.state,r=e.instance,n=e.options,a=n.scroll,i=a===void 0?!0:a,s=n.resize,l=s===void 0?!0:s,c=ci(t.elements.popper),u=[].concat(t.scrollParents.reference,t.scrollParents.popper);return i&&u.forEach(function(d){d.addEventListener("scroll",r.update,w0)}),l&&c.addEventListener("resize",r.update,w0),function(){i&&u.forEach(function(d){d.removeEventListener("scroll",r.update,w0)}),l&&c.removeEventListener("resize",r.update,w0)}}const FHe={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:OHe,data:{}};var PHe={left:"right",right:"left",bottom:"top",top:"bottom"};function U0(e){return e.replace(/left|right|bottom|top/g,function(t){return PHe[t]})}var IHe={start:"end",end:"start"};function Y6(e){return e.replace(/start|end/g,function(t){return IHe[t]})}function hk(e){var t=ci(e),r=t.pageXOffset,n=t.pageYOffset;return{scrollLeft:r,scrollTop:n}}function mk(e){return ef(Jl(e)).left+hk(e).scrollLeft}function RHe(e,t){var r=ci(e),n=Jl(e),a=r.visualViewport,i=n.clientWidth,s=n.clientHeight,l=0,c=0;if(a){i=a.width,s=a.height;var u=HH();(u||!u&&t==="fixed")&&(l=a.offsetLeft,c=a.offsetTop)}return{width:i,height:s,x:l+mk(e),y:c}}function MHe(e){var t,r=Jl(e),n=hk(e),a=(t=e.ownerDocument)==null?void 0:t.body,i=Pc(r.scrollWidth,r.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),s=Pc(r.scrollHeight,r.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),l=-n.scrollLeft+mk(e),c=-n.scrollTop;return Lo(a||r).direction==="rtl"&&(l+=Pc(r.clientWidth,a?a.clientWidth:0)-i),{width:i,height:s,x:l,y:c}}function pk(e){var t=Lo(e),r=t.overflow,n=t.overflowX,a=t.overflowY;return/auto|scroll|overlay|hidden/.test(r+a+n)}function XH(e){return["html","body","#document"].indexOf(Fl(e))>=0?e.ownerDocument.body:Ws(e)&&pk(e)?e:XH(w1(e))}function Hh(e,t){var r;t===void 0&&(t=[]);var n=XH(e),a=n===((r=e.ownerDocument)==null?void 0:r.body),i=ci(n),s=a?[i].concat(i.visualViewport||[],pk(n)?n:[]):n,l=t.concat(s);return a?l:l.concat(Hh(w1(s)))}function Ij(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function UHe(e,t){var r=ef(e,!1,t==="fixed");return r.top=r.top+e.clientTop,r.left=r.left+e.clientLeft,r.bottom=r.top+e.clientHeight,r.right=r.left+e.clientWidth,r.width=e.clientWidth,r.height=e.clientHeight,r.x=r.left,r.y=r.top,r}function X6(e,t,r){return t===zH?Ij(RHe(e,r)):nu(t)?UHe(t,r):Ij(MHe(Jl(e)))}function $He(e){var t=Hh(w1(e)),r=["absolute","fixed"].indexOf(Lo(e).position)>=0,n=r&&Ws(e)?jx(e):e;return nu(n)?t.filter(function(a){return nu(a)&&VH(a,n)&&Fl(a)!=="body"}):[]}function LHe(e,t,r,n){var a=t==="clippingParents"?$He(e):[].concat(t),i=[].concat(a,[r]),s=i[0],l=i.reduce(function(c,u){var d=X6(e,u,n);return c.top=Pc(d.top,c.top),c.right=Mv(d.right,c.right),c.bottom=Mv(d.bottom,c.bottom),c.left=Pc(d.left,c.left),c},X6(e,s,n));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function KH(e){var t=e.reference,r=e.element,n=e.placement,a=n?Bs(n):null,i=n?tf(n):null,s=t.x+t.width/2-r.width/2,l=t.y+t.height/2-r.height/2,c;switch(a){case Pa:c={x:s,y:t.y-r.height};break;case Wi:c={x:s,y:t.y+t.height};break;case zi:c={x:t.x+t.width,y:l};break;case Ia:c={x:t.x-r.width,y:l};break;default:c={x:t.x,y:t.y}}var u=a?fk(a):null;if(u!=null){var d=u==="y"?"height":"width";switch(i){case Jd:c[u]=c[u]-(t[d]/2-r[d]/2);break;case _p:c[u]=c[u]+(t[d]/2-r[d]/2);break}}return c}function Dp(e,t){t===void 0&&(t={});var r=t,n=r.placement,a=n===void 0?e.placement:n,i=r.strategy,s=i===void 0?e.strategy:i,l=r.boundary,c=l===void 0?cHe:l,u=r.rootBoundary,d=u===void 0?zH:u,f=r.elementContext,h=f===void 0?ph:f,m=r.altBoundary,x=m===void 0?!1:m,p=r.padding,g=p===void 0?0:p,v=GH(typeof g!="number"?g:YH(g,Dx)),y=h===ph?uHe:ph,b=e.rects.popper,w=e.elements[x?y:h],_=LHe(nu(w)?w:w.contextElement||Jl(e.elements.popper),c,d,s),D=ef(e.elements.reference),j=KH({reference:D,element:b,placement:a}),N=Ij(Object.assign({},b,j)),S=h===ph?N:D,E={top:_.top-S.top+v.top,bottom:S.bottom-_.bottom+v.bottom,left:_.left-S.left+v.left,right:S.right-_.right+v.right},A=e.modifiersData.offset;if(h===ph&&A){var T=A[a];Object.keys(E).forEach(function(L){var O=[zi,Wi].indexOf(L)>=0?1:-1,V=[Pa,Wi].indexOf(L)>=0?"y":"x";E[L]+=T[V]*O})}return E}function BHe(e,t){t===void 0&&(t={});var r=t,n=r.placement,a=r.boundary,i=r.rootBoundary,s=r.padding,l=r.flipVariations,c=r.allowedAutoPlacements,u=c===void 0?ck:c,d=tf(n),f=d?l?V6:V6.filter(function(x){return tf(x)===d}):Dx,h=f.filter(function(x){return u.indexOf(x)>=0});h.length===0&&(h=f);var m=h.reduce(function(x,p){return x[p]=Dp(e,{placement:p,boundary:a,rootBoundary:i,padding:s})[Bs(p)],x},{});return Object.keys(m).sort(function(x,p){return m[x]-m[p]})}function WHe(e){if(Bs(e)===lk)return[];var t=U0(e);return[Y6(e),t,Y6(t)]}function zHe(e){var t=e.state,r=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var a=r.mainAxis,i=a===void 0?!0:a,s=r.altAxis,l=s===void 0?!0:s,c=r.fallbackPlacements,u=r.padding,d=r.boundary,f=r.rootBoundary,h=r.altBoundary,m=r.flipVariations,x=m===void 0?!0:m,p=r.allowedAutoPlacements,g=t.options.placement,v=Bs(g),y=v===g,b=c||(y||!x?[U0(g)]:WHe(g)),w=[g].concat(b).reduce(function(z,q){return z.concat(Bs(q)===lk?BHe(t,{placement:q,boundary:d,rootBoundary:f,padding:u,flipVariations:x,allowedAutoPlacements:p}):q)},[]),_=t.rects.reference,D=t.rects.popper,j=new Map,N=!0,S=w[0],E=0;E<w.length;E++){var A=w[E],T=Bs(A),L=tf(A)===Jd,O=[Pa,Wi].indexOf(T)>=0,V=O?"width":"height",W=Dp(t,{placement:A,boundary:d,rootBoundary:f,altBoundary:h,padding:u}),B=O?L?zi:Ia:L?Wi:Pa;_[V]>D[V]&&(B=U0(B));var P=U0(B),F=[];if(i&&F.push(W[T]<=0),l&&F.push(W[B]<=0,W[P]<=0),F.every(function(z){return z})){S=A,N=!1;break}j.set(A,F)}if(N)for(var I=x?3:1,R=function(q){var K=w.find(function(se){var ie=j.get(se);if(ie)return ie.slice(0,q).every(function(ee){return ee})});if(K)return S=K,"break"},C=I;C>0;C--){var k=R(C);if(k==="break")break}t.placement!==S&&(t.modifiersData[n]._skip=!0,t.placement=S,t.reset=!0)}}const HHe={name:"flip",enabled:!0,phase:"main",fn:zHe,requiresIfExists:["offset"],data:{_skip:!1}};function K6(e,t,r){return r===void 0&&(r={x:0,y:0}),{top:e.top-t.height-r.y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function Z6(e){return[Pa,zi,Wi,Ia].some(function(t){return e[t]>=0})}function VHe(e){var t=e.state,r=e.name,n=t.rects.reference,a=t.rects.popper,i=t.modifiersData.preventOverflow,s=Dp(t,{elementContext:"reference"}),l=Dp(t,{altBoundary:!0}),c=K6(s,n),u=K6(l,a,i),d=Z6(c),f=Z6(u);t.modifiersData[r]={referenceClippingOffsets:c,popperEscapeOffsets:u,isReferenceHidden:d,hasPopperEscaped:f},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":f})}const qHe={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:VHe};function GHe(e,t,r){var n=Bs(e),a=[Ia,Pa].indexOf(n)>=0?-1:1,i=typeof r=="function"?r(Object.assign({},t,{placement:e})):r,s=i[0],l=i[1];return s=s||0,l=(l||0)*a,[Ia,zi].indexOf(n)>=0?{x:l,y:s}:{x:s,y:l}}function YHe(e){var t=e.state,r=e.options,n=e.name,a=r.offset,i=a===void 0?[0,0]:a,s=ck.reduce(function(d,f){return d[f]=GHe(f,t.rects,i),d},{}),l=s[t.placement],c=l.x,u=l.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=c,t.modifiersData.popperOffsets.y+=u),t.modifiersData[n]=s}const XHe={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:YHe};function KHe(e){var t=e.state,r=e.name;t.modifiersData[r]=KH({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}const ZHe={name:"popperOffsets",enabled:!0,phase:"read",fn:KHe,data:{}};function JHe(e){return e==="x"?"y":"x"}function QHe(e){var t=e.state,r=e.options,n=e.name,a=r.mainAxis,i=a===void 0?!0:a,s=r.altAxis,l=s===void 0?!1:s,c=r.boundary,u=r.rootBoundary,d=r.altBoundary,f=r.padding,h=r.tether,m=h===void 0?!0:h,x=r.tetherOffset,p=x===void 0?0:x,g=Dp(t,{boundary:c,rootBoundary:u,padding:f,altBoundary:d}),v=Bs(t.placement),y=tf(t.placement),b=!y,w=fk(v),_=JHe(w),D=t.modifiersData.popperOffsets,j=t.rects.reference,N=t.rects.popper,S=typeof p=="function"?p(Object.assign({},t.rects,{placement:t.placement})):p,E=typeof S=="number"?{mainAxis:S,altAxis:S}:Object.assign({mainAxis:0,altAxis:0},S),A=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,T={x:0,y:0};if(D){if(i){var L,O=w==="y"?Pa:Ia,V=w==="y"?Wi:zi,W=w==="y"?"height":"width",B=D[w],P=B+g[O],F=B-g[V],I=m?-N[W]/2:0,R=y===Jd?j[W]:N[W],C=y===Jd?-N[W]:-j[W],k=t.elements.arrow,z=m&&k?dk(k):{width:0,height:0},q=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:qH(),K=q[O],se=q[V],ie=zh(0,j[W],z[W]),ee=b?j[W]/2-I-ie-K-E.mainAxis:R-ie-K-E.mainAxis,ae=b?-j[W]/2+I+ie+se+E.mainAxis:C+ie+se+E.mainAxis,pe=t.elements.arrow&&jx(t.elements.arrow),H=pe?w==="y"?pe.clientTop||0:pe.clientLeft||0:0,ne=(L=A==null?void 0:A[w])!=null?L:0,U=B+ee-ne-H,le=B+ae-ne,re=zh(m?Mv(P,U):P,B,m?Pc(F,le):F);D[w]=re,T[w]=re-B}if(l){var X,G=w==="x"?Pa:Ia,ce=w==="x"?Wi:zi,J=D[_],ue=_==="y"?"height":"width",me=J+g[G],te=J-g[ce],oe=[Pa,Ia].indexOf(v)!==-1,ge=(X=A==null?void 0:A[_])!=null?X:0,ye=oe?me:J-j[ue]-N[ue]-ge+E.altAxis,Ce=oe?J+j[ue]+N[ue]-ge-E.altAxis:te,Ie=m&&oe?DHe(ye,J,Ce):zh(m?ye:me,J,m?Ce:te);D[_]=Ie,T[_]=Ie-J}t.modifiersData[n]=T}}const eVe={name:"preventOverflow",enabled:!0,phase:"main",fn:QHe,requiresIfExists:["offset"]};function tVe(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function rVe(e){return e===ci(e)||!Ws(e)?hk(e):tVe(e)}function nVe(e){var t=e.getBoundingClientRect(),r=Qd(t.width)/e.offsetWidth||1,n=Qd(t.height)/e.offsetHeight||1;return r!==1||n!==1}function aVe(e,t,r){r===void 0&&(r=!1);var n=Ws(t),a=Ws(t)&&nVe(t),i=Jl(t),s=ef(e,a,r),l={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(n||!n&&!r)&&((Fl(t)!=="body"||pk(i))&&(l=rVe(t)),Ws(t)?(c=ef(t,!0),c.x+=t.clientLeft,c.y+=t.clientTop):i&&(c.x=mk(i))),{x:s.left+l.scrollLeft-c.x,y:s.top+l.scrollTop-c.y,width:s.width,height:s.height}}function iVe(e){var t=new Map,r=new Set,n=[];e.forEach(function(i){t.set(i.name,i)});function a(i){r.add(i.name);var s=[].concat(i.requires||[],i.requiresIfExists||[]);s.forEach(function(l){if(!r.has(l)){var c=t.get(l);c&&a(c)}}),n.push(i)}return e.forEach(function(i){r.has(i.name)||a(i)}),n}function sVe(e){var t=iVe(e);return bHe.reduce(function(r,n){return r.concat(t.filter(function(a){return a.phase===n}))},[])}function oVe(e){var t;return function(){return t||(t=new Promise(function(r){Promise.resolve().then(function(){t=void 0,r(e())})})),t}}function lVe(e){var t=e.reduce(function(r,n){var a=r[n.name];return r[n.name]=a?Object.assign({},a,n,{options:Object.assign({},a.options,n.options),data:Object.assign({},a.data,n.data)}):n,r},{});return Object.keys(t).map(function(r){return t[r]})}var J6={placement:"bottom",modifiers:[],strategy:"absolute"};function Q6(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function cVe(e){e===void 0&&(e={});var t=e,r=t.defaultModifiers,n=r===void 0?[]:r,a=t.defaultOptions,i=a===void 0?J6:a;return function(l,c,u){u===void 0&&(u=i);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},J6,i),modifiersData:{},elements:{reference:l,popper:c},attributes:{},styles:{}},f=[],h=!1,m={state:d,setOptions:function(v){var y=typeof v=="function"?v(d.options):v;p(),d.options=Object.assign({},i,d.options,y),d.scrollParents={reference:nu(l)?Hh(l):l.contextElement?Hh(l.contextElement):[],popper:Hh(c)};var b=sVe(lVe([].concat(n,d.options.modifiers)));return d.orderedModifiers=b.filter(function(w){return w.enabled}),x(),m.update()},forceUpdate:function(){if(!h){var v=d.elements,y=v.reference,b=v.popper;if(Q6(y,b)){d.rects={reference:aVe(y,jx(b),d.options.strategy==="fixed"),popper:dk(b)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(E){return d.modifiersData[E.name]=Object.assign({},E.data)});for(var w=0;w<d.orderedModifiers.length;w++){if(d.reset===!0){d.reset=!1,w=-1;continue}var _=d.orderedModifiers[w],D=_.fn,j=_.options,N=j===void 0?{}:j,S=_.name;typeof D=="function"&&(d=D({state:d,options:N,name:S,instance:m})||d)}}}},update:oVe(function(){return new Promise(function(g){m.forceUpdate(),g(d)})}),destroy:function(){p(),h=!0}};if(!Q6(l,c))return m;m.setOptions(u).then(function(g){!h&&u.onFirstUpdate&&u.onFirstUpdate(g)});function x(){d.orderedModifiers.forEach(function(g){var v=g.name,y=g.options,b=y===void 0?{}:y,w=g.effect;if(typeof w=="function"){var _=w({state:d,name:v,instance:m,options:b}),D=function(){};f.push(_||D)}})}function p(){f.forEach(function(g){return g()}),f=[]}return m}}var uVe=cVe({defaultModifiers:[qHe,ZHe,AHe,FHe,XHe,HHe,eVe,EHe]}),e8=function(t){return{position:t,top:"0",left:"0",opacity:"0",pointerEvents:"none"}},dVe={name:"applyStyles",enabled:!1},fVe={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:function(t){var r=t.state;return function(){var n=r.elements,a=n.reference,i=n.popper;if("removeAttribute"in a){var s=(a.getAttribute("aria-describedby")||"").split(",").filter(function(l){return l.trim()!==i.id});s.length?a.setAttribute("aria-describedby",s.join(",")):a.removeAttribute("aria-describedby")}}},fn:function(t){var r,n=t.state,a=n.elements,i=a.popper,s=a.reference,l=(r=i.getAttribute("role"))==null?void 0:r.toLowerCase();if(i.id&&l==="tooltip"&&"setAttribute"in s){var c=s.getAttribute("aria-describedby");if(c&&c.split(",").indexOf(i.id)!==-1)return;s.setAttribute("aria-describedby",c?c+","+i.id:i.id)}}},hVe=[];function mVe(e,t,r){var n=r===void 0?{}:r,a=n.enabled,i=a===void 0?!0:a,s=n.placement,l=s===void 0?"bottom":s,c=n.strategy,u=c===void 0?"absolute":c,d=n.modifiers,f=d===void 0?hVe:d,h=_l(n,["enabled","placement","strategy","modifiers"]),m=M.useRef(),x=M.useCallback(function(){var w;(w=m.current)==null||w.update()},[]),p=M.useCallback(function(){var w;(w=m.current)==null||w.forceUpdate()},[]),g=lHe(M.useState({placement:l,update:x,forceUpdate:p,attributes:{},styles:{popper:e8(u),arrow:{}}})),v=g[0],y=g[1],b=M.useMemo(function(){return{name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:function(_){var D=_.state,j={},N={};Object.keys(D.elements).forEach(function(S){j[S]=D.styles[S],N[S]=D.attributes[S]}),y({state:D,styles:j,attributes:N,update:x,forceUpdate:p,placement:D.placement})}}},[x,p,y]);return M.useEffect(function(){!m.current||!i||m.current.setOptions({placement:l,strategy:u,modifiers:[].concat(f,[b,dVe])})},[u,l,b,i]),M.useEffect(function(){if(!(!i||e==null||t==null))return m.current=uVe(e,t,Xe({},h,{placement:l,strategy:u,modifiers:[].concat(f,[fVe,b])})),function(){m.current!=null&&(m.current.destroy(),m.current=void 0,y(function(w){return Xe({},w,{attributes:{},styles:{popper:e8(u)}})}))}},[i,e,t]),v}function pVe(e,t,r,n){var a=n&&typeof n!="boolean"?n.capture:n;e.removeEventListener(t,r,a),r.__once&&e.removeEventListener(t,r.__once,a)}function Nh(e,t,r,n){return iHe(e,t,r,n),function(){pVe(e,t,r,n)}}var xVe=function(){},gVe=xVe;const vVe=At(gVe);function yVe(e){return e&&"setState"in e?Yj.findDOMNode(e):e??null}const bVe=function(e){return _x(yVe(e))};var wVe=27,t8=function(){};function _Ve(e){return e.button===0}function DVe(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}var r8=function(t){return t&&("current"in t?t.current:t)};function jVe(e,t,r){var n=r===void 0?{}:r,a=n.disabled,i=n.clickTrigger,s=i===void 0?"click":i,l=M.useRef(!1),c=t||t8,u=M.useCallback(function(h){var m,x=r8(e);vVe(!!x,"RootClose captured a close event but does not have a ref to compare it to. useRootClose(), should be passed a ref that resolves to a DOM node"),l.current=!x||DVe(h)||!_Ve(h)||!!wp(x,(m=h.composedPath==null?void 0:h.composedPath()[0])!=null?m:h.target)},[e]),d=z6(function(h){l.current||c(h)}),f=z6(function(h){h.keyCode===wVe&&c(h)});M.useEffect(function(){if(!(a||e==null)){var h=window.event,m=bVe(r8(e)),x=Nh(m,s,u,!0),p=Nh(m,s,function(y){if(y===h){h=void 0;return}d(y)}),g=Nh(m,"keyup",function(y){if(y===h){h=void 0;return}f(y)}),v=[];return"ontouchstart"in m.documentElement&&(v=[].slice.call(m.body.children).map(function(y){return Nh(y,"mousemove",t8)})),function(){x(),p(),g(),v.forEach(function(y){return y()})}}},[e,a,s,u,d,f])}function NVe(e){var t={};return Array.isArray(e)?(e==null||e.forEach(function(r){t[r.name]=r}),t):e||t}function SVe(e){return e===void 0&&(e={}),Array.isArray(e)?e:Object.keys(e).map(function(t){return e[t].name=t,e[t]})}function EVe(e){var t,r,n,a,i=e.enabled,s=e.enableEvents,l=e.placement,c=e.flip,u=e.offset,d=e.fixed,f=e.containerPadding,h=e.arrowElement,m=e.popperConfig,x=m===void 0?{}:m,p=NVe(x.modifiers);return Xe({},x,{placement:l,enabled:i,strategy:d?"fixed":x.strategy,modifiers:SVe(Xe({},p,{eventListeners:{enabled:s},preventOverflow:Xe({},p.preventOverflow,{options:f?Xe({padding:f},(t=p.preventOverflow)==null?void 0:t.options):(r=p.preventOverflow)==null?void 0:r.options}),offset:{options:Xe({offset:u},(n=p.offset)==null?void 0:n.options)},arrow:Xe({},p.arrow,{enabled:!!h,options:Xe({},(a=p.arrow)==null?void 0:a.options,{element:h})}),flip:Xe({enabled:!!c},p.flip)}))})}var _0;function xk(e){if((!_0&&_0!==0||e)&&ok){var t=document.createElement("div");t.style.position="absolute",t.style.top="-9999px",t.style.width="50px",t.style.height="50px",t.style.overflow="scroll",document.body.appendChild(t),_0=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return _0}var s_=function(t){var r;return typeof document>"u"?null:t==null?_x().body:(typeof t=="function"&&(t=t()),t&&"current"in t&&(t=t.current),(r=t)!=null&&r.nodeType&&t||null)};function n8(e,t){var r=M.useState(function(){return s_(e)}),n=r[0],a=r[1];if(!n){var i=s_(e);i&&a(i)}return M.useEffect(function(){},[t,n]),M.useEffect(function(){var s=s_(e);s!==n&&a(s)},[e,n]),n}const a8=e=>!e||typeof e=="function"?e:t=>{e.current=t};function TVe(e,t){const r=a8(e),n=a8(t);return a=>{r&&r(a),n&&n(a)}}function kVe(e,t){return M.useMemo(()=>TVe(e,t),[e,t])}var gk=Q.forwardRef(function(e,t){var r=e.flip,n=e.offset,a=e.placement,i=e.containerPadding,s=i===void 0?5:i,l=e.popperConfig,c=l===void 0?{}:l,u=e.transition,d=H6(),f=d[0],h=d[1],m=H6(),x=m[0],p=m[1],g=kVe(h,t),v=n8(e.container),y=n8(e.target),b=M.useState(!e.show),w=b[0],_=b[1],D=mVe(y,f,EVe({placement:a,enableEvents:!!e.show,containerPadding:s||5,flip:r,offset:n,arrowElement:x,popperConfig:c})),j=D.styles,N=D.attributes,S=_l(D,["styles","attributes"]);e.show?w&&_(!1):!e.transition&&!w&&_(!0);var E=function(){_(!0),e.onExited&&e.onExited.apply(e,arguments)},A=e.show||u&&!w;if(jVe(f,e.onHide,{disabled:!e.rootClose||e.rootCloseDisabled,clickTrigger:e.rootCloseEvent}),!A)return null;var T=e.children(Xe({},S,{show:!!e.show,props:Xe({},N.popper,{style:j.popper,ref:g}),arrowProps:Xe({},N.arrow,{style:j.arrow,ref:p})}));if(u){var L=e.onExit,O=e.onExiting,V=e.onEnter,W=e.onEntering,B=e.onEntered;T=Q.createElement(u,{in:e.show,appear:!0,onExit:L,onExiting:O,onExited:E,onEnter:V,onEntering:W,onEntered:B},T)}return v?Yj.createPortal(T,v):null});gk.displayName="Overlay";gk.propTypes={show:ke.bool,placement:ke.oneOf(ck),target:ke.any,container:ke.any,flip:ke.bool,children:ke.func.isRequired,containerPadding:ke.number,popperConfig:ke.object,rootClose:ke.bool,rootCloseEvent:ke.oneOf(["click","mousedown"]),rootCloseDisabled:ke.bool,onHide:function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];if(t.rootClose){var i;return(i=ke.func).isRequired.apply(i,[t].concat(n))}return ke.func.apply(ke,[t].concat(n))},transition:ke.elementType,onEnter:ke.func,onEntering:ke.func,onEntered:ke.func,onExit:ke.func,onExiting:ke.func,onExited:ke.func};function o_(e,t){var r=sk(e);return r?r.innerHeight:Fc(e).height}function ZH(e,t,r){e.closest&&!r&&e.closest(t);var n=e;do{if(rHe(n,t))return n;n=n.parentElement}while(n&&n!==r&&n.nodeType===document.ELEMENT_NODE);return null}var i8=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function CVe(e,t){return!!(e===t||i8(e)&&i8(t))}function AVe(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!CVe(e[r],t[r]))return!1;return!0}function JH(e,t){t===void 0&&(t=AVe);var r=null;function n(){for(var a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];if(r&&r.lastThis===this&&t(a,r.lastArgs))return r.lastResult;var s=e.apply(this,a);return r={lastResult:s,lastArgs:a,lastThis:this},s}return n.clear=function(){r=null},n}function Rj(e,t){var r=sk(e);return r?r.innerWidth:Fc(e).width}function QH(e){return DH(e)||MH(e)||nk(e)||jH()}var OVe=$M,FVe=Gp,PVe=bf,IVe=gb,eV=Object.prototype,RVe=eV.hasOwnProperty,MVe=OVe(function(e,t){e=Object(e);var r=-1,n=t.length,a=n>2?t[2]:void 0;for(a&&PVe(t[0],t[1],a)&&(n=1);++r<n;)for(var i=t[r],s=IVe(i),l=-1,c=s.length;++l<c;){var u=s[l],d=e[u];(d===void 0||FVe(d,eV[u])&&!RVe.call(e,u))&&(e[u]=i[u])}return e}),UVe=MVe;const $Ve=At(UVe);var LVe=yL,BVe=DL,WVe=nS,zVe=ws,HVe=ob,VVe=sa,qVe=Ly,GVe=vy,YVe=Hi,XVe=QN;function KVe(e,t,r){var n=VVe(e),a=n||qVe(e)||XVe(e);if(t=zVe(t),r==null){var i=e&&e.constructor;a?r=n?new i:[]:YVe(e)?r=GVe(i)?BVe(HVe(e)):{}:r={}}return(a?LVe:WVe)(e,function(s,l,c){return t(r,s,l,c)}),r}var ZVe=KVe;const JVe=At(ZVe);var QVe={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(ht,function(){return function(r,n,a){n.prototype.isBetween=function(i,s,l,c){var u=a(i),d=a(s),f=(c=c||"()")[0]==="(",h=c[1]===")";return(f?this.isAfter(u,l):!this.isBefore(u,l))&&(h?this.isBefore(d,l):!this.isAfter(d,l))||(f?this.isBefore(u,l):!this.isAfter(u,l))&&(h?this.isAfter(d,l):!this.isBefore(d,l))}}})})(QVe);var eqe={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(ht,function(){return function(r,n){n.prototype.isSameOrAfter=function(a,i){return this.isSame(a,i)||this.isAfter(a,i)}}})})(eqe);var tqe={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(ht,function(){return function(r,n){n.prototype.isSameOrBefore=function(a,i){return this.isSame(a,i)||this.isBefore(a,i)}}})})(tqe);var rqe={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(ht,function(){return function(r,n,a){var i=n.prototype,s=function(f){return f&&(f.indexOf?f:f.s)},l=function(f,h,m,x,p){var g=f.name?f:f.$locale(),v=s(g[h]),y=s(g[m]),b=v||y.map(function(_){return _.slice(0,x)});if(!p)return b;var w=g.weekStart;return b.map(function(_,D){return b[(D+(w||0))%7]})},c=function(){return a.Ls[a.locale()]},u=function(f,h){return f.formats[h]||function(m){return m.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(x,p,g){return p||g.slice(1)})}(f.formats[h.toUpperCase()])},d=function(){var f=this;return{months:function(h){return h?h.format("MMMM"):l(f,"months")},monthsShort:function(h){return h?h.format("MMM"):l(f,"monthsShort","months",3)},firstDayOfWeek:function(){return f.$locale().weekStart||0},weekdays:function(h){return h?h.format("dddd"):l(f,"weekdays")},weekdaysMin:function(h){return h?h.format("dd"):l(f,"weekdaysMin","weekdays",2)},weekdaysShort:function(h){return h?h.format("ddd"):l(f,"weekdaysShort","weekdays",3)},longDateFormat:function(h){return u(f.$locale(),h)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};i.localeData=function(){return d.bind(this)()},a.localeData=function(){var f=c();return{firstDayOfWeek:function(){return f.weekStart||0},weekdays:function(){return a.weekdays()},weekdaysShort:function(){return a.weekdaysShort()},weekdaysMin:function(){return a.weekdaysMin()},months:function(){return a.months()},monthsShort:function(){return a.monthsShort()},longDateFormat:function(h){return u(f,h)},meridiem:f.meridiem,ordinal:f.ordinal}},a.months=function(){return l(c(),"months")},a.monthsShort=function(){return l(c(),"monthsShort","months",3)},a.weekdays=function(f){return l(c(),"weekdays",null,null,f)},a.weekdaysShort=function(f){return l(c(),"weekdaysShort","weekdays",3,f)},a.weekdaysMin=function(f){return l(c(),"weekdaysMin","weekdays",2,f)}}})})(rqe);var nqe={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(ht,function(){var r={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(n,a,i){var s=a.prototype,l=s.format;i.en.formats=r,s.format=function(c){c===void 0&&(c="YYYY-MM-DDTHH:mm:ssZ");var u=this.$locale().formats,d=function(f,h){return f.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(m,x,p){var g=p&&p.toUpperCase();return x||h[p]||r[p]||h[g].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(v,y,b){return y||b.slice(1)})})}(c,u===void 0?{}:u);return l.call(this,d)}}})})(nqe);var aqe={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(ht,function(){return function(r,n,a){var i=function(s,l){if(!l||!l.length||l.length===1&&!l[0]||l.length===1&&Array.isArray(l[0])&&!l[0].length)return null;var c;l.length===1&&l[0].length>0&&(l=l[0]),c=(l=l.filter(function(d){return d}))[0];for(var u=1;u<l.length;u+=1)l[u].isValid()&&!l[u][s](c)||(c=l[u]);return c};a.max=function(){var s=[].slice.call(arguments,0);return i("isAfter",s)},a.min=function(){var s=[].slice.call(arguments,0);return i("isBefore",s)}}})})(aqe);var iqe={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(ht,function(){var r="minute",n=/[+-]\d\d(?::?\d\d)?/g,a=/([+-]|\d\d)/g;return function(i,s,l){var c=s.prototype;l.utc=function(p){var g={date:p,utc:!0,args:arguments};return new s(g)},c.utc=function(p){var g=l(this.toDate(),{locale:this.$L,utc:!0});return p?g.add(this.utcOffset(),r):g},c.local=function(){return l(this.toDate(),{locale:this.$L,utc:!1})};var u=c.parse;c.parse=function(p){p.utc&&(this.$u=!0),this.$utils().u(p.$offset)||(this.$offset=p.$offset),u.call(this,p)};var d=c.init;c.init=function(){if(this.$u){var p=this.$d;this.$y=p.getUTCFullYear(),this.$M=p.getUTCMonth(),this.$D=p.getUTCDate(),this.$W=p.getUTCDay(),this.$H=p.getUTCHours(),this.$m=p.getUTCMinutes(),this.$s=p.getUTCSeconds(),this.$ms=p.getUTCMilliseconds()}else d.call(this)};var f=c.utcOffset;c.utcOffset=function(p,g){var v=this.$utils().u;if(v(p))return this.$u?0:v(this.$offset)?f.call(this):this.$offset;if(typeof p=="string"&&(p=function(_){_===void 0&&(_="");var D=_.match(n);if(!D)return null;var j=(""+D[0]).match(a)||["-",0,0],N=j[0],S=60*+j[1]+ +j[2];return S===0?0:N==="+"?S:-S}(p),p===null))return this;var y=Math.abs(p)<=16?60*p:p;if(y===0)return this.utc(g);var b=this.clone();if(g)return b.$offset=y,b.$u=!1,b;var w=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();return(b=this.local().add(y+w,r)).$offset=y,b.$x.$localOffset=w,b};var h=c.format;c.format=function(p){var g=p||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return h.call(this,g)},c.valueOf=function(){var p=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*p},c.isUTC=function(){return!!this.$u},c.toISOString=function(){return this.toDate().toISOString()},c.toString=function(){return this.toDate().toUTCString()};var m=c.toDate;c.toDate=function(p){return p==="s"&&this.$offset?l(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():m.call(this)};var x=c.diff;c.diff=function(p,g,v){if(p&&this.$u===p.$u)return x.call(this,p,g,v);var y=this.local(),b=l(p).local();return x.call(y,b,g,v)}}})})(iqe);var sqe={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(ht,function(){return function(r,n){n.prototype.isLeapYear=function(){return this.$y%4==0&&this.$y%100!=0||this.$y%400==0}}})})(sqe);function Cs(e){return e.children}var Ra={PREVIOUS:"PREV",NEXT:"NEXT",TODAY:"TODAY",DATE:"DATE"},xa={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"},s8=Object.keys(xa).map(function(e){return xa[e]});ke.oneOfType([ke.string,ke.func]);ke.any;ke.func;ke.oneOfType([ke.arrayOf(ke.oneOf(s8)),ke.objectOf(function(e,t){var r=s8.indexOf(t)!==-1&&typeof e[t]=="boolean";if(r)return null;for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i];return ke.elementType.apply(ke,[e,t].concat(a))})]);ke.oneOfType([ke.oneOf(["overlap","no-overlap"]),ke.func]);var o8={seconds:1e3,minutes:1e3*60,hours:1e3*60*60,day:1e3*60*60*24};function tV(e,t){var r=Un(e,"month");return Un(r,"week",t.startOfWeek())}function rV(e,t){var r=Iv(e,"month");return Iv(r,"week",t.startOfWeek())}function oqe(e,t){for(var r=tV(e,t),n=rV(e,t),a=[];Rf(r,n,"day");)a.push(r),r=hs(r,1,"day");return a}function lqe(e,t){var r=Un(e,t);return bx(r,e)?r:hs(r,1,t)}function cqe(e,t){for(var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"day",n=e,a=[];Rf(n,t,r);)a.push(n),n=hs(n,1,r);return a}function uqe(e,t){return t==null&&e==null?null:(t==null&&(t=new Date),e==null&&(e=new Date),e=Un(e,"day"),e=bp(e,bp(t)),e=Zd(e,Zd(t)),e=yp(e,yp(t)),vp(e,vp(t)))}function l8(e){return bp(e)===0&&Zd(e)===0&&yp(e)===0&&vp(e)===0}function dqe(e,t,r,n){return r==="day"&&(r="date"),Math.abs($6[r](e,void 0,n)-$6[r](t,void 0,n))}function vk(e,t,r){return!r||r==="milliseconds"?Math.abs(+e-+t):Math.round(Math.abs(+Un(e,r)/o8[r]-+Un(t,r)/o8[r]))}var fqe=ke.oneOfType([ke.string,ke.func]);function hqe(e,t,r,n,a){var i=typeof n=="function"?n(r,a,e):t.call(e,r,n,a);return fp(i==null||typeof i=="string","`localizer format(..)` must return a string, null, or undefined"),i}function mqe(e,t,r){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,t+r,0,0)}function yk(e,t){return e.getTimezoneOffset()-t.getTimezoneOffset()}function pqe(e,t){return vk(e,t,"minutes")+yk(e,t)}function xqe(e){var t=Un(e,"day");return vk(t,e,"minutes")+yk(t,e)}function gqe(e,t){return ik(e,t,"day")}function vqe(e,t,r){var n=bx(e,t,"minutes");return n?wx(t,r,"minutes"):b1(t,r,"minutes")}function Mj(e,t){return dqe(e,t,"day")}function yqe(e){var t=e.evtA,r=t.start,n=t.end,a=t.allDay,i=e.evtB,s=i.start,l=i.end,c=i.allDay,u=+Un(r,"day")-+Un(s,"day"),d=Mj(r,n),f=Mj(s,l);return u||f-d||!!c-!!a||+r-+s||+n-+l}function bqe(e){var t=e.event,r=t.start,n=t.end,a=e.range,i=a.start,s=a.end,l=Un(r,"day"),c=Rf(l,s,"day"),u=ak(l,n,"minutes"),d=u?b1(n,i,"minutes"):wx(n,i,"minutes");return c&&d}function wqe(e,t){return bx(e,t,"day")}function _qe(e,t){return l8(e)&&l8(t)}var Dqe=pn(function e(t){var r=this;mn(this,e),fp(typeof t.format=="function","date localizer `format(..)` must be a function"),fp(typeof t.firstOfWeek=="function","date localizer `firstOfWeek(..)` must be a function"),this.propType=t.propType||fqe,this.formats=t.formats,this.format=function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return hqe.apply(void 0,[r,t.format].concat(a))},this.startOfWeek=t.firstOfWeek,this.merge=t.merge||uqe,this.inRange=t.inRange||FH,this.lt=t.lt||ik,this.lte=t.lte||Rf,this.gt=t.gt||b1,this.gte=t.gte||wx,this.eq=t.eq||bx,this.neq=t.neq||ak,this.startOf=t.startOf||Un,this.endOf=t.endOf||Iv,this.add=t.add||hs,this.range=t.range||cqe,this.diff=t.diff||vk,this.ceil=t.ceil||lqe,this.min=t.min||AH,this.max=t.max||OH,this.minutes=t.minutes||Zd,this.daySpan=t.daySpan||Mj,this.firstVisibleDay=t.firstVisibleDay||tV,this.lastVisibleDay=t.lastVisibleDay||rV,this.visibleDays=t.visibleDays||oqe,this.getSlotDate=t.getSlotDate||mqe,this.getTimezoneOffset=t.getTimezoneOffset||function(n){return n.getTimezoneOffset()},this.getDstOffset=t.getDstOffset||yk,this.getTotalMin=t.getTotalMin||pqe,this.getMinutesFromMidnight=t.getMinutesFromMidnight||xqe,this.continuesPrior=t.continuesPrior||gqe,this.continuesAfter=t.continuesAfter||vqe,this.sortEvents=t.sortEvents||yqe,this.inEventRange=t.inEventRange||bqe,this.isSameDate=t.isSameDate||wqe,this.startAndEndAreDateOnly=t.startAndEndAreDateOnly||_qe,this.segmentOffset=t.browserTZOffset?t.browserTZOffset():0});function jqe(e,t,r,n){var a=Jt(Jt({},e.formats),r);return Jt(Jt({},e),{},{messages:n,startOfWeek:function(){return e.startOfWeek(t)},format:function(s,l){return e.format(s,a[l]||l,t)}})}var Nqe=function(e){function t(){var r;mn(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=ua(this,t,[].concat(a)),r.navigate=function(s){r.props.onNavigate(s)},r.view=function(s){r.props.onView(s)},r}return da(t,e),pn(t,[{key:"render",value:function(){var n=this.props,a=n.localizer.messages,i=n.label;return Q.createElement("div",{className:"rbc-toolbar"},Q.createElement("span",{className:"rbc-btn-group"},Q.createElement("button",{type:"button",onClick:this.navigate.bind(null,Ra.TODAY)},a.today),Q.createElement("button",{type:"button",onClick:this.navigate.bind(null,Ra.PREVIOUS)},a.previous),Q.createElement("button",{type:"button",onClick:this.navigate.bind(null,Ra.NEXT)},a.next)),Q.createElement("span",{className:"rbc-toolbar-label"},i),Q.createElement("span",{className:"rbc-btn-group"},this.viewNamesGroup(a)))}},{key:"viewNamesGroup",value:function(n){var a=this,i=this.props.views,s=this.props.view;if(i.length>1)return i.map(function(l){return Q.createElement("button",{type:"button",key:l,className:Br({"rbc-active":s===l}),onClick:a.view.bind(null,l)},n[l])})}}])}(Q.Component);function br(e,t){e&&e.apply(null,[].concat(t))}var Sqe={date:"Date",time:"Time",event:"Event",allDay:"All Day",week:"Week",work_week:"Work Week",day:"Day",month:"Month",previous:"Back",next:"Next",yesterday:"Yesterday",tomorrow:"Tomorrow",today:"Today",agenda:"Agenda",noEventsInRange:"There are no events in this range.",showMore:function(t){return"+".concat(t," more")}};function Eqe(e){return Jt(Jt({},Sqe),e)}function Tqe(e){var t=e.ref,r=e.callback;M.useEffect(function(){var n=function(i){t.current&&!t.current.contains(i.target)&&r()};return document.addEventListener("mousedown",n),function(){document.removeEventListener("mousedown",n)}},[t,r])}var kqe=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],nV=function(e){function t(){return mn(this,t),ua(this,t,arguments)}return da(t,e),pn(t,[{key:"render",value:function(){var n=this.props,a=n.style,i=n.className,s=n.event,l=n.selected,c=n.isAllDay,u=n.onSelect,d=n.onDoubleClick,f=n.onKeyPress,h=n.localizer,m=n.continuesPrior,x=n.continuesAfter,p=n.accessors,g=n.getters,v=n.children,y=n.components,b=y.event,w=y.eventWrapper,_=n.slotStart,D=n.slotEnd,j=Gs(n,kqe);delete j.resizable;var N=p.title(s),S=p.tooltip(s),E=p.end(s),A=p.start(s),T=p.allDay(s),L=c||T||h.diff(A,h.ceil(E,"day"),"day")>1,O=g.eventProp(s,A,E,l),V=Q.createElement("div",{className:"rbc-event-content",title:S||void 0},b?Q.createElement(b,{event:s,continuesPrior:m,continuesAfter:x,title:N,isAllDay:T,localizer:h,slotStart:_,slotEnd:D}):N);return Q.createElement(w,Object.assign({},this.props,{type:"date"}),Q.createElement("div",Object.assign({},j,{style:Jt(Jt({},O.style),a),className:Br("rbc-event",i,O.className,{"rbc-selected":l,"rbc-event-allday":L,"rbc-event-continues-prior":m,"rbc-event-continues-after":x}),onClick:function(B){return u&&u(s,B)},onDoubleClick:function(B){return d&&d(s,B)},onKeyDown:function(B){return f&&f(s,B)}}),typeof v=="function"?v(V):V))}}])}(Q.Component);function _1(e,t){return!e||t==null?!1:lu(e,t)}function aV(e,t){var r=e.right-e.left,n=r/t;return n}function iV(e,t,r,n){var a=aV(e,n);return r?n-1-Math.floor((t-e.left)/a):Math.floor((t-e.left)/a)}function Cqe(e,t){var r=t.x,n=t.y;return n>=e.top&&n<=e.bottom&&r>=e.left&&r<=e.right}function Aqe(e,t,r,n,a){var i=-1,s=-1,l=n-1,c=aV(t,n),u=iV(t,r.x,a,n),d=t.top<r.y&&t.bottom>r.y,f=t.top<e.y&&t.bottom>e.y,h=e.y>t.bottom,m=t.top>e.y,x=r.top<t.top&&r.bottom>t.bottom;return x&&(i=0,s=l),d&&(m?(i=0,s=u):h&&(i=u,s=l)),f&&(i=s=a?l-Math.floor((e.x-t.left)/c):Math.floor((e.x-t.left)/c),d?u<i?i=u:s=u:e.y<r.y?s=l:i=0),{startIdx:i,endIdx:s}}function Oqe(e){var t=e.target,r=e.offset,n=e.container,a=e.box,i=Fc(t),s=i.top,l=i.left,c=i.width,u=i.height,d=Fc(n),f=d.top,h=d.left,m=d.width,x=d.height,p=Fc(a),g=p.width,v=p.height,y=f+x,b=h+m,w=s+v,_=l+g,D=r.x,j=r.y,N=w>y?s-v-j:s+j+u,S=_>b?l+D-g+c:l+D;return{topOffset:N,leftOffset:S}}function Fqe(e){var t=e.containerRef,r=e.accessors,n=e.getters,a=e.selected,i=e.components,s=e.localizer,l=e.position,c=e.show,u=e.events,d=e.slotStart,f=e.slotEnd,h=e.onSelect,m=e.onDoubleClick,x=e.onKeyPress,p=e.handleDragStart,g=e.popperRef,v=e.target,y=e.offset;Tqe({ref:g,callback:c}),M.useLayoutEffect(function(){var _=Oqe({target:v,offset:y,container:t.current,box:g.current}),D=_.topOffset,j=_.leftOffset;g.current.style.top="".concat(D,"px"),g.current.style.left="".concat(j,"px")},[y.x,y.y,v]);var b=l.width,w={minWidth:b+b/2};return Q.createElement("div",{style:w,className:"rbc-overlay",ref:g},Q.createElement("div",{className:"rbc-overlay-header"},s.format(d,"dayHeaderFormat")),u.map(function(_,D){return Q.createElement(nV,{key:D,type:"popup",localizer:s,event:_,getters:n,onSelect:h,accessors:r,components:i,onDoubleClick:m,onKeyPress:x,continuesPrior:s.lt(r.end(_),d,"day"),continuesAfter:s.gte(r.start(_),f,"day"),slotStart:d,slotEnd:f,selected:_1(_,a),draggable:!0,onDragStart:function(){return p(_)},onDragEnd:function(){return c()}})}))}var sV=Q.forwardRef(function(e,t){return Q.createElement(Fqe,Object.assign({},e,{popperRef:t}))});sV.propTypes={accessors:ke.object.isRequired,getters:ke.object.isRequired,selected:ke.object,components:ke.object.isRequired,localizer:ke.object.isRequired,position:ke.object.isRequired,show:ke.func.isRequired,events:ke.array.isRequired,slotStart:ke.instanceOf(Date).isRequired,slotEnd:ke.instanceOf(Date),onSelect:ke.func,onDoubleClick:ke.func,onKeyPress:ke.func,handleDragStart:ke.func,style:ke.object,offset:ke.shape({x:ke.number,y:ke.number})};function Pqe(e){var t=e.containerRef,r=e.popupOffset,n=r===void 0?5:r,a=e.overlay,i=e.accessors,s=e.localizer,l=e.components,c=e.getters,u=e.selected,d=e.handleSelectEvent,f=e.handleDoubleClickEvent,h=e.handleKeyPressEvent,m=e.handleDragStart,x=e.onHide,p=e.overlayDisplay,g=M.useRef(null);if(!a.position)return null;var v=n;isNaN(n)||(v={x:n,y:n});var y=a.position,b=a.events,w=a.date,_=a.end;return Q.createElement(gk,{rootClose:!0,flip:!0,show:!0,placement:"bottom",onHide:x,target:a.target},function(D){var j=D.props;return Q.createElement(sV,Object.assign({},j,{containerRef:t,ref:g,target:a.target,offset:v,accessors:i,getters:c,selected:u,components:l,localizer:s,position:y,show:p,events:b,slotStart:w,slotEnd:_,onSelect:d,onDoubleClick:f,onKeyPress:h,handleDragStart:m}))})}var bk=Q.forwardRef(function(e,t){return Q.createElement(Pqe,Object.assign({},e,{containerRef:t}))});bk.propTypes={popupOffset:ke.oneOfType([ke.number,ke.shape({x:ke.number,y:ke.number})]),overlay:ke.shape({position:ke.object,events:ke.array,date:ke.instanceOf(Date),end:ke.instanceOf(Date)}),accessors:ke.object.isRequired,localizer:ke.object.isRequired,components:ke.object.isRequired,getters:ke.object.isRequired,selected:ke.object,handleSelectEvent:ke.func,handleDoubleClickEvent:ke.func,handleKeyPressEvent:ke.func,handleDragStart:ke.func,onHide:ke.func,overlayDisplay:ke.func};function Vn(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;return Nh(r,e,t,{passive:!1})}function Iqe(e,t,r){return!e||wp(e,document.elementFromPoint(t,r))}function Rqe(e,t){var r=t.clientX,n=t.clientY,a=document.elementFromPoint(r,n);return ZH(a,".rbc-event",e)}function Mqe(e,t){var r=t.clientX,n=t.clientY,a=document.elementFromPoint(r,n);return ZH(a,".rbc-show-more",e)}function Uv(e,t){return!!Rqe(e,t)}function Uqe(e,t){return!!Mqe(e,t)}function xh(e){var t=e;return e.touches&&e.touches.length&&(t=e.touches[0]),{clientX:t.clientX,clientY:t.clientY,pageX:t.pageX,pageY:t.pageY}}var c8=5,$qe=250,oV=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.global,a=n===void 0?!1:n,i=r.longPressThreshold,s=i===void 0?250:i,l=r.validContainers,c=l===void 0?[]:l;mn(this,e),this._initialEvent=null,this.selecting=!1,this.isDetached=!1,this.container=t,this.globalMouse=!t||a,this.longPressThreshold=s,this.validContainers=c,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=Vn("touchmove",function(){},window),this._removeKeyDownListener=Vn("keydown",this._keyListener),this._removeKeyUpListener=Vn("keyup",this._keyListener),this._removeDropFromOutsideListener=Vn("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=Vn("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return pn(e,[{key:"on",value:function(r,n){var a=this._listeners[r]||(this._listeners[r]=[]);return a.push(n),{remove:function(){var s=a.indexOf(n);s!==-1&&a.splice(s,1)}}}},{key:"emit",value:function(r){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];var s,l=this._listeners[r]||[];return l.forEach(function(c){s===void 0&&(s=c.apply(void 0,a))}),s}},{key:"teardown",value:function(){this._initialEvent=null,this._initialEventData=null,this._selectRect=null,this.selecting=!1,this._lastClickData=null,this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(r){var n=this._selectRect;return!n||!this.selecting?!1:u8(n,au(r))}},{key:"filter",value:function(r){var n=this._selectRect;return!n||!this.selecting?[]:r.filter(this.isSelected,this)}},{key:"_addLongPressListener",value:function(r,n){var a=this,i=null,s=null,l=null,c=function(h){i=setTimeout(function(){d(),r(h)},a.longPressThreshold),s=Vn("touchmove",function(){return d()}),l=Vn("touchend",function(){return d()})},u=Vn("touchstart",c),d=function(){i&&clearTimeout(i),s&&s(),l&&l(),i=null,s=null,l=null};return n&&c(n),function(){d(),u()}}},{key:"_addInitialEventListener",value:function(){var r=this,n=Vn("mousedown",function(i){r._removeInitialEventListener(),r._handleInitialEvent(i),r._removeInitialEventListener=Vn("mousedown",r._handleInitialEvent)}),a=Vn("touchstart",function(i){r._removeInitialEventListener(),r._removeInitialEventListener=r._addLongPressListener(r._handleInitialEvent,i)});this._removeInitialEventListener=function(){n(),a()}}},{key:"_dropFromOutsideListener",value:function(r){var n=xh(r),a=n.pageX,i=n.pageY,s=n.clientX,l=n.clientY;this.emit("dropFromOutside",{x:a,y:i,clientX:s,clientY:l}),r.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(r){var n=xh(r),a=n.pageX,i=n.pageY,s=n.clientX,l=n.clientY;this.emit("dragOverFromOutside",{x:a,y:i,clientX:s,clientY:l}),r.preventDefault()}},{key:"_handleInitialEvent",value:function(r){if(this._initialEvent=r,!this.isDetached){var n=xh(r),a=n.clientX,i=n.clientY,s=n.pageX,l=n.pageY,c=this.container(),u,d;if(!(r.which===3||r.button===2||!Iqe(c,a,i))){if(!this.globalMouse&&c&&!wp(c,r.target)){var f=Lqe(0),h=f.top,m=f.left,x=f.bottom,p=f.right;if(d=au(c),u=u8({top:d.top-h,left:d.left-m,bottom:d.bottom+x,right:d.right+p},{top:l,left:s}),!u)return}var g=this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(r.type),x:s,y:l,clientX:a,clientY:i});if(g!==!1)switch(r.type){case"mousedown":this._removeEndListener=Vn("mouseup",this._handleTerminatingEvent),this._onEscListener=Vn("keydown",this._handleTerminatingEvent),this._removeMoveListener=Vn("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(r),this._removeEndListener=Vn("touchend",this._handleTerminatingEvent),this._removeMoveListener=Vn("touchmove",this._handleMoveEvent);break}}}}},{key:"_isWithinValidContainer",value:function(r){var n=r.target,a=this.validContainers;return!a||!a.length||!n?!0:a.some(function(i){return!!n.closest(i)})}},{key:"_handleTerminatingEvent",value:function(r){var n=this.selecting,a=this._selectRect;if(!n&&r.type.includes("key")&&(r=this._initialEvent),this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._selectRect=null,this._initialEvent=null,this._initialEventData=null,!!r){var i=!this.container||wp(this.container(),r.target),s=this._isWithinValidContainer(r);return r.key==="Escape"||!s?this.emit("reset"):!n&&i?this._handleClickEvent(r):n?this.emit("select",a):this.emit("reset")}}},{key:"_handleClickEvent",value:function(r){var n=xh(r),a=n.pageX,i=n.pageY,s=n.clientX,l=n.clientY,c=new Date().getTime();return this._lastClickData&&c-this._lastClickData.timestamp<$qe?(this._lastClickData=null,this.emit("doubleClick",{x:a,y:i,clientX:s,clientY:l})):(this._lastClickData={timestamp:c},this.emit("click",{x:a,y:i,clientX:s,clientY:l}))}},{key:"_handleMoveEvent",value:function(r){if(!(this._initialEventData===null||this.isDetached)){var n=this._initialEventData,a=n.x,i=n.y,s=xh(r),l=s.pageX,c=s.pageY,u=Math.abs(a-l),d=Math.abs(i-c),f=Math.min(l,a),h=Math.min(c,i),m=this.selecting,x=this.isClick(l,c);x&&!m&&!(u||d)||(!m&&!x&&this.emit("selectStart",this._initialEventData),x||(this.selecting=!0,this._selectRect={top:h,left:f,x:l,y:c,right:f+u,bottom:h+d},this.emit("selecting",this._selectRect)),r.preventDefault())}}},{key:"_keyListener",value:function(r){this.ctrl=r.metaKey||r.ctrlKey}},{key:"isClick",value:function(r,n){var a=this._initialEventData,i=a.x,s=a.y,l=a.isTouch;return!l&&Math.abs(r-i)<=c8&&Math.abs(n-s)<=c8}}])}();function Lqe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return Co(e)!=="object"&&(e={top:e,left:e,right:e,bottom:e}),e}function u8(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=au(e),a=n.top,i=n.left,s=n.right,l=s===void 0?i:s,c=n.bottom,u=c===void 0?a:c,d=au(t),f=d.top,h=d.left,m=d.right,x=m===void 0?h:m,p=d.bottom,g=p===void 0?f:p;return!(u-r<f||a+r>g||l-r<h||i+r>x)}function au(e){if(!e.getBoundingClientRect)return e;var t=e.getBoundingClientRect(),r=t.left+d8("left"),n=t.top+d8("top");return{top:n,left:r,right:(e.offsetWidth||0)+r,bottom:(e.offsetHeight||0)+n}}function d8(e){if(e==="left")return window.pageXOffset||document.body.scrollLeft||0;if(e==="top")return window.pageYOffset||document.body.scrollTop||0}var Bqe=function(e){function t(r,n){var a;return mn(this,t),a=ua(this,t,[r,n]),a.state={selecting:!1},a.containerRef=M.createRef(),a}return da(t,e),pn(t,[{key:"componentDidMount",value:function(){this.props.selectable&&this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"componentDidUpdate",value:function(n){!n.selectable&&this.props.selectable&&this._selectable(),n.selectable&&!this.props.selectable&&this._teardownSelectable()}},{key:"render",value:function(){var n=this.props,a=n.range,i=n.getNow,s=n.getters,l=n.date,c=n.components.dateCellWrapper,u=n.localizer,d=this.state,f=d.selecting,h=d.startIdx,m=d.endIdx,x=i();return Q.createElement("div",{className:"rbc-row-bg",ref:this.containerRef},a.map(function(p,g){var v=f&&g>=h&&g<=m,y=s.dayProp(p),b=y.className,w=y.style;return Q.createElement(c,{key:g,value:p,range:a},Q.createElement("div",{style:w,className:Br("rbc-day-bg",b,v&&"rbc-selected-cell",u.isSameDate(p,x)&&"rbc-today",l&&u.neq(l,p,"month")&&"rbc-off-range-bg")}))}))}},{key:"_selectable",value:function(){var n=this,a=this.containerRef.current,i=this._selector=new oV(this.props.container,{longPressThreshold:this.props.longPressThreshold}),s=function(c,u){if(!Uv(a,c)&&!Uqe(a,c)){var d=au(a),f=n.props,h=f.range,m=f.rtl;if(Cqe(d,c)){var x=iV(d,c.x,m,h.length);n._selectSlot({startIdx:x,endIdx:x,action:u,box:c})}}n._initial={},n.setState({selecting:!1})};i.on("selecting",function(l){var c=n.props,u=c.range,d=c.rtl,f=-1,h=-1;if(n.state.selecting||(br(n.props.onSelectStart,[l]),n._initial={x:l.x,y:l.y}),i.isSelected(a)){var m=au(a),x=Aqe(n._initial,m,l,u.length,d);f=x.startIdx,h=x.endIdx}n.setState({selecting:!0,startIdx:f,endIdx:h})}),i.on("beforeSelect",function(l){if(n.props.selectable==="ignoreEvents")return!Uv(n.containerRef.current,l)}),i.on("click",function(l){return s(l,"click")}),i.on("doubleClick",function(l){return s(l,"doubleClick")}),i.on("select",function(l){n._selectSlot(Jt(Jt({},n.state),{},{action:"select",bounds:l})),n._initial={},n.setState({selecting:!1}),br(n.props.onSelectEnd,[n.state])})}},{key:"_teardownSelectable",value:function(){this._selector&&(this._selector.teardown(),this._selector=null)}},{key:"_selectSlot",value:function(n){var a=n.endIdx,i=n.startIdx,s=n.action,l=n.bounds,c=n.box;a!==-1&&i!==-1&&this.props.onSelectSlot&&this.props.onSelectSlot({start:i,end:a,action:s,bounds:l,box:c,resourceId:this.props.resourceId})}}])}(Q.Component),Ei={propTypes:{slotMetrics:ke.object.isRequired,selected:ke.object,isAllDay:ke.bool,accessors:ke.object.isRequired,localizer:ke.object.isRequired,components:ke.object.isRequired,getters:ke.object.isRequired,onSelect:ke.func,onDoubleClick:ke.func,onKeyPress:ke.func},defaultProps:{segments:[],selected:{}},renderEvent:function(t,r){var n=t.selected;t.isAllDay;var a=t.accessors,i=t.getters,s=t.onSelect,l=t.onDoubleClick,c=t.onKeyPress,u=t.localizer,d=t.slotMetrics,f=t.components,h=t.resizable,m=d.continuesPrior(r),x=d.continuesAfter(r);return Q.createElement(nV,{event:r,getters:i,localizer:u,accessors:a,components:f,onSelect:s,onDoubleClick:l,onKeyPress:c,continuesPrior:m,continuesAfter:x,slotStart:d.first,slotEnd:d.last,selected:_1(r,n),resizable:h})},renderSpan:function(t,r,n){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:" ",i=Math.abs(r)/t*100+"%";return Q.createElement("div",{key:n,className:"rbc-row-segment",style:{WebkitFlexBasis:i,flexBasis:i,maxWidth:i}},a)}},lV=function(e){function t(){return mn(this,t),ua(this,t,arguments)}return da(t,e),pn(t,[{key:"render",value:function(){var n=this,a=this.props,i=a.segments,s=a.slotMetrics.slots,l=a.className,c=1;return Q.createElement("div",{className:Br(l,"rbc-row")},i.reduce(function(u,d,f){var h=d.event,m=d.left,x=d.right,p=d.span,g="_lvl_"+f,v=m-c,y=Ei.renderEvent(n.props,h);return v&&u.push(Ei.renderSpan(s,v,"".concat(g,"_gap"))),u.push(Ei.renderSpan(s,p,g,y)),c=x+1,u},[]))}}])}(Q.Component);lV.defaultProps=Jt({},Ei.defaultProps);function cV(e){var t=e.dateRange,r=e.unit,n=r===void 0?"day":r,a=e.localizer;return{first:t[0],last:a.add(t[t.length-1],1,n)}}function Wqe(e,t,r,n){var a=cV({dateRange:t,localizer:n}),i=a.first,s=a.last,l=n.diff(i,s,"day"),c=n.max(n.startOf(r.start(e),"day"),i),u=n.min(n.ceil(r.end(e),"day"),s),d=tDe(t,function(h){return n.isSameDate(h,c)}),f=n.diff(c,u,"day");return f=Math.min(f,l),f=Math.max(f-n.segmentOffset,1),{event:e,span:f,left:d+1,right:Math.max(d+f,1)}}function Uj(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r,n,a,i=[],s=[];for(r=0;r<e.length;r++){for(a=e[r],n=0;n<i.length&&zqe(a,i[n]);n++);n>=t?s.push(a):(i[n]||(i[n]=[])).push(a)}for(r=0;r<i.length;r++)i[r].sort(function(l,c){return l.left-c.left});return{levels:i,extra:s}}function jp(e,t,r,n,a){var i={start:n.start(e),end:n.end(e)},s={start:t,end:r};return a.inEventRange({event:i,range:s})}function zqe(e,t){return t.some(function(r){return r.left<=e.right&&r.right>=e.left})}function Hqe(e,t,r){var n=M0(e),a=[],i=[];n.forEach(function(c){var u=t.start(c),d=t.end(c);r.daySpan(u,d)>1?a.push(c):i.push(c)});var s=a.sort(function(c,u){return $j(c,u,t,r)}),l=i.sort(function(c,u){return $j(c,u,t,r)});return[].concat(M0(s),M0(l))}function $j(e,t,r,n){var a={start:r.start(e),end:r.end(e),allDay:r.allDay(e)},i={start:r.start(t),end:r.end(t),allDay:r.allDay(t)};return n.sortEvents({evtA:a,evtB:i})}var Lj=function(t,r){return t.left<=r&&t.right>=r},l_=function(t,r){return t.filter(function(n){return Lj(n,r)}).map(function(n){return n.event})},uV=function(e){function t(){return mn(this,t),ua(this,t,arguments)}return da(t,e),pn(t,[{key:"render",value:function(){for(var n=this.props,a=n.segments,i=n.slotMetrics.slots,s=Uj(a).levels[0],l=1,c=1,u=[];l<=i;){var d="_lvl_"+l,f=s.filter(function(w){return Lj(w,l)})[0]||{},h=f.event,m=f.left,x=f.right,p=f.span;if(!h){var g=this.getHiddenEventsForSlot(a,l);if(g.length>0){var v=l-c;v&&u.push(Ei.renderSpan(i,v,d+"_gap")),u.push(Ei.renderSpan(i,1,d,this.renderShowMore(a,l))),c=l=l+1;continue}l++;continue}var y=Math.max(0,m-c);if(this.canRenderSlotEvent(m,p)){var b=Ei.renderEvent(this.props,h);y&&u.push(Ei.renderSpan(i,y,d+"_gap")),u.push(Ei.renderSpan(i,p,d,b)),c=l=x+1}else y&&u.push(Ei.renderSpan(i,y,d+"_gap")),u.push(Ei.renderSpan(i,1,d,this.renderShowMore(a,l))),c=l=l+1}return Q.createElement("div",{className:"rbc-row"},u)}},{key:"getHiddenEventsForSlot",value:function(n,a){var i=l_(n,a),s=Uj(n).levels[0],l=s.filter(function(c){return Lj(c,a)}).map(function(c){return c.event});return i.filter(function(c){return!l.some(function(u){return u===c})})}},{key:"canRenderSlotEvent",value:function(n,a){var i=this.props.segments;return Em(n,n+a).every(function(s){var l=l_(i,s).length;return l===1})}},{key:"renderShowMore",value:function(n,a){var i=this,s=this.props,l=s.localizer,c=s.slotMetrics,u=s.components,d=c.getEventsForSlot(a),f=l_(n,a),h=f.length;if(u!=null&&u.showMore){var m=u.showMore,x=c.getDateForSlot(a-1);return h?Q.createElement(m,{localizer:l,slotDate:x,slot:a,count:h,events:d,remainingEvents:f}):!1}return h?Q.createElement("button",{type:"button",key:"sm_"+a,className:Br("rbc-button-link","rbc-show-more"),onClick:function(g){return i.showMore(a,g)}},l.messages.showMore(h,f,d)):!1}},{key:"showMore",value:function(n,a){a.preventDefault(),a.stopPropagation(),this.props.onShowMore(n,a.target)}}])}(Q.Component);uV.defaultProps=Jt({},Ei.defaultProps);var Vqe=function(t){var r=t.children;return Q.createElement("div",{className:"rbc-row-content-scroll-container"},r)},qqe=function(t,r){return t.left<=r&&t.right>=r},Gqe=function(t,r){return t[0].range===r[0].range&&t[0].events===r[0].events};function dV(){return JH(function(e){for(var t=e.range,r=e.events,n=e.maxRows,a=e.minRows,i=e.accessors,s=e.localizer,l=cV({dateRange:t,localizer:s}),c=l.first,u=l.last,d=r.map(function(p){return Wqe(p,t,i,s)}),f=Uj(d,Math.max(n-1,1)),h=f.levels,m=f.extra,x=m.length>0?a-1:a;h.length<x;)h.push([]);return{first:c,last:u,levels:h,extra:m,range:t,slots:t.length,clone:function(g){var v=dV();return v(Jt(Jt({},e),g))},getDateForSlot:function(g){return t[g]},getSlotForDate:function(g){return t.find(function(v){return s.isSameDate(v,g)})},getEventsForSlot:function(g){return d.filter(function(v){return qqe(v,g)}).map(function(v){return v.event})},continuesPrior:function(g){return s.continuesPrior(i.start(g),c)},continuesAfter:function(g){var v=i.start(g),y=i.end(g);return s.continuesAfter(v,y,u)}}},Gqe)}var Np=function(e){function t(){var r;mn(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=ua(this,t,[].concat(a)),r.handleSelectSlot=function(s){var l=r.props,c=l.range,u=l.onSelectSlot;u(c.slice(s.start,s.end+1),s)},r.handleShowMore=function(s,l){var c=r.props,u=c.range,d=c.onShowMore,f=r.slotMetrics(r.props),h=aHe(r.containerRef.current,".rbc-row-bg")[0],m;h&&(m=h.children[s-1]);var x=f.getEventsForSlot(s);d(x,u[s-1],m,s,l)},r.getContainer=function(){var s=r.props.container;return s?s():r.containerRef.current},r.renderHeadingCell=function(s,l){var c=r.props,u=c.renderHeader,d=c.getNow,f=c.localizer;return u({date:s,key:"header_".concat(l),className:Br("rbc-date-cell",f.isSameDate(s,d())&&"rbc-now")})},r.renderDummy=function(){var s=r.props,l=s.className,c=s.range,u=s.renderHeader,d=s.showAllEvents;return Q.createElement("div",{className:l,ref:r.containerRef},Q.createElement("div",{className:Br("rbc-row-content",d&&"rbc-row-content-scrollable")},u&&Q.createElement("div",{className:"rbc-row",ref:r.headingRowRef},c.map(r.renderHeadingCell)),Q.createElement("div",{className:"rbc-row",ref:r.eventRowRef},Q.createElement("div",{className:"rbc-row-segment"},Q.createElement("div",{className:"rbc-event"},Q.createElement("div",{className:"rbc-event-content"},""))))))},r.containerRef=M.createRef(),r.headingRowRef=M.createRef(),r.eventRowRef=M.createRef(),r.slotMetrics=dV(),r}return da(t,e),pn(t,[{key:"getRowLimit",value:function(){var n,a=o_(this.eventRowRef.current),i=(n=this.headingRowRef)!==null&&n!==void 0&&n.current?o_(this.headingRowRef.current):0,s=o_(this.containerRef.current)-i;return Math.max(Math.floor(s/a),1)}},{key:"render",value:function(){var n=this.props,a=n.date,i=n.rtl,s=n.range,l=n.className,c=n.selected,u=n.selectable,d=n.renderForMeasure,f=n.accessors,h=n.getters,m=n.components,x=n.getNow,p=n.renderHeader,g=n.onSelect,v=n.localizer,y=n.onSelectStart,b=n.onSelectEnd,w=n.onDoubleClick,_=n.onKeyPress,D=n.resourceId,j=n.longPressThreshold,N=n.isAllDay,S=n.resizable,E=n.showAllEvents;if(d)return this.renderDummy();var A=this.slotMetrics(this.props),T=A.levels,L=A.extra,O=E?Vqe:Cs,V=m.weekWrapper,W={selected:c,accessors:f,getters:h,localizer:v,components:m,onSelect:g,onDoubleClick:w,onKeyPress:_,resourceId:D,slotMetrics:A,resizable:S};return Q.createElement("div",{className:l,role:"rowgroup",ref:this.containerRef},Q.createElement(Bqe,{localizer:v,date:a,getNow:x,rtl:i,range:s,selectable:u,container:this.getContainer,getters:h,onSelectStart:y,onSelectEnd:b,onSelectSlot:this.handleSelectSlot,components:m,longPressThreshold:j,resourceId:D}),Q.createElement("div",{className:Br("rbc-row-content",E&&"rbc-row-content-scrollable"),role:"row"},p&&Q.createElement("div",{className:"rbc-row ",ref:this.headingRowRef},s.map(this.renderHeadingCell)),Q.createElement(O,null,Q.createElement(V,Object.assign({isAllDay:N},W,{rtl:this.props.rtl}),T.map(function(B,P){return Q.createElement(lV,Object.assign({key:P,segments:B},W))}),!!L.length&&Q.createElement(uV,Object.assign({segments:L,onShowMore:this.handleShowMore},W))))))}}])}(Q.Component);Np.defaultProps={minRows:0,maxRows:1/0};var wk=function(t){var r=t.label;return Q.createElement("span",{role:"columnheader","aria-sort":"none"},r)},Yqe=function(t){var r=t.label,n=t.drilldownView,a=t.onDrillDown;return n?Q.createElement("button",{type:"button",className:"rbc-button-link",onClick:a},r):Q.createElement("span",null,r)},Xqe=["date","className"],Kqe=function(t,r,n,a,i){return t.filter(function(s){return jp(s,r,n,a,i)})},D1=function(e){function t(){var r;mn(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=ua(this,t,[].concat(a)),r.getContainer=function(){return r.containerRef.current},r.renderWeek=function(s,l){var c=r.props,u=c.events,d=c.components,f=c.selectable,h=c.getNow,m=c.selected,x=c.date,p=c.localizer,g=c.longPressThreshold,v=c.accessors,y=c.getters,b=c.showAllEvents,w=r.state,_=w.needLimitMeasure,D=w.rowLimit,j=Kqe(M0(u),s[0],s[s.length-1],v,p),N=Hqe(j,v,p);return Q.createElement(Np,{key:l,ref:l===0?r.slotRowRef:void 0,container:r.getContainer,className:"rbc-month-row",getNow:h,date:x,range:s,events:N,maxRows:b?1/0:D,selected:m,selectable:f,components:d,accessors:v,getters:y,localizer:p,renderHeader:r.readerDateHeading,renderForMeasure:_,onShowMore:r.handleShowMore,onSelect:r.handleSelectEvent,onDoubleClick:r.handleDoubleClickEvent,onKeyPress:r.handleKeyPressEvent,onSelectSlot:r.handleSelectSlot,longPressThreshold:g,rtl:r.props.rtl,resizable:r.props.resizable,showAllEvents:b})},r.readerDateHeading=function(s){var l=s.date,c=s.className,u=Gs(s,Xqe),d=r.props,f=d.date,h=d.getDrilldownView,m=d.localizer,x=m.neq(f,l,"month"),p=m.isSameDate(l,f),g=h(l),v=m.format(l,"dateFormat"),y=r.props.components.dateHeader||Yqe;return Q.createElement("div",Object.assign({},u,{className:Br(c,x&&"rbc-off-range",p&&"rbc-current"),role:"cell"}),Q.createElement(y,{label:v,date:l,drilldownView:g,isOffRange:x,onDrillDown:function(w){return r.handleHeadingClick(l,g,w)}}))},r.handleSelectSlot=function(s,l){r._pendingSelection=r._pendingSelection.concat(s),clearTimeout(r._selectTimer),r._selectTimer=setTimeout(function(){return r.selectDates(l)})},r.handleHeadingClick=function(s,l,c){c.preventDefault(),r.clearSelection(),br(r.props.onDrillDown,[s,l])},r.handleSelectEvent=function(){r.clearSelection();for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];br(r.props.onSelectEvent,l)},r.handleDoubleClickEvent=function(){r.clearSelection();for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];br(r.props.onDoubleClickEvent,l)},r.handleKeyPressEvent=function(){r.clearSelection();for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];br(r.props.onKeyPressEvent,l)},r.handleShowMore=function(s,l,c,u,d){var f=r.props,h=f.popup,m=f.onDrillDown,x=f.onShowMore,p=f.getDrilldownView,g=f.doShowMoreDrillDown;if(r.clearSelection(),h){var v=BH(c,r.containerRef.current);r.setState({overlay:{date:l,events:s,position:v,target:d}})}else g&&br(m,[l,p(l)||xa.DAY]);br(x,[s,l,u])},r.overlayDisplay=function(){r.setState({overlay:null})},r.state={rowLimit:5,needLimitMeasure:!0,date:null},r.containerRef=M.createRef(),r.slotRowRef=M.createRef(),r._bgRows=[],r._pendingSelection=[],r}return da(t,e),pn(t,[{key:"componentDidMount",value:function(){var n=this,a;this.state.needLimitMeasure&&this.measureRowLimit(this.props),window.addEventListener("resize",this._resizeListener=function(){a||WH(function(){a=!1,n.setState({needLimitMeasure:!0})})},!1)}},{key:"componentDidUpdate",value:function(){this.state.needLimitMeasure&&this.measureRowLimit(this.props)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._resizeListener,!1)}},{key:"render",value:function(){var n=this.props,a=n.date,i=n.localizer,s=n.className,l=i.visibleDays(a,i),c=Wze(l,7);return this._weekCount=c.length,Q.createElement("div",{className:Br("rbc-month-view",s),role:"table","aria-label":"Month View",ref:this.containerRef},Q.createElement("div",{className:"rbc-row rbc-month-header",role:"row"},this.renderHeaders(c[0])),c.map(this.renderWeek),this.props.popup&&this.renderOverlay())}},{key:"renderHeaders",value:function(n){var a=this.props,i=a.localizer,s=a.components,l=n[0],c=n[n.length-1],u=s.header||wk;return i.range(l,c,"day").map(function(d,f){return Q.createElement("div",{key:"header_"+f,className:"rbc-header"},Q.createElement(u,{date:d,localizer:i,label:i.format(d,"weekdayFormat")}))})}},{key:"renderOverlay",value:function(){var n,a,i=this,s=(n=(a=this.state)===null||a===void 0?void 0:a.overlay)!==null&&n!==void 0?n:{},l=this.props,c=l.accessors,u=l.localizer,d=l.components,f=l.getters,h=l.selected,m=l.popupOffset,x=l.handleDragStart,p=function(){return i.setState({overlay:null})};return Q.createElement(bk,{overlay:s,accessors:c,localizer:u,components:d,getters:f,selected:h,popupOffset:m,ref:this.containerRef,handleKeyPressEvent:this.handleKeyPressEvent,handleSelectEvent:this.handleSelectEvent,handleDoubleClickEvent:this.handleDoubleClickEvent,handleDragStart:x,show:!!s.position,overlayDisplay:this.overlayDisplay,onHide:p})}},{key:"measureRowLimit",value:function(){this.setState({needLimitMeasure:!1,rowLimit:this.slotRowRef.current.getRowLimit()})}},{key:"selectDates",value:function(n){var a=this._pendingSelection.slice();this._pendingSelection=[],a.sort(function(l,c){return+l-+c});var i=new Date(a[0]),s=new Date(a[a.length-1]);s.setDate(a[a.length-1].getDate()+1),br(this.props.onSelectSlot,{slots:a,start:i,end:s,action:n.action,bounds:n.bounds,box:n.box})}},{key:"clearSelection",value:function(){clearTimeout(this._selectTimer),this._pendingSelection=[]}}],[{key:"getDerivedStateFromProps",value:function(n,a){var i=n.date,s=n.localizer;return{date:i,needLimitMeasure:s.neq(i,a.date,"month")}}}])}(Q.Component);D1.range=function(e,t){var r=t.localizer,n=r.firstVisibleDay(e,r),a=r.lastVisibleDay(e,r);return{start:n,end:a}};D1.navigate=function(e,t,r){var n=r.localizer;switch(t){case Ra.PREVIOUS:return n.add(e,-1,"month");case Ra.NEXT:return n.add(e,1,"month");default:return e}};D1.title=function(e,t){var r=t.localizer;return r.format(e,"monthHeaderFormat")};var f8=function(t){var r=t.min,n=t.max,a=t.step,i=t.slots,s=t.localizer;return"".concat(+s.startOf(r,"minutes"))+"".concat(+s.startOf(n,"minutes"))+"".concat(a,"-").concat(i)};function _k(e){for(var t=e.min,r=e.max,n=e.step,a=e.timeslots,i=e.localizer,s=f8({step:n,localizer:i}),l=1+i.getTotalMin(t,r),c=i.getMinutesFromMidnight(t),u=Math.ceil((l-1)/(n*a)),d=u*a,f=new Array(u),h=new Array(d),m=0;m<u;m++){f[m]=new Array(a);for(var x=0;x<a;x++){var p=m*a+x,g=p*n;h[p]=f[m][x]=i.getSlotDate(t,c,g)}}var v=h.length*n;h.push(i.getSlotDate(t,c,v));function y(b){var w=i.diff(t,b,"minutes")+i.getDstOffset(t,b);return Math.min(w,l)}return{groups:f,update:function(w){return f8(w)!==s?_k(w):this},dateIsInGroup:function(w,_){var D=f[_+1];return i.inRange(w,f[_][0],D?D[0]:r,"minutes")},nextSlot:function(w){var _=h[Math.min(h.findIndex(function(D){return D===w||i.eq(D,w)})+1,h.length-1)];return i.eq(_,w)&&(_=i.add(w,n,"minutes")),_},closestSlotToPosition:function(w){var _=Math.min(h.length-1,Math.max(0,Math.floor(w*d)));return h[_]},closestSlotFromPoint:function(w,_){var D=Math.abs(_.top-_.bottom);return this.closestSlotToPosition((w.y-_.top)/D)},closestSlotFromDate:function(w){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(i.lt(w,t,"minutes"))return h[0];if(i.gt(w,r,"minutes"))return h[h.length-1];var D=i.diff(t,w,"minutes");return h[(D-D%n)/n+_]},startsBeforeDay:function(w){return i.lt(w,t,"day")},startsAfterDay:function(w){return i.gt(w,r,"day")},startsBefore:function(w){return i.lt(i.merge(t,w),t,"minutes")},startsAfter:function(w){return i.gt(i.merge(r,w),r,"minutes")},getRange:function(w,_,D,j){D||(w=i.min(r,i.max(t,w))),j||(_=i.min(r,i.max(t,_)));var N=y(w),S=y(_),E=S>n*d&&!i.eq(r,_)?(N-n)/(n*d)*100:N/(n*d)*100;return{top:E,height:S/(n*d)*100-E,start:y(w),startDate:w,end:y(_),endDate:_}},getCurrentTimePosition:function(w){var _=y(w),D=_/(n*d)*100;return D}}}var Zqe=function(){function e(t,r){var n=r.accessors,a=r.slotMetrics;mn(this,e);var i=a.getRange(n.start(t),n.end(t)),s=i.start,l=i.startDate,c=i.end,u=i.endDate,d=i.top,f=i.height;this.start=s,this.end=c,this.startMs=+l,this.endMs=+u,this.top=d,this.height=f,this.data=t}return pn(e,[{key:"_width",get:function(){if(this.rows){var r=this.rows.reduce(function(a,i){return Math.max(a,i.leaves.length+1)},0)+1;return 100/r}if(this.leaves){var n=100-this.container._width;return n/(this.leaves.length+1)}return this.row._width}},{key:"width",get:function(){var r=this._width,n=Math.min(100,this._width*1.7);if(this.rows)return n;if(this.leaves)return this.leaves.length>0?n:r;var a=this.row.leaves,i=a.indexOf(this);return i===a.length-1?r:n}},{key:"xOffset",get:function(){if(this.rows)return 0;if(this.leaves)return this.container._width;var r=this.row,n=r.leaves,a=r.xOffset,i=r._width,s=n.indexOf(this)+1;return a+s*i}}])}();function Jqe(e,t,r){return Math.abs(t.start-e.start)<r||t.start>e.start&&t.start<e.end}function Qqe(e){for(var t=Hy(e,["startMs",function(l){return-l.endMs}]),r=[];t.length>0;){var n=t.shift();r.push(n);for(var a=0;a<t.length;a++){var i=t[a];if(!(n.endMs>i.startMs)){if(a>0){var s=t.splice(a,1)[0];r.push(s)}break}}}return r}function fV(e){for(var t=e.events,r=e.minimumStartDifference,n=e.slotMetrics,a=e.accessors,i=t.map(function(d){return new Zqe(d,{slotMetrics:n,accessors:a})}),s=Qqe(i),l=[],c=function(){var f=s[u],h=l.find(function(p){return p.end>f.start||Math.abs(f.start-p.start)<r});if(!h)return f.rows=[],l.push(f),1;f.container=h;for(var m=null,x=h.rows.length-1;!m&&x>=0;x--)Jqe(h.rows[x],f,r)&&(m=h.rows[x]);m?(m.leaves.push(f),f.row=m):(f.leaves=[],h.rows.push(f))},u=0;u<s.length;u++)c();return s.map(function(d){return{event:d.data,style:{top:d.top,height:d.height,width:d.width,xOffset:Math.max(0,d.xOffset)}}})}function hV(e,t,r){for(var n=0;n<e.friends.length;++n)if(!(r.indexOf(e.friends[n])>-1)){t=t>e.friends[n].idx?t:e.friends[n].idx,r.push(e.friends[n]);var a=hV(e.friends[n],t,r);t=t>a?t:a}return t}function eGe(e){var t=e.events,r=e.minimumStartDifference,n=e.slotMetrics,a=e.accessors,i=fV({events:t,minimumStartDifference:r,slotMetrics:n,accessors:a});i.sort(function(V,W){return V=V.style,W=W.style,V.top!==W.top?V.top>W.top?1:-1:V.height!==W.height?V.top+V.height<W.top+W.height?1:-1:0});for(var s=0;s<i.length;++s)i[s].friends=[],delete i[s].style.left,delete i[s].style.left,delete i[s].idx,delete i[s].size;for(var l=0;l<i.length-1;++l)for(var c=i[l],u=c.style.top,d=c.style.top+c.style.height,f=l+1;f<i.length;++f){var h=i[f],m=h.style.top,x=h.style.top+h.style.height;(m>=u&&x<=d||x>u&&x<=d||m>=u&&m<d)&&(c.friends.push(h),h.friends.push(c))}for(var p=0;p<i.length;++p){for(var g=i[p],v=[],y=0;y<100;++y)v.push(1);for(var b=0;b<g.friends.length;++b)g.friends[b].idx!==void 0&&(v[g.friends[b].idx]=0);g.idx=v.indexOf(1)}for(var w=0;w<i.length;++w){var _=0;if(!i[w].size){var D=[],j=hV(i[w],0,D);_=100/(j+1),i[w].size=_;for(var N=0;N<D.length;++N)D[N].size=_}}for(var S=0;S<i.length;++S){var E=i[S];E.style.left=E.idx*E.size;for(var A=0,T=0;T<E.friends.length;++T){var L=E.friends[T].idx;A=A>L?A:L}A<=E.idx&&(E.size=100-E.idx*E.size);var O=E.idx===0?0:3;E.style.width="calc(".concat(E.size,"% - ").concat(O,"px)"),E.style.height="calc(".concat(E.style.height,"% - 2px)"),E.style.xOffset="calc(".concat(E.style.left,"% + ").concat(O,"px)")}return i}var h8={overlap:fV,"no-overlap":eGe};function tGe(e){return!!(e&&e.constructor&&e.call&&e.apply)}function rGe(e){e.events,e.minimumStartDifference,e.slotMetrics,e.accessors;var t=e.dayLayoutAlgorithm,r=t;return t in h8&&(r=h8[t]),tGe(r)?r.apply(this,arguments):[]}var mV=function(e){function t(){return mn(this,t),ua(this,t,arguments)}return da(t,e),pn(t,[{key:"render",value:function(){var n=this.props,a=n.renderSlot,i=n.resource,s=n.group,l=n.getters,c=n.components,u=c===void 0?{}:c,d=u.timeSlotWrapper,f=d===void 0?Cs:d,h=l?l.slotGroupProp(s):{};return Q.createElement("div",Object.assign({className:"rbc-timeslot-group"},h),s.map(function(m,x){var p=l?l.slotProp(m,i):{};return Q.createElement(f,{key:x,value:m,resource:i},Q.createElement("div",Object.assign({},p,{className:Br("rbc-time-slot",p.className)}),a&&a(m,x)))}))}}])}(M.Component);function D0(e){return typeof e=="string"?e:e+"%"}function nGe(e){var t=e.style,r=e.className,n=e.event,a=e.accessors,i=e.rtl,s=e.selected,l=e.label,c=e.continuesPrior,u=e.continuesAfter,d=e.getters,f=e.onClick,h=e.onDoubleClick,m=e.isBackgroundEvent,x=e.onKeyPress,p=e.components,g=p.event,v=p.eventWrapper,y=a.title(n),b=a.tooltip(n),w=a.end(n),_=a.start(n),D=d.eventProp(n,_,w,s),j=[Q.createElement("div",{key:"1",className:"rbc-event-label"},l),Q.createElement("div",{key:"2",className:"rbc-event-content"},g?Q.createElement(g,{event:n,title:y}):y)],N=t.height,S=t.top,E=t.width,A=t.xOffset,T=Jt(Jt({},D.style),{},xc({top:D0(S),height:D0(N),width:D0(E)},i?"right":"left",D0(A)));return Q.createElement(v,Object.assign({type:"time"},e),Q.createElement("div",{role:"button",tabIndex:0,onClick:f,onDoubleClick:h,style:T,onKeyDown:x,title:b?(typeof l=="string"?l+": ":"")+b:void 0,className:Br(m?"rbc-background-event":"rbc-event",r,D.className,{"rbc-selected":s,"rbc-event-continues-earlier":c,"rbc-event-continues-later":u})},j))}var aGe=function(t){var r=t.children,n=t.className,a=t.style,i=t.innerRef;return Q.createElement("div",{className:n,style:a,ref:i},r)},iGe=Q.forwardRef(function(e,t){return Q.createElement(aGe,Object.assign({},e,{innerRef:t}))}),sGe=["dayProp"],oGe=["eventContainerWrapper","timeIndicatorWrapper"],pV=function(e){function t(){var r;mn(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=ua(this,t,[].concat(a)),r.state={selecting:!1,timeIndicatorPosition:null},r.intervalTriggered=!1,r.renderEvents=function(s){var l=s.events,c=s.isBackgroundEvent,u=r.props,d=u.rtl,f=u.selected,h=u.accessors,m=u.localizer,x=u.getters,p=u.components,g=u.step,v=u.timeslots,y=u.dayLayoutAlgorithm,b=u.resizable,w=r,_=w.slotMetrics,D=m.messages,j=rGe({events:l,accessors:h,slotMetrics:_,minimumStartDifference:Math.ceil(g*v/2),dayLayoutAlgorithm:y});return j.map(function(N,S){var E,A=N.event,T=N.style,L=h.end(A),O=h.start(A),V=(E=h.eventId(A))!==null&&E!==void 0?E:"evt_"+S,W="eventTimeRangeFormat",B,P=_.startsBeforeDay(O),F=_.startsAfterDay(L);P?W="eventTimeRangeEndFormat":F&&(W="eventTimeRangeStartFormat"),P&&F?B=D.allDay:B=m.format({start:O,end:L},W);var I=P||_.startsBefore(O),R=F||_.startsAfter(L);return Q.createElement(nGe,{style:T,event:A,label:B,key:V,getters:x,rtl:d,components:p,continuesPrior:I,continuesAfter:R,accessors:h,resource:r.props.resource,selected:_1(A,f),onClick:function(k){return r._select(Jt(Jt(Jt({},A),r.props.resource&&{sourceResource:r.props.resource}),c&&{isBackgroundEvent:!0}),k)},onDoubleClick:function(k){return r._doubleClick(A,k)},isBackgroundEvent:c,onKeyPress:function(k){return r._keyPress(A,k)},resizable:b})})},r._selectable=function(){var s=r.containerRef.current,l=r.props,c=l.longPressThreshold,u=l.localizer,d=r._selector=new oV(function(){return s},{longPressThreshold:c}),f=function(p){var g=r.props.onSelecting,v=r.state||{},y=h(p),b=y.startDate,w=y.endDate;g&&(u.eq(v.startDate,b,"minutes")&&u.eq(v.endDate,w,"minutes")||g({start:b,end:w,resourceId:r.props.resource})===!1)||(r.state.start!==y.start||r.state.end!==y.end||r.state.selecting!==y.selecting)&&r.setState(y)},h=function(p){var g=r.slotMetrics.closestSlotFromPoint(p,au(s));r.state.selecting||(r._initialSlot=g);var v=r._initialSlot;u.lte(v,g)?g=r.slotMetrics.nextSlot(g):u.gt(v,g)&&(v=r.slotMetrics.nextSlot(v));var y=r.slotMetrics.getRange(u.min(v,g),u.max(v,g));return Jt(Jt({},y),{},{selecting:!0,top:"".concat(y.top,"%"),height:"".concat(y.height,"%")})},m=function(p,g){if(!Uv(r.containerRef.current,p)){var v=h(p),y=v.startDate,b=v.endDate;r._selectSlot({startDate:y,endDate:b,action:g,box:p})}r.setState({selecting:!1})};d.on("selecting",f),d.on("selectStart",f),d.on("beforeSelect",function(x){if(r.props.selectable==="ignoreEvents")return!Uv(r.containerRef.current,x)}),d.on("click",function(x){return m(x,"click")}),d.on("doubleClick",function(x){return m(x,"doubleClick")}),d.on("select",function(x){r.state.selecting&&(r._selectSlot(Jt(Jt({},r.state),{},{action:"select",bounds:x})),r.setState({selecting:!1}))}),d.on("reset",function(){r.state.selecting&&r.setState({selecting:!1})})},r._teardownSelectable=function(){r._selector&&(r._selector.teardown(),r._selector=null)},r._selectSlot=function(s){for(var l=s.startDate,c=s.endDate,u=s.action,d=s.bounds,f=s.box,h=l,m=[];r.props.localizer.lte(h,c);)m.push(h),h=new Date(+h+r.props.step*60*1e3);br(r.props.onSelectSlot,{slots:m,start:l,end:c,resourceId:r.props.resource,action:u,bounds:d,box:f})},r._select=function(){for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];br(r.props.onSelectEvent,l)},r._doubleClick=function(){for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];br(r.props.onDoubleClickEvent,l)},r._keyPress=function(){for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];br(r.props.onKeyPressEvent,l)},r.slotMetrics=_k(r.props),r.containerRef=M.createRef(),r}return da(t,e),pn(t,[{key:"componentDidMount",value:function(){this.props.selectable&&this._selectable(),this.props.isNow&&this.setTimeIndicatorPositionUpdateInterval()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable(),this.clearTimeIndicatorInterval()}},{key:"componentDidUpdate",value:function(n,a){this.props.selectable&&!n.selectable&&this._selectable(),!this.props.selectable&&n.selectable&&this._teardownSelectable();var i=this.props,s=i.getNow,l=i.isNow,c=i.localizer,u=i.date,d=i.min,f=i.max,h=c.neq(n.getNow(),s(),"minutes");if(n.isNow!==l||h){if(this.clearTimeIndicatorInterval(),l){var m=!h&&c.eq(n.date,u,"minutes")&&a.timeIndicatorPosition===this.state.timeIndicatorPosition;this.setTimeIndicatorPositionUpdateInterval(m)}}else l&&(c.neq(n.min,d,"minutes")||c.neq(n.max,f,"minutes"))&&this.positionTimeIndicator()}},{key:"setTimeIndicatorPositionUpdateInterval",value:function(){var n=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;!this.intervalTriggered&&!a&&this.positionTimeIndicator(),this._timeIndicatorTimeout=window.setTimeout(function(){n.intervalTriggered=!0,n.positionTimeIndicator(),n.setTimeIndicatorPositionUpdateInterval()},6e4)}},{key:"clearTimeIndicatorInterval",value:function(){this.intervalTriggered=!1,window.clearTimeout(this._timeIndicatorTimeout)}},{key:"positionTimeIndicator",value:function(){var n=this.props,a=n.min,i=n.max,s=n.getNow,l=s();if(l>=a&&l<=i){var c=this.slotMetrics.getCurrentTimePosition(l);this.intervalTriggered=!0,this.setState({timeIndicatorPosition:c})}else this.clearTimeIndicatorInterval()}},{key:"render",value:function(){var n=this.props,a=n.date,i=n.max,s=n.rtl,l=n.isNow,c=n.resource,u=n.accessors,d=n.localizer,f=n.getters,h=f.dayProp,m=Gs(f,sGe),x=n.components,p=x.eventContainerWrapper,g=x.timeIndicatorWrapper,v=Gs(x,oGe);this.slotMetrics=this.slotMetrics.update(this.props);var y=this.slotMetrics,b=this.state,w=b.selecting,_=b.top,D=b.height,j=b.startDate,N=b.endDate,S={start:j,end:N},E=h(i,c),A=E.className,T=E.style,L={className:"rbc-current-time-indicator",style:{top:"".concat(this.state.timeIndicatorPosition,"%")}},O=v.dayColumnWrapper||iGe;return Q.createElement(O,{ref:this.containerRef,date:a,style:T,className:Br(A,"rbc-day-slot","rbc-time-column",l&&"rbc-now",l&&"rbc-today",w&&"rbc-slot-selecting"),slotMetrics:y,resource:c},y.groups.map(function(V,W){return Q.createElement(mV,{key:W,group:V,resource:c,getters:m,components:v})}),Q.createElement(p,{localizer:d,resource:c,accessors:u,getters:m,components:v,slotMetrics:y},Q.createElement("div",{className:Br("rbc-events-container",s&&"rtl")},this.renderEvents({events:this.props.backgroundEvents,isBackgroundEvent:!0}),this.renderEvents({events:this.props.events}))),w&&Q.createElement("div",{className:"rbc-slot-selection",style:{top:_,height:D}},Q.createElement("span",null,d.format(S,"selectRangeFormat"))),l&&this.intervalTriggered&&Q.createElement(g,L,Q.createElement("div",L)))}}])}(Q.Component);pV.defaultProps={dragThroughEvents:!0,timeslots:2};var xV=function(t){var r=t.label;return Q.createElement(Q.Fragment,null,r)},lGe=function(e){function t(){var r;mn(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=ua(this,t,[].concat(a)),r.handleHeaderClick=function(s,l,c){c.preventDefault(),br(r.props.onDrillDown,[s,l])},r.renderRow=function(s){var l=r.props,c=l.events,u=l.rtl,d=l.selectable,f=l.getNow,h=l.range,m=l.getters,x=l.localizer,p=l.accessors,g=l.components,v=l.resizable,y=p.resourceId(s),b=s?c.filter(function(w){return p.resource(w)===y}):c;return Q.createElement(Np,{isAllDay:!0,rtl:u,getNow:f,minRows:2,maxRows:r.props.allDayMaxRows+1,range:h,events:b,resourceId:y,className:"rbc-allday-cell",selectable:d,selected:r.props.selected,components:g,accessors:p,getters:m,localizer:x,onSelect:r.props.onSelectEvent,onShowMore:r.props.onShowMore,onDoubleClick:r.props.onDoubleClickEvent,onKeyPress:r.props.onKeyPressEvent,onSelectSlot:r.props.onSelectSlot,longPressThreshold:r.props.longPressThreshold,resizable:v})},r}return da(t,e),pn(t,[{key:"renderHeaderCells",value:function(n){var a=this,i=this.props,s=i.localizer,l=i.getDrilldownView,c=i.getNow,u=i.getters.dayProp,d=i.components.header,f=d===void 0?wk:d,h=c();return n.map(function(m,x){var p=l(m),g=s.format(m,"dayFormat"),v=u(m),y=v.className,b=v.style,w=Q.createElement(f,{date:m,label:g,localizer:s});return Q.createElement("div",{key:x,style:b,className:Br("rbc-header",y,s.isSameDate(m,h)&&"rbc-today")},p?Q.createElement("button",{type:"button",className:"rbc-button-link",onClick:function(D){return a.handleHeaderClick(m,p,D)}},w):Q.createElement("span",null,w))})}},{key:"render",value:function(){var n=this,a=this.props,i=a.width,s=a.rtl,l=a.resources,c=a.range,u=a.events,d=a.getNow,f=a.accessors,h=a.selectable,m=a.components,x=a.getters,p=a.scrollRef,g=a.localizer,v=a.isOverflowing,y=a.components,b=y.timeGutterHeader,w=y.resourceHeader,_=w===void 0?xV:w,D=a.resizable,j={};v&&(j[s?"marginLeft":"marginRight"]="".concat(xk()-1,"px"));var N=l.groupEvents(u);return Q.createElement("div",{style:j,ref:p,className:Br("rbc-time-header",v&&"rbc-overflowing")},Q.createElement("div",{className:"rbc-label rbc-time-header-gutter",style:{width:i,minWidth:i,maxWidth:i}},b&&Q.createElement(b,null)),l.map(function(S,E){var A=Oi(S,2),T=A[0],L=A[1];return Q.createElement("div",{className:"rbc-time-header-content",key:T||E},L&&Q.createElement("div",{className:"rbc-row rbc-row-resource",key:"resource_".concat(E)},Q.createElement("div",{className:"rbc-header"},Q.createElement(_,{index:E,label:f.resourceTitle(L),resource:L}))),Q.createElement("div",{className:"rbc-row rbc-time-header-cell".concat(c.length<=1?" rbc-time-header-cell-single-day":"")},n.renderHeaderCells(c)),Q.createElement(Np,{isAllDay:!0,rtl:s,getNow:d,minRows:2,maxRows:n.props.allDayMaxRows+1,range:c,events:N.get(T)||[],resourceId:L&&T,className:"rbc-allday-cell",selectable:h,selected:n.props.selected,components:m,accessors:f,getters:x,localizer:g,onSelect:n.props.onSelectEvent,onShowMore:n.props.onShowMore,onDoubleClick:n.props.onDoubleClickEvent,onKeyDown:n.props.onKeyPressEvent,onSelectSlot:n.props.onSelectSlot,longPressThreshold:n.props.longPressThreshold,resizable:D}))}))}}])}(Q.Component),cGe=function(e){function t(){var r;mn(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=ua(this,t,[].concat(a)),r.handleHeaderClick=function(s,l,c){c.preventDefault(),br(r.props.onDrillDown,[s,l])},r}return da(t,e),pn(t,[{key:"renderHeaderCells",value:function(n){var a=this,i=this.props,s=i.localizer,l=i.getDrilldownView,c=i.getNow,u=i.getters.dayProp,d=i.components,f=d.header,h=f===void 0?wk:f,m=d.resourceHeader,x=m===void 0?xV:m,p=i.resources,g=i.accessors,v=i.events,y=i.rtl,b=i.selectable,w=i.components,_=i.getters,D=i.resizable,j=c(),N=p.groupEvents(v);return n.map(function(S,E){var A=l(S),T=s.format(S,"dayFormat"),L=u(S),O=L.className,V=L.style,W=Q.createElement(h,{date:S,label:T,localizer:s});return Q.createElement("div",{key:E,className:"rbc-time-header-content rbc-resource-grouping"},Q.createElement("div",{className:"rbc-row rbc-time-header-cell".concat(n.length<=1?" rbc-time-header-cell-single-day":"")},Q.createElement("div",{style:V,className:Br("rbc-header",O,s.isSameDate(S,j)&&"rbc-today")},A?Q.createElement("button",{type:"button",className:"rbc-button-link",onClick:function(P){return a.handleHeaderClick(S,A,P)}},W):Q.createElement("span",null,W))),Q.createElement("div",{className:"rbc-row"},p.map(function(B,P){var F=Oi(B,2),I=F[0],R=F[1];return Q.createElement("div",{key:"resource_".concat(I,"_").concat(P),className:Br("rbc-header",O,s.isSameDate(S,j)&&"rbc-today")},Q.createElement(x,{index:P,label:g.resourceTitle(R),resource:R}))})),Q.createElement("div",{className:"rbc-row rbc-m-b-negative-3 rbc-h-full"},p.map(function(B,P){var F=Oi(B,2),I=F[0],R=F[1],C=(N.get(I)||[]).filter(function(k){return s.isSameDate(k.start,S)||s.isSameDate(k.end,S)});return Q.createElement(Np,{key:"resource_".concat(I,"_").concat(P),isAllDay:!0,rtl:y,getNow:c,minRows:2,maxRows:a.props.allDayMaxRows+1,range:[S],events:C,resourceId:R&&I,className:"rbc-allday-cell",selectable:b,selected:a.props.selected,components:w,accessors:g,getters:_,localizer:s,onSelect:a.props.onSelectEvent,onShowMore:a.props.onShowMore,onDoubleClick:a.props.onDoubleClickEvent,onKeyDown:a.props.onKeyPressEvent,onSelectSlot:a.props.onSelectSlot,longPressThreshold:a.props.longPressThreshold,resizable:D})})))})}},{key:"render",value:function(){var n=this.props,a=n.width,i=n.rtl,s=n.range,l=n.scrollRef,c=n.isOverflowing,u=n.components.timeGutterHeader,d={};return c&&(d[i?"marginLeft":"marginRight"]="".concat(xk()-1,"px")),Q.createElement("div",{style:d,ref:l,className:Br("rbc-time-header",c&&"rbc-overflowing")},Q.createElement("div",{className:"rbc-label rbc-time-header-gutter",style:{width:a,minWidth:a,maxWidth:a}},u&&Q.createElement(u,null)),this.renderHeaderCells(s))}}])}(Q.Component);function uGe(e){var t=e.min,r=e.max,n=e.localizer;return n.getTimezoneOffset(t)!==n.getTimezoneOffset(r)?{start:n.add(t,-1,"day"),end:n.add(r,-1,"day")}:{start:t,end:r}}var dGe=function(t){var r=t.min,n=t.max,a=t.timeslots,i=t.step,s=t.localizer,l=t.getNow,c=t.resource,u=t.components,d=t.getters,f=t.gutterRef,h=u.timeGutterWrapper,m=M.useMemo(function(){return uGe({min:r,max:n,localizer:s})},[r==null?void 0:r.toISOString(),n==null?void 0:n.toISOString(),s]),x=m.start,p=m.end,g=M.useState(_k({min:x,max:p,timeslots:a,step:i,localizer:s})),v=Oi(g,2),y=v[0],b=v[1];M.useEffect(function(){y&&b(y.update({min:x,max:p,timeslots:a,step:i,localizer:s}))},[x==null?void 0:x.toISOString(),p==null?void 0:p.toISOString(),a,i]);var w=M.useCallback(function(_,D){if(D)return null;var j=y.dateIsInGroup(l(),D);return Q.createElement("span",{className:Br("rbc-label",j&&"rbc-now")},s.format(_,"timeGutterFormat"))},[y,s,l]);return Q.createElement(h,{slotMetrics:y},Q.createElement("div",{className:"rbc-time-gutter rbc-time-column",ref:f},y.groups.map(function(_,D){return Q.createElement(mV,{key:D,group:_,resource:c,components:u,renderSlot:w,getters:d})})))},fGe=Q.forwardRef(function(e,t){return Q.createElement(dGe,Object.assign({gutterRef:t},e))}),c_={};function hGe(e,t){return{map:function(n){return e?e.map(function(a,i){return n([t.resourceId(a),a],i)}):[n([c_,null],0)]},groupEvents:function(n){var a=new Map;return e?(n.forEach(function(i){var s=t.resource(i)||c_;if(Array.isArray(s))s.forEach(function(c){var u=a.get(c)||[];u.push(i),a.set(c,u)});else{var l=a.get(s)||[];l.push(i),a.set(s,l)}}),a):(a.set(c_,n),a)}}}var Uf=function(e){function t(r){var n;return mn(this,t),n=ua(this,t,[r]),n.handleScroll=function(a){n.scrollRef.current&&(n.scrollRef.current.scrollLeft=a.target.scrollLeft)},n.handleResize=function(){W6(n.rafHandle),n.rafHandle=WH(n.checkOverflow)},n.handleKeyPressEvent=function(){n.clearSelection();for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];br(n.props.onKeyPressEvent,i)},n.handleSelectEvent=function(){n.clearSelection();for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];br(n.props.onSelectEvent,i)},n.handleDoubleClickEvent=function(){n.clearSelection();for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];br(n.props.onDoubleClickEvent,i)},n.handleShowMore=function(a,i,s,l,c){var u=n.props,d=u.popup,f=u.onDrillDown,h=u.onShowMore,m=u.getDrilldownView,x=u.doShowMoreDrillDown;if(n.clearSelection(),d){var p=BH(s,n.containerRef.current);n.setState({overlay:{date:i,events:a,position:Jt(Jt({},p),{},{width:"200px"}),target:c}})}else x&&br(f,[i,m(i)||xa.DAY]);br(h,[a,i,l])},n.handleSelectAllDaySlot=function(a,i){var s=n.props.onSelectSlot,l=new Date(a[0]),c=new Date(a[a.length-1]);c.setDate(a[a.length-1].getDate()+1),br(s,{slots:a,start:l,end:c,action:i.action,resourceId:i.resourceId})},n.overlayDisplay=function(){n.setState({overlay:null})},n.checkOverflow=function(){if(!n._updatingOverflow){var a=n.contentRef.current;if(a!=null&&a.scrollHeight){var i=a.scrollHeight>a.clientHeight;n.state.isOverflowing!==i&&(n._updatingOverflow=!0,n.setState({isOverflowing:i},function(){n._updatingOverflow=!1}))}}},n.memoizedResources=JH(function(a,i){return hGe(a,i)}),n.state={gutterWidth:void 0,isOverflowing:null},n.scrollRef=Q.createRef(),n.contentRef=Q.createRef(),n.containerRef=Q.createRef(),n._scrollRatio=null,n.gutterRef=M.createRef(),n}return da(t,e),pn(t,[{key:"getSnapshotBeforeUpdate",value:function(){return this.checkOverflow(),null}},{key:"componentDidMount",value:function(){this.props.width==null&&this.measureGutter(),this.calculateScroll(),this.applyScroll(),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize),W6(this.rafHandle),this.measureGutterAnimationFrameRequest&&window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest)}},{key:"componentDidUpdate",value:function(){this.applyScroll()}},{key:"renderDayColumn",value:function(n,a,i,s,l,c,u,d,f,h){var m=this.props,x=m.min,p=m.max,g=(s.get(a)||[]).filter(function(y){return c.inRange(n,u.start(y),u.end(y),"day")}),v=(l.get(a)||[]).filter(function(y){return c.inRange(n,u.start(y),u.end(y),"day")});return Q.createElement(pV,Object.assign({},this.props,{localizer:c,min:c.merge(n,x),max:c.merge(n,p),resource:i&&a,components:d,isNow:c.isSameDate(n,h),key:"".concat(a,"-").concat(n),date:n,events:g,backgroundEvents:v,dayLayoutAlgorithm:f}))}},{key:"renderResourcesFirst",value:function(n,a,i,s,l,c,u,d,f){var h=this;return a.map(function(m){var x=Oi(m,2),p=x[0],g=x[1];return n.map(function(v){return h.renderDayColumn(v,p,g,i,s,l,c,d,f,u)})})}},{key:"renderRangeFirst",value:function(n,a,i,s,l,c,u,d,f){var h=this;return n.map(function(m){return Q.createElement("div",{style:{display:"flex",minHeight:"100%",flex:1},key:m},a.map(function(x){var p=Oi(x,2),g=p[0],v=p[1];return Q.createElement("div",{style:{flex:1},key:c.resourceId(v)},h.renderDayColumn(m,g,v,i,s,l,c,d,f,u))}))})}},{key:"renderEvents",value:function(n,a,i,s){var l=this.props,c=l.accessors,u=l.localizer,d=l.resourceGroupingLayout,f=l.components,h=l.dayLayoutAlgorithm,m=this.memoizedResources(this.props.resources,c),x=m.groupEvents(a),p=m.groupEvents(i);return d?this.renderRangeFirst(n,m,x,p,u,c,s,f,h):this.renderResourcesFirst(n,m,x,p,u,c,s,f,h)}},{key:"render",value:function(){var n,a=this.props,i=a.events,s=a.backgroundEvents,l=a.range,c=a.width,u=a.rtl,d=a.selected,f=a.getNow,h=a.resources,m=a.components,x=a.accessors,p=a.getters,g=a.localizer,v=a.min,y=a.max,b=a.showMultiDayTimes,w=a.longPressThreshold,_=a.resizable,D=a.resourceGroupingLayout;c=c||this.state.gutterWidth;var j=l[0],N=l[l.length-1];this.slots=l.length;var S=[],E=[],A=[];i.forEach(function(L){if(jp(L,j,N,x,g)){var O=x.start(L),V=x.end(L);x.allDay(L)||g.startAndEndAreDateOnly(O,V)||!b&&!g.isSameDate(O,V)?S.push(L):E.push(L)}}),s.forEach(function(L){jp(L,j,N,x,g)&&A.push(L)}),S.sort(function(L,O){return $j(L,O,x,g)});var T={range:l,events:S,width:c,rtl:u,getNow:f,localizer:g,selected:d,allDayMaxRows:this.props.showAllEvents?1/0:(n=this.props.allDayMaxRows)!==null&&n!==void 0?n:1/0,resources:this.memoizedResources(h,x),selectable:this.props.selectable,accessors:x,getters:p,components:m,scrollRef:this.scrollRef,isOverflowing:this.state.isOverflowing,longPressThreshold:w,onSelectSlot:this.handleSelectAllDaySlot,onSelectEvent:this.handleSelectEvent,onShowMore:this.handleShowMore,onDoubleClickEvent:this.props.onDoubleClickEvent,onKeyPressEvent:this.props.onKeyPressEvent,onDrillDown:this.props.onDrillDown,getDrilldownView:this.props.getDrilldownView,resizable:_};return Q.createElement("div",{className:Br("rbc-time-view",h&&"rbc-time-view-resources"),ref:this.containerRef},h&&h.length>1&&D?Q.createElement(cGe,T):Q.createElement(lGe,T),this.props.popup&&this.renderOverlay(),Q.createElement("div",{ref:this.contentRef,className:"rbc-time-content",onScroll:this.handleScroll},Q.createElement(fGe,{date:j,ref:this.gutterRef,localizer:g,min:g.merge(j,v),max:g.merge(j,y),step:this.props.step,getNow:this.props.getNow,timeslots:this.props.timeslots,components:m,className:"rbc-time-gutter",getters:p}),this.renderEvents(l,E,A,f())))}},{key:"renderOverlay",value:function(){var n,a,i=this,s=(n=(a=this.state)===null||a===void 0?void 0:a.overlay)!==null&&n!==void 0?n:{},l=this.props,c=l.accessors,u=l.localizer,d=l.components,f=l.getters,h=l.selected,m=l.popupOffset,x=l.handleDragStart,p=function(){return i.setState({overlay:null})};return Q.createElement(bk,{overlay:s,accessors:c,localizer:u,components:d,getters:f,selected:h,popupOffset:m,ref:this.containerRef,handleKeyPressEvent:this.handleKeyPressEvent,handleSelectEvent:this.handleSelectEvent,handleDoubleClickEvent:this.handleDoubleClickEvent,handleDragStart:x,show:!!s.position,overlayDisplay:this.overlayDisplay,onHide:p})}},{key:"clearSelection",value:function(){clearTimeout(this._selectTimer),this._pendingSelection=[]}},{key:"measureGutter",value:function(){var n=this;this.measureGutterAnimationFrameRequest&&window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest),this.measureGutterAnimationFrameRequest=window.requestAnimationFrame(function(){var a,i=(a=n.gutterRef)!==null&&a!==void 0&&a.current?Rj(n.gutterRef.current):void 0;i&&n.state.gutterWidth!==i&&n.setState({gutterWidth:i})})}},{key:"applyScroll",value:function(){if(this._scrollRatio!=null&&this.props.enableAutoScroll===!0){var n=this.contentRef.current;n.scrollTop=n.scrollHeight*this._scrollRatio,this._scrollRatio=null}}},{key:"calculateScroll",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props,a=n.min,i=n.max,s=n.scrollToTime,l=n.localizer,c=l.diff(l.merge(s,a),s,"milliseconds"),u=l.diff(a,i,"milliseconds");this._scrollRatio=c/u}}])}(M.Component);Uf.defaultProps={step:30,timeslots:2,resourceGroupingLayout:!1};var mGe=["date","localizer","min","max","scrollToTime","enableAutoScroll"],j1=function(e){function t(){return mn(this,t),ua(this,t,arguments)}return da(t,e),pn(t,[{key:"render",value:function(){var n=this.props,a=n.date,i=n.localizer,s=n.min,l=s===void 0?i.startOf(new Date,"day"):s,c=n.max,u=c===void 0?i.endOf(new Date,"day"):c,d=n.scrollToTime,f=d===void 0?i.startOf(new Date,"day"):d,h=n.enableAutoScroll,m=h===void 0?!0:h,x=Gs(n,mGe),p=t.range(a,{localizer:i});return Q.createElement(Uf,Object.assign({},x,{range:p,eventOffset:10,localizer:i,min:l,max:u,scrollToTime:f,enableAutoScroll:m}))}}])}(Q.Component);j1.range=function(e,t){var r=t.localizer;return[r.startOf(e,"day")]};j1.navigate=function(e,t,r){var n=r.localizer;switch(t){case Ra.PREVIOUS:return n.add(e,-1,"day");case Ra.NEXT:return n.add(e,1,"day");default:return e}};j1.title=function(e,t){var r=t.localizer;return r.format(e,"dayHeaderFormat")};var pGe=["date","localizer","min","max","scrollToTime","enableAutoScroll"],Pl=function(e){function t(){return mn(this,t),ua(this,t,arguments)}return da(t,e),pn(t,[{key:"render",value:function(){var n=this.props,a=n.date,i=n.localizer,s=n.min,l=s===void 0?i.startOf(new Date,"day"):s,c=n.max,u=c===void 0?i.endOf(new Date,"day"):c,d=n.scrollToTime,f=d===void 0?i.startOf(new Date,"day"):d,h=n.enableAutoScroll,m=h===void 0?!0:h,x=Gs(n,pGe),p=t.range(a,this.props);return Q.createElement(Uf,Object.assign({},x,{range:p,eventOffset:15,localizer:i,min:l,max:u,scrollToTime:f,enableAutoScroll:m}))}}])}(Q.Component);Pl.defaultProps=Uf.defaultProps;Pl.navigate=function(e,t,r){var n=r.localizer;switch(t){case Ra.PREVIOUS:return n.add(e,-1,"week");case Ra.NEXT:return n.add(e,1,"week");default:return e}};Pl.range=function(e,t){var r=t.localizer,n=r.startOfWeek(),a=r.startOf(e,"week",n),i=r.endOf(e,"week",n);return r.range(a,i)};Pl.title=function(e,t){var r=t.localizer,n=Pl.range(e,{localizer:r}),a=QH(n),i=a[0],s=a.slice(1);return r.format({start:i,end:s.pop()},"dayRangeHeaderFormat")};var xGe=["date","localizer","min","max","scrollToTime","enableAutoScroll"];function Dk(e,t){return Pl.range(e,t).filter(function(r){return[6,0].indexOf(r.getDay())===-1})}var Nx=function(e){function t(){return mn(this,t),ua(this,t,arguments)}return da(t,e),pn(t,[{key:"render",value:function(){var n=this.props,a=n.date,i=n.localizer,s=n.min,l=s===void 0?i.startOf(new Date,"day"):s,c=n.max,u=c===void 0?i.endOf(new Date,"day"):c,d=n.scrollToTime,f=d===void 0?i.startOf(new Date,"day"):d,h=n.enableAutoScroll,m=h===void 0?!0:h,x=Gs(n,xGe),p=Dk(a,this.props);return Q.createElement(Uf,Object.assign({},x,{range:p,eventOffset:15,localizer:i,min:l,max:u,scrollToTime:f,enableAutoScroll:m}))}}])}(Q.Component);Nx.defaultProps=Uf.defaultProps;Nx.range=Dk;Nx.navigate=Pl.navigate;Nx.title=function(e,t){var r=t.localizer,n=Dk(e,{localizer:r}),a=QH(n),i=a[0],s=a.slice(1);return r.format({start:i,end:s.pop()},"dayRangeHeaderFormat")};var N1=30;function S1(e){var t=e.accessors,r=e.components,n=e.date,a=e.events,i=e.getters,s=e.length,l=s===void 0?N1:s,c=e.localizer,u=e.onDoubleClickEvent,d=e.onSelectEvent,f=e.selected,h=M.useRef(null),m=M.useRef(null),x=M.useRef(null),p=M.useRef(null),g=M.useRef(null);M.useEffect(function(){b()});var v=function(N,S,E){var A=r.event,T=r.date;return S=S.filter(function(L){return jp(L,c.startOf(N,"day"),c.endOf(N,"day"),t,c)}),S.map(function(L,O){var V=t.title(L),W=t.end(L),B=t.start(L),P=i.eventProp(L,B,W,_1(L,f)),F=O===0&&c.format(N,"agendaDateFormat"),I=O===0?Q.createElement("td",{rowSpan:S.length,className:"rbc-agenda-date-cell"},T?Q.createElement(T,{day:N,label:F}):F):!1;return Q.createElement("tr",{key:E+"_"+O,className:P.className,style:P.style},I,Q.createElement("td",{className:"rbc-agenda-time-cell"},y(N,L)),Q.createElement("td",{className:"rbc-agenda-event-cell",onClick:function(C){return d&&d(L,C)},onDoubleClick:function(C){return u&&u(L,C)}},A?Q.createElement(A,{event:L,title:V}):V))},[])},y=function(N,S){var E="",A=r.time,T=c.messages.allDay,L=t.end(S),O=t.start(S);return t.allDay(S)||(c.eq(O,L)?T=c.format(O,"agendaTimeFormat"):c.isSameDate(O,L)?T=c.format({start:O,end:L},"agendaTimeRangeFormat"):c.isSameDate(N,O)?T=c.format(O,"agendaTimeFormat"):c.isSameDate(N,L)&&(T=c.format(L,"agendaTimeFormat"))),c.gt(N,O,"day")&&(E="rbc-continues-prior"),c.lt(N,L,"day")&&(E+=" rbc-continues-after"),Q.createElement("span",{className:E.trim()},A?Q.createElement(A,{event:S,day:N,label:T}):T)},b=function(){if(g.current){var N=h.current,S=g.current.firstChild;if(S){var E=p.current.scrollHeight>p.current.clientHeight,A=[],T=A;A=[Rj(S.children[0]),Rj(S.children[1])],(T[0]!==A[0]||T[1]!==A[1])&&(m.current.style.width=A[0]+"px",x.current.style.width=A[1]+"px"),E?(m1e(N,"rbc-header-overflowing"),N.style.marginRight=xk()+"px"):p1e(N,"rbc-header-overflowing")}}},w=c.messages,_=c.add(n,l,"day"),D=c.range(n,_,"day");return a=a.filter(function(j){return jp(j,c.startOf(n,"day"),c.endOf(_,"day"),t,c)}),a.sort(function(j,N){return+t.start(j)-+t.start(N)}),Q.createElement("div",{className:"rbc-agenda-view"},a.length!==0?Q.createElement(Q.Fragment,null,Q.createElement("table",{ref:h,className:"rbc-agenda-table"},Q.createElement("thead",null,Q.createElement("tr",null,Q.createElement("th",{className:"rbc-header",ref:m},w.date),Q.createElement("th",{className:"rbc-header",ref:x},w.time),Q.createElement("th",{className:"rbc-header"},w.event)))),Q.createElement("div",{className:"rbc-agenda-content",ref:p},Q.createElement("table",{className:"rbc-agenda-table"},Q.createElement("tbody",{ref:g},D.map(function(j,N){return v(j,a,N)}))))):Q.createElement("span",{className:"rbc-agenda-empty"},w.noEventsInRange))}S1.range=function(e,t){var r=t.length,n=r===void 0?N1:r,a=t.localizer,i=a.add(e,n,"day");return{start:e,end:i}};S1.navigate=function(e,t,r){var n=r.length,a=n===void 0?N1:n,i=r.localizer;switch(t){case Ra.PREVIOUS:return i.add(e,-a,"day");case Ra.NEXT:return i.add(e,a,"day");default:return e}};S1.title=function(e,t){var r=t.length,n=r===void 0?N1:r,a=t.localizer,i=a.add(e,n,"day");return a.format({start:e,end:i},"agendaHeaderFormat")};var $0=xc(xc(xc(xc(xc({},xa.MONTH,D1),xa.WEEK,Pl),xa.WORK_WEEK,Nx),xa.DAY,j1),xa.AGENDA,S1),gGe=["action","date","today"];function vGe(e,t){var r=t.action,n=t.date,a=t.today,i=Gs(t,gGe);switch(e=typeof e=="string"?$0[e]:e,r){case Ra.TODAY:n=a||new Date;break;case Ra.DATE:break;default:fp(e&&typeof e.navigate=="function","Calendar View components must implement a static `.navigate(date, action)` method.s"),n=e.navigate(n,r,i)}return n}function yGe(e,t){var r=null;return typeof t=="function"?r=t(e):typeof t=="string"&&Co(e)==="object"&&e!=null&&t in e&&(r=e[t]),r}var co=function(t){return function(r){return yGe(r,t)}},bGe=["view","date","getNow","onNavigate"],wGe=["view","toolbar","events","backgroundEvents","resourceGroupingLayout","style","className","elementProps","date","getNow","length","showMultiDayTimes","onShowMore","doShowMoreDrillDown","components","formats","messages","culture"];function gV(e){if(Array.isArray(e))return e;for(var t=[],r=0,n=Object.entries(e);r<n.length;r++){var a=Oi(n[r],2),i=a[0],s=a[1];s&&t.push(i)}return t}function _Ge(e,t){var r=t.views,n=gV(r);return n.indexOf(e)!==-1}var vV=function(e){function t(){var r;mn(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=ua(this,t,[].concat(a)),r.getViews=function(){var s=r.props.views;return Array.isArray(s)?JVe(s,function(l,c){return l[c]=$0[c]},{}):Co(s)==="object"?k$(s,function(l,c){return l===!0?$0[c]:l}):$0},r.getView=function(){var s=r.getViews();return s[r.props.view]},r.getDrilldownView=function(s){var l=r.props,c=l.view,u=l.drilldownView,d=l.getDrilldownView;return d?d(s,c,Object.keys(r.getViews())):u},r.handleRangeChange=function(s,l,c){var u=r.props,d=u.onRangeChange,f=u.localizer;d&&l.range&&d(l.range(s,{localizer:f}),c)},r.handleNavigate=function(s,l){var c=r.props,u=c.view,d=c.date,f=c.getNow,h=c.onNavigate,m=Gs(c,bGe),x=r.getView(),p=f();d=vGe(x,Jt(Jt({},m),{},{action:s,date:l||d||p,today:p})),h(d,u,s),r.handleRangeChange(d,x)},r.handleViewChange=function(s){s!==r.props.view&&_Ge(s,r.props)&&r.props.onView(s);var l=r.getViews();r.handleRangeChange(r.props.date||r.props.getNow(),l[s],s)},r.handleSelectEvent=function(){for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];br(r.props.onSelectEvent,l)},r.handleDoubleClickEvent=function(){for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];br(r.props.onDoubleClickEvent,l)},r.handleKeyPressEvent=function(){for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];br(r.props.onKeyPressEvent,l)},r.handleSelectSlot=function(s){br(r.props.onSelectSlot,s)},r.handleDrillDown=function(s,l){var c=r.props.onDrillDown;if(c){c(s,l,r.drilldownView);return}l&&r.handleViewChange(l),r.handleNavigate(Ra.DATE,s)},r.state={context:t.getContext(r.props)},r}return da(t,e),pn(t,[{key:"render",value:function(){var n=this.props,a=n.view,i=n.toolbar,s=n.events,l=n.backgroundEvents,c=n.resourceGroupingLayout,u=n.style,d=n.className,f=n.elementProps,h=n.date,m=n.getNow,x=n.length,p=n.showMultiDayTimes,g=n.onShowMore,v=n.doShowMoreDrillDown;n.components,n.formats,n.messages,n.culture;var y=Gs(n,wGe);h=h||m();var b=this.getView(),w=this.state.context,_=w.accessors,D=w.components,j=w.getters,N=w.localizer,S=w.viewNames,E=D.toolbar||Nqe,A=b.title(h,{localizer:N,length:x});return Q.createElement("div",Object.assign({},f,{className:Br(d,"rbc-calendar",y.rtl&&"rbc-rtl"),style:u}),i&&Q.createElement(E,{date:h,view:a,views:S,label:A,onView:this.handleViewChange,onNavigate:this.handleNavigate,localizer:N}),Q.createElement(b,Object.assign({},y,{events:s,backgroundEvents:l,date:h,getNow:m,length:x,localizer:N,getters:j,components:D,accessors:_,showMultiDayTimes:p,getDrilldownView:this.getDrilldownView,onNavigate:this.handleNavigate,onDrillDown:this.handleDrillDown,onSelectEvent:this.handleSelectEvent,onDoubleClickEvent:this.handleDoubleClickEvent,onKeyPressEvent:this.handleKeyPressEvent,onSelectSlot:this.handleSelectSlot,onShowMore:g,doShowMoreDrillDown:v,resourceGroupingLayout:c})))}}],[{key:"getDerivedStateFromProps",value:function(n){return{context:t.getContext(n)}}},{key:"getContext",value:function(n){var a=n.startAccessor,i=n.endAccessor,s=n.allDayAccessor,l=n.tooltipAccessor,c=n.titleAccessor,u=n.resourceAccessor,d=n.resourceIdAccessor,f=n.resourceTitleAccessor,h=n.eventIdAccessor,m=n.eventPropGetter,x=n.backgroundEventPropGetter,p=n.slotPropGetter,g=n.slotGroupPropGetter,v=n.dayPropGetter,y=n.view,b=n.views,w=n.localizer,_=n.culture,D=n.messages,j=D===void 0?{}:D,N=n.components,S=N===void 0?{}:N,E=n.formats,A=E===void 0?{}:E,T=gV(b),L=Eqe(j);return{viewNames:T,localizer:jqe(w,_,A,L),getters:{eventProp:function(){return m&&m.apply(void 0,arguments)||{}},backgroundEventProp:function(){return x&&x.apply(void 0,arguments)||{}},slotProp:function(){return p&&p.apply(void 0,arguments)||{}},slotGroupProp:function(){return g&&g.apply(void 0,arguments)||{}},dayProp:function(){return v&&v.apply(void 0,arguments)||{}}},components:$Ve(S[y]||{},EL(S,T),{eventWrapper:Cs,backgroundEventWrapper:Cs,eventContainerWrapper:Cs,dateCellWrapper:Cs,weekWrapper:Cs,timeSlotWrapper:Cs,timeGutterWrapper:Cs,timeIndicatorWrapper:Cs}),accessors:{start:co(a),end:co(i),allDay:co(s),tooltip:co(l),title:co(c),resource:co(u),resourceId:co(d),resourceTitle:co(f),eventId:co(h)}}}}])}(Q.Component);vV.defaultProps={events:[],backgroundEvents:[],elementProps:{},popup:!1,toolbar:!0,view:xa.MONTH,views:[xa.MONTH,xa.WEEK,xa.DAY,xa.AGENDA],step:30,length:30,allDayMaxRows:1/0,doShowMoreDrillDown:!0,drilldownView:xa.DAY,titleAccessor:"title",tooltipAccessor:"title",allDayAccessor:"allDay",startAccessor:"start",endAccessor:"end",resourceAccessor:"resourceId",resourceIdAccessor:"id",resourceTitleAccessor:"title",eventIdAccessor:"id",longPressThreshold:250,getNow:function(){return new Date},dayLayoutAlgorithm:"overlap"};var DGe=kH(vV,{view:"onView",date:"onNavigate",selected:"onSelectEvent"}),jGe=function(t,r,n){var a=t.start,i=t.end;return n.format(a,"MMMM DD",r)+"  "+n.format(i,n.eq(a,i,"month")?"DD":"MMMM DD",r)},NGe=function(t,r,n){var a=t.start,i=t.end;return n.format(a,"L",r)+"  "+n.format(i,"L",r)},u_=function(t,r,n){var a=t.start,i=t.end;return n.format(a,"LT",r)+"  "+n.format(i,"LT",r)},SGe=function(t,r,n){var a=t.start;return n.format(a,"LT",r)+"  "},EGe=function(t,r,n){var a=t.end;return"  "+n.format(a,"LT",r)},TGe={dateFormat:"DD",dayFormat:"DD ddd",weekdayFormat:"ddd",selectRangeFormat:u_,eventTimeRangeFormat:u_,eventTimeRangeStartFormat:SGe,eventTimeRangeEndFormat:EGe,timeGutterFormat:"LT",monthHeaderFormat:"MMMM YYYY",dayHeaderFormat:"dddd MMM DD",dayRangeHeaderFormat:jGe,agendaHeaderFormat:NGe,agendaDateFormat:"ddd MMM DD",agendaTimeFormat:"LT",agendaTimeRangeFormat:u_};function rl(e){var t=e&&e.toLowerCase();return t==="FullYear"?t="year":t||(t=void 0),t}function kGe(e){var t=function(C,k){return k?C.locale(k):C};function r(R){return e(R).toDate().getTimezoneOffset()}function n(R,C){var k,z,q=e(R).local(),K=e(C).local();if(!e.tz)return q.toDate().getTimezoneOffset()-K.toDate().getTimezoneOffset();var se=(k=q==null||(z=q._z)===null||z===void 0?void 0:z.name)!==null&&k!==void 0?k:e.tz.guess(),ie=e.tz.zone(se).utcOffset(+q),ee=e.tz.zone(se).utcOffset(+K);return ie-ee}function a(R){var C=e(R).startOf("day");return n(C,R)}function i(R,C,k){var z=rl(k),q=z?e(R).startOf(z):e(R),K=z?e(C).startOf(z):e(C);return[q,K,z]}function s(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,C=arguments.length>1?arguments[1]:void 0,k=rl(C);return k?e(R).startOf(k).toDate():e(R).toDate()}function l(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,C=arguments.length>1?arguments[1]:void 0,k=rl(C);return k?e(R).endOf(k).toDate():e(R).toDate()}function c(R,C,k){var z=i(R,C,k),q=Oi(z,3),K=q[0],se=q[1],ie=q[2];return K.isSame(se,ie)}function u(R,C,k){return!c(R,C,k)}function d(R,C,k){var z=i(R,C,k),q=Oi(z,3),K=q[0],se=q[1],ie=q[2];return K.isAfter(se,ie)}function f(R,C,k){var z=i(R,C,k),q=Oi(z,3),K=q[0],se=q[1],ie=q[2];return K.isBefore(se,ie)}function h(R,C,k){var z=i(R,C,k),q=Oi(z,3),K=q[0],se=q[1],ie=q[2];return K.isSameOrBefore(se,ie)}function m(R,C,k){var z=i(R,C,k),q=Oi(z,3),K=q[0],se=q[1],ie=q[2];return K.isSameOrBefore(se,ie)}function x(R,C,k){var z=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"day",q=rl(z),K=e(R),se=e(C),ie=e(k);return K.isBetween(se,ie,q,"[]")}function p(R,C){var k=e(R),z=e(C),q=e.min(k,z);return q.toDate()}function g(R,C){var k=e(R),z=e(C),q=e.max(k,z);return q.toDate()}function v(R,C){if(!R&&!C)return null;var k=e(C).format("HH:mm:ss"),z=e(R).startOf("day").format("MM/DD/YYYY");return e("".concat(z," ").concat(k),"MM/DD/YYYY HH:mm:ss").toDate()}function y(R,C,k){var z=rl(k);return e(R).add(C,z).toDate()}function b(R,C){for(var k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"day",z=rl(k),q=e(R).toDate(),K=[];m(q,C);)K.push(q),q=y(q,1,z);return K}function w(R,C){var k=rl(C),z=s(R,k);return c(z,R)?z:y(z,1,k)}function _(R,C){var k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"day",z=rl(k),q=e(R),K=e(C);return K.diff(q,z)}function D(R){var C=e(R);return C.minutes()}function j(R){var C=R?e.localeData(R):e.localeData();return C?C.firstDayOfWeek():0}function N(R){return e(R).startOf("month").startOf("week").toDate()}function S(R){return e(R).endOf("month").endOf("week").toDate()}function E(R){for(var C=N(R),k=S(R),z=[];m(C,k);)z.push(C),C=y(C,1,"d");return z}function A(R,C,k){return e(R).startOf("day").minute(C+k).toDate()}function T(R,C){return _(R,C,"minutes")}function L(R){var C=e(R).startOf("day"),k=e(R);return k.diff(C,"minutes")+a(R)}function O(R,C){var k=e(R),z=e(C);return k.isBefore(z,"day")}function V(R,C,k){var z=e(C),q=e(k);return z.isSameOrAfter(q,"minutes")}function W(R,C){var k=e(R),z=e(C),q=e.duration(z.diff(k));return q.days()}function B(R){var C=R.evtA,k=C.start,z=C.end,q=C.allDay,K=R.evtB,se=K.start,ie=K.end,ee=K.allDay,ae=+s(k,"day")-+s(se,"day"),pe=W(k,z),H=W(se,ie);return ae||H-pe||!!ee-!!q||+k-+se||+z-+ie}function P(R){var C=R.event,k=C.start,z=C.end,q=R.range,K=q.start,se=q.end,ie=e(k).startOf("day"),ee=e(z),ae=e(K),pe=e(se),H=ie.isSameOrBefore(pe,"day"),ne=!ie.isSame(ee,"minutes"),U=ne?ee.isAfter(ae,"minutes"):ee.isSameOrAfter(ae,"minutes");return H&&U}function F(R,C){var k=e(R),z=e(C);return k.isSame(z,"day")}function I(){var R=new Date,C=/-/.test(R.toString())?"-":"",k=R.getTimezoneOffset(),z=Number("".concat(C).concat(Math.abs(k))),q=e().utcOffset();return q>z?1:0}return new Dqe({formats:TGe,firstOfWeek:j,firstVisibleDay:N,lastVisibleDay:S,visibleDays:E,format:function(C,k,z){return t(e(C),z).format(k)},lt:f,lte:m,gt:d,gte:h,eq:c,neq:u,merge:v,inRange:x,startOf:s,endOf:l,range:b,add:y,diff:_,ceil:w,min:p,max:g,minutes:D,getSlotDate:A,getTimezoneOffset:r,getDstOffset:n,getTotalMin:T,getMinutesFromMidnight:L,continuesPrior:O,continuesAfter:V,sortEvents:B,inEventRange:P,isSameDate:F,daySpan:W,browserTZOffset:I})}//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var yV;function Ve(){return yV.apply(null,arguments)}function CGe(e){yV=e}function ms(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function Ic(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function zt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function jk(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(zt(e,t))return!1;return!0}function ja(e){return e===void 0}function Bo(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function Sx(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function bV(e,t){var r=[],n,a=e.length;for(n=0;n<a;++n)r.push(t(e[n],n));return r}function hl(e,t){for(var r in t)zt(t,r)&&(e[r]=t[r]);return zt(t,"toString")&&(e.toString=t.toString),zt(t,"valueOf")&&(e.valueOf=t.valueOf),e}function Js(e,t,r,n){return zV(e,t,r,n,!0).utc()}function AGe(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Nt(e){return e._pf==null&&(e._pf=AGe()),e._pf}var Bj;Array.prototype.some?Bj=Array.prototype.some:Bj=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function Nk(e){var t=null,r=!1,n=e._d&&!isNaN(e._d.getTime());if(n&&(t=Nt(e),r=Bj.call(t.parsedDateParts,function(a){return a!=null}),n=t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r),e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n;return e._isValid}function E1(e){var t=Js(NaN);return e!=null?hl(Nt(t),e):Nt(t).userInvalidated=!0,t}var m8=Ve.momentProperties=[],d_=!1;function Sk(e,t){var r,n,a,i=m8.length;if(ja(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),ja(t._i)||(e._i=t._i),ja(t._f)||(e._f=t._f),ja(t._l)||(e._l=t._l),ja(t._strict)||(e._strict=t._strict),ja(t._tzm)||(e._tzm=t._tzm),ja(t._isUTC)||(e._isUTC=t._isUTC),ja(t._offset)||(e._offset=t._offset),ja(t._pf)||(e._pf=Nt(t)),ja(t._locale)||(e._locale=t._locale),i>0)for(r=0;r<i;r++)n=m8[r],a=t[n],ja(a)||(e[n]=a);return e}function Ex(e){Sk(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),d_===!1&&(d_=!0,Ve.updateOffset(this),d_=!1)}function ps(e){return e instanceof Ex||e!=null&&e._isAMomentObject!=null}function wV(e){Ve.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function Yi(e,t){var r=!0;return hl(function(){if(Ve.deprecationHandler!=null&&Ve.deprecationHandler(null,e),r){var n=[],a,i,s,l=arguments.length;for(i=0;i<l;i++){if(a="",typeof arguments[i]=="object"){a+=`
[`+i+"] ";for(s in arguments[0])zt(arguments[0],s)&&(a+=s+": "+arguments[0][s]+", ");a=a.slice(0,-2)}else a=arguments[i];n.push(a)}wV(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var p8={};function _V(e,t){Ve.deprecationHandler!=null&&Ve.deprecationHandler(e,t),p8[e]||(wV(t),p8[e]=!0)}Ve.suppressDeprecationWarnings=!1;Ve.deprecationHandler=null;function Qs(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function OGe(e){var t,r;for(r in e)zt(e,r)&&(t=e[r],Qs(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Wj(e,t){var r=hl({},e),n;for(n in t)zt(t,n)&&(Ic(e[n])&&Ic(t[n])?(r[n]={},hl(r[n],e[n]),hl(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)zt(e,n)&&!zt(t,n)&&Ic(e[n])&&(r[n]=hl({},r[n]));return r}function Ek(e){e!=null&&this.set(e)}var zj;Object.keys?zj=Object.keys:zj=function(e){var t,r=[];for(t in e)zt(e,t)&&r.push(t);return r};var FGe={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function PGe(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return Qs(n)?n.call(t,r):n}function Ys(e,t,r){var n=""+Math.abs(e),a=t-n.length,i=e>=0;return(i?r?"+":"":"-")+Math.pow(10,Math.max(0,a)).toString().substr(1)+n}var Tk=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,j0=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,f_={},ld={};function ot(e,t,r,n){var a=n;typeof n=="string"&&(a=function(){return this[n]()}),e&&(ld[e]=a),t&&(ld[t[0]]=function(){return Ys(a.apply(this,arguments),t[1],t[2])}),r&&(ld[r]=function(){return this.localeData().ordinal(a.apply(this,arguments),e)})}function IGe(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function RGe(e){var t=e.match(Tk),r,n;for(r=0,n=t.length;r<n;r++)ld[t[r]]?t[r]=ld[t[r]]:t[r]=IGe(t[r]);return function(a){var i="",s;for(s=0;s<n;s++)i+=Qs(t[s])?t[s].call(a,e):t[s];return i}}function L0(e,t){return e.isValid()?(t=DV(t,e.localeData()),f_[t]=f_[t]||RGe(t),f_[t](e)):e.localeData().invalidDate()}function DV(e,t){var r=5;function n(a){return t.longDateFormat(a)||a}for(j0.lastIndex=0;r>=0&&j0.test(e);)e=e.replace(j0,n),j0.lastIndex=0,r-=1;return e}var MGe={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function UGe(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(Tk).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var $Ge="Invalid date";function LGe(){return this._invalidDate}var BGe="%d",WGe=/\d{1,2}/;function zGe(e){return this._ordinal.replace("%d",e)}var HGe={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function VGe(e,t,r,n){var a=this._relativeTime[r];return Qs(a)?a(e,t,r,n):a.replace(/%d/i,e)}function qGe(e,t){var r=this._relativeTime[e>0?"future":"past"];return Qs(r)?r(t):r.replace(/%s/i,t)}var x8={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Xi(e){return typeof e=="string"?x8[e]||x8[e.toLowerCase()]:void 0}function kk(e){var t={},r,n;for(n in e)zt(e,n)&&(r=Xi(n),r&&(t[r]=e[n]));return t}var GGe={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function YGe(e){var t=[],r;for(r in e)zt(e,r)&&t.push({unit:r,priority:GGe[r]});return t.sort(function(n,a){return n.priority-a.priority}),t}var jV=/\d/,hi=/\d\d/,NV=/\d{3}/,Ck=/\d{4}/,T1=/[+-]?\d{6}/,jr=/\d\d?/,SV=/\d\d\d\d?/,EV=/\d\d\d\d\d\d?/,k1=/\d{1,3}/,Ak=/\d{1,4}/,C1=/[+-]?\d{1,6}/,$f=/\d+/,A1=/[+-]?\d+/,XGe=/Z|[+-]\d\d:?\d\d/gi,O1=/Z|[+-]\d\d(?::?\d\d)?/gi,KGe=/[+-]?\d+(\.\d{1,3})?/,Tx=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Lf=/^[1-9]\d?/,Ok=/^([1-9]\d|\d)/,$v;$v={};function Je(e,t,r){$v[e]=Qs(t)?t:function(n,a){return n&&r?r:t}}function ZGe(e,t){return zt($v,e)?$v[e](t._strict,t._locale):new RegExp(JGe(e))}function JGe(e){return Eo(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,a,i){return r||n||a||i}))}function Eo(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Ci(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function Ot(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=Ci(t)),r}var Hj={};function sr(e,t){var r,n=t,a;for(typeof e=="string"&&(e=[e]),Bo(t)&&(n=function(i,s){s[t]=Ot(i)}),a=e.length,r=0;r<a;r++)Hj[e[r]]=n}function kx(e,t){sr(e,function(r,n,a,i){a._w=a._w||{},t(r,a._w,a,i)})}function QGe(e,t,r){t!=null&&zt(Hj,e)&&Hj[e](t,r._a,r,e)}function F1(e){return e%4===0&&e%100!==0||e%400===0}var na=0,yo=1,Os=2,un=3,ss=4,bo=5,jc=6,eYe=7,tYe=8;ot("Y",0,0,function(){var e=this.year();return e<=9999?Ys(e,4):"+"+e});ot(0,["YY",2],0,function(){return this.year()%100});ot(0,["YYYY",4],0,"year");ot(0,["YYYYY",5],0,"year");ot(0,["YYYYYY",6,!0],0,"year");Je("Y",A1);Je("YY",jr,hi);Je("YYYY",Ak,Ck);Je("YYYYY",C1,T1);Je("YYYYYY",C1,T1);sr(["YYYYY","YYYYYY"],na);sr("YYYY",function(e,t){t[na]=e.length===2?Ve.parseTwoDigitYear(e):Ot(e)});sr("YY",function(e,t){t[na]=Ve.parseTwoDigitYear(e)});sr("Y",function(e,t){t[na]=parseInt(e,10)});function Vh(e){return F1(e)?366:365}Ve.parseTwoDigitYear=function(e){return Ot(e)+(Ot(e)>68?1900:2e3)};var TV=Bf("FullYear",!0);function rYe(){return F1(this.year())}function Bf(e,t){return function(r){return r!=null?(kV(this,e,r),Ve.updateOffset(this,t),this):Sp(this,e)}}function Sp(e,t){if(!e.isValid())return NaN;var r=e._d,n=e._isUTC;switch(t){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function kV(e,t,r){var n,a,i,s,l;if(!(!e.isValid()||isNaN(r))){switch(n=e._d,a=e._isUTC,t){case"Milliseconds":return void(a?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(a?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(a?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(a?n.setUTCHours(r):n.setHours(r));case"Date":return void(a?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}i=r,s=e.month(),l=e.date(),l=l===29&&s===1&&!F1(i)?28:l,a?n.setUTCFullYear(i,s,l):n.setFullYear(i,s,l)}}function nYe(e){return e=Xi(e),Qs(this[e])?this[e]():this}function aYe(e,t){if(typeof e=="object"){e=kk(e);var r=YGe(e),n,a=r.length;for(n=0;n<a;n++)this[r[n].unit](e[r[n].unit])}else if(e=Xi(e),Qs(this[e]))return this[e](t);return this}function iYe(e,t){return(e%t+t)%t}var Vr;Array.prototype.indexOf?Vr=Array.prototype.indexOf:Vr=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function Fk(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=iYe(t,12);return e+=(t-r)/12,r===1?F1(e)?29:28:31-r%7%2}ot("M",["MM",2],"Mo",function(){return this.month()+1});ot("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});ot("MMMM",0,0,function(e){return this.localeData().months(this,e)});Je("M",jr,Lf);Je("MM",jr,hi);Je("MMM",function(e,t){return t.monthsShortRegex(e)});Je("MMMM",function(e,t){return t.monthsRegex(e)});sr(["M","MM"],function(e,t){t[yo]=Ot(e)-1});sr(["MMM","MMMM"],function(e,t,r,n){var a=r._locale.monthsParse(e,n,r._strict);a!=null?t[yo]=a:Nt(r).invalidMonth=e});var sYe="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),CV="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),AV=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,oYe=Tx,lYe=Tx;function cYe(e,t){return e?ms(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||AV).test(t)?"format":"standalone"][e.month()]:ms(this._months)?this._months:this._months.standalone}function uYe(e,t){return e?ms(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[AV.test(t)?"format":"standalone"][e.month()]:ms(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function dYe(e,t,r){var n,a,i,s=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)i=Js([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(i,"").toLocaleLowerCase();return r?t==="MMM"?(a=Vr.call(this._shortMonthsParse,s),a!==-1?a:null):(a=Vr.call(this._longMonthsParse,s),a!==-1?a:null):t==="MMM"?(a=Vr.call(this._shortMonthsParse,s),a!==-1?a:(a=Vr.call(this._longMonthsParse,s),a!==-1?a:null)):(a=Vr.call(this._longMonthsParse,s),a!==-1?a:(a=Vr.call(this._shortMonthsParse,s),a!==-1?a:null))}function fYe(e,t,r){var n,a,i;if(this._monthsParseExact)return dYe.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(a=Js([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(a,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(a,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(i="^"+this.months(a,"")+"|^"+this.monthsShort(a,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function OV(e,t){if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=Ot(t);else if(t=e.localeData().monthsParse(t),!Bo(t))return e}var r=t,n=e.date();return n=n<29?n:Math.min(n,Fk(e.year(),r)),e._isUTC?e._d.setUTCMonth(r,n):e._d.setMonth(r,n),e}function FV(e){return e!=null?(OV(this,e),Ve.updateOffset(this,!0),this):Sp(this,"Month")}function hYe(){return Fk(this.year(),this.month())}function mYe(e){return this._monthsParseExact?(zt(this,"_monthsRegex")||PV.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(zt(this,"_monthsShortRegex")||(this._monthsShortRegex=oYe),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function pYe(e){return this._monthsParseExact?(zt(this,"_monthsRegex")||PV.call(this),e?this._monthsStrictRegex:this._monthsRegex):(zt(this,"_monthsRegex")||(this._monthsRegex=lYe),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function PV(){function e(c,u){return u.length-c.length}var t=[],r=[],n=[],a,i,s,l;for(a=0;a<12;a++)i=Js([2e3,a]),s=Eo(this.monthsShort(i,"")),l=Eo(this.months(i,"")),t.push(s),r.push(l),n.push(l),n.push(s);t.sort(e),r.sort(e),n.sort(e),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}function xYe(e,t,r,n,a,i,s){var l;return e<100&&e>=0?(l=new Date(e+400,t,r,n,a,i,s),isFinite(l.getFullYear())&&l.setFullYear(e)):l=new Date(e,t,r,n,a,i,s),l}function Ep(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function Lv(e,t,r){var n=7+t-r,a=(7+Ep(e,0,n).getUTCDay()-t)%7;return-a+n-1}function IV(e,t,r,n,a){var i=(7+r-n)%7,s=Lv(e,n,a),l=1+7*(t-1)+i+s,c,u;return l<=0?(c=e-1,u=Vh(c)+l):l>Vh(e)?(c=e+1,u=l-Vh(e)):(c=e,u=l),{year:c,dayOfYear:u}}function Tp(e,t,r){var n=Lv(e.year(),t,r),a=Math.floor((e.dayOfYear()-n-1)/7)+1,i,s;return a<1?(s=e.year()-1,i=a+To(s,t,r)):a>To(e.year(),t,r)?(i=a-To(e.year(),t,r),s=e.year()+1):(s=e.year(),i=a),{week:i,year:s}}function To(e,t,r){var n=Lv(e,t,r),a=Lv(e+1,t,r);return(Vh(e)-n+a)/7}ot("w",["ww",2],"wo","week");ot("W",["WW",2],"Wo","isoWeek");Je("w",jr,Lf);Je("ww",jr,hi);Je("W",jr,Lf);Je("WW",jr,hi);kx(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=Ot(e)});function gYe(e){return Tp(e,this._week.dow,this._week.doy).week}var vYe={dow:0,doy:6};function yYe(){return this._week.dow}function bYe(){return this._week.doy}function wYe(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function _Ye(e){var t=Tp(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}ot("d",0,"do","day");ot("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});ot("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});ot("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});ot("e",0,0,"weekday");ot("E",0,0,"isoWeekday");Je("d",jr);Je("e",jr);Je("E",jr);Je("dd",function(e,t){return t.weekdaysMinRegex(e)});Je("ddd",function(e,t){return t.weekdaysShortRegex(e)});Je("dddd",function(e,t){return t.weekdaysRegex(e)});kx(["dd","ddd","dddd"],function(e,t,r,n){var a=r._locale.weekdaysParse(e,n,r._strict);a!=null?t.d=a:Nt(r).invalidWeekday=e});kx(["d","e","E"],function(e,t,r,n){t[n]=Ot(e)});function DYe(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function jYe(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function Pk(e,t){return e.slice(t,7).concat(e.slice(0,t))}var NYe="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),RV="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),SYe="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),EYe=Tx,TYe=Tx,kYe=Tx;function CYe(e,t){var r=ms(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?Pk(r,this._week.dow):e?r[e.day()]:r}function AYe(e){return e===!0?Pk(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function OYe(e){return e===!0?Pk(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function FYe(e,t,r){var n,a,i,s=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)i=Js([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(i,"").toLocaleLowerCase();return r?t==="dddd"?(a=Vr.call(this._weekdaysParse,s),a!==-1?a:null):t==="ddd"?(a=Vr.call(this._shortWeekdaysParse,s),a!==-1?a:null):(a=Vr.call(this._minWeekdaysParse,s),a!==-1?a:null):t==="dddd"?(a=Vr.call(this._weekdaysParse,s),a!==-1||(a=Vr.call(this._shortWeekdaysParse,s),a!==-1)?a:(a=Vr.call(this._minWeekdaysParse,s),a!==-1?a:null)):t==="ddd"?(a=Vr.call(this._shortWeekdaysParse,s),a!==-1||(a=Vr.call(this._weekdaysParse,s),a!==-1)?a:(a=Vr.call(this._minWeekdaysParse,s),a!==-1?a:null)):(a=Vr.call(this._minWeekdaysParse,s),a!==-1||(a=Vr.call(this._weekdaysParse,s),a!==-1)?a:(a=Vr.call(this._shortWeekdaysParse,s),a!==-1?a:null))}function PYe(e,t,r){var n,a,i;if(this._weekdaysParseExact)return FYe.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(a=Js([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(a,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(a,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(a,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(i="^"+this.weekdays(a,"")+"|^"+this.weekdaysShort(a,"")+"|^"+this.weekdaysMin(a,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function IYe(e){if(!this.isValid())return e!=null?this:NaN;var t=Sp(this,"Day");return e!=null?(e=DYe(e,this.localeData()),this.add(e-t,"d")):t}function RYe(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function MYe(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=jYe(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function UYe(e){return this._weekdaysParseExact?(zt(this,"_weekdaysRegex")||Ik.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(zt(this,"_weekdaysRegex")||(this._weekdaysRegex=EYe),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function $Ye(e){return this._weekdaysParseExact?(zt(this,"_weekdaysRegex")||Ik.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(zt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=TYe),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function LYe(e){return this._weekdaysParseExact?(zt(this,"_weekdaysRegex")||Ik.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(zt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=kYe),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Ik(){function e(d,f){return f.length-d.length}var t=[],r=[],n=[],a=[],i,s,l,c,u;for(i=0;i<7;i++)s=Js([2e3,1]).day(i),l=Eo(this.weekdaysMin(s,"")),c=Eo(this.weekdaysShort(s,"")),u=Eo(this.weekdays(s,"")),t.push(l),r.push(c),n.push(u),a.push(l),a.push(c),a.push(u);t.sort(e),r.sort(e),n.sort(e),a.sort(e),this._weekdaysRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function Rk(){return this.hours()%12||12}function BYe(){return this.hours()||24}ot("H",["HH",2],0,"hour");ot("h",["hh",2],0,Rk);ot("k",["kk",2],0,BYe);ot("hmm",0,0,function(){return""+Rk.apply(this)+Ys(this.minutes(),2)});ot("hmmss",0,0,function(){return""+Rk.apply(this)+Ys(this.minutes(),2)+Ys(this.seconds(),2)});ot("Hmm",0,0,function(){return""+this.hours()+Ys(this.minutes(),2)});ot("Hmmss",0,0,function(){return""+this.hours()+Ys(this.minutes(),2)+Ys(this.seconds(),2)});function MV(e,t){ot(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}MV("a",!0);MV("A",!1);function UV(e,t){return t._meridiemParse}Je("a",UV);Je("A",UV);Je("H",jr,Ok);Je("h",jr,Lf);Je("k",jr,Lf);Je("HH",jr,hi);Je("hh",jr,hi);Je("kk",jr,hi);Je("hmm",SV);Je("hmmss",EV);Je("Hmm",SV);Je("Hmmss",EV);sr(["H","HH"],un);sr(["k","kk"],function(e,t,r){var n=Ot(e);t[un]=n===24?0:n});sr(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});sr(["h","hh"],function(e,t,r){t[un]=Ot(e),Nt(r).bigHour=!0});sr("hmm",function(e,t,r){var n=e.length-2;t[un]=Ot(e.substr(0,n)),t[ss]=Ot(e.substr(n)),Nt(r).bigHour=!0});sr("hmmss",function(e,t,r){var n=e.length-4,a=e.length-2;t[un]=Ot(e.substr(0,n)),t[ss]=Ot(e.substr(n,2)),t[bo]=Ot(e.substr(a)),Nt(r).bigHour=!0});sr("Hmm",function(e,t,r){var n=e.length-2;t[un]=Ot(e.substr(0,n)),t[ss]=Ot(e.substr(n))});sr("Hmmss",function(e,t,r){var n=e.length-4,a=e.length-2;t[un]=Ot(e.substr(0,n)),t[ss]=Ot(e.substr(n,2)),t[bo]=Ot(e.substr(a))});function WYe(e){return(e+"").toLowerCase().charAt(0)==="p"}var zYe=/[ap]\.?m?\.?/i,HYe=Bf("Hours",!0);function VYe(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var $V={calendar:FGe,longDateFormat:MGe,invalidDate:$Ge,ordinal:BGe,dayOfMonthOrdinalParse:WGe,relativeTime:HGe,months:sYe,monthsShort:CV,week:vYe,weekdays:NYe,weekdaysMin:SYe,weekdaysShort:RV,meridiemParse:zYe},Er={},gh={},kp;function qYe(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function g8(e){return e&&e.toLowerCase().replace("_","-")}function GYe(e){for(var t=0,r,n,a,i;t<e.length;){for(i=g8(e[t]).split("-"),r=i.length,n=g8(e[t+1]),n=n?n.split("-"):null;r>0;){if(a=P1(i.slice(0,r).join("-")),a)return a;if(n&&n.length>=r&&qYe(i,n)>=r-1)break;r--}t++}return kp}function YYe(e){return!!(e&&e.match("^[^/\\\\]*$"))}function P1(e){var t=null,r;if(Er[e]===void 0&&typeof module<"u"&&module&&module.exports&&YYe(e))try{t=kp._abbr,r=require,r("./locale/"+e),wl(t)}catch{Er[e]=null}return Er[e]}function wl(e,t){var r;return e&&(ja(t)?r=Xo(e):r=Mk(e,t),r?kp=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),kp._abbr}function Mk(e,t){if(t!==null){var r,n=$V;if(t.abbr=e,Er[e]!=null)_V("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Er[e]._config;else if(t.parentLocale!=null)if(Er[t.parentLocale]!=null)n=Er[t.parentLocale]._config;else if(r=P1(t.parentLocale),r!=null)n=r._config;else return gh[t.parentLocale]||(gh[t.parentLocale]=[]),gh[t.parentLocale].push({name:e,config:t}),null;return Er[e]=new Ek(Wj(n,t)),gh[e]&&gh[e].forEach(function(a){Mk(a.name,a.config)}),wl(e),Er[e]}else return delete Er[e],null}function XYe(e,t){if(t!=null){var r,n,a=$V;Er[e]!=null&&Er[e].parentLocale!=null?Er[e].set(Wj(Er[e]._config,t)):(n=P1(e),n!=null&&(a=n._config),t=Wj(a,t),n==null&&(t.abbr=e),r=new Ek(t),r.parentLocale=Er[e],Er[e]=r),wl(e)}else Er[e]!=null&&(Er[e].parentLocale!=null?(Er[e]=Er[e].parentLocale,e===wl()&&wl(e)):Er[e]!=null&&delete Er[e]);return Er[e]}function Xo(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return kp;if(!ms(e)){if(t=P1(e),t)return t;e=[e]}return GYe(e)}function KYe(){return zj(Er)}function Uk(e){var t,r=e._a;return r&&Nt(e).overflow===-2&&(t=r[yo]<0||r[yo]>11?yo:r[Os]<1||r[Os]>Fk(r[na],r[yo])?Os:r[un]<0||r[un]>24||r[un]===24&&(r[ss]!==0||r[bo]!==0||r[jc]!==0)?un:r[ss]<0||r[ss]>59?ss:r[bo]<0||r[bo]>59?bo:r[jc]<0||r[jc]>999?jc:-1,Nt(e)._overflowDayOfYear&&(t<na||t>Os)&&(t=Os),Nt(e)._overflowWeeks&&t===-1&&(t=eYe),Nt(e)._overflowWeekday&&t===-1&&(t=tYe),Nt(e).overflow=t),e}var ZYe=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,JYe=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,QYe=/Z|[+-]\d\d(?::?\d\d)?/,N0=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],h_=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],eXe=/^\/?Date\((-?\d+)/i,tXe=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,rXe={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function LV(e){var t,r,n=e._i,a=ZYe.exec(n)||JYe.exec(n),i,s,l,c,u=N0.length,d=h_.length;if(a){for(Nt(e).iso=!0,t=0,r=u;t<r;t++)if(N0[t][1].exec(a[1])){s=N0[t][0],i=N0[t][2]!==!1;break}if(s==null){e._isValid=!1;return}if(a[3]){for(t=0,r=d;t<r;t++)if(h_[t][1].exec(a[3])){l=(a[2]||" ")+h_[t][0];break}if(l==null){e._isValid=!1;return}}if(!i&&l!=null){e._isValid=!1;return}if(a[4])if(QYe.exec(a[4]))c="Z";else{e._isValid=!1;return}e._f=s+(l||"")+(c||""),Lk(e)}else e._isValid=!1}function nXe(e,t,r,n,a,i){var s=[aXe(e),CV.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(a,10)];return i&&s.push(parseInt(i,10)),s}function aXe(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function iXe(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function sXe(e,t,r){if(e){var n=RV.indexOf(e),a=new Date(t[0],t[1],t[2]).getDay();if(n!==a)return Nt(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function oXe(e,t,r){if(e)return rXe[e];if(t)return 0;var n=parseInt(r,10),a=n%100,i=(n-a)/100;return i*60+a}function BV(e){var t=tXe.exec(iXe(e._i)),r;if(t){if(r=nXe(t[4],t[3],t[2],t[5],t[6],t[7]),!sXe(t[1],r,e))return;e._a=r,e._tzm=oXe(t[8],t[9],t[10]),e._d=Ep.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),Nt(e).rfc2822=!0}else e._isValid=!1}function lXe(e){var t=eXe.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(LV(e),e._isValid===!1)delete e._isValid;else return;if(BV(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:Ve.createFromInputFallback(e)}Ve.createFromInputFallback=Yi("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function Lu(e,t,r){return e??t??r}function cXe(e){var t=new Date(Ve.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function $k(e){var t,r,n=[],a,i,s;if(!e._d){for(a=cXe(e),e._w&&e._a[Os]==null&&e._a[yo]==null&&uXe(e),e._dayOfYear!=null&&(s=Lu(e._a[na],a[na]),(e._dayOfYear>Vh(s)||e._dayOfYear===0)&&(Nt(e)._overflowDayOfYear=!0),r=Ep(s,0,e._dayOfYear),e._a[yo]=r.getUTCMonth(),e._a[Os]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=a[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[un]===24&&e._a[ss]===0&&e._a[bo]===0&&e._a[jc]===0&&(e._nextDay=!0,e._a[un]=0),e._d=(e._useUTC?Ep:xYe).apply(null,n),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[un]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==i&&(Nt(e).weekdayMismatch=!0)}}function uXe(e){var t,r,n,a,i,s,l,c,u;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(i=1,s=4,r=Lu(t.GG,e._a[na],Tp(Dr(),1,4).year),n=Lu(t.W,1),a=Lu(t.E,1),(a<1||a>7)&&(c=!0)):(i=e._locale._week.dow,s=e._locale._week.doy,u=Tp(Dr(),i,s),r=Lu(t.gg,e._a[na],u.year),n=Lu(t.w,u.week),t.d!=null?(a=t.d,(a<0||a>6)&&(c=!0)):t.e!=null?(a=t.e+i,(t.e<0||t.e>6)&&(c=!0)):a=i),n<1||n>To(r,i,s)?Nt(e)._overflowWeeks=!0:c!=null?Nt(e)._overflowWeekday=!0:(l=IV(r,n,a,i,s),e._a[na]=l.year,e._dayOfYear=l.dayOfYear)}Ve.ISO_8601=function(){};Ve.RFC_2822=function(){};function Lk(e){if(e._f===Ve.ISO_8601){LV(e);return}if(e._f===Ve.RFC_2822){BV(e);return}e._a=[],Nt(e).empty=!0;var t=""+e._i,r,n,a,i,s,l=t.length,c=0,u,d;for(a=DV(e._f,e._locale).match(Tk)||[],d=a.length,r=0;r<d;r++)i=a[r],n=(t.match(ZGe(i,e))||[])[0],n&&(s=t.substr(0,t.indexOf(n)),s.length>0&&Nt(e).unusedInput.push(s),t=t.slice(t.indexOf(n)+n.length),c+=n.length),ld[i]?(n?Nt(e).empty=!1:Nt(e).unusedTokens.push(i),QGe(i,n,e)):e._strict&&!n&&Nt(e).unusedTokens.push(i);Nt(e).charsLeftOver=l-c,t.length>0&&Nt(e).unusedInput.push(t),e._a[un]<=12&&Nt(e).bigHour===!0&&e._a[un]>0&&(Nt(e).bigHour=void 0),Nt(e).parsedDateParts=e._a.slice(0),Nt(e).meridiem=e._meridiem,e._a[un]=dXe(e._locale,e._a[un],e._meridiem),u=Nt(e).era,u!==null&&(e._a[na]=e._locale.erasConvertYear(u,e._a[na])),$k(e),Uk(e)}function dXe(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function fXe(e){var t,r,n,a,i,s,l=!1,c=e._f.length;if(c===0){Nt(e).invalidFormat=!0,e._d=new Date(NaN);return}for(a=0;a<c;a++)i=0,s=!1,t=Sk({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[a],Lk(t),Nk(t)&&(s=!0),i+=Nt(t).charsLeftOver,i+=Nt(t).unusedTokens.length*10,Nt(t).score=i,l?i<n&&(n=i,r=t):(n==null||i<n||s)&&(n=i,r=t,s&&(l=!0));hl(e,r||t)}function hXe(e){if(!e._d){var t=kk(e._i),r=t.day===void 0?t.date:t.day;e._a=bV([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),$k(e)}}function mXe(e){var t=new Ex(Uk(WV(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function WV(e){var t=e._i,r=e._f;return e._locale=e._locale||Xo(e._l),t===null||r===void 0&&t===""?E1({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),ps(t)?new Ex(Uk(t)):(Sx(t)?e._d=t:ms(r)?fXe(e):r?Lk(e):pXe(e),Nk(e)||(e._d=null),e))}function pXe(e){var t=e._i;ja(t)?e._d=new Date(Ve.now()):Sx(t)?e._d=new Date(t.valueOf()):typeof t=="string"?lXe(e):ms(t)?(e._a=bV(t.slice(0),function(r){return parseInt(r,10)}),$k(e)):Ic(t)?hXe(e):Bo(t)?e._d=new Date(t):Ve.createFromInputFallback(e)}function zV(e,t,r,n,a){var i={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Ic(e)&&jk(e)||ms(e)&&e.length===0)&&(e=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=a,i._l=r,i._i=e,i._f=t,i._strict=n,mXe(i)}function Dr(e,t,r,n){return zV(e,t,r,n,!1)}var xXe=Yi("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Dr.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:E1()}),gXe=Yi("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Dr.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:E1()});function HV(e,t){var r,n;if(t.length===1&&ms(t[0])&&(t=t[0]),!t.length)return Dr();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function vXe(){var e=[].slice.call(arguments,0);return HV("isBefore",e)}function yXe(){var e=[].slice.call(arguments,0);return HV("isAfter",e)}var bXe=function(){return Date.now?Date.now():+new Date},vh=["year","quarter","month","week","day","hour","minute","second","millisecond"];function wXe(e){var t,r=!1,n,a=vh.length;for(t in e)if(zt(e,t)&&!(Vr.call(vh,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<a;++n)if(e[vh[n]]){if(r)return!1;parseFloat(e[vh[n]])!==Ot(e[vh[n]])&&(r=!0)}return!0}function _Xe(){return this._isValid}function DXe(){return Ns(NaN)}function I1(e){var t=kk(e),r=t.year||0,n=t.quarter||0,a=t.month||0,i=t.week||t.isoWeek||0,s=t.day||0,l=t.hour||0,c=t.minute||0,u=t.second||0,d=t.millisecond||0;this._isValid=wXe(t),this._milliseconds=+d+u*1e3+c*6e4+l*1e3*60*60,this._days=+s+i*7,this._months=+a+n*3+r*12,this._data={},this._locale=Xo(),this._bubble()}function B0(e){return e instanceof I1}function Vj(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function jXe(e,t,r){var n=Math.min(e.length,t.length),a=Math.abs(e.length-t.length),i=0,s;for(s=0;s<n;s++)Ot(e[s])!==Ot(t[s])&&i++;return i+a}function VV(e,t){ot(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Ys(~~(r/60),2)+t+Ys(~~r%60,2)})}VV("Z",":");VV("ZZ","");Je("Z",O1);Je("ZZ",O1);sr(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=Bk(O1,e)});var NXe=/([\+\-]|\d\d)/gi;function Bk(e,t){var r=(t||"").match(e),n,a,i;return r===null?null:(n=r[r.length-1]||[],a=(n+"").match(NXe)||["-",0,0],i=+(a[1]*60)+Ot(a[2]),i===0?0:a[0]==="+"?i:-i)}function Wk(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(ps(e)||Sx(e)?e.valueOf():Dr(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),Ve.updateOffset(r,!1),r):Dr(e).local()}function qj(e){return-Math.round(e._d.getTimezoneOffset())}Ve.updateOffset=function(){};function SXe(e,t,r){var n=this._offset||0,a;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=Bk(O1,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(a=qj(this)),this._offset=e,this._isUTC=!0,a!=null&&this.add(a,"m"),n!==e&&(!t||this._changeInProgress?YV(this,Ns(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Ve.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:qj(this)}function EXe(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function TXe(e){return this.utcOffset(0,e)}function kXe(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(qj(this),"m")),this}function CXe(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=Bk(XGe,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function AXe(e){return this.isValid()?(e=e?Dr(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function OXe(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function FXe(){if(!ja(this._isDSTShifted))return this._isDSTShifted;var e={},t;return Sk(e,this),e=WV(e),e._a?(t=e._isUTC?Js(e._a):Dr(e._a),this._isDSTShifted=this.isValid()&&jXe(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function PXe(){return this.isValid()?!this._isUTC:!1}function IXe(){return this.isValid()?this._isUTC:!1}function qV(){return this.isValid()?this._isUTC&&this._offset===0:!1}var RXe=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,MXe=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Ns(e,t){var r=e,n=null,a,i,s;return B0(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:Bo(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=RXe.exec(e))?(a=n[1]==="-"?-1:1,r={y:0,d:Ot(n[Os])*a,h:Ot(n[un])*a,m:Ot(n[ss])*a,s:Ot(n[bo])*a,ms:Ot(Vj(n[jc]*1e3))*a}):(n=MXe.exec(e))?(a=n[1]==="-"?-1:1,r={y:cc(n[2],a),M:cc(n[3],a),w:cc(n[4],a),d:cc(n[5],a),h:cc(n[6],a),m:cc(n[7],a),s:cc(n[8],a)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(s=UXe(Dr(r.from),Dr(r.to)),r={},r.ms=s.milliseconds,r.M=s.months),i=new I1(r),B0(e)&&zt(e,"_locale")&&(i._locale=e._locale),B0(e)&&zt(e,"_isValid")&&(i._isValid=e._isValid),i}Ns.fn=I1.prototype;Ns.invalid=DXe;function cc(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function v8(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function UXe(e,t){var r;return e.isValid()&&t.isValid()?(t=Wk(t,e),e.isBefore(t)?r=v8(e,t):(r=v8(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function GV(e,t){return function(r,n){var a,i;return n!==null&&!isNaN(+n)&&(_V(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=r,r=n,n=i),a=Ns(r,n),YV(this,a,e),this}}function YV(e,t,r,n){var a=t._milliseconds,i=Vj(t._days),s=Vj(t._months);e.isValid()&&(n=n??!0,s&&OV(e,Sp(e,"Month")+s*r),i&&kV(e,"Date",Sp(e,"Date")+i*r),a&&e._d.setTime(e._d.valueOf()+a*r),n&&Ve.updateOffset(e,i||s))}var $Xe=GV(1,"add"),LXe=GV(-1,"subtract");function XV(e){return typeof e=="string"||e instanceof String}function BXe(e){return ps(e)||Sx(e)||XV(e)||Bo(e)||zXe(e)||WXe(e)||e===null||e===void 0}function WXe(e){var t=Ic(e)&&!jk(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],a,i,s=n.length;for(a=0;a<s;a+=1)i=n[a],r=r||zt(e,i);return t&&r}function zXe(e){var t=ms(e),r=!1;return t&&(r=e.filter(function(n){return!Bo(n)&&XV(e)}).length===0),t&&r}function HXe(e){var t=Ic(e)&&!jk(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],a,i;for(a=0;a<n.length;a+=1)i=n[a],r=r||zt(e,i);return t&&r}function VXe(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function qXe(e,t){arguments.length===1&&(arguments[0]?BXe(arguments[0])?(e=arguments[0],t=void 0):HXe(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||Dr(),n=Wk(r,this).startOf("day"),a=Ve.calendarFormat(this,n)||"sameElse",i=t&&(Qs(t[a])?t[a].call(this,r):t[a]);return this.format(i||this.localeData().calendar(a,this,Dr(r)))}function GXe(){return new Ex(this)}function YXe(e,t){var r=ps(e)?e:Dr(e);return this.isValid()&&r.isValid()?(t=Xi(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function XXe(e,t){var r=ps(e)?e:Dr(e);return this.isValid()&&r.isValid()?(t=Xi(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function KXe(e,t,r,n){var a=ps(e)?e:Dr(e),i=ps(t)?t:Dr(t);return this.isValid()&&a.isValid()&&i.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(a,r):!this.isBefore(a,r))&&(n[1]===")"?this.isBefore(i,r):!this.isAfter(i,r))):!1}function ZXe(e,t){var r=ps(e)?e:Dr(e),n;return this.isValid()&&r.isValid()?(t=Xi(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function JXe(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function QXe(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function eKe(e,t,r){var n,a,i;if(!this.isValid())return NaN;if(n=Wk(e,this),!n.isValid())return NaN;switch(a=(n.utcOffset()-this.utcOffset())*6e4,t=Xi(t),t){case"year":i=W0(this,n)/12;break;case"month":i=W0(this,n);break;case"quarter":i=W0(this,n)/3;break;case"second":i=(this-n)/1e3;break;case"minute":i=(this-n)/6e4;break;case"hour":i=(this-n)/36e5;break;case"day":i=(this-n-a)/864e5;break;case"week":i=(this-n-a)/6048e5;break;default:i=this-n}return r?i:Ci(i)}function W0(e,t){if(e.date()<t.date())return-W0(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),a,i;return t-n<0?(a=e.clone().add(r-1,"months"),i=(t-n)/(n-a)):(a=e.clone().add(r+1,"months"),i=(t-n)/(a-n)),-(r+i)||0}Ve.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Ve.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function tKe(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function rKe(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?L0(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Qs(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",L0(r,"Z")):L0(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function nKe(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,a,i;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",a="-MM-DD[T]HH:mm:ss.SSS",i=t+'[")]',this.format(r+n+a+i)}function aKe(e){e||(e=this.isUtc()?Ve.defaultFormatUtc:Ve.defaultFormat);var t=L0(this,e);return this.localeData().postformat(t)}function iKe(e,t){return this.isValid()&&(ps(e)&&e.isValid()||Dr(e).isValid())?Ns({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function sKe(e){return this.from(Dr(),e)}function oKe(e,t){return this.isValid()&&(ps(e)&&e.isValid()||Dr(e).isValid())?Ns({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function lKe(e){return this.to(Dr(),e)}function KV(e){var t;return e===void 0?this._locale._abbr:(t=Xo(e),t!=null&&(this._locale=t),this)}var ZV=Yi("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function JV(){return this._locale}var Bv=1e3,cd=60*Bv,Wv=60*cd,QV=(365*400+97)*24*Wv;function ud(e,t){return(e%t+t)%t}function eq(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-QV:new Date(e,t,r).valueOf()}function tq(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-QV:Date.UTC(e,t,r)}function cKe(e){var t,r;if(e=Xi(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?tq:eq,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=ud(t+(this._isUTC?0:this.utcOffset()*cd),Wv);break;case"minute":t=this._d.valueOf(),t-=ud(t,cd);break;case"second":t=this._d.valueOf(),t-=ud(t,Bv);break}return this._d.setTime(t),Ve.updateOffset(this,!0),this}function uKe(e){var t,r;if(e=Xi(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?tq:eq,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=Wv-ud(t+(this._isUTC?0:this.utcOffset()*cd),Wv)-1;break;case"minute":t=this._d.valueOf(),t+=cd-ud(t,cd)-1;break;case"second":t=this._d.valueOf(),t+=Bv-ud(t,Bv)-1;break}return this._d.setTime(t),Ve.updateOffset(this,!0),this}function dKe(){return this._d.valueOf()-(this._offset||0)*6e4}function fKe(){return Math.floor(this.valueOf()/1e3)}function hKe(){return new Date(this.valueOf())}function mKe(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function pKe(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function xKe(){return this.isValid()?this.toISOString():null}function gKe(){return Nk(this)}function vKe(){return hl({},Nt(this))}function yKe(){return Nt(this).overflow}function bKe(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}ot("N",0,0,"eraAbbr");ot("NN",0,0,"eraAbbr");ot("NNN",0,0,"eraAbbr");ot("NNNN",0,0,"eraName");ot("NNNNN",0,0,"eraNarrow");ot("y",["y",1],"yo","eraYear");ot("y",["yy",2],0,"eraYear");ot("y",["yyy",3],0,"eraYear");ot("y",["yyyy",4],0,"eraYear");Je("N",zk);Je("NN",zk);Je("NNN",zk);Je("NNNN",AKe);Je("NNNNN",OKe);sr(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var a=r._locale.erasParse(e,n,r._strict);a?Nt(r).era=a:Nt(r).invalidEra=e});Je("y",$f);Je("yy",$f);Je("yyy",$f);Je("yyyy",$f);Je("yo",FKe);sr(["y","yy","yyy","yyyy"],na);sr(["yo"],function(e,t,r,n){var a;r._locale._eraYearOrdinalRegex&&(a=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[na]=r._locale.eraYearOrdinalParse(e,a):t[na]=parseInt(e,10)});function wKe(e,t){var r,n,a,i=this._eras||Xo("en")._eras;for(r=0,n=i.length;r<n;++r){switch(typeof i[r].since){case"string":a=Ve(i[r].since).startOf("day"),i[r].since=a.valueOf();break}switch(typeof i[r].until){case"undefined":i[r].until=1/0;break;case"string":a=Ve(i[r].until).startOf("day").valueOf(),i[r].until=a.valueOf();break}}return i}function _Ke(e,t,r){var n,a,i=this.eras(),s,l,c;for(e=e.toUpperCase(),n=0,a=i.length;n<a;++n)if(s=i[n].name.toUpperCase(),l=i[n].abbr.toUpperCase(),c=i[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(l===e)return i[n];break;case"NNNN":if(s===e)return i[n];break;case"NNNNN":if(c===e)return i[n];break}else if([s,l,c].indexOf(e)>=0)return i[n]}function DKe(e,t){var r=e.since<=e.until?1:-1;return t===void 0?Ve(e.since).year():Ve(e.since).year()+(t-e.offset)*r}function jKe(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function NKe(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function SKe(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function EKe(){var e,t,r,n,a=this.localeData().eras();for(e=0,t=a.length;e<t;++e)if(r=a[e].since<=a[e].until?1:-1,n=this.clone().startOf("day").valueOf(),a[e].since<=n&&n<=a[e].until||a[e].until<=n&&n<=a[e].since)return(this.year()-Ve(a[e].since).year())*r+a[e].offset;return this.year()}function TKe(e){return zt(this,"_erasNameRegex")||Hk.call(this),e?this._erasNameRegex:this._erasRegex}function kKe(e){return zt(this,"_erasAbbrRegex")||Hk.call(this),e?this._erasAbbrRegex:this._erasRegex}function CKe(e){return zt(this,"_erasNarrowRegex")||Hk.call(this),e?this._erasNarrowRegex:this._erasRegex}function zk(e,t){return t.erasAbbrRegex(e)}function AKe(e,t){return t.erasNameRegex(e)}function OKe(e,t){return t.erasNarrowRegex(e)}function FKe(e,t){return t._eraYearOrdinalRegex||$f}function Hk(){var e=[],t=[],r=[],n=[],a,i,s,l,c,u=this.eras();for(a=0,i=u.length;a<i;++a)s=Eo(u[a].name),l=Eo(u[a].abbr),c=Eo(u[a].narrow),t.push(s),e.push(l),r.push(c),n.push(s),n.push(l),n.push(c);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}ot(0,["gg",2],0,function(){return this.weekYear()%100});ot(0,["GG",2],0,function(){return this.isoWeekYear()%100});function R1(e,t){ot(0,[e,e.length],0,t)}R1("gggg","weekYear");R1("ggggg","weekYear");R1("GGGG","isoWeekYear");R1("GGGGG","isoWeekYear");Je("G",A1);Je("g",A1);Je("GG",jr,hi);Je("gg",jr,hi);Je("GGGG",Ak,Ck);Je("gggg",Ak,Ck);Je("GGGGG",C1,T1);Je("ggggg",C1,T1);kx(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=Ot(e)});kx(["gg","GG"],function(e,t,r,n){t[n]=Ve.parseTwoDigitYear(e)});function PKe(e){return rq.call(this,e,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function IKe(e){return rq.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function RKe(){return To(this.year(),1,4)}function MKe(){return To(this.isoWeekYear(),1,4)}function UKe(){var e=this.localeData()._week;return To(this.year(),e.dow,e.doy)}function $Ke(){var e=this.localeData()._week;return To(this.weekYear(),e.dow,e.doy)}function rq(e,t,r,n,a){var i;return e==null?Tp(this,n,a).year:(i=To(e,n,a),t>i&&(t=i),LKe.call(this,e,t,r,n,a))}function LKe(e,t,r,n,a){var i=IV(e,t,r,n,a),s=Ep(i.year,0,i.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}ot("Q",0,"Qo","quarter");Je("Q",jV);sr("Q",function(e,t){t[yo]=(Ot(e)-1)*3});function BKe(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}ot("D",["DD",2],"Do","date");Je("D",jr,Lf);Je("DD",jr,hi);Je("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});sr(["D","DD"],Os);sr("Do",function(e,t){t[Os]=Ot(e.match(jr)[0])});var nq=Bf("Date",!0);ot("DDD",["DDDD",3],"DDDo","dayOfYear");Je("DDD",k1);Je("DDDD",NV);sr(["DDD","DDDD"],function(e,t,r){r._dayOfYear=Ot(e)});function WKe(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}ot("m",["mm",2],0,"minute");Je("m",jr,Ok);Je("mm",jr,hi);sr(["m","mm"],ss);var zKe=Bf("Minutes",!1);ot("s",["ss",2],0,"second");Je("s",jr,Ok);Je("ss",jr,hi);sr(["s","ss"],bo);var HKe=Bf("Seconds",!1);ot("S",0,0,function(){return~~(this.millisecond()/100)});ot(0,["SS",2],0,function(){return~~(this.millisecond()/10)});ot(0,["SSS",3],0,"millisecond");ot(0,["SSSS",4],0,function(){return this.millisecond()*10});ot(0,["SSSSS",5],0,function(){return this.millisecond()*100});ot(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});ot(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});ot(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});ot(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});Je("S",k1,jV);Je("SS",k1,hi);Je("SSS",k1,NV);var ml,aq;for(ml="SSSS";ml.length<=9;ml+="S")Je(ml,$f);function VKe(e,t){t[jc]=Ot(("0."+e)*1e3)}for(ml="S";ml.length<=9;ml+="S")sr(ml,VKe);aq=Bf("Milliseconds",!1);ot("z",0,0,"zoneAbbr");ot("zz",0,0,"zoneName");function qKe(){return this._isUTC?"UTC":""}function GKe(){return this._isUTC?"Coordinated Universal Time":""}var Me=Ex.prototype;Me.add=$Xe;Me.calendar=qXe;Me.clone=GXe;Me.diff=eKe;Me.endOf=uKe;Me.format=aKe;Me.from=iKe;Me.fromNow=sKe;Me.to=oKe;Me.toNow=lKe;Me.get=nYe;Me.invalidAt=yKe;Me.isAfter=YXe;Me.isBefore=XXe;Me.isBetween=KXe;Me.isSame=ZXe;Me.isSameOrAfter=JXe;Me.isSameOrBefore=QXe;Me.isValid=gKe;Me.lang=ZV;Me.locale=KV;Me.localeData=JV;Me.max=gXe;Me.min=xXe;Me.parsingFlags=vKe;Me.set=aYe;Me.startOf=cKe;Me.subtract=LXe;Me.toArray=mKe;Me.toObject=pKe;Me.toDate=hKe;Me.toISOString=rKe;Me.inspect=nKe;typeof Symbol<"u"&&Symbol.for!=null&&(Me[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});Me.toJSON=xKe;Me.toString=tKe;Me.unix=fKe;Me.valueOf=dKe;Me.creationData=bKe;Me.eraName=jKe;Me.eraNarrow=NKe;Me.eraAbbr=SKe;Me.eraYear=EKe;Me.year=TV;Me.isLeapYear=rYe;Me.weekYear=PKe;Me.isoWeekYear=IKe;Me.quarter=Me.quarters=BKe;Me.month=FV;Me.daysInMonth=hYe;Me.week=Me.weeks=wYe;Me.isoWeek=Me.isoWeeks=_Ye;Me.weeksInYear=UKe;Me.weeksInWeekYear=$Ke;Me.isoWeeksInYear=RKe;Me.isoWeeksInISOWeekYear=MKe;Me.date=nq;Me.day=Me.days=IYe;Me.weekday=RYe;Me.isoWeekday=MYe;Me.dayOfYear=WKe;Me.hour=Me.hours=HYe;Me.minute=Me.minutes=zKe;Me.second=Me.seconds=HKe;Me.millisecond=Me.milliseconds=aq;Me.utcOffset=SXe;Me.utc=TXe;Me.local=kXe;Me.parseZone=CXe;Me.hasAlignedHourOffset=AXe;Me.isDST=OXe;Me.isLocal=PXe;Me.isUtcOffset=IXe;Me.isUtc=qV;Me.isUTC=qV;Me.zoneAbbr=qKe;Me.zoneName=GKe;Me.dates=Yi("dates accessor is deprecated. Use date instead.",nq);Me.months=Yi("months accessor is deprecated. Use month instead",FV);Me.years=Yi("years accessor is deprecated. Use year instead",TV);Me.zone=Yi("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",EXe);Me.isDSTShifted=Yi("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",FXe);function YKe(e){return Dr(e*1e3)}function XKe(){return Dr.apply(null,arguments).parseZone()}function iq(e){return e}var qt=Ek.prototype;qt.calendar=PGe;qt.longDateFormat=UGe;qt.invalidDate=LGe;qt.ordinal=zGe;qt.preparse=iq;qt.postformat=iq;qt.relativeTime=VGe;qt.pastFuture=qGe;qt.set=OGe;qt.eras=wKe;qt.erasParse=_Ke;qt.erasConvertYear=DKe;qt.erasAbbrRegex=kKe;qt.erasNameRegex=TKe;qt.erasNarrowRegex=CKe;qt.months=cYe;qt.monthsShort=uYe;qt.monthsParse=fYe;qt.monthsRegex=pYe;qt.monthsShortRegex=mYe;qt.week=gYe;qt.firstDayOfYear=bYe;qt.firstDayOfWeek=yYe;qt.weekdays=CYe;qt.weekdaysMin=OYe;qt.weekdaysShort=AYe;qt.weekdaysParse=PYe;qt.weekdaysRegex=UYe;qt.weekdaysShortRegex=$Ye;qt.weekdaysMinRegex=LYe;qt.isPM=WYe;qt.meridiem=VYe;function zv(e,t,r,n){var a=Xo(),i=Js().set(n,t);return a[r](i,e)}function sq(e,t,r){if(Bo(e)&&(t=e,e=void 0),e=e||"",t!=null)return zv(e,t,r,"month");var n,a=[];for(n=0;n<12;n++)a[n]=zv(e,n,r,"month");return a}function Vk(e,t,r,n){typeof e=="boolean"?(Bo(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,Bo(t)&&(r=t,t=void 0),t=t||"");var a=Xo(),i=e?a._week.dow:0,s,l=[];if(r!=null)return zv(t,(r+i)%7,n,"day");for(s=0;s<7;s++)l[s]=zv(t,(s+i)%7,n,"day");return l}function KKe(e,t){return sq(e,t,"months")}function ZKe(e,t){return sq(e,t,"monthsShort")}function JKe(e,t,r){return Vk(e,t,r,"weekdays")}function QKe(e,t,r){return Vk(e,t,r,"weekdaysShort")}function eZe(e,t,r){return Vk(e,t,r,"weekdaysMin")}wl("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=Ot(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});Ve.lang=Yi("moment.lang is deprecated. Use moment.locale instead.",wl);Ve.langData=Yi("moment.langData is deprecated. Use moment.localeData instead.",Xo);var uo=Math.abs;function tZe(){var e=this._data;return this._milliseconds=uo(this._milliseconds),this._days=uo(this._days),this._months=uo(this._months),e.milliseconds=uo(e.milliseconds),e.seconds=uo(e.seconds),e.minutes=uo(e.minutes),e.hours=uo(e.hours),e.months=uo(e.months),e.years=uo(e.years),this}function oq(e,t,r,n){var a=Ns(t,r);return e._milliseconds+=n*a._milliseconds,e._days+=n*a._days,e._months+=n*a._months,e._bubble()}function rZe(e,t){return oq(this,e,t,1)}function nZe(e,t){return oq(this,e,t,-1)}function y8(e){return e<0?Math.floor(e):Math.ceil(e)}function aZe(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,a,i,s,l,c;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=y8(Gj(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,a=Ci(e/1e3),n.seconds=a%60,i=Ci(a/60),n.minutes=i%60,s=Ci(i/60),n.hours=s%24,t+=Ci(s/24),c=Ci(lq(t)),r+=c,t-=y8(Gj(c)),l=Ci(r/12),r%=12,n.days=t,n.months=r,n.years=l,this}function lq(e){return e*4800/146097}function Gj(e){return e*146097/4800}function iZe(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=Xi(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+lq(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(Gj(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function Ko(e){return function(){return this.as(e)}}var cq=Ko("ms"),sZe=Ko("s"),oZe=Ko("m"),lZe=Ko("h"),cZe=Ko("d"),uZe=Ko("w"),dZe=Ko("M"),fZe=Ko("Q"),hZe=Ko("y"),mZe=cq;function pZe(){return Ns(this)}function xZe(e){return e=Xi(e),this.isValid()?this[e+"s"]():NaN}function bu(e){return function(){return this.isValid()?this._data[e]:NaN}}var gZe=bu("milliseconds"),vZe=bu("seconds"),yZe=bu("minutes"),bZe=bu("hours"),wZe=bu("days"),_Ze=bu("months"),DZe=bu("years");function jZe(){return Ci(this.days()/7)}var ho=Math.round,Ku={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function NZe(e,t,r,n,a){return a.relativeTime(t||1,!!r,e,n)}function SZe(e,t,r,n){var a=Ns(e).abs(),i=ho(a.as("s")),s=ho(a.as("m")),l=ho(a.as("h")),c=ho(a.as("d")),u=ho(a.as("M")),d=ho(a.as("w")),f=ho(a.as("y")),h=i<=r.ss&&["s",i]||i<r.s&&["ss",i]||s<=1&&["m"]||s<r.m&&["mm",s]||l<=1&&["h"]||l<r.h&&["hh",l]||c<=1&&["d"]||c<r.d&&["dd",c];return r.w!=null&&(h=h||d<=1&&["w"]||d<r.w&&["ww",d]),h=h||u<=1&&["M"]||u<r.M&&["MM",u]||f<=1&&["y"]||["yy",f],h[2]=t,h[3]=+e>0,h[4]=n,NZe.apply(null,h)}function EZe(e){return e===void 0?ho:typeof e=="function"?(ho=e,!0):!1}function TZe(e,t){return Ku[e]===void 0?!1:t===void 0?Ku[e]:(Ku[e]=t,e==="s"&&(Ku.ss=t-1),!0)}function kZe(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Ku,a,i;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},Ku,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),a=this.localeData(),i=SZe(this,!r,n,a),r&&(i=a.pastFuture(+this,i)),a.postformat(i)}var m_=Math.abs;function Mu(e){return(e>0)-(e<0)||+e}function M1(){if(!this.isValid())return this.localeData().invalidDate();var e=m_(this._milliseconds)/1e3,t=m_(this._days),r=m_(this._months),n,a,i,s,l=this.asSeconds(),c,u,d,f;return l?(n=Ci(e/60),a=Ci(n/60),e%=60,n%=60,i=Ci(r/12),r%=12,s=e?e.toFixed(3).replace(/\.?0+$/,""):"",c=l<0?"-":"",u=Mu(this._months)!==Mu(l)?"-":"",d=Mu(this._days)!==Mu(l)?"-":"",f=Mu(this._milliseconds)!==Mu(l)?"-":"",c+"P"+(i?u+i+"Y":"")+(r?u+r+"M":"")+(t?d+t+"D":"")+(a||n||e?"T":"")+(a?f+a+"H":"")+(n?f+n+"M":"")+(e?f+s+"S":"")):"P0D"}var $t=I1.prototype;$t.isValid=_Xe;$t.abs=tZe;$t.add=rZe;$t.subtract=nZe;$t.as=iZe;$t.asMilliseconds=cq;$t.asSeconds=sZe;$t.asMinutes=oZe;$t.asHours=lZe;$t.asDays=cZe;$t.asWeeks=uZe;$t.asMonths=dZe;$t.asQuarters=fZe;$t.asYears=hZe;$t.valueOf=mZe;$t._bubble=aZe;$t.clone=pZe;$t.get=xZe;$t.milliseconds=gZe;$t.seconds=vZe;$t.minutes=yZe;$t.hours=bZe;$t.days=wZe;$t.weeks=jZe;$t.months=_Ze;$t.years=DZe;$t.humanize=kZe;$t.toISOString=M1;$t.toString=M1;$t.toJSON=M1;$t.locale=KV;$t.localeData=JV;$t.toIsoString=Yi("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",M1);$t.lang=ZV;ot("X",0,0,"unix");ot("x",0,0,"valueOf");Je("x",A1);Je("X",KGe);sr("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});sr("x",function(e,t,r){r._d=new Date(Ot(e))});//! moment.js
Ve.version="2.30.1";CGe(Dr);Ve.fn=Me;Ve.min=vXe;Ve.max=yXe;Ve.now=bXe;Ve.utc=Js;Ve.unix=YKe;Ve.months=KKe;Ve.isDate=Sx;Ve.locale=wl;Ve.invalid=E1;Ve.duration=Ns;Ve.isMoment=ps;Ve.weekdays=JKe;Ve.parseZone=XKe;Ve.localeData=Xo;Ve.isDuration=B0;Ve.monthsShort=ZKe;Ve.weekdaysMin=eZe;Ve.defineLocale=Mk;Ve.updateLocale=XYe;Ve.locales=KYe;Ve.weekdaysShort=QKe;Ve.normalizeUnits=Xi;Ve.relativeTimeRounding=EZe;Ve.relativeTimeThreshold=TZe;Ve.calendarFormat=VXe;Ve.prototype=Me;Ve.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const CZe=kGe(Ve),AZe=({filters:e,currentUser:t})=>{const[r,n]=M.useState([]),[a,i]=M.useState(!1),[s,l]=M.useState(null),[c,u]=M.useState(!1),[d,f]=M.useState(new Date),[h,m]=M.useState("month"),x=M.useCallback(async D=>{i(!0);try{let j,N;h==="month"?(j=Ve(D).startOf("month").subtract(7,"days").format("YYYY-MM-DD"),N=Ve(D).endOf("month").add(7,"days").format("YYYY-MM-DD")):h==="week"?(j=Ve(D).startOf("week").format("YYYY-MM-DD"),N=Ve(D).endOf("week").format("YYYY-MM-DD")):h==="day"?(j=Ve(D).format("YYYY-MM-DD"),N=Ve(D).format("YYYY-MM-DD")):(j=Ve(D).format("YYYY-MM-DD"),N=Ve(D).add(1,"month").format("YYYY-MM-DD"));const E=(await ei.getCalendarActivities(j,N)).map(A=>({id:A.id,title:A.subject,start:new Date(A.scheduled_at),end:A.end_time?new Date(A.end_time):new Date(A.scheduled_at),resource:{...A,type:A.type,source:A.sync_source||"crm",location:A.location,meeting_link:A.meeting_link,attendees:A.attendees,contact:A.contact,deal:A.deal,sync_status:A.sync_status,outlook_event_id:A.outlook_event_id}}));n(E)}catch{}finally{i(!1)}},[h]);M.useEffect(()=>{x(d)},[d,h,x]);const p=D=>{f(D)},g=D=>{m(D)},v=D=>{l(D),u(!0)},y=D=>{},b=D=>{const j=D.resource;let N={borderRadius:"4px",opacity:.9,border:"0px",display:"block",fontSize:"13px"};return j.type==="meeting"?N.backgroundColor="#10b981":j.type==="call"?N.backgroundColor="#f59e0b":j.type==="email"?N.backgroundColor="#3b82f6":j.type==="task"?N.backgroundColor="#8b5cf6":N.backgroundColor="#6b7280",j.source==="outlook"&&(N.borderLeft="4px solid #0078D4",N.paddingLeft="4px"),{style:N}},w=({event:D})=>{const j=D.resource;return o.jsxs("div",{className:"calendar-event-content",children:[o.jsxs("div",{className:"calendar-event-header",children:[j.source==="outlook"&&o.jsx("span",{className:"calendar-event-badge",title:"Synced from Outlook",children:""}),j.type==="meeting"&&o.jsx(p_,{size:12}),j.type==="call"&&o.jsx("span",{children:""}),j.type==="email"&&o.jsx("span",{children:""}),j.type==="task"&&o.jsx("span",{children:""})]}),o.jsx("div",{className:"calendar-event-title",children:D.title}),j.meeting_link&&o.jsxs("div",{className:"calendar-event-link",children:[o.jsx(D8,{size:10})," Teams"]}),j.location&&o.jsxs("div",{className:"calendar-event-location",children:[o.jsx(j8,{size:10})," ",j.location]})]})},_=D=>{const j=()=>{D.onNavigate("PREV")},N=()=>{D.onNavigate("NEXT")},S=()=>{D.onNavigate("TODAY")},E=()=>{const A=Ve(D.date);return D.view==="month"?A.format("MMMM YYYY"):D.view==="week"?`${A.startOf("week").format("MMM D")} - ${A.endOf("week").format("MMM D, YYYY")}`:D.view==="day"?A.format("MMMM D, YYYY"):A.format("MMMM YYYY")};return o.jsxs("div",{className:"rbc-toolbar",children:[o.jsxs("span",{className:"rbc-btn-group",children:[o.jsx("button",{type:"button",onClick:S,children:"Today"}),o.jsx("button",{type:"button",onClick:j,children:"Back"}),o.jsx("button",{type:"button",onClick:N,children:"Next"})]}),o.jsx("span",{className:"rbc-toolbar-label",children:E()}),o.jsxs("span",{className:"rbc-btn-group",children:[o.jsx("button",{type:"button",className:D.view==="month"?"rbc-active":"",onClick:()=>D.onView("month"),children:"Month"}),o.jsx("button",{type:"button",className:D.view==="week"?"rbc-active":"",onClick:()=>D.onView("week"),children:"Week"}),o.jsx("button",{type:"button",className:D.view==="day"?"rbc-active":"",onClick:()=>D.onView("day"),children:"Day"}),o.jsx("button",{type:"button",className:D.view==="agenda"?"rbc-active":"",onClick:()=>D.onView("agenda"),children:"Agenda"})]})]})};return o.jsxs("div",{className:"activity-calendar-container",children:[a&&o.jsxs("div",{className:"calendar-loading-overlay",children:[o.jsx("div",{className:"spinner"}),o.jsx("span",{children:"Loading calendar..."})]}),o.jsx(DGe,{localizer:CZe,events:r,startAccessor:"start",endAccessor:"end",style:{height:700},onNavigate:p,onView:g,onSelectEvent:v,onSelectSlot:y,selectable:!0,popup:!0,views:["month","week","day","agenda"],view:h,date:d,eventPropGetter:b,components:{event:w,toolbar:_},step:30,showMultiDayTimes:!0,defaultDate:new Date}),c&&s&&o.jsx(OZe,{event:s,onClose:()=>{u(!1),l(null)},onRefresh:()=>x(d)})]})},OZe=({event:e,onClose:t,onRefresh:r})=>{const n=e.resource;return o.jsx("div",{className:"modal-overlay",onClick:t,children:o.jsxs("div",{className:"modal-content",onClick:a=>a.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:e.title}),o.jsx("button",{onClick:t,className:"modal-close",children:""})]}),o.jsxs("div",{className:"modal-body",children:[o.jsxs("div",{className:"event-detail-row",children:[o.jsx("strong",{children:"Type:"}),o.jsx("span",{className:"event-type-badge",children:n.type})]}),o.jsxs("div",{className:"event-detail-row",children:[o.jsx("strong",{children:"Date & Time:"}),o.jsxs("span",{children:[Ve(e.start).format("MMMM D, YYYY h:mm A")," - ",Ve(e.end).format("h:mm A")]})]}),n.location&&o.jsxs("div",{className:"event-detail-row",children:[o.jsxs("strong",{children:[o.jsx(j8,{size:16})," Location:"]}),o.jsx("span",{children:n.location})]}),n.meeting_link&&o.jsxs("div",{className:"event-detail-row",children:[o.jsxs("strong",{children:[o.jsx(D8,{size:16})," Meeting Link:"]}),o.jsx("a",{href:n.meeting_link,target:"_blank",rel:"noopener noreferrer",className:"meeting-link",children:"Join Teams Meeting"})]}),n.attendees&&n.attendees.length>0&&o.jsxs("div",{className:"event-detail-row",children:[o.jsxs("strong",{children:[o.jsx(_q,{size:16})," Attendees:"]}),o.jsx("div",{className:"attendees-list",children:n.attendees.map((a,i)=>o.jsx("span",{className:"attendee-badge",children:a},i))})]}),n.contact&&o.jsxs("div",{className:"event-detail-row",children:[o.jsx("strong",{children:"Contact:"}),o.jsxs("span",{children:[n.contact.first_name," ",n.contact.last_name]})]}),n.deal&&o.jsxs("div",{className:"event-detail-row",children:[o.jsx("strong",{children:"Deal:"}),o.jsx("span",{children:n.deal.name})]}),n.description&&o.jsxs("div",{className:"event-detail-row",children:[o.jsx("strong",{children:"Description:"}),o.jsx("p",{children:n.description})]}),n.source==="outlook"&&o.jsx("div",{className:"event-detail-badge outlook-badge",children:" Synced from Outlook"})]}),o.jsx("div",{className:"modal-footer",children:o.jsx("button",{onClick:t,className:"btn-secondary",children:"Close"})})]})})},FZe=()=>{const{user:e,hasAnyPermission:t}=Vt(),[r,n]=M.useState([]),[a,i]=M.useState(!0),[s,l]=M.useState(""),[c,u]=M.useState({activityType:"all",dateRange:"all",teamMember:"all",channel:"all"}),[d,f]=M.useState(""),[h,m]=M.useState(!1),[x,p]=M.useState(!1),[g,v]=M.useState(!0),[y,b]=M.useState(new Set),[w,_]=M.useState(!1),[D,j]=M.useState("timeline"),[N,S]=M.useState("auto"),[E,A]=M.useState(!1),[T,L]=M.useState(new Date),[O,V]=M.useState(null),[W,B]=M.useState(null),P=M.useCallback(async()=>{if(e)try{i(!0),l("");const ee=await ei.getUserActivities();n(ee),L(new Date)}catch{l("Failed to load activities. Please try again.")}finally{i(!1)}},[e]);M.useEffect(()=>{P()},[P]),M.useEffect(()=>{if(!E)return;const ee=setInterval(()=>{P()},3e4);return()=>clearInterval(ee)},[E,P]);const F=ee=>{n(ae=>[ee,...ae])},I=async ee=>{try{const ae=await ei.getActivityById(ee.id);B(ae),m(!0)}catch(ae){console.error("Error fetching activity for editing:",ae),B(ee),m(!0)}},R=ee=>{n(ae=>ae.map(pe=>pe.id===ee.id?ee:pe))},C=async ee=>{if(window.confirm("Are you sure you want to delete this activity? This action cannot be undone."))try{await ei.deleteActivity(ee),n(ae=>ae.filter(pe=>pe.id!==ee)),b(ae=>{const pe=new Set(ae);return pe.delete(ee),_(pe.size>0),pe})}catch(ae){console.error("Error deleting activity:",ae),l("Failed to delete activity. Please try again.")}},k=async(ee,ae)=>{try{switch(ee){case"delete":if(!window.confirm(`Are you sure you want to delete ${ae.length} activities? This action cannot be undone.`))return;await Promise.all(ae.map(re=>ei.deleteActivity(re))),n(re=>re.filter(X=>!ae.includes(X.id)));break;case"export":const H=r.filter(re=>ae.includes(re.id)).map(re=>{var X,G;return{id:re.id,timestamp:re.created_at,type:re.type,subject:re.subject,description:re.description,contact:re.contact?`${re.contact.first_name} ${re.contact.last_name}`:"N/A",company:((G=(X=re.contact)==null?void 0:X.company)==null?void 0:G.name)||"N/A",user:re.user?`${re.user.first_name} ${re.user.last_name}`:"N/A",duration_minutes:re.duration_minutes||null,scheduled_at:re.scheduled_at||null}}),ne=new Blob([JSON.stringify(H,null,2)],{type:"application/json"}),U=URL.createObjectURL(ne),le=document.createElement("a");le.href=U,le.download=`selected_activities_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(le),le.click(),document.body.removeChild(le),URL.revokeObjectURL(U);break;default:break}b(new Set),_(!1)}catch(pe){console.error("Bulk action failed:",pe),l("Failed to perform bulk action. Please try again.")}},z=(ee,ae)=>{b(pe=>{const H=new Set(pe);return ae?H.add(ee):H.delete(ee),_(H.size>0),H})},q=()=>{y.size===se.length?(b(new Set),_(!1)):(b(new Set(se.map(ee=>ee.id))),_(!0))},K=M.useMemo(()=>r.map(ee=>{var ae,pe,H,ne,U,le,re,X,G,ce,J,ue;return{id:ee.id,type:ee.type,channel:ee.channel||"system",title:ee.subject,description:ee.description,contact_id:ee.contact_id,contact:ee.contact?`${ee.contact.first_name} ${ee.contact.last_name}`:"N/A",company:((pe=(ae=ee.contact)==null?void 0:ae.company)==null?void 0:pe.name)||"N/A",timestamp:new Date(ee.created_at),user:ee.user?`${ee.user.first_name} ${ee.user.last_name}`:"System",avatar:((H=ee.user)==null?void 0:H.avatar_url)||null,contactAvatar:((ne=ee.contact)==null?void 0:ne.avatar_url)||null,status:ee.status,priority:ee.priority,dealValue:ee.deal?`${(U=ee.deal.value)==null?void 0:U.toLocaleString()}`:null,attachments:ee.attachments||[],duration:ee.duration_minutes?`${ee.duration_minutes} min`:null,previousStage:(le=ee.metadata)==null?void 0:le.previous_stage,currentStage:(re=ee.metadata)==null?void 0:re.current_stage,probability:(X=ee.metadata)==null?void 0:X.probability,meetingType:(G=ee.metadata)==null?void 0:G.meeting_type,location:(ce=ee.metadata)==null?void 0:ce.location,attendees:(J=ee.metadata)==null?void 0:J.attendees,callType:(ue=ee.metadata)==null?void 0:ue.call_type}}),[r]),se=M.useMemo(()=>K.filter(ee=>{var re,X,G,ce;const ae=c.activityType==="all"||ee.type===c.activityType,pe=c.channel==="all"||ee.channel===c.channel,H=c.teamMember==="all"||ee.contact_id===c.teamMember,ne=d.toLowerCase(),U=d===""||((re=ee.title)==null?void 0:re.toLowerCase().includes(ne))||((X=ee.description)==null?void 0:X.toLowerCase().includes(ne))||((G=ee.contact)==null?void 0:G.toLowerCase().includes(ne))||((ce=ee.company)==null?void 0:ce.toLowerCase().includes(ne));let le=!0;if(c.dateRange!=="all"){const J=new Date,ue=new Date(ee.timestamp);switch(c.dateRange){case"today":le=ue.toDateString()===J.toDateString();break;case"week":const me=new Date(J.getTime()-7*24*60*60*1e3);le=ue>=me;break;case"month":const te=new Date(J.getTime()-30*24*60*60*1e3);le=ue>=te;break}}return ae&&pe&&H&&U&&le}),[K,c,d]),ie=()=>{const ee=se.map(ne=>({timestamp:ne.timestamp.toISOString(),type:ne.type,title:ne.title,contact:ne.contact,company:ne.company,user:ne.user,description:ne.description})),ae=new Blob([JSON.stringify(ee,null,2)],{type:"application/json"}),pe=URL.createObjectURL(ae),H=document.createElement("a");H.href=pe,H.download=`activity_timeline_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(H),H.click(),document.body.removeChild(H),URL.revokeObjectURL(pe)};return o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(ii,{}),o.jsx("main",{className:"pt-16",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[o.jsx(Hs,{}),o.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-8",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold text-text-primary mb-2",children:"Activity Timeline"}),o.jsx("p",{className:"text-text-secondary",children:"Unified view of all customer interactions across communication channels"})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-3 sm:space-y-0 sm:space-x-4 mt-4 lg:mt-0",children:[c.teamMember!=="all"&&o.jsxs("div",{className:"flex items-center bg-surface border border-border rounded-lg p-1",children:[o.jsxs("button",{onClick:()=>S("timeline"),className:`px-3 py-1.5 text-sm rounded-md transition-all duration-150 flex items-center space-x-1 ${N==="timeline"?"bg-primary text-white":"text-text-secondary hover:text-text-primary"}`,children:[o.jsx(Y,{name:"GitBranch",size:16}),o.jsx("span",{children:"Timeline"})]}),o.jsxs("button",{onClick:()=>S("list"),className:`px-3 py-1.5 text-sm rounded-md transition-all duration-150 flex items-center space-x-1 ${N==="list"?"bg-primary text-white":"text-text-secondary hover:text-text-primary"}`,children:[o.jsx(Y,{name:"List",size:16}),o.jsx("span",{children:"List"})]}),o.jsxs("button",{onClick:()=>S("calendar"),className:`px-3 py-1.5 text-sm rounded-md transition-all duration-150 flex items-center space-x-1 ${N==="calendar"?"bg-primary text-white":"text-text-secondary hover:text-text-primary"}`,children:[o.jsx(Y,{name:"Calendar",size:16}),o.jsx("span",{children:"Calendar"})]})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("button",{onClick:()=>p(!0),className:"flex items-center space-x-2 px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-out",children:[o.jsx(Y,{name:"FileTemplate",size:16}),o.jsx("span",{children:"Templates"})]}),o.jsxs("button",{onClick:ie,className:"flex items-center space-x-2 px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-out",children:[o.jsx(Y,{name:"Download",size:16}),o.jsx("span",{children:"Export"})]}),t(["activities.create_all","activities.create_own"])&&o.jsxs("button",{onClick:()=>m(!0),className:"btn-primary flex items-center space-x-2",children:[o.jsx(Y,{name:"Plus",size:16}),o.jsx("span",{children:"Add Activity"})]})]})]})]}),s&&o.jsxs("div",{className:"bg-error-50 border border-error-200 text-error p-4 rounded-lg mb-6 flex items-center space-x-2",children:[o.jsx(Y,{name:"AlertCircle",size:20}),o.jsx("span",{children:s})]}),o.jsx("div",{className:"mb-6",children:o.jsxs("div",{className:"relative max-w-md",children:[o.jsx(Y,{name:"Search",size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary"}),o.jsx("input",{type:"text",placeholder:"Search activities, contacts, or companies...",value:d,onChange:ee=>f(ee.target.value),className:"input-field pl-10"})]})}),o.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[o.jsx("div",{className:`lg:w-80 ${g?"block":"hidden lg:block"}`,children:o.jsxs("div",{className:"card sticky top-24 max-h-[calc(100vh-8rem)] flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 pb-4 border-b border-border",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Filters"}),o.jsx("button",{onClick:()=>v(!g),className:"lg:hidden p-1 text-text-secondary hover:text-text-primary",children:o.jsx(Y,{name:"X",size:20})})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-6 pt-4 scrollbar-thin scrollbar-thumb-border scrollbar-track-transparent",children:o.jsx(cze,{selectedFilters:c,onFiltersChange:u})})]})}),o.jsx("button",{onClick:()=>v(!g),className:"lg:hidden fixed bottom-6 right-6 w-14 h-14 bg-primary text-white rounded-full shadow-lg flex items-center justify-center z-50",children:o.jsx(Y,{name:"Filter",size:20})}),o.jsxs("div",{className:"flex-1",children:[w&&o.jsx(dze,{selectedCount:y.size,selectedIds:Array.from(y),onBulkAction:k,onClearSelection:()=>{b(new Set),_(!1)}}),o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("div",{className:"text-sm text-text-secondary",children:["Showing ",se.length," of ",r.length," activities",c.teamMember==="all"&&o.jsx("span",{className:"ml-2 text-xs text-text-tertiary",children:" List view (all contacts)"}),c.teamMember!=="all"&&N==="timeline"&&o.jsx("span",{className:"ml-2 text-xs text-text-tertiary",children:" Timeline view"}),c.teamMember!=="all"&&N==="list"&&o.jsx("span",{className:"ml-2 text-xs text-text-tertiary",children:" List view"}),c.teamMember!=="all"&&N==="calendar"&&o.jsx("span",{className:"ml-2 text-xs text-text-tertiary",children:" Calendar view"})]}),se.length>0&&o.jsxs("label",{className:"flex items-center space-x-2 text-sm text-text-secondary",children:[o.jsx("input",{type:"checkbox",checked:y.size===se.length,onChange:q,className:"rounded border-border text-primary focus:ring-primary"}),o.jsx("span",{children:"Select all"})]})]}),(c.activityType!=="all"||c.dateRange!=="all"||c.channel!=="all"||d)&&o.jsx("button",{onClick:()=>{u({activityType:"all",dateRange:"all",teamMember:"all",channel:"all"}),f("")},className:"text-sm text-primary hover:text-primary-700 transition-colors duration-150 ease-out",children:"Clear all filters"})]}),D==="insights"?o.jsx(uze,{activities:se}):o.jsx(o.Fragment,{children:a?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),o.jsx("p",{className:"text-text-secondary",children:"Loading activities..."})]}):o.jsx(o.Fragment,{children:se.length>0?N==="calendar"?o.jsx(AZe,{filters:c,currentUser:e,onActivityAdded:F,onActivityUpdated:R,onEditActivity:I}):c.teamMember==="all"||N==="list"?o.jsx(mze,{activities:se,selectedActivities:y,onActivitySelection:z,onEdit:I,onDelete:C,onSelectAll:q}):o.jsx("div",{className:"space-y-6",children:se.map((ee,ae)=>o.jsx(lze,{activity:ee,isLast:ae===se.length-1,isSelected:y.has(ee.id),onSelectionChange:pe=>z(ee.id,pe),showCheckbox:!0,onEdit:I,onDelete:C},ee.id))}):o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"w-16 h-16 bg-primary-50 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(Y,{name:"Clock",size:32,className:"text-primary"})}),o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"No activities found"}),o.jsx("p",{className:"text-text-secondary mb-4",children:"Try adjusting your filters or search terms to find activities."}),o.jsx("button",{onClick:()=>m(!0),className:"btn-primary",children:"Add First Activity"})]})})})]})]})]})}),h&&o.jsx(wH,{isOpen:h,onClose:()=>{m(!1),V(null),B(null)},onActivityAdded:F,onActivityUpdated:R,prefilledData:O?O.template:{},templateData:O,editingActivity:W}),x&&o.jsx(hze,{isOpen:x,onClose:()=>p(!1),onTemplateSelected:ee=>{V(ee),p(!1),m(!0)}})]})},PZe=({activeSection:e,onSectionChange:t})=>{const{user:r,hasPermission:n}=Vt(),i=[{id:"user-management",label:"User Management",icon:"Users",description:"Manage users, roles and status",requiredPermission:"settings.user_management"},{id:"permissions",label:"Permissions",icon:"Shield",description:"Role-based access control",requiredPermission:"settings.permissions"},{id:"integrations",label:"Integrations",icon:"Plug",description:"API connections and services",requiredPermission:"settings.integrations"},{id:"custom-fields",label:"Custom Fields",icon:"ListPlus",description:"Field creation and configuration",requiredPermission:"settings.custom_fields"},{id:"email-templates",label:"Email Templates",icon:"Mail",description:"Template editor and management",requiredPermission:"settings.email_templates"},{id:"system-config",label:"System Configuration",icon:"Settings",description:"General system settings",requiredPermission:"settings.system_config"}].filter(s=>s.requiredPermission?n(s.requiredPermission):!0);return o.jsx("nav",{className:"w-full bg-surface border-r border-border h-full",children:o.jsxs("div",{className:"p-3 xs:p-4 sm:p-6",children:[o.jsx("h2",{className:"text-base xs:text-lg font-semibold text-text-primary mb-3 xs:mb-4 sm:mb-6",children:"Settings Categories"}),o.jsx("ul",{className:"space-y-1.5 xs:space-y-2",children:i==null?void 0:i.map(s=>o.jsx("li",{children:o.jsx("button",{onClick:()=>t==null?void 0:t(s==null?void 0:s.id),className:`w-full text-left p-3 xs:p-4 rounded-lg transition-all duration-150 ease-smooth group min-h-touch ${e===(s==null?void 0:s.id)?"bg-primary-50 border border-primary-100 text-primary":"text-text-secondary hover:text-primary"}`,children:o.jsxs("div",{className:"flex items-start space-x-2 xs:space-x-3",children:[o.jsx(Y,{name:s==null?void 0:s.icon,size:18,className:`xs:w-5 xs:h-5 mt-0.5 ${e===(s==null?void 0:s.id)?"text-primary":"text-text-tertiary group-hover:text-primary"}`}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:`font-medium text-xs xs:text-sm ${e===(s==null?void 0:s.id)?"text-primary":""}`,children:s==null?void 0:s.label}),o.jsx("div",{className:"text-xs text-text-tertiary mt-0.5 xs:mt-1 leading-tight",children:s==null?void 0:s.description})]})]})})},s==null?void 0:s.id))})]})})},Nr={async getAllUsers(){const{data:e,error:t}=await be.get("/api/v1/users");if(t)throw t;return e||[]},async getCurrentUserProfile(){const{data:e,error:t}=await be.get("/api/v1/users/me");if(t)throw t;return e},async updateCurrentUserProfile(e){const{data:t,error:r}=await be.put("/api/v1/users/me",e);if(r)throw r;return t},async getUserById(e){const{data:t,error:r}=await be.get(`/api/v1/users/${e}`);if(r){if(r.status===404)return null;throw r}return t},async updateUser(e,t){const{data:r,error:n}=await be.put(`/api/v1/users/${e}`,t);if(n)throw n;return r},async getUserStats(){const{data:e,error:t}=await be.get("/api/v1/users/stats");return t?{total:0,active:0,roles:{}}:e},async searchUsers(e){const{data:t,error:r}=await be.get(`/api/v1/users?search=${encodeURIComponent(e)}`);if(r)throw r;return t||[]},async getUsersByRole(e){const{data:t,error:r}=await be.get(`/api/v1/users?role=${encodeURIComponent(e)}`);if(r)throw r;return t||[]},async filterUsers(e){const t=new URLSearchParams;e.status&&e.status!=="all"&&t.append("status",e.status),e.roles&&e.roles.length>0&&t.append("roles",e.roles.join(","));const r=t.toString(),n=r?`/api/v1/users?${r}`:"/api/v1/users",{data:a,error:i}=await be.get(n);if(i)throw i;return a||[]},getUserRoles(){return[{value:"admin",label:"Administrator",description:"Full system access"},{value:"sales_manager",label:"Sales Manager",description:"Team management access"},{value:"sales_rep",label:"Sales Representative",description:"Standard user access"},{value:"user",label:"User",description:"Basic user access"}]},async inviteUser(e){const{data:t,error:r}=await be.post("/api/v1/users/invite",e);if(r)throw r;return t},async changeUserRole(e,t){return this.updateUser(e,{role:t})},async deactivateUser(e){return this.updateUser(e,{is_active:!1})},async reactivateUser(e){return this.updateUser(e,{is_active:!0})},async bulkUpdateUsers(e,t){const r=e.map(i=>this.updateUser(i,t)),n=await Promise.allSettled(r),a=n.filter(i=>i.status==="rejected");if(a.length>0)throw console.error("Some updates failed:",a),new Error(`Failed to update ${a.length} user(s)`);return n.map(i=>i.value)}},b8=()=>{try{const{user:e}=Vt(),[t,r]=M.useState([]),[n,a]=M.useState(!0),[i,s]=M.useState(""),[l,c]=M.useState(""),[u,d]=M.useState([]),[f,h]=M.useState(!1),[m,x]=M.useState({email:"",firstName:"",lastName:"",role:"sales_rep",message:""}),[p,g]=M.useState(""),[v,y]=M.useState("all"),[b,w]=M.useState("all"),[_,D]=M.useState(1),[j,N]=M.useState(10),S=Nr==null?void 0:Nr.getUserRoles(),E=async()=>{var k;try{a(!0),s("");let z=[];if(p)z=await(Nr==null?void 0:Nr.searchUsers(p));else{const K={};v!=="all"&&(K.status=v),b!=="all"&&(K.roles=[b]),((k=Object.keys(K))==null?void 0:k.length)>0?z=await(Nr==null?void 0:Nr.filterUsers(K)):z=await(Nr==null?void 0:Nr.getAllUsers())}const q=z==null?void 0:z.map(K=>{var se,ie,ee;return{id:K==null?void 0:K.id,name:(K==null?void 0:K.full_name)||((se=`${K==null?void 0:K.first_name} ${K==null?void 0:K.last_name}`)==null?void 0:se.trim()),email:K==null?void 0:K.email,role:((ie=S==null?void 0:S.find(ae=>(ae==null?void 0:ae.value)===(K==null?void 0:K.role)))==null?void 0:ie.label)||(K==null?void 0:K.role),status:K!=null&&K.is_active?"Active":"Inactive",lastLogin:K!=null&&K.updated_at?(ee=new Date(K==null?void 0:K.updated_at))==null?void 0:ee.toLocaleString():"Never",avatar:K==null?void 0:K.avatar_url,rawData:K}});r(q)}catch(z){console.error("Error loading users:",z),s("Failed to load users. Please try again.")}finally{a(!1)}};M.useEffect(()=>{e&&["admin","sales_manager"].includes(e==null?void 0:e.role)&&E()},[e,p,v,b]),M.useEffect(()=>{D(1)},[p,v,b,j]),M.useEffect(()=>{if(i||l){const k=setTimeout(()=>{s(""),c("")},5e3);return()=>clearTimeout(k)}},[i,l]);const A=k=>{d(z=>z!=null&&z.includes(k)?z==null?void 0:z.filter(q=>q!==k):[...z,k])},T=()=>{d((u==null?void 0:u.length)===(t==null?void 0:t.length)?[]:t==null?void 0:t.map(k=>k==null?void 0:k.id))},L=async k=>{var z;try{s("");let q=u;if(k==="deactivate"){const se=((z=t==null?void 0:t.filter(ie=>{var ee;return((ee=ie==null?void 0:ie.rawData)==null?void 0:ee.role)==="admin"||(ie==null?void 0:ie.id)===(e==null?void 0:e.id)}))==null?void 0:z.map(ie=>ie==null?void 0:ie.id))||[];if(q=u.filter(ie=>!se.includes(ie)),q.length===0){s("Cannot deactivate administrator accounts or your own account");return}q.length<u.length&&c(`Deactivated ${q.length} user(s). Administrator accounts and your account were skipped.`)}let K={};switch(k){case"activate":K={is_active:!0};break;case"deactivate":K={is_active:!1};break}await(Nr==null?void 0:Nr.bulkUpdateUsers(q,K)),(k==="activate"||q.length===u.length)&&c(`Successfully ${k}d ${q.length} user(s)`),d([]),E()}catch(q){console.error(`Error ${k}ing users:`,q),s(`Failed to ${k} users. Please try again.`)}},O=async k=>{k==null||k.preventDefault();try{s("");const z={email:m.email,first_name:m.firstName,last_name:m.lastName,role:m.role};await(Nr==null?void 0:Nr.inviteUser(z)),c("User invitation sent successfully!"),h(!1),x({email:"",firstName:"",lastName:"",role:"sales_rep",message:""}),E()}catch(z){console.error("Error inviting user:",z),s("Failed to send invitation. Please try again.")}},V=async(k,z)=>{try{switch(s(""),k){case"activate":await(Nr==null?void 0:Nr.reactivateUser(z)),c("User activated successfully");break;case"deactivate":await(Nr==null?void 0:Nr.deactivateUser(z)),c("User deactivated successfully");break}E()}catch(q){console.error(`Error ${k}ing user:`,q),s(`Failed to ${k} user. Please try again.`)}},W=Math.ceil((t==null?void 0:t.length)/j),B=(_-1)*j,P=B+j,F=t==null?void 0:t.slice(B,P),I=k=>{D(k)},R=k=>{var z;N(Number((z=k==null?void 0:k.target)==null?void 0:z.value))},C=k=>{const z={Active:"bg-success-50 text-success-600 border-success-100",Inactive:"bg-error-50 text-error-600 border-error-100",Pending:"bg-warning-50 text-warning-600 border-warning-100"};return o.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded border ${(z==null?void 0:z[k])||"bg-gray-50 text-gray-600 border-gray-100"}`,children:k})};return n&&!e?o.jsx("div",{className:"space-y-6",children:o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Y,{name:"Loader",size:48,className:"text-text-tertiary mx-auto mb-4 animate-spin"}),o.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"Loading..."}),o.jsx("p",{className:"text-text-secondary",children:"Please wait while we load your profile."})]})}):!e||(e==null?void 0:e.role)!=="admin"?o.jsx("div",{className:"space-y-6",children:o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Y,{name:"Lock",size:48,className:"text-text-tertiary mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"Access Restricted"}),o.jsx("p",{className:"text-text-secondary",children:"Only administrators can access user management."})]})}):o.jsxs("div",{className:"space-y-4 xs:space-y-6",children:[o.jsxs("div",{className:"flex flex-col xs:flex-row items-start xs:items-center justify-between gap-3 xs:gap-4",children:[o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("h2",{className:"text-xl xs:text-2xl font-bold text-text-primary truncate",children:"User Management"}),o.jsx("p",{className:"text-xs xs:text-sm text-text-secondary mt-1 hidden sm:block",children:"Manage users, roles, and permissions"})]}),o.jsxs("button",{onClick:()=>h(!0),className:"bg-primary text-white px-3 xs:px-4 py-2 min-h-touch rounded-lg hover:bg-primary-600 transition-colors duration-150 ease-smooth flex items-center space-x-1.5 xs:space-x-2 text-sm xs:text-base whitespace-nowrap flex-shrink-0",children:[o.jsx(Y,{name:"UserPlus",size:16}),o.jsx("span",{className:"hidden xs:inline",children:"Invite User"}),o.jsx("span",{className:"xs:hidden",children:"Invite"})]})]}),l&&o.jsxs("div",{className:"bg-success-50 border border-success-200 text-success p-4 rounded-lg flex items-center space-x-2",children:[o.jsx(Y,{name:"CheckCircle",size:20}),o.jsx("span",{children:l}),o.jsx("button",{onClick:()=>c(""),className:"ml-auto text-success hover:text-success-600",children:o.jsx(Y,{name:"X",size:16})})]}),i&&o.jsxs("div",{className:"bg-error-50 border border-error-200 text-error p-4 rounded-lg flex items-center space-x-2",children:[o.jsx(Y,{name:"AlertCircle",size:20}),o.jsx("span",{children:i}),o.jsx("button",{onClick:()=>s(""),className:"ml-auto text-error hover:text-error-600",children:o.jsx(Y,{name:"X",size:16})})]}),o.jsxs("div",{className:"flex flex-col gap-3 xs:gap-4",children:[o.jsxs("div",{className:"flex flex-col xs:flex-row gap-2 xs:gap-3",children:[o.jsxs("div",{className:"relative flex-1 xs:flex-initial",children:[o.jsx(Y,{name:"Search",size:16,className:"absolute left-2.5 xs:left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary"}),o.jsx("input",{type:"text",placeholder:"Search users...",value:p,onChange:k=>{var z;return g((z=k==null?void 0:k.target)==null?void 0:z.value)},className:"pl-8 xs:pl-10 pr-3 xs:pr-4 py-2 min-h-touch border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary w-full xs:w-64 text-sm xs:text-base"})]}),o.jsxs("select",{value:v,onChange:k=>{var z;return y((z=k==null?void 0:k.target)==null?void 0:z.value)},className:"px-3 py-2 min-h-touch border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary text-sm xs:text-base flex-1 xs:flex-initial",children:[o.jsx("option",{value:"all",children:"All Status"}),o.jsx("option",{value:"active",children:"Active"}),o.jsx("option",{value:"inactive",children:"Inactive"})]}),o.jsxs("select",{value:b,onChange:k=>{var z;return w((z=k==null?void 0:k.target)==null?void 0:z.value)},className:"px-3 py-2 min-h-touch border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary text-sm xs:text-base flex-1 xs:flex-initial",children:[o.jsx("option",{value:"all",children:"All Roles"}),S==null?void 0:S.map(k=>o.jsx("option",{value:k==null?void 0:k.value,children:k==null?void 0:k.label},k==null?void 0:k.value))]})]}),o.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[o.jsx("label",{className:"text-xs xs:text-sm text-text-secondary whitespace-nowrap",children:"Items per page:"}),o.jsxs("select",{value:j,onChange:R,className:"px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:[o.jsx("option",{value:5,children:"5"}),o.jsx("option",{value:10,children:"10"}),o.jsx("option",{value:25,children:"25"}),o.jsx("option",{value:50,children:"50"}),o.jsx("option",{value:100,children:"100"})]})]})]}),(u==null?void 0:u.length)>0&&o.jsx("div",{className:"bg-primary-50 border border-primary-100 rounded-lg p-3 xs:p-4",children:o.jsxs("div",{className:"flex flex-col xs:flex-row items-start xs:items-center justify-between gap-2 xs:gap-0",children:[o.jsxs("span",{className:"text-xs xs:text-sm text-primary font-medium",children:[u==null?void 0:u.length," user",(u==null?void 0:u.length)!==1?"s":""," selected"]}),o.jsxs("div",{className:"flex space-x-2 w-full xs:w-auto",children:[o.jsx("button",{onClick:()=>L("activate"),className:"px-3 py-2 min-h-touch text-xs xs:text-sm bg-success text-white rounded hover:bg-success-600 transition-colors duration-150 flex-1 xs:flex-initial",children:"Activate"}),o.jsx("button",{onClick:()=>L("deactivate"),className:"px-3 py-2 min-h-touch text-xs xs:text-sm bg-error text-white rounded hover:bg-error-600 transition-colors duration-150 flex-1 xs:flex-initial",children:"Deactivate"})]})]})}),n?o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),o.jsx("span",{className:"text-text-secondary",children:"Loading users..."})]})}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"hidden md:block bg-surface rounded-lg border border-border overflow-hidden",children:[o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-background border-b border-border",children:o.jsxs("tr",{children:[o.jsx("th",{className:"text-left py-3 px-4",children:o.jsx("input",{type:"checkbox",checked:(u==null?void 0:u.length)===(t==null?void 0:t.length)&&(t==null?void 0:t.length)>0,onChange:T,className:"rounded border-border text-primary focus:ring-primary"})}),o.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-primary",children:"User"}),o.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-primary",children:"Role"}),o.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-primary",children:"Status"}),o.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-primary",children:"Last Login"}),o.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-primary",children:"Actions"})]})}),o.jsx("tbody",{children:(F==null?void 0:F.length)===0?o.jsx("tr",{children:o.jsxs("td",{colSpan:"6",className:"py-8 text-center",children:[o.jsx(Y,{name:"Users",size:48,className:"text-text-tertiary mx-auto mb-4"}),o.jsx("p",{className:"text-text-secondary",children:"No users found"})]})}):F==null?void 0:F.map(k=>{var q,K;const z=((q=k==null?void 0:k.rawData)==null?void 0:q.role)==="admin"||(k==null?void 0:k.id)===(e==null?void 0:e.id);return o.jsxs("tr",{className:"border-b border-border hover:bg-surface-hover",children:[o.jsx("td",{className:"py-3 px-4",children:o.jsx("input",{type:"checkbox",checked:u==null?void 0:u.includes(k==null?void 0:k.id),onChange:()=>A(k==null?void 0:k.id),disabled:z,className:"rounded border-border text-primary focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed",title:z?"Protected account cannot be bulk-modified":""})}),o.jsx("td",{className:"py-3 px-4",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center",children:k!=null&&k.avatar?o.jsx("img",{src:k==null?void 0:k.avatar,alt:k==null?void 0:k.name,className:"w-8 h-8 rounded-full"}):o.jsx(Y,{name:"User",size:16,className:"text-primary"})}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-text-primary",children:(k==null?void 0:k.name)||"Unnamed User"}),o.jsx("div",{className:"text-sm text-text-secondary",children:k==null?void 0:k.email})]})]})}),o.jsx("td",{className:"py-3 px-4 text-sm text-text-secondary",children:k==null?void 0:k.role}),o.jsx("td",{className:"py-3 px-4",children:C(k==null?void 0:k.status)}),o.jsx("td",{className:"py-3 px-4 text-sm text-text-secondary",children:k==null?void 0:k.lastLogin}),o.jsx("td",{className:"py-3 px-4",children:o.jsx("div",{className:"flex space-x-2",children:((K=k==null?void 0:k.rawData)==null?void 0:K.role)==="admin"||(k==null?void 0:k.id)===(e==null?void 0:e.id)?o.jsx("span",{className:"text-xs text-text-tertiary px-2 py-1",children:(k==null?void 0:k.id)===(e==null?void 0:e.id)?"Current User":"Protected"}):o.jsx(o.Fragment,{children:(k==null?void 0:k.status)==="Active"?o.jsx("button",{onClick:()=>V("deactivate",k==null?void 0:k.id),className:"p-1 text-text-secondary hover:text-error transition-colors duration-150",title:"Deactivate User",children:o.jsx(Y,{name:"UserX",size:16})}):o.jsx("button",{onClick:()=>V("activate",k==null?void 0:k.id),className:"p-1 text-text-secondary hover:text-success transition-colors duration-150",title:"Activate User",children:o.jsx(Y,{name:"UserCheck",size:16})})})})})]},k==null?void 0:k.id)})})]})}),(t==null?void 0:t.length)>0&&o.jsx(Im,{currentPage:_,totalPages:W,totalItems:t==null?void 0:t.length,itemsPerPage:j,onPageChange:I,showInfo:!0})]}),o.jsxs("div",{className:"md:hidden space-y-3",children:[(F==null?void 0:F.length)===0?o.jsxs("div",{className:"bg-surface rounded-lg border border-border p-8 text-center",children:[o.jsx(Y,{name:"Users",size:48,className:"text-text-tertiary mx-auto mb-4"}),o.jsx("p",{className:"text-text-secondary",children:"No users found"})]}):F==null?void 0:F.map(k=>{var q;const z=((q=k==null?void 0:k.rawData)==null?void 0:q.role)==="admin"||(k==null?void 0:k.id)===(e==null?void 0:e.id);return o.jsxs("div",{className:"bg-surface rounded-lg border border-border p-4",children:[o.jsx("div",{className:"flex items-start justify-between mb-3",children:o.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[o.jsx("input",{type:"checkbox",checked:u==null?void 0:u.includes(k==null?void 0:k.id),onChange:()=>A(k==null?void 0:k.id),disabled:z,className:"rounded border-border text-primary focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed mt-1 flex-shrink-0",title:z?"Protected account":""}),o.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center flex-shrink-0",children:k!=null&&k.avatar?o.jsx("img",{src:k==null?void 0:k.avatar,alt:k==null?void 0:k.name,className:"w-10 h-10 rounded-full"}):o.jsx(Y,{name:"User",size:18,className:"text-primary"})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("div",{className:"font-medium text-text-primary text-sm truncate",children:(k==null?void 0:k.name)||"Unnamed User"}),o.jsx("div",{className:"text-xs text-text-secondary truncate",children:k==null?void 0:k.email})]})]})}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Role:"}),o.jsx("span",{className:"text-text-primary font-medium",children:k==null?void 0:k.role})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Status:"}),C(k==null?void 0:k.status)]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Last Login:"}),o.jsx("span",{className:"text-text-primary text-xs truncate ml-2",children:k==null?void 0:k.lastLogin})]})]}),o.jsx("div",{className:"mt-3 pt-3 border-t border-border flex justify-end",children:z?o.jsx("span",{className:"text-xs text-text-tertiary px-2 py-1",children:(k==null?void 0:k.id)===(e==null?void 0:e.id)?"Current User":"Protected"}):o.jsx(o.Fragment,{children:(k==null?void 0:k.status)==="Active"?o.jsxs("button",{onClick:()=>V("deactivate",k==null?void 0:k.id),className:"px-3 py-2 min-h-touch text-xs bg-error text-white rounded hover:bg-error-600 transition-colors duration-150 flex items-center space-x-1",children:[o.jsx(Y,{name:"UserX",size:14}),o.jsx("span",{children:"Deactivate"})]}):o.jsxs("button",{onClick:()=>V("activate",k==null?void 0:k.id),className:"px-3 py-2 min-h-touch text-xs bg-success text-white rounded hover:bg-success-600 transition-colors duration-150 flex items-center space-x-1",children:[o.jsx(Y,{name:"UserCheck",size:14}),o.jsx("span",{children:"Activate"})]})})})]},k==null?void 0:k.id)}),(t==null?void 0:t.length)>0&&o.jsx(Im,{currentPage:_,totalPages:W,totalItems:t==null?void 0:t.length,itemsPerPage:j,onPageChange:I,showInfo:!0})]})]}),f&&o.jsx("div",{className:"fixed inset-0 z-1200 overflow-y-auto",children:o.jsxs("div",{className:"flex items-center justify-center min-h-screen px-3 xs:px-4",children:[o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:()=>h(!1)}),o.jsx("div",{className:"bg-surface rounded-lg shadow-xl max-w-md w-full relative z-1300 my-6",children:o.jsxs("div",{className:"p-4 xs:p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-base xs:text-lg font-semibold text-text-primary",children:"Invite New User"}),o.jsx("button",{onClick:()=>h(!1),className:"text-text-secondary hover:text-text-primary transition-colors duration-150 p-1 min-h-touch min-w-touch flex items-center justify-center -m-1","aria-label":"Close modal",children:o.jsx(Y,{name:"X",size:20})})]}),o.jsxs("form",{onSubmit:O,className:"space-y-3 xs:space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Email Address"}),o.jsx("input",{type:"email",value:m==null?void 0:m.email,onChange:k=>x(z=>{var q;return{...z,email:(q=k==null?void 0:k.target)==null?void 0:q.value}}),className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",placeholder:"user@company.com",required:!0})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"First Name"}),o.jsx("input",{type:"text",value:m==null?void 0:m.firstName,onChange:k=>x(z=>{var q;return{...z,firstName:(q=k==null?void 0:k.target)==null?void 0:q.value}}),className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",placeholder:"John"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Last Name"}),o.jsx("input",{type:"text",value:m==null?void 0:m.lastName,onChange:k=>x(z=>{var q;return{...z,lastName:(q=k==null?void 0:k.target)==null?void 0:q.value}}),className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",placeholder:"Doe"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Role"}),o.jsxs("select",{value:m==null?void 0:m.role,onChange:k=>x(z=>{var q;return{...z,role:(q=k==null?void 0:k.target)==null?void 0:q.value}}),className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",required:!0,children:[o.jsx("option",{value:"",children:"Select Role"}),S==null?void 0:S.map(k=>o.jsx("option",{value:k==null?void 0:k.value,children:k==null?void 0:k.label},k==null?void 0:k.value))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Welcome Message (Optional)"}),o.jsx("textarea",{value:m==null?void 0:m.message,onChange:k=>x(z=>{var q;return{...z,message:(q=k==null?void 0:k.target)==null?void 0:q.value}}),className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",rows:3,placeholder:"Welcome to our team..."})]}),o.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[o.jsx("button",{type:"button",onClick:()=>h(!1),className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors duration-150",children:"Cancel"}),o.jsx("button",{type:"submit",className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors duration-150 ease-smooth",children:"Send Invitation"})]})]})]})})]})})]})}catch(e){return console.error("Error in UserManagement component:",e),o.jsx("div",{className:"space-y-6",children:o.jsxs("div",{className:"text-center py-12",children:[o.jsx(Y,{name:"AlertCircle",size:48,className:"text-error mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"Something went wrong"}),o.jsx("p",{className:"text-text-secondary",children:"Please refresh the page and try again."})]})})}},yh={async getAllRoles(){const{data:e,error:t}=await be.get("/api/v1/roles");if(t)throw t;return e||[]},async getAllPermissions(){const{data:e,error:t}=await be.get("/api/v1/roles/permissions/all");if(t)throw t;return e||[]},async getRoleById(e){const{data:t,error:r}=await be.get(`/api/v1/roles/${e}`);if(r){if(r.status===404)return null;throw r}return t},async updateRolePermissions(e,t){const{data:r,error:n}=await be.put(`/api/v1/roles/${e}/permissions`,{role_id:e,permissions:t});if(n)throw n;return r},async getRolePermissions(e){const{data:t,error:r}=await be.get(`/api/v1/roles/by-name/${encodeURIComponent(e)}/permissions`);return r?{}:t||{}},async updateRolePermissionsByName(e,t){const r={role_name:e,permissions:t},{data:n,error:a}=await be.put(`/api/v1/roles/by-name/${encodeURIComponent(e)}/permissions`,r);if(a)throw a;return n},async restoreDefaultPermissions(e){const{data:t,error:r}=await be.post(`/api/v1/roles/by-name/${encodeURIComponent(e)}/restore-defaults`);if(r)throw r;return t}},IZe=()=>{const{refreshPermissions:e}=Vt(),[t,r]=M.useState("Admin"),[n,a]=M.useState([]),[i,s]=M.useState(!0),[l,c]=M.useState(""),[u,d]=M.useState(""),f=[{category:"Dashboard & Analytics",items:[{name:"View Dashboard Statistics",key:"dashboard.view_stats"},{name:"Filter Dashboard Data",key:"dashboard.filter"},{name:"Drag & Drop Pipeline",key:"dashboard.pipeline_drag_drop"},{name:"View Pipeline",key:"dashboard.pipeline_view"},{name:"View Personal Analytics",key:"analytics.view_personal"},{name:"View Team Analytics",key:"analytics.view_team"},{name:"View Company Analytics",key:"analytics.view_company"},{name:"Export Analytics Reports",key:"analytics.export"}]},{category:"Deal Management",items:[{name:"View All Deals",key:"deals.view_all"},{name:"View Own Deals",key:"deals.view_own"},{name:"Create Deals",key:"deals.create"},{name:"Edit All Deals",key:"deals.edit_all"},{name:"Edit Own Deals",key:"deals.edit_own"},{name:"Delete All Deals",key:"deals.delete_all"},{name:"Delete Own Deals",key:"deals.delete_own"},{name:"Move Pipeline Stages",key:"deals.move_stages"},{name:"Export Deals",key:"deals.export"}]},{category:"Contact Management",items:[{name:"View All Contacts",key:"contacts.view_all"},{name:"View Own Contacts",key:"contacts.view_own"},{name:"Create Contacts",key:"contacts.create"},{name:"Edit All Contacts",key:"contacts.edit_all"},{name:"Edit Own Contacts",key:"contacts.edit_own"},{name:"Delete All Contacts",key:"contacts.delete_all"},{name:"Delete Own Contacts",key:"contacts.delete_own"},{name:"Import Contacts",key:"contacts.import"},{name:"Export Contacts",key:"contacts.export"}]},{category:"Company Management",items:[{name:"View All Companies",key:"companies.view_all"},{name:"View Own Companies",key:"companies.view_own"},{name:"Create Companies",key:"companies.create"},{name:"Edit All Companies",key:"companies.edit_all"},{name:"Edit Own Companies",key:"companies.edit_own"},{name:"Delete All Companies",key:"companies.delete_all"},{name:"Delete Own Companies",key:"companies.delete_own"},{name:"Import/Export Companies",key:"companies.import_export"}]},{category:"Activity Management",items:[{name:"View All Activities",key:"activities.view_all"},{name:"View Own Activities",key:"activities.view_own"},{name:"Create Activity for Any Contact",key:"activities.create_all"},{name:"Create Activity for Own Contacts",key:"activities.create_own"},{name:"Edit All Activities",key:"activities.edit_all"},{name:"Edit Own Activities",key:"activities.edit_own"},{name:"Delete All Activities",key:"activities.delete_all"},{name:"Delete Own Activities",key:"activities.delete_own"},{name:"Export Activities",key:"activities.export"}]},{category:"Campaign Management",items:[{name:"View All Campaigns",key:"campaigns.view_all"},{name:"View Own Campaigns",key:"campaigns.view_own"},{name:"Create Campaigns",key:"campaigns.create"},{name:"Edit All Campaigns",key:"campaigns.edit_all"},{name:"Edit Own Campaigns",key:"campaigns.edit_own"},{name:"Delete All Campaigns",key:"campaigns.delete_all"},{name:"Delete Own Campaigns",key:"campaigns.delete_own"},{name:"Execute Campaigns",key:"campaigns.execute"},{name:"Export Campaign Data",key:"campaigns.export"}]},{category:"Settings & Configuration",items:[{name:"User Management",key:"settings.user_management"},{name:"Manage Permissions",key:"settings.permissions"},{name:"Manage Integrations",key:"settings.integrations"},{name:"Manage Custom Fields",key:"settings.custom_fields"},{name:"Manage Email Templates",key:"settings.email_templates"},{name:"System Configuration",key:"settings.system_config"},{name:"View Own Profile",key:"settings.view_profile"},{name:"Edit Own Profile",key:"settings.edit_profile"}]}],[h,m]=M.useState({}),x=async()=>{try{s(!0),c("");const[w,_]=await Promise.all([yh.getAllRoles(),yh.getAllPermissions()]),D=w.filter(N=>N.name!=="sales_operations").map(N=>({name:N.display_name,userCount:0}));a(D);const j={};for(const N of w)try{const S=await yh.getRolePermissions(N.name);j[N.display_name]=S}catch(S){console.warn(`Failed to load permissions for role ${N.name}:`,S),j[N.display_name]={}}m(j),D.length>0&&!t&&r(D[0].name)}catch(w){console.error("Error loading permissions data:",w),c("Failed to load permissions data. Please try again."),a([{name:"Admin",userCount:0},{name:"Sales Manager",userCount:0},{name:"Sales Rep",userCount:0},{name:"Sales Operations",userCount:0}])}finally{s(!1)}};M.useEffect(()=>{x()},[]);const p=w=>{m(_=>{var D;return{..._,[t]:{..._==null?void 0:_[t],[w]:!((D=_==null?void 0:_[t])!=null&&D[w])}}})},g=async()=>{try{c(""),d("");const w=h[t]||{},_=await yh.updateRolePermissionsByName(t,w);d(`Permissions updated successfully for ${t}! Users with this role will need to log out and log back in to see the changes.`),await x(),setTimeout(()=>d(""),5e3)}catch(w){console.error("Error saving permission changes:",w),c("Failed to save permission changes. Please try again."),setTimeout(()=>c(""),5e3)}},v=async()=>{if(confirm(`Are you sure you want to restore default permissions for ${t}? This will overwrite all custom changes.`))try{c(""),d("");const w=await yh.restoreDefaultPermissions(t);d(`Default permissions restored for ${t}!`),await x(),setTimeout(()=>d(""),3e3)}catch(w){console.error("Error restoring default permissions:",w),c("Failed to restore default permissions. Please try again."),setTimeout(()=>c(""),5e3)}},y=async()=>{try{c(""),d(""),await e(),Ue.success("Permissions refreshed successfully!"),d("Your permissions have been refreshed. The page will reload to apply changes."),setTimeout(()=>{window.location.reload()},1500)}catch(w){console.error("Error refreshing permissions:",w),c("Failed to refresh permissions. Please try again."),Ue.error("Failed to refresh permissions. Please try again."),setTimeout(()=>c(""),5e3)}},b=w=>{var D,j;const _=(h==null?void 0:h[w])||{};return(j=(D=Object.values(_))==null?void 0:D.filter(Boolean))==null?void 0:j.length};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"Permissions"}),o.jsx("p",{className:"text-text-secondary mt-1",children:"Configure role-based access control"})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("button",{onClick:y,className:"bg-surface border border-border text-text-secondary px-4 py-2 rounded-lg hover:bg-surface-hover transition-colors duration-150 ease-smooth flex items-center space-x-2",title:"Refresh your current permissions",children:[o.jsx(Y,{name:"RefreshCw",size:16}),o.jsx("span",{children:"Refresh Permissions"})]}),o.jsxs("button",{onClick:v,className:"bg-surface border border-border text-text-secondary px-4 py-2 rounded-lg hover:bg-surface-hover transition-colors duration-150 ease-smooth flex items-center space-x-2",children:[o.jsx(Y,{name:"RotateCcw",size:16}),o.jsx("span",{children:"Restore to Default"})]}),o.jsxs("button",{onClick:g,className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors duration-150 ease-smooth flex items-center space-x-2",children:[o.jsx(Y,{name:"Save",size:16}),o.jsx("span",{children:"Save Changes"})]})]})]}),o.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx(Y,{name:"Info",size:20,className:"text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5"}),o.jsxs("div",{className:"text-sm text-blue-800 dark:text-blue-200",children:[o.jsx("p",{className:"font-medium mb-1",children:"Important: Permission Changes Require Re-login"}),o.jsxs("p",{children:["After updating role permissions, users with that role must ",o.jsx("strong",{children:"log out and log back in"})," to see the new permissions take effect."]})]})]})}),u&&o.jsx("div",{className:"bg-success-50 border border-success-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Y,{name:"CheckCircle",size:20,className:"text-success-600"}),o.jsx("div",{className:"text-success-800",children:u})]})}),l&&o.jsx("div",{className:"bg-error-50 border border-error-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Y,{name:"AlertCircle",size:20,className:"text-error-600"}),o.jsx("div",{className:"text-error-800",children:l})]})}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[o.jsx("div",{className:"lg:col-span-4",children:o.jsxs("div",{className:"bg-surface rounded-lg border border-border p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Roles"}),o.jsx("div",{className:"space-y-2",children:n==null?void 0:n.map(w=>o.jsx("button",{onClick:()=>r(w==null?void 0:w.name),className:`w-full text-left p-3 rounded-lg transition-all duration-150 ease-smooth ${t===(w==null?void 0:w.name)?"bg-primary-50 border border-primary-100 text-primary":"text-text-secondary hover:text-text-primary hover:bg-surface-hover border border-transparent"}`,children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:`font-medium text-sm ${t===(w==null?void 0:w.name)?"text-primary":"text-text-primary"}`,children:w==null?void 0:w.name}),o.jsxs("div",{className:"text-xs text-text-tertiary mt-1",children:[w==null?void 0:w.userCount," user",(w==null?void 0:w.userCount)!==1?"s":"","  ",b(w==null?void 0:w.name)," permissions"]})]}),t===(w==null?void 0:w.name)&&o.jsx(Y,{name:"Check",size:16,className:"text-primary"})]})},w==null?void 0:w.name))})]})}),o.jsx("div",{className:"lg:col-span-8",children:o.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[o.jsxs("div",{className:"p-6 border-b border-border",children:[o.jsxs("h3",{className:"text-lg font-semibold text-text-primary",children:["Permissions for ",t]}),o.jsx("p",{className:"text-text-secondary text-sm mt-1",children:"Configure what actions this role can perform"})]}),o.jsx("div",{className:"p-6 space-y-6",children:f==null?void 0:f.map(w=>{var _;return o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium text-text-primary mb-3 text-sm uppercase tracking-wide",children:w==null?void 0:w.category}),o.jsx("div",{className:"space-y-2 ml-4",children:(_=w==null?void 0:w.items)==null?void 0:_.map(D=>{var j;return o.jsxs("label",{className:"flex items-center space-x-3 p-2 rounded hover:bg-surface-hover cursor-pointer group",children:[o.jsx("input",{type:"checkbox",checked:((j=h==null?void 0:h[t])==null?void 0:j[D==null?void 0:D.key])||!1,onChange:()=>p(D==null?void 0:D.key),className:"rounded border-border text-primary focus:ring-primary"}),o.jsx("span",{className:"text-sm text-text-secondary group-hover:text-text-primary transition-colors duration-150",children:D==null?void 0:D.name})]},D==null?void 0:D.key)})})]},w==null?void 0:w.category)})})]})})]}),o.jsx("div",{className:"bg-background border border-border rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx(Y,{name:"Info",size:16,className:"text-primary mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:"font-medium text-text-primary text-sm",children:"Permission Guidelines"}),o.jsx("p",{className:"text-text-secondary text-sm mt-1",children:"Changes to permissions will take effect immediately for all users with the selected role. Users may need to refresh their browser to see updated access."})]})]})})]})},nl={async getUserIntegrations(){try{const{data:e,error:t}=await be.get("/api/v1/integrations");if(t)throw t;return e||[]}catch(e){throw e}},async getIntegration(e){try{const{data:t,error:r}=await be.get(`/api/v1/integrations/${e}`);if(r)throw r;return t}catch(t){throw t}},async createIntegration(e){try{const{data:t,error:r}=await be.post("/api/v1/integrations",e);if(r)throw r;return t}catch(t){throw t}},async updateIntegration(e,t){try{const{data:r,error:n}=await be.put(`/api/v1/integrations/${e}`,t);if(n)throw n;return r}catch(r){throw r}},async deleteIntegration(e){try{const{data:t,error:r}=await be.delete(`/api/v1/integrations/${e}`);if(r)throw r;return t}catch(t){throw t}},async getOAuthUrl(e){try{const t=await be.post(`/api/v1/integrations/oauth/url?provider=${e}`),{data:r,error:n}=t;if(n)throw n;return r.auth_url}catch(t){throw t}},async handleOAuthCallback(e,t,r=null){try{const{data:n,error:a}=await be.post("/api/v1/integrations/oauth/callback",{provider:e,code:t,state:r});if(a)throw a;return n}catch(n){throw n}},async testIntegration(e){try{const{data:t,error:r}=await be.post(`/api/v1/integrations/${e}/test`);if(r)throw r;return t}catch(t){throw t}},async syncIntegration(e,t=!1){try{const{data:r,error:n}=await be.post(`/api/v1/integrations/${e}/sync`,null,{params:{force:t}});if(n)throw n;return r}catch(r){throw r}},async disconnectIntegration(e){try{const{data:t,error:r}=await be.post(`/api/v1/integrations/${e}/disconnect`);if(r)throw r;return t}catch(t){throw t}},async getIntegrationLogs(e,t=50,r=0){try{const{data:n,error:a}=await be.get(`/api/v1/integrations/${e}/logs`,{params:{limit:t,offset:r}});if(a)throw a;return n||[]}catch(n){throw n}},async initiateOAuthFlow(e){try{const t=await this.getOAuthUrl(e);localStorage.setItem("oauth_provider",e),window.location.href=t}catch(t){throw t}},async handleOAuthCallbackFromUrl(){const e=new URLSearchParams(window.location.search),t=e.get("code"),r=e.get("state"),n=e.get("error");if(n)throw new Error(`OAuth error: ${n}`);if(!t)throw new Error("No authorization code received");let a=localStorage.getItem("oauth_provider");if(r&&r.includes(":")){const[i,s]=r.split(":");a=s}if(!a)throw new Error("No provider information available");try{const i=await this.handleOAuthCallback(a,t,r);return localStorage.removeItem("oauth_provider"),i}catch(i){throw localStorage.removeItem("oauth_provider"),i}},getStatusBadge(e){const t={connected:{color:"bg-green-100 text-green-800",icon:"CheckCircle",text:"Connected"},disconnected:{color:"bg-gray-100 text-gray-800",icon:"XCircle",text:"Disconnected"},error:{color:"bg-red-100 text-red-800",icon:"AlertCircle",text:"Error"},syncing:{color:"bg-blue-100 text-blue-800",icon:"RefreshCw",text:"Syncing"}};return t[e]||t.disconnected},getProviderConfig(e){return{gmail:{name:"Gmail",description:"Sync emails and contacts with Gmail",icon:"Mail",color:"text-red-600",features:["Email sync","Contact sync","Email templates","Auto-logging"]},google_calendar:{name:"Google Calendar",description:"Schedule meetings and sync calendar events",icon:"Calendar",color:"text-blue-600",features:["Meeting scheduling","Event sync","Activity tracking","Reminders"]},outlook_calendar:{name:"Microsoft Outlook Calendar",description:"Two-way calendar sync with Outlook",icon:"Calendar",color:"text-blue-500",features:["Two-way sync","Meeting scheduling","Teams meetings","Activity tracking"]}}[e]||{name:e,description:`Integration with ${e}`,icon:"Settings",color:"text-gray-600",features:[]}},async getOutlookCalendarAuthUrl(){try{const{data:e,error:t}=await be.get("/api/v1/calendar-integration/outlook-calendar/connect");if(t)throw t;return e}catch(e){throw e}},async getOutlookCalendarStatus(){try{const{data:e,error:t}=await be.get("/api/v1/calendar-integration/outlook-calendar/status");if(t)throw t;return e}catch(e){throw e}},async syncOutlookCalendar(e=null,t=null){try{const r={};e&&(r.start_date=e),t&&(r.end_date=t);const{data:n,error:a}=await be.post("/api/v1/calendar-integration/outlook-calendar/sync",null,{params:r});if(a)throw a;return n}catch(r){throw r}},async disconnectOutlookCalendar(e){try{const{data:t,error:r}=await be.delete(`/api/v1/calendar-integration/outlook-calendar/${e}`);if(r)throw r;return t}catch(t){throw t}},async connectOutlookCalendar(){try{const{auth_url:e,state:t}=await this.getOutlookCalendarAuthUrl(),r=window.open(e,"outlook-calendar-auth","width=500,height=700,left=100,top=100");if(!r)throw new Error("Popup was blocked. Please allow popups for this site.");return new Promise((n,a)=>{let i=!1;const s=u=>{u.data&&u.data.type==="outlook-calendar-connected"&&(i=!0,window.removeEventListener("message",s),clearInterval(l),clearTimeout(c),u.data.success?n({success:!0}):a(new Error(u.data.error||"Connection failed")))};window.addEventListener("message",s);const l=setInterval(async()=>{if(r.closed&&(clearInterval(l),clearTimeout(c),window.removeEventListener("message",s),!i))try{await new Promise(d=>setTimeout(d,1500));const u=await this.getOutlookCalendarStatus();u&&u.connected?n({success:!0}):a(new Error("User closed the popup or authentication failed"))}catch{a(new Error("Connection verification failed"))}},500),c=setTimeout(()=>{window.removeEventListener("message",s),clearInterval(l),r.closed||r.close(),a(new Error("OAuth flow timed out after 5 minutes"))},3e5)})}catch(e){throw e}}},RZe=()=>{const[e]=Cp(),[t,r]=M.useState([]),[n,a]=M.useState(!0),[i,s]=M.useState(null),[l,c]=M.useState(null),[u,d]=M.useState({}),[f,h]=M.useState({}),[m,x]=M.useState(null),[p,g]=M.useState(null),[v,y]=M.useState(!1),b=[{id:"outlook_calendar",name:"Microsoft Outlook Calendar",description:"Two-way calendar sync with Outlook",icon:"Calendar",color:"text-blue-500",features:["Calendar sync","Teams meetings","Activity tracking","Two-way sync"]}];M.useEffect(()=>{w();const O=e.get("code"),V=e.get("error");O?_():V&&(Ue.error(`OAuth error: ${V}`),window.history.replaceState({},document.title,window.location.pathname))},[e]);const w=async()=>{try{a(!0);const O=await nl.getUserIntegrations();r(O),s(null)}catch(O){console.error("Error loading integrations:",O),s("Failed to load integrations"),Ue.error("Failed to load integrations")}finally{a(!1)}},_=async()=>{try{const O=await nl.handleOAuthCallbackFromUrl();Ue.success(`Successfully connected ${O.provider||"integration"}!`),await w(),window.history.replaceState({},document.title,window.location.pathname)}catch(O){console.error(" OAuth callback error:",O),Ue.error(`Failed to connect: ${O.message}`),window.history.replaceState({},document.title,window.location.pathname)}},D=O=>{const V={connected:{bg:"bg-success-50",text:"text-success-600",border:"border-success-100",label:"Connected"},disconnected:{bg:"bg-error-50",text:"text-error-600",border:"border-error-100",label:"Disconnected"},error:{bg:"bg-warning-50",text:"text-warning-600",border:"border-warning-100",label:"Error"}},W=(V==null?void 0:V[O])||(V==null?void 0:V.disconnected);return o.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded border ${W==null?void 0:W.bg} ${W==null?void 0:W.text} ${W==null?void 0:W.border}`,children:W==null?void 0:W.label})},j=O=>{const V={connected:{name:"CheckCircle",color:"text-success"},disconnected:{name:"XCircle",color:"text-error"},error:{name:"AlertCircle",color:"text-warning"}},W=(V==null?void 0:V[O])||(V==null?void 0:V.disconnected);return o.jsx(Y,{name:W==null?void 0:W.name,size:20,className:W==null?void 0:W.color})},N=async O=>{try{if(d(W=>({...W,[O]:!0})),O==="outlook_calendar"){try{const W=await nl.connectOutlookCalendar();Ue.success("Successfully connected Microsoft Outlook Calendar!"),await w()}catch(W){console.error(" Outlook Calendar connection error:",W),W.message!=="User closed the popup"&&Ue.error(`Failed to connect Outlook Calendar: ${W.message}`)}return}localStorage.setItem("oauth_provider",O);const V=await nl.getOAuthUrl(O);V?window.location.href=V:(console.error(" No OAuth URL received"),Ue.error("No OAuth URL received"))}catch(V){console.error(" Connection error:",V),Ue.error(`Failed to connect to ${O}: ${V.message||"Unknown error"}`)}finally{d(V=>({...V,[O]:!1}))}},S=async(O,V)=>{try{V==="outlook_calendar"?await nl.disconnectOutlookCalendar(O):await nl.disconnectIntegration(O),Ue.success("Integration disconnected successfully"),await w()}catch(W){console.error("Disconnect error:",W),Ue.error("Failed to disconnect integration")}},E=async O=>{try{h(W=>({...W,[O]:"testing"}));const V=await nl.testIntegration(O);h(W=>({...W,[O]:V.success?"success":"error"})),V.success?Ue.success("Integration test successful"):Ue.error(`Integration test failed: ${V.error||"Unknown error"}`)}catch(V){console.error("Test error:",V),h(W=>({...W,[O]:"error"})),Ue.error("Failed to test integration")}},A=async O=>{try{x(O),Ue.loading("Syncing Outlook Calendar...",{id:"calendar-sync"});const V=await nl.syncOutlookCalendar();V.success?(Ue.success(`Calendar synced! ${V.events_fetched||0} events fetched, ${V.created||0} created, ${V.updated||0} updated`,{id:"calendar-sync",duration:4e3}),await w()):Ue.error(`Sync failed: ${V.error||"Unknown error"}`,{id:"calendar-sync"})}catch(V){console.error("Calendar sync error:",V),Ue.error(`Failed to sync calendar: ${V.message}`,{id:"calendar-sync"})}finally{x(null)}},T=O=>{g(O),y(!0)},L=()=>{y(!1),g(null)};return o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"Integrations"}),o.jsx("p",{className:"text-text-secondary mt-1",children:"Connect your CRM with Google and Microsoft services"})]})}),n&&o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin"}),o.jsx("span",{className:"text-text-secondary",children:"Loading integrations..."})]})}),i&&o.jsxs("div",{className:"bg-error-50 border border-error-200 rounded-lg p-4",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:"AlertCircle",size:20,className:"text-error-600"}),o.jsx("span",{className:"text-error-600 font-medium",children:"Failed to load integrations"})]}),o.jsx("p",{className:"text-error-600 text-sm mt-1",children:i})]}),!n&&!i&&o.jsx(o.Fragment,{children:o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:b.map(O=>{const V=t.find(P=>P.provider===O.id&&P.status==="connected"),W=!!V,B=u[O.id];return o.jsxs("div",{className:"bg-surface rounded-lg border border-border p-6 hover:shadow-md transition-shadow duration-150",children:[o.jsxs("div",{className:"flex items-start justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:`w-10 h-10 ${W?"bg-success-50":"bg-primary-50"} rounded-lg flex items-center justify-center`,children:o.jsx(Y,{name:O.icon,size:20,className:W?"text-success":O.color})}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-text-primary",children:O.name}),o.jsx("p",{className:"text-sm text-text-secondary mt-1",children:O.description})]})]}),j(W?"connected":"disconnected")]}),o.jsxs("div",{className:"space-y-3 mb-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Status:"}),D(W?"connected":"disconnected")]}),(V==null?void 0:V.last_sync)&&o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Last Sync:"}),o.jsx("span",{className:"text-sm text-text-primary",children:new Date(V.last_sync).toLocaleDateString()})]}),(f==null?void 0:f[V==null?void 0:V.id])&&o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Test Result:"}),o.jsx("span",{className:`text-sm ${(f==null?void 0:f[V==null?void 0:V.id])==="testing"?"text-text-secondary":(f==null?void 0:f[V==null?void 0:V.id])==="success"?"text-success":"text-error"}`,children:(f==null?void 0:f[V==null?void 0:V.id])==="testing"?"Testing...":(f==null?void 0:f[V==null?void 0:V.id])==="success"?"Success":"Failed"})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Features:"}),o.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:O.features.map((P,F)=>o.jsx("span",{className:"text-xs px-2 py-1 bg-background rounded text-text-secondary",children:P},F))})]})]}),o.jsxs("div",{className:"space-y-2",children:[W?o.jsx(o.Fragment,{children:o.jsxs("div",{className:"flex space-x-2",children:[O.id==="outlook_calendar"?o.jsx("button",{onClick:()=>A(V.id),disabled:m===V.id,className:"flex-1 px-3 py-2 text-sm bg-background text-text-primary rounded hover:bg-surface-hover transition-colors duration-150 disabled:opacity-50 disabled:cursor-not-allowed",children:m===V.id?o.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[o.jsx("div",{className:"w-4 h-4 border-2 border-text-secondary border-t-transparent rounded-full animate-spin"}),o.jsx("span",{children:"Syncing..."})]}):"Sync Now"}):o.jsx("button",{onClick:()=>E(V.id),disabled:(f==null?void 0:f[V.id])==="testing",className:"flex-1 px-3 py-2 text-sm bg-background text-text-primary rounded hover:bg-surface-hover transition-colors duration-150 disabled:opacity-50 disabled:cursor-not-allowed",children:(f==null?void 0:f[V.id])==="testing"?o.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[o.jsx("div",{className:"w-4 h-4 border-2 border-text-secondary border-t-transparent rounded-full animate-spin"}),o.jsx("span",{children:"Testing"})]}):"Test Connection"}),o.jsx("button",{onClick:()=>T(V),className:"flex-1 px-3 py-2 text-sm bg-primary text-white rounded hover:bg-primary-600 transition-colors duration-150",children:"Configure"})]})}):o.jsx("button",{onClick:()=>N(O.id),disabled:B,className:"w-full px-3 py-2 text-sm bg-primary text-white rounded hover:bg-primary-600 transition-colors duration-150 disabled:opacity-50 disabled:cursor-not-allowed",children:B?o.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[o.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),o.jsx("span",{children:"Connecting..."})]}):"Connect"}),W&&o.jsx("button",{onClick:()=>S(V.id,O.id),className:"w-full px-3 py-2 text-sm text-error hover:bg-error-50 rounded transition-colors duration-150",children:"Disconnect"})]})]},O.id)})})}),v&&p&&o.jsx("div",{className:"fixed inset-0 z-1200 overflow-y-auto",children:o.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:()=>y(!1)}),o.jsx("div",{className:"bg-surface rounded-lg shadow-xl max-w-lg w-full relative z-1300",children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("h3",{className:"text-lg font-semibold text-text-primary",children:["Configure ",p==null?void 0:p.name]}),o.jsx("button",{onClick:()=>y(!1),className:"text-text-secondary hover:text-text-primary transition-colors duration-150",children:o.jsx(Y,{name:"X",size:20})})]}),o.jsxs("div",{className:"space-y-4",children:[(p==null?void 0:p.provider)==="gmail"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-sm font-medium text-text-primary",children:"Auto Sync"}),o.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded border-border text-primary focus:ring-primary"})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-sm font-medium text-text-primary",children:"Sync Contacts"}),o.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded border-border text-primary focus:ring-primary"})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-sm font-medium text-text-primary",children:"Sync Emails"}),o.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded border-border text-primary focus:ring-primary"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Sync Frequency"}),o.jsxs("select",{className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:[o.jsx("option",{value:"5",children:"Every 5 minutes"}),o.jsx("option",{value:"15",selected:!0,children:"Every 15 minutes"}),o.jsx("option",{value:"30",children:"Every 30 minutes"}),o.jsx("option",{value:"60",children:"Every hour"})]})]})]}),(p==null?void 0:p.provider)==="google_calendar"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-sm font-medium text-text-primary",children:"Auto Sync Events"}),o.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded border-border text-primary focus:ring-primary"})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-sm font-medium text-text-primary",children:"Create CRM Activities"}),o.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded border-border text-primary focus:ring-primary"})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-sm font-medium text-text-primary",children:"Sync Meeting Notes"}),o.jsx("input",{type:"checkbox",className:"rounded border-border text-primary focus:ring-primary"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Default Calendar"}),o.jsxs("select",{className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:[o.jsx("option",{value:"primary",children:"Primary Calendar"}),o.jsx("option",{value:"work",children:"Work Calendar"}),o.jsx("option",{value:"crm",children:"CRM Events"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Sync Frequency"}),o.jsxs("select",{className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:[o.jsx("option",{value:"5",children:"Every 5 minutes"}),o.jsx("option",{value:"15",selected:!0,children:"Every 15 minutes"}),o.jsx("option",{value:"30",children:"Every 30 minutes"}),o.jsx("option",{value:"60",children:"Every hour"})]})]})]}),(p==null?void 0:p.provider)==="outlook_calendar"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-sm font-medium text-text-primary",children:"Two-way Calendar Sync"}),o.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded border-border text-primary focus:ring-primary"})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-sm font-medium text-text-primary",children:"Create CRM Activities"}),o.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded border-border text-primary focus:ring-primary"})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-sm font-medium text-text-primary",children:"Enable Teams Meetings"}),o.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded border-border text-primary focus:ring-primary"})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-sm font-medium text-text-primary",children:"Sync Activity Notes"}),o.jsx("input",{type:"checkbox",className:"rounded border-border text-primary focus:ring-primary"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Sync Frequency"}),o.jsxs("select",{className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:[o.jsx("option",{value:"5",children:"Every 5 minutes"}),o.jsx("option",{value:"10",selected:!0,children:"Every 10 minutes"}),o.jsx("option",{value:"15",children:"Every 15 minutes"}),o.jsx("option",{value:"30",children:"Every 30 minutes"}),o.jsx("option",{value:"60",children:"Every hour"})]})]})]})]}),o.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[o.jsx("button",{onClick:()=>y(!1),className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors duration-150",children:"Cancel"}),o.jsx("button",{onClick:L,className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors duration-150 ease-smooth",children:"Save Configuration"})]})]})})]})}),o.jsx("div",{className:"bg-background border border-border rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx(Y,{name:"Zap",size:16,className:"text-primary mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:"font-medium text-text-primary text-sm",children:"Integration Health"}),o.jsxs("p",{className:"text-text-secondary text-sm mt-1",children:[t==null?void 0:t.length," of ",b==null?void 0:b.length," integrations are connected and working properly. Connect your Google services to enhance your CRM capabilities."]})]})]})})]})},MZe=()=>{var W,B;const[e,t]=M.useState([]),[r,n]=M.useState(!1),[a,i]=M.useState(null),[s,l]=M.useState(!1),[c,u]=M.useState(null),[d,f]=M.useState("all"),[h,m]=M.useState(1),[x,p]=M.useState(10),g=[{value:"text",label:"Text"},{value:"number",label:"Number"},{value:"select",label:"Select"},{value:"multi_select",label:"Multi Select"},{value:"date",label:"Date"},{value:"datetime",label:"Date & Time"},{value:"boolean",label:"Boolean"},{value:"email",label:"Email"},{value:"phone",label:"Phone"},{value:"url",label:"URL"},{value:"textarea",label:"Text Area"},{value:"currency",label:"Currency"},{value:"percentage",label:"Percentage"}],v=[{value:"contact",label:"Contact"},{value:"company",label:"Company"},{value:"deal",label:"Deal"},{value:"activity",label:"Activity"},{value:"task",label:"Task"}],y=[{value:"form",label:"Form Only"},{value:"detail_view",label:"Detail View Only"},{value:"both",label:"Both Form and Detail View"}],b=async()=>{l(!0),u(null);try{const P=await as.getAllFields();t(P||[])}catch(P){console.error("Failed to fetch custom fields:",P),u("Failed to load custom fields. Please try again."),t([])}finally{l(!1)}};M.useEffect(()=>{b()},[]);const w=({field:P,onSave:F,onCancel:I})=>{var ee;const[R,C]=M.useState({name:(P==null?void 0:P.name)||"",description:(P==null?void 0:P.description)||"",field_type:(P==null?void 0:P.field_type)||"text",entity_type:(P==null?void 0:P.entity_type)||"contact",is_required:(P==null?void 0:P.is_required)||!1,placement:(P==null?void 0:P.placement)||"both",field_config:(P==null?void 0:P.field_config)||{},help_text:(P==null?void 0:P.help_text)||"",placeholder:(P==null?void 0:P.placeholder)||""}),[k,z]=M.useState(((ee=P==null?void 0:P.field_config)==null?void 0:ee.options)||[{value:"",label:""}]),q=async ae=>{ae.preventDefault();let pe={...R.field_config};(R.field_type==="select"||R.field_type==="multi_select")&&(pe.options=k.filter(ne=>ne.value&&ne.label));const H={...R,field_config:pe};try{P?await as.updateField(P.id,H):await as.createField(H),F(),b()}catch(ne){console.error("Failed to save custom field:",ne)}},K=()=>{z([...k,{value:"",label:""}])},se=(ae,pe,H)=>{const ne=k.map((U,le)=>le===ae?{...U,[pe]:H}:U);z(ne)},ie=ae=>{z(k.filter((pe,H)=>H!==ae))};return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-screen overflow-y-auto",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h2",{className:"text-xl font-semibold",children:P?"Edit Custom Field":"Create Custom Field"}),o.jsx("button",{onClick:I,className:"text-text-secondary hover:text-text-primary",children:o.jsx(_8,{size:20})})]}),o.jsxs("form",{onSubmit:q,className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Field Name *"}),o.jsx("input",{type:"text",value:R.name,onChange:ae=>C({...R,name:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Field Type *"}),o.jsx("select",{value:R.field_type,onChange:ae=>C({...R,field_type:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:g.map(ae=>o.jsx("option",{value:ae.value,children:ae.label},ae.value))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Entity Type *"}),o.jsx("select",{value:R.entity_type,onChange:ae=>C({...R,entity_type:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!!P,children:v.map(ae=>o.jsx("option",{value:ae.value,children:ae.label},ae.value))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Placement"}),o.jsx("select",{value:R.placement,onChange:ae=>C({...R,placement:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:y.map(ae=>o.jsx("option",{value:ae.value,children:ae.label},ae.value))})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),o.jsx("textarea",{value:R.description,onChange:ae=>C({...R,description:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"2"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Help Text"}),o.jsx("input",{type:"text",value:R.help_text,onChange:ae=>C({...R,help_text:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Placeholder"}),o.jsx("input",{type:"text",value:R.placeholder,onChange:ae=>C({...R,placeholder:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",id:"required",checked:R.is_required,onChange:ae=>C({...R,is_required:ae.target.checked}),className:"mr-2"}),o.jsx("label",{htmlFor:"required",className:"text-sm font-medium text-gray-700",children:"Required Field"})]}),(R.field_type==="select"||R.field_type==="multi_select")&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Options"}),k.map((ae,pe)=>o.jsxs("div",{className:"flex gap-2 mb-2",children:[o.jsx("input",{type:"text",placeholder:"Value",value:ae.value,onChange:H=>se(pe,"value",H.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),o.jsx("input",{type:"text",placeholder:"Label",value:ae.label,onChange:H=>se(pe,"label",H.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),o.jsx("button",{type:"button",onClick:()=>ie(pe),className:"px-3 py-2 text-error hover:text-error-600",children:o.jsx(Gk,{size:16})})]},pe)),o.jsx("button",{type:"button",onClick:K,className:"text-primary hover:text-primary-600 text-sm",children:"+ Add Option"})]}),o.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[o.jsx("button",{type:"button",onClick:I,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),o.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center",children:[o.jsx(Sq,{size:16,className:"mr-2"}),P?"Update":"Create"," Field"]})]})]})]})})},_=async P=>{if(window.confirm("Are you sure you want to delete this custom field? This action cannot be undone."))try{await as.deleteField(P),b()}catch(F){console.error("Failed to delete custom field:",F)}},D=d==="all"?e:e.filter(P=>P.entity_type===d),j=P=>P==="all"?e.length:e.filter(F=>F.entity_type===P).length,N=Math.ceil(D.length/x),S=(h-1)*x,E=S+x,A=D.slice(S,E),T=P=>{f(P),m(1)},L=P=>{m(P),window.scrollTo({top:0,behavior:"smooth"})},O=P=>{p(P),m(1)},V=()=>{const P=[];if(N<=5)for(let I=1;I<=N;I++)P.push(I);else if(h<=3){for(let I=1;I<=4;I++)P.push(I);P.push("..."),P.push(N)}else if(h>=N-2){P.push(1),P.push("...");for(let I=N-3;I<=N;I++)P.push(I)}else P.push(1),P.push("..."),P.push(h-1),P.push(h),P.push(h+1),P.push("..."),P.push(N);return P};return o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsxs("div",{children:[o.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center",children:[o.jsx(Dq,{className:"mr-3"}),"Custom Fields"]}),o.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"Create and manage custom fields for your data"})]}),o.jsxs("button",{onClick:()=>n(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center",children:[o.jsx(jq,{size:16,className:"mr-2"}),"Create Field"]})]}),o.jsxs("div",{className:"mb-6 bg-white rounded-lg shadow p-2 flex flex-wrap gap-2",children:[o.jsxs("button",{onClick:()=>T("all"),className:`px-4 py-2 rounded-md font-medium transition-colors ${d==="all"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["All (",j("all"),")"]}),v.map(P=>o.jsxs("button",{onClick:()=>T(P.value),className:`px-4 py-2 rounded-md font-medium transition-colors ${d===P.value?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[P.label," (",j(P.value),")"]},P.value))]}),s?o.jsx("div",{className:"text-center py-8",children:"Loading..."}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"bg-white rounded-lg shadow px-6 py-3 mb-4 flex justify-between items-center",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Show"}),o.jsxs("select",{value:x,onChange:P=>O(Number(P.target.value)),className:"px-3 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[o.jsx("option",{value:5,children:"5"}),o.jsx("option",{value:10,children:"10"}),o.jsx("option",{value:25,children:"25"}),o.jsx("option",{value:50,children:"50"}),o.jsx("option",{value:100,children:"100"})]}),o.jsx("span",{className:"text-sm text-gray-600",children:"entries per page"})]}),o.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",D.length>0?S+1:0," to ",Math.min(E,D.length)," of ",D.length," entries"]})]}),o.jsx("div",{className:"rounded-lg overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto",style:{maxWidth:"100%",overflowX:"auto"},children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[o.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Field Name"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Type"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Entity"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Required"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Placement"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Created"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:A&&A.length>0?A.map(P=>o.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:P.name}),P.description&&o.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-300",children:P.description})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:P.field_type.replace("_"," ")})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:P.entity_type})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:P.is_required?o.jsx("span",{className:"text-red-600 dark:text-red-400",children:""}):o.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"-"})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-200",children:P.placement.replace("_"," ")}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:new Date(P.created_at).toLocaleDateString()}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>i(P),className:"text-primary hover:text-primary-600",children:o.jsx(Nq,{size:16})}),o.jsx("button",{onClick:()=>_(P.id),className:"text-error hover:text-error-600",children:o.jsx(Gk,{size:16})})]})})]},P.id)):o.jsx("tr",{children:o.jsx("td",{colSpan:"7",className:"text-center py-8 text-gray-500 dark:text-gray-400",children:s?"Loading custom fields...":c||(d!=="all"?`No custom fields found for ${(W=v.find(P=>P.value===d))==null?void 0:W.label}. Create your first ${(B=v.find(P=>P.value===d))==null?void 0:B.label} custom field to get started.`:"No custom fields found. Create your first custom field to get started.")})})})]})})}),D.length>0&&N>1&&o.jsx("div",{className:"bg-white rounded-lg shadow px-6 py-4 mt-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("button",{onClick:()=>L(h-1),disabled:h===1,className:`px-4 py-2 rounded-md font-medium ${h===1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Previous"}),o.jsx("div",{className:"flex space-x-2",children:V().map((P,F)=>P==="..."?o.jsx("span",{className:"px-3 py-2 text-gray-500",children:"..."},`ellipsis-${F}`):o.jsx("button",{onClick:()=>L(P),className:`px-4 py-2 rounded-md font-medium transition-colors ${h===P?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:P},P))}),o.jsx("button",{onClick:()=>L(h+1),disabled:h===N,className:`px-4 py-2 rounded-md font-medium ${h===N?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Next"})]})})]}),r&&o.jsx(w,{onSave:()=>n(!1),onCancel:()=>n(!1)}),a&&o.jsx(w,{field:a,onSave:()=>i(null),onCancel:()=>i(null)})]})},UZe=()=>o.jsx(MZe,{}),$Ze=()=>{const[e,t]=M.useState([]),[r,n]=M.useState([]),[a,i]=M.useState(!0),[s,l]=M.useState(null),[c,u]=M.useState(null),[d,f]=M.useState(!1),[h,m]=M.useState(!1),[x,p]=M.useState(null),[g,v]=M.useState(!1),[y,b]=M.useState(""),[w,_]=M.useState({name:"",subject:"",category:"general",content:"",status:"draft"}),[D,j]=M.useState("content"),[N,S]=M.useState([]),[E,A]=M.useState({}),T=es.getCategories(),L=[...T,...N],O=es.getStatuses(),V=ne=>!T.some(U=>U.value===ne);M.useEffect(()=>{k(),z(),W()},[]);const W=()=>{const ne=localStorage.getItem("emailTemplateCustomCategories");if(ne)try{S(JSON.parse(ne))}catch(le){console.error("Failed to load custom categories:",le)}const U=localStorage.getItem("emailTemplateCategoryMetadata");if(U)try{A(JSON.parse(U))}catch(le){console.error("Failed to load category metadata:",le)}},B=ne=>{localStorage.setItem("emailTemplateCustomCategories",JSON.stringify(ne)),S(ne)},P=ne=>{localStorage.setItem("emailTemplateCategoryMetadata",JSON.stringify(ne)),A(ne)},F=ne=>{if(!window.confirm(`Are you sure you want to delete the "${I(ne)}" category? Templates using this category will be moved to "General".`))return;const U=N.filter(le=>le.value!==ne);B(U),w.category===ne&&_(le=>({...le,category:"general"}))},I=ne=>{const U=L.find(le=>le.value===ne);return(U==null?void 0:U.label)||ne},R=()=>{if(!y.trim()){alert("Please enter a category name");return}const ne=y.toLowerCase().replace(/\s+/g,"-"),U=y.trim();if([...T,...N].some(G=>G.value===ne)){alert("This category already exists");return}const re={value:ne,label:U},X=[...N,re];B(X),_(G=>({...G,category:ne})),b(""),v(!1)},C=ne=>{const U=ne.target.value;U==="__add_new__"?v(!0):_(le=>({...le,category:U}))},k=async()=>{try{i(!0);const ne=await es.getTemplates();t(ne.templates||[])}catch(ne){l("Failed to load email templates"),console.error(ne)}finally{i(!1)}},z=async()=>{try{const ne=await es.getMergeFields();n(ne.fields||[])}catch(ne){console.error("Failed to load merge fields:",ne)}},q=()=>{p(null),_({name:"",subject:"",category:"general",content:"",status:"draft"}),f(!0)},K=ne=>{p(ne);const U=E[ne.id],le=(U==null?void 0:U.customCategory)||ne.category;_({name:ne.name,subject:ne.subject,category:le,content:ne.content,status:ne.status}),f(!0)},se=async ne=>{if(window.confirm("Are you sure you want to delete this template?"))try{await es.deleteTemplate(ne),await k()}catch(U){alert("Failed to delete template"),console.error(U)}},ie=async ne=>{var U,le;ne.preventDefault();try{const re={...w,category:V(w.category)?"general":w.category};let X;if(x?X=await es.updateTemplate(x.id,re):X=await es.createTemplate(re),V(w.category)){const G={...E,[X.id]:{customCategory:w.category,categoryLabel:I(w.category)}};P(G)}f(!1),await k()}catch(re){alert("Failed to save template: "+(((le=(U=re.response)==null?void 0:U.data)==null?void 0:le.detail)||re.message)),console.error(re)}},ee=ne=>{u(ne),m(!0)},ae=ne=>{const U=document.getElementById("template-subject"),le=document.getElementById("template-content");let re,X,G;D==="subject"?(re=U,X=(w==null?void 0:w.subject)||"",G="subject"):(re=le,X=(w==null?void 0:w.content)||"",G="content");const ce=(re==null?void 0:re.selectionStart)||0,J=(re==null?void 0:re.selectionEnd)||0,ue=X.substring(0,ce),me=X.substring(J,X.length),te=ue+ne+me;_(G==="subject"?oe=>({...oe,subject:te}):oe=>({...oe,content:te})),setTimeout(()=>{re==null||re.focus(),re==null||re.setSelectionRange(ce+ne.length,ce+ne.length)},0)},pe=ne=>{var le;const U={active:"bg-success-50 text-success-600 border-success-100",draft:"bg-warning-50 text-warning-600 border-warning-100",inactive:"bg-error-50 text-error-600 border-error-100"};return o.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded border ${(U==null?void 0:U[ne])||"bg-gray-50 text-gray-600 border-gray-100"}`,children:((le=ne==null?void 0:ne.charAt(0))==null?void 0:le.toUpperCase())+(ne==null?void 0:ne.slice(1))})},H=ne=>{const U=E[ne.id];U!=null&&U.customCategory||ne.category;const le=(U==null?void 0:U.categoryLabel)||I(ne.category);return o.jsx("span",{className:"px-2 py-1 text-xs bg-primary-50 text-primary border border-primary-100 rounded",children:le})};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"Email Templates"}),o.jsx("p",{className:"text-text-secondary mt-1",children:"Create and manage email templates with merge fields"})]}),o.jsxs("button",{onClick:q,className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors duration-150 ease-smooth flex items-center space-x-2",children:[o.jsx(Y,{name:"Plus",size:16}),o.jsx("span",{children:"Create Template"})]})]}),a?o.jsx("div",{className:"bg-surface rounded-lg border border-border p-8 text-center",children:o.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"}),o.jsx("span",{className:"text-text-secondary",children:"Loading templates..."})]})}):s?o.jsxs("div",{className:"bg-surface rounded-lg border border-border p-8 text-center",children:[o.jsx("div",{className:"text-error",children:s}),o.jsx("button",{onClick:k,className:"mt-2 text-primary hover:underline",children:"Try again"})]}):o.jsx("div",{className:"bg-surface rounded-lg border border-border overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-background border-b border-border",children:o.jsxs("tr",{children:[o.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-primary",children:"Template Name"}),o.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-primary",children:"Subject"}),o.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-primary",children:"Category"}),o.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-primary",children:"Status"}),o.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-primary",children:"Modified"}),o.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-primary",children:"Actions"})]})}),o.jsx("tbody",{children:e.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:7,className:"py-8 px-4 text-center text-text-secondary",children:"No email templates found. Create your first template to get started."})}):e.map(ne=>o.jsxs("tr",{className:"border-b border-border hover:bg-surface-hover",children:[o.jsx("td",{className:"py-3 px-4",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Y,{name:"Mail",size:16,className:"text-text-tertiary"}),o.jsx("span",{className:"font-medium text-text-primary",children:ne.name})]})}),o.jsx("td",{className:"py-3 px-4 text-sm text-text-secondary max-w-xs truncate",children:ne.subject}),o.jsx("td",{className:"py-3 px-4",children:H(ne)}),o.jsx("td",{className:"py-3 px-4",children:pe(ne.status)}),o.jsx("td",{className:"py-3 px-4 text-sm text-text-secondary",children:new Date(ne.updated_at).toLocaleDateString()}),o.jsx("td",{className:"py-3 px-4",children:o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>ee(ne),className:"p-1 text-text-secondary hover:text-primary transition-colors duration-150",title:"Preview",children:o.jsx(Y,{name:"Eye",size:16})}),o.jsx("button",{onClick:()=>K(ne),className:"p-1 text-text-secondary hover:text-primary transition-colors duration-150",title:"Edit",children:o.jsx(Y,{name:"Edit3",size:16})}),o.jsx("button",{onClick:()=>se(ne.id),className:"p-1 text-text-secondary hover:text-error transition-colors duration-150",title:"Delete",children:o.jsx(Y,{name:"Trash2",size:16})})]})})]},ne.id))})]})})}),d&&o.jsx("div",{className:"fixed inset-0 z-1200 overflow-y-auto",children:o.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:()=>f(!1)}),o.jsx("div",{className:"bg-surface rounded-lg shadow-xl max-w-4xl w-full relative z-1300 max-h-screen overflow-y-auto",children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:x?"Edit Template":"Create New Template"}),o.jsx("button",{onClick:()=>f(!1),className:"text-text-secondary hover:text-text-primary transition-colors duration-150",children:o.jsx(Y,{name:"X",size:20})})]}),o.jsxs("form",{onSubmit:ie,className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Template Name"}),o.jsx("input",{type:"text",value:w==null?void 0:w.name,onChange:ne=>_(U=>{var le;return{...U,name:(le=ne==null?void 0:ne.target)==null?void 0:le.value}}),className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",placeholder:"Enter template name",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Category"}),o.jsxs("select",{value:w==null?void 0:w.category,onChange:C,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:[L==null?void 0:L.map(ne=>o.jsx("option",{value:ne==null?void 0:ne.value,children:ne==null?void 0:ne.label},ne==null?void 0:ne.value)),o.jsx("option",{value:"__add_new__",className:"text-primary font-semibold",children:"+ Add New Category"})]}),N.length>0&&o.jsxs("div",{className:"mt-2 p-2 bg-background border border-border rounded-lg",children:[o.jsx("p",{className:"text-xs text-text-secondary mb-2",children:"Custom Categories:"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:N.map(ne=>o.jsxs("div",{className:"inline-flex items-center space-x-1 px-2 py-1 bg-primary-50 text-primary rounded border border-primary-100",children:[o.jsx("span",{className:"text-xs",children:ne.label}),o.jsx("button",{type:"button",onClick:()=>F(ne.value),className:"text-primary hover:text-error transition-colors",title:"Delete category",children:o.jsx(Y,{name:"X",size:12})})]},ne.value))})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Status"}),o.jsx("select",{value:w==null?void 0:w.status,onChange:ne=>_(U=>{var le;return{...U,status:(le=ne==null?void 0:ne.target)==null?void 0:le.value}}),className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:O==null?void 0:O.map(ne=>o.jsx("option",{value:ne==null?void 0:ne.value,children:ne==null?void 0:ne.label},ne==null?void 0:ne.value))})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Subject Line",o.jsx("span",{className:"text-xs text-text-tertiary ml-2 font-normal",children:"(Click subject field, then click merge fields to insert)"})]}),o.jsx("input",{id:"template-subject",type:"text",value:w==null?void 0:w.subject,onChange:ne=>_(U=>{var le;return{...U,subject:(le=ne==null?void 0:ne.target)==null?void 0:le.value}}),onFocus:()=>j("subject"),className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",placeholder:"Enter email subject (e.g., Hello {{first_name}}!)",required:!0})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"lg:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Email Content"}),o.jsx("textarea",{id:"template-content",value:w==null?void 0:w.content,onChange:ne=>_(U=>{var le;return{...U,content:(le=ne==null?void 0:ne.target)==null?void 0:le.value}}),onFocus:()=>j("content"),className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",rows:12,placeholder:"Enter email content...",required:!0})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Merge Fields",o.jsx("span",{className:"text-xs text-text-tertiary ml-2 font-normal block mt-1",children:"Click in Subject or Content field first, then click a merge field to insert"})]}),o.jsx("div",{className:"bg-background border border-border rounded-lg p-3 max-h-80 overflow-y-auto",children:(()=>{const ne=(r||[]).reduce((re,X)=>{const G=(X==null?void 0:X.category)||"General";return re[G]||(re[G]=[]),re[G].push(X),re},{}),U=["Contact Fields","Company Fields","Deal Fields","System Fields","Contact Custom Fields","Company Custom Fields","Deal Custom Fields","Activity Custom Fields","General"],le=Object.keys(ne).sort((re,X)=>{const G=U.indexOf(re),ce=U.indexOf(X);return G===-1&&ce===-1?re.localeCompare(X):G===-1?1:ce===-1?-1:G-ce});return o.jsx("div",{className:"space-y-3",children:le.map(re=>o.jsxs("details",{open:re==="Contact Fields"||re==="System Fields",children:[o.jsxs("summary",{className:"cursor-pointer text-sm font-medium text-text-primary hover:text-primary px-2 py-1 rounded hover:bg-surface-hover transition-colors duration-150",children:[re," (",ne[re].length,")"]}),o.jsx("div",{className:"mt-2 space-y-1 pl-2",children:ne[re].map(X=>o.jsxs("button",{type:"button",onClick:()=>ae(X==null?void 0:X.field),className:"w-full text-left p-2 rounded hover:bg-surface-hover transition-colors duration-150 group",children:[o.jsx("div",{className:"text-xs font-mono text-primary group-hover:text-primary-600",children:X==null?void 0:X.field}),o.jsxs("div",{className:"text-xs text-text-tertiary mt-1",children:[X==null?void 0:X.description,(X==null?void 0:X.example)&&o.jsxs("span",{className:"ml-2 italic",children:["e.g., ",X==null?void 0:X.example]})]})]},X==null?void 0:X.field))})]},re))})})()})]})]}),o.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[o.jsx("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors duration-150",children:"Cancel"}),o.jsx("button",{type:"submit",className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors duration-150 ease-smooth",children:x?"Update Template":"Create Template"})]})]})]})})]})}),h&&c&&o.jsx("div",{className:"fixed inset-0 z-1200 overflow-y-auto",children:o.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:()=>m(!1)}),o.jsx("div",{className:"bg-surface rounded-lg shadow-xl max-w-2xl w-full relative z-1300",children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Template Preview"}),o.jsx("button",{onClick:()=>m(!1),className:"text-text-secondary hover:text-text-primary transition-colors duration-150",children:o.jsx(Y,{name:"X",size:20})})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Subject:"}),o.jsx("div",{className:"bg-background border border-border rounded-lg p-3 text-text-primary",children:c==null?void 0:c.subject})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Content:"}),o.jsx("div",{className:"bg-background border border-border rounded-lg p-4 text-text-primary whitespace-pre-wrap min-h-40",children:c==null?void 0:c.content})]})]}),o.jsx("div",{className:"flex justify-end mt-6",children:o.jsx("button",{onClick:()=>m(!1),className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors duration-150 ease-smooth",children:"Close Preview"})})]})})]})}),g&&o.jsx("div",{className:"fixed inset-0 z-1300 overflow-y-auto",children:o.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:()=>v(!1)}),o.jsx("div",{className:"bg-surface rounded-lg shadow-xl max-w-md w-full relative z-1400",children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Add New Category"}),o.jsx("button",{onClick:()=>v(!1),className:"text-text-secondary hover:text-text-primary transition-colors duration-150",children:o.jsx(Y,{name:"X",size:20})})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Category Name"}),o.jsx("input",{type:"text",value:y,onChange:ne=>b(ne.target.value),onKeyPress:ne=>{ne.key==="Enter"&&(ne.preventDefault(),R())},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",placeholder:"e.g., Customer Support, Sales Follow-up",autoFocus:!0}),o.jsx("p",{className:"text-xs text-text-tertiary mt-1",children:"Enter a descriptive name for the new category"})]}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx("button",{type:"button",onClick:()=>{v(!1),b("")},className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors duration-150",children:"Cancel"}),o.jsx("button",{type:"button",onClick:R,className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors duration-150 ease-smooth",children:"Add Category"})]})]})]})})]})}),o.jsx("div",{className:"bg-background border border-border rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx(Y,{name:"Lightbulb",size:16,className:"text-primary mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:"font-medium text-text-primary text-sm",children:"Template Usage Tips"}),o.jsxs("p",{className:"text-text-secondary text-sm mt-1",children:["Use merge fields like ","{{first_name}}"," to personalize emails. Templates marked as 'Active' are available for use in email campaigns. Test your templates before sending to ensure proper formatting."]})]})]})})]})},LZe=()=>{var _,D,j,N,S,E,A,T,L,O,V,W,B;const[e,t]=M.useState({}),[r,n]=M.useState(!0),[a,i]=M.useState(""),[s,l]=M.useState(""),[c,u]=M.useState(!1),[d,f]=M.useState("json"),[h,m]=M.useState(!1),x=async()=>{try{n(!0),i("");const P=await mo.getConfigurationsGrouped(),F=[];Object.entries(P).forEach(([R,C])=>{Object.entries(C).forEach(([k,z])=>{F.push({key:`${R}.${k}`,value:z,category:R})})});const I=mo.transformConfigurationsForUI(F);t(I)}catch(P){console.error("Error loading configuration:",P),i("Failed to load configuration. Using default values."),Ue.error("Failed to load configuration settings"),t(mo.getDefaultConfiguration())}finally{n(!1)}};M.useEffect(()=>{x()},[]);const p=["America/New_York","America/Chicago","America/Denver","America/Los_Angeles","Europe/London","Europe/Paris","Asia/Tokyo","Asia/Shanghai","Australia/Sydney"],g=[{code:"USD",name:"US Dollar"},{code:"EUR",name:"Euro"},{code:"GBP",name:"British Pound"},{code:"CAD",name:"Canadian Dollar"},{code:"AUD",name:"Australian Dollar"},{code:"JPY",name:"Japanese Yen"}],v=["MM/DD/YYYY","DD/MM/YYYY","YYYY-MM-DD","DD-MM-YYYY"],y=(P,F,I)=>{t(R=>({...R,[P]:{...R==null?void 0:R[P],[F]:I}})),u(!0)},b=async()=>{try{n(!0),i("");const P=mo.transformConfigurationsFromUI(e),F=new Set(["general.company_name","general.company_email","general.company_phone","general.company_address","general.timezone","general.date_format","general.time_format","general.currency","general.language","sales.default_pipeline_stage","sales.deal_currency","sales.require_deal_value","sales.auto_progress_deals","sales.deal_inactivity_warning_days","sales.lead_scoring_enabled","sales.opportunity_auto_close_days","notifications.email_notifications","notifications.deal_update_notifications","notifications.task_reminders","notifications.weekly_reports","notifications.system_alerts","notifications.lead_assignment_alerts","notifications.quota_achievement_alerts","security.password_complexity","security.min_password_length","security.two_factor_auth","security.session_timeout_minutes","security.max_login_attempts","security.lockout_duration_minutes","security.data_encryption_at_rest","security.audit_log_retention_days","backup.enable_automatic_backups","backup.backup_frequency","backup.backup_retention_days","backup.backup_location","backup.compress_backups","integrations.email_service_provider","integrations.calendar_integration","integrations.crm_sync_enabled","integrations.api_rate_limit","performance.enable_caching","performance.cache_ttl_seconds","performance.max_search_results","performance.database_query_timeout"]),I=P.filter(z=>{const q=F.has(z.key);return q||console.warn(`Skipping invalid configuration key: ${z.key}`),q});if(!Array.isArray(I)||I.length===0)throw new Error("No valid configurations to save");const R=I.filter(z=>!z.key||z.value===void 0||z.value===null||z.value==="");if(R.length>0)throw console.error("Invalid configurations found:",R),new Error(`Some configurations have missing or empty values: ${R.map(z=>z.key).join(", ")}`);const C=I.map(z=>({key:z.key,value:z.value})),k=await mo.updateConfigurationsBulk(C);l("Configuration saved successfully!"),u(!1),Ue.success("System configuration updated successfully!"),setTimeout(()=>l(""),3e3),await x()}catch(P){console.error("Error saving configuration:",P),console.error("Full error object:",JSON.stringify(P,null,2));let F="Failed to save configuration. Please try again.";P&&P.message&&(F=P.message),i(F),Ue.error(F)}finally{n(!1)}},w=async()=>{try{i("");const P=await mo.exportConfiguration(),F=d==="json"?JSON.stringify(P,null,2):Object.entries(P.configurations).map(([k,z])=>Object.entries(z).map(([q,K])=>`${k}.${q}=${K}`).join(`
`)).join(`
`),I=new Blob([F],{type:d==="json"?"application/json":"text/plain"}),R=URL.createObjectURL(I),C=document.createElement("a");C.href=R,C.download=`system-config.${d}`,document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(R),m(!1),l("Configuration exported successfully!"),Ue.success("Configuration exported successfully!")}catch(P){console.error("Error exporting configuration:",P);const F="Failed to export configuration. Please try again.";i(F),Ue.error(F)}};return o.jsxs("div",{className:"space-y-6",children:[a&&o.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start space-x-3",children:[o.jsx(Y,{name:"AlertCircle",size:20,className:"text-red-500 mt-0.5 flex-shrink-0"}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium text-red-800",children:"Configuration Error"}),o.jsx("p",{className:"text-red-700 text-sm mt-1",children:a})]})]}),s&&o.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-start space-x-3",children:[o.jsx(Y,{name:"CheckCircle",size:20,className:"text-green-500 mt-0.5 flex-shrink-0"}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium text-green-800",children:"Success"}),o.jsx("p",{className:"text-green-700 text-sm mt-1",children:s})]})]}),r&&o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-center space-x-3",children:[o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-primary"}),o.jsx("span",{className:"text-blue-700",children:"Loading configuration..."})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"System Configuration"}),o.jsx("p",{className:"text-text-secondary mt-1",children:"Manage general system settings and preferences"})]}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsxs("button",{onClick:()=>m(!0),disabled:r,className:"bg-background text-text-primary px-4 py-2 rounded-lg hover:bg-surface-hover transition-colors duration-150 ease-smooth flex items-center space-x-2 border border-border disabled:opacity-50 disabled:cursor-not-allowed",children:[o.jsx(Y,{name:"Download",size:16}),o.jsx("span",{children:"Export Configuration"})]}),o.jsxs("button",{onClick:b,disabled:!c||r,className:`px-4 py-2 rounded-lg transition-colors duration-150 ease-smooth flex items-center space-x-2 ${c&&!r?"bg-primary text-white hover:bg-primary-600":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:[r?o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):o.jsx(Y,{name:"Save",size:16}),o.jsx("span",{children:r?"Saving...":"Save Changes"})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsx("div",{className:"space-y-6",children:o.jsxs("div",{className:"bg-surface rounded-lg border border-border p-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center space-x-2",children:[o.jsx(Y,{name:"Settings",size:20,className:"text-primary"}),o.jsx("span",{children:"General Settings"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Company Name"}),o.jsx("input",{type:"text",value:((_=e==null?void 0:e.general)==null?void 0:_.company_name)||"",onChange:P=>{var F;return y("general","company_name",(F=P==null?void 0:P.target)==null?void 0:F.value)},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Company Email"}),o.jsx("input",{type:"email",value:((D=e==null?void 0:e.general)==null?void 0:D.company_email)||"",onChange:P=>{var F;return y("general","company_email",(F=P==null?void 0:P.target)==null?void 0:F.value)},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Company Phone"}),o.jsx("input",{type:"tel",value:((j=e==null?void 0:e.general)==null?void 0:j.company_phone)||"",onChange:P=>{var F;return y("general","company_phone",(F=P==null?void 0:P.target)==null?void 0:F.value)},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Company Address"}),o.jsx("textarea",{value:((N=e==null?void 0:e.general)==null?void 0:N.company_address)||"",onChange:P=>{var F;return y("general","company_address",(F=P==null?void 0:P.target)==null?void 0:F.value)},rows:3,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Timezone"}),o.jsx("select",{value:((S=e==null?void 0:e.general)==null?void 0:S.timezone)||"",onChange:P=>{var F;return y("general","timezone",(F=P==null?void 0:P.target)==null?void 0:F.value)},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:p==null?void 0:p.map(P=>o.jsx("option",{value:P,children:P},P))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Date Format"}),o.jsx("select",{value:((E=e==null?void 0:e.general)==null?void 0:E.date_format)||"",onChange:P=>{var F;return y("general","date_format",(F=P==null?void 0:P.target)==null?void 0:F.value)},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:v==null?void 0:v.map(P=>o.jsx("option",{value:P,children:P},P))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Time Format"}),o.jsxs("select",{value:((A=e==null?void 0:e.general)==null?void 0:A.time_format)||"",onChange:P=>{var F;return y("general","time_format",(F=P==null?void 0:P.target)==null?void 0:F.value)},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:[o.jsx("option",{value:"12",children:"12 Hour"}),o.jsx("option",{value:"24",children:"24 Hour"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Currency"}),o.jsx("select",{value:((T=e==null?void 0:e.general)==null?void 0:T.currency)||"",onChange:P=>{var F;return y("general","currency",(F=P==null?void 0:P.target)==null?void 0:F.value)},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:g==null?void 0:g.map(P=>o.jsxs("option",{value:P==null?void 0:P.code,children:[P==null?void 0:P.code," - ",P==null?void 0:P.name]},P==null?void 0:P.code))})]})]})]})}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-surface rounded-lg border border-border p-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center space-x-2",children:[o.jsx(Y,{name:"Target",size:20,className:"text-primary"}),o.jsx("span",{children:"Deals Settings"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Default Pipeline Stage"}),o.jsxs("select",{value:((L=e==null?void 0:e.sales)==null?void 0:L.default_pipeline_stage)||"",onChange:P=>{var F;return y("sales","default_pipeline_stage",(F=P==null?void 0:P.target)==null?void 0:F.value)},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:[o.jsx("option",{value:"lead",children:"Lead"}),o.jsx("option",{value:"qualified",children:"Qualified"}),o.jsx("option",{value:"proposal",children:"Proposal"}),o.jsx("option",{value:"negotiation",children:"Negotiation"}),o.jsx("option",{value:"closed_won",children:"Closed Won"}),o.jsx("option",{value:"closed_lost",children:"Closed Lost"})]})]}),o.jsx("div",{children:o.jsxs("label",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"checkbox",checked:((O=e==null?void 0:e.sales)==null?void 0:O.require_deal_value)||!1,onChange:P=>{var F;return y("sales","require_deal_value",(F=P==null?void 0:P.target)==null?void 0:F.checked)},className:"rounded border-border text-primary focus:ring-primary"}),o.jsx("span",{className:"text-sm text-text-primary",children:"Require deal value"})]})})]})]}),o.jsxs("div",{className:"bg-surface rounded-lg border border-border p-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center space-x-2",children:[o.jsx(Y,{name:"Shield",size:20,className:"text-primary"}),o.jsx("span",{children:"Security"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Session Timeout (minutes)"}),o.jsx("input",{type:"number",value:((V=e==null?void 0:e.security)==null?void 0:V.session_timeout_minutes)||"",onChange:P=>{var F;return y("security","session_timeout_minutes",parseInt((F=P==null?void 0:P.target)==null?void 0:F.value))},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",min:"30",max:"1440"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Max Login Attempts"}),o.jsx("input",{type:"number",value:((W=e==null?void 0:e.security)==null?void 0:W.max_login_attempts)||"",onChange:P=>{var F;return y("security","max_login_attempts",parseInt((F=P==null?void 0:P.target)==null?void 0:F.value))},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",min:"3",max:"10"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Account Lockout Duration (minutes)"}),o.jsx("input",{type:"number",value:((B=e==null?void 0:e.security)==null?void 0:B.lockout_duration_minutes)||"",onChange:P=>{var F;return y("security","lockout_duration_minutes",parseInt((F=P==null?void 0:P.target)==null?void 0:F.value))},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",min:"5",max:"1440",placeholder:"30"}),o.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"How long to lock account after max failed login attempts"})]})]})]})]})]}),h&&o.jsx("div",{className:"fixed inset-0 z-1200 overflow-y-auto",children:o.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:()=>m(!1)}),o.jsx("div",{className:"bg-surface rounded-lg shadow-xl max-w-md w-full relative z-1300",children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Export Configuration"}),o.jsx("button",{onClick:()=>m(!1),className:"text-text-secondary hover:text-text-primary transition-colors duration-150",children:o.jsx(Y,{name:"X",size:20})})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Export Format"}),o.jsxs("select",{value:d,onChange:P=>{var F;return f((F=P==null?void 0:P.target)==null?void 0:F.value)},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:[o.jsx("option",{value:"json",children:"JSON"}),o.jsx("option",{value:"txt",children:"Text"})]})]}),o.jsx("p",{className:"text-sm text-text-secondary",children:"This will download your current system configuration settings."})]}),o.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[o.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors duration-150",children:"Cancel"}),o.jsx("button",{onClick:w,className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors duration-150 ease-smooth",children:"Export"})]})]})})]})}),o.jsx("div",{className:"bg-background border border-border rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx(Y,{name:"AlertCircle",size:16,className:"text-primary mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:"font-medium text-text-primary text-sm",children:"Configuration Changes"}),o.jsx("p",{className:"text-text-secondary text-sm mt-1",children:c?'You have unsaved changes. Click "Save Changes" to apply your modifications.':"All settings are saved and up to date. Changes will take effect immediately after saving."})]})]})})]})},BZe=()=>{const{user:e,hasPermission:t}=Vt(),[r]=Cp(),[n,a]=M.useState("user-management");M.useEffect(()=>{if(e){const s=r.get("section");if(r.get("code")||r.get("error")){a("integrations");return}if(s){a(s);return}const c=[{id:"user-management",permission:"settings.user_management"},{id:"integrations",permission:"settings.integrations"},{id:"custom-fields",permission:"settings.custom_fields"},{id:"email-templates",permission:"settings.email_templates"},{id:"permissions",permission:"settings.permissions"},{id:"system-config",permission:"settings.system_config"}];for(const u of c)if(t(u.permission)){a(u.id);break}}},[e,r,t]);const i=()=>{switch(n){case"user-management":return o.jsx(b8,{});case"permissions":return o.jsx(IZe,{});case"integrations":return o.jsx(RZe,{});case"custom-fields":return o.jsx(UZe,{});case"email-templates":return o.jsx($Ze,{});case"system-config":return o.jsx(LZe,{});default:return o.jsx(b8,{})}};return o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(ii,{}),o.jsx("main",{className:"pt-14 xs:pt-16 sm:pt-20",children:o.jsxs("div",{className:"max-w-full mx-auto",children:[o.jsx("div",{className:"px-3 xs:px-4 sm:px-6 py-3 xs:py-4 hidden sm:block",children:o.jsx(Hs,{})}),o.jsxs("div",{className:"flex flex-col lg:flex-row min-h-[calc(100vh-4rem)] xs:min-h-[calc(100vh-5rem)] sm:min-h-[calc(100vh-7rem)]",children:[o.jsx("div",{className:"hidden lg:block lg:w-64 xl:w-72 flex-shrink-0",children:o.jsx(PZe,{activeSection:n,onSectionChange:a})}),o.jsx("div",{className:"lg:hidden sticky top-14 xs:top-16 sm:top-20 z-10 bg-surface border-b border-border",children:o.jsx("div",{className:"px-3 xs:px-4 sm:px-6 py-3 xs:py-4",children:o.jsxs("select",{value:n,onChange:s=>{var l;return a((l=s==null?void 0:s.target)==null?void 0:l.value)},className:"w-full px-3 py-2.5 text-sm xs:text-base border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary bg-surface text-text-primary min-h-touch","aria-label":"Settings section",children:[t("settings.user_management")&&o.jsx("option",{value:"user-management",children:"User Management"}),t("settings.permissions")&&o.jsx("option",{value:"permissions",children:"Permissions"}),t("settings.integrations")&&o.jsx("option",{value:"integrations",children:"Integrations"}),t("settings.custom_fields")&&o.jsx("option",{value:"custom-fields",children:"Custom Fields"}),t("settings.email_templates")&&o.jsx("option",{value:"email-templates",children:"Email Templates"}),t("settings.system_config")&&o.jsx("option",{value:"system-config",children:"System Configuration"})]})})}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:o.jsx("div",{className:"p-3 xs:p-4 sm:p-6",children:i()})})]})]})})]})},WZe=()=>{const{user:e,permissions:t,hasPermission:r}=Vt();return o.jsx("div",{className:"min-h-screen bg-gray-50 p-8",children:o.jsxs("div",{className:"max-w-4xl mx-auto",children:[o.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Permission Debugger"}),o.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:"User Information"}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("p",{children:[o.jsx("strong",{children:"Email:"})," ",(e==null?void 0:e.email)||"Not logged in"]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Role:"})," ",(e==null?void 0:e.role)||"N/A"]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Name:"})," ",(e==null?void 0:e.full_name)||(e==null?void 0:e.first_name)||"N/A"]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Loaded Permissions"}),o.jsxs("p",{className:"mb-4",children:[o.jsx("strong",{children:"Total Count:"})," ",(t==null?void 0:t.length)||0]}),t&&t.length>0?o.jsx("div",{className:"grid grid-cols-2 gap-2",children:t.map((n,a)=>o.jsxs("div",{className:"text-sm bg-green-50 border border-green-200 rounded px-3 py-2",children:[" ",n]},a))}):o.jsx("p",{className:"text-red-600",children:" No permissions loaded!"})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Permission Tests"}),o.jsx("div",{className:"space-y-2",children:["dashboard.view_stats","deals.view_own","deals.view_all","contacts.view_own","analytics.view_personal","activities.view_own","settings.view_profile"].map(n=>o.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[o.jsx("span",{className:"font-mono text-sm",children:n}),o.jsx("span",{className:`px-3 py-1 rounded text-sm ${r(n)?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:r(n)?" Has Permission":" Missing"})]},n))})]}),o.jsx("button",{onClick:()=>window.location.reload(),className:"mt-6 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Reload Page"})]})})},zZe=()=>(Q.useEffect(()=>{const e=new URLSearchParams(window.location.search);e.set("section","integrations"),window.location.href=`/settings-administration?${e.toString()}`},[]),o.jsx("div",{className:"flex items-center justify-center min-h-screen",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),o.jsx("p",{children:"Processing OAuth callback..."})]})})),HZe=()=>o.jsx(fq,{children:o.jsxs(aX,{children:[o.jsx(nX,{}),o.jsxs(hq,{children:[o.jsx(Kr,{path:"/login",element:o.jsx(uC,{})}),o.jsx(Kr,{path:"/forgot-password",element:o.jsx(iX,{})}),o.jsx(Kr,{path:"/reset-password",element:o.jsx(sX,{})}),o.jsx(Kr,{path:"/",element:o.jsx(uC,{})}),o.jsx(Kr,{path:"/auth/microsoft/success",element:o.jsx(oX,{})}),o.jsx(Kr,{path:"/debug-permissions",element:o.jsx(WZe,{})}),o.jsx(Kr,{path:"/integrations/oauth/callback",element:o.jsx(_a,{requiredPermission:"settings.integrations",children:o.jsx(zZe,{})})}),o.jsx(Kr,{path:"/sales-dashboard",element:o.jsx(_a,{requiredPermissions:["dashboard.view_stats","dashboard.pipeline_view"],children:o.jsx(aCe,{})})}),o.jsx(Kr,{path:"/deal-management",element:o.jsx(_a,{requiredPermission:"deals.view_own",children:o.jsx(t_,{})})}),o.jsx(Kr,{path:"/deal-management/new",element:o.jsx(_a,{requiredPermission:"deals.create",children:o.jsx(t_,{})})}),o.jsx(Kr,{path:"/deal-management/:dealId",element:o.jsx(_a,{requiredPermission:"deals.view_own",children:o.jsx(t_,{})})}),o.jsx(Kr,{path:"/contact-management",element:o.jsx(_a,{requiredPermission:"contacts.view_own",children:o.jsx($We,{})})}),o.jsx(Kr,{path:"/company-management",element:o.jsx(_a,{requiredPermission:"companies.view_own",children:o.jsx(R6,{})})}),o.jsx(Kr,{path:"/company-management/:companyId",element:o.jsx(_a,{requiredPermission:"companies.view_own",children:o.jsx(R6,{})})}),o.jsx(Kr,{path:"/campaign-management",element:o.jsx(_a,{requiredPermission:"campaigns.view_own",children:o.jsx(n_,{})})}),o.jsx(Kr,{path:"/campaign-management/new",element:o.jsx(_a,{requiredPermission:"campaigns.create",children:o.jsx(n_,{})})}),o.jsx(Kr,{path:"/campaign-management/:campaignId",element:o.jsx(_a,{requiredPermission:"campaigns.view_own",children:o.jsx(n_,{})})}),o.jsx(Kr,{path:"/pipeline-analytics",element:o.jsx(_a,{requiredPermission:"analytics.view_personal",children:o.jsx(oze,{})})}),o.jsx(Kr,{path:"/activity-timeline",element:o.jsx(_a,{requiredPermission:"activities.view_own",children:o.jsx(FZe,{})})}),o.jsx(Kr,{path:"/settings-administration",element:o.jsx(_a,{requiredPermission:"settings.view_profile",children:o.jsx(BZe,{})})})]})]})});function VZe(){return o.jsx(tX,{children:o.jsx(rX,{children:o.jsx(qZe,{})})})}function qZe(){return o.jsxs("div",{className:"min-h-screen bg-background text-text-primary transition-colors duration-300",children:[o.jsx(HZe,{}),o.jsx(bG,{position:"top-right",toastOptions:{duration:4e3,className:"",style:{background:"#ffffff",color:"#1f2937",border:"1px solid #e5e7eb",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",borderRadius:"8px",fontSize:"14px",fontWeight:"500"},success:{style:{background:"#f0fdf4",color:"#166534",border:"1px solid #bbf7d0"},iconTheme:{primary:"#16a34a",secondary:"#ffffff"}},error:{style:{background:"#fef2f2",color:"#991b1b",border:"1px solid #fecaca"},iconTheme:{primary:"#dc2626",secondary:"#ffffff"}}}})]})}const GZe=document.getElementById("root"),YZe=E8(GZe);YZe.render(o.jsx(VZe,{}));export{Co as _,Oi as a,Zu as b,xc as c};
//# sourceMappingURL=index-CWCr2c4h.js.map
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/jspdf.es.min-CY8FTPTr.js","assets/vendor-CF0Y5DJ5.js","assets/router-CEKQOvjm.js","assets/ui-V0Y0FXBm.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}