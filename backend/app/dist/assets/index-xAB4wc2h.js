import{r as R,a as Y4,R as ge,g as Rt,b as HL,c as gt,d as VL}from"./vendor-CF0Y5DJ5.js";import{u as V2,N as GL,a as Os,b as ah,L as hr,_ as ct,c as G2,B as XL,R as KL,d as Tr}from"./router-CEKQOvjm.js";import{C as YL,L as ZL,X as Z4,a as JL,S as QL,b as tD,c as rD,d as e9,P as t9,M as r9,e as n9,f as a9,g as i9,h as s9,T as nD,i as o9}from"./ui-DbZRXSBI.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var J4={exports:{}},Bx={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c9=R,l9=Symbol.for("react.element"),u9=Symbol.for("react.fragment"),d9=Object.prototype.hasOwnProperty,f9=c9.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,h9={key:!0,ref:!0,__self:!0,__source:!0};function Q4(e,t,r){var n,a={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)d9.call(t,n)&&!h9.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:l9,type:e,key:i,ref:o,props:a,_owner:f9.current}}Bx.Fragment=u9;Bx.jsx=Q4;Bx.jsxs=Q4;J4.exports=Bx;var s=J4.exports,eF,aD=Y4;eF=aD.createRoot,aD.hydrateRoot;let m9={data:""},p9=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||m9,x9=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,g9=/\/\*[^]*?\*\/|  +/g,iD=/\n+/g,Xs=(e,t)=>{let r="",n="",a="";for(let i in e){let o=e[i];i[0]=="@"?i[1]=="i"?r=i+" "+o+";":n+=i[1]=="f"?Xs(o,i):i+"{"+Xs(o,i[1]=="k"?"":t)+"}":typeof o=="object"?n+=Xs(o,t?t.replace(/([^,])+/g,c=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,c):c?c+" "+l:l)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=Xs.p?Xs.p(i,o):i+":"+o+";")}return r+(t&&a?t+"{"+a+"}":a)+n},as={},tF=e=>{if(typeof e=="object"){let t="";for(let r in e)t+=r+tF(e[r]);return t}return e},v9=(e,t,r,n,a)=>{let i=tF(e),o=as[i]||(as[i]=(l=>{let u=0,d=11;for(;u<l.length;)d=101*d+l.charCodeAt(u++)>>>0;return"go"+d})(i));if(!as[o]){let l=i!==e?e:(u=>{let d,f,h=[{}];for(;d=x9.exec(u.replace(g9,""));)d[4]?h.shift():d[3]?(f=d[3].replace(iD," ").trim(),h.unshift(h[0][f]=h[0][f]||{})):h[0][d[1]]=d[2].replace(iD," ").trim();return h[0]})(e);as[o]=Xs(a?{["@keyframes "+o]:l}:l,r?"":"."+o)}let c=r&&as.g?as.g:null;return r&&(as.g=as[o]),((l,u,d,f)=>{f?u.data=u.data.replace(f,l):u.data.indexOf(l)===-1&&(u.data=d?l+u.data:u.data+l)})(as[o],t,n,c),o},y9=(e,t,r)=>e.reduce((n,a,i)=>{let o=t[i];if(o&&o.call){let c=o(r),l=c&&c.props&&c.props.className||/^go/.test(c)&&c;o=l?"."+l:c&&typeof c=="object"?c.props?"":Xs(c,""):c===!1?"":c}return n+a+(o??"")},"");function Lx(e){let t=this||{},r=e.call?e(t.p):e;return v9(r.unshift?r.raw?y9(r,[].slice.call(arguments,1),t.p):r.reduce((n,a)=>Object.assign(n,a&&a.call?a(t.p):a),{}):r,p9(t.target),t.g,t.o,t.k)}let rF,Fb,Ob;Lx.bind({g:1});let js=Lx.bind({k:1});function b9(e,t,r,n){Xs.p=t,rF=e,Fb=r,Ob=n}function vo(e,t){let r=this||{};return function(){let n=arguments;function a(i,o){let c=Object.assign({},i),l=c.className||a.className;r.p=Object.assign({theme:Fb&&Fb()},c),r.o=/ *go\d+/.test(l),c.className=Lx.apply(r,n)+(l?" "+l:"");let u=e;return e[0]&&(u=c.as||e,delete c.as),Ob&&u[0]&&Ob(c),rF(u,c)}return a}}var w9=e=>typeof e=="function",Gm=(e,t)=>w9(e)?e(t):e,_9=(()=>{let e=0;return()=>(++e).toString()})(),nF=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),j9=20,X2="default",aF=(e,t)=>{let{toastLimit:r}=e.settings;switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,r)};case 1:return{...e,toasts:e.toasts.map(o=>o.id===t.toast.id?{...o,...t.toast}:o)};case 2:let{toast:n}=t;return aF(e,{type:e.toasts.find(o=>o.id===n.id)?1:0,toast:n});case 3:let{toastId:a}=t;return{...e,toasts:e.toasts.map(o=>o.id===a||a===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(o=>o.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let i=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},Rm=[],iF={toasts:[],pausedAt:void 0,settings:{toastLimit:j9}},Li={},sF=(e,t=X2)=>{Li[t]=aF(Li[t]||iF,e),Rm.forEach(([r,n])=>{r===t&&n(Li[t])})},oF=e=>Object.keys(Li).forEach(t=>sF(e,t)),N9=e=>Object.keys(Li).find(t=>Li[t].toasts.some(r=>r.id===e)),$x=(e=X2)=>t=>{sF(t,e)},D9={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},S9=(e={},t=X2)=>{let[r,n]=R.useState(Li[t]||iF),a=R.useRef(Li[t]);R.useEffect(()=>(a.current!==Li[t]&&n(Li[t]),Rm.push([t,n]),()=>{let o=Rm.findIndex(([c])=>c===t);o>-1&&Rm.splice(o,1)}),[t]);let i=r.toasts.map(o=>{var c,l,u;return{...e,...e[o.type],...o,removeDelay:o.removeDelay||((c=e[o.type])==null?void 0:c.removeDelay)||(e==null?void 0:e.removeDelay),duration:o.duration||((l=e[o.type])==null?void 0:l.duration)||(e==null?void 0:e.duration)||D9[o.type],style:{...e.style,...(u=e[o.type])==null?void 0:u.style,...o.style}}});return{...r,toasts:i}},E9=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:(r==null?void 0:r.id)||_9()}),ih=e=>(t,r)=>{let n=E9(t,e,r);return $x(n.toasterId||N9(n.id))({type:2,toast:n}),n.id},zr=(e,t)=>ih("blank")(e,t);zr.error=ih("error");zr.success=ih("success");zr.loading=ih("loading");zr.custom=ih("custom");zr.dismiss=(e,t)=>{let r={type:3,toastId:e};t?$x(t)(r):oF(r)};zr.dismissAll=e=>zr.dismiss(void 0,e);zr.remove=(e,t)=>{let r={type:4,toastId:e};t?$x(t)(r):oF(r)};zr.removeAll=e=>zr.remove(void 0,e);zr.promise=(e,t,r)=>{let n=zr.loading(t.loading,{...r,...r==null?void 0:r.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let i=t.success?Gm(t.success,a):void 0;return i?zr.success(i,{id:n,...r,...r==null?void 0:r.success}):zr.dismiss(n),a}).catch(a=>{let i=t.error?Gm(t.error,a):void 0;i?zr.error(i,{id:n,...r,...r==null?void 0:r.error}):zr.dismiss(n)}),e};var T9=1e3,C9=(e,t="default")=>{let{toasts:r,pausedAt:n}=S9(e,t),a=R.useRef(new Map).current,i=R.useCallback((f,h=T9)=>{if(a.has(f))return;let m=setTimeout(()=>{a.delete(f),o({type:4,toastId:f})},h);a.set(f,m)},[]);R.useEffect(()=>{if(n)return;let f=Date.now(),h=r.map(m=>{if(m.duration===1/0)return;let x=(m.duration||0)+m.pauseDuration-(f-m.createdAt);if(x<0){m.visible&&zr.dismiss(m.id);return}return setTimeout(()=>zr.dismiss(m.id,t),x)});return()=>{h.forEach(m=>m&&clearTimeout(m))}},[r,n,t]);let o=R.useCallback($x(t),[t]),c=R.useCallback(()=>{o({type:5,time:Date.now()})},[o]),l=R.useCallback((f,h)=>{o({type:1,toast:{id:f,height:h}})},[o]),u=R.useCallback(()=>{n&&o({type:6,time:Date.now()})},[n,o]),d=R.useCallback((f,h)=>{let{reverseOrder:m=!1,gutter:x=8,defaultPosition:p}=h||{},g=r.filter(b=>(b.position||p)===(f.position||p)&&b.height),v=g.findIndex(b=>b.id===f.id),y=g.filter((b,_)=>_<v&&b.visible).length;return g.filter(b=>b.visible).slice(...m?[y+1]:[0,y]).reduce((b,_)=>b+(_.height||0)+x,0)},[r]);return R.useEffect(()=>{r.forEach(f=>{if(f.dismissed)i(f.id,f.removeDelay);else{let h=a.get(f.id);h&&(clearTimeout(h),a.delete(f.id))}})},[r,i]),{toasts:r,handlers:{updateHeight:l,startPause:c,endPause:u,calculateOffset:d}}},A9=js`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,k9=js`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,F9=js`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,O9=vo("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${A9} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${k9} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${F9} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,P9=js`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,I9=vo("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${P9} 1s linear infinite;
`,U9=js`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,R9=js`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,M9=vo("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${U9} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${R9} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,B9=vo("div")`
  position: absolute;
`,L9=vo("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,$9=js`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,W9=vo("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${$9} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,z9=({toast:e})=>{let{icon:t,type:r,iconTheme:n}=e;return t!==void 0?typeof t=="string"?R.createElement(W9,null,t):t:r==="blank"?null:R.createElement(L9,null,R.createElement(I9,{...n}),r!=="loading"&&R.createElement(B9,null,r==="error"?R.createElement(O9,{...n}):R.createElement(M9,{...n})))},q9=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,H9=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,V9="0%{opacity:0;} 100%{opacity:1;}",G9="0%{opacity:1;} 100%{opacity:0;}",X9=vo("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,K9=vo("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Y9=(e,t)=>{let r=e.includes("top")?1:-1,[n,a]=nF()?[V9,G9]:[q9(r),H9(r)];return{animation:t?`${js(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${js(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Z9=R.memo(({toast:e,position:t,style:r,children:n})=>{let a=e.height?Y9(e.position||t||"top-center",e.visible):{opacity:0},i=R.createElement(z9,{toast:e}),o=R.createElement(K9,{...e.ariaProps},Gm(e.message,e));return R.createElement(X9,{className:e.className,style:{...a,...r,...e.style}},typeof n=="function"?n({icon:i,message:o}):R.createElement(R.Fragment,null,i,o))});b9(R.createElement);var J9=({id:e,className:t,style:r,onHeightUpdate:n,children:a})=>{let i=R.useCallback(o=>{if(o){let c=()=>{let l=o.getBoundingClientRect().height;n(e,l)};c(),new MutationObserver(c).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[e,n]);return R.createElement("div",{ref:i,className:t,style:r},a)},Q9=(e,t)=>{let r=e.includes("top"),n=r?{top:0}:{bottom:0},a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:nF()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...n,...a}},e$=Lx`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Kh=16,t$=({reverseOrder:e,position:t="top-center",toastOptions:r,gutter:n,children:a,toasterId:i,containerStyle:o,containerClassName:c})=>{let{toasts:l,handlers:u}=C9(r,i);return R.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:Kh,left:Kh,right:Kh,bottom:Kh,pointerEvents:"none",...o},className:c,onMouseEnter:u.startPause,onMouseLeave:u.endPause},l.map(d=>{let f=d.position||t,h=u.calculateOffset(d,{reverseOrder:e,gutter:n,defaultPosition:t}),m=Q9(f,h);return R.createElement(J9,{id:d.id,key:d.id,onHeightUpdate:u.updateHeight,className:d.visible?e$:"",style:m},d.type==="custom"?Gm(d.message,d):a?a(d):R.createElement(Z9,{toast:d,position:f}))}))},Be=zr;const r$="modulepreload",n$=function(e){return"/"+e},sD={},fl=function(t,r,n){return!r||r.length===0?t():(document.getElementsByTagName("link"),Promise.all(r.map(a=>{if(a=n$(a),a in sD)return;sD[a]=!0;const i=a.endsWith(".css"),o=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${o}`))return;const c=document.createElement("link");if(c.rel=i?"stylesheet":r$,i||(c.as="script",c.crossOrigin=""),c.href=a,document.head.appendChild(c),i)return new Promise((l,u)=>{c.addEventListener("load",l),c.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>t()).catch(a=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=a,window.dispatchEvent(i),!i.defaultPrevented)throw a}))};function cF(e,t){return function(){return e.apply(t,arguments)}}const{toString:a$}=Object.prototype,{getPrototypeOf:K2}=Object,{iterator:Wx,toStringTag:lF}=Symbol,zx=(e=>t=>{const r=a$.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Si=e=>(e=e.toLowerCase(),t=>zx(t)===e),qx=e=>t=>typeof t===e,{isArray:cu}=Array,Md=qx("undefined");function sh(e){return e!==null&&!Md(e)&&e.constructor!==null&&!Md(e.constructor)&&aa(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const uF=Si("ArrayBuffer");function i$(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&uF(e.buffer),t}const s$=qx("string"),aa=qx("function"),dF=qx("number"),oh=e=>e!==null&&typeof e=="object",o$=e=>e===!0||e===!1,Mm=e=>{if(zx(e)!=="object")return!1;const t=K2(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(lF in e)&&!(Wx in e)},c$=e=>{if(!oh(e)||sh(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},l$=Si("Date"),u$=Si("File"),d$=Si("Blob"),f$=Si("FileList"),h$=e=>oh(e)&&aa(e.pipe),m$=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||aa(e.append)&&((t=zx(e))==="formdata"||t==="object"&&aa(e.toString)&&e.toString()==="[object FormData]"))},p$=Si("URLSearchParams"),[x$,g$,v$,y$]=["ReadableStream","Request","Response","Headers"].map(Si),b$=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ch(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),cu(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{if(sh(e))return;const i=r?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let c;for(n=0;n<o;n++)c=i[n],t.call(null,e[c],c,e)}}function fF(e,t){if(sh(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const Zo=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,hF=e=>!Md(e)&&e!==Zo;function Pb(){const{caseless:e}=hF(this)&&this||{},t={},r=(n,a)=>{const i=e&&fF(t,a)||a;Mm(t[i])&&Mm(n)?t[i]=Pb(t[i],n):Mm(n)?t[i]=Pb({},n):cu(n)?t[i]=n.slice():t[i]=n};for(let n=0,a=arguments.length;n<a;n++)arguments[n]&&ch(arguments[n],r);return t}const w$=(e,t,r,{allOwnKeys:n}={})=>(ch(t,(a,i)=>{r&&aa(a)?e[i]=cF(a,r):e[i]=a},{allOwnKeys:n}),e),_$=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),j$=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},N$=(e,t,r,n)=>{let a,i,o;const c={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),i=a.length;i-- >0;)o=a[i],(!n||n(o,e,t))&&!c[o]&&(t[o]=e[o],c[o]=!0);e=r!==!1&&K2(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},D$=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},S$=e=>{if(!e)return null;if(cu(e))return e;let t=e.length;if(!dF(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},E$=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&K2(Uint8Array)),T$=(e,t)=>{const n=(e&&e[Wx]).call(e);let a;for(;(a=n.next())&&!a.done;){const i=a.value;t.call(e,i[0],i[1])}},C$=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},A$=Si("HTMLFormElement"),k$=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),oD=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),F$=Si("RegExp"),mF=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};ch(r,(a,i)=>{let o;(o=t(a,i,e))!==!1&&(n[i]=o||a)}),Object.defineProperties(e,n)},O$=e=>{mF(e,(t,r)=>{if(aa(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(aa(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},P$=(e,t)=>{const r={},n=a=>{a.forEach(i=>{r[i]=!0})};return cu(e)?n(e):n(String(e).split(t)),r},I$=()=>{},U$=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function R$(e){return!!(e&&aa(e.append)&&e[lF]==="FormData"&&e[Wx])}const M$=e=>{const t=new Array(10),r=(n,a)=>{if(oh(n)){if(t.indexOf(n)>=0)return;if(sh(n))return n;if(!("toJSON"in n)){t[a]=n;const i=cu(n)?[]:{};return ch(n,(o,c)=>{const l=r(o,a+1);!Md(l)&&(i[c]=l)}),t[a]=void 0,i}}return n};return r(e,0)},B$=Si("AsyncFunction"),L$=e=>e&&(oh(e)||aa(e))&&aa(e.then)&&aa(e.catch),pF=((e,t)=>e?setImmediate:t?((r,n)=>(Zo.addEventListener("message",({source:a,data:i})=>{a===Zo&&i===r&&n.length&&n.shift()()},!1),a=>{n.push(a),Zo.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",aa(Zo.postMessage)),$$=typeof queueMicrotask<"u"?queueMicrotask.bind(Zo):typeof process<"u"&&process.nextTick||pF,W$=e=>e!=null&&aa(e[Wx]),De={isArray:cu,isArrayBuffer:uF,isBuffer:sh,isFormData:m$,isArrayBufferView:i$,isString:s$,isNumber:dF,isBoolean:o$,isObject:oh,isPlainObject:Mm,isEmptyObject:c$,isReadableStream:x$,isRequest:g$,isResponse:v$,isHeaders:y$,isUndefined:Md,isDate:l$,isFile:u$,isBlob:d$,isRegExp:F$,isFunction:aa,isStream:h$,isURLSearchParams:p$,isTypedArray:E$,isFileList:f$,forEach:ch,merge:Pb,extend:w$,trim:b$,stripBOM:_$,inherits:j$,toFlatObject:N$,kindOf:zx,kindOfTest:Si,endsWith:D$,toArray:S$,forEachEntry:T$,matchAll:C$,isHTMLForm:A$,hasOwnProperty:oD,hasOwnProp:oD,reduceDescriptors:mF,freezeMethods:O$,toObjectSet:P$,toCamelCase:k$,noop:I$,toFiniteNumber:U$,findKey:fF,global:Zo,isContextDefined:hF,isSpecCompliantForm:R$,toJSONObject:M$,isAsyncFn:B$,isThenable:L$,setImmediate:pF,asap:$$,isIterable:W$};function pt(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}De.inherits(pt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:De.toJSONObject(this.config),code:this.code,status:this.status}}});const xF=pt.prototype,gF={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{gF[e]={value:e}});Object.defineProperties(pt,gF);Object.defineProperty(xF,"isAxiosError",{value:!0});pt.from=(e,t,r,n,a,i)=>{const o=Object.create(xF);return De.toFlatObject(e,o,function(l){return l!==Error.prototype},c=>c!=="isAxiosError"),pt.call(o,e.message,t,r,n,a),o.cause=e,o.name=e.name,i&&Object.assign(o,i),o};const z$=null;function Ib(e){return De.isPlainObject(e)||De.isArray(e)}function vF(e){return De.endsWith(e,"[]")?e.slice(0,-2):e}function cD(e,t,r){return e?e.concat(t).map(function(a,i){return a=vF(a),!r&&i?"["+a+"]":a}).join(r?".":""):t}function q$(e){return De.isArray(e)&&!e.some(Ib)}const H$=De.toFlatObject(De,{},null,function(t){return/^is[A-Z]/.test(t)});function Hx(e,t,r){if(!De.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=De.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,g){return!De.isUndefined(g[p])});const n=r.metaTokens,a=r.visitor||d,i=r.dots,o=r.indexes,l=(r.Blob||typeof Blob<"u"&&Blob)&&De.isSpecCompliantForm(t);if(!De.isFunction(a))throw new TypeError("visitor must be a function");function u(x){if(x===null)return"";if(De.isDate(x))return x.toISOString();if(De.isBoolean(x))return x.toString();if(!l&&De.isBlob(x))throw new pt("Blob is not supported. Use a Buffer instead.");return De.isArrayBuffer(x)||De.isTypedArray(x)?l&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function d(x,p,g){let v=x;if(x&&!g&&typeof x=="object"){if(De.endsWith(p,"{}"))p=n?p:p.slice(0,-2),x=JSON.stringify(x);else if(De.isArray(x)&&q$(x)||(De.isFileList(x)||De.endsWith(p,"[]"))&&(v=De.toArray(x)))return p=vF(p),v.forEach(function(b,_){!(De.isUndefined(b)||b===null)&&t.append(o===!0?cD([p],_,i):o===null?p:p+"[]",u(b))}),!1}return Ib(x)?!0:(t.append(cD(g,p,i),u(x)),!1)}const f=[],h=Object.assign(H$,{defaultVisitor:d,convertValue:u,isVisitable:Ib});function m(x,p){if(!De.isUndefined(x)){if(f.indexOf(x)!==-1)throw Error("Circular reference detected in "+p.join("."));f.push(x),De.forEach(x,function(v,y){(!(De.isUndefined(v)||v===null)&&a.call(t,v,De.isString(y)?y.trim():y,p,h))===!0&&m(v,p?p.concat(y):[y])}),f.pop()}}if(!De.isObject(e))throw new TypeError("data must be an object");return m(e),t}function lD(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Y2(e,t){this._pairs=[],e&&Hx(e,this,t)}const yF=Y2.prototype;yF.append=function(t,r){this._pairs.push([t,r])};yF.toString=function(t){const r=t?function(n){return t.call(this,n,lD)}:lD;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function V$(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function bF(e,t,r){if(!t)return e;const n=r&&r.encode||V$;De.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let i;if(a?i=a(t,r):i=De.isURLSearchParams(t)?t.toString():new Y2(t,r).toString(n),i){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class uD{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){De.forEach(this.handlers,function(n){n!==null&&t(n)})}}const wF={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},G$=typeof URLSearchParams<"u"?URLSearchParams:Y2,X$=typeof FormData<"u"?FormData:null,K$=typeof Blob<"u"?Blob:null,Y$={isBrowser:!0,classes:{URLSearchParams:G$,FormData:X$,Blob:K$},protocols:["http","https","file","blob","url","data"]},Z2=typeof window<"u"&&typeof document<"u",Ub=typeof navigator=="object"&&navigator||void 0,Z$=Z2&&(!Ub||["ReactNative","NativeScript","NS"].indexOf(Ub.product)<0),J$=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Q$=Z2&&window.location.href||"http://localhost",e7=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Z2,hasStandardBrowserEnv:Z$,hasStandardBrowserWebWorkerEnv:J$,navigator:Ub,origin:Q$},Symbol.toStringTag,{value:"Module"})),An={...e7,...Y$};function t7(e,t){return Hx(e,new An.classes.URLSearchParams,{visitor:function(r,n,a,i){return An.isNode&&De.isBuffer(r)?(this.append(n,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function r7(e){return De.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function n7(e){const t={},r=Object.keys(e);let n;const a=r.length;let i;for(n=0;n<a;n++)i=r[n],t[i]=e[i];return t}function _F(e){function t(r,n,a,i){let o=r[i++];if(o==="__proto__")return!0;const c=Number.isFinite(+o),l=i>=r.length;return o=!o&&De.isArray(a)?a.length:o,l?(De.hasOwnProp(a,o)?a[o]=[a[o],n]:a[o]=n,!c):((!a[o]||!De.isObject(a[o]))&&(a[o]=[]),t(r,n,a[o],i)&&De.isArray(a[o])&&(a[o]=n7(a[o])),!c)}if(De.isFormData(e)&&De.isFunction(e.entries)){const r={};return De.forEachEntry(e,(n,a)=>{t(r7(n),a,r,0)}),r}return null}function a7(e,t,r){if(De.isString(e))try{return(t||JSON.parse)(e),De.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const lh={transitional:wF,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,i=De.isObject(t);if(i&&De.isHTMLForm(t)&&(t=new FormData(t)),De.isFormData(t))return a?JSON.stringify(_F(t)):t;if(De.isArrayBuffer(t)||De.isBuffer(t)||De.isStream(t)||De.isFile(t)||De.isBlob(t)||De.isReadableStream(t))return t;if(De.isArrayBufferView(t))return t.buffer;if(De.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let c;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return t7(t,this.formSerializer).toString();if((c=De.isFileList(t))||n.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Hx(c?{"files[]":t}:t,l&&new l,this.formSerializer)}}return i||a?(r.setContentType("application/json",!1),a7(t)):t}],transformResponse:[function(t){const r=this.transitional||lh.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(De.isResponse(t)||De.isReadableStream(t))return t;if(t&&De.isString(t)&&(n&&!this.responseType||a)){const o=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t)}catch(c){if(o)throw c.name==="SyntaxError"?pt.from(c,pt.ERR_BAD_RESPONSE,this,null,this.response):c}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:An.classes.FormData,Blob:An.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};De.forEach(["delete","get","head","post","put","patch"],e=>{lh.headers[e]={}});const i7=De.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),s7=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(o){a=o.indexOf(":"),r=o.substring(0,a).trim().toLowerCase(),n=o.substring(a+1).trim(),!(!r||t[r]&&i7[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},dD=Symbol("internals");function Hu(e){return e&&String(e).trim().toLowerCase()}function Bm(e){return e===!1||e==null?e:De.isArray(e)?e.map(Bm):String(e)}function o7(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const c7=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function hv(e,t,r,n,a){if(De.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!De.isString(t)){if(De.isString(n))return t.indexOf(n)!==-1;if(De.isRegExp(n))return n.test(t)}}function l7(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function u7(e,t){const r=De.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,i,o){return this[n].call(this,t,a,i,o)},configurable:!0})})}let ia=class{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function i(c,l,u){const d=Hu(l);if(!d)throw new Error("header name must be a non-empty string");const f=De.findKey(a,d);(!f||a[f]===void 0||u===!0||u===void 0&&a[f]!==!1)&&(a[f||l]=Bm(c))}const o=(c,l)=>De.forEach(c,(u,d)=>i(u,d,l));if(De.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(De.isString(t)&&(t=t.trim())&&!c7(t))o(s7(t),r);else if(De.isObject(t)&&De.isIterable(t)){let c={},l,u;for(const d of t){if(!De.isArray(d))throw TypeError("Object iterator must return a key-value pair");c[u=d[0]]=(l=c[u])?De.isArray(l)?[...l,d[1]]:[l,d[1]]:d[1]}o(c,r)}else t!=null&&i(r,t,n);return this}get(t,r){if(t=Hu(t),t){const n=De.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return o7(a);if(De.isFunction(r))return r.call(this,a,n);if(De.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Hu(t),t){const n=De.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||hv(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function i(o){if(o=Hu(o),o){const c=De.findKey(n,o);c&&(!r||hv(n,n[c],c,r))&&(delete n[c],a=!0)}}return De.isArray(t)?t.forEach(i):i(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const i=r[n];(!t||hv(this,this[i],i,t,!0))&&(delete this[i],a=!0)}return a}normalize(t){const r=this,n={};return De.forEach(this,(a,i)=>{const o=De.findKey(n,i);if(o){r[o]=Bm(a),delete r[i];return}const c=t?l7(i):String(i).trim();c!==i&&delete r[i],r[c]=Bm(a),n[c]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return De.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&De.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[dD]=this[dD]={accessors:{}}).accessors,a=this.prototype;function i(o){const c=Hu(o);n[c]||(u7(a,o),n[c]=!0)}return De.isArray(t)?t.forEach(i):i(t),this}};ia.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);De.reduceDescriptors(ia.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});De.freezeMethods(ia);function mv(e,t){const r=this||lh,n=t||r,a=ia.from(n.headers);let i=n.data;return De.forEach(e,function(c){i=c.call(r,i,a.normalize(),t?t.status:void 0)}),a.normalize(),i}function jF(e){return!!(e&&e.__CANCEL__)}function lu(e,t,r){pt.call(this,e??"canceled",pt.ERR_CANCELED,t,r),this.name="CanceledError"}De.inherits(lu,pt,{__CANCEL__:!0});function NF(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new pt("Request failed with status code "+r.status,[pt.ERR_BAD_REQUEST,pt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function d7(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function f7(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,i=0,o;return t=t!==void 0?t:1e3,function(l){const u=Date.now(),d=n[i];o||(o=u),r[a]=l,n[a]=u;let f=i,h=0;for(;f!==a;)h+=r[f++],f=f%e;if(a=(a+1)%e,a===i&&(i=(i+1)%e),u-o<t)return;const m=d&&u-d;return m?Math.round(h*1e3/m):void 0}}function h7(e,t){let r=0,n=1e3/t,a,i;const o=(u,d=Date.now())=>{r=d,a=null,i&&(clearTimeout(i),i=null),e(...u)};return[(...u)=>{const d=Date.now(),f=d-r;f>=n?o(u,d):(a=u,i||(i=setTimeout(()=>{i=null,o(a)},n-f)))},()=>a&&o(a)]}const Xm=(e,t,r=3)=>{let n=0;const a=f7(50,250);return h7(i=>{const o=i.loaded,c=i.lengthComputable?i.total:void 0,l=o-n,u=a(l),d=o<=c;n=o;const f={loaded:o,total:c,progress:c?o/c:void 0,bytes:l,rate:u||void 0,estimated:u&&c&&d?(c-o)/u:void 0,event:i,lengthComputable:c!=null,[t?"download":"upload"]:!0};e(f)},r)},fD=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},hD=e=>(...t)=>De.asap(()=>e(...t)),m7=An.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,An.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(An.origin),An.navigator&&/(msie|trident)/i.test(An.navigator.userAgent)):()=>!0,p7=An.hasStandardBrowserEnv?{write(e,t,r,n,a,i){const o=[e+"="+encodeURIComponent(t)];De.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),De.isString(n)&&o.push("path="+n),De.isString(a)&&o.push("domain="+a),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function x7(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function g7(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function DF(e,t,r){let n=!x7(t);return e&&(n||r==!1)?g7(e,t):t}const mD=e=>e instanceof ia?{...e}:e;function uc(e,t){t=t||{};const r={};function n(u,d,f,h){return De.isPlainObject(u)&&De.isPlainObject(d)?De.merge.call({caseless:h},u,d):De.isPlainObject(d)?De.merge({},d):De.isArray(d)?d.slice():d}function a(u,d,f,h){if(De.isUndefined(d)){if(!De.isUndefined(u))return n(void 0,u,f,h)}else return n(u,d,f,h)}function i(u,d){if(!De.isUndefined(d))return n(void 0,d)}function o(u,d){if(De.isUndefined(d)){if(!De.isUndefined(u))return n(void 0,u)}else return n(void 0,d)}function c(u,d,f){if(f in t)return n(u,d);if(f in e)return n(void 0,u)}const l={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:c,headers:(u,d,f)=>a(mD(u),mD(d),f,!0)};return De.forEach(Object.keys({...e,...t}),function(d){const f=l[d]||a,h=f(e[d],t[d],d);De.isUndefined(h)&&f!==c||(r[d]=h)}),r}const SF=e=>{const t=uc({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:i,headers:o,auth:c}=t;t.headers=o=ia.from(o),t.url=bF(DF(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),c&&o.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):"")));let l;if(De.isFormData(r)){if(An.hasStandardBrowserEnv||An.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){const[u,...d]=l?l.split(";").map(f=>f.trim()).filter(Boolean):[];o.setContentType([u||"multipart/form-data",...d].join("; "))}}if(An.hasStandardBrowserEnv&&(n&&De.isFunction(n)&&(n=n(t)),n||n!==!1&&m7(t.url))){const u=a&&i&&p7.read(i);u&&o.set(a,u)}return t},v7=typeof XMLHttpRequest<"u",y7=v7&&function(e){return new Promise(function(r,n){const a=SF(e);let i=a.data;const o=ia.from(a.headers).normalize();let{responseType:c,onUploadProgress:l,onDownloadProgress:u}=a,d,f,h,m,x;function p(){m&&m(),x&&x(),a.cancelToken&&a.cancelToken.unsubscribe(d),a.signal&&a.signal.removeEventListener("abort",d)}let g=new XMLHttpRequest;g.open(a.method.toUpperCase(),a.url,!0),g.timeout=a.timeout;function v(){if(!g)return;const b=ia.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),w={data:!c||c==="text"||c==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:b,config:e,request:g};NF(function(N){r(N),p()},function(N){n(N),p()},w),g=null}"onloadend"in g?g.onloadend=v:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(v)},g.onabort=function(){g&&(n(new pt("Request aborted",pt.ECONNABORTED,e,g)),g=null)},g.onerror=function(){n(new pt("Network Error",pt.ERR_NETWORK,e,g)),g=null},g.ontimeout=function(){let _=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const w=a.transitional||wF;a.timeoutErrorMessage&&(_=a.timeoutErrorMessage),n(new pt(_,w.clarifyTimeoutError?pt.ETIMEDOUT:pt.ECONNABORTED,e,g)),g=null},i===void 0&&o.setContentType(null),"setRequestHeader"in g&&De.forEach(o.toJSON(),function(_,w){g.setRequestHeader(w,_)}),De.isUndefined(a.withCredentials)||(g.withCredentials=!!a.withCredentials),c&&c!=="json"&&(g.responseType=a.responseType),u&&([h,x]=Xm(u,!0),g.addEventListener("progress",h)),l&&g.upload&&([f,m]=Xm(l),g.upload.addEventListener("progress",f),g.upload.addEventListener("loadend",m)),(a.cancelToken||a.signal)&&(d=b=>{g&&(n(!b||b.type?new lu(null,e,g):b),g.abort(),g=null)},a.cancelToken&&a.cancelToken.subscribe(d),a.signal&&(a.signal.aborted?d():a.signal.addEventListener("abort",d)));const y=d7(a.url);if(y&&An.protocols.indexOf(y)===-1){n(new pt("Unsupported protocol "+y+":",pt.ERR_BAD_REQUEST,e));return}g.send(i||null)})},b7=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const i=function(u){if(!a){a=!0,c();const d=u instanceof Error?u:this.reason;n.abort(d instanceof pt?d:new lu(d instanceof Error?d.message:d))}};let o=t&&setTimeout(()=>{o=null,i(new pt(`timeout ${t} of ms exceeded`,pt.ETIMEDOUT))},t);const c=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),e=null)};e.forEach(u=>u.addEventListener("abort",i));const{signal:l}=n;return l.unsubscribe=()=>De.asap(c),l}},w7=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},_7=async function*(e,t){for await(const r of j7(e))yield*w7(r,t)},j7=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},pD=(e,t,r,n)=>{const a=_7(e,t);let i=0,o,c=l=>{o||(o=!0,n&&n(l))};return new ReadableStream({async pull(l){try{const{done:u,value:d}=await a.next();if(u){c(),l.close();return}let f=d.byteLength;if(r){let h=i+=f;r(h)}l.enqueue(new Uint8Array(d))}catch(u){throw c(u),u}},cancel(l){return c(l),a.return()}},{highWaterMark:2})},Vx=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",EF=Vx&&typeof ReadableStream=="function",N7=Vx&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),TF=(e,...t)=>{try{return!!e(...t)}catch{return!1}},D7=EF&&TF(()=>{let e=!1;const t=new Request(An.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),xD=64*1024,Rb=EF&&TF(()=>De.isReadableStream(new Response("").body)),Km={stream:Rb&&(e=>e.body)};Vx&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Km[t]&&(Km[t]=De.isFunction(e[t])?r=>r[t]():(r,n)=>{throw new pt(`Response type '${t}' is not supported`,pt.ERR_NOT_SUPPORT,n)})})})(new Response);const S7=async e=>{if(e==null)return 0;if(De.isBlob(e))return e.size;if(De.isSpecCompliantForm(e))return(await new Request(An.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(De.isArrayBufferView(e)||De.isArrayBuffer(e))return e.byteLength;if(De.isURLSearchParams(e)&&(e=e+""),De.isString(e))return(await N7(e)).byteLength},E7=async(e,t)=>{const r=De.toFiniteNumber(e.getContentLength());return r??S7(t)},T7=Vx&&(async e=>{let{url:t,method:r,data:n,signal:a,cancelToken:i,timeout:o,onDownloadProgress:c,onUploadProgress:l,responseType:u,headers:d,withCredentials:f="same-origin",fetchOptions:h}=SF(e);u=u?(u+"").toLowerCase():"text";let m=b7([a,i&&i.toAbortSignal()],o),x;const p=m&&m.unsubscribe&&(()=>{m.unsubscribe()});let g;try{if(l&&D7&&r!=="get"&&r!=="head"&&(g=await E7(d,n))!==0){let w=new Request(t,{method:"POST",body:n,duplex:"half"}),j;if(De.isFormData(n)&&(j=w.headers.get("content-type"))&&d.setContentType(j),w.body){const[N,D]=fD(g,Xm(hD(l)));n=pD(w.body,xD,N,D)}}De.isString(f)||(f=f?"include":"omit");const v="credentials"in Request.prototype;x=new Request(t,{...h,signal:m,method:r.toUpperCase(),headers:d.normalize().toJSON(),body:n,duplex:"half",credentials:v?f:void 0});let y=await fetch(x,h);const b=Rb&&(u==="stream"||u==="response");if(Rb&&(c||b&&p)){const w={};["status","statusText","headers"].forEach(S=>{w[S]=y[S]});const j=De.toFiniteNumber(y.headers.get("content-length")),[N,D]=c&&fD(j,Xm(hD(c),!0))||[];y=new Response(pD(y.body,xD,N,()=>{D&&D(),p&&p()}),w)}u=u||"text";let _=await Km[De.findKey(Km,u)||"text"](y,e);return!b&&p&&p(),await new Promise((w,j)=>{NF(w,j,{data:_,headers:ia.from(y.headers),status:y.status,statusText:y.statusText,config:e,request:x})})}catch(v){throw p&&p(),v&&v.name==="TypeError"&&/Load failed|fetch/i.test(v.message)?Object.assign(new pt("Network Error",pt.ERR_NETWORK,e,x),{cause:v.cause||v}):pt.from(v,v&&v.code,e,x)}}),Mb={http:z$,xhr:y7,fetch:T7};De.forEach(Mb,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const gD=e=>`- ${e}`,C7=e=>De.isFunction(e)||e===null||e===!1,CF={getAdapter:e=>{e=De.isArray(e)?e:[e];const{length:t}=e;let r,n;const a={};for(let i=0;i<t;i++){r=e[i];let o;if(n=r,!C7(r)&&(n=Mb[(o=String(r)).toLowerCase()],n===void 0))throw new pt(`Unknown adapter '${o}'`);if(n)break;a[o||"#"+i]=n}if(!n){const i=Object.entries(a).map(([c,l])=>`adapter ${c} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=t?i.length>1?`since :
`+i.map(gD).join(`
`):" "+gD(i[0]):"as no adapter specified";throw new pt("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:Mb};function pv(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new lu(null,e)}function vD(e){return pv(e),e.headers=ia.from(e.headers),e.data=mv.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),CF.getAdapter(e.adapter||lh.adapter)(e).then(function(n){return pv(e),n.data=mv.call(e,e.transformResponse,n),n.headers=ia.from(n.headers),n},function(n){return jF(n)||(pv(e),n&&n.response&&(n.response.data=mv.call(e,e.transformResponse,n.response),n.response.headers=ia.from(n.response.headers))),Promise.reject(n)})}const AF="1.11.0",Gx={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Gx[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const yD={};Gx.transitional=function(t,r,n){function a(i,o){return"[Axios v"+AF+"] Transitional option '"+i+"'"+o+(n?". "+n:"")}return(i,o,c)=>{if(t===!1)throw new pt(a(o," has been removed"+(r?" in "+r:"")),pt.ERR_DEPRECATED);return r&&!yD[o]&&(yD[o]=!0,console.warn(a(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,o,c):!0}};Gx.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function A7(e,t,r){if(typeof e!="object")throw new pt("options must be an object",pt.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const i=n[a],o=t[i];if(o){const c=e[i],l=c===void 0||o(c,i,e);if(l!==!0)throw new pt("option "+i+" must be "+l,pt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new pt("Unknown option "+i,pt.ERR_BAD_OPTION)}}const Lm={assertOptions:A7,validators:Gx},Ii=Lm.validators;let rc=class{constructor(t){this.defaults=t||{},this.interceptors={request:new uD,response:new uD}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const i=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=uc(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:i}=r;n!==void 0&&Lm.assertOptions(n,{silentJSONParsing:Ii.transitional(Ii.boolean),forcedJSONParsing:Ii.transitional(Ii.boolean),clarifyTimeoutError:Ii.transitional(Ii.boolean)},!1),a!=null&&(De.isFunction(a)?r.paramsSerializer={serialize:a}:Lm.assertOptions(a,{encode:Ii.function,serialize:Ii.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Lm.assertOptions(r,{baseUrl:Ii.spelling("baseURL"),withXsrfToken:Ii.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=i&&De.merge(i.common,i[r.method]);i&&De.forEach(["delete","get","head","post","put","patch","common"],x=>{delete i[x]}),r.headers=ia.concat(o,i);const c=[];let l=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(r)===!1||(l=l&&p.synchronous,c.unshift(p.fulfilled,p.rejected))});const u=[];this.interceptors.response.forEach(function(p){u.push(p.fulfilled,p.rejected)});let d,f=0,h;if(!l){const x=[vD.bind(this),void 0];for(x.unshift(...c),x.push(...u),h=x.length,d=Promise.resolve(r);f<h;)d=d.then(x[f++],x[f++]);return d}h=c.length;let m=r;for(f=0;f<h;){const x=c[f++],p=c[f++];try{m=x(m)}catch(g){p.call(this,g);break}}try{d=vD.call(this,m)}catch(x){return Promise.reject(x)}for(f=0,h=u.length;f<h;)d=d.then(u[f++],u[f++]);return d}getUri(t){t=uc(this.defaults,t);const r=DF(t.baseURL,t.url,t.allowAbsoluteUrls);return bF(r,t.params,t.paramsSerializer)}};De.forEach(["delete","get","head","options"],function(t){rc.prototype[t]=function(r,n){return this.request(uc(n||{},{method:t,url:r,data:(n||{}).data}))}});De.forEach(["post","put","patch"],function(t){function r(n){return function(i,o,c){return this.request(uc(c||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}rc.prototype[t]=r(),rc.prototype[t+"Form"]=r(!0)});let k7=class kF{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const n=this;this.promise.then(a=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](a);n._listeners=null}),this.promise.then=a=>{let i;const o=new Promise(c=>{n.subscribe(c),i=c}).then(a);return o.cancel=function(){n.unsubscribe(i)},o},t(function(i,o,c){n.reason||(n.reason=new lu(i,o,c),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new kF(function(a){t=a}),cancel:t}}};function F7(e){return function(r){return e.apply(null,r)}}function O7(e){return De.isObject(e)&&e.isAxiosError===!0}const Bb={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Bb).forEach(([e,t])=>{Bb[t]=e});function FF(e){const t=new rc(e),r=cF(rc.prototype.request,t);return De.extend(r,rc.prototype,t,{allOwnKeys:!0}),De.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return FF(uc(e,a))},r}const Sr=FF(lh);Sr.Axios=rc;Sr.CanceledError=lu;Sr.CancelToken=k7;Sr.isCancel=jF;Sr.VERSION=AF;Sr.toFormData=Hx;Sr.AxiosError=pt;Sr.Cancel=Sr.CanceledError;Sr.all=function(t){return Promise.all(t)};Sr.spread=F7;Sr.isAxiosError=O7;Sr.mergeConfig=uc;Sr.AxiosHeaders=ia;Sr.formToJSON=e=>_F(De.isHTMLForm(e)?new FormData(e):e);Sr.getAdapter=CF.getAdapter;Sr.HttpStatusCode=Bb;Sr.default=Sr;const{Axios:bMe,AxiosError:wMe,CanceledError:_Me,isCancel:jMe,CancelToken:NMe,VERSION:DMe,all:SMe,Cancel:EMe,isAxiosError:TMe,spread:CMe,toFormData:AMe,AxiosHeaders:kMe,HttpStatusCode:FMe,formToJSON:OMe,getAdapter:PMe,mergeConfig:IMe}=Sr,bD="http://localhost:8000/";class P7{constructor(){console.log("ApiClient initialized with BASE_URL:",bD),this.client=Sr.create({baseURL:bD,timeout:1e4,headers:{"Content-Type":"application/json"}}),this.client.interceptors.request.use(t=>{const r=this.getToken();return r&&(t.headers.Authorization=`Bearer ${r}`),t},t=>Promise.reject(t)),this.client.interceptors.response.use(t=>t,t=>{var r;return((r=t.response)==null?void 0:r.status)===401&&(this.removeToken(),window.location.href="/login"),Promise.reject(t)})}getToken(){return localStorage.getItem("access_token")}setToken(t){localStorage.setItem("access_token",t)}removeToken(){localStorage.removeItem("access_token"),localStorage.removeItem("user_profile")}getCurrentUser(){const t=localStorage.getItem("user_profile");return t?JSON.parse(t):null}setCurrentUser(t){localStorage.setItem("user_profile",JSON.stringify(t))}async login(t,r){var n,a,i,o,c,l;try{console.log("Attempting login with:",{email:t,baseURL:this.client.defaults.baseURL});const u=await this.client.post("/api/v1/auth/login",{email:t,password:r});console.log("Login response received:",u.status,u.data);const{access_token:d,user:f}=u.data;return this.setToken(d),this.setCurrentUser(f),console.log("Login successful, token set:",d?"Yes":"No"),{user:f,error:null}}catch(u){return console.error("Login error details:",{status:(n=u.response)==null?void 0:n.status,statusText:(a=u.response)==null?void 0:a.statusText,data:(i=u.response)==null?void 0:i.data,message:u.message,url:(o=u.config)==null?void 0:o.url}),{user:null,error:{message:((l=(c=u.response)==null?void 0:c.data)==null?void 0:l.detail)||u.message||"Login failed"}}}}async register(t,r,n={}){var a,i;try{const o=await this.client.post("/api/v1/auth/register",{email:t,password:r,first_name:n.firstName||"",last_name:n.lastName||"",role:n.role||"sales_rep"}),{access_token:c,user:l}=o.data;return this.setToken(c),this.setCurrentUser(l),console.log("Registration successful, token set:",c?"Yes":"No"),{user:l,error:null}}catch(o){return{user:null,error:{message:((i=(a=o.response)==null?void 0:a.data)==null?void 0:i.detail)||"Registration failed"}}}}async logout(){return this.removeToken(),{error:null}}async microsoftLogin(){try{const{microsoftAuthService:t}=await fl(()=>import("./microsoftAuthService-CE-uUPeH.js"),__vite__mapDeps([])),{token:r,user:n}=await t.initiateMicrosoftLogin();return this.setToken(r),this.setCurrentUser(n),console.log("Microsoft SSO successful, token set:",r?"Yes":"No"),{user:n,error:null}}catch(t){return console.error("Microsoft login error:",t),{user:null,error:{message:t.message||"Microsoft login failed"}}}}async microsoftSilentLogin(t,r){try{const{microsoftAuthService:n}=await fl(()=>import("./microsoftAuthService-CE-uUPeH.js"),__vite__mapDeps([])),{token:a,user:i}=await n.silentSSOLogin(t,r);return this.setToken(a),this.setCurrentUser(i),console.log("Silent SSO successful, token set:",a?"Yes":"No"),{user:i,error:null}}catch(n){return console.error("Silent SSO error:",n),{user:null,error:{message:n.message||"Silent SSO failed"}}}}async get(t){try{return{data:(await this.client.get(t)).data,error:null}}catch(r){return{data:null,error:this.handleError(r)}}}async post(t,r,n={}){try{return{data:(await this.client.post(t,r,n)).data,error:null}}catch(a){return{data:null,error:this.handleError(a)}}}async put(t,r){try{return{data:(await this.client.put(t,r)).data,error:null}}catch(n){return{data:null,error:this.handleError(n)}}}async patch(t,r){try{return{data:(await this.client.patch(t,r)).data,error:null}}catch(n){return{data:null,error:this.handleError(n)}}}async delete(t){try{return{data:(await this.client.delete(t)).data,error:null}}catch(r){return{data:null,error:this.handleError(r)}}}handleError(t){var r,n,a,i;if(t.response){let o="An error occurred";return t.response.status===422&&((r=t.response.data)!=null&&r.detail)?Array.isArray(t.response.data.detail)?o=t.response.data.detail.map(c=>{const l=c.loc?c.loc.join("."):"";return l?`${l}: ${c.msg}`:c.msg}).join(", "):o=t.response.data.detail:(n=t.response.data)!=null&&n.detail?o=t.response.data.detail:(a=t.response.data)!=null&&a.message&&(o=t.response.data.message),{message:o,status:t.response.status,detail:((i=t.response.data)==null?void 0:i.detail)||null}}else return t.request?{message:"No response from server. Please check your connection."}:{message:t.message||"An unexpected error occurred"}}}const be=new P7,Xo={_cachedPermissions:null,_permissionsByCategory:null,_userRole:null,async fetchUserPermissions(){try{console.log(" Fetching fresh permissions from backend...");const{data:e,error:t}=await be.get("/api/v1/auth/me/permissions");return t?(console.error(" Error fetching permissions:",t),null):(console.log(" Fresh permissions received:",e.permissions),this._cachedPermissions=e.permissions||[],this._permissionsByCategory=e.permissions_by_category||{},this._userRole=e.role,e)}catch(e){return console.error(" Failed to fetch user permissions:",e),null}},async getPermissions(){return await this.fetchUserPermissions(),this._cachedPermissions||[]},clearCache(){console.log(" Clearing permission cache"),this._cachedPermissions=null,this._permissionsByCategory=null,this._userRole=null},async hasPermissionAsync(e){return(await this.getPermissions()).includes(e)},hasPermissionSync(e){return this._cachedPermissions?this._cachedPermissions.includes(e):(console.warn("Permissions not loaded yet. Call fetchUserPermissions first."),!1)},staticPermissions:{dashboard:{view_personal:["admin","sales_manager","sales_rep","user"],view_team:["admin","sales_manager"],view_company:["admin"],export_reports:["admin","sales_manager"]},contacts:{view_own:["admin","sales_manager","sales_rep","user"],view_team:["admin","sales_manager"],view_all:["admin"],create:["admin","sales_manager","sales_rep"],edit_own:["admin","sales_manager","sales_rep"],edit_team:["admin","sales_manager"],edit_all:["admin"],delete_own:["admin","sales_manager","sales_rep"],delete_team:["admin","sales_manager"],delete_all:["admin"],import_export:["admin","sales_manager"],merge_duplicates:["admin","sales_manager"]},deals:{view_own:["admin","sales_manager","sales_rep","user"],view_team:["admin","sales_manager"],view_all:["admin"],create:["admin","sales_manager","sales_rep"],edit_own:["admin","sales_manager","sales_rep"],edit_team:["admin","sales_manager"],edit_all:["admin"],delete_own:["admin","sales_manager","sales_rep"],delete_team:["admin","sales_manager"],delete_all:["admin"],move_pipeline_stages:["admin","sales_manager","sales_rep"]},activities:{view_own:["admin","sales_manager","sales_rep","user"],view_team:["admin","sales_manager"],view_all:["admin"],create:["admin","sales_manager","sales_rep"],edit_own:["admin","sales_manager","sales_rep"],edit_team:["admin","sales_manager"],delete_own:["admin","sales_manager","sales_rep"],delete_team:["admin","sales_manager"]},analytics:{view_personal:["admin","sales_manager","sales_rep"],view_team:["admin","sales_manager"],view_company:["admin"],export_reports:["admin","sales_manager"]},settings:{user_management:["admin","sales_manager"],permissions:["admin"],system_config:["admin"],integrations:["admin","sales_manager"],custom_fields:["admin","sales_manager"],email_templates:["admin","sales_manager"],view_own_profile:["admin","sales_manager","sales_rep","user"],edit_own_profile:["admin","sales_manager","sales_rep","user"]}},hasPermission(e,t,r){if(this._cachedPermissions){const n=`${t}.${r}`;return this._cachedPermissions.includes(n)}return!this.staticPermissions[t]||!this.staticPermissions[t][r]?!1:this.staticPermissions[t][r].includes(e)},canViewData(e,t,r,n=[]){switch(e){case"admin":return!0;case"sales_manager":return t===r||n.includes(t);case"sales_rep":case"user":return t===r;default:return!1}},canEditData(e,t,r,n=[]){switch(e){case"admin":return!0;case"sales_manager":return t===r||n.includes(t);case"sales_rep":return t===r;case"user":return t===r;default:return!1}},getAllowedNavigation(e){return{dashboard:this.hasPermission(e,"dashboard","view_personal"),contacts:this.hasPermission(e,"contacts","view_own"),deals:this.hasPermission(e,"deals","view_own"),activities:this.hasPermission(e,"activities","view_own"),analytics:this.hasPermission(e,"analytics","view_personal"),settings:this.hasPermission(e,"settings","view_own_profile")}},getAllowedSettingsSections(e){return{"user-management":this.hasPermission(e,"settings","user_management"),permissions:this.hasPermission(e,"settings","permissions"),integrations:this.hasPermission(e,"settings","integrations"),"custom-fields":this.hasPermission(e,"settings","custom_fields"),"email-templates":this.hasPermission(e,"settings","email_templates"),"system-config":this.hasPermission(e,"settings","system_config")}},getRoleLevel(e){return{user:1,sales_rep:2,sales_manager:3,admin:4}[e]||0},canManageRole(e,t){return this.getRoleLevel(e)>this.getRoleLevel(t)}},OF=R.createContext({}),Pt=()=>{const e=R.useContext(OF);if(!e)throw new Error("useAuth must be used within AuthProvider");return e},I7=({children:e})=>{const[t,r]=R.useState(null),[n,a]=R.useState(null),[i,o]=R.useState(!0),[c,l]=R.useState(""),[u,d]=R.useState([]);R.useEffect(()=>{(async()=>{const S=be.getToken(),T=be.getCurrentUser();S&&T&&(r(T),a(T),await f()),o(!1)})()},[]);const f=async()=>{try{console.log(" Loading user permissions...");const D=await Xo.fetchUserPermissions();if(console.log(" Permissions data received:",D),D){const S=D.permissions||[];console.log(" Setting permissions:",S),console.log(" Number of permissions:",S.length),d(S),console.log(" Permissions set successfully!")}else console.warn(" No permissions data received")}catch(D){console.error(" Failed to load permissions:",D)}},N={user:t,userProfile:n,loading:i,authError:c,permissions:u,signIn:async(D,S)=>{try{l(""),o(!0);const{user:T,error:A}=await be.login(D,S);if(A)return l(A.message),{error:A};if(T)return r(T),a(T),await f(),{user:T,userProfile:T}}catch{const A="Sign in failed. Please try again.";return l(A),{error:{message:A}}}finally{o(!1)}},signUp:async(D,S,T={})=>{try{l(""),o(!0);const{user:A,error:E}=await be.register(D,S,T);if(E)return l(E.message),{error:E};if(A)return r(A),a(A),await f(),{user:A,userProfile:A}}catch{const E="Sign up failed. Please try again.";return l(E),{error:{message:E}}}finally{o(!1)}},signInWithMicrosoft:async()=>{try{l(""),o(!0);const{user:D,error:S}=await be.microsoftLogin();if(S)return l(S.message),{error:S};if(D)return r(D),a(D),await f(),{user:D,userProfile:D}}catch(D){const S=D.message||"Microsoft sign-in failed. Please try again.";return l(S),{error:{message:S}}}finally{o(!1)}},attemptSilentSSO:async()=>{try{const{microsoftAuthService:D}=await fl(()=>import("./microsoftAuthService-CE-uUPeH.js"),__vite__mapDeps([]));return D.shouldAttemptSharePointSSO()?(console.log(" Attempting silent SSO..."),console.log(" Silent SSO not fully implemented - SharePoint context integration needed"),{user:null,error:null}):(console.log("Silent SSO not requested"),{user:null,error:null})}catch(D){return console.error("Silent SSO error:",D),{user:null,error:null}}},signOut:async()=>{try{await be.logout(),r(null),a(null),d([]),l(""),Xo.clearCache()}catch(D){console.error("Sign out error:",D)}},getUserProfile:async D=>{const S=be.getCurrentUser();return S&&S.id===D?S:null},updateUserProfile:async(D,S)=>{try{const{data:T,error:A}=await be.patch(`/users/${D}`,S);return A?{data:null,error:A}:(be.setCurrentUser(T),r(T),a(T),{data:T,error:null})}catch{return{data:null,error:{message:"Failed to update profile"}}}},clearAuthError:()=>l(""),hasPermission:D=>u.includes(D),hasAnyPermission:D=>D.some(S=>u.includes(S)),loadUserPermissions:f,refreshPermissions:async()=>(console.log(" Manually refreshing permissions..."),await f(),u)};return s.jsx(OF.Provider,{value:N,children:e})},PF=R.createContext({theme:"light",toggleTheme:()=>{}}),U7=({children:e})=>{const t=()=>{try{const i=localStorage.getItem("theme");if(i)return i;if(typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches)return"dark"}catch{}return"light"},[r,n]=R.useState(t);R.useEffect(()=>{const i=window.document.documentElement;r==="dark"?i.classList.add("dark"):i.classList.remove("dark");try{i.setAttribute("data-theme",r),localStorage.setItem("theme",r)}catch{}},[r]);const a=()=>n(i=>i==="light"?"dark":"light");return s.jsx(PF.Provider,{value:{theme:r,toggleTheme:a},children:e})},R7=()=>{const{pathname:e}=V2();return R.useEffect(()=>{window.scrollTo(0,0)},[e]),null};function G({name:e,size:t=24,color:r="currentColor",className:n="",strokeWidth:a=2,...i}){var c;const o=(c=ZL)==null?void 0:c[e];return o?s.jsx(o,{size:t,color:r,strokeWidth:a,className:n,...i}):s.jsx(YL,{size:t,color:"gray",strokeWidth:a,className:n,...i})}let M7=class extends ge.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,r){console.log("Error caught by ErrorBoundary:",t,r)}render(){var t,r;return(t=this.state)!=null&&t.hasError?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-neutral-50",children:s.jsxs("div",{className:"text-center p-8 max-w-md",children:[s.jsx("div",{className:"flex justify-center items-center mb-2",children:s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"42px",height:"42px",viewBox:"0 0 32 33",fill:"none",children:[s.jsx("path",{d:"M16 28.5C22.6274 28.5 28 23.1274 28 16.5C28 9.87258 22.6274 4.5 16 4.5C9.37258 4.5 4 9.87258 4 16.5C4 23.1274 9.37258 28.5 16 28.5Z",stroke:"#343330","stroke-width":"2","stroke-miterlimit":"10"}),s.jsx("path",{d:"M11.5 15.5C12.3284 15.5 13 14.8284 13 14C13 13.1716 12.3284 12.5 11.5 12.5C10.6716 12.5 10 13.1716 10 14C10 14.8284 10.6716 15.5 11.5 15.5Z",fill:"#343330"}),s.jsx("path",{d:"M20.5 15.5C21.3284 15.5 22 14.8284 22 14C22 13.1716 21.3284 12.5 20.5 12.5C19.6716 12.5 19 13.1716 19 14C19 14.8284 19.6716 15.5 20.5 15.5Z",fill:"#343330"}),s.jsx("path",{d:"M21 22.5C19.9625 20.7062 18.2213 19.5 16 19.5C13.7787 19.5 12.0375 20.7062 11 22.5",stroke:"#343330","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})]})}),s.jsxs("div",{className:"flex flex-col gap-1 text-center",children:[s.jsx("h1",{className:"text-2xl font-medium text-neutral-800",children:"Something went wrong"}),s.jsx("p",{className:"text-neutral-600 text-base w-8/12 mx-auto",children:"We encountered an unexpected error while processing your request."})]}),s.jsx("div",{className:"flex justify-center items-center mt-6",children:s.jsxs("button",{onClick:()=>{window.location.href="/"},className:"bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded flex items-center gap-2 transition-colors duration-200 shadow-sm",children:[s.jsx(G,{name:"ArrowLeft",size:18,color:"#fff"}),"Back"]})})]})}):(r=this.props)==null?void 0:r.children}};const Zn=({children:e,requiredRoles:t=[],requiredPermission:r=null,requiredPermissions:n=[]})=>{const{user:a,loading:i,hasPermission:o,hasAnyPermission:c,permissions:l}=Pt();return console.log(" ProtectedRoute check:",{loading:i,user:a==null?void 0:a.email,permissions:l,requiredPermission:r,requiredPermissions:n,requiredRoles:t}),i?s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):a?t.length>0&&!t.includes(a.role)?s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsxs("div",{className:"text-center p-8",children:[s.jsx(G,{name:"Lock",size:64,className:"text-text-tertiary mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:"Access Denied"}),s.jsx("p",{className:"text-text-secondary",children:"You don't have permission to access this page."}),s.jsxs("p",{className:"text-text-tertiary text-sm mt-2",children:["Required roles: ",t.join(", ")]})]})}):r&&!o(r)?s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsxs("div",{className:"text-center p-8",children:[s.jsx(G,{name:"Shield",size:64,className:"text-text-tertiary mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:"Insufficient Permissions"}),s.jsx("p",{className:"text-text-secondary",children:"You don't have permission to perform this action."}),s.jsxs("p",{className:"text-text-tertiary text-sm mt-2",children:["Required permission: ",r]})]})}):n&&n.length>0&&!c(n)?s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsxs("div",{className:"text-center p-8",children:[s.jsx(G,{name:"Shield",size:64,className:"text-text-tertiary mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:"Insufficient Permissions"}),s.jsx("p",{className:"text-text-secondary",children:"You don't have permission to access this page."}),s.jsxs("p",{className:"text-text-tertiary text-sm mt-2",children:["Required one of: ",n.join(", ")]})]})}):e:s.jsx(GL,{to:"/login",replace:!0})},wD=()=>{const[e,t]=R.useState(""),[r,n]=R.useState(""),[a,i]=R.useState(!1),[o,c]=R.useState(!1),[l,u]=R.useState(!1),{signIn:d,signInWithMicrosoft:f,authError:h,clearAuthError:m}=Pt(),x=Os(),[p]=ah(),g=async b=>{b==null||b.preventDefault(),i(!0),m();const{user:_,error:w}=await d(e,r);_&&!w&&x("/sales-dashboard"),i(!1)},v=async()=>{c(!0),m();try{const b="http://localhost:8000/".replace(/\/$/,""),_=await fetch(`${b}/api/v1/auth/microsoft/login`);if(!_.ok)throw new Error("Failed to get Microsoft login URL");const{auth_url:w}=await _.json();window.location.href=w}catch(b){console.error(" Microsoft login failed:",b),c(!1)}},y=async b=>{i(!0),m();const _={admin:{email:"aravind@hibizsolutions.com",password:"12345"},sales_manager:{email:"peter@gmail.com",password:"12345"},sales_rep:{email:"steve@gmail.com",password:"12345"},user:{email:"tony@gmail.com",password:"12345"}},w=_==null?void 0:_[b];if(w){t(w==null?void 0:w.email),n(w==null?void 0:w.password);const{user:j,error:N}=await d(w==null?void 0:w.email,w==null?void 0:w.password);j&&!N&&x("/sales-dashboard")}i(!1)};return R.useEffect(()=>{if(p.get("auto")==="microsoft"){console.log(" Auto-login detected: Redirecting to Microsoft...");const _=async()=>{try{const w="http://localhost:8000/".replace(/\/$/,""),j=await fetch(`${w}/api/v1/auth/microsoft/login`);if(!j.ok)throw new Error("Failed to get Microsoft login URL");const{auth_url:N}=await j.json();console.log(" Redirecting to Microsoft authentication..."),window.location.href=N}catch(w){console.error(" Auto-login failed:",w),u(!1)}};u(!0),_()}},[p]),s.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary-50 to-blue-50 py-12 px-4 sm:px-6 lg:px-8",children:[l&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsx("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-md mx-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-primary mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Signing you in..."}),s.jsx("p",{className:"text-text-secondary",children:"Connecting with Microsoft to authenticate your account"})]})})}),s.jsxs("div",{className:"max-w-md w-full",children:[s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("div",{className:"w-16 h-16 bg-primary rounded-xl flex items-center justify-center mx-auto mb-4",children:s.jsx(G,{name:"BarChart3",size:28,className:"text-white"})}),s.jsx("h2",{className:"text-3xl font-bold text-text-primary",children:"Welcome back"}),s.jsx("p",{className:"text-text-secondary mt-2",children:"Sign in to your SalesFlow account"})]}),s.jsxs("div",{className:"mt-6",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-0 flex items-center",children:s.jsx("div",{className:"w-full border-t border-border"})}),s.jsx("div",{className:"relative flex justify-center text-sm",children:s.jsx("span",{className:"px-2 bg-background text-text-secondary",children:"Quick Demo Access"})})]}),s.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-3",children:[s.jsxs("button",{type:"button",onClick:()=>y("admin"),disabled:a,className:"flex items-center justify-center px-3 py-2 border border-border rounded-lg text-sm text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-colors duration-150 disabled:opacity-50",children:[s.jsx(G,{name:"Crown",size:16,className:"mr-2"}),"Admin Demo"]}),s.jsxs("button",{type:"button",onClick:()=>y("sales_manager"),disabled:a,className:"flex items-center justify-center px-3 py-2 border border-border rounded-lg text-sm text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-colors duration-150 disabled:opacity-50",children:[s.jsx(G,{name:"Users",size:16,className:"mr-2"}),"Manager Demo"]}),s.jsxs("button",{type:"button",onClick:()=>y("sales_rep"),disabled:a,className:"flex items-center justify-center px-3 py-2 border border-border rounded-lg text-sm text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-colors duration-150 disabled:opacity-50",children:[s.jsx(G,{name:"Target",size:16,className:"mr-2"}),"Sales Rep Demo"]}),s.jsxs("button",{type:"button",onClick:()=>y("user"),disabled:a,className:"flex items-center justify-center px-3 py-2 border border-border rounded-lg text-sm text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-colors duration-150 disabled:opacity-50",children:[s.jsx(G,{name:"User",size:16,className:"mr-2"}),"User Demo"]})]})]}),s.jsxs("div",{className:"relative mb-6",children:[s.jsx("div",{className:"absolute inset-0 flex items-center",children:s.jsx("div",{className:"w-full border-t border-border"})}),s.jsx("div",{className:"relative flex justify-center text-sm",children:s.jsx("span",{className:"bg-white px-2 text-text-secondary",children:"Or sign in manually"})})]}),s.jsxs("form",{className:"space-y-6",onSubmit:g,children:[h&&s.jsxs("div",{className:"bg-error-50 border border-error-200 text-error rounded-lg p-4 flex items-center space-x-2",children:[s.jsx(G,{name:"AlertCircle",size:16,className:"text-error flex-shrink-0"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm",children:h}),s.jsx("button",{type:"button",onClick:()=>{var _;const b=h;(_=navigator.clipboard)==null||_.writeText(b)},className:"text-xs text-error-600 hover:text-error-700 underline mt-1",children:"Copy error message"})]}),s.jsx("button",{type:"button",onClick:m,className:"text-error hover:text-error-600",children:s.jsx(G,{name:"X",size:16})})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-text-primary mb-2",children:"Email address"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"input-field pl-10",placeholder:"Enter your email",value:e,onChange:b=>{var _;return t((_=b==null?void 0:b.target)==null?void 0:_.value)}}),s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(G,{name:"Mail",size:18,className:"text-text-tertiary"})})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-text-primary mb-2",children:"Password"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"input-field pl-10",placeholder:"Enter your password",value:r,onChange:b=>{var _;return n((_=b==null?void 0:b.target)==null?void 0:_.value)}}),s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(G,{name:"Lock",size:18,className:"text-text-tertiary"})})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 text-primary focus:ring-primary border-border rounded"}),s.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-text-secondary",children:"Remember me"})]}),s.jsx("div",{className:"text-sm",children:s.jsx(hr,{to:"/forgot-password",className:"font-medium text-primary hover:text-primary-600",children:"Forgot your password?"})})]}),s.jsx("div",{children:s.jsx("button",{type:"submit",disabled:a,className:"btn-primary w-full flex justify-center items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:a?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),s.jsx("span",{children:"Signing in..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(G,{name:"LogIn",size:18}),s.jsx("span",{children:"Sign in"})]})})})]}),s.jsx("div",{className:"mt-6",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-0 flex items-center",children:s.jsx("div",{className:"w-full border-t border-border"})}),s.jsx("div",{className:"relative flex justify-center text-sm",children:s.jsx("span",{className:"px-2 bg-white text-text-secondary",children:"Or continue with"})})]})}),s.jsx("div",{className:"mt-6",children:s.jsx("button",{type:"button",onClick:v,disabled:a||o,className:"w-full flex items-center justify-center px-4 py-3 border border-gray-300 rounded-lg shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition-colors duration-150 disabled:opacity-50 disabled:cursor-not-allowed",children:o?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-gray-700 mr-3"}),s.jsx("span",{children:"Signing in with Microsoft..."})]}):s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"w-5 h-5 mr-3",viewBox:"0 0 21 21",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[s.jsx("rect",{x:"1",y:"1",width:"9",height:"9",fill:"#F25022"}),s.jsx("rect",{x:"1",y:"11",width:"9",height:"9",fill:"#00A4EF"}),s.jsx("rect",{x:"11",y:"1",width:"9",height:"9",fill:"#7FBA00"}),s.jsx("rect",{x:"11",y:"11",width:"9",height:"9",fill:"#FFB900"})]}),s.jsx("span",{children:"Sign in with Microsoft"})]})})}),s.jsx("div",{className:"mt-6 text-center",children:s.jsxs("p",{className:"text-sm text-text-secondary",children:["Don't have an account?"," ",s.jsx(hr,{to:"/register",className:"font-medium text-primary hover:text-primary-600",children:"Sign up here"})]})})]}),s.jsx("div",{className:"mt-8 text-center",children:s.jsx("p",{className:"text-xs text-text-tertiary",children:" 2025 SalesFlow Pro. Built with React & Supabase."})})]})]})},B7=()=>{const[e,t]=R.useState({firstName:"",lastName:"",email:"",password:"",confirmPassword:"",phone:"",role:"sales_rep"}),[r,n]=R.useState(!1),{signUp:a,authError:i,clearAuthError:o}=Pt(),c=Os(),l=d=>{const{name:f,value:h}=d.target;t(m=>({...m,[f]:h}))},u=async d=>{if(d.preventDefault(),n(!0),o(),e.password!==e.confirmPassword){n(!1);return}const{user:f,error:h}=await a(e.email,e.password,{firstName:e.firstName,lastName:e.lastName,phone:e.phone,role:e.role});f&&!h&&c("/sales-dashboard"),n(!1)};return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary-50 to-blue-50 py-12 px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"max-w-md w-full",children:[s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("div",{className:"w-16 h-16 bg-primary rounded-xl flex items-center justify-center mx-auto mb-4",children:s.jsx(G,{name:"UserPlus",size:28,className:"text-white"})}),s.jsx("h2",{className:"text-3xl font-bold text-text-primary",children:"Create Account"}),s.jsx("p",{className:"text-text-secondary mt-2",children:"Join SalesFlow and start managing your sales"})]}),s.jsxs("form",{className:"space-y-6",onSubmit:u,children:[i&&s.jsxs("div",{className:"bg-error-50 border border-error-200 text-error rounded-lg p-4 flex items-center space-x-2",children:[s.jsx(G,{name:"AlertCircle",size:16,className:"text-error flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsx("p",{className:"text-sm",children:i})}),s.jsx("button",{type:"button",onClick:o,className:"text-error hover:text-error-600",children:s.jsx(G,{name:"X",size:16})})]}),e.password!==e.confirmPassword&&e.confirmPassword&&s.jsxs("div",{className:"bg-error-50 border border-error-200 text-error rounded-lg p-4 flex items-center space-x-2",children:[s.jsx(G,{name:"AlertCircle",size:16,className:"text-error flex-shrink-0"}),s.jsx("p",{className:"text-sm",children:"Passwords do not match"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"firstName",className:"block text-sm font-medium text-text-primary mb-2",children:"First Name"}),s.jsx("input",{id:"firstName",name:"firstName",type:"text",required:!0,className:"input-field",placeholder:"Enter your first name",value:e.firstName,onChange:l})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"lastName",className:"block text-sm font-medium text-text-primary mb-2",children:"Last Name"}),s.jsx("input",{id:"lastName",name:"lastName",type:"text",required:!0,className:"input-field",placeholder:"Enter your last name",value:e.lastName,onChange:l})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-text-primary mb-2",children:"Email Address"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"input-field pl-10",placeholder:"Enter your email",value:e.email,onChange:l}),s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(G,{name:"Mail",size:18,className:"text-text-tertiary"})})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-text-primary mb-2",children:"Phone Number (Optional)"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{id:"phone",name:"phone",type:"tel",className:"input-field pl-10",placeholder:"Enter your phone number",value:e.phone,onChange:l}),s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(G,{name:"Phone",size:18,className:"text-text-tertiary"})})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-text-primary mb-2",children:"Role"}),s.jsxs("div",{className:"relative",children:[s.jsxs("select",{id:"role",name:"role",className:"input-field pl-10",value:e.role,onChange:l,children:[s.jsx("option",{value:"sales_rep",children:"Sales Representative"}),s.jsx("option",{value:"sales_manager",children:"Sales Manager"}),s.jsx("option",{value:"admin",children:"Administrator"}),s.jsx("option",{value:"user",children:"User"})]}),s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(G,{name:"User",size:18,className:"text-text-tertiary"})})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-text-primary mb-2",children:"Password"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,className:"input-field pl-10",placeholder:"Create a password",value:e.password,onChange:l}),s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(G,{name:"Lock",size:18,className:"text-text-tertiary"})})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-text-primary mb-2",children:"Confirm Password"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",autoComplete:"new-password",required:!0,className:"input-field pl-10",placeholder:"Confirm your password",value:e.confirmPassword,onChange:l}),s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(G,{name:"Lock",size:18,className:"text-text-tertiary"})})]})]}),s.jsx("div",{children:s.jsx("button",{type:"submit",disabled:r||e.password!==e.confirmPassword,className:"btn-primary w-full flex justify-center items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:r?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),s.jsx("span",{children:"Creating account..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(G,{name:"UserPlus",size:18}),s.jsx("span",{children:"Create Account"})]})})})]}),s.jsx("div",{className:"mt-6 text-center",children:s.jsxs("p",{className:"text-sm text-text-secondary",children:["Already have an account?"," ",s.jsx(hr,{to:"/login",className:"font-medium text-primary hover:text-primary-600",children:"Sign in here"})]})})]}),s.jsx("div",{className:"mt-8 text-center",children:s.jsx("p",{className:"text-xs text-text-tertiary",children:" 2025 SalesFlow Pro. Built with React & Supabase."})})]})})},L7=()=>{const[e,t]=R.useState(""),[r,n]=R.useState(!1),[a,i]=R.useState(!1),[o,c]=R.useState(""),l=async u=>{var d,f;u.preventDefault(),c(""),i(!1),n(!0);try{await be.post("/api/v1/auth/forgot-password",{email:e.trim()}),i(!0),t("")}catch(h){console.error("Forgot password error:",h),c(((f=(d=h.response)==null?void 0:d.data)==null?void 0:f.detail)||"Failed to send reset link. Please try again.")}finally{n(!1)}};return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary-50 to-blue-50 py-12 px-4 sm:px-6 lg:px-8",children:s.jsx("div",{className:"max-w-md w-full",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("div",{className:"w-16 h-16 bg-primary rounded-xl flex items-center justify-center mx-auto mb-4",children:s.jsx(G,{name:"Lock",size:28,className:"text-white"})}),s.jsx("h2",{className:"text-3xl font-bold text-text-primary",children:"Forgot Password?"}),s.jsx("p",{className:"text-text-secondary mt-2",children:"No worries, we'll send you reset instructions"})]}),a?s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-xl mb-4",children:s.jsx(G,{name:"Mail",size:28,className:"text-green-600"})}),s.jsx("h3",{className:"text-xl font-semibold text-text-primary mb-2",children:"Check Your Email"}),s.jsx("p",{className:"text-text-secondary mb-4",children:"If an account exists with the email you provided, you will receive a password reset link shortly."}),s.jsx("p",{className:"text-sm text-text-tertiary mb-6",children:"Didn't receive the email? Check your spam folder or try again."}),s.jsxs("button",{onClick:()=>i(!1),className:"btn-secondary w-full flex justify-center items-center space-x-2 mb-3",children:[s.jsx(G,{name:"ArrowLeft",size:18}),s.jsx("span",{children:"Send Another Link"})]}),s.jsx(hr,{to:"/login",className:"block text-center text-primary hover:text-primary-600 font-medium transition-colors duration-150",children:"Back to Login"})]}):s.jsxs(s.Fragment,{children:[s.jsxs("form",{onSubmit:l,className:"space-y-6",children:[o&&s.jsxs("div",{className:"bg-error-50 border border-error-200 text-error px-4 py-3 rounded-lg flex items-start space-x-3",children:[s.jsx(G,{name:"AlertCircle",size:20,className:"flex-shrink-0 mt-0.5"}),s.jsx("span",{className:"text-sm",children:o})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-text-secondary mb-2",children:"Email Address"}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(G,{name:"Mail",size:20,className:"text-text-tertiary"})}),s.jsx("input",{id:"email",type:"email",value:e,onChange:u=>t(u.target.value),placeholder:"Enter your email",required:!0,className:"w-full pl-10 pr-4 py-3 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all duration-150 outline-none text-text-primary placeholder-text-tertiary",disabled:r})]}),s.jsx("p",{className:"mt-2 text-sm text-text-tertiary",children:"Enter the email address associated with your account"})]}),s.jsx("button",{type:"submit",disabled:r||!e.trim(),className:"btn-primary w-full flex justify-center items-center space-x-2",children:r?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}),s.jsx("span",{children:"Sending..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(G,{name:"Mail",size:18}),s.jsx("span",{children:"Send Reset Link"})]})})]}),s.jsx("div",{className:"mt-6 text-center",children:s.jsxs(hr,{to:"/login",className:"inline-flex items-center space-x-2 text-primary hover:text-primary-600 font-medium transition-colors duration-150",children:[s.jsx(G,{name:"ArrowLeft",size:16}),s.jsx("span",{children:"Back to Login"})]})})]})]})})})},$7=()=>{const[e]=ah(),t=Os(),[r,n]=R.useState(""),[a,i]=R.useState(""),[o,c]=R.useState(""),[l,u]=R.useState(!1),[d,f]=R.useState(!1),[h,m]=R.useState(!1),[x,p]=R.useState(!1),[g,v]=R.useState("");R.useEffect(()=>{const _=e.get("token");_?n(_):v("Invalid reset link. Please request a new password reset.")},[e]);const y=()=>a.length<5?(v("Password must be at least 5 characters long"),!1):a!==o?(v("Passwords do not match"),!1):!0,b=async _=>{var w,j;if(_.preventDefault(),v(""),!!y()){m(!0);try{await be.post("/api/v1/auth/reset-password",{token:r,new_password:a}),p(!0),setTimeout(()=>{t("/login")},3e3)}catch(N){console.error("Reset password error:",N),v(((j=(w=N.response)==null?void 0:w.data)==null?void 0:j.detail)||"Failed to reset password. The link may be expired or invalid.")}finally{m(!1)}}};return!r&&!h?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary-50 to-blue-50 py-12 px-4 sm:px-6 lg:px-8",children:s.jsx("div",{className:"max-w-md w-full",children:s.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-error-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:s.jsx(G,{name:"AlertCircle",size:28,className:"text-error"})}),s.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-3",children:"Invalid Reset Link"}),s.jsx("p",{className:"text-text-secondary mb-6",children:"This password reset link is invalid or has expired."}),s.jsxs(hr,{to:"/forgot-password",className:"btn-primary w-full flex justify-center items-center space-x-2 mb-3",children:[s.jsx(G,{name:"Mail",size:18}),s.jsx("span",{children:"Request New Link"})]}),s.jsx(hr,{to:"/login",className:"block text-center text-primary hover:text-primary-600 font-medium transition-colors duration-150",children:"Back to Login"})]})})})}):s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary-50 to-blue-50 py-12 px-4 sm:px-6 lg:px-8",children:s.jsx("div",{className:"max-w-md w-full",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("div",{className:"w-16 h-16 bg-primary rounded-xl flex items-center justify-center mx-auto mb-4",children:s.jsx(G,{name:"Key",size:28,className:"text-white"})}),s.jsx("h2",{className:"text-3xl font-bold text-text-primary",children:"Reset Password"}),s.jsx("p",{className:"text-text-secondary mt-2",children:"Enter your new password below"})]}),x?s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-xl mb-4",children:s.jsx(G,{name:"CheckCircle",size:28,className:"text-green-600"})}),s.jsx("h3",{className:"text-xl font-semibold text-text-primary mb-2",children:"Password Reset Successful!"}),s.jsx("p",{className:"text-text-secondary mb-4",children:"Your password has been successfully reset. You can now log in with your new password."}),s.jsx("p",{className:"text-sm text-text-tertiary mb-6",children:"Redirecting to login page in 3 seconds..."}),s.jsxs(hr,{to:"/login",className:"btn-primary w-full flex justify-center items-center space-x-2",children:[s.jsx(G,{name:"LogIn",size:18}),s.jsx("span",{children:"Go to Login"})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("form",{onSubmit:b,className:"space-y-6",children:[g&&s.jsxs("div",{className:"bg-error-50 border border-error-200 text-error px-4 py-3 rounded-lg flex items-start space-x-3",children:[s.jsx(G,{name:"AlertCircle",size:20,className:"flex-shrink-0 mt-0.5"}),s.jsx("span",{className:"text-sm",children:g})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-text-secondary mb-2",children:"New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(G,{name:"Lock",size:20,className:"text-text-tertiary"})}),s.jsx("input",{id:"password",type:l?"text":"password",value:a,onChange:_=>i(_.target.value),placeholder:"Enter new password",required:!0,minLength:5,className:"w-full pl-10 pr-12 py-3 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all duration-150 outline-none text-text-primary placeholder-text-tertiary",disabled:h}),s.jsx("button",{type:"button",onClick:()=>u(!l),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:s.jsx(G,{name:l?"EyeOff":"Eye",size:20,className:"text-text-tertiary hover:text-text-secondary"})})]}),s.jsx("p",{className:"mt-2 text-sm text-text-tertiary",children:"Must be at least 5 characters long"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-text-secondary mb-2",children:"Confirm Password"}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(G,{name:"Lock",size:20,className:"text-text-tertiary"})}),s.jsx("input",{id:"confirmPassword",type:d?"text":"password",value:o,onChange:_=>c(_.target.value),placeholder:"Confirm new password",required:!0,minLength:5,className:"w-full pl-10 pr-12 py-3 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-all duration-150 outline-none text-text-primary placeholder-text-tertiary",disabled:h}),s.jsx("button",{type:"button",onClick:()=>f(!d),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:s.jsx(G,{name:d?"EyeOff":"Eye",size:20,className:"text-text-tertiary hover:text-text-secondary"})})]})]}),a&&o&&s.jsxs("div",{className:`flex items-center space-x-2 text-sm ${a===o?"text-green-600":"text-error"}`,children:[s.jsx(G,{name:a===o?"CheckCircle":"XCircle",size:16}),s.jsx("span",{children:a===o?"Passwords match":"Passwords do not match"})]}),s.jsx("button",{type:"submit",disabled:h||!a||!o,className:"btn-primary w-full flex justify-center items-center space-x-2",children:h?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}),s.jsx("span",{children:"Resetting Password..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(G,{name:"Key",size:18}),s.jsx("span",{children:"Reset Password"})]})})]}),s.jsx("div",{className:"mt-6 text-center",children:s.jsxs(hr,{to:"/login",className:"inline-flex items-center space-x-2 text-primary hover:text-primary-600 font-medium transition-colors duration-150",children:[s.jsx(G,{name:"ArrowLeft",size:16}),s.jsx("span",{children:"Back to Login"})]})})]})]})})})},W7=()=>{const[e]=ah(),t=Os(),{loadUserPermissions:r}=Pt(),[n,a]=R.useState("processing"),[i,o]=R.useState("");return R.useEffect(()=>{(async()=>{try{const l=e.get("token"),u=e.get("user"),d=e.get("error");if(d){a("error"),o(decodeURIComponent(d)),console.error(" Microsoft callback error:",d),setTimeout(()=>{t("/login")},3e3);return}if(!l||!u){a("error"),o("Missing authentication data. Please try again."),console.error(" Missing token or user data in callback"),setTimeout(()=>{t("/login")},3e3);return}const f=JSON.parse(decodeURIComponent(u));console.log(" Microsoft callback successful"),console.log("   Token received:",l?"Yes":"No"),console.log("   User:",f.email),be.setToken(l),be.setCurrentUser(f),await r(),a("success"),console.log(" Redirecting to dashboard..."),t("/sales-dashboard",{replace:!0})}catch(l){console.error(" Error processing Microsoft callback:",l),a("error"),o("Failed to process authentication. Please try again."),setTimeout(()=>{t("/login")},3e3)}})()},[e,t,r]),s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary-50 to-blue-50",children:s.jsx("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8",children:s.jsxs("div",{className:"text-center",children:[n==="processing"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-primary mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Completing sign in..."}),s.jsx("p",{className:"text-text-secondary",children:"Please wait while we set up your session"})]}),n==="success"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),s.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Sign in successful!"}),s.jsx("p",{className:"text-text-secondary",children:"Redirecting to your dashboard..."})]}),n==="error"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-16 h-16 bg-error-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx("svg",{className:"w-8 h-8 text-error",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),s.jsx("h2",{className:"text-2xl font-bold text-error mb-2",children:"Sign in failed"}),s.jsx("p",{className:"text-text-secondary mb-4",children:i||"An error occurred during authentication"}),s.jsx("p",{className:"text-sm text-text-tertiary",children:"Redirecting to login page..."})]})]})})})};function Lb(e,t){return Lb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Lb(e,t)}function IF(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Lb(e,t)}function Bd(e){"@babel/helpers - typeof";return Bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bd(e)}function z7(e,t){if(Bd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Bd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function q7(e){var t=z7(e,"string");return Bd(t)=="symbol"?t:t+""}function H7(e,t,r){return(t=q7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function jD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_D(Object(r),!0).forEach(function(n){H7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_D(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Jn(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var ND=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),DD=function(){return Math.random().toString(36).substring(7).split("").join(".")},SD={INIT:"@@redux/INIT"+DD(),REPLACE:"@@redux/REPLACE"+DD()};function V7(e){if(typeof e!="object"||e===null)return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function UF(e,t,r){var n;if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Jn(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Jn(1));return r(UF)(e,t)}if(typeof e!="function")throw new Error(Jn(2));var a=e,i=t,o=[],c=o,l=!1;function u(){c===o&&(c=o.slice())}function d(){if(l)throw new Error(Jn(3));return i}function f(p){if(typeof p!="function")throw new Error(Jn(4));if(l)throw new Error(Jn(5));var g=!0;return u(),c.push(p),function(){if(g){if(l)throw new Error(Jn(6));g=!1,u();var y=c.indexOf(p);c.splice(y,1),o=null}}}function h(p){if(!V7(p))throw new Error(Jn(7));if(typeof p.type>"u")throw new Error(Jn(8));if(l)throw new Error(Jn(9));try{l=!0,i=a(i,p)}finally{l=!1}for(var g=o=c,v=0;v<g.length;v++){var y=g[v];y()}return p}function m(p){if(typeof p!="function")throw new Error(Jn(10));a=p,h({type:SD.REPLACE})}function x(){var p,g=f;return p={subscribe:function(y){if(typeof y!="object"||y===null)throw new Error(Jn(11));function b(){y.next&&y.next(d())}b();var _=g(b);return{unsubscribe:_}}},p[ND]=function(){return this},p}return h({type:SD.INIT}),n={dispatch:h,subscribe:f,getState:d,replaceReducer:m},n[ND]=x,n}function ED(e,t){return function(){return t(e.apply(this,arguments))}}function TD(e,t){if(typeof e=="function")return ED(e,t);if(typeof e!="object"||e===null)throw new Error(Jn(16));var r={};for(var n in e){var a=e[n];typeof a=="function"&&(r[n]=ED(a,t))}return r}function RF(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.length===0?function(n){return n}:t.length===1?t[0]:t.reduce(function(n,a){return function(){return n(a.apply(void 0,arguments))}})}function G7(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(n){return function(){var a=n.apply(void 0,arguments),i=function(){throw new Error(Jn(15))},o={getState:a.getState,dispatch:function(){return i.apply(void 0,arguments)}},c=t.map(function(l){return l(o)});return i=RF.apply(void 0,c)(a.dispatch),jD(jD({},a),{},{dispatch:i})}}}var MF={exports:{}},X7="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",K7=X7,Y7=K7;function BF(){}function LF(){}LF.resetWarningCache=BF;var Z7=function(){function e(n,a,i,o,c,l){if(l!==Y7){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:LF,resetWarningCache:BF};return r.PropTypes=r,r};MF.exports=Z7();var J7=MF.exports;const kt=Rt(J7);var $F=ge.createContext(null);function Q7(e){e()}var WF=Q7,eW=function(t){return WF=t},tW=function(){return WF};function rW(){var e=tW(),t=null,r=null;return{clear:function(){t=null,r=null},notify:function(){e(function(){for(var a=t;a;)a.callback(),a=a.next})},get:function(){for(var a=[],i=t;i;)a.push(i),i=i.next;return a},subscribe:function(a){var i=!0,o=r={callback:a,next:null,prev:r};return o.prev?o.prev.next=o:t=o,function(){!i||t===null||(i=!1,o.next?o.next.prev=o.prev:r=o.prev,o.prev?o.prev.next=o.next:t=o.next)}}}}var CD={notify:function(){},get:function(){return[]}};function zF(e,t){var r,n=CD;function a(f){return l(),n.subscribe(f)}function i(){n.notify()}function o(){d.onStateChange&&d.onStateChange()}function c(){return!!r}function l(){r||(r=t?t.addNestedSub(o):e.subscribe(o),n=rW())}function u(){r&&(r(),r=void 0,n.clear(),n=CD)}var d={addNestedSub:a,notifyNestedSubs:i,handleChangeWrapper:o,isSubscribed:c,trySubscribe:l,tryUnsubscribe:u,getListeners:function(){return n}};return d}var qF=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?R.useLayoutEffect:R.useEffect;function nW(e){var t=e.store,r=e.context,n=e.children,a=R.useMemo(function(){var c=zF(t);return{store:t,subscription:c}},[t]),i=R.useMemo(function(){return t.getState()},[t]);qF(function(){var c=a.subscription;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),i!==t.getState()&&c.notifyNestedSubs(),function(){c.tryUnsubscribe(),c.onStateChange=null}},[a,i]);var o=r||$F;return ge.createElement(o.Provider,{value:a},n)}function Ym(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var HF={exports:{}},Ht={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sn=typeof Symbol=="function"&&Symbol.for,J2=sn?Symbol.for("react.element"):60103,Q2=sn?Symbol.for("react.portal"):60106,Xx=sn?Symbol.for("react.fragment"):60107,Kx=sn?Symbol.for("react.strict_mode"):60108,Yx=sn?Symbol.for("react.profiler"):60114,Zx=sn?Symbol.for("react.provider"):60109,Jx=sn?Symbol.for("react.context"):60110,ew=sn?Symbol.for("react.async_mode"):60111,Qx=sn?Symbol.for("react.concurrent_mode"):60111,e0=sn?Symbol.for("react.forward_ref"):60112,t0=sn?Symbol.for("react.suspense"):60113,aW=sn?Symbol.for("react.suspense_list"):60120,r0=sn?Symbol.for("react.memo"):60115,n0=sn?Symbol.for("react.lazy"):60116,iW=sn?Symbol.for("react.block"):60121,sW=sn?Symbol.for("react.fundamental"):60117,oW=sn?Symbol.for("react.responder"):60118,cW=sn?Symbol.for("react.scope"):60119;function Fa(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case J2:switch(e=e.type,e){case ew:case Qx:case Xx:case Yx:case Kx:case t0:return e;default:switch(e=e&&e.$$typeof,e){case Jx:case e0:case n0:case r0:case Zx:return e;default:return t}}case Q2:return t}}}function VF(e){return Fa(e)===Qx}Ht.AsyncMode=ew;Ht.ConcurrentMode=Qx;Ht.ContextConsumer=Jx;Ht.ContextProvider=Zx;Ht.Element=J2;Ht.ForwardRef=e0;Ht.Fragment=Xx;Ht.Lazy=n0;Ht.Memo=r0;Ht.Portal=Q2;Ht.Profiler=Yx;Ht.StrictMode=Kx;Ht.Suspense=t0;Ht.isAsyncMode=function(e){return VF(e)||Fa(e)===ew};Ht.isConcurrentMode=VF;Ht.isContextConsumer=function(e){return Fa(e)===Jx};Ht.isContextProvider=function(e){return Fa(e)===Zx};Ht.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===J2};Ht.isForwardRef=function(e){return Fa(e)===e0};Ht.isFragment=function(e){return Fa(e)===Xx};Ht.isLazy=function(e){return Fa(e)===n0};Ht.isMemo=function(e){return Fa(e)===r0};Ht.isPortal=function(e){return Fa(e)===Q2};Ht.isProfiler=function(e){return Fa(e)===Yx};Ht.isStrictMode=function(e){return Fa(e)===Kx};Ht.isSuspense=function(e){return Fa(e)===t0};Ht.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Xx||e===Qx||e===Yx||e===Kx||e===t0||e===aW||typeof e=="object"&&e!==null&&(e.$$typeof===n0||e.$$typeof===r0||e.$$typeof===Zx||e.$$typeof===Jx||e.$$typeof===e0||e.$$typeof===sW||e.$$typeof===oW||e.$$typeof===cW||e.$$typeof===iW)};Ht.typeOf=Fa;HF.exports=Ht;var lW=HF.exports,tw=lW,uW={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},dW={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},fW={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},GF={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},rw={};rw[tw.ForwardRef]=fW;rw[tw.Memo]=GF;function AD(e){return tw.isMemo(e)?GF:rw[e.$$typeof]||uW}var hW=Object.defineProperty,mW=Object.getOwnPropertyNames,kD=Object.getOwnPropertySymbols,pW=Object.getOwnPropertyDescriptor,xW=Object.getPrototypeOf,FD=Object.prototype;function XF(e,t,r){if(typeof t!="string"){if(FD){var n=xW(t);n&&n!==FD&&XF(e,n,r)}var a=mW(t);kD&&(a=a.concat(kD(t)));for(var i=AD(e),o=AD(t),c=0;c<a.length;++c){var l=a[c];if(!dW[l]&&!(r&&r[l])&&!(o&&o[l])&&!(i&&i[l])){var u=pW(t,l);try{hW(e,l,u)}catch{}}}}return e}var gW=XF;const OD=Rt(gW);var KF={exports:{}},Jt={};/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a0=60103,i0=60106,uh=60107,dh=60108,fh=60114,hh=60109,mh=60110,ph=60112,xh=60113,nw=60120,gh=60115,vh=60116,YF=60121,ZF=60122,JF=60117,QF=60129,eO=60131;if(typeof Symbol=="function"&&Symbol.for){var un=Symbol.for;a0=un("react.element"),i0=un("react.portal"),uh=un("react.fragment"),dh=un("react.strict_mode"),fh=un("react.profiler"),hh=un("react.provider"),mh=un("react.context"),ph=un("react.forward_ref"),xh=un("react.suspense"),nw=un("react.suspense_list"),gh=un("react.memo"),vh=un("react.lazy"),YF=un("react.block"),ZF=un("react.server.block"),JF=un("react.fundamental"),QF=un("react.debug_trace_mode"),eO=un("react.legacy_hidden")}function Ei(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case a0:switch(e=e.type,e){case uh:case fh:case dh:case xh:case nw:return e;default:switch(e=e&&e.$$typeof,e){case mh:case ph:case vh:case gh:case hh:return e;default:return t}}case i0:return t}}}var vW=hh,yW=a0,bW=ph,wW=uh,_W=vh,jW=gh,NW=i0,DW=fh,SW=dh,EW=xh;Jt.ContextConsumer=mh;Jt.ContextProvider=vW;Jt.Element=yW;Jt.ForwardRef=bW;Jt.Fragment=wW;Jt.Lazy=_W;Jt.Memo=jW;Jt.Portal=NW;Jt.Profiler=DW;Jt.StrictMode=SW;Jt.Suspense=EW;Jt.isAsyncMode=function(){return!1};Jt.isConcurrentMode=function(){return!1};Jt.isContextConsumer=function(e){return Ei(e)===mh};Jt.isContextProvider=function(e){return Ei(e)===hh};Jt.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===a0};Jt.isForwardRef=function(e){return Ei(e)===ph};Jt.isFragment=function(e){return Ei(e)===uh};Jt.isLazy=function(e){return Ei(e)===vh};Jt.isMemo=function(e){return Ei(e)===gh};Jt.isPortal=function(e){return Ei(e)===i0};Jt.isProfiler=function(e){return Ei(e)===fh};Jt.isStrictMode=function(e){return Ei(e)===dh};Jt.isSuspense=function(e){return Ei(e)===xh};Jt.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===uh||e===fh||e===QF||e===dh||e===xh||e===nw||e===eO||typeof e=="object"&&e!==null&&(e.$$typeof===vh||e.$$typeof===gh||e.$$typeof===hh||e.$$typeof===mh||e.$$typeof===ph||e.$$typeof===JF||e.$$typeof===YF||e[0]===ZF)};Jt.typeOf=Ei;KF.exports=Jt;var TW=KF.exports,CW=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],AW=["reactReduxForwardedRef"],kW=[],FW=[null,null];function OW(e,t){var r=e[1];return[t.payload,r+1]}function PD(e,t,r){qF(function(){return e.apply(void 0,t)},r)}function PW(e,t,r,n,a,i,o){e.current=n,t.current=a,r.current=!1,i.current&&(i.current=null,o())}function IW(e,t,r,n,a,i,o,c,l,u){if(e){var d=!1,f=null,h=function(){if(!d){var p=t.getState(),g,v;try{g=n(p,a.current)}catch(y){v=y,f=y}v||(f=null),g===i.current?o.current||l():(i.current=g,c.current=g,o.current=!0,u({type:"STORE_UPDATED",payload:{error:v}}))}};r.onStateChange=h,r.trySubscribe(),h();var m=function(){if(d=!0,r.tryUnsubscribe(),r.onStateChange=null,f)throw f};return m}}var UW=function(){return[null,0]};function RW(e,t){t===void 0&&(t={});var r=t,n=r.getDisplayName,a=n===void 0?function(b){return"ConnectAdvanced("+b+")"}:n,i=r.methodName,o=i===void 0?"connectAdvanced":i,c=r.renderCountProp,l=c===void 0?void 0:c,u=r.shouldHandleStateChanges,d=u===void 0?!0:u,f=r.storeKey,h=f===void 0?"store":f;r.withRef;var m=r.forwardRef,x=m===void 0?!1:m,p=r.context,g=p===void 0?$F:p,v=Ym(r,CW),y=g;return function(_){var w=_.displayName||_.name||"Component",j=a(w),N=ct({},v,{getDisplayName:a,methodName:o,renderCountProp:l,shouldHandleStateChanges:d,storeKey:h,displayName:j,wrappedComponentName:w,WrappedComponent:_}),D=v.pure;function S(P){return e(P.dispatch,N)}var T=D?R.useMemo:function(P){return P()};function A(P){var X=R.useMemo(function(){var oe=P.reactReduxForwardedRef,J=Ym(P,AW);return[P.context,oe,J]},[P]),q=X[0],B=X[1],O=X[2],F=R.useMemo(function(){return q&&q.Consumer&&TW.isContextConsumer(ge.createElement(q.Consumer,null))?q:y},[q,y]),I=R.useContext(F),L=!!P.store&&!!P.store.getState&&!!P.store.dispatch;I&&I.store;var C=L?P.store:I.store,k=R.useMemo(function(){return S(C)},[C]),z=R.useMemo(function(){if(!d)return FW;var oe=zF(C,L?null:I.subscription),J=oe.notifyNestedSubs.bind(oe);return[oe,J]},[C,L,I]),V=z[0],Z=z[1],ce=R.useMemo(function(){return L?I:ct({},I,{subscription:V})},[L,I,V]),ie=R.useReducer(OW,kW,UW),Q=ie[0],ne=Q[0],pe=ie[1];if(ne&&ne.error)throw ne.error;var W=R.useRef(),re=R.useRef(O),U=R.useRef(),se=R.useRef(!1),te=T(function(){return U.current&&O===re.current?U.current:k(C.getState(),O)},[C,ne,O]);PD(PW,[re,W,se,O,te,U,Z]),PD(IW,[d,C,V,k,re,W,se,U,Z,pe],[C,V,k]);var K=R.useMemo(function(){return ge.createElement(_,ct({},te,{ref:B}))},[B,_,te]),H=R.useMemo(function(){return d?ge.createElement(F.Provider,{value:ce},K):K},[F,K,ce]);return H}var E=D?ge.memo(A):A;if(E.WrappedComponent=_,E.displayName=A.displayName=j,x){var M=ge.forwardRef(function(X,q){return ge.createElement(E,ct({},X,{reactReduxForwardedRef:q}))});return M.displayName=j,M.WrappedComponent=_,OD(M,_)}return OD(E,_)}}function ID(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function xv(e,t){if(ID(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var a=0;a<r.length;a++)if(!Object.prototype.hasOwnProperty.call(t,r[a])||!ID(e[r[a]],t[r[a]]))return!1;return!0}function MW(e,t){var r={},n=function(o){var c=e[o];typeof c=="function"&&(r[o]=function(){return t(c.apply(void 0,arguments))})};for(var a in e)n(a);return r}function aw(e){return function(r,n){var a=e(r,n);function i(){return a}return i.dependsOnOwnProps=!1,i}}function UD(e){return e.dependsOnOwnProps!==null&&e.dependsOnOwnProps!==void 0?!!e.dependsOnOwnProps:e.length!==1}function tO(e,t){return function(n,a){a.displayName;var i=function(c,l){return i.dependsOnOwnProps?i.mapToProps(c,l):i.mapToProps(c)};return i.dependsOnOwnProps=!0,i.mapToProps=function(c,l){i.mapToProps=e,i.dependsOnOwnProps=UD(e);var u=i(c,l);return typeof u=="function"&&(i.mapToProps=u,i.dependsOnOwnProps=UD(u),u=i(c,l)),u},i}}function BW(e){return typeof e=="function"?tO(e):void 0}function LW(e){return e?void 0:aw(function(t){return{dispatch:t}})}function $W(e){return e&&typeof e=="object"?aw(function(t){return MW(e,t)}):void 0}const WW=[BW,LW,$W];function zW(e){return typeof e=="function"?tO(e):void 0}function qW(e){return e?void 0:aw(function(){return{}})}const HW=[zW,qW];function VW(e,t,r){return ct({},r,e,t)}function GW(e){return function(r,n){n.displayName;var a=n.pure,i=n.areMergedPropsEqual,o=!1,c;return function(u,d,f){var h=e(u,d,f);return o?(!a||!i(h,c))&&(c=h):(o=!0,c=h),c}}}function XW(e){return typeof e=="function"?GW(e):void 0}function KW(e){return e?void 0:function(){return VW}}const YW=[XW,KW];var ZW=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function JW(e,t,r,n){return function(i,o){return r(e(i,o),t(n,o),o)}}function QW(e,t,r,n,a){var i=a.areStatesEqual,o=a.areOwnPropsEqual,c=a.areStatePropsEqual,l=!1,u,d,f,h,m;function x(b,_){return u=b,d=_,f=e(u,d),h=t(n,d),m=r(f,h,d),l=!0,m}function p(){return f=e(u,d),t.dependsOnOwnProps&&(h=t(n,d)),m=r(f,h,d),m}function g(){return e.dependsOnOwnProps&&(f=e(u,d)),t.dependsOnOwnProps&&(h=t(n,d)),m=r(f,h,d),m}function v(){var b=e(u,d),_=!c(b,f);return f=b,_&&(m=r(f,h,d)),m}function y(b,_){var w=!o(_,d),j=!i(b,u,_,d);return u=b,d=_,w&&j?p():w?g():j?v():m}return function(_,w){return l?y(_,w):x(_,w)}}function ez(e,t){var r=t.initMapStateToProps,n=t.initMapDispatchToProps,a=t.initMergeProps,i=Ym(t,ZW),o=r(e,i),c=n(e,i),l=a(e,i),u=i.pure?QW:JW;return u(o,c,l,e,i)}var tz=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];function gv(e,t,r){for(var n=t.length-1;n>=0;n--){var a=t[n](e);if(a)return a}return function(i,o){throw new Error("Invalid value of type "+typeof e+" for "+r+" argument when connecting component "+o.wrappedComponentName+".")}}function rz(e,t){return e===t}function nz(e){var t=e===void 0?{}:e,r=t.connectHOC,n=r===void 0?RW:r,a=t.mapStateToPropsFactories,i=a===void 0?HW:a,o=t.mapDispatchToPropsFactories,c=o===void 0?WW:o,l=t.mergePropsFactories,u=l===void 0?YW:l,d=t.selectorFactory,f=d===void 0?ez:d;return function(m,x,p,g){g===void 0&&(g={});var v=g,y=v.pure,b=y===void 0?!0:y,_=v.areStatesEqual,w=_===void 0?rz:_,j=v.areOwnPropsEqual,N=j===void 0?xv:j,D=v.areStatePropsEqual,S=D===void 0?xv:D,T=v.areMergedPropsEqual,A=T===void 0?xv:T,E=Ym(v,tz),M=gv(m,i,"mapStateToProps"),P=gv(x,c,"mapDispatchToProps"),X=gv(p,u,"mergeProps");return n(f,ct({methodName:"connect",getDisplayName:function(B){return"Connect("+B+")"},shouldHandleStateChanges:!!m,initMapStateToProps:M,initMapDispatchToProps:P,initMergeProps:X,pure:b,areStatesEqual:w,areOwnPropsEqual:N,areStatePropsEqual:S,areMergedPropsEqual:A},E))}}const rO=nz();eW(Y4.unstable_batchedUpdates);function az(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function nO(e,t){var r=R.useState(function(){return{inputs:t,result:e()}})[0],n=R.useRef(!0),a=R.useRef(r),i=n.current||!!(t&&a.current.inputs&&az(t,a.current.inputs)),o=i?a.current:{inputs:t,result:e()};return R.useEffect(function(){n.current=!1,a.current=o},[o]),o.result}function iz(e,t){return nO(function(){return e},t)}var Ft=nO,tt=iz,sz="Invariant failed";function oo(e,t){throw new Error(sz)}var gi=function(t){var r=t.top,n=t.right,a=t.bottom,i=t.left,o=n-i,c=a-r,l={top:r,right:n,bottom:a,left:i,width:o,height:c,x:i,y:r,center:{x:(n+i)/2,y:(a+r)/2}};return l},iw=function(t,r){return{top:t.top-r.top,left:t.left-r.left,bottom:t.bottom+r.bottom,right:t.right+r.right}},RD=function(t,r){return{top:t.top+r.top,left:t.left+r.left,bottom:t.bottom-r.bottom,right:t.right-r.right}},oz=function(t,r){return{top:t.top+r.y,left:t.left+r.x,bottom:t.bottom+r.y,right:t.right+r.x}},vv={top:0,right:0,bottom:0,left:0},sw=function(t){var r=t.borderBox,n=t.margin,a=n===void 0?vv:n,i=t.border,o=i===void 0?vv:i,c=t.padding,l=c===void 0?vv:c,u=gi(iw(r,a)),d=gi(RD(r,o)),f=gi(RD(d,l));return{marginBox:u,borderBox:gi(r),paddingBox:d,contentBox:f,margin:a,border:o,padding:l}},Ia=function(t){var r=t.slice(0,-2),n=t.slice(-2);if(n!=="px")return 0;var a=Number(r);return isNaN(a)&&oo(),a},cz=function(){return{x:window.pageXOffset,y:window.pageYOffset}},Zm=function(t,r){var n=t.borderBox,a=t.border,i=t.margin,o=t.padding,c=oz(n,r);return sw({borderBox:c,border:a,margin:i,padding:o})},Jm=function(t,r){return r===void 0&&(r=cz()),Zm(t,r)},aO=function(t,r){var n={top:Ia(r.marginTop),right:Ia(r.marginRight),bottom:Ia(r.marginBottom),left:Ia(r.marginLeft)},a={top:Ia(r.paddingTop),right:Ia(r.paddingRight),bottom:Ia(r.paddingBottom),left:Ia(r.paddingLeft)},i={top:Ia(r.borderTopWidth),right:Ia(r.borderRightWidth),bottom:Ia(r.borderBottomWidth),left:Ia(r.borderLeftWidth)};return sw({borderBox:t,margin:n,padding:a,border:i})},iO=function(t){var r=t.getBoundingClientRect(),n=window.getComputedStyle(t);return aO(r,n)},MD=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function lz(e,t){return!!(e===t||MD(e)&&MD(t))}function uz(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!lz(e[r],t[r]))return!1;return!0}function tn(e,t){t===void 0&&(t=uz);var r,n=[],a,i=!1;function o(){for(var c=[],l=0;l<arguments.length;l++)c[l]=arguments[l];return i&&r===this&&t(c,n)||(a=e.apply(this,c),i=!0,r=this,n=c),a}return o}var Ld=function(t){var r=[],n=null,a=function(){for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];r=c,!n&&(n=requestAnimationFrame(function(){n=null,t.apply(void 0,r)}))};return a.cancel=function(){n&&(cancelAnimationFrame(n),n=null)},a};function sO(e,t){}sO.bind(null,"warn");sO.bind(null,"error");function to(){}function dz(e,t){return ct({},e,{},t)}function Za(e,t,r){var n=t.map(function(a){var i=dz(r,a.options);return e.addEventListener(a.eventName,a.fn,i),function(){e.removeEventListener(a.eventName,a.fn,i)}});return function(){n.forEach(function(i){i()})}}var fz="Invariant failed";function Qm(e){this.message=e}Qm.prototype.toString=function(){return this.message};function We(e,t){throw new Qm(fz)}var hz=function(e){IF(t,e);function t(){for(var n,a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return n=e.call.apply(e,[this].concat(i))||this,n.callbacks=null,n.unbind=to,n.onWindowError=function(c){var l=n.getCallbacks();l.isDragging()&&l.tryAbort();var u=c.error;u instanceof Qm&&c.preventDefault()},n.getCallbacks=function(){if(!n.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return n.callbacks},n.setCallbacks=function(c){n.callbacks=c},n}var r=t.prototype;return r.componentDidMount=function(){this.unbind=Za(window,[{eventName:"error",fn:this.onWindowError}])},r.componentDidCatch=function(a){if(a instanceof Qm){this.setState({});return}throw a},r.componentWillUnmount=function(){this.unbind()},r.render=function(){return this.props.children(this.setCallbacks)},t}(ge.Component),mz=`
  Press space bar to start a drag.
  When dragging you can use the arrow keys to move the item around and escape to cancel.
  Some screen readers may require you to be in focus mode or to use your pass through key
`,ep=function(t){return t+1},pz=function(t){return`
  You have lifted an item in position `+ep(t.source.index)+`
`},oO=function(t,r){var n=t.droppableId===r.droppableId,a=ep(t.index),i=ep(r.index);return n?`
      You have moved the item from position `+a+`
      to position `+i+`
    `:`
    You have moved the item from position `+a+`
    in list `+t.droppableId+`
    to list `+r.droppableId+`
    in position `+i+`
  `},cO=function(t,r,n){var a=r.droppableId===n.droppableId;return a?`
      The item `+t+`
      has been combined with `+n.draggableId:`
      The item `+t+`
      in list `+r.droppableId+`
      has been combined with `+n.draggableId+`
      in list `+n.droppableId+`
    `},xz=function(t){var r=t.destination;if(r)return oO(t.source,r);var n=t.combine;return n?cO(t.draggableId,t.source,n):"You are over an area that cannot be dropped on"},BD=function(t){return`
  The item has returned to its starting position
  of `+ep(t.index)+`
`},gz=function(t){if(t.reason==="CANCEL")return`
      Movement cancelled.
      `+BD(t.source)+`
    `;var r=t.destination,n=t.combine;return r?`
      You have dropped the item.
      `+oO(t.source,r)+`
    `:n?`
      You have dropped the item.
      `+cO(t.draggableId,t.source,n)+`
    `:`
    The item has been dropped while not over a drop area.
    `+BD(t.source)+`
  `},$m={dragHandleUsageInstructions:mz,onDragStart:pz,onDragUpdate:xz,onDragEnd:gz},rn={x:0,y:0},pn=function(t,r){return{x:t.x+r.x,y:t.y+r.y}},ja=function(t,r){return{x:t.x-r.x,y:t.y-r.y}},ro=function(t,r){return t.x===r.x&&t.y===r.y},uu=function(t){return{x:t.x!==0?-t.x:0,y:t.y!==0?-t.y:0}},dc=function(t,r,n){var a;return n===void 0&&(n=0),a={},a[t]=r,a[t==="x"?"y":"x"]=n,a},$d=function(t,r){return Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2))},LD=function(t,r){return Math.min.apply(Math,r.map(function(n){return $d(t,n)}))},lO=function(t){return function(r){return{x:t(r.x),y:t(r.y)}}},vz=function(e,t){var r=gi({top:Math.max(t.top,e.top),right:Math.min(t.right,e.right),bottom:Math.min(t.bottom,e.bottom),left:Math.max(t.left,e.left)});return r.width<=0||r.height<=0?null:r},yh=function(t,r){return{top:t.top+r.y,left:t.left+r.x,bottom:t.bottom+r.y,right:t.right+r.x}},$D=function(t){return[{x:t.left,y:t.top},{x:t.right,y:t.top},{x:t.left,y:t.bottom},{x:t.right,y:t.bottom}]},yz={top:0,right:0,bottom:0,left:0},bz=function(t,r){return r?yh(t,r.scroll.diff.displacement):t},wz=function(t,r,n){if(n&&n.increasedBy){var a;return ct({},t,(a={},a[r.end]=t[r.end]+n.increasedBy[r.line],a))}return t},_z=function(t,r){return r&&r.shouldClipSubject?vz(r.pageMarginBox,t):gi(t)},jl=function(e){var t=e.page,r=e.withPlaceholder,n=e.axis,a=e.frame,i=bz(t.marginBox,a),o=wz(i,n,r),c=_z(o,a);return{page:t,withPlaceholder:r,active:c}},ow=function(e,t){e.frame||We();var r=e.frame,n=ja(t,r.scroll.initial),a=uu(n),i=ct({},r,{scroll:{initial:r.scroll.initial,current:t,diff:{value:n,displacement:a},max:r.scroll.max}}),o=jl({page:e.subject.page,withPlaceholder:e.subject.withPlaceholder,axis:e.axis,frame:i}),c=ct({},e,{frame:i,subject:o});return c};function tp(e){return Object.values?Object.values(e):Object.keys(e).map(function(t){return e[t]})}function cw(e,t){if(e.findIndex)return e.findIndex(t);for(var r=0;r<e.length;r++)if(t(e[r]))return r;return-1}function yo(e,t){if(e.find)return e.find(t);var r=cw(e,t);if(r!==-1)return e[r]}function uO(e){return Array.prototype.slice.call(e)}var dO=tn(function(e){return e.reduce(function(t,r){return t[r.descriptor.id]=r,t},{})}),fO=tn(function(e){return e.reduce(function(t,r){return t[r.descriptor.id]=r,t},{})}),s0=tn(function(e){return tp(e)}),jz=tn(function(e){return tp(e)}),du=tn(function(e,t){var r=jz(t).filter(function(n){return e===n.descriptor.droppableId}).sort(function(n,a){return n.descriptor.index-a.descriptor.index});return r});function lw(e){return e.at&&e.at.type==="REORDER"?e.at.destination:null}function o0(e){return e.at&&e.at.type==="COMBINE"?e.at.combine:null}var c0=tn(function(e,t){return t.filter(function(r){return r.descriptor.id!==e.descriptor.id})}),Nz=function(e){var t=e.isMovingForward,r=e.draggable,n=e.destination,a=e.insideDestination,i=e.previousImpact;if(!n.isCombineEnabled)return null;var o=lw(i);if(!o)return null;function c(p){var g={type:"COMBINE",combine:{draggableId:p,droppableId:n.descriptor.id}};return ct({},i,{at:g})}var l=i.displaced.all,u=l.length?l[0]:null;if(t)return u?c(u):null;var d=c0(r,a);if(!u){if(!d.length)return null;var f=d[d.length-1];return c(f.descriptor.id)}var h=cw(d,function(p){return p.descriptor.id===u});h===-1&&We();var m=h-1;if(m<0)return null;var x=d[m];return c(x.descriptor.id)},fu=function(e,t){return e.descriptor.droppableId===t.descriptor.id},hO={point:rn,value:0},Wd={invisible:{},visible:{},all:[]},Dz={displaced:Wd,displacedBy:hO,at:null},ti=function(e,t){return function(r){return e<=r&&r<=t}},mO=function(e){var t=ti(e.top,e.bottom),r=ti(e.left,e.right);return function(n){var a=t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right);if(a)return!0;var i=t(n.top)||t(n.bottom),o=r(n.left)||r(n.right),c=i&&o;if(c)return!0;var l=n.top<e.top&&n.bottom>e.bottom,u=n.left<e.left&&n.right>e.right,d=l&&u;if(d)return!0;var f=l&&o||u&&i;return f}},Sz=function(e){var t=ti(e.top,e.bottom),r=ti(e.left,e.right);return function(n){var a=t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right);return a}},uw={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},pO={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"},Ez=function(e){return function(t){var r=ti(t.top,t.bottom),n=ti(t.left,t.right);return function(a){return e===uw?r(a.top)&&r(a.bottom):n(a.left)&&n(a.right)}}},Tz=function(t,r){var n=r.frame?r.frame.scroll.diff.displacement:rn;return yh(t,n)},Cz=function(t,r,n){return r.subject.active?n(r.subject.active)(t):!1},Az=function(t,r,n){return n(r)(t)},dw=function(t){var r=t.target,n=t.destination,a=t.viewport,i=t.withDroppableDisplacement,o=t.isVisibleThroughFrameFn,c=i?Tz(r,n):r;return Cz(c,n,o)&&Az(c,a,o)},kz=function(t){return dw(ct({},t,{isVisibleThroughFrameFn:mO}))},xO=function(t){return dw(ct({},t,{isVisibleThroughFrameFn:Sz}))},Fz=function(t){return dw(ct({},t,{isVisibleThroughFrameFn:Ez(t.destination.axis)}))},Oz=function(t,r,n){if(typeof n=="boolean")return n;if(!r)return!0;var a=r.invisible,i=r.visible;if(a[t])return!1;var o=i[t];return o?o.shouldAnimate:!0};function Pz(e,t){var r=e.page.marginBox,n={top:t.point.y,right:0,bottom:0,left:t.point.x};return gi(iw(r,n))}function zd(e){var t=e.afterDragging,r=e.destination,n=e.displacedBy,a=e.viewport,i=e.forceShouldAnimate,o=e.last;return t.reduce(function(l,u){var d=Pz(u,n),f=u.descriptor.id;l.all.push(f);var h=kz({target:d,destination:r,viewport:a,withDroppableDisplacement:!0});if(!h)return l.invisible[u.descriptor.id]=!0,l;var m=Oz(f,o,i),x={draggableId:f,shouldAnimate:m};return l.visible[f]=x,l},{all:[],visible:{},invisible:{}})}function Iz(e,t){if(!e.length)return 0;var r=e[e.length-1].descriptor.index;return t.inHomeList?r:r+1}function WD(e){var t=e.insideDestination,r=e.inHomeList,n=e.displacedBy,a=e.destination,i=Iz(t,{inHomeList:r});return{displaced:Wd,displacedBy:n,at:{type:"REORDER",destination:{droppableId:a.descriptor.id,index:i}}}}function rp(e){var t=e.draggable,r=e.insideDestination,n=e.destination,a=e.viewport,i=e.displacedBy,o=e.last,c=e.index,l=e.forceShouldAnimate,u=fu(t,n);if(c==null)return WD({insideDestination:r,inHomeList:u,displacedBy:i,destination:n});var d=yo(r,function(p){return p.descriptor.index===c});if(!d)return WD({insideDestination:r,inHomeList:u,displacedBy:i,destination:n});var f=c0(t,r),h=r.indexOf(d),m=f.slice(h),x=zd({afterDragging:m,destination:n,displacedBy:i,last:o,viewport:a.frame,forceShouldAnimate:l});return{displaced:x,displacedBy:i,at:{type:"REORDER",destination:{droppableId:n.descriptor.id,index:c}}}}function co(e,t){return!!t.effected[e]}var Uz=function(e){var t=e.isMovingForward,r=e.destination,n=e.draggables,a=e.combine,i=e.afterCritical;if(!r.isCombineEnabled)return null;var o=a.draggableId,c=n[o],l=c.descriptor.index,u=co(o,i);return u?t?l:l-1:t?l+1:l},Rz=function(e){var t=e.isMovingForward,r=e.isInHomeList,n=e.insideDestination,a=e.location;if(!n.length)return null;var i=a.index,o=t?i+1:i-1,c=n[0].descriptor.index,l=n[n.length-1].descriptor.index,u=r?l:l+1;return o<c||o>u?null:o},Mz=function(e){var t=e.isMovingForward,r=e.isInHomeList,n=e.draggable,a=e.draggables,i=e.destination,o=e.insideDestination,c=e.previousImpact,l=e.viewport,u=e.afterCritical,d=c.at;if(d||We(),d.type==="REORDER"){var f=Rz({isMovingForward:t,isInHomeList:r,location:d.destination,insideDestination:o});return f==null?null:rp({draggable:n,insideDestination:o,destination:i,viewport:l,last:c.displaced,displacedBy:c.displacedBy,index:f})}var h=Uz({isMovingForward:t,destination:i,displaced:c.displaced,draggables:a,combine:d.combine,afterCritical:u});return h==null?null:rp({draggable:n,insideDestination:o,destination:i,viewport:l,last:c.displaced,displacedBy:c.displacedBy,index:h})},Bz=function(e){var t=e.displaced,r=e.afterCritical,n=e.combineWith,a=e.displacedBy,i=!!(t.visible[n]||t.invisible[n]);return co(n,r)?i?rn:uu(a.point):i?a.point:rn},Lz=function(e){var t=e.afterCritical,r=e.impact,n=e.draggables,a=o0(r);a||We();var i=a.draggableId,o=n[i].page.borderBox.center,c=Bz({displaced:r.displaced,afterCritical:t,combineWith:i,displacedBy:r.displacedBy});return pn(o,c)},gO=function(t,r){return r.margin[t.start]+r.borderBox[t.size]/2},$z=function(t,r){return r.margin[t.end]+r.borderBox[t.size]/2},fw=function(t,r,n){return r[t.crossAxisStart]+n.margin[t.crossAxisStart]+n.borderBox[t.crossAxisSize]/2},zD=function(t){var r=t.axis,n=t.moveRelativeTo,a=t.isMoving;return dc(r.line,n.marginBox[r.end]+gO(r,a),fw(r,n.marginBox,a))},qD=function(t){var r=t.axis,n=t.moveRelativeTo,a=t.isMoving;return dc(r.line,n.marginBox[r.start]-$z(r,a),fw(r,n.marginBox,a))},Wz=function(t){var r=t.axis,n=t.moveInto,a=t.isMoving;return dc(r.line,n.contentBox[r.start]+gO(r,a),fw(r,n.contentBox,a))},zz=function(e){var t=e.impact,r=e.draggable,n=e.draggables,a=e.droppable,i=e.afterCritical,o=du(a.descriptor.id,n),c=r.page,l=a.axis;if(!o.length)return Wz({axis:l,moveInto:a.page,isMoving:c});var u=t.displaced,d=t.displacedBy,f=u.all[0];if(f){var h=n[f];if(co(f,i))return qD({axis:l,moveRelativeTo:h.page,isMoving:c});var m=Zm(h.page,d.point);return qD({axis:l,moveRelativeTo:m,isMoving:c})}var x=o[o.length-1];if(x.descriptor.id===r.descriptor.id)return c.borderBox.center;if(co(x.descriptor.id,i)){var p=Zm(x.page,uu(i.displacedBy.point));return zD({axis:l,moveRelativeTo:p,isMoving:c})}return zD({axis:l,moveRelativeTo:x.page,isMoving:c})},$b=function(e,t){var r=e.frame;return r?pn(t,r.scroll.diff.displacement):t},qz=function(t){var r=t.impact,n=t.draggable,a=t.droppable,i=t.draggables,o=t.afterCritical,c=n.page.borderBox.center,l=r.at;return!a||!l?c:l.type==="REORDER"?zz({impact:r,draggable:n,draggables:i,droppable:a,afterCritical:o}):Lz({impact:r,draggables:i,afterCritical:o})},l0=function(e){var t=qz(e),r=e.droppable,n=r?$b(r,t):t;return n},vO=function(e,t){var r=ja(t,e.scroll.initial),n=uu(r),a=gi({top:t.y,bottom:t.y+e.frame.height,left:t.x,right:t.x+e.frame.width}),i={frame:a,scroll:{initial:e.scroll.initial,max:e.scroll.max,current:t,diff:{value:r,displacement:n}}};return i};function HD(e,t){return e.map(function(r){return t[r]})}function Hz(e,t){for(var r=0;r<t.length;r++){var n=t[r].visible[e];if(n)return n}return null}var Vz=function(e){var t=e.impact,r=e.viewport,n=e.destination,a=e.draggables,i=e.maxScrollChange,o=vO(r,pn(r.scroll.current,i)),c=n.frame?ow(n,pn(n.frame.scroll.current,i)):n,l=t.displaced,u=zd({afterDragging:HD(l.all,a),destination:n,displacedBy:t.displacedBy,viewport:o.frame,last:l,forceShouldAnimate:!1}),d=zd({afterDragging:HD(l.all,a),destination:c,displacedBy:t.displacedBy,viewport:r.frame,last:l,forceShouldAnimate:!1}),f={},h={},m=[l,u,d];l.all.forEach(function(p){var g=Hz(p,m);if(g){h[p]=g;return}f[p]=!0});var x=ct({},t,{displaced:{all:l.all,invisible:f,visible:h}});return x},Gz=function(e,t){return pn(e.scroll.diff.displacement,t)},hw=function(e){var t=e.pageBorderBoxCenter,r=e.draggable,n=e.viewport,a=Gz(n,t),i=ja(a,r.page.borderBox.center);return pn(r.client.borderBox.center,i)},yO=function(e){var t=e.draggable,r=e.destination,n=e.newPageBorderBoxCenter,a=e.viewport,i=e.withDroppableDisplacement,o=e.onlyOnMainAxis,c=o===void 0?!1:o,l=ja(n,t.page.borderBox.center),u=yh(t.page.borderBox,l),d={target:u,destination:r,withDroppableDisplacement:i,viewport:a};return c?Fz(d):xO(d)},Xz=function(e){var t=e.isMovingForward,r=e.draggable,n=e.destination,a=e.draggables,i=e.previousImpact,o=e.viewport,c=e.previousPageBorderBoxCenter,l=e.previousClientSelection,u=e.afterCritical;if(!n.isEnabled)return null;var d=du(n.descriptor.id,a),f=fu(r,n),h=Nz({isMovingForward:t,draggable:r,destination:n,insideDestination:d,previousImpact:i})||Mz({isMovingForward:t,isInHomeList:f,draggable:r,draggables:a,destination:n,insideDestination:d,previousImpact:i,viewport:o,afterCritical:u});if(!h)return null;var m=l0({impact:h,draggable:r,droppable:n,draggables:a,afterCritical:u}),x=yO({draggable:r,destination:n,newPageBorderBoxCenter:m,viewport:o.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0});if(x){var p=hw({pageBorderBoxCenter:m,draggable:r,viewport:o});return{clientSelection:p,impact:h,scrollJumpRequest:null}}var g=ja(m,c),v=Vz({impact:h,viewport:o,destination:n,draggables:a,maxScrollChange:g});return{clientSelection:l,impact:v,scrollJumpRequest:g}},Ln=function(t){var r=t.subject.active;return r||We(),r},Kz=function(e){var t=e.isMovingForward,r=e.pageBorderBoxCenter,n=e.source,a=e.droppables,i=e.viewport,o=n.subject.active;if(!o)return null;var c=n.axis,l=ti(o[c.start],o[c.end]),u=s0(a).filter(function(f){return f!==n}).filter(function(f){return f.isEnabled}).filter(function(f){return!!f.subject.active}).filter(function(f){return mO(i.frame)(Ln(f))}).filter(function(f){var h=Ln(f);return t?o[c.crossAxisEnd]<h[c.crossAxisEnd]:h[c.crossAxisStart]<o[c.crossAxisStart]}).filter(function(f){var h=Ln(f),m=ti(h[c.start],h[c.end]);return l(h[c.start])||l(h[c.end])||m(o[c.start])||m(o[c.end])}).sort(function(f,h){var m=Ln(f)[c.crossAxisStart],x=Ln(h)[c.crossAxisStart];return t?m-x:x-m}).filter(function(f,h,m){return Ln(f)[c.crossAxisStart]===Ln(m[0])[c.crossAxisStart]});if(!u.length)return null;if(u.length===1)return u[0];var d=u.filter(function(f){var h=ti(Ln(f)[c.start],Ln(f)[c.end]);return h(r[c.line])});return d.length===1?d[0]:d.length>1?d.sort(function(f,h){return Ln(f)[c.start]-Ln(h)[c.start]})[0]:u.sort(function(f,h){var m=LD(r,$D(Ln(f))),x=LD(r,$D(Ln(h)));return m!==x?m-x:Ln(f)[c.start]-Ln(h)[c.start]})[0]},VD=function(t,r){var n=t.page.borderBox.center;return co(t.descriptor.id,r)?ja(n,r.displacedBy.point):n},Yz=function(t,r){var n=t.page.borderBox;return co(t.descriptor.id,r)?yh(n,uu(r.displacedBy.point)):n},Zz=function(e){var t=e.pageBorderBoxCenter,r=e.viewport,n=e.destination,a=e.insideDestination,i=e.afterCritical,o=a.filter(function(c){return xO({target:Yz(c,i),destination:n,viewport:r.frame,withDroppableDisplacement:!0})}).sort(function(c,l){var u=$d(t,$b(n,VD(c,i))),d=$d(t,$b(n,VD(l,i)));return u<d?-1:d<u?1:c.descriptor.index-l.descriptor.index});return o[0]||null},bh=tn(function(t,r){var n=r[t.line];return{value:n,point:dc(t.line,n)}}),Jz=function(t,r,n){var a=t.axis;if(t.descriptor.mode==="virtual")return dc(a.line,r[a.line]);var i=t.subject.page.contentBox[a.size],o=du(t.descriptor.id,n),c=o.reduce(function(d,f){return d+f.client.marginBox[a.size]},0),l=c+r[a.line],u=l-i;return u<=0?null:dc(a.line,u)},bO=function(t,r){return ct({},t,{scroll:ct({},t.scroll,{max:r})})},wO=function(t,r,n){var a=t.frame;fu(r,t)&&We(),t.subject.withPlaceholder&&We();var i=bh(t.axis,r.displaceBy).point,o=Jz(t,i,n),c={placeholderSize:i,increasedBy:o,oldFrameMaxScroll:t.frame?t.frame.scroll.max:null};if(!a){var l=jl({page:t.subject.page,withPlaceholder:c,axis:t.axis,frame:t.frame});return ct({},t,{subject:l})}var u=o?pn(a.scroll.max,o):a.scroll.max,d=bO(a,u),f=jl({page:t.subject.page,withPlaceholder:c,axis:t.axis,frame:d});return ct({},t,{subject:f,frame:d})},Qz=function(t){var r=t.subject.withPlaceholder;r||We();var n=t.frame;if(!n){var a=jl({page:t.subject.page,axis:t.axis,frame:null,withPlaceholder:null});return ct({},t,{subject:a})}var i=r.oldFrameMaxScroll;i||We();var o=bO(n,i),c=jl({page:t.subject.page,axis:t.axis,frame:o,withPlaceholder:null});return ct({},t,{subject:c,frame:o})},eq=function(e){var t=e.previousPageBorderBoxCenter,r=e.moveRelativeTo,n=e.insideDestination,a=e.draggable,i=e.draggables,o=e.destination,c=e.viewport,l=e.afterCritical;if(!r){if(n.length)return null;var u={displaced:Wd,displacedBy:hO,at:{type:"REORDER",destination:{droppableId:o.descriptor.id,index:0}}},d=l0({impact:u,draggable:a,droppable:o,draggables:i,afterCritical:l}),f=fu(a,o)?o:wO(o,a,i),h=yO({draggable:a,destination:f,newPageBorderBoxCenter:d,viewport:c.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0});return h?u:null}var m=t[o.axis.line]<=r.page.borderBox.center[o.axis.line],x=function(){var g=r.descriptor.index;return r.descriptor.id===a.descriptor.id||m?g:g+1}(),p=bh(o.axis,a.displaceBy);return rp({draggable:a,insideDestination:n,destination:o,viewport:c,displacedBy:p,last:Wd,index:x})},tq=function(e){var t=e.isMovingForward,r=e.previousPageBorderBoxCenter,n=e.draggable,a=e.isOver,i=e.draggables,o=e.droppables,c=e.viewport,l=e.afterCritical,u=Kz({isMovingForward:t,pageBorderBoxCenter:r,source:a,droppables:o,viewport:c});if(!u)return null;var d=du(u.descriptor.id,i),f=Zz({pageBorderBoxCenter:r,viewport:c,destination:u,insideDestination:d,afterCritical:l}),h=eq({previousPageBorderBoxCenter:r,destination:u,draggable:n,draggables:i,moveRelativeTo:f,insideDestination:d,viewport:c,afterCritical:l});if(!h)return null;var m=l0({impact:h,draggable:n,droppable:u,draggables:i,afterCritical:l}),x=hw({pageBorderBoxCenter:m,draggable:n,viewport:c});return{clientSelection:x,impact:h,scrollJumpRequest:null}},Na=function(e){var t=e.at;return t?t.type==="REORDER"?t.destination.droppableId:t.combine.droppableId:null},rq=function(t,r){var n=Na(t);return n?r[n]:null},nq=function(e){var t=e.state,r=e.type,n=rq(t.impact,t.dimensions.droppables),a=!!n,i=t.dimensions.droppables[t.critical.droppable.id],o=n||i,c=o.axis.direction,l=c==="vertical"&&(r==="MOVE_UP"||r==="MOVE_DOWN")||c==="horizontal"&&(r==="MOVE_LEFT"||r==="MOVE_RIGHT");if(l&&!a)return null;var u=r==="MOVE_DOWN"||r==="MOVE_RIGHT",d=t.dimensions.draggables[t.critical.draggable.id],f=t.current.page.borderBoxCenter,h=t.dimensions,m=h.draggables,x=h.droppables;return l?Xz({isMovingForward:u,previousPageBorderBoxCenter:f,draggable:d,destination:o,draggables:m,viewport:t.viewport,previousClientSelection:t.current.client.selection,previousImpact:t.impact,afterCritical:t.afterCritical}):tq({isMovingForward:u,previousPageBorderBoxCenter:f,draggable:d,isOver:o,draggables:m,droppables:x,viewport:t.viewport,afterCritical:t.afterCritical})};function zo(e){return e.phase==="DRAGGING"||e.phase==="COLLECTING"}function _O(e){var t=ti(e.top,e.bottom),r=ti(e.left,e.right);return function(a){return t(a.y)&&r(a.x)}}function aq(e,t){return e.left<t.right&&e.right>t.left&&e.top<t.bottom&&e.bottom>t.top}function iq(e){var t=e.pageBorderBox,r=e.draggable,n=e.candidates,a=r.page.borderBox.center,i=n.map(function(o){var c=o.axis,l=dc(o.axis.line,t.center[c.line],o.page.borderBox.center[c.crossAxisLine]);return{id:o.descriptor.id,distance:$d(a,l)}}).sort(function(o,c){return c.distance-o.distance});return i[0]?i[0].id:null}function sq(e){var t=e.pageBorderBox,r=e.draggable,n=e.droppables,a=s0(n).filter(function(i){if(!i.isEnabled)return!1;var o=i.subject.active;if(!o||!aq(t,o))return!1;if(_O(o)(t.center))return!0;var c=i.axis,l=o.center[c.crossAxisLine],u=t[c.crossAxisStart],d=t[c.crossAxisEnd],f=ti(o[c.crossAxisStart],o[c.crossAxisEnd]),h=f(u),m=f(d);return!h&&!m?!0:h?u<l:d>l});return a.length?a.length===1?a[0].descriptor.id:iq({pageBorderBox:t,draggable:r,candidates:a}):null}var jO=function(t,r){return gi(yh(t,r))},oq=function(e,t){var r=e.frame;return r?jO(t,r.scroll.diff.value):t};function NO(e){var t=e.displaced,r=e.id;return!!(t.visible[r]||t.invisible[r])}function cq(e){var t=e.draggable,r=e.closest,n=e.inHomeList;return r?n&&r.descriptor.index>t.descriptor.index?r.descriptor.index-1:r.descriptor.index:null}var lq=function(e){var t=e.pageBorderBoxWithDroppableScroll,r=e.draggable,n=e.destination,a=e.insideDestination,i=e.last,o=e.viewport,c=e.afterCritical,l=n.axis,u=bh(n.axis,r.displaceBy),d=u.value,f=t[l.start],h=t[l.end],m=c0(r,a),x=yo(m,function(g){var v=g.descriptor.id,y=g.page.borderBox.center[l.line],b=co(v,c),_=NO({displaced:i,id:v});return b?_?h<=y:f<y-d:_?h<=y+d:f<y}),p=cq({draggable:r,closest:x,inHomeList:fu(r,n)});return rp({draggable:r,insideDestination:a,destination:n,viewport:o,last:i,displacedBy:u,index:p})},uq=4,dq=function(e){var t=e.draggable,r=e.pageBorderBoxWithDroppableScroll,n=e.previousImpact,a=e.destination,i=e.insideDestination,o=e.afterCritical;if(!a.isCombineEnabled)return null;var c=a.axis,l=bh(a.axis,t.displaceBy),u=l.value,d=r[c.start],f=r[c.end],h=c0(t,i),m=yo(h,function(p){var g=p.descriptor.id,v=p.page.borderBox,y=v[c.size],b=y/uq,_=co(g,o),w=NO({displaced:n.displaced,id:g});return _?w?f>v[c.start]+b&&f<v[c.end]-b:d>v[c.start]-u+b&&d<v[c.end]-u-b:w?f>v[c.start]+u+b&&f<v[c.end]+u-b:d>v[c.start]+b&&d<v[c.end]-b});if(!m)return null;var x={displacedBy:l,displaced:n.displaced,at:{type:"COMBINE",combine:{draggableId:m.descriptor.id,droppableId:a.descriptor.id}}};return x},DO=function(e){var t=e.pageOffset,r=e.draggable,n=e.draggables,a=e.droppables,i=e.previousImpact,o=e.viewport,c=e.afterCritical,l=jO(r.page.borderBox,t),u=sq({pageBorderBox:l,draggable:r,droppables:a});if(!u)return Dz;var d=a[u],f=du(d.descriptor.id,n),h=oq(d,l);return dq({pageBorderBoxWithDroppableScroll:h,draggable:r,previousImpact:i,destination:d,insideDestination:f,afterCritical:c})||lq({pageBorderBoxWithDroppableScroll:h,draggable:r,destination:d,insideDestination:f,last:i.displaced,viewport:o,afterCritical:c})},mw=function(e,t){var r;return ct({},e,(r={},r[t.descriptor.id]=t,r))},fq=function(t){var r=t.previousImpact,n=t.impact,a=t.droppables,i=Na(r),o=Na(n);if(!i||i===o)return a;var c=a[i];if(!c.subject.withPlaceholder)return a;var l=Qz(c);return mw(a,l)},hq=function(e){var t=e.draggable,r=e.draggables,n=e.droppables,a=e.previousImpact,i=e.impact,o=fq({previousImpact:a,impact:i,droppables:n}),c=Na(i);if(!c)return o;var l=n[c];if(fu(t,l)||l.subject.withPlaceholder)return o;var u=wO(l,t,r);return mw(o,u)},wd=function(e){var t=e.state,r=e.clientSelection,n=e.dimensions,a=e.viewport,i=e.impact,o=e.scrollJumpRequest,c=a||t.viewport,l=n||t.dimensions,u=r||t.current.client.selection,d=ja(u,t.initial.client.selection),f={offset:d,selection:u,borderBoxCenter:pn(t.initial.client.borderBoxCenter,d)},h={selection:pn(f.selection,c.scroll.current),borderBoxCenter:pn(f.borderBoxCenter,c.scroll.current),offset:pn(f.offset,c.scroll.diff.value)},m={client:f,page:h};if(t.phase==="COLLECTING")return ct({phase:"COLLECTING"},t,{dimensions:l,viewport:c,current:m});var x=l.draggables[t.critical.draggable.id],p=i||DO({pageOffset:h.offset,draggable:x,draggables:l.draggables,droppables:l.droppables,previousImpact:t.impact,viewport:c,afterCritical:t.afterCritical}),g=hq({draggable:x,impact:p,previousImpact:t.impact,draggables:l.draggables,droppables:l.droppables}),v=ct({},t,{current:m,dimensions:{draggables:l.draggables,droppables:g},impact:p,viewport:c,scrollJumpRequest:o||null,forceShouldAnimate:o?!1:null});return v};function mq(e,t){return e.map(function(r){return t[r]})}var SO=function(e){var t=e.impact,r=e.viewport,n=e.draggables,a=e.destination,i=e.forceShouldAnimate,o=t.displaced,c=mq(o.all,n),l=zd({afterDragging:c,destination:a,displacedBy:t.displacedBy,viewport:r.frame,forceShouldAnimate:i,last:o});return ct({},t,{displaced:l})},EO=function(e){var t=e.impact,r=e.draggable,n=e.droppable,a=e.draggables,i=e.viewport,o=e.afterCritical,c=l0({impact:t,draggable:r,draggables:a,droppable:n,afterCritical:o});return hw({pageBorderBoxCenter:c,draggable:r,viewport:i})},TO=function(e){var t=e.state,r=e.dimensions,n=e.viewport;t.movementMode!=="SNAP"&&We();var a=t.impact,i=n||t.viewport,o=r||t.dimensions,c=o.draggables,l=o.droppables,u=c[t.critical.draggable.id],d=Na(a);d||We();var f=l[d],h=SO({impact:a,viewport:i,destination:f,draggables:c}),m=EO({impact:h,draggable:u,droppable:f,draggables:c,viewport:i,afterCritical:t.afterCritical});return wd({impact:h,clientSelection:m,state:t,dimensions:o,viewport:i})},pq=function(e){return{index:e.index,droppableId:e.droppableId}},CO=function(e){var t=e.draggable,r=e.home,n=e.draggables,a=e.viewport,i=bh(r.axis,t.displaceBy),o=du(r.descriptor.id,n),c=o.indexOf(t);c===-1&&We();var l=o.slice(c+1),u=l.reduce(function(m,x){return m[x.descriptor.id]=!0,m},{}),d={inVirtualList:r.descriptor.mode==="virtual",displacedBy:i,effected:u},f=zd({afterDragging:l,destination:r,displacedBy:i,last:null,viewport:a.frame,forceShouldAnimate:!1}),h={displaced:f,displacedBy:i,at:{type:"REORDER",destination:pq(t.descriptor)}};return{impact:h,afterCritical:d}},xq=function(e,t){return{draggables:e.draggables,droppables:mw(e.droppables,t)}},gq=function(e){var t=e.draggable,r=e.offset,n=e.initialWindowScroll,a=Zm(t.client,r),i=Jm(a,n),o=ct({},t,{placeholder:ct({},t.placeholder,{client:a}),client:a,page:i});return o},vq=function(e){var t=e.frame;return t||We(),t},yq=function(e){var t=e.additions,r=e.updatedDroppables,n=e.viewport,a=n.scroll.diff.value;return t.map(function(i){var o=i.descriptor.droppableId,c=r[o],l=vq(c),u=l.scroll.diff.value,d=pn(a,u),f=gq({draggable:i,offset:d,initialWindowScroll:n.scroll.initial});return f})},bq=function(e){var t=e.state,r=e.published,n=r.modified.map(function(b){var _=t.dimensions.droppables[b.droppableId],w=ow(_,b.scroll);return w}),a=ct({},t.dimensions.droppables,{},dO(n)),i=fO(yq({additions:r.additions,updatedDroppables:a,viewport:t.viewport})),o=ct({},t.dimensions.draggables,{},i);r.removals.forEach(function(b){delete o[b]});var c={droppables:a,draggables:o},l=Na(t.impact),u=l?c.droppables[l]:null,d=c.draggables[t.critical.draggable.id],f=c.droppables[t.critical.droppable.id],h=CO({draggable:d,home:f,draggables:o,viewport:t.viewport}),m=h.impact,x=h.afterCritical,p=u&&u.isCombineEnabled?t.impact:m,g=DO({pageOffset:t.current.page.offset,draggable:c.draggables[t.critical.draggable.id],draggables:c.draggables,droppables:c.droppables,previousImpact:p,viewport:t.viewport,afterCritical:x}),v=ct({phase:"DRAGGING"},t,{phase:"DRAGGING",impact:g,onLiftImpact:m,dimensions:c,afterCritical:x,forceShouldAnimate:!1});if(t.phase==="COLLECTING")return v;var y=ct({phase:"DROP_PENDING"},v,{phase:"DROP_PENDING",reason:t.reason,isWaiting:!1});return y},Wb=function(t){return t.movementMode==="SNAP"},yv=function(t,r,n){var a=xq(t.dimensions,r);return!Wb(t)||n?wd({state:t,dimensions:a}):TO({state:t,dimensions:a})};function bv(e){return e.isDragging&&e.movementMode==="SNAP"?ct({phase:"DRAGGING"},e,{scrollJumpRequest:null}):e}var GD={phase:"IDLE",completed:null,shouldFlush:!1},wq=function(e,t){if(e===void 0&&(e=GD),t.type==="FLUSH")return ct({},GD,{shouldFlush:!0});if(t.type==="INITIAL_PUBLISH"){e.phase!=="IDLE"&&We();var r=t.payload,n=r.critical,a=r.clientSelection,i=r.viewport,o=r.dimensions,c=r.movementMode,l=o.draggables[n.draggable.id],u=o.droppables[n.droppable.id],d={selection:a,borderBoxCenter:l.client.borderBox.center,offset:rn},f={client:d,page:{selection:pn(d.selection,i.scroll.initial),borderBoxCenter:pn(d.selection,i.scroll.initial),offset:pn(d.selection,i.scroll.diff.value)}},h=s0(o.droppables).every(function(pe){return!pe.isFixedOnPage}),m=CO({draggable:l,home:u,draggables:o.draggables,viewport:i}),x=m.impact,p=m.afterCritical,g={phase:"DRAGGING",isDragging:!0,critical:n,movementMode:c,dimensions:o,initial:f,current:f,isWindowScrollAllowed:h,impact:x,afterCritical:p,onLiftImpact:x,viewport:i,scrollJumpRequest:null,forceShouldAnimate:null};return g}if(t.type==="COLLECTION_STARTING"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&We();var v=ct({phase:"COLLECTING"},e,{phase:"COLLECTING"});return v}if(t.type==="PUBLISH_WHILE_DRAGGING")return e.phase==="COLLECTING"||e.phase==="DROP_PENDING"||We(),bq({state:e,published:t.payload});if(t.type==="MOVE"){if(e.phase==="DROP_PENDING")return e;zo(e)||We();var y=t.payload.client;return ro(y,e.current.client.selection)?e:wd({state:e,clientSelection:y,impact:Wb(e)?e.impact:null})}if(t.type==="UPDATE_DROPPABLE_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="COLLECTING")return bv(e);zo(e)||We();var b=t.payload,_=b.id,w=b.newScroll,j=e.dimensions.droppables[_];if(!j)return e;var N=ow(j,w);return yv(e,N,!1)}if(t.type==="UPDATE_DROPPABLE_IS_ENABLED"){if(e.phase==="DROP_PENDING")return e;zo(e)||We();var D=t.payload,S=D.id,T=D.isEnabled,A=e.dimensions.droppables[S];A||We(),A.isEnabled===T&&We();var E=ct({},A,{isEnabled:T});return yv(e,E,!0)}if(t.type==="UPDATE_DROPPABLE_IS_COMBINE_ENABLED"){if(e.phase==="DROP_PENDING")return e;zo(e)||We();var M=t.payload,P=M.id,X=M.isCombineEnabled,q=e.dimensions.droppables[P];q||We(),q.isCombineEnabled===X&&We();var B=ct({},q,{isCombineEnabled:X});return yv(e,B,!0)}if(t.type==="MOVE_BY_WINDOW_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="DROP_ANIMATING")return e;zo(e)||We(),e.isWindowScrollAllowed||We();var O=t.payload.newScroll;if(ro(e.viewport.scroll.current,O))return bv(e);var F=vO(e.viewport,O);return Wb(e)?TO({state:e,viewport:F}):wd({state:e,viewport:F})}if(t.type==="UPDATE_VIEWPORT_MAX_SCROLL"){if(!zo(e))return e;var I=t.payload.maxScroll;if(ro(I,e.viewport.scroll.max))return e;var L=ct({},e.viewport,{scroll:ct({},e.viewport.scroll,{max:I})});return ct({phase:"DRAGGING"},e,{viewport:L})}if(t.type==="MOVE_UP"||t.type==="MOVE_DOWN"||t.type==="MOVE_LEFT"||t.type==="MOVE_RIGHT"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&We();var C=nq({state:e,type:t.type});return C?wd({state:e,impact:C.impact,clientSelection:C.clientSelection,scrollJumpRequest:C.scrollJumpRequest}):e}if(t.type==="DROP_PENDING"){var k=t.payload.reason;e.phase!=="COLLECTING"&&We();var z=ct({phase:"DROP_PENDING"},e,{phase:"DROP_PENDING",isWaiting:!0,reason:k});return z}if(t.type==="DROP_ANIMATE"){var V=t.payload,Z=V.completed,ce=V.dropDuration,ie=V.newHomeClientOffset;e.phase==="DRAGGING"||e.phase==="DROP_PENDING"||We();var Q={phase:"DROP_ANIMATING",completed:Z,dropDuration:ce,newHomeClientOffset:ie,dimensions:e.dimensions};return Q}if(t.type==="DROP_COMPLETE"){var ne=t.payload.completed;return{phase:"IDLE",completed:ne,shouldFlush:!1}}return e},_q=function(t){return{type:"BEFORE_INITIAL_CAPTURE",payload:t}},jq=function(t){return{type:"LIFT",payload:t}},Nq=function(t){return{type:"INITIAL_PUBLISH",payload:t}},Dq=function(t){return{type:"PUBLISH_WHILE_DRAGGING",payload:t}},Sq=function(){return{type:"COLLECTION_STARTING",payload:null}},Eq=function(t){return{type:"UPDATE_DROPPABLE_SCROLL",payload:t}},Tq=function(t){return{type:"UPDATE_DROPPABLE_IS_ENABLED",payload:t}},Cq=function(t){return{type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:t}},AO=function(t){return{type:"MOVE",payload:t}},Aq=function(t){return{type:"MOVE_BY_WINDOW_SCROLL",payload:t}},kq=function(t){return{type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:t}},Fq=function(){return{type:"MOVE_UP",payload:null}},Oq=function(){return{type:"MOVE_DOWN",payload:null}},Pq=function(){return{type:"MOVE_RIGHT",payload:null}},Iq=function(){return{type:"MOVE_LEFT",payload:null}},pw=function(){return{type:"FLUSH",payload:null}},Uq=function(t){return{type:"DROP_ANIMATE",payload:t}},xw=function(t){return{type:"DROP_COMPLETE",payload:t}},kO=function(t){return{type:"DROP",payload:t}},Rq=function(t){return{type:"DROP_PENDING",payload:t}},FO=function(){return{type:"DROP_ANIMATION_FINISHED",payload:null}},Mq=function(e){return function(t){var r=t.getState,n=t.dispatch;return function(a){return function(i){if(i.type!=="LIFT"){a(i);return}var o=i.payload,c=o.id,l=o.clientSelection,u=o.movementMode,d=r();d.phase==="DROP_ANIMATING"&&n(xw({completed:d.completed})),r().phase!=="IDLE"&&We(),n(pw()),n(_q({draggableId:c,movementMode:u}));var f={shouldPublishImmediately:u==="SNAP"},h={draggableId:c,scrollOptions:f},m=e.startPublishing(h),x=m.critical,p=m.dimensions,g=m.viewport;n(Nq({critical:x,dimensions:p,clientSelection:l,movementMode:u,viewport:g}))}}}},Bq=function(e){return function(){return function(t){return function(r){r.type==="INITIAL_PUBLISH"&&e.dragging(),r.type==="DROP_ANIMATE"&&e.dropping(r.payload.completed.result.reason),(r.type==="FLUSH"||r.type==="DROP_COMPLETE")&&e.resting(),t(r)}}}},gw={outOfTheWay:"cubic-bezier(0.2, 0, 0, 1)",drop:"cubic-bezier(.2,1,.1,1)"},qd={opacity:{drop:0,combining:.7},scale:{drop:.75}},vw={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},Ro=vw.outOfTheWay+"s "+gw.outOfTheWay,_d={fluid:"opacity "+Ro,snap:"transform "+Ro+", opacity "+Ro,drop:function(t){var r=t+"s "+gw.drop;return"transform "+r+", opacity "+r},outOfTheWay:"transform "+Ro,placeholder:"height "+Ro+", width "+Ro+", margin "+Ro},XD=function(t){return ro(t,rn)?null:"translate("+t.x+"px, "+t.y+"px)"},zb={moveTo:XD,drop:function(t,r){var n=XD(t);return n?r?n+" scale("+qd.scale.drop+")":n:null}},qb=vw.minDropTime,OO=vw.maxDropTime,Lq=OO-qb,KD=1500,$q=.6,Wq=function(e){var t=e.current,r=e.destination,n=e.reason,a=$d(t,r);if(a<=0)return qb;if(a>=KD)return OO;var i=a/KD,o=qb+Lq*i,c=n==="CANCEL"?o*$q:o;return Number(c.toFixed(2))},zq=function(e){var t=e.impact,r=e.draggable,n=e.dimensions,a=e.viewport,i=e.afterCritical,o=n.draggables,c=n.droppables,l=Na(t),u=l?c[l]:null,d=c[r.descriptor.droppableId],f=EO({impact:t,draggable:r,draggables:o,afterCritical:i,droppable:u||d,viewport:a}),h=ja(f,r.client.borderBox.center);return h},qq=function(e){var t=e.draggables,r=e.reason,n=e.lastImpact,a=e.home,i=e.viewport,o=e.onLiftImpact;if(!n.at||r!=="DROP"){var c=SO({draggables:t,impact:o,destination:a,viewport:i,forceShouldAnimate:!0});return{impact:c,didDropInsideDroppable:!1}}if(n.at.type==="REORDER")return{impact:n,didDropInsideDroppable:!0};var l=ct({},n,{displaced:Wd});return{impact:l,didDropInsideDroppable:!0}},Hq=function(e){var t=e.getState,r=e.dispatch;return function(n){return function(a){if(a.type!=="DROP"){n(a);return}var i=t(),o=a.payload.reason;if(i.phase==="COLLECTING"){r(Rq({reason:o}));return}if(i.phase!=="IDLE"){var c=i.phase==="DROP_PENDING"&&i.isWaiting;c&&We(),i.phase==="DRAGGING"||i.phase==="DROP_PENDING"||We();var l=i.critical,u=i.dimensions,d=u.draggables[i.critical.draggable.id],f=qq({reason:o,lastImpact:i.impact,afterCritical:i.afterCritical,onLiftImpact:i.onLiftImpact,home:i.dimensions.droppables[i.critical.droppable.id],viewport:i.viewport,draggables:i.dimensions.draggables}),h=f.impact,m=f.didDropInsideDroppable,x=m?lw(h):null,p=m?o0(h):null,g={index:l.draggable.index,droppableId:l.droppable.id},v={draggableId:d.descriptor.id,type:d.descriptor.type,source:g,reason:o,mode:i.movementMode,destination:x,combine:p},y=zq({impact:h,draggable:d,dimensions:u,viewport:i.viewport,afterCritical:i.afterCritical}),b={critical:i.critical,afterCritical:i.afterCritical,result:v,impact:h},_=!ro(i.current.client.offset,y)||!!v.combine;if(!_){r(xw({completed:b}));return}var w=Wq({current:i.current.client.offset,destination:y,reason:o}),j={newHomeClientOffset:y,dropDuration:w,completed:b};r(Uq(j))}}}},PO=function(){return{x:window.pageXOffset,y:window.pageYOffset}};function Vq(e){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(r){r.target!==window&&r.target!==window.document||e()}}}function Gq(e){var t=e.onWindowScroll;function r(){t(PO())}var n=Ld(r),a=Vq(n),i=to;function o(){return i!==to}function c(){o()&&We(),i=Za(window,[a])}function l(){o()||We(),n.cancel(),i(),i=to}return{start:c,stop:l,isActive:o}}var Xq=function(t){return t.type==="DROP_COMPLETE"||t.type==="DROP_ANIMATE"||t.type==="FLUSH"},Kq=function(e){var t=Gq({onWindowScroll:function(n){e.dispatch(Aq({newScroll:n}))}});return function(r){return function(n){!t.isActive()&&n.type==="INITIAL_PUBLISH"&&t.start(),t.isActive()&&Xq(n)&&t.stop(),r(n)}}},Yq=function(e){var t=!1,r=!1,n=setTimeout(function(){r=!0}),a=function(o){t||r||(t=!0,e(o),clearTimeout(n))};return a.wasCalled=function(){return t},a},Zq=function(){var e=[],t=function(i){var o=cw(e,function(u){return u.timerId===i});o===-1&&We();var c=e.splice(o,1),l=c[0];l.callback()},r=function(i){var o=setTimeout(function(){return t(o)}),c={timerId:o,callback:i};e.push(c)},n=function(){if(e.length){var i=[].concat(e);e.length=0,i.forEach(function(o){clearTimeout(o.timerId),o.callback()})}};return{add:r,flush:n}},Jq=function(t,r){return t==null&&r==null?!0:t==null||r==null?!1:t.droppableId===r.droppableId&&t.index===r.index},Qq=function(t,r){return t==null&&r==null?!0:t==null||r==null?!1:t.draggableId===r.draggableId&&t.droppableId===r.droppableId},eH=function(t,r){if(t===r)return!0;var n=t.draggable.id===r.draggable.id&&t.draggable.droppableId===r.draggable.droppableId&&t.draggable.type===r.draggable.type&&t.draggable.index===r.draggable.index,a=t.droppable.id===r.droppable.id&&t.droppable.type===r.droppable.type;return n&&a},Vu=function(t,r){r()},Yh=function(t,r){return{draggableId:t.draggable.id,type:t.droppable.type,source:{droppableId:t.droppable.id,index:t.draggable.index},mode:r}},wv=function(t,r,n,a){if(!t){n(a(r));return}var i=Yq(n),o={announce:i};t(r,o),i.wasCalled()||n(a(r))},tH=function(e,t){var r=Zq(),n=null,a=function(h,m){n&&We(),Vu("onBeforeCapture",function(){var x=e().onBeforeCapture;if(x){var p={draggableId:h,mode:m};x(p)}})},i=function(h,m){n&&We(),Vu("onBeforeDragStart",function(){var x=e().onBeforeDragStart;x&&x(Yh(h,m))})},o=function(h,m){n&&We();var x=Yh(h,m);n={mode:m,lastCritical:h,lastLocation:x.source,lastCombine:null},r.add(function(){Vu("onDragStart",function(){return wv(e().onDragStart,x,t,$m.onDragStart)})})},c=function(h,m){var x=lw(m),p=o0(m);n||We();var g=!eH(h,n.lastCritical);g&&(n.lastCritical=h);var v=!Jq(n.lastLocation,x);v&&(n.lastLocation=x);var y=!Qq(n.lastCombine,p);if(y&&(n.lastCombine=p),!(!g&&!v&&!y)){var b=ct({},Yh(h,n.mode),{combine:p,destination:x});r.add(function(){Vu("onDragUpdate",function(){return wv(e().onDragUpdate,b,t,$m.onDragUpdate)})})}},l=function(){n||We(),r.flush()},u=function(h){n||We(),n=null,Vu("onDragEnd",function(){return wv(e().onDragEnd,h,t,$m.onDragEnd)})},d=function(){if(n){var h=ct({},Yh(n.lastCritical,n.mode),{combine:null,destination:null,reason:"CANCEL"});u(h)}};return{beforeCapture:a,beforeStart:i,start:o,update:c,flush:l,drop:u,abort:d}},rH=function(e,t){var r=tH(e,t);return function(n){return function(a){return function(i){if(i.type==="BEFORE_INITIAL_CAPTURE"){r.beforeCapture(i.payload.draggableId,i.payload.movementMode);return}if(i.type==="INITIAL_PUBLISH"){var o=i.payload.critical;r.beforeStart(o,i.payload.movementMode),a(i),r.start(o,i.payload.movementMode);return}if(i.type==="DROP_COMPLETE"){var c=i.payload.completed.result;r.flush(),a(i),r.drop(c);return}if(a(i),i.type==="FLUSH"){r.abort();return}var l=n.getState();l.phase==="DRAGGING"&&r.update(l.critical,l.impact)}}}},nH=function(e){return function(t){return function(r){if(r.type!=="DROP_ANIMATION_FINISHED"){t(r);return}var n=e.getState();n.phase!=="DROP_ANIMATING"&&We(),e.dispatch(xw({completed:n.completed}))}}},aH=function(e){var t=null,r=null;function n(){r&&(cancelAnimationFrame(r),r=null),t&&(t(),t=null)}return function(a){return function(i){if((i.type==="FLUSH"||i.type==="DROP_COMPLETE"||i.type==="DROP_ANIMATION_FINISHED")&&n(),a(i),i.type==="DROP_ANIMATE"){var o={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){var l=e.getState();l.phase==="DROP_ANIMATING"&&e.dispatch(FO())}};r=requestAnimationFrame(function(){r=null,t=Za(window,[o])})}}}},iH=function(e){return function(){return function(t){return function(r){(r.type==="DROP_COMPLETE"||r.type==="FLUSH"||r.type==="DROP_ANIMATE")&&e.stopPublishing(),t(r)}}}},sH=function(e){var t=!1;return function(){return function(r){return function(n){if(n.type==="INITIAL_PUBLISH"){t=!0,e.tryRecordFocus(n.payload.critical.draggable.id),r(n),e.tryRestoreFocusRecorded();return}if(r(n),!!t){if(n.type==="FLUSH"){t=!1,e.tryRestoreFocusRecorded();return}if(n.type==="DROP_COMPLETE"){t=!1;var a=n.payload.completed.result;a.combine&&e.tryShiftRecord(a.draggableId,a.combine.draggableId),e.tryRestoreFocusRecorded()}}}}}},oH=function(t){return t.type==="DROP_COMPLETE"||t.type==="DROP_ANIMATE"||t.type==="FLUSH"},cH=function(e){return function(t){return function(r){return function(n){if(oH(n)){e.stop(),r(n);return}if(n.type==="INITIAL_PUBLISH"){r(n);var a=t.getState();a.phase!=="DRAGGING"&&We(),e.start(a);return}r(n),e.scroll(t.getState())}}}},lH=function(e){return function(t){return function(r){if(t(r),r.type==="PUBLISH_WHILE_DRAGGING"){var n=e.getState();n.phase==="DROP_PENDING"&&(n.isWaiting||e.dispatch(kO({reason:n.reason})))}}}},uH=RF,dH=function(e){var t=e.dimensionMarshal,r=e.focusMarshal,n=e.styleMarshal,a=e.getResponders,i=e.announce,o=e.autoScroller;return UF(wq,uH(G7(Bq(n),iH(t),Mq(t),Hq,nH,aH,lH,cH(o),Kq,sH(r),rH(a,i))))},_v=function(){return{additions:{},removals:{},modified:{}}};function fH(e){var t=e.registry,r=e.callbacks,n=_v(),a=null,i=function(){a||(r.collectionStarting(),a=requestAnimationFrame(function(){a=null;var d=n,f=d.additions,h=d.removals,m=d.modified,x=Object.keys(f).map(function(v){return t.draggable.getById(v).getDimension(rn)}).sort(function(v,y){return v.descriptor.index-y.descriptor.index}),p=Object.keys(m).map(function(v){var y=t.droppable.getById(v),b=y.callbacks.getScrollWhileDragging();return{droppableId:v,scroll:b}}),g={additions:x,removals:Object.keys(h),modified:p};n=_v(),r.publish(g)}))},o=function(d){var f=d.descriptor.id;n.additions[f]=d,n.modified[d.descriptor.droppableId]=!0,n.removals[f]&&delete n.removals[f],i()},c=function(d){var f=d.descriptor;n.removals[f.id]=!0,n.modified[f.droppableId]=!0,n.additions[f.id]&&delete n.additions[f.id],i()},l=function(){a&&(cancelAnimationFrame(a),a=null,n=_v())};return{add:o,remove:c,stop:l}}var IO=function(e){var t=e.scrollHeight,r=e.scrollWidth,n=e.height,a=e.width,i=ja({x:r,y:t},{x:a,y:n}),o={x:Math.max(0,i.x),y:Math.max(0,i.y)};return o},UO=function(){var e=document.documentElement;return e||We(),e},RO=function(){var e=UO(),t=IO({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,width:e.clientWidth,height:e.clientHeight});return t},hH=function(){var e=PO(),t=RO(),r=e.y,n=e.x,a=UO(),i=a.clientWidth,o=a.clientHeight,c=n+i,l=r+o,u=gi({top:r,left:n,right:c,bottom:l}),d={frame:u,scroll:{initial:e,current:e,max:t,diff:{value:rn,displacement:rn}}};return d},mH=function(e){var t=e.critical,r=e.scrollOptions,n=e.registry,a=hH(),i=a.scroll.current,o=t.droppable,c=n.droppable.getAllByType(o.type).map(function(f){return f.callbacks.getDimensionAndWatchScroll(i,r)}),l=n.draggable.getAllByType(t.draggable.type).map(function(f){return f.getDimension(i)}),u={draggables:fO(l),droppables:dO(c)},d={dimensions:u,critical:t,viewport:a};return d};function YD(e,t,r){if(r.descriptor.id===t.id||r.descriptor.type!==t.type)return!1;var n=e.droppable.getById(r.descriptor.droppableId);return n.descriptor.mode==="virtual"}var pH=function(e,t){var r=null,n=fH({callbacks:{publish:t.publishWhileDragging,collectionStarting:t.collectionStarting},registry:e}),a=function(m,x){e.droppable.exists(m)||We(),r&&t.updateDroppableIsEnabled({id:m,isEnabled:x})},i=function(m,x){r&&(e.droppable.exists(m)||We(),t.updateDroppableIsCombineEnabled({id:m,isCombineEnabled:x}))},o=function(m,x){r&&(e.droppable.exists(m)||We(),t.updateDroppableScroll({id:m,newScroll:x}))},c=function(m,x){r&&e.droppable.getById(m).callbacks.scroll(x)},l=function(){if(r){n.stop();var m=r.critical.droppable;e.droppable.getAllByType(m.type).forEach(function(x){return x.callbacks.dragStopped()}),r.unsubscribe(),r=null}},u=function(m){r||We();var x=r.critical.draggable;m.type==="ADDITION"&&YD(e,x,m.value)&&n.add(m.value),m.type==="REMOVAL"&&YD(e,x,m.value)&&n.remove(m.value)},d=function(m){r&&We();var x=e.draggable.getById(m.draggableId),p=e.droppable.getById(x.descriptor.droppableId),g={draggable:x.descriptor,droppable:p.descriptor},v=e.subscribe(u);return r={critical:g,unsubscribe:v},mH({critical:g,registry:e,scrollOptions:m.scrollOptions})},f={updateDroppableIsEnabled:a,updateDroppableIsCombineEnabled:i,scrollDroppable:c,updateDroppableScroll:o,startPublishing:d,stopPublishing:l};return f},MO=function(e,t){return e.phase==="IDLE"?!0:e.phase!=="DROP_ANIMATING"||e.completed.result.draggableId===t?!1:e.completed.result.reason==="DROP"},xH=function(e){window.scrollBy(e.x,e.y)},gH=tn(function(e){return s0(e).filter(function(t){return!(!t.isEnabled||!t.frame)})}),vH=function(t,r){var n=yo(gH(r),function(a){return a.frame||We(),_O(a.frame.pageMarginBox)(t)});return n},yH=function(e){var t=e.center,r=e.destination,n=e.droppables;if(r){var a=n[r];return a.frame?a:null}var i=vH(t,n);return i},no={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:function(t){return Math.pow(t,2)},durationDampening:{stopDampeningAt:1200,accelerateAt:360}},bH=function(e,t){var r=e[t.size]*no.startFromPercentage,n=e[t.size]*no.maxScrollAtPercentage,a={startScrollingFrom:r,maxScrollValueAt:n};return a},BO=function(e){var t=e.startOfRange,r=e.endOfRange,n=e.current,a=r-t;if(a===0)return 0;var i=n-t,o=i/a;return o},yw=1,wH=function(e,t){if(e>t.startScrollingFrom)return 0;if(e<=t.maxScrollValueAt)return no.maxPixelScroll;if(e===t.startScrollingFrom)return yw;var r=BO({startOfRange:t.maxScrollValueAt,endOfRange:t.startScrollingFrom,current:e}),n=1-r,a=no.maxPixelScroll*no.ease(n);return Math.ceil(a)},ZD=no.durationDampening.accelerateAt,JD=no.durationDampening.stopDampeningAt,_H=function(e,t){var r=t,n=JD,a=Date.now(),i=a-r;if(i>=JD)return e;if(i<ZD)return yw;var o=BO({startOfRange:ZD,endOfRange:n,current:i}),c=e*no.ease(o);return Math.ceil(c)},QD=function(e){var t=e.distanceToEdge,r=e.thresholds,n=e.dragStartTime,a=e.shouldUseTimeDampening,i=wH(t,r);return i===0?0:a?Math.max(_H(i,n),yw):i},eS=function(e){var t=e.container,r=e.distanceToEdges,n=e.dragStartTime,a=e.axis,i=e.shouldUseTimeDampening,o=bH(t,a),c=r[a.end]<r[a.start];return c?QD({distanceToEdge:r[a.end],thresholds:o,dragStartTime:n,shouldUseTimeDampening:i}):-1*QD({distanceToEdge:r[a.start],thresholds:o,dragStartTime:n,shouldUseTimeDampening:i})},jH=function(e){var t=e.container,r=e.subject,n=e.proposedScroll,a=r.height>t.height,i=r.width>t.width;return!i&&!a?n:i&&a?null:{x:i?0:n.x,y:a?0:n.y}},NH=lO(function(e){return e===0?0:e}),LO=function(e){var t=e.dragStartTime,r=e.container,n=e.subject,a=e.center,i=e.shouldUseTimeDampening,o={top:a.y-r.top,right:r.right-a.x,bottom:r.bottom-a.y,left:a.x-r.left},c=eS({container:r,distanceToEdges:o,dragStartTime:t,axis:uw,shouldUseTimeDampening:i}),l=eS({container:r,distanceToEdges:o,dragStartTime:t,axis:pO,shouldUseTimeDampening:i}),u=NH({x:l,y:c});if(ro(u,rn))return null;var d=jH({container:r,subject:n,proposedScroll:u});return d?ro(d,rn)?null:d:null},DH=lO(function(e){return e===0?0:e>0?1:-1}),bw=function(){var e=function(r,n){return r<0?r:r>n?r-n:0};return function(t){var r=t.current,n=t.max,a=t.change,i=pn(r,a),o={x:e(i.x,n.x),y:e(i.y,n.y)};return ro(o,rn)?null:o}}(),$O=function(t){var r=t.max,n=t.current,a=t.change,i={x:Math.max(n.x,r.x),y:Math.max(n.y,r.y)},o=DH(a),c=bw({max:i,current:n,change:o});return!c||o.x!==0&&c.x===0||o.y!==0&&c.y===0},ww=function(t,r){return $O({current:t.scroll.current,max:t.scroll.max,change:r})},SH=function(t,r){if(!ww(t,r))return null;var n=t.scroll.max,a=t.scroll.current;return bw({current:a,max:n,change:r})},_w=function(t,r){var n=t.frame;return n?$O({current:n.scroll.current,max:n.scroll.max,change:r}):!1},EH=function(t,r){var n=t.frame;return!n||!_w(t,r)?null:bw({current:n.scroll.current,max:n.scroll.max,change:r})},TH=function(e){var t=e.viewport,r=e.subject,n=e.center,a=e.dragStartTime,i=e.shouldUseTimeDampening,o=LO({dragStartTime:a,container:t.frame,subject:r,center:n,shouldUseTimeDampening:i});return o&&ww(t,o)?o:null},CH=function(e){var t=e.droppable,r=e.subject,n=e.center,a=e.dragStartTime,i=e.shouldUseTimeDampening,o=t.frame;if(!o)return null;var c=LO({dragStartTime:a,container:o.pageMarginBox,subject:r,center:n,shouldUseTimeDampening:i});return c&&_w(t,c)?c:null},tS=function(e){var t=e.state,r=e.dragStartTime,n=e.shouldUseTimeDampening,a=e.scrollWindow,i=e.scrollDroppable,o=t.current.page.borderBoxCenter,c=t.dimensions.draggables[t.critical.draggable.id],l=c.page.marginBox;if(t.isWindowScrollAllowed){var u=t.viewport,d=TH({dragStartTime:r,viewport:u,subject:l,center:o,shouldUseTimeDampening:n});if(d){a(d);return}}var f=yH({center:o,destination:Na(t.impact),droppables:t.dimensions.droppables});if(f){var h=CH({dragStartTime:r,droppable:f,subject:l,center:o,shouldUseTimeDampening:n});h&&i(f.descriptor.id,h)}},AH=function(e){var t=e.scrollWindow,r=e.scrollDroppable,n=Ld(t),a=Ld(r),i=null,o=function(d){i||We();var f=i,h=f.shouldUseTimeDampening,m=f.dragStartTime;tS({state:d,scrollWindow:n,scrollDroppable:a,dragStartTime:m,shouldUseTimeDampening:h})},c=function(d){i&&We();var f=Date.now(),h=!1,m=function(){h=!0};tS({state:d,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:m,scrollDroppable:m}),i={dragStartTime:f,shouldUseTimeDampening:h},h&&o(d)},l=function(){i&&(n.cancel(),a.cancel(),i=null)};return{start:c,stop:l,scroll:o}},kH=function(e){var t=e.move,r=e.scrollDroppable,n=e.scrollWindow,a=function(u,d){var f=pn(u.current.client.selection,d);t({client:f})},i=function(u,d){if(!_w(u,d))return d;var f=EH(u,d);if(!f)return r(u.descriptor.id,d),null;var h=ja(d,f);r(u.descriptor.id,h);var m=ja(d,h);return m},o=function(u,d,f){if(!u||!ww(d,f))return f;var h=SH(d,f);if(!h)return n(f),null;var m=ja(f,h);n(m);var x=ja(f,m);return x},c=function(u){var d=u.scrollJumpRequest;if(d){var f=Na(u.impact);f||We();var h=i(u.dimensions.droppables[f],d);if(h){var m=u.viewport,x=o(u.isWindowScrollAllowed,m,h);x&&a(u,x)}}};return c},FH=function(e){var t=e.scrollDroppable,r=e.scrollWindow,n=e.move,a=AH({scrollWindow:r,scrollDroppable:t}),i=kH({move:n,scrollWindow:r,scrollDroppable:t}),o=function(u){if(u.phase==="DRAGGING"){if(u.movementMode==="FLUID"){a.scroll(u);return}u.scrollJumpRequest&&i(u)}},c={scroll:o,start:a.start,stop:a.stop};return c},Nl="data-rbd",Dl=function(){var e=Nl+"-drag-handle";return{base:e,draggableId:e+"-draggable-id",contextId:e+"-context-id"}}(),Hb=function(){var e=Nl+"-draggable";return{base:e,contextId:e+"-context-id",id:e+"-id"}}(),OH=function(){var e=Nl+"-droppable";return{base:e,contextId:e+"-context-id",id:e+"-id"}}(),rS={contextId:Nl+"-scroll-container-context-id"},PH=function(t){return function(r){return"["+r+'="'+t+'"]'}},Gu=function(t,r){return t.map(function(n){var a=n.styles[r];return a?n.selector+" { "+a+" }":""}).join(" ")},IH="pointer-events: none;",UH=function(e){var t=PH(e),r=function(){var c=`
      cursor: -webkit-grab;
      cursor: grab;
    `;return{selector:t(Dl.contextId),styles:{always:`
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: rgba(0,0,0,0);
          touch-action: manipulation;
        `,resting:c,dragging:IH,dropAnimating:c}}}(),n=function(){var c=`
      transition: `+_d.outOfTheWay+`;
    `;return{selector:t(Hb.contextId),styles:{dragging:c,dropAnimating:c,userCancel:c}}}(),a={selector:t(OH.contextId),styles:{always:"overflow-anchor: none;"}},i={selector:"body",styles:{dragging:`
        cursor: grabbing;
        cursor: -webkit-grabbing;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        overflow-anchor: none;
      `}},o=[n,r,a,i];return{always:Gu(o,"always"),resting:Gu(o,"resting"),dragging:Gu(o,"dragging"),dropAnimating:Gu(o,"dropAnimating"),userCancel:Gu(o,"userCancel")}},Da=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?R.useLayoutEffect:R.useEffect,jv=function(){var t=document.querySelector("head");return t||We(),t},nS=function(t){var r=document.createElement("style");return t&&r.setAttribute("nonce",t),r.type="text/css",r};function RH(e,t){var r=Ft(function(){return UH(e)},[e]),n=R.useRef(null),a=R.useRef(null),i=tt(tn(function(f){var h=a.current;h||We(),h.textContent=f}),[]),o=tt(function(f){var h=n.current;h||We(),h.textContent=f},[]);Da(function(){!n.current&&!a.current||We();var f=nS(t),h=nS(t);return n.current=f,a.current=h,f.setAttribute(Nl+"-always",e),h.setAttribute(Nl+"-dynamic",e),jv().appendChild(f),jv().appendChild(h),o(r.always),i(r.resting),function(){var m=function(p){var g=p.current;g||We(),jv().removeChild(g),p.current=null};m(n),m(a)}},[t,o,i,r.always,r.resting,e]);var c=tt(function(){return i(r.dragging)},[i,r.dragging]),l=tt(function(f){if(f==="DROP"){i(r.dropAnimating);return}i(r.userCancel)},[i,r.dropAnimating,r.userCancel]),u=tt(function(){a.current&&i(r.resting)},[i,r.resting]),d=Ft(function(){return{dragging:c,dropping:l,resting:u}},[c,l,u]);return d}var WO=function(e){return e&&e.ownerDocument?e.ownerDocument.defaultView:window};function u0(e){return e instanceof WO(e).HTMLElement}function MH(e,t){var r="["+Dl.contextId+'="'+e+'"]',n=uO(document.querySelectorAll(r));if(!n.length)return null;var a=yo(n,function(i){return i.getAttribute(Dl.draggableId)===t});return!a||!u0(a)?null:a}function BH(e){var t=R.useRef({}),r=R.useRef(null),n=R.useRef(null),a=R.useRef(!1),i=tt(function(h,m){var x={id:h,focus:m};return t.current[h]=x,function(){var g=t.current,v=g[h];v!==x&&delete g[h]}},[]),o=tt(function(h){var m=MH(e,h);m&&m!==document.activeElement&&m.focus()},[e]),c=tt(function(h,m){r.current===h&&(r.current=m)},[]),l=tt(function(){n.current||a.current&&(n.current=requestAnimationFrame(function(){n.current=null;var h=r.current;h&&o(h)}))},[o]),u=tt(function(h){r.current=null;var m=document.activeElement;m&&m.getAttribute(Dl.draggableId)===h&&(r.current=h)},[]);Da(function(){return a.current=!0,function(){a.current=!1;var h=n.current;h&&cancelAnimationFrame(h)}},[]);var d=Ft(function(){return{register:i,tryRecordFocus:u,tryRestoreFocusRecorded:l,tryShiftRecord:c}},[i,u,l,c]);return d}function LH(){var e={draggables:{},droppables:{}},t=[];function r(f){return t.push(f),function(){var m=t.indexOf(f);m!==-1&&t.splice(m,1)}}function n(f){t.length&&t.forEach(function(h){return h(f)})}function a(f){return e.draggables[f]||null}function i(f){var h=a(f);return h||We(),h}var o={register:function(h){e.draggables[h.descriptor.id]=h,n({type:"ADDITION",value:h})},update:function(h,m){var x=e.draggables[m.descriptor.id];x&&x.uniqueId===h.uniqueId&&(delete e.draggables[m.descriptor.id],e.draggables[h.descriptor.id]=h)},unregister:function(h){var m=h.descriptor.id,x=a(m);x&&h.uniqueId===x.uniqueId&&(delete e.draggables[m],n({type:"REMOVAL",value:h}))},getById:i,findById:a,exists:function(h){return!!a(h)},getAllByType:function(h){return tp(e.draggables).filter(function(m){return m.descriptor.type===h})}};function c(f){return e.droppables[f]||null}function l(f){var h=c(f);return h||We(),h}var u={register:function(h){e.droppables[h.descriptor.id]=h},unregister:function(h){var m=c(h.descriptor.id);m&&h.uniqueId===m.uniqueId&&delete e.droppables[h.descriptor.id]},getById:l,findById:c,exists:function(h){return!!c(h)},getAllByType:function(h){return tp(e.droppables).filter(function(m){return m.descriptor.type===h})}};function d(){e.draggables={},e.droppables={},t.length=0}return{draggable:o,droppable:u,subscribe:r,clean:d}}function $H(){var e=Ft(LH,[]);return R.useEffect(function(){return function(){requestAnimationFrame(e.clean)}},[e]),e}var jw=ge.createContext(null),np=function(){var e=document.body;return e||We(),e},WH={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},zH=function(t){return"rbd-announcement-"+t};function qH(e){var t=Ft(function(){return zH(e)},[e]),r=R.useRef(null);R.useEffect(function(){var i=document.createElement("div");return r.current=i,i.id=t,i.setAttribute("aria-live","assertive"),i.setAttribute("aria-atomic","true"),ct(i.style,WH),np().appendChild(i),function(){setTimeout(function(){var l=np();l.contains(i)&&l.removeChild(i),i===r.current&&(r.current=null)})}},[t]);var n=tt(function(a){var i=r.current;if(i){i.textContent=a;return}},[]);return n}var HH=0,VH={separator:"::"};function Nw(e,t){return t===void 0&&(t=VH),Ft(function(){return""+e+t.separator+HH++},[t.separator,e])}function GH(e){var t=e.contextId,r=e.uniqueId;return"rbd-hidden-text-"+t+"-"+r}function XH(e){var t=e.contextId,r=e.text,n=Nw("hidden-text",{separator:"-"}),a=Ft(function(){return GH({contextId:t,uniqueId:n})},[n,t]);return R.useEffect(function(){var o=document.createElement("div");return o.id=a,o.textContent=r,o.style.display="none",np().appendChild(o),function(){var l=np();l.contains(o)&&l.removeChild(o)}},[a,r]),a}var d0=ge.createContext(null);function zO(e){var t=R.useRef(e);return R.useEffect(function(){t.current=e}),t}function KH(){var e=null;function t(){return!!e}function r(o){return o===e}function n(o){e&&We();var c={abandon:o};return e=c,c}function a(){e||We(),e=null}function i(){e&&(e.abandon(),a())}return{isClaimed:t,isActive:r,claim:n,release:a,tryAbandon:i}}var YH=9,ZH=13,Dw=27,qO=32,JH=33,QH=34,eV=35,tV=36,rV=37,nV=38,aV=39,iV=40,Zh,sV=(Zh={},Zh[ZH]=!0,Zh[YH]=!0,Zh),HO=function(e){sV[e.keyCode]&&e.preventDefault()},f0=function(){var e="visibilitychange";if(typeof document>"u")return e;var t=[e,"ms"+e,"webkit"+e,"moz"+e,"o"+e],r=yo(t,function(n){return"on"+n in document});return r||e}(),VO=0,aS=5;function oV(e,t){return Math.abs(t.x-e.x)>=aS||Math.abs(t.y-e.y)>=aS}var iS={type:"IDLE"};function cV(e){var t=e.cancel,r=e.completed,n=e.getPhase,a=e.setPhase;return[{eventName:"mousemove",fn:function(o){var c=o.button,l=o.clientX,u=o.clientY;if(c===VO){var d={x:l,y:u},f=n();if(f.type==="DRAGGING"){o.preventDefault(),f.actions.move(d);return}f.type!=="PENDING"&&We();var h=f.point;if(oV(h,d)){o.preventDefault();var m=f.actions.fluidLift(d);a({type:"DRAGGING",actions:m})}}}},{eventName:"mouseup",fn:function(o){var c=n();if(c.type!=="DRAGGING"){t();return}o.preventDefault(),c.actions.drop({shouldBlockNextClick:!0}),r()}},{eventName:"mousedown",fn:function(o){n().type==="DRAGGING"&&o.preventDefault(),t()}},{eventName:"keydown",fn:function(o){var c=n();if(c.type==="PENDING"){t();return}if(o.keyCode===Dw){o.preventDefault(),t();return}HO(o)}},{eventName:"resize",fn:t},{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(){n().type==="PENDING"&&t()}},{eventName:"webkitmouseforcedown",fn:function(o){var c=n();if(c.type==="IDLE"&&We(),c.actions.shouldRespectForcePress()){t();return}o.preventDefault()}},{eventName:f0,fn:t}]}function lV(e){var t=R.useRef(iS),r=R.useRef(to),n=Ft(function(){return{eventName:"mousedown",fn:function(f){if(!f.defaultPrevented&&f.button===VO&&!(f.ctrlKey||f.metaKey||f.shiftKey||f.altKey)){var h=e.findClosestDraggableId(f);if(h){var m=e.tryGetLock(h,o,{sourceEvent:f});if(m){f.preventDefault();var x={x:f.clientX,y:f.clientY};r.current(),u(m,x)}}}}}},[e]),a=Ft(function(){return{eventName:"webkitmouseforcewillbegin",fn:function(f){if(!f.defaultPrevented){var h=e.findClosestDraggableId(f);if(h){var m=e.findOptionsForDraggable(h);m&&(m.shouldRespectForcePress||e.canGetLock(h)&&f.preventDefault())}}}}},[e]),i=tt(function(){var f={passive:!1,capture:!0};r.current=Za(window,[a,n],f)},[a,n]),o=tt(function(){var d=t.current;d.type!=="IDLE"&&(t.current=iS,r.current(),i())},[i]),c=tt(function(){var d=t.current;o(),d.type==="DRAGGING"&&d.actions.cancel({shouldBlockNextClick:!0}),d.type==="PENDING"&&d.actions.abort()},[o]),l=tt(function(){var f={capture:!0,passive:!1},h=cV({cancel:c,completed:o,getPhase:function(){return t.current},setPhase:function(x){t.current=x}});r.current=Za(window,h,f)},[c,o]),u=tt(function(f,h){t.current.type!=="IDLE"&&We(),t.current={type:"PENDING",point:h,actions:f},l()},[l]);Da(function(){return i(),function(){r.current()}},[i])}var Lc;function uV(){}var dV=(Lc={},Lc[QH]=!0,Lc[JH]=!0,Lc[tV]=!0,Lc[eV]=!0,Lc);function fV(e,t){function r(){t(),e.cancel()}function n(){t(),e.drop()}return[{eventName:"keydown",fn:function(i){if(i.keyCode===Dw){i.preventDefault(),r();return}if(i.keyCode===qO){i.preventDefault(),n();return}if(i.keyCode===iV){i.preventDefault(),e.moveDown();return}if(i.keyCode===nV){i.preventDefault(),e.moveUp();return}if(i.keyCode===aV){i.preventDefault(),e.moveRight();return}if(i.keyCode===rV){i.preventDefault(),e.moveLeft();return}if(dV[i.keyCode]){i.preventDefault();return}HO(i)}},{eventName:"mousedown",fn:r},{eventName:"mouseup",fn:r},{eventName:"click",fn:r},{eventName:"touchstart",fn:r},{eventName:"resize",fn:r},{eventName:"wheel",fn:r,options:{passive:!0}},{eventName:f0,fn:r}]}function hV(e){var t=R.useRef(uV),r=Ft(function(){return{eventName:"keydown",fn:function(i){if(i.defaultPrevented||i.keyCode!==qO)return;var o=e.findClosestDraggableId(i);if(!o)return;var c=e.tryGetLock(o,d,{sourceEvent:i});if(!c)return;i.preventDefault();var l=!0,u=c.snapLift();t.current();function d(){l||We(),l=!1,t.current(),n()}t.current=Za(window,fV(u,d),{capture:!0,passive:!1})}}},[e]),n=tt(function(){var i={passive:!1,capture:!0};t.current=Za(window,[r],i)},[r]);Da(function(){return n(),function(){t.current()}},[n])}var Nv={type:"IDLE"},mV=120,pV=.15;function xV(e){var t=e.cancel,r=e.getPhase;return[{eventName:"orientationchange",fn:t},{eventName:"resize",fn:t},{eventName:"contextmenu",fn:function(a){a.preventDefault()}},{eventName:"keydown",fn:function(a){if(r().type!=="DRAGGING"){t();return}a.keyCode===Dw&&a.preventDefault(),t()}},{eventName:f0,fn:t}]}function gV(e){var t=e.cancel,r=e.completed,n=e.getPhase;return[{eventName:"touchmove",options:{capture:!1},fn:function(i){var o=n();if(o.type!=="DRAGGING"){t();return}o.hasMoved=!0;var c=i.touches[0],l=c.clientX,u=c.clientY,d={x:l,y:u};i.preventDefault(),o.actions.move(d)}},{eventName:"touchend",fn:function(i){var o=n();if(o.type!=="DRAGGING"){t();return}i.preventDefault(),o.actions.drop({shouldBlockNextClick:!0}),r()}},{eventName:"touchcancel",fn:function(i){if(n().type!=="DRAGGING"){t();return}i.preventDefault(),t()}},{eventName:"touchforcechange",fn:function(i){var o=n();o.type==="IDLE"&&We();var c=i.touches[0];if(c){var l=c.force>=pV;if(l){var u=o.actions.shouldRespectForcePress();if(o.type==="PENDING"){u&&t();return}if(u){if(o.hasMoved){i.preventDefault();return}t();return}i.preventDefault()}}}},{eventName:f0,fn:t}]}function vV(e){var t=R.useRef(Nv),r=R.useRef(to),n=tt(function(){return t.current},[]),a=tt(function(m){t.current=m},[]),i=Ft(function(){return{eventName:"touchstart",fn:function(m){if(!m.defaultPrevented){var x=e.findClosestDraggableId(m);if(x){var p=e.tryGetLock(x,c,{sourceEvent:m});if(p){var g=m.touches[0],v=g.clientX,y=g.clientY,b={x:v,y};r.current(),f(p,b)}}}}}},[e]),o=tt(function(){var m={capture:!0,passive:!1};r.current=Za(window,[i],m)},[i]),c=tt(function(){var h=t.current;h.type!=="IDLE"&&(h.type==="PENDING"&&clearTimeout(h.longPressTimerId),a(Nv),r.current(),o())},[o,a]),l=tt(function(){var h=t.current;c(),h.type==="DRAGGING"&&h.actions.cancel({shouldBlockNextClick:!0}),h.type==="PENDING"&&h.actions.abort()},[c]),u=tt(function(){var m={capture:!0,passive:!1},x={cancel:l,completed:c,getPhase:n},p=Za(window,gV(x),m),g=Za(window,xV(x),m);r.current=function(){p(),g()}},[l,n,c]),d=tt(function(){var m=n();m.type!=="PENDING"&&We();var x=m.actions.fluidLift(m.point);a({type:"DRAGGING",actions:x,hasMoved:!1})},[n,a]),f=tt(function(m,x){n().type!=="IDLE"&&We();var p=setTimeout(d,mV);a({type:"PENDING",point:x,actions:m,longPressTimerId:p}),u()},[u,n,a,d]);Da(function(){return o(),function(){r.current();var x=n();x.type==="PENDING"&&(clearTimeout(x.longPressTimerId),a(Nv))}},[n,o,a]),Da(function(){var m=Za(window,[{eventName:"touchmove",fn:function(){},options:{capture:!1,passive:!1}}]);return m},[])}var yV={input:!0,button:!0,textarea:!0,select:!0,option:!0,optgroup:!0,video:!0,audio:!0};function GO(e,t){if(t==null)return!1;var r=!!yV[t.tagName.toLowerCase()];if(r)return!0;var n=t.getAttribute("contenteditable");return n==="true"||n===""?!0:t===e?!1:GO(e,t.parentElement)}function bV(e,t){var r=t.target;return u0(r)?GO(e,r):!1}var wV=function(e){return gi(e.getBoundingClientRect()).center};function _V(e){return e instanceof WO(e).Element}var jV=function(){var e="matches";if(typeof document>"u")return e;var t=[e,"msMatchesSelector","webkitMatchesSelector"],r=yo(t,function(n){return n in Element.prototype});return r||e}();function XO(e,t){return e==null?null:e[jV](t)?e:XO(e.parentElement,t)}function NV(e,t){return e.closest?e.closest(t):XO(e,t)}function DV(e){return"["+Dl.contextId+'="'+e+'"]'}function SV(e,t){var r=t.target;if(!_V(r))return null;var n=DV(e),a=NV(r,n);return!a||!u0(a)?null:a}function EV(e,t){var r=SV(e,t);return r?r.getAttribute(Dl.draggableId):null}function TV(e,t){var r="["+Hb.contextId+'="'+e+'"]',n=uO(document.querySelectorAll(r)),a=yo(n,function(i){return i.getAttribute(Hb.id)===t});return!a||!u0(a)?null:a}function CV(e){e.preventDefault()}function Jh(e){var t=e.expected,r=e.phase,n=e.isLockActive;return e.shouldWarn,!(!n()||t!==r)}function KO(e){var t=e.lockAPI,r=e.store,n=e.registry,a=e.draggableId;if(t.isClaimed())return!1;var i=n.draggable.findById(a);return!(!i||!i.options.isEnabled||!MO(r.getState(),a))}function AV(e){var t=e.lockAPI,r=e.contextId,n=e.store,a=e.registry,i=e.draggableId,o=e.forceSensorStop,c=e.sourceEvent,l=KO({lockAPI:t,store:n,registry:a,draggableId:i});if(!l)return null;var u=a.draggable.getById(i),d=TV(r,u.descriptor.id);if(!d||c&&!u.options.canDragInteractiveElements&&bV(d,c))return null;var f=t.claim(o||to),h="PRE_DRAG";function m(){return u.options.shouldRespectForcePress}function x(){return t.isActive(f)}function p(j,N){Jh({expected:j,phase:h,isLockActive:x,shouldWarn:!0})&&n.dispatch(N())}var g=p.bind(null,"DRAGGING");function v(j){function N(){t.release(),h="COMPLETED"}h!=="PRE_DRAG"&&(N(),h!=="PRE_DRAG"&&We()),n.dispatch(jq(j.liftActionArgs)),h="DRAGGING";function D(S,T){if(T===void 0&&(T={shouldBlockNextClick:!1}),j.cleanup(),T.shouldBlockNextClick){var A=Za(window,[{eventName:"click",fn:CV,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(A)}N(),n.dispatch(kO({reason:S}))}return ct({isActive:function(){return Jh({expected:"DRAGGING",phase:h,isLockActive:x,shouldWarn:!1})},shouldRespectForcePress:m,drop:function(T){return D("DROP",T)},cancel:function(T){return D("CANCEL",T)}},j.actions)}function y(j){var N=Ld(function(S){g(function(){return AO({client:S})})}),D=v({liftActionArgs:{id:i,clientSelection:j,movementMode:"FLUID"},cleanup:function(){return N.cancel()},actions:{move:N}});return ct({},D,{move:N})}function b(){var j={moveUp:function(){return g(Fq)},moveRight:function(){return g(Pq)},moveDown:function(){return g(Oq)},moveLeft:function(){return g(Iq)}};return v({liftActionArgs:{id:i,clientSelection:wV(d),movementMode:"SNAP"},cleanup:to,actions:j})}function _(){var j=Jh({expected:"PRE_DRAG",phase:h,isLockActive:x,shouldWarn:!0});j&&t.release()}var w={isActive:function(){return Jh({expected:"PRE_DRAG",phase:h,isLockActive:x,shouldWarn:!1})},shouldRespectForcePress:m,fluidLift:y,snapLift:b,abort:_};return w}var kV=[lV,hV,vV];function FV(e){var t=e.contextId,r=e.store,n=e.registry,a=e.customSensors,i=e.enableDefaultSensors,o=[].concat(i?kV:[],a||[]),c=R.useState(function(){return KH()})[0],l=tt(function(y,b){y.isDragging&&!b.isDragging&&c.tryAbandon()},[c]);Da(function(){var y=r.getState(),b=r.subscribe(function(){var _=r.getState();l(y,_),y=_});return b},[c,r,l]),Da(function(){return c.tryAbandon},[c.tryAbandon]);for(var u=tt(function(v){return KO({lockAPI:c,registry:n,store:r,draggableId:v})},[c,n,r]),d=tt(function(v,y,b){return AV({lockAPI:c,registry:n,contextId:t,store:r,draggableId:v,forceSensorStop:y,sourceEvent:b&&b.sourceEvent?b.sourceEvent:null})},[t,c,n,r]),f=tt(function(v){return EV(t,v)},[t]),h=tt(function(v){var y=n.draggable.findById(v);return y?y.options:null},[n.draggable]),m=tt(function(){c.isClaimed()&&(c.tryAbandon(),r.getState().phase!=="IDLE"&&r.dispatch(pw()))},[c,r]),x=tt(c.isClaimed,[c]),p=Ft(function(){return{canGetLock:u,tryGetLock:d,findClosestDraggableId:f,findOptionsForDraggable:h,tryReleaseLock:m,isLockClaimed:x}},[u,d,f,h,m,x]),g=0;g<o.length;g++)o[g](p)}var OV=function(t){return{onBeforeCapture:t.onBeforeCapture,onBeforeDragStart:t.onBeforeDragStart,onDragStart:t.onDragStart,onDragEnd:t.onDragEnd,onDragUpdate:t.onDragUpdate}};function Xu(e){return e.current||We(),e.current}function PV(e){var t=e.contextId,r=e.setCallbacks,n=e.sensors,a=e.nonce,i=e.dragHandleUsageInstructions,o=R.useRef(null),c=zO(e),l=tt(function(){return OV(c.current)},[c]),u=qH(t),d=XH({contextId:t,text:i}),f=RH(t,a),h=tt(function(S){Xu(o).dispatch(S)},[]),m=Ft(function(){return TD({publishWhileDragging:Dq,updateDroppableScroll:Eq,updateDroppableIsEnabled:Tq,updateDroppableIsCombineEnabled:Cq,collectionStarting:Sq},h)},[h]),x=$H(),p=Ft(function(){return pH(x,m)},[x,m]),g=Ft(function(){return FH(ct({scrollWindow:xH,scrollDroppable:p.scrollDroppable},TD({move:AO},h)))},[p.scrollDroppable,h]),v=BH(t),y=Ft(function(){return dH({announce:u,autoScroller:g,dimensionMarshal:p,focusMarshal:v,getResponders:l,styleMarshal:f})},[u,g,p,v,l,f]);o.current=y;var b=tt(function(){var S=Xu(o),T=S.getState();T.phase!=="IDLE"&&S.dispatch(pw())},[]),_=tt(function(){var S=Xu(o).getState();return S.isDragging||S.phase==="DROP_ANIMATING"},[]),w=Ft(function(){return{isDragging:_,tryAbort:b}},[_,b]);r(w);var j=tt(function(S){return MO(Xu(o).getState(),S)},[]),N=tt(function(){return zo(Xu(o).getState())},[]),D=Ft(function(){return{marshal:p,focus:v,contextId:t,canLift:j,isMovementAllowed:N,dragHandleUsageInstructionsId:d,registry:x}},[t,p,d,v,j,N,x]);return FV({contextId:t,store:y,registry:x,customSensors:n,enableDefaultSensors:e.enableDefaultSensors!==!1}),R.useEffect(function(){return b},[b]),ge.createElement(d0.Provider,{value:D},ge.createElement(nW,{context:jw,store:y},e.children))}var IV=0;function UV(){return Ft(function(){return""+IV++},[])}function RV(e){var t=UV(),r=e.dragHandleUsageInstructions||$m.dragHandleUsageInstructions;return ge.createElement(hz,null,function(n){return ge.createElement(PV,{nonce:e.nonce,contextId:t,setCallbacks:n,dragHandleUsageInstructions:r,enableDefaultSensors:e.enableDefaultSensors,sensors:e.sensors,onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragUpdate:e.onDragUpdate,onDragEnd:e.onDragEnd},e.children)})}var YO=function(t){return function(r){return t===r}},MV=YO("scroll"),BV=YO("auto"),sS=function(t,r){return r(t.overflowX)||r(t.overflowY)},LV=function(t){var r=window.getComputedStyle(t),n={overflowX:r.overflowX,overflowY:r.overflowY};return sS(n,MV)||sS(n,BV)},$V=function(){return!1},WV=function e(t){return t==null?null:t===document.body?$V()?t:null:t===document.documentElement?null:LV(t)?t:e(t.parentElement)},Vb=function(e){return{x:e.scrollLeft,y:e.scrollTop}},zV=function e(t){if(!t)return!1;var r=window.getComputedStyle(t);return r.position==="fixed"?!0:e(t.parentElement)},qV=function(e){var t=WV(e),r=zV(e);return{closestScrollable:t,isFixedOnPage:r}},HV=function(e){var t=e.descriptor,r=e.isEnabled,n=e.isCombineEnabled,a=e.isFixedOnPage,i=e.direction,o=e.client,c=e.page,l=e.closest,u=function(){if(!l)return null;var m=l.scrollSize,x=l.client,p=IO({scrollHeight:m.scrollHeight,scrollWidth:m.scrollWidth,height:x.paddingBox.height,width:x.paddingBox.width});return{pageMarginBox:l.page.marginBox,frameClient:x,scrollSize:m,shouldClipSubject:l.shouldClipSubject,scroll:{initial:l.scroll,current:l.scroll,max:p,diff:{value:rn,displacement:rn}}}}(),d=i==="vertical"?uw:pO,f=jl({page:c,withPlaceholder:null,axis:d,frame:u}),h={descriptor:t,isCombineEnabled:n,isFixedOnPage:a,axis:d,isEnabled:r,client:o,page:c,frame:u,subject:f};return h},VV=function(t,r){var n=iO(t);if(!r||t!==r)return n;var a=n.paddingBox.top-r.scrollTop,i=n.paddingBox.left-r.scrollLeft,o=a+r.scrollHeight,c=i+r.scrollWidth,l={top:a,right:c,bottom:o,left:i},u=iw(l,n.border),d=sw({borderBox:u,margin:n.margin,border:n.border,padding:n.padding});return d},GV=function(e){var t=e.ref,r=e.descriptor,n=e.env,a=e.windowScroll,i=e.direction,o=e.isDropDisabled,c=e.isCombineEnabled,l=e.shouldClipSubject,u=n.closestScrollable,d=VV(t,u),f=Jm(d,a),h=function(){if(!u)return null;var x=iO(u),p={scrollHeight:u.scrollHeight,scrollWidth:u.scrollWidth};return{client:x,page:Jm(x,a),scroll:Vb(u),scrollSize:p,shouldClipSubject:l}}(),m=HV({descriptor:r,isEnabled:!o,isCombineEnabled:c,isFixedOnPage:n.isFixedOnPage,direction:i,client:d,page:f,closest:h});return m},XV={passive:!1},KV={passive:!0},oS=function(e){return e.shouldPublishImmediately?XV:KV};function ap(e){var t=R.useContext(e);return t||We(),t}var Qh=function(t){return t&&t.env.closestScrollable||null};function YV(e){var t=R.useRef(null),r=ap(d0),n=Nw("droppable"),a=r.registry,i=r.marshal,o=zO(e),c=Ft(function(){return{id:e.droppableId,type:e.type,mode:e.mode}},[e.droppableId,e.mode,e.type]),l=R.useRef(c),u=Ft(function(){return tn(function(_,w){t.current||We();var j={x:_,y:w};i.updateDroppableScroll(c.id,j)})},[c.id,i]),d=tt(function(){var _=t.current;return!_||!_.env.closestScrollable?rn:Vb(_.env.closestScrollable)},[]),f=tt(function(){var _=d();u(_.x,_.y)},[d,u]),h=Ft(function(){return Ld(f)},[f]),m=tt(function(){var _=t.current,w=Qh(_);_&&w||We();var j=_.scrollOptions;if(j.shouldPublishImmediately){f();return}h()},[h,f]),x=tt(function(_,w){t.current&&We();var j=o.current,N=j.getDroppableRef();N||We();var D=qV(N),S={ref:N,descriptor:c,env:D,scrollOptions:w};t.current=S;var T=GV({ref:N,descriptor:c,env:D,windowScroll:_,direction:j.direction,isDropDisabled:j.isDropDisabled,isCombineEnabled:j.isCombineEnabled,shouldClipSubject:!j.ignoreContainerClipping}),A=D.closestScrollable;return A&&(A.setAttribute(rS.contextId,r.contextId),A.addEventListener("scroll",m,oS(S.scrollOptions))),T},[r.contextId,c,m,o]),p=tt(function(){var _=t.current,w=Qh(_);return _&&w||We(),Vb(w)},[]),g=tt(function(){var _=t.current;_||We();var w=Qh(_);t.current=null,w&&(h.cancel(),w.removeAttribute(rS.contextId),w.removeEventListener("scroll",m,oS(_.scrollOptions)))},[m,h]),v=tt(function(_){var w=t.current;w||We();var j=Qh(w);j||We(),j.scrollTop+=_.y,j.scrollLeft+=_.x},[]),y=Ft(function(){return{getDimensionAndWatchScroll:x,getScrollWhileDragging:p,dragStopped:g,scroll:v}},[g,x,p,v]),b=Ft(function(){return{uniqueId:n,descriptor:c,callbacks:y}},[y,c,n]);Da(function(){return l.current=b.descriptor,a.droppable.register(b),function(){t.current&&g(),a.droppable.unregister(b)}},[y,c,g,b,i,a.droppable]),Da(function(){t.current&&i.updateDroppableIsEnabled(l.current.id,!e.isDropDisabled)},[e.isDropDisabled,i]),Da(function(){t.current&&i.updateDroppableIsCombineEnabled(l.current.id,e.isCombineEnabled)},[e.isCombineEnabled,i])}function Dv(){}var cS={width:0,height:0,margin:yz},ZV=function(t){var r=t.isAnimatingOpenOnMount,n=t.placeholder,a=t.animate;return r||a==="close"?cS:{height:n.client.borderBox.height,width:n.client.borderBox.width,margin:n.client.margin}},JV=function(t){var r=t.isAnimatingOpenOnMount,n=t.placeholder,a=t.animate,i=ZV({isAnimatingOpenOnMount:r,placeholder:n,animate:a});return{display:n.display,boxSizing:"border-box",width:i.width,height:i.height,marginTop:i.margin.top,marginRight:i.margin.right,marginBottom:i.margin.bottom,marginLeft:i.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:a!=="none"?_d.placeholder:null}};function QV(e){var t=R.useRef(null),r=tt(function(){t.current&&(clearTimeout(t.current),t.current=null)},[]),n=e.animate,a=e.onTransitionEnd,i=e.onClose,o=e.contextId,c=R.useState(e.animate==="open"),l=c[0],u=c[1];R.useEffect(function(){return l?n!=="open"?(r(),u(!1),Dv):t.current?Dv:(t.current=setTimeout(function(){t.current=null,u(!1)}),r):Dv},[n,l,r]);var d=tt(function(h){h.propertyName==="height"&&(a(),n==="close"&&i())},[n,i,a]),f=JV({isAnimatingOpenOnMount:l,animate:e.animate,placeholder:e.placeholder});return ge.createElement(e.placeholder.tagName,{style:f,"data-rbd-placeholder-context-id":o,onTransitionEnd:d,ref:e.innerRef})}var eG=ge.memo(QV),Sw=ge.createContext(null),tG=function(e){IF(t,e);function t(){for(var n,a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return n=e.call.apply(e,[this].concat(i))||this,n.state={isVisible:!!n.props.on,data:n.props.on,animate:n.props.shouldAnimate&&n.props.on?"open":"none"},n.onClose=function(){n.state.animate==="close"&&n.setState({isVisible:!1})},n}t.getDerivedStateFromProps=function(a,i){return a.shouldAnimate?a.on?{isVisible:!0,data:a.on,animate:"open"}:i.isVisible?{isVisible:!0,data:i.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:!!a.on,data:a.on,animate:"none"}};var r=t.prototype;return r.render=function(){if(!this.state.isVisible)return null;var a={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(a)},t}(ge.PureComponent),lS={dragging:5e3,dropAnimating:4500},rG=function(t,r){return r?_d.drop(r.duration):t?_d.snap:_d.fluid},nG=function(t,r){return t?r?qd.opacity.drop:qd.opacity.combining:null},aG=function(t){return t.forceShouldAnimate!=null?t.forceShouldAnimate:t.mode==="SNAP"};function iG(e){var t=e.dimension,r=t.client,n=e.offset,a=e.combineWith,i=e.dropping,o=!!a,c=aG(e),l=!!i,u=l?zb.drop(n,o):zb.moveTo(n),d={position:"fixed",top:r.marginBox.top,left:r.marginBox.left,boxSizing:"border-box",width:r.borderBox.width,height:r.borderBox.height,transition:rG(c,i),transform:u,opacity:nG(o,l),zIndex:l?lS.dropAnimating:lS.dragging,pointerEvents:"none"};return d}function sG(e){return{transform:zb.moveTo(e.offset),transition:e.shouldAnimateDisplacement?null:"none"}}function oG(e){return e.type==="DRAGGING"?iG(e):sG(e)}function cG(e,t,r){r===void 0&&(r=rn);var n=window.getComputedStyle(t),a=t.getBoundingClientRect(),i=aO(a,n),o=Jm(i,r),c={client:i,tagName:t.tagName.toLowerCase(),display:n.display},l={x:i.marginBox.width,y:i.marginBox.height},u={descriptor:e,placeholder:c,displaceBy:l,client:i,page:o};return u}function lG(e){var t=Nw("draggable"),r=e.descriptor,n=e.registry,a=e.getDraggableRef,i=e.canDragInteractiveElements,o=e.shouldRespectForcePress,c=e.isEnabled,l=Ft(function(){return{canDragInteractiveElements:i,shouldRespectForcePress:o,isEnabled:c}},[i,c,o]),u=tt(function(m){var x=a();return x||We(),cG(r,x,m)},[r,a]),d=Ft(function(){return{uniqueId:t,descriptor:r,options:l,getDimension:u}},[r,u,l,t]),f=R.useRef(d),h=R.useRef(!0);Da(function(){return n.draggable.register(f.current),function(){return n.draggable.unregister(f.current)}},[n.draggable]),Da(function(){if(h.current){h.current=!1;return}var m=f.current;f.current=d,n.draggable.update(d,m)},[d,n.draggable])}function uG(e){e.preventDefault()}function dG(e){var t=R.useRef(null),r=tt(function(S){t.current=S},[]),n=tt(function(){return t.current},[]),a=ap(d0),i=a.contextId,o=a.dragHandleUsageInstructionsId,c=a.registry,l=ap(Sw),u=l.type,d=l.droppableId,f=Ft(function(){return{id:e.draggableId,index:e.index,type:u,droppableId:d}},[e.draggableId,e.index,u,d]),h=e.children,m=e.draggableId,x=e.isEnabled,p=e.shouldRespectForcePress,g=e.canDragInteractiveElements,v=e.isClone,y=e.mapped,b=e.dropAnimationFinished;if(!v){var _=Ft(function(){return{descriptor:f,registry:c,getDraggableRef:n,canDragInteractiveElements:g,shouldRespectForcePress:p,isEnabled:x}},[f,c,n,g,p,x]);lG(_)}var w=Ft(function(){return x?{tabIndex:0,role:"button","aria-describedby":o,"data-rbd-drag-handle-draggable-id":m,"data-rbd-drag-handle-context-id":i,draggable:!1,onDragStart:uG}:null},[i,o,m,x]),j=tt(function(S){y.type==="DRAGGING"&&y.dropping&&S.propertyName==="transform"&&b()},[b,y]),N=Ft(function(){var S=oG(y),T=y.type==="DRAGGING"&&y.dropping?j:null,A={innerRef:r,draggableProps:{"data-rbd-draggable-context-id":i,"data-rbd-draggable-id":m,style:S,onTransitionEnd:T},dragHandleProps:w};return A},[i,w,m,y,j,r]),D=Ft(function(){return{draggableId:f.id,type:f.type,source:{index:f.index,droppableId:f.droppableId}}},[f.droppableId,f.id,f.index,f.type]);return h(N,y.snapshot,D)}var ZO=function(e,t){return e===t},JO=function(e){var t=e.combine,r=e.destination;return r?r.droppableId:t?t.droppableId:null},fG=function(t){return t.combine?t.combine.draggableId:null},hG=function(t){return t.at&&t.at.type==="COMBINE"?t.at.combine.draggableId:null};function mG(){var e=tn(function(a,i){return{x:a,y:i}}),t=tn(function(a,i,o,c,l){return{isDragging:!0,isClone:i,isDropAnimating:!!l,dropAnimation:l,mode:a,draggingOver:o,combineWith:c,combineTargetFor:null}}),r=tn(function(a,i,o,c,l,u,d){return{mapped:{type:"DRAGGING",dropping:null,draggingOver:l,combineWith:u,mode:i,offset:a,dimension:o,forceShouldAnimate:d,snapshot:t(i,c,l,u,null)}}}),n=function(i,o){if(i.isDragging){if(i.critical.draggable.id!==o.draggableId)return null;var c=i.current.client.offset,l=i.dimensions.draggables[o.draggableId],u=Na(i.impact),d=hG(i.impact),f=i.forceShouldAnimate;return r(e(c.x,c.y),i.movementMode,l,o.isClone,u,d,f)}if(i.phase==="DROP_ANIMATING"){var h=i.completed;if(h.result.draggableId!==o.draggableId)return null;var m=o.isClone,x=i.dimensions.draggables[o.draggableId],p=h.result,g=p.mode,v=JO(p),y=fG(p),b=i.dropDuration,_={duration:b,curve:gw.drop,moveTo:i.newHomeClientOffset,opacity:y?qd.opacity.drop:null,scale:y?qd.scale.drop:null};return{mapped:{type:"DRAGGING",offset:i.newHomeClientOffset,dimension:x,dropping:_,draggingOver:v,combineWith:y,mode:g,forceShouldAnimate:null,snapshot:t(g,m,v,y,_)}}}return null};return n}function QO(e){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:e,combineWith:null}}var pG={mapped:{type:"SECONDARY",offset:rn,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:QO(null)}};function xG(){var e=tn(function(o,c){return{x:o,y:c}}),t=tn(QO),r=tn(function(o,c,l){return c===void 0&&(c=null),{mapped:{type:"SECONDARY",offset:o,combineTargetFor:c,shouldAnimateDisplacement:l,snapshot:t(c)}}}),n=function(c){return c?r(rn,c,!0):null},a=function(c,l,u,d){var f=u.displaced.visible[c],h=!!(d.inVirtualList&&d.effected[c]),m=o0(u),x=m&&m.draggableId===c?l:null;if(!f){if(!h)return n(x);if(u.displaced.invisible[c])return null;var p=uu(d.displacedBy.point),g=e(p.x,p.y);return r(g,x,!0)}if(h)return n(x);var v=u.displacedBy.point,y=e(v.x,v.y);return r(y,x,f.shouldAnimate)},i=function(c,l){if(c.isDragging)return c.critical.draggable.id===l.draggableId?null:a(l.draggableId,c.critical.draggable.id,c.impact,c.afterCritical);if(c.phase==="DROP_ANIMATING"){var u=c.completed;return u.result.draggableId===l.draggableId?null:a(l.draggableId,u.result.draggableId,u.impact,u.afterCritical)}return null};return i}var gG=function(){var t=mG(),r=xG(),n=function(i,o){return t(i,o)||r(i,o)||pG};return n},vG={dropAnimationFinished:FO},yG=rO(gG,vG,null,{context:jw,pure:!0,areStatePropsEqual:ZO})(dG);function e5(e){var t=ap(Sw),r=t.isUsingCloneFor;return r===e.draggableId&&!e.isClone?null:ge.createElement(yG,e)}function bG(e){var t=typeof e.isDragDisabled=="boolean"?!e.isDragDisabled:!0,r=!!e.disableInteractiveElementBlocking,n=!!e.shouldRespectForcePress;return ge.createElement(e5,ct({},e,{isClone:!1,isEnabled:t,canDragInteractiveElements:r,shouldRespectForcePress:n}))}function wG(e){var t=R.useContext(d0);t||We();var r=t.contextId,n=t.isMovementAllowed,a=R.useRef(null),i=R.useRef(null),o=e.children,c=e.droppableId,l=e.type,u=e.mode,d=e.direction,f=e.ignoreContainerClipping,h=e.isDropDisabled,m=e.isCombineEnabled,x=e.snapshot,p=e.useClone,g=e.updateViewportMaxScroll,v=e.getContainerForClone,y=tt(function(){return a.current},[]),b=tt(function(A){a.current=A},[]);tt(function(){return i.current},[]);var _=tt(function(A){i.current=A},[]),w=tt(function(){n()&&g({maxScroll:RO()})},[n,g]);YV({droppableId:c,type:l,mode:u,direction:d,isDropDisabled:h,isCombineEnabled:m,ignoreContainerClipping:f,getDroppableRef:y});var j=ge.createElement(tG,{on:e.placeholder,shouldAnimate:e.shouldAnimatePlaceholder},function(A){var E=A.onClose,M=A.data,P=A.animate;return ge.createElement(eG,{placeholder:M,onClose:E,innerRef:_,animate:P,contextId:r,onTransitionEnd:w})}),N=Ft(function(){return{innerRef:b,placeholder:j,droppableProps:{"data-rbd-droppable-id":c,"data-rbd-droppable-context-id":r}}},[r,c,j,b]),D=p?p.dragging.draggableId:null,S=Ft(function(){return{droppableId:c,type:l,isUsingCloneFor:D}},[c,D,l]);function T(){if(!p)return null;var A=p.dragging,E=p.render,M=ge.createElement(e5,{draggableId:A.draggableId,index:A.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},function(P,X){return E(P,X,A)});return HL.createPortal(M,v())}return ge.createElement(Sw.Provider,{value:S},o(N,x),T())}var Sv=function(t,r){return t===r.droppable.type},uS=function(t,r){return r.draggables[t.draggable.id]},_G=function(){var t={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},r=ct({},t,{shouldAnimatePlaceholder:!1}),n=tn(function(o){return{draggableId:o.id,type:o.type,source:{index:o.index,droppableId:o.droppableId}}}),a=tn(function(o,c,l,u,d,f){var h=d.descriptor.id,m=d.descriptor.droppableId===o;if(m){var x=f?{render:f,dragging:n(d.descriptor)}:null,p={isDraggingOver:l,draggingOverWith:l?h:null,draggingFromThisWith:h,isUsingPlaceholder:!0};return{placeholder:d.placeholder,shouldAnimatePlaceholder:!1,snapshot:p,useClone:x}}if(!c)return r;if(!u)return t;var g={isDraggingOver:l,draggingOverWith:h,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:d.placeholder,shouldAnimatePlaceholder:!0,snapshot:g,useClone:null}}),i=function(c,l){var u=l.droppableId,d=l.type,f=!l.isDropDisabled,h=l.renderClone;if(c.isDragging){var m=c.critical;if(!Sv(d,m))return r;var x=uS(m,c.dimensions),p=Na(c.impact)===u;return a(u,f,p,p,x,h)}if(c.phase==="DROP_ANIMATING"){var g=c.completed;if(!Sv(d,g.critical))return r;var v=uS(g.critical,c.dimensions);return a(u,f,JO(g.result)===u,Na(g.impact)===u,v,h)}if(c.phase==="IDLE"&&c.completed&&!c.shouldFlush){var y=c.completed;if(!Sv(d,y.critical))return r;var b=Na(y.impact)===u,_=!!(y.impact.at&&y.impact.at.type==="COMBINE"),w=y.critical.droppable.id===u;return b?_?t:r:w?t:r}return r};return i},jG={updateViewportMaxScroll:kq};function NG(){return document.body||We(),document.body}var DG={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:NG},t5=rO(_G,jG,null,{context:jw,pure:!0,areStatePropsEqual:ZO})(wG);t5.defaultProps=DG;function r5(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=r5(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function dt(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=r5(e))&&(n&&(n+=" "),n+=t);return n}var SG=Array.isArray,Kn=SG,EG=typeof gt=="object"&&gt&&gt.Object===Object&&gt,n5=EG,TG=n5,CG=typeof self=="object"&&self&&self.Object===Object&&self,AG=TG||CG||Function("return this")(),Ti=AG,kG=Ti,FG=kG.Symbol,hu=FG,dS=hu,a5=Object.prototype,OG=a5.hasOwnProperty,PG=a5.toString,Ku=dS?dS.toStringTag:void 0;function IG(e){var t=OG.call(e,Ku),r=e[Ku];try{e[Ku]=void 0;var n=!0}catch{}var a=PG.call(e);return n&&(t?e[Ku]=r:delete e[Ku]),a}var UG=IG,RG=Object.prototype,MG=RG.toString;function BG(e){return MG.call(e)}var LG=BG,fS=hu,$G=UG,WG=LG,zG="[object Null]",qG="[object Undefined]",hS=fS?fS.toStringTag:void 0;function HG(e){return e==null?e===void 0?qG:zG:hS&&hS in Object(e)?$G(e):WG(e)}var Ps=HG;function VG(e){return e!=null&&typeof e=="object"}var Ci=VG,GG=Ps,XG=Ci,KG="[object Symbol]";function YG(e){return typeof e=="symbol"||XG(e)&&GG(e)==KG}var mu=YG,ZG=Kn,JG=mu,QG=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,eX=/^\w*$/;function tX(e,t){if(ZG(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||JG(e)?!0:eX.test(e)||!QG.test(e)||t!=null&&e in Object(t)}var Ew=tX;function rX(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Ai=rX;const pu=Rt(Ai);var nX=Ps,aX=Ai,iX="[object AsyncFunction]",sX="[object Function]",oX="[object GeneratorFunction]",cX="[object Proxy]";function lX(e){if(!aX(e))return!1;var t=nX(e);return t==sX||t==oX||t==iX||t==cX}var Tw=lX;const st=Rt(Tw);var uX=Ti,dX=uX["__core-js_shared__"],fX=dX,Ev=fX,mS=function(){var e=/[^.]+$/.exec(Ev&&Ev.keys&&Ev.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function hX(e){return!!mS&&mS in e}var mX=hX,pX=Function.prototype,xX=pX.toString;function gX(e){if(e!=null){try{return xX.call(e)}catch{}try{return e+""}catch{}}return""}var i5=gX,vX=Tw,yX=mX,bX=Ai,wX=i5,_X=/[\\^$.*+?()[\]{}|]/g,jX=/^\[object .+?Constructor\]$/,NX=Function.prototype,DX=Object.prototype,SX=NX.toString,EX=DX.hasOwnProperty,TX=RegExp("^"+SX.call(EX).replace(_X,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function CX(e){if(!bX(e)||yX(e))return!1;var t=vX(e)?TX:jX;return t.test(wX(e))}var AX=CX;function kX(e,t){return e==null?void 0:e[t]}var FX=kX,OX=AX,PX=FX;function IX(e,t){var r=PX(e,t);return OX(r)?r:void 0}var Sc=IX,UX=Sc,RX=UX(Object,"create"),h0=RX,pS=h0;function MX(){this.__data__=pS?pS(null):{},this.size=0}var BX=MX;function LX(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var $X=LX,WX=h0,zX="__lodash_hash_undefined__",qX=Object.prototype,HX=qX.hasOwnProperty;function VX(e){var t=this.__data__;if(WX){var r=t[e];return r===zX?void 0:r}return HX.call(t,e)?t[e]:void 0}var GX=VX,XX=h0,KX=Object.prototype,YX=KX.hasOwnProperty;function ZX(e){var t=this.__data__;return XX?t[e]!==void 0:YX.call(t,e)}var JX=ZX,QX=h0,eK="__lodash_hash_undefined__";function tK(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=QX&&t===void 0?eK:t,this}var rK=tK,nK=BX,aK=$X,iK=GX,sK=JX,oK=rK;function xu(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}xu.prototype.clear=nK;xu.prototype.delete=aK;xu.prototype.get=iK;xu.prototype.has=sK;xu.prototype.set=oK;var cK=xu;function lK(){this.__data__=[],this.size=0}var uK=lK;function dK(e,t){return e===t||e!==e&&t!==t}var m0=dK,fK=m0;function hK(e,t){for(var r=e.length;r--;)if(fK(e[r][0],t))return r;return-1}var p0=hK,mK=p0,pK=Array.prototype,xK=pK.splice;function gK(e){var t=this.__data__,r=mK(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():xK.call(t,r,1),--this.size,!0}var vK=gK,yK=p0;function bK(e){var t=this.__data__,r=yK(t,e);return r<0?void 0:t[r][1]}var wK=bK,_K=p0;function jK(e){return _K(this.__data__,e)>-1}var NK=jK,DK=p0;function SK(e,t){var r=this.__data__,n=DK(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var EK=SK,TK=uK,CK=vK,AK=wK,kK=NK,FK=EK;function gu(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}gu.prototype.clear=TK;gu.prototype.delete=CK;gu.prototype.get=AK;gu.prototype.has=kK;gu.prototype.set=FK;var x0=gu,OK=Sc,PK=Ti,IK=OK(PK,"Map"),Cw=IK,xS=cK,UK=x0,RK=Cw;function MK(){this.size=0,this.__data__={hash:new xS,map:new(RK||UK),string:new xS}}var BK=MK;function LK(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var $K=LK,WK=$K;function zK(e,t){var r=e.__data__;return WK(t)?r[typeof t=="string"?"string":"hash"]:r.map}var g0=zK,qK=g0;function HK(e){var t=qK(this,e).delete(e);return this.size-=t?1:0,t}var VK=HK,GK=g0;function XK(e){return GK(this,e).get(e)}var KK=XK,YK=g0;function ZK(e){return YK(this,e).has(e)}var JK=ZK,QK=g0;function eY(e,t){var r=QK(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var tY=eY,rY=BK,nY=VK,aY=KK,iY=JK,sY=tY;function vu(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}vu.prototype.clear=rY;vu.prototype.delete=nY;vu.prototype.get=aY;vu.prototype.has=iY;vu.prototype.set=sY;var Aw=vu,s5=Aw,oY="Expected a function";function kw(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(oY);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],i=r.cache;if(i.has(a))return i.get(a);var o=e.apply(this,n);return r.cache=i.set(a,o)||i,o};return r.cache=new(kw.Cache||s5),r}kw.Cache=s5;var o5=kw;const cY=Rt(o5);var lY=o5,uY=500;function dY(e){var t=lY(e,function(n){return r.size===uY&&r.clear(),n}),r=t.cache;return t}var fY=dY,hY=fY,mY=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,pY=/\\(\\)?/g,xY=hY(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(mY,function(r,n,a,i){t.push(a?i.replace(pY,"$1"):n||r)}),t}),gY=xY;function vY(e,t){for(var r=-1,n=e==null?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var v0=vY,gS=hu,yY=v0,bY=Kn,wY=mu,vS=gS?gS.prototype:void 0,yS=vS?vS.toString:void 0;function c5(e){if(typeof e=="string")return e;if(bY(e))return yY(e,c5)+"";if(wY(e))return yS?yS.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var _Y=c5,jY=_Y;function NY(e){return e==null?"":jY(e)}var l5=NY,DY=Kn,SY=Ew,EY=gY,TY=l5;function CY(e,t){return DY(e)?e:SY(e,t)?[e]:EY(TY(e))}var y0=CY,AY=mu;function kY(e){if(typeof e=="string"||AY(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var wh=kY,FY=y0,OY=wh;function PY(e,t){t=FY(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[OY(t[r++])];return r&&r==n?e:void 0}var b0=PY,IY=b0;function UY(e,t,r){var n=e==null?void 0:IY(e,t);return n===void 0?r:n}var u5=UY;const Sa=Rt(u5);function RY(e){return e==null}var MY=RY;const ft=Rt(MY);var BY=Ps,LY=Kn,$Y=Ci,WY="[object String]";function zY(e){return typeof e=="string"||!LY(e)&&$Y(e)&&BY(e)==WY}var qY=zY;const lo=Rt(qY);var d5={exports:{}},Vt={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fw=Symbol.for("react.element"),Ow=Symbol.for("react.portal"),w0=Symbol.for("react.fragment"),_0=Symbol.for("react.strict_mode"),j0=Symbol.for("react.profiler"),N0=Symbol.for("react.provider"),D0=Symbol.for("react.context"),HY=Symbol.for("react.server_context"),S0=Symbol.for("react.forward_ref"),E0=Symbol.for("react.suspense"),T0=Symbol.for("react.suspense_list"),C0=Symbol.for("react.memo"),A0=Symbol.for("react.lazy"),VY=Symbol.for("react.offscreen"),f5;f5=Symbol.for("react.module.reference");function oi(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case Fw:switch(e=e.type,e){case w0:case j0:case _0:case E0:case T0:return e;default:switch(e=e&&e.$$typeof,e){case HY:case D0:case S0:case A0:case C0:case N0:return e;default:return t}}case Ow:return t}}}Vt.ContextConsumer=D0;Vt.ContextProvider=N0;Vt.Element=Fw;Vt.ForwardRef=S0;Vt.Fragment=w0;Vt.Lazy=A0;Vt.Memo=C0;Vt.Portal=Ow;Vt.Profiler=j0;Vt.StrictMode=_0;Vt.Suspense=E0;Vt.SuspenseList=T0;Vt.isAsyncMode=function(){return!1};Vt.isConcurrentMode=function(){return!1};Vt.isContextConsumer=function(e){return oi(e)===D0};Vt.isContextProvider=function(e){return oi(e)===N0};Vt.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Fw};Vt.isForwardRef=function(e){return oi(e)===S0};Vt.isFragment=function(e){return oi(e)===w0};Vt.isLazy=function(e){return oi(e)===A0};Vt.isMemo=function(e){return oi(e)===C0};Vt.isPortal=function(e){return oi(e)===Ow};Vt.isProfiler=function(e){return oi(e)===j0};Vt.isStrictMode=function(e){return oi(e)===_0};Vt.isSuspense=function(e){return oi(e)===E0};Vt.isSuspenseList=function(e){return oi(e)===T0};Vt.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===w0||e===j0||e===_0||e===E0||e===T0||e===VY||typeof e=="object"&&e!==null&&(e.$$typeof===A0||e.$$typeof===C0||e.$$typeof===N0||e.$$typeof===D0||e.$$typeof===S0||e.$$typeof===f5||e.getModuleId!==void 0)};Vt.typeOf=oi;d5.exports=Vt;var GY=d5.exports,XY=Ps,KY=Ci,YY="[object Number]";function ZY(e){return typeof e=="number"||KY(e)&&XY(e)==YY}var h5=ZY;const m5=Rt(h5);var JY=h5;function QY(e){return JY(e)&&e!=+e}var eZ=QY;const _h=Rt(eZ);var qn=function(t){return t===0?0:t>0?1:-1},Jo=function(t){return lo(t)&&t.indexOf("%")===t.length-1},Re=function(t){return m5(t)&&!_h(t)},tZ=function(t){return ft(t)},Hr=function(t){return Re(t)||lo(t)},rZ=0,yu=function(t){var r=++rZ;return"".concat(t||"").concat(r)},Hn=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Re(t)&&!lo(t))return n;var i;if(Jo(t)){var o=t.indexOf("%");i=r*parseFloat(t.slice(0,o))/100}else i=+t;return _h(i)&&(i=n),a&&i>r&&(i=r),i},Ks=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},nZ=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},a=0;a<r;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1},gr=function(t,r){return Re(t)&&Re(r)?function(n){return t+n*(r-t)}:function(){return r}};function ip(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):Sa(n,t))===r})}var aZ=function(t,r){return Re(t)&&Re(r)?t-r:lo(t)&&lo(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function hl(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function Gb(e){"@babel/helpers - typeof";return Gb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gb(e)}var iZ=["viewBox","children"],sZ=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],bS=["points","pathLength"],Tv={svg:iZ,polygon:bS,polyline:bS},Pw=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],sp=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(R.isValidElement(t)&&(n=t.props),!pu(n))return null;var a={};return Object.keys(n).forEach(function(i){Pw.includes(i)&&(a[i]=r||function(o){return n[i](n,o)})}),a},oZ=function(t,r,n){return function(a){return t(r,n,a),null}},uo=function(t,r,n){if(!pu(t)||Gb(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(i){var o=t[i];Pw.includes(i)&&typeof o=="function"&&(a||(a={}),a[i]=oZ(o,r,n))}),a},cZ=["children"],lZ=["children"];function wS(e,t){if(e==null)return{};var r=uZ(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function uZ(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Xb(e){"@babel/helpers - typeof";return Xb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xb(e)}var _S={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},gs=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},jS=null,Cv=null,Iw=function e(t){if(t===jS&&Array.isArray(Cv))return Cv;var r=[];return R.Children.forEach(t,function(n){ft(n)||(GY.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),Cv=r,jS=t,r};function sa(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(a){return gs(a)}):n=[gs(t)],Iw(e).forEach(function(a){var i=Sa(a,"type.displayName")||Sa(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}function va(e,t){var r=sa(e,t);return r&&r[0]}var NS=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,a=r.height;return!(!Re(n)||n<=0||!Re(a)||a<=0)},dZ=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],fZ=function(t){return t&&t.type&&lo(t.type)&&dZ.indexOf(t.type)>=0},hZ=function(t){return t&&Xb(t)==="object"&&"clipDot"in t},mZ=function(t,r,n,a){var i,o=(i=Tv==null?void 0:Tv[a])!==null&&i!==void 0?i:[];return r.startsWith("data-")||!st(t)&&(a&&o.includes(r)||sZ.includes(r))||n&&Pw.includes(r)},nt=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(R.isValidElement(t)&&(a=t.props),!pu(a))return null;var i={};return Object.keys(a).forEach(function(o){var c;mZ((c=a)===null||c===void 0?void 0:c[o],o,r,n)&&(i[o]=a[o])}),i},Kb=function e(t,r){if(t===r)return!0;var n=R.Children.count(t);if(n!==R.Children.count(r))return!1;if(n===0)return!0;if(n===1)return DS(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var i=t[a],o=r[a];if(Array.isArray(i)||Array.isArray(o)){if(!e(i,o))return!1}else if(!DS(i,o))return!1}return!0},DS=function(t,r){if(ft(t)&&ft(r))return!0;if(!ft(t)&&!ft(r)){var n=t.props||{},a=n.children,i=wS(n,cZ),o=r.props||{},c=o.children,l=wS(o,lZ);return a&&c?hl(i,l)&&Kb(a,c):!a&&!c?hl(i,l):!1}return!1},SS=function(t,r){var n=[],a={};return Iw(t).forEach(function(i,o){if(fZ(i))n.push(i);else if(i){var c=gs(i.type),l=r[c]||{},u=l.handler,d=l.once;if(u&&(!d||!a[c])){var f=u(i,c,o);n.push(f),a[c]=!0}}}),n},pZ=function(t){var r=t&&t.type;return r&&_S[r]?_S[r]:null},xZ=function(t,r){return Iw(r).indexOf(t)},gZ=["children","width","height","viewBox","className","style","title","desc"];function Yb(){return Yb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yb.apply(this,arguments)}function vZ(e,t){if(e==null)return{};var r=yZ(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function yZ(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Zb(e){var t=e.children,r=e.width,n=e.height,a=e.viewBox,i=e.className,o=e.style,c=e.title,l=e.desc,u=vZ(e,gZ),d=a||{width:r,height:n,x:0,y:0},f=dt("recharts-surface",i);return ge.createElement("svg",Yb({},nt(u,!0,"svg"),{className:f,width:r,height:n,style:o,viewBox:"".concat(d.x," ").concat(d.y," ").concat(d.width," ").concat(d.height)}),ge.createElement("title",null,c),ge.createElement("desc",null,l),t)}var bZ=["children","className"];function Jb(){return Jb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Jb.apply(this,arguments)}function wZ(e,t){if(e==null)return{};var r=_Z(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _Z(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Tt=ge.forwardRef(function(e,t){var r=e.children,n=e.className,a=wZ(e,bZ),i=dt("recharts-layer",n);return ge.createElement("g",Jb({className:i},nt(a,!0),{ref:t}),r)}),bi=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function jZ(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(a);++n<a;)i[n]=e[n+t];return i}var p5=jZ,NZ=p5;function DZ(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:NZ(e,t,r)}var SZ=DZ,EZ="\\ud800-\\udfff",TZ="\\u0300-\\u036f",CZ="\\ufe20-\\ufe2f",AZ="\\u20d0-\\u20ff",kZ=TZ+CZ+AZ,FZ="\\ufe0e\\ufe0f",OZ="\\u200d",PZ=RegExp("["+OZ+EZ+kZ+FZ+"]");function IZ(e){return PZ.test(e)}var x5=IZ;function UZ(e){return e.split("")}var RZ=UZ,g5="\\ud800-\\udfff",MZ="\\u0300-\\u036f",BZ="\\ufe20-\\ufe2f",LZ="\\u20d0-\\u20ff",$Z=MZ+BZ+LZ,WZ="\\ufe0e\\ufe0f",zZ="["+g5+"]",Qb="["+$Z+"]",e1="\\ud83c[\\udffb-\\udfff]",qZ="(?:"+Qb+"|"+e1+")",v5="[^"+g5+"]",y5="(?:\\ud83c[\\udde6-\\uddff]){2}",b5="[\\ud800-\\udbff][\\udc00-\\udfff]",HZ="\\u200d",w5=qZ+"?",_5="["+WZ+"]?",VZ="(?:"+HZ+"(?:"+[v5,y5,b5].join("|")+")"+_5+w5+")*",GZ=_5+w5+VZ,XZ="(?:"+[v5+Qb+"?",Qb,y5,b5,zZ].join("|")+")",KZ=RegExp(e1+"(?="+e1+")|"+XZ+GZ,"g");function YZ(e){return e.match(KZ)||[]}var ZZ=YZ,JZ=RZ,QZ=x5,eJ=ZZ;function tJ(e){return QZ(e)?eJ(e):JZ(e)}var rJ=tJ,nJ=SZ,aJ=x5,iJ=rJ,sJ=l5;function oJ(e){return function(t){t=sJ(t);var r=aJ(t)?iJ(t):void 0,n=r?r[0]:t.charAt(0),a=r?nJ(r,1).join(""):t.slice(1);return n[e]()+a}}var cJ=oJ,lJ=cJ,uJ=lJ("toUpperCase"),dJ=uJ;const k0=Rt(dJ);function tr(e){return function(){return e}}const j5=Math.cos,op=Math.sin,ki=Math.sqrt,cp=Math.PI,F0=2*cp,t1=Math.PI,r1=2*t1,qo=1e-6,fJ=r1-qo;function N5(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function hJ(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return N5;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class mJ{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?N5:hJ(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,o){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+o}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,c=this._y1,l=n-t,u=a-r,d=o-t,f=c-r,h=d*d+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>qo)if(!(Math.abs(f*l-u*d)>qo)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let m=n-o,x=a-c,p=l*l+u*u,g=m*m+x*x,v=Math.sqrt(p),y=Math.sqrt(h),b=i*Math.tan((t1-Math.acos((p+h-g)/(2*v*y)))/2),_=b/y,w=b/v;Math.abs(_-1)>qo&&this._append`L${t+_*d},${r+_*f}`,this._append`A${i},${i},0,0,${+(f*m>d*x)},${this._x1=t+w*l},${this._y1=r+w*u}`}}arc(t,r,n,a,i,o){if(t=+t,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let c=n*Math.cos(a),l=n*Math.sin(a),u=t+c,d=r+l,f=1^o,h=o?a-i:i-a;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>qo||Math.abs(this._y1-d)>qo)&&this._append`L${u},${d}`,n&&(h<0&&(h=h%r1+r1),h>fJ?this._append`A${n},${n},0,1,${f},${t-c},${r-l}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:h>qo&&this._append`A${n},${n},0,${+(h>=t1)},${f},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function Uw(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new mJ(t)}function Rw(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function D5(e){this._context=e}D5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function O0(e){return new D5(e)}function S5(e){return e[0]}function E5(e){return e[1]}function T5(e,t){var r=tr(!0),n=null,a=O0,i=null,o=Uw(c);e=typeof e=="function"?e:e===void 0?S5:tr(e),t=typeof t=="function"?t:t===void 0?E5:tr(t);function c(l){var u,d=(l=Rw(l)).length,f,h=!1,m;for(n==null&&(i=a(m=o())),u=0;u<=d;++u)!(u<d&&r(f=l[u],u,l))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(f,u,l),+t(f,u,l));if(m)return i=null,m+""||null}return c.x=function(l){return arguments.length?(e=typeof l=="function"?l:tr(+l),c):e},c.y=function(l){return arguments.length?(t=typeof l=="function"?l:tr(+l),c):t},c.defined=function(l){return arguments.length?(r=typeof l=="function"?l:tr(!!l),c):r},c.curve=function(l){return arguments.length?(a=l,n!=null&&(i=a(n)),c):a},c.context=function(l){return arguments.length?(l==null?n=i=null:i=a(n=l),c):n},c}function em(e,t,r){var n=null,a=tr(!0),i=null,o=O0,c=null,l=Uw(u);e=typeof e=="function"?e:e===void 0?S5:tr(+e),t=typeof t=="function"?t:tr(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?E5:tr(+r);function u(f){var h,m,x,p=(f=Rw(f)).length,g,v=!1,y,b=new Array(p),_=new Array(p);for(i==null&&(c=o(y=l())),h=0;h<=p;++h){if(!(h<p&&a(g=f[h],h,f))===v)if(v=!v)m=h,c.areaStart(),c.lineStart();else{for(c.lineEnd(),c.lineStart(),x=h-1;x>=m;--x)c.point(b[x],_[x]);c.lineEnd(),c.areaEnd()}v&&(b[h]=+e(g,h,f),_[h]=+t(g,h,f),c.point(n?+n(g,h,f):b[h],r?+r(g,h,f):_[h]))}if(y)return c=null,y+""||null}function d(){return T5().defined(a).curve(o).context(i)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:tr(+f),n=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:tr(+f),u):e},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:tr(+f),u):n},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:tr(+f),r=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:tr(+f),u):t},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:tr(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(t)},u.defined=function(f){return arguments.length?(a=typeof f=="function"?f:tr(!!f),u):a},u.curve=function(f){return arguments.length?(o=f,i!=null&&(c=o(i)),u):o},u.context=function(f){return arguments.length?(f==null?i=c=null:c=o(i=f),u):i},u}class C5{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function pJ(e){return new C5(e,!0)}function xJ(e){return new C5(e,!1)}const Mw={draw(e,t){const r=ki(t/cp);e.moveTo(r,0),e.arc(0,0,r,0,F0)}},gJ={draw(e,t){const r=ki(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},A5=ki(1/3),vJ=A5*2,yJ={draw(e,t){const r=ki(t/vJ),n=r*A5;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},bJ={draw(e,t){const r=ki(t),n=-r/2;e.rect(n,n,r,r)}},wJ=.8908130915292852,k5=op(cp/10)/op(7*cp/10),_J=op(F0/10)*k5,jJ=-j5(F0/10)*k5,NJ={draw(e,t){const r=ki(t*wJ),n=_J*r,a=jJ*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const o=F0*i/5,c=j5(o),l=op(o);e.lineTo(l*r,-c*r),e.lineTo(c*n-l*a,l*n+c*a)}e.closePath()}},Av=ki(3),DJ={draw(e,t){const r=-ki(t/(Av*3));e.moveTo(0,r*2),e.lineTo(-Av*r,-r),e.lineTo(Av*r,-r),e.closePath()}},Ua=-.5,Ra=ki(3)/2,n1=1/ki(12),SJ=(n1/2+1)*3,EJ={draw(e,t){const r=ki(t/SJ),n=r/2,a=r*n1,i=n,o=r*n1+r,c=-i,l=o;e.moveTo(n,a),e.lineTo(i,o),e.lineTo(c,l),e.lineTo(Ua*n-Ra*a,Ra*n+Ua*a),e.lineTo(Ua*i-Ra*o,Ra*i+Ua*o),e.lineTo(Ua*c-Ra*l,Ra*c+Ua*l),e.lineTo(Ua*n+Ra*a,Ua*a-Ra*n),e.lineTo(Ua*i+Ra*o,Ua*o-Ra*i),e.lineTo(Ua*c+Ra*l,Ua*l-Ra*c),e.closePath()}};function TJ(e,t){let r=null,n=Uw(a);e=typeof e=="function"?e:tr(e||Mw),t=typeof t=="function"?t:tr(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:tr(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:tr(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function lp(){}function up(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function F5(e){this._context=e}F5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:up(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:up(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function CJ(e){return new F5(e)}function O5(e){this._context=e}O5.prototype={areaStart:lp,areaEnd:lp,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:up(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function AJ(e){return new O5(e)}function P5(e){this._context=e}P5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:up(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function kJ(e){return new P5(e)}function I5(e){this._context=e}I5.prototype={areaStart:lp,areaEnd:lp,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function FJ(e){return new I5(e)}function ES(e){return e<0?-1:1}function TS(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),o=(r-e._y1)/(a||n<0&&-0),c=(i*a+o*n)/(n+a);return(ES(i)+ES(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(c))||0}function CS(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function kv(e,t,r){var n=e._x0,a=e._y0,i=e._x1,o=e._y1,c=(i-n)/3;e._context.bezierCurveTo(n+c,a+c*t,i-c,o-c*r,i,o)}function dp(e){this._context=e}dp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:kv(this,this._t0,CS(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,kv(this,CS(this,r=TS(this,e,t)),r);break;default:kv(this,this._t0,r=TS(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function U5(e){this._context=new R5(e)}(U5.prototype=Object.create(dp.prototype)).point=function(e,t){dp.prototype.point.call(this,t,e)};function R5(e){this._context=e}R5.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function OJ(e){return new dp(e)}function PJ(e){return new U5(e)}function M5(e){this._context=e}M5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=AS(e),a=AS(t),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function AS(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,o[t]-=n*o[t-1];for(a[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function IJ(e){return new M5(e)}function P0(e,t){this._context=e,this._t=t}P0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function UJ(e){return new P0(e,.5)}function RJ(e){return new P0(e,0)}function MJ(e){return new P0(e,1)}function Sl(e,t){if((o=e.length)>1)for(var r=1,n,a,i=e[t[0]],o,c=i.length;r<o;++r)for(a=i,i=e[t[r]],n=0;n<c;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function a1(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function BJ(e,t){return e[t]}function LJ(e){const t=[];return t.key=e,t}function $J(){var e=tr([]),t=a1,r=Sl,n=BJ;function a(i){var o=Array.from(e.apply(this,arguments),LJ),c,l=o.length,u=-1,d;for(const f of i)for(c=0,++u;c<l;++c)(o[c][u]=[0,+n(f,o[c].key,u,i)]).data=f;for(c=0,d=Rw(t(o));c<l;++c)o[d[c]].index=c;return r(o,d),o}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:tr(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:tr(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?a1:typeof i=="function"?i:tr(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??Sl,a):r},a}function WJ(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,o;a<i;++a){for(o=r=0;r<n;++r)o+=e[r][a][1]||0;if(o)for(r=0;r<n;++r)e[r][a][1]/=o}Sl(e,t)}}function zJ(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var o=0,c=0;o<a;++o)c+=e[o][r][1]||0;n[r][1]+=n[r][0]=-c/2}Sl(e,t)}}function qJ(e,t){if(!(!((o=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,o;n<i;++n){for(var c=0,l=0,u=0;c<o;++c){for(var d=e[t[c]],f=d[n][1]||0,h=d[n-1][1]||0,m=(f-h)/2,x=0;x<c;++x){var p=e[t[x]],g=p[n][1]||0,v=p[n-1][1]||0;m+=g-v}l+=f,u+=m*f}a[n-1][1]+=a[n-1][0]=r,l&&(r-=u/l)}a[n-1][1]+=a[n-1][0]=r,Sl(e,t)}}function Hd(e){"@babel/helpers - typeof";return Hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hd(e)}var HJ=["type","size","sizeType"];function i1(){return i1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i1.apply(this,arguments)}function kS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function FS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kS(Object(r),!0).forEach(function(n){VJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VJ(e,t,r){return t=GJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GJ(e){var t=XJ(e,"string");return Hd(t)=="symbol"?t:t+""}function XJ(e,t){if(Hd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Hd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function KJ(e,t){if(e==null)return{};var r=YJ(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function YJ(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var B5={symbolCircle:Mw,symbolCross:gJ,symbolDiamond:yJ,symbolSquare:bJ,symbolStar:NJ,symbolTriangle:DJ,symbolWye:EJ},ZJ=Math.PI/180,JJ=function(t){var r="symbol".concat(k0(t));return B5[r]||Mw},QJ=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*ZJ;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},eQ=function(t,r){B5["symbol".concat(k0(t))]=r},Bw=function(t){var r=t.type,n=r===void 0?"circle":r,a=t.size,i=a===void 0?64:a,o=t.sizeType,c=o===void 0?"area":o,l=KJ(t,HJ),u=FS(FS({},l),{},{type:n,size:i,sizeType:c}),d=function(){var g=JJ(n),v=TJ().type(g).size(QJ(i,c,n));return v()},f=u.className,h=u.cx,m=u.cy,x=nt(u,!0);return h===+h&&m===+m&&i===+i?ge.createElement("path",i1({},x,{className:dt("recharts-symbols",f),transform:"translate(".concat(h,", ").concat(m,")"),d:d()})):null};Bw.registerSymbol=eQ;function El(e){"@babel/helpers - typeof";return El=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},El(e)}function s1(){return s1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s1.apply(this,arguments)}function OS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tQ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?OS(Object(r),!0).forEach(function(n){Vd(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$5(n.key),n)}}function aQ(e,t,r){return t&&nQ(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function iQ(e,t,r){return t=fp(t),sQ(e,L5()?Reflect.construct(t,r||[],fp(e).constructor):t.apply(e,r))}function sQ(e,t){if(t&&(El(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oQ(e)}function oQ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L5(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(L5=function(){return!!e})()}function fp(e){return fp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fp(e)}function cQ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o1(e,t)}function o1(e,t){return o1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},o1(e,t)}function Vd(e,t,r){return t=$5(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $5(e){var t=lQ(e,"string");return El(t)=="symbol"?t:t+""}function lQ(e,t){if(El(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(El(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Ma=32,Lw=function(e){function t(){return rQ(this,t),iQ(this,t,arguments)}return cQ(t,e),aQ(t,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,i=Ma/2,o=Ma/6,c=Ma/3,l=n.inactive?a:n.color;if(n.type==="plainline")return ge.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:i,x2:Ma,y2:i,className:"recharts-legend-icon"});if(n.type==="line")return ge.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(i,"h").concat(c,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*c,",").concat(i,`
            H`).concat(Ma,"M").concat(2*c,",").concat(i,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(c,",").concat(i),className:"recharts-legend-icon"});if(n.type==="rect")return ge.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(Ma/8,"h").concat(Ma,"v").concat(Ma*3/4,"h").concat(-Ma,"z"),className:"recharts-legend-icon"});if(ge.isValidElement(n.legendIcon)){var u=tQ({},n);return delete u.legendIcon,ge.cloneElement(n.legendIcon,u)}return ge.createElement(Bw,{fill:l,cx:i,cy:i,size:Ma,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,i=a.payload,o=a.iconSize,c=a.layout,l=a.formatter,u=a.inactiveColor,d={x:0,y:0,width:Ma,height:Ma},f={display:c==="horizontal"?"inline-block":"block",marginRight:10},h={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(m,x){var p=m.formatter||l,g=dt(Vd(Vd({"recharts-legend-item":!0},"legend-item-".concat(x),!0),"inactive",m.inactive));if(m.type==="none")return null;var v=st(m.value)?null:m.value;bi(!st(m.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var y=m.inactive?u:m.color;return ge.createElement("li",s1({className:g,style:f,key:"legend-item-".concat(x)},uo(n.props,m,x)),ge.createElement(Zb,{width:o,height:o,viewBox:d,style:h},n.renderIcon(m)),ge.createElement("span",{className:"recharts-legend-item-text",style:{color:y}},p?p(v,m,x):v))})}},{key:"render",value:function(){var n=this.props,a=n.payload,i=n.layout,o=n.align;if(!a||!a.length)return null;var c={padding:0,margin:0,textAlign:i==="horizontal"?o:"left"};return ge.createElement("ul",{className:"recharts-default-legend",style:c},this.renderItems())}}])}(R.PureComponent);Vd(Lw,"displayName","Legend");Vd(Lw,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var uQ=x0;function dQ(){this.__data__=new uQ,this.size=0}var fQ=dQ;function hQ(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var mQ=hQ;function pQ(e){return this.__data__.get(e)}var xQ=pQ;function gQ(e){return this.__data__.has(e)}var vQ=gQ,yQ=x0,bQ=Cw,wQ=Aw,_Q=200;function jQ(e,t){var r=this.__data__;if(r instanceof yQ){var n=r.__data__;if(!bQ||n.length<_Q-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new wQ(n)}return r.set(e,t),this.size=r.size,this}var NQ=jQ,DQ=x0,SQ=fQ,EQ=mQ,TQ=xQ,CQ=vQ,AQ=NQ;function bu(e){var t=this.__data__=new DQ(e);this.size=t.size}bu.prototype.clear=SQ;bu.prototype.delete=EQ;bu.prototype.get=TQ;bu.prototype.has=CQ;bu.prototype.set=AQ;var $w=bu,kQ="__lodash_hash_undefined__";function FQ(e){return this.__data__.set(e,kQ),this}var OQ=FQ;function PQ(e){return this.__data__.has(e)}var IQ=PQ,UQ=Aw,RQ=OQ,MQ=IQ;function hp(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new UQ;++t<r;)this.add(e[t])}hp.prototype.add=hp.prototype.push=RQ;hp.prototype.has=MQ;var W5=hp;function BQ(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var z5=BQ;function LQ(e,t){return e.has(t)}var q5=LQ,$Q=W5,WQ=z5,zQ=q5,qQ=1,HQ=2;function VQ(e,t,r,n,a,i){var o=r&qQ,c=e.length,l=t.length;if(c!=l&&!(o&&l>c))return!1;var u=i.get(e),d=i.get(t);if(u&&d)return u==t&&d==e;var f=-1,h=!0,m=r&HQ?new $Q:void 0;for(i.set(e,t),i.set(t,e);++f<c;){var x=e[f],p=t[f];if(n)var g=o?n(p,x,f,t,e,i):n(x,p,f,e,t,i);if(g!==void 0){if(g)continue;h=!1;break}if(m){if(!WQ(t,function(v,y){if(!zQ(m,y)&&(x===v||a(x,v,r,n,i)))return m.push(y)})){h=!1;break}}else if(!(x===p||a(x,p,r,n,i))){h=!1;break}}return i.delete(e),i.delete(t),h}var H5=VQ,GQ=Ti,XQ=GQ.Uint8Array,V5=XQ;function KQ(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r}var YQ=KQ;function ZQ(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var Ww=ZQ,PS=hu,IS=V5,JQ=m0,QQ=H5,eee=YQ,tee=Ww,ree=1,nee=2,aee="[object Boolean]",iee="[object Date]",see="[object Error]",oee="[object Map]",cee="[object Number]",lee="[object RegExp]",uee="[object Set]",dee="[object String]",fee="[object Symbol]",hee="[object ArrayBuffer]",mee="[object DataView]",US=PS?PS.prototype:void 0,Fv=US?US.valueOf:void 0;function pee(e,t,r,n,a,i,o){switch(r){case mee:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case hee:return!(e.byteLength!=t.byteLength||!i(new IS(e),new IS(t)));case aee:case iee:case cee:return JQ(+e,+t);case see:return e.name==t.name&&e.message==t.message;case lee:case dee:return e==t+"";case oee:var c=eee;case uee:var l=n&ree;if(c||(c=tee),e.size!=t.size&&!l)return!1;var u=o.get(e);if(u)return u==t;n|=nee,o.set(e,t);var d=QQ(c(e),c(t),n,a,i,o);return o.delete(e),d;case fee:if(Fv)return Fv.call(e)==Fv.call(t)}return!1}var xee=pee;function gee(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var zw=gee,vee=zw,yee=Kn;function bee(e,t,r){var n=t(e);return yee(e)?n:vee(n,r(e))}var G5=bee;function wee(e,t){for(var r=-1,n=e==null?0:e.length,a=0,i=[];++r<n;){var o=e[r];t(o,r,e)&&(i[a++]=o)}return i}var _ee=wee;function jee(){return[]}var X5=jee,Nee=_ee,Dee=X5,See=Object.prototype,Eee=See.propertyIsEnumerable,RS=Object.getOwnPropertySymbols,Tee=RS?function(e){return e==null?[]:(e=Object(e),Nee(RS(e),function(t){return Eee.call(e,t)}))}:Dee,qw=Tee;function Cee(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var Aee=Cee,kee=Ps,Fee=Ci,Oee="[object Arguments]";function Pee(e){return Fee(e)&&kee(e)==Oee}var Iee=Pee,MS=Iee,Uee=Ci,K5=Object.prototype,Ree=K5.hasOwnProperty,Mee=K5.propertyIsEnumerable,Bee=MS(function(){return arguments}())?MS:function(e){return Uee(e)&&Ree.call(e,"callee")&&!Mee.call(e,"callee")},Hw=Bee,mp={exports:{}};function Lee(){return!1}var $ee=Lee;mp.exports;(function(e,t){var r=Ti,n=$ee,a=t&&!t.nodeType&&t,i=a&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===a,c=o?r.Buffer:void 0,l=c?c.isBuffer:void 0,u=l||n;e.exports=u})(mp,mp.exports);var Vw=mp.exports,Wee=9007199254740991,zee=/^(?:0|[1-9]\d*)$/;function qee(e,t){var r=typeof e;return t=t??Wee,!!t&&(r=="number"||r!="symbol"&&zee.test(e))&&e>-1&&e%1==0&&e<t}var Gw=qee,Hee=9007199254740991;function Vee(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Hee}var Xw=Vee,Gee=Ps,Xee=Xw,Kee=Ci,Yee="[object Arguments]",Zee="[object Array]",Jee="[object Boolean]",Qee="[object Date]",ete="[object Error]",tte="[object Function]",rte="[object Map]",nte="[object Number]",ate="[object Object]",ite="[object RegExp]",ste="[object Set]",ote="[object String]",cte="[object WeakMap]",lte="[object ArrayBuffer]",ute="[object DataView]",dte="[object Float32Array]",fte="[object Float64Array]",hte="[object Int8Array]",mte="[object Int16Array]",pte="[object Int32Array]",xte="[object Uint8Array]",gte="[object Uint8ClampedArray]",vte="[object Uint16Array]",yte="[object Uint32Array]",sr={};sr[dte]=sr[fte]=sr[hte]=sr[mte]=sr[pte]=sr[xte]=sr[gte]=sr[vte]=sr[yte]=!0;sr[Yee]=sr[Zee]=sr[lte]=sr[Jee]=sr[ute]=sr[Qee]=sr[ete]=sr[tte]=sr[rte]=sr[nte]=sr[ate]=sr[ite]=sr[ste]=sr[ote]=sr[cte]=!1;function bte(e){return Kee(e)&&Xee(e.length)&&!!sr[Gee(e)]}var wte=bte;function _te(e){return function(t){return e(t)}}var I0=_te,pp={exports:{}};pp.exports;(function(e,t){var r=n5,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,o=i&&r.process,c=function(){try{var l=a&&a.require&&a.require("util").types;return l||o&&o.binding&&o.binding("util")}catch{}}();e.exports=c})(pp,pp.exports);var Kw=pp.exports,jte=wte,Nte=I0,BS=Kw,LS=BS&&BS.isTypedArray,Dte=LS?Nte(LS):jte,Y5=Dte,Ste=Aee,Ete=Hw,Tte=Kn,Cte=Vw,Ate=Gw,kte=Y5,Fte=Object.prototype,Ote=Fte.hasOwnProperty;function Pte(e,t){var r=Tte(e),n=!r&&Ete(e),a=!r&&!n&&Cte(e),i=!r&&!n&&!a&&kte(e),o=r||n||a||i,c=o?Ste(e.length,String):[],l=c.length;for(var u in e)(t||Ote.call(e,u))&&!(o&&(u=="length"||a&&(u=="offset"||u=="parent")||i&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||Ate(u,l)))&&c.push(u);return c}var Z5=Pte,Ite=Object.prototype;function Ute(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||Ite;return e===r}var Yw=Ute;function Rte(e,t){return function(r){return e(t(r))}}var J5=Rte,Mte=J5,Bte=Mte(Object.keys,Object),Lte=Bte,$te=Yw,Wte=Lte,zte=Object.prototype,qte=zte.hasOwnProperty;function Hte(e){if(!$te(e))return Wte(e);var t=[];for(var r in Object(e))qte.call(e,r)&&r!="constructor"&&t.push(r);return t}var Vte=Hte,Gte=Tw,Xte=Xw;function Kte(e){return e!=null&&Xte(e.length)&&!Gte(e)}var wu=Kte,Yte=Z5,Zte=Vte,Jte=wu;function Qte(e){return Jte(e)?Yte(e):Zte(e)}var _u=Qte,ere=G5,tre=qw,rre=_u;function nre(e){return ere(e,rre,tre)}var Q5=nre,$S=Q5,are=1,ire=Object.prototype,sre=ire.hasOwnProperty;function ore(e,t,r,n,a,i){var o=r&are,c=$S(e),l=c.length,u=$S(t),d=u.length;if(l!=d&&!o)return!1;for(var f=l;f--;){var h=c[f];if(!(o?h in t:sre.call(t,h)))return!1}var m=i.get(e),x=i.get(t);if(m&&x)return m==t&&x==e;var p=!0;i.set(e,t),i.set(t,e);for(var g=o;++f<l;){h=c[f];var v=e[h],y=t[h];if(n)var b=o?n(y,v,h,t,e,i):n(v,y,h,e,t,i);if(!(b===void 0?v===y||a(v,y,r,n,i):b)){p=!1;break}g||(g=h=="constructor")}if(p&&!g){var _=e.constructor,w=t.constructor;_!=w&&"constructor"in e&&"constructor"in t&&!(typeof _=="function"&&_ instanceof _&&typeof w=="function"&&w instanceof w)&&(p=!1)}return i.delete(e),i.delete(t),p}var cre=ore,lre=Sc,ure=Ti,dre=lre(ure,"DataView"),fre=dre,hre=Sc,mre=Ti,pre=hre(mre,"Promise"),xre=pre,gre=Sc,vre=Ti,yre=gre(vre,"Set"),eP=yre,bre=Sc,wre=Ti,_re=bre(wre,"WeakMap"),jre=_re,c1=fre,l1=Cw,u1=xre,d1=eP,f1=jre,tP=Ps,ju=i5,WS="[object Map]",Nre="[object Object]",zS="[object Promise]",qS="[object Set]",HS="[object WeakMap]",VS="[object DataView]",Dre=ju(c1),Sre=ju(l1),Ere=ju(u1),Tre=ju(d1),Cre=ju(f1),Ho=tP;(c1&&Ho(new c1(new ArrayBuffer(1)))!=VS||l1&&Ho(new l1)!=WS||u1&&Ho(u1.resolve())!=zS||d1&&Ho(new d1)!=qS||f1&&Ho(new f1)!=HS)&&(Ho=function(e){var t=tP(e),r=t==Nre?e.constructor:void 0,n=r?ju(r):"";if(n)switch(n){case Dre:return VS;case Sre:return WS;case Ere:return zS;case Tre:return qS;case Cre:return HS}return t});var U0=Ho,Ov=$w,Are=H5,kre=xee,Fre=cre,GS=U0,XS=Kn,KS=Vw,Ore=Y5,Pre=1,YS="[object Arguments]",ZS="[object Array]",tm="[object Object]",Ire=Object.prototype,JS=Ire.hasOwnProperty;function Ure(e,t,r,n,a,i){var o=XS(e),c=XS(t),l=o?ZS:GS(e),u=c?ZS:GS(t);l=l==YS?tm:l,u=u==YS?tm:u;var d=l==tm,f=u==tm,h=l==u;if(h&&KS(e)){if(!KS(t))return!1;o=!0,d=!1}if(h&&!d)return i||(i=new Ov),o||Ore(e)?Are(e,t,r,n,a,i):kre(e,t,l,r,n,a,i);if(!(r&Pre)){var m=d&&JS.call(e,"__wrapped__"),x=f&&JS.call(t,"__wrapped__");if(m||x){var p=m?e.value():e,g=x?t.value():t;return i||(i=new Ov),a(p,g,r,n,i)}}return h?(i||(i=new Ov),Fre(e,t,r,n,a,i)):!1}var Rre=Ure,Mre=Rre,QS=Ci;function rP(e,t,r,n,a){return e===t?!0:e==null||t==null||!QS(e)&&!QS(t)?e!==e&&t!==t:Mre(e,t,r,n,rP,a)}var Zw=rP,Bre=$w,Lre=Zw,$re=1,Wre=2;function zre(e,t,r,n){var a=r.length,i=a,o=!n;if(e==null)return!i;for(e=Object(e);a--;){var c=r[a];if(o&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++a<i;){c=r[a];var l=c[0],u=e[l],d=c[1];if(o&&c[2]){if(u===void 0&&!(l in e))return!1}else{var f=new Bre;if(n)var h=n(u,d,l,e,t,f);if(!(h===void 0?Lre(d,u,$re|Wre,n,f):h))return!1}}return!0}var qre=zre,Hre=Ai;function Vre(e){return e===e&&!Hre(e)}var nP=Vre,Gre=nP,Xre=_u;function Kre(e){for(var t=Xre(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,Gre(a)]}return t}var Yre=Kre;function Zre(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var aP=Zre,Jre=qre,Qre=Yre,ene=aP;function tne(e){var t=Qre(e);return t.length==1&&t[0][2]?ene(t[0][0],t[0][1]):function(r){return r===e||Jre(r,e,t)}}var rne=tne;function nne(e,t){return e!=null&&t in Object(e)}var ane=nne,ine=y0,sne=Hw,one=Kn,cne=Gw,lne=Xw,une=wh;function dne(e,t,r){t=ine(t,e);for(var n=-1,a=t.length,i=!1;++n<a;){var o=une(t[n]);if(!(i=e!=null&&r(e,o)))break;e=e[o]}return i||++n!=a?i:(a=e==null?0:e.length,!!a&&lne(a)&&cne(o,a)&&(one(e)||sne(e)))}var fne=dne,hne=ane,mne=fne;function pne(e,t){return e!=null&&mne(e,t,hne)}var xne=pne,gne=Zw,vne=u5,yne=xne,bne=Ew,wne=nP,_ne=aP,jne=wh,Nne=1,Dne=2;function Sne(e,t){return bne(e)&&wne(t)?_ne(jne(e),t):function(r){var n=vne(r,e);return n===void 0&&n===t?yne(r,e):gne(t,n,Nne|Dne)}}var Ene=Sne;function Tne(e){return e}var Nu=Tne;function Cne(e){return function(t){return t==null?void 0:t[e]}}var Ane=Cne,kne=b0;function Fne(e){return function(t){return kne(t,e)}}var One=Fne,Pne=Ane,Ine=One,Une=Ew,Rne=wh;function Mne(e){return Une(e)?Pne(Rne(e)):Ine(e)}var Bne=Mne,Lne=rne,$ne=Ene,Wne=Nu,zne=Kn,qne=Bne;function Hne(e){return typeof e=="function"?e:e==null?Wne:typeof e=="object"?zne(e)?$ne(e[0],e[1]):Lne(e):qne(e)}var Ji=Hne;function Vne(e,t,r,n){for(var a=e.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1}var iP=Vne;function Gne(e){return e!==e}var Xne=Gne;function Kne(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}var Yne=Kne,Zne=iP,Jne=Xne,Qne=Yne;function eae(e,t,r){return t===t?Qne(e,t,r):Zne(e,Jne,r)}var tae=eae,rae=tae;function nae(e,t){var r=e==null?0:e.length;return!!r&&rae(e,t,0)>-1}var aae=nae;function iae(e,t,r){for(var n=-1,a=e==null?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}var sae=iae;function oae(){}var cae=oae,Pv=eP,lae=cae,uae=Ww,dae=1/0,fae=Pv&&1/uae(new Pv([,-0]))[1]==dae?function(e){return new Pv(e)}:lae,hae=fae,mae=W5,pae=aae,xae=sae,gae=q5,vae=hae,yae=Ww,bae=200;function wae(e,t,r){var n=-1,a=pae,i=e.length,o=!0,c=[],l=c;if(r)o=!1,a=xae;else if(i>=bae){var u=t?null:vae(e);if(u)return yae(u);o=!1,a=gae,l=new mae}else l=t?[]:c;e:for(;++n<i;){var d=e[n],f=t?t(d):d;if(d=r||d!==0?d:0,o&&f===f){for(var h=l.length;h--;)if(l[h]===f)continue e;t&&l.push(f),c.push(d)}else a(l,f,r)||(l!==c&&l.push(f),c.push(d))}return c}var _ae=wae,jae=Ji,Nae=_ae;function Dae(e,t){return e&&e.length?Nae(e,jae(t)):[]}var Sae=Dae;const eE=Rt(Sae);function sP(e,t,r){return t===!0?eE(e,r):st(t)?eE(e,t):e}function Tl(e){"@babel/helpers - typeof";return Tl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tl(e)}var Eae=["ref"];function tE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function is(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tE(Object(r),!0).forEach(function(n){R0(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Tae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rE(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cP(n.key),n)}}function Cae(e,t,r){return t&&rE(e.prototype,t),r&&rE(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Aae(e,t,r){return t=xp(t),kae(e,oP()?Reflect.construct(t,r||[],xp(e).constructor):t.apply(e,r))}function kae(e,t){if(t&&(Tl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fae(e)}function Fae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oP(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oP=function(){return!!e})()}function xp(e){return xp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xp(e)}function Oae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h1(e,t)}function h1(e,t){return h1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},h1(e,t)}function R0(e,t,r){return t=cP(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cP(e){var t=Pae(e,"string");return Tl(t)=="symbol"?t:t+""}function Pae(e,t){if(Tl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Tl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Iae(e,t){if(e==null)return{};var r=Uae(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Uae(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Rae(e){return e.value}function Mae(e,t){if(ge.isValidElement(e))return ge.cloneElement(e,t);if(typeof e=="function")return ge.createElement(e,t);t.ref;var r=Iae(t,Eae);return ge.createElement(Lw,r)}var nE=1,ao=function(e){function t(){var r;Tae(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=Aae(this,t,[].concat(a)),R0(r,"lastBoundingBox",{width:-1,height:-1}),r}return Oae(t,e),Cae(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>nE||Math.abs(a.height-this.lastBoundingBox.height)>nE)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?is({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,i=a.layout,o=a.align,c=a.verticalAlign,l=a.margin,u=a.chartWidth,d=a.chartHeight,f,h;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(o==="center"&&i==="vertical"){var m=this.getBBoxSnapshot();f={left:((u||0)-m.width)/2}}else f=o==="right"?{right:l&&l.right||0}:{left:l&&l.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(c==="middle"){var x=this.getBBoxSnapshot();h={top:((d||0)-x.height)/2}}else h=c==="bottom"?{bottom:l&&l.bottom||0}:{top:l&&l.top||0};return is(is({},f),h)}},{key:"render",value:function(){var n=this,a=this.props,i=a.content,o=a.width,c=a.height,l=a.wrapperStyle,u=a.payloadUniqBy,d=a.payload,f=is(is({position:"absolute",width:o||"auto",height:c||"auto"},this.getDefaultPosition(l)),l);return ge.createElement("div",{className:"recharts-legend-wrapper",style:f,ref:function(m){n.wrapperNode=m}},Mae(i,is(is({},this.props),{},{payload:sP(d,u,Rae)})))}}],[{key:"getWithHeight",value:function(n,a){var i=is(is({},this.defaultProps),n.props),o=i.layout;return o==="vertical"&&Re(n.props.height)?{height:n.props.height}:o==="horizontal"?{width:n.props.width||a}:null}}])}(R.PureComponent);R0(ao,"displayName","Legend");R0(ao,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var aE=hu,Bae=Hw,Lae=Kn,iE=aE?aE.isConcatSpreadable:void 0;function $ae(e){return Lae(e)||Bae(e)||!!(iE&&e&&e[iE])}var Wae=$ae,zae=zw,qae=Wae;function lP(e,t,r,n,a){var i=-1,o=e.length;for(r||(r=qae),a||(a=[]);++i<o;){var c=e[i];t>0&&r(c)?t>1?lP(c,t-1,r,n,a):zae(a,c):n||(a[a.length]=c)}return a}var Jw=lP;function Hae(e){return function(t,r,n){for(var a=-1,i=Object(t),o=n(t),c=o.length;c--;){var l=o[e?c:++a];if(r(i[l],l,i)===!1)break}return t}}var Vae=Hae,Gae=Vae,Xae=Gae(),Kae=Xae,Yae=Kae,Zae=_u;function Jae(e,t){return e&&Yae(e,t,Zae)}var uP=Jae,Qae=wu;function eie(e,t){return function(r,n){if(r==null)return r;if(!Qae(r))return e(r,n);for(var a=r.length,i=t?a:-1,o=Object(r);(t?i--:++i<a)&&n(o[i],i,o)!==!1;);return r}}var tie=eie,rie=uP,nie=tie,aie=nie(rie),Qw=aie,iie=Qw,sie=wu;function oie(e,t){var r=-1,n=sie(e)?Array(e.length):[];return iie(e,function(a,i,o){n[++r]=t(a,i,o)}),n}var dP=oie;function cie(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var lie=cie,sE=mu;function uie(e,t){if(e!==t){var r=e!==void 0,n=e===null,a=e===e,i=sE(e),o=t!==void 0,c=t===null,l=t===t,u=sE(t);if(!c&&!u&&!i&&e>t||i&&o&&l&&!c&&!u||n&&o&&l||!r&&l||!a)return 1;if(!n&&!i&&!u&&e<t||u&&r&&a&&!n&&!i||c&&r&&a||!o&&a||!l)return-1}return 0}var die=uie,fie=die;function hie(e,t,r){for(var n=-1,a=e.criteria,i=t.criteria,o=a.length,c=r.length;++n<o;){var l=fie(a[n],i[n]);if(l){if(n>=c)return l;var u=r[n];return l*(u=="desc"?-1:1)}}return e.index-t.index}var mie=hie,Iv=v0,pie=b0,xie=Ji,gie=dP,vie=lie,yie=I0,bie=mie,wie=Nu,_ie=Kn;function jie(e,t,r){t.length?t=Iv(t,function(i){return _ie(i)?function(o){return pie(o,i.length===1?i[0]:i)}:i}):t=[wie];var n=-1;t=Iv(t,yie(xie));var a=gie(e,function(i,o,c){var l=Iv(t,function(u){return u(i)});return{criteria:l,index:++n,value:i}});return vie(a,function(i,o){return bie(i,o,r)})}var Nie=jie;function Die(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var Sie=Die,Eie=Sie,oE=Math.max;function Tie(e,t,r){return t=oE(t===void 0?e.length-1:t,0),function(){for(var n=arguments,a=-1,i=oE(n.length-t,0),o=Array(i);++a<i;)o[a]=n[t+a];a=-1;for(var c=Array(t+1);++a<t;)c[a]=n[a];return c[t]=r(o),Eie(e,this,c)}}var fP=Tie;function Cie(e){return function(){return e}}var Aie=Cie,kie=Sc,Fie=function(){try{var e=kie(Object,"defineProperty");return e({},"",{}),e}catch{}}(),hP=Fie,Oie=Aie,cE=hP,Pie=Nu,Iie=cE?function(e,t){return cE(e,"toString",{configurable:!0,enumerable:!1,value:Oie(t),writable:!0})}:Pie,Uie=Iie,Rie=800,Mie=16,Bie=Date.now;function Lie(e){var t=0,r=0;return function(){var n=Bie(),a=Mie-(n-r);if(r=n,a>0){if(++t>=Rie)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var $ie=Lie,Wie=Uie,zie=$ie,qie=zie(Wie),mP=qie,Hie=Nu,Vie=fP,Gie=mP;function Xie(e,t){return Gie(Vie(e,t,Hie),e+"")}var Kie=Xie,Yie=m0,Zie=wu,Jie=Gw,Qie=Ai;function ese(e,t,r){if(!Qie(r))return!1;var n=typeof t;return(n=="number"?Zie(r)&&Jie(t,r.length):n=="string"&&t in r)?Yie(r[t],e):!1}var M0=ese,tse=Jw,rse=Nie,nse=Kie,lE=M0,ase=nse(function(e,t){if(e==null)return[];var r=t.length;return r>1&&lE(e,t[0],t[1])?t=[]:r>2&&lE(t[0],t[1],t[2])&&(t=[t[0]]),rse(e,tse(t,1),[])}),ise=ase;const e_=Rt(ise);function Gd(e){"@babel/helpers - typeof";return Gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gd(e)}function m1(){return m1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},m1.apply(this,arguments)}function sse(e,t){return use(e)||lse(e,t)||cse(e,t)||ose()}function ose(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cse(e,t){if(e){if(typeof e=="string")return uE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uE(e,t)}}function uE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lse(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,c=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return c}}function use(e){if(Array.isArray(e))return e}function dE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Uv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dE(Object(r),!0).forEach(function(n){dse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dse(e,t,r){return t=fse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fse(e){var t=hse(e,"string");return Gd(t)=="symbol"?t:t+""}function hse(e,t){if(Gd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Gd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mse(e){return Array.isArray(e)&&Hr(e[0])&&Hr(e[1])?e.join(" ~ "):e}var pse=function(t){var r=t.separator,n=r===void 0?" : ":r,a=t.contentStyle,i=a===void 0?{}:a,o=t.itemStyle,c=o===void 0?{}:o,l=t.labelStyle,u=l===void 0?{}:l,d=t.payload,f=t.formatter,h=t.itemSorter,m=t.wrapperClassName,x=t.labelClassName,p=t.label,g=t.labelFormatter,v=t.accessibilityLayer,y=v===void 0?!1:v,b=function(){if(d&&d.length){var E={padding:0,margin:0},M=(h?e_(d,h):d).map(function(P,X){if(P.type==="none")return null;var q=Uv({display:"block",paddingTop:4,paddingBottom:4,color:P.color||"#000"},c),B=P.formatter||f||mse,O=P.value,F=P.name,I=O,L=F;if(B&&I!=null&&L!=null){var C=B(O,F,P,X,d);if(Array.isArray(C)){var k=sse(C,2);I=k[0],L=k[1]}else I=C}return ge.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(X),style:q},Hr(L)?ge.createElement("span",{className:"recharts-tooltip-item-name"},L):null,Hr(L)?ge.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,ge.createElement("span",{className:"recharts-tooltip-item-value"},I),ge.createElement("span",{className:"recharts-tooltip-item-unit"},P.unit||""))});return ge.createElement("ul",{className:"recharts-tooltip-item-list",style:E},M)}return null},_=Uv({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),w=Uv({margin:0},u),j=!ft(p),N=j?p:"",D=dt("recharts-default-tooltip",m),S=dt("recharts-tooltip-label",x);j&&g&&d!==void 0&&d!==null&&(N=g(p,d));var T=y?{role:"status","aria-live":"assertive"}:{};return ge.createElement("div",m1({className:D,style:_},T),ge.createElement("p",{className:S,style:w},ge.isValidElement(N)?N:"".concat(N)),b())};function Xd(e){"@babel/helpers - typeof";return Xd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xd(e)}function rm(e,t,r){return t=xse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xse(e){var t=gse(e,"string");return Xd(t)=="symbol"?t:t+""}function gse(e,t){if(Xd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Xd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yu="recharts-tooltip-wrapper",vse={visibility:"hidden"};function yse(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return dt(Yu,rm(rm(rm(rm({},"".concat(Yu,"-right"),Re(r)&&t&&Re(t.x)&&r>=t.x),"".concat(Yu,"-left"),Re(r)&&t&&Re(t.x)&&r<t.x),"".concat(Yu,"-bottom"),Re(n)&&t&&Re(t.y)&&n>=t.y),"".concat(Yu,"-top"),Re(n)&&t&&Re(t.y)&&n<t.y))}function fE(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,a=e.offsetTopLeft,i=e.position,o=e.reverseDirection,c=e.tooltipDimension,l=e.viewBox,u=e.viewBoxDimension;if(i&&Re(i[n]))return i[n];var d=r[n]-c-a,f=r[n]+a;if(t[n])return o[n]?d:f;if(o[n]){var h=d,m=l[n];return h<m?Math.max(f,l[n]):Math.max(d,l[n])}var x=f+c,p=l[n]+u;return x>p?Math.max(d,l[n]):Math.max(f,l[n])}function bse(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function wse(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,a=e.position,i=e.reverseDirection,o=e.tooltipBox,c=e.useTranslate3d,l=e.viewBox,u,d,f;return o.height>0&&o.width>0&&r?(d=fE({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:o.width,viewBox:l,viewBoxDimension:l.width}),f=fE({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:o.height,viewBox:l,viewBoxDimension:l.height}),u=bse({translateX:d,translateY:f,useTranslate3d:c})):u=vse,{cssProperties:u,cssClasses:yse({translateX:d,translateY:f,coordinate:r})}}function Cl(e){"@babel/helpers - typeof";return Cl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cl(e)}function hE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hE(Object(r),!0).forEach(function(n){x1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jse(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xP(n.key),n)}}function Nse(e,t,r){return t&&jse(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dse(e,t,r){return t=gp(t),Sse(e,pP()?Reflect.construct(t,r||[],gp(e).constructor):t.apply(e,r))}function Sse(e,t){if(t&&(Cl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ese(e)}function Ese(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pP(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pP=function(){return!!e})()}function gp(e){return gp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gp(e)}function Tse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p1(e,t)}function p1(e,t){return p1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},p1(e,t)}function x1(e,t,r){return t=xP(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xP(e){var t=Cse(e,"string");return Cl(t)=="symbol"?t:t+""}function Cse(e,t){if(Cl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Cl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var pE=1,Ase=function(e){function t(){var r;_se(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=Dse(this,t,[].concat(a)),x1(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),x1(r,"handleKeyDown",function(o){if(o.key==="Escape"){var c,l,u,d;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(c=(l=r.props.coordinate)===null||l===void 0?void 0:l.x)!==null&&c!==void 0?c:0,y:(u=(d=r.props.coordinate)===null||d===void 0?void 0:d.y)!==null&&u!==void 0?u:0}})}}),r}return Tse(t,e),Nse(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>pE||Math.abs(n.height-this.state.lastBoundingBox.height)>pE)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,i=a.active,o=a.allowEscapeViewBox,c=a.animationDuration,l=a.animationEasing,u=a.children,d=a.coordinate,f=a.hasPayload,h=a.isAnimationActive,m=a.offset,x=a.position,p=a.reverseDirection,g=a.useTranslate3d,v=a.viewBox,y=a.wrapperStyle,b=wse({allowEscapeViewBox:o,coordinate:d,offsetTopLeft:m,position:x,reverseDirection:p,tooltipBox:this.state.lastBoundingBox,useTranslate3d:g,viewBox:v}),_=b.cssClasses,w=b.cssProperties,j=mE(mE({transition:h&&i?"transform ".concat(c,"ms ").concat(l):void 0},w),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&f?"visible":"hidden",position:"absolute",top:0,left:0},y);return ge.createElement("div",{tabIndex:-1,className:_,style:j,ref:function(D){n.wrapperNode=D}},u)}}])}(R.PureComponent),kse=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},bo={isSsr:kse()};function Al(e){"@babel/helpers - typeof";return Al=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Al(e)}function xE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function gE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xE(Object(r),!0).forEach(function(n){t_(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Fse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ose(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vP(n.key),n)}}function Pse(e,t,r){return t&&Ose(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ise(e,t,r){return t=vp(t),Use(e,gP()?Reflect.construct(t,r||[],vp(e).constructor):t.apply(e,r))}function Use(e,t){if(t&&(Al(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rse(e)}function Rse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gP(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gP=function(){return!!e})()}function vp(e){return vp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vp(e)}function Mse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g1(e,t)}function g1(e,t){return g1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},g1(e,t)}function t_(e,t,r){return t=vP(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vP(e){var t=Bse(e,"string");return Al(t)=="symbol"?t:t+""}function Bse(e,t){if(Al(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Al(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Lse(e){return e.dataKey}function $se(e,t){return ge.isValidElement(e)?ge.cloneElement(e,t):typeof e=="function"?ge.createElement(e,t):ge.createElement(pse,t)}var _r=function(e){function t(){return Fse(this,t),Ise(this,t,arguments)}return Mse(t,e),Pse(t,[{key:"render",value:function(){var n=this,a=this.props,i=a.active,o=a.allowEscapeViewBox,c=a.animationDuration,l=a.animationEasing,u=a.content,d=a.coordinate,f=a.filterNull,h=a.isAnimationActive,m=a.offset,x=a.payload,p=a.payloadUniqBy,g=a.position,v=a.reverseDirection,y=a.useTranslate3d,b=a.viewBox,_=a.wrapperStyle,w=x??[];f&&w.length&&(w=sP(x.filter(function(N){return N.value!=null&&(N.hide!==!0||n.props.includeHidden)}),p,Lse));var j=w.length>0;return ge.createElement(Ase,{allowEscapeViewBox:o,animationDuration:c,animationEasing:l,isAnimationActive:h,active:i,coordinate:d,hasPayload:j,offset:m,position:g,reverseDirection:v,useTranslate3d:y,viewBox:b,wrapperStyle:_},$se(u,gE(gE({},this.props),{},{payload:w})))}}])}(R.PureComponent);t_(_r,"displayName","Tooltip");t_(_r,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!bo.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var Wse=Ti,zse=function(){return Wse.Date.now()},qse=zse,Hse=/\s/;function Vse(e){for(var t=e.length;t--&&Hse.test(e.charAt(t)););return t}var Gse=Vse,Xse=Gse,Kse=/^\s+/;function Yse(e){return e&&e.slice(0,Xse(e)+1).replace(Kse,"")}var Zse=Yse,Jse=Zse,vE=Ai,Qse=mu,yE=NaN,eoe=/^[-+]0x[0-9a-f]+$/i,toe=/^0b[01]+$/i,roe=/^0o[0-7]+$/i,noe=parseInt;function aoe(e){if(typeof e=="number")return e;if(Qse(e))return yE;if(vE(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=vE(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Jse(e);var r=toe.test(e);return r||roe.test(e)?noe(e.slice(2),r?2:8):eoe.test(e)?yE:+e}var yP=aoe,ioe=Ai,Rv=qse,bE=yP,soe="Expected a function",ooe=Math.max,coe=Math.min;function loe(e,t,r){var n,a,i,o,c,l,u=0,d=!1,f=!1,h=!0;if(typeof e!="function")throw new TypeError(soe);t=bE(t)||0,ioe(r)&&(d=!!r.leading,f="maxWait"in r,i=f?ooe(bE(r.maxWait)||0,t):i,h="trailing"in r?!!r.trailing:h);function m(j){var N=n,D=a;return n=a=void 0,u=j,o=e.apply(D,N),o}function x(j){return u=j,c=setTimeout(v,t),d?m(j):o}function p(j){var N=j-l,D=j-u,S=t-N;return f?coe(S,i-D):S}function g(j){var N=j-l,D=j-u;return l===void 0||N>=t||N<0||f&&D>=i}function v(){var j=Rv();if(g(j))return y(j);c=setTimeout(v,p(j))}function y(j){return c=void 0,h&&n?m(j):(n=a=void 0,o)}function b(){c!==void 0&&clearTimeout(c),u=0,n=l=a=c=void 0}function _(){return c===void 0?o:y(Rv())}function w(){var j=Rv(),N=g(j);if(n=arguments,a=this,l=j,N){if(c===void 0)return x(l);if(f)return clearTimeout(c),c=setTimeout(v,t),m(l)}return c===void 0&&(c=setTimeout(v,t)),o}return w.cancel=b,w.flush=_,w}var uoe=loe,doe=uoe,foe=Ai,hoe="Expected a function";function moe(e,t,r){var n=!0,a=!0;if(typeof e!="function")throw new TypeError(hoe);return foe(r)&&(n="leading"in r?!!r.leading:n,a="trailing"in r?!!r.trailing:a),doe(e,t,{leading:n,maxWait:t,trailing:a})}var poe=moe;const bP=Rt(poe);function Kd(e){"@babel/helpers - typeof";return Kd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kd(e)}function wE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function nm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wE(Object(r),!0).forEach(function(n){xoe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xoe(e,t,r){return t=goe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function goe(e){var t=voe(e,"string");return Kd(t)=="symbol"?t:t+""}function voe(e,t){if(Kd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Kd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yoe(e,t){return joe(e)||_oe(e,t)||woe(e,t)||boe()}function boe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function woe(e,t){if(e){if(typeof e=="string")return _E(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _E(e,t)}}function _E(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _oe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,c=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return c}}function joe(e){if(Array.isArray(e))return e}var zn=R.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,a=n===void 0?{width:-1,height:-1}:n,i=e.width,o=i===void 0?"100%":i,c=e.height,l=c===void 0?"100%":c,u=e.minWidth,d=u===void 0?0:u,f=e.minHeight,h=e.maxHeight,m=e.children,x=e.debounce,p=x===void 0?0:x,g=e.id,v=e.className,y=e.onResize,b=e.style,_=b===void 0?{}:b,w=R.useRef(null),j=R.useRef();j.current=y,R.useImperativeHandle(t,function(){return Object.defineProperty(w.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),w.current},configurable:!0})});var N=R.useState({containerWidth:a.width,containerHeight:a.height}),D=yoe(N,2),S=D[0],T=D[1],A=R.useCallback(function(M,P){T(function(X){var q=Math.round(M),B=Math.round(P);return X.containerWidth===q&&X.containerHeight===B?X:{containerWidth:q,containerHeight:B}})},[]);R.useEffect(function(){var M=function(F){var I,L=F[0].contentRect,C=L.width,k=L.height;A(C,k),(I=j.current)===null||I===void 0||I.call(j,C,k)};p>0&&(M=bP(M,p,{trailing:!0,leading:!1}));var P=new ResizeObserver(M),X=w.current.getBoundingClientRect(),q=X.width,B=X.height;return A(q,B),P.observe(w.current),function(){P.disconnect()}},[A,p]);var E=R.useMemo(function(){var M=S.containerWidth,P=S.containerHeight;if(M<0||P<0)return null;bi(Jo(o)||Jo(l),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,o,l),bi(!r||r>0,"The aspect(%s) must be greater than zero.",r);var X=Jo(o)?M:o,q=Jo(l)?P:l;r&&r>0&&(X?q=X/r:q&&(X=q*r),h&&q>h&&(q=h)),bi(X>0||q>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,X,q,o,l,d,f,r);var B=!Array.isArray(m)&&gs(m.type).endsWith("Chart");return ge.Children.map(m,function(O){return ge.isValidElement(O)?R.cloneElement(O,nm({width:X,height:q},B?{style:nm({height:"100%",width:"100%",maxHeight:q,maxWidth:X},O.props.style)}:{})):O})},[r,m,l,h,f,d,S,o]);return ge.createElement("div",{id:g?"".concat(g):void 0,className:dt("recharts-responsive-container",v),style:nm(nm({},_),{},{width:o,height:l,minWidth:d,minHeight:f,maxHeight:h}),ref:w},E)}),Ns=function(t){return null};Ns.displayName="Cell";function Yd(e){"@babel/helpers - typeof";return Yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yd(e)}function jE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function v1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jE(Object(r),!0).forEach(function(n){Noe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Noe(e,t,r){return t=Doe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Doe(e){var t=Soe(e,"string");return Yd(t)=="symbol"?t:t+""}function Soe(e,t){if(Yd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Yd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $c={widthCache:{},cacheCount:0},Eoe=2e3,Toe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},NE="recharts_measurement_span";function Coe(e){var t=v1({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var jd=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||bo.isSsr)return{width:0,height:0};var n=Coe(r),a=JSON.stringify({text:t,copyStyle:n});if($c.widthCache[a])return $c.widthCache[a];try{var i=document.getElementById(NE);i||(i=document.createElement("span"),i.setAttribute("id",NE),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var o=v1(v1({},Toe),n);Object.assign(i.style,o),i.textContent="".concat(t);var c=i.getBoundingClientRect(),l={width:c.width,height:c.height};return $c.widthCache[a]=l,++$c.cacheCount>Eoe&&($c.cacheCount=0,$c.widthCache={}),l}catch{return{width:0,height:0}}},Aoe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function Zd(e){"@babel/helpers - typeof";return Zd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zd(e)}function yp(e,t){return Poe(e)||Ooe(e,t)||Foe(e,t)||koe()}function koe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Foe(e,t){if(e){if(typeof e=="string")return DE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DE(e,t)}}function DE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ooe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,c=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return c}}function Poe(e){if(Array.isArray(e))return e}function Ioe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SE(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Roe(n.key),n)}}function Uoe(e,t,r){return t&&SE(e.prototype,t),r&&SE(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Roe(e){var t=Moe(e,"string");return Zd(t)=="symbol"?t:t+""}function Moe(e,t){if(Zd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Zd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var EE=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,TE=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Boe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Loe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,wP={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},$oe=Object.keys(wP),nl="NaN";function Woe(e,t){return e*wP[t]}var am=function(){function e(t,r){Ioe(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!Boe.test(r)&&(this.num=NaN,this.unit=""),$oe.includes(r)&&(this.num=Woe(t,r),this.unit="px")}return Uoe(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,a=(n=Loe.exec(r))!==null&&n!==void 0?n:[],i=yp(a,3),o=i[1],c=i[2];return new e(parseFloat(o),c??"")}}])}();function _P(e){if(e.includes(nl))return nl;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=EE.exec(t))!==null&&r!==void 0?r:[],a=yp(n,4),i=a[1],o=a[2],c=a[3],l=am.parse(i??""),u=am.parse(c??""),d=o==="*"?l.multiply(u):l.divide(u);if(d.isNaN())return nl;t=t.replace(EE,d.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,h=(f=TE.exec(t))!==null&&f!==void 0?f:[],m=yp(h,4),x=m[1],p=m[2],g=m[3],v=am.parse(x??""),y=am.parse(g??""),b=p==="+"?v.add(y):v.subtract(y);if(b.isNaN())return nl;t=t.replace(TE,b.toString())}return t}var CE=/\(([^()]*)\)/;function zoe(e){for(var t=e;t.includes("(");){var r=CE.exec(t),n=yp(r,2),a=n[1];t=t.replace(CE,_P(a))}return t}function qoe(e){var t=e.replace(/\s+/g,"");return t=zoe(t),t=_P(t),t}function Hoe(e){try{return qoe(e)}catch{return nl}}function Mv(e){var t=Hoe(e.slice(5,-1));return t===nl?"":t}var Voe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Goe=["dx","dy","angle","className","breakAll"];function y1(){return y1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},y1.apply(this,arguments)}function AE(e,t){if(e==null)return{};var r=Xoe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Xoe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function kE(e,t){return Joe(e)||Zoe(e,t)||Yoe(e,t)||Koe()}function Koe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yoe(e,t){if(e){if(typeof e=="string")return FE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FE(e,t)}}function FE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Zoe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,c=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return c}}function Joe(e){if(Array.isArray(e))return e}var jP=/[ \f\n\r\t\v\u2028\u2029]+/,NP=function(t){var r=t.children,n=t.breakAll,a=t.style;try{var i=[];ft(r)||(n?i=r.toString().split(""):i=r.toString().split(jP));var o=i.map(function(l){return{word:l,width:jd(l,a).width}}),c=n?0:jd("",a).width;return{wordsWithComputedWidth:o,spaceWidth:c}}catch{return null}},Qoe=function(t,r,n,a,i){var o=t.maxLines,c=t.children,l=t.style,u=t.breakAll,d=Re(o),f=c,h=function(){var X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return X.reduce(function(q,B){var O=B.word,F=B.width,I=q[q.length-1];if(I&&(a==null||i||I.width+F+n<Number(a)))I.words.push(O),I.width+=F+n;else{var L={words:[O],width:F};q.push(L)}return q},[])},m=h(r),x=function(X){return X.reduce(function(q,B){return q.width>B.width?q:B})};if(!d)return m;for(var p="",g=function(X){var q=f.slice(0,X),B=NP({breakAll:u,style:l,children:q+p}).wordsWithComputedWidth,O=h(B),F=O.length>o||x(O).width>Number(a);return[F,O]},v=0,y=f.length-1,b=0,_;v<=y&&b<=f.length-1;){var w=Math.floor((v+y)/2),j=w-1,N=g(j),D=kE(N,2),S=D[0],T=D[1],A=g(w),E=kE(A,1),M=E[0];if(!S&&!M&&(v=w+1),S&&M&&(y=w-1),!S&&M){_=T;break}b++}return _||m},OE=function(t){var r=ft(t)?[]:t.toString().split(jP);return[{words:r}]},ece=function(t){var r=t.width,n=t.scaleToFit,a=t.children,i=t.style,o=t.breakAll,c=t.maxLines;if((r||n)&&!bo.isSsr){var l,u,d=NP({breakAll:o,children:a,style:i});if(d){var f=d.wordsWithComputedWidth,h=d.spaceWidth;l=f,u=h}else return OE(a);return Qoe({breakAll:o,children:a,maxLines:c,style:i},l,u,r,n)}return OE(a)},PE="#808080",fc=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,o=t.lineHeight,c=o===void 0?"1em":o,l=t.capHeight,u=l===void 0?"0.71em":l,d=t.scaleToFit,f=d===void 0?!1:d,h=t.textAnchor,m=h===void 0?"start":h,x=t.verticalAnchor,p=x===void 0?"end":x,g=t.fill,v=g===void 0?PE:g,y=AE(t,Voe),b=R.useMemo(function(){return ece({breakAll:y.breakAll,children:y.children,maxLines:y.maxLines,scaleToFit:f,style:y.style,width:y.width})},[y.breakAll,y.children,y.maxLines,f,y.style,y.width]),_=y.dx,w=y.dy,j=y.angle,N=y.className,D=y.breakAll,S=AE(y,Goe);if(!Hr(n)||!Hr(i))return null;var T=n+(Re(_)?_:0),A=i+(Re(w)?w:0),E;switch(p){case"start":E=Mv("calc(".concat(u,")"));break;case"middle":E=Mv("calc(".concat((b.length-1)/2," * -").concat(c," + (").concat(u," / 2))"));break;default:E=Mv("calc(".concat(b.length-1," * -").concat(c,")"));break}var M=[];if(f){var P=b[0].width,X=y.width;M.push("scale(".concat((Re(X)?X/P:1)/P,")"))}return j&&M.push("rotate(".concat(j,", ").concat(T,", ").concat(A,")")),M.length&&(S.transform=M.join(" ")),ge.createElement("text",y1({},nt(S,!0),{x:T,y:A,className:dt("recharts-text",N),textAnchor:m,fill:v.includes("url")?PE:v}),b.map(function(q,B){var O=q.words.join(D?"":" ");return ge.createElement("tspan",{x:T,dy:B===0?E:c,key:"".concat(O,"-").concat(B)},O)}))};function io(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function tce(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function r_(e){let t,r,n;e.length!==2?(t=io,r=(c,l)=>io(e(c),l),n=(c,l)=>e(c)-l):(t=e===io||e===tce?e:rce,r=e,n=e);function a(c,l,u=0,d=c.length){if(u<d){if(t(l,l)!==0)return d;do{const f=u+d>>>1;r(c[f],l)<0?u=f+1:d=f}while(u<d)}return u}function i(c,l,u=0,d=c.length){if(u<d){if(t(l,l)!==0)return d;do{const f=u+d>>>1;r(c[f],l)<=0?u=f+1:d=f}while(u<d)}return u}function o(c,l,u=0,d=c.length){const f=a(c,l,u,d-1);return f>u&&n(c[f-1],l)>-n(c[f],l)?f-1:f}return{left:a,center:o,right:i}}function rce(){return 0}function DP(e){return e===null?NaN:+e}function*nce(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const ace=r_(io),jh=ace.right;r_(DP).center;class IE extends Map{constructor(t,r=oce){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(UE(this,t))}has(t){return super.has(UE(this,t))}set(t,r){return super.set(ice(this,t),r)}delete(t){return super.delete(sce(this,t))}}function UE({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function ice({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function sce({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function oce(e){return e!==null&&typeof e=="object"?e.valueOf():e}function cce(e=io){if(e===io)return SP;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function SP(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const lce=Math.sqrt(50),uce=Math.sqrt(10),dce=Math.sqrt(2);function bp(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),o=i>=lce?10:i>=uce?5:i>=dce?2:1;let c,l,u;return a<0?(u=Math.pow(10,-a)/o,c=Math.round(e*u),l=Math.round(t*u),c/u<e&&++c,l/u>t&&--l,u=-u):(u=Math.pow(10,a)*o,c=Math.round(e/u),l=Math.round(t/u),c*u<e&&++c,l*u>t&&--l),l<c&&.5<=r&&r<2?bp(e,t,r*2):[c,l,u]}function b1(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,o]=n?bp(t,e,r):bp(e,t,r);if(!(i>=a))return[];const c=i-a+1,l=new Array(c);if(n)if(o<0)for(let u=0;u<c;++u)l[u]=(i-u)/-o;else for(let u=0;u<c;++u)l[u]=(i-u)*o;else if(o<0)for(let u=0;u<c;++u)l[u]=(a+u)/-o;else for(let u=0;u<c;++u)l[u]=(a+u)*o;return l}function w1(e,t,r){return t=+t,e=+e,r=+r,bp(e,t,r)[2]}function _1(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?w1(t,e,r):w1(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function RE(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function ME(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function EP(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?SP:cce(a);n>r;){if(n-r>600){const l=n-r+1,u=t-r+1,d=Math.log(l),f=.5*Math.exp(2*d/3),h=.5*Math.sqrt(d*f*(l-f)/l)*(u-l/2<0?-1:1),m=Math.max(r,Math.floor(t-u*f/l+h)),x=Math.min(n,Math.floor(t+(l-u)*f/l+h));EP(e,t,m,x,a)}const i=e[t];let o=r,c=n;for(Zu(e,r,t),a(e[n],i)>0&&Zu(e,r,n);o<c;){for(Zu(e,o,c),++o,--c;a(e[o],i)<0;)++o;for(;a(e[c],i)>0;)--c}a(e[r],i)===0?Zu(e,r,c):(++c,Zu(e,c,n)),c<=t&&(r=c+1),t<=c&&(n=c-1)}return e}function Zu(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function fce(e,t,r){if(e=Float64Array.from(nce(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return ME(e);if(t>=1)return RE(e);var n,a=(n-1)*t,i=Math.floor(a),o=RE(EP(e,i).subarray(0,i+1)),c=ME(e.subarray(i+1));return o+(c-o)*(a-i)}}function hce(e,t,r=DP){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),o=+r(e[i],i,e),c=+r(e[i+1],i+1,e);return o+(c-o)*(a-i)}}function mce(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function ci(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Is(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const j1=Symbol("implicit");function n_(){var e=new IE,t=[],r=[],n=j1;function a(i){let o=e.get(i);if(o===void 0){if(n!==j1)return n;e.set(i,o=t.push(i)-1)}return r[o%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new IE;for(const o of i)e.has(o)||e.set(o,t.push(o)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return n_(t,r).unknown(n)},ci.apply(a,arguments),a}function Jd(){var e=n_().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,o,c=!1,l=0,u=0,d=.5;delete e.unknown;function f(){var h=t().length,m=a<n,x=m?a:n,p=m?n:a;i=(p-x)/Math.max(1,h-l+u*2),c&&(i=Math.floor(i)),x+=(p-x-i*(h-l))*d,o=i*(1-l),c&&(x=Math.round(x),o=Math.round(o));var g=mce(h).map(function(v){return x+i*v});return r(m?g.reverse():g)}return e.domain=function(h){return arguments.length?(t(h),f()):t()},e.range=function(h){return arguments.length?([n,a]=h,n=+n,a=+a,f()):[n,a]},e.rangeRound=function(h){return[n,a]=h,n=+n,a=+a,c=!0,f()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(h){return arguments.length?(c=!!h,f()):c},e.padding=function(h){return arguments.length?(l=Math.min(1,u=+h),f()):l},e.paddingInner=function(h){return arguments.length?(l=Math.min(1,h),f()):l},e.paddingOuter=function(h){return arguments.length?(u=+h,f()):u},e.align=function(h){return arguments.length?(d=Math.max(0,Math.min(1,h)),f()):d},e.copy=function(){return Jd(t(),[n,a]).round(c).paddingInner(l).paddingOuter(u).align(d)},ci.apply(f(),arguments)}function TP(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return TP(t())},e}function Nd(){return TP(Jd.apply(null,arguments).paddingInner(1))}function a_(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function CP(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Nh(){}var Qd=.7,wp=1/Qd,ml="\\s*([+-]?\\d+)\\s*",ef="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",zi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",pce=/^#([0-9a-f]{3,8})$/,xce=new RegExp(`^rgb\\(${ml},${ml},${ml}\\)$`),gce=new RegExp(`^rgb\\(${zi},${zi},${zi}\\)$`),vce=new RegExp(`^rgba\\(${ml},${ml},${ml},${ef}\\)$`),yce=new RegExp(`^rgba\\(${zi},${zi},${zi},${ef}\\)$`),bce=new RegExp(`^hsl\\(${ef},${zi},${zi}\\)$`),wce=new RegExp(`^hsla\\(${ef},${zi},${zi},${ef}\\)$`),BE={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};a_(Nh,tf,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:LE,formatHex:LE,formatHex8:_ce,formatHsl:jce,formatRgb:$E,toString:$E});function LE(){return this.rgb().formatHex()}function _ce(){return this.rgb().formatHex8()}function jce(){return AP(this).formatHsl()}function $E(){return this.rgb().formatRgb()}function tf(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=pce.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?WE(t):r===3?new na(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?im(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?im(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=xce.exec(e))?new na(t[1],t[2],t[3],1):(t=gce.exec(e))?new na(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=vce.exec(e))?im(t[1],t[2],t[3],t[4]):(t=yce.exec(e))?im(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=bce.exec(e))?HE(t[1],t[2]/100,t[3]/100,1):(t=wce.exec(e))?HE(t[1],t[2]/100,t[3]/100,t[4]):BE.hasOwnProperty(e)?WE(BE[e]):e==="transparent"?new na(NaN,NaN,NaN,0):null}function WE(e){return new na(e>>16&255,e>>8&255,e&255,1)}function im(e,t,r,n){return n<=0&&(e=t=r=NaN),new na(e,t,r,n)}function Nce(e){return e instanceof Nh||(e=tf(e)),e?(e=e.rgb(),new na(e.r,e.g,e.b,e.opacity)):new na}function N1(e,t,r,n){return arguments.length===1?Nce(e):new na(e,t,r,n??1)}function na(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}a_(na,N1,CP(Nh,{brighter(e){return e=e==null?wp:Math.pow(wp,e),new na(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Qd:Math.pow(Qd,e),new na(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new na(nc(this.r),nc(this.g),nc(this.b),_p(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:zE,formatHex:zE,formatHex8:Dce,formatRgb:qE,toString:qE}));function zE(){return`#${Qo(this.r)}${Qo(this.g)}${Qo(this.b)}`}function Dce(){return`#${Qo(this.r)}${Qo(this.g)}${Qo(this.b)}${Qo((isNaN(this.opacity)?1:this.opacity)*255)}`}function qE(){const e=_p(this.opacity);return`${e===1?"rgb(":"rgba("}${nc(this.r)}, ${nc(this.g)}, ${nc(this.b)}${e===1?")":`, ${e})`}`}function _p(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function nc(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Qo(e){return e=nc(e),(e<16?"0":"")+e.toString(16)}function HE(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new pi(e,t,r,n)}function AP(e){if(e instanceof pi)return new pi(e.h,e.s,e.l,e.opacity);if(e instanceof Nh||(e=tf(e)),!e)return new pi;if(e instanceof pi)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),o=NaN,c=i-a,l=(i+a)/2;return c?(t===i?o=(r-n)/c+(r<n)*6:r===i?o=(n-t)/c+2:o=(t-r)/c+4,c/=l<.5?i+a:2-i-a,o*=60):c=l>0&&l<1?0:o,new pi(o,c,l,e.opacity)}function Sce(e,t,r,n){return arguments.length===1?AP(e):new pi(e,t,r,n??1)}function pi(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}a_(pi,Sce,CP(Nh,{brighter(e){return e=e==null?wp:Math.pow(wp,e),new pi(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Qd:Math.pow(Qd,e),new pi(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new na(Bv(e>=240?e-240:e+120,a,n),Bv(e,a,n),Bv(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new pi(VE(this.h),sm(this.s),sm(this.l),_p(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=_p(this.opacity);return`${e===1?"hsl(":"hsla("}${VE(this.h)}, ${sm(this.s)*100}%, ${sm(this.l)*100}%${e===1?")":`, ${e})`}`}}));function VE(e){return e=(e||0)%360,e<0?e+360:e}function sm(e){return Math.max(0,Math.min(1,e||0))}function Bv(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const i_=e=>()=>e;function Ece(e,t){return function(r){return e+r*t}}function Tce(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function Cce(e){return(e=+e)==1?kP:function(t,r){return r-t?Tce(t,r,e):i_(isNaN(t)?r:t)}}function kP(e,t){var r=t-e;return r?Ece(e,r):i_(isNaN(e)?t:e)}const GE=function e(t){var r=Cce(t);function n(a,i){var o=r((a=N1(a)).r,(i=N1(i)).r),c=r(a.g,i.g),l=r(a.b,i.b),u=kP(a.opacity,i.opacity);return function(d){return a.r=o(d),a.g=c(d),a.b=l(d),a.opacity=u(d),a+""}}return n.gamma=e,n}(1);function Ace(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function kce(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Fce(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),o;for(o=0;o<n;++o)a[o]=Du(e[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(c){for(o=0;o<n;++o)i[o]=a[o](c);return i}}function Oce(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function jp(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function Pce(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=Du(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var D1=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Lv=new RegExp(D1.source,"g");function Ice(e){return function(){return e}}function Uce(e){return function(t){return e(t)+""}}function Rce(e,t){var r=D1.lastIndex=Lv.lastIndex=0,n,a,i,o=-1,c=[],l=[];for(e=e+"",t=t+"";(n=D1.exec(e))&&(a=Lv.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),c[o]?c[o]+=i:c[++o]=i),(n=n[0])===(a=a[0])?c[o]?c[o]+=a:c[++o]=a:(c[++o]=null,l.push({i:o,x:jp(n,a)})),r=Lv.lastIndex;return r<t.length&&(i=t.slice(r),c[o]?c[o]+=i:c[++o]=i),c.length<2?l[0]?Uce(l[0].x):Ice(t):(t=l.length,function(u){for(var d=0,f;d<t;++d)c[(f=l[d]).i]=f.x(u);return c.join("")})}function Du(e,t){var r=typeof t,n;return t==null||r==="boolean"?i_(t):(r==="number"?jp:r==="string"?(n=tf(t))?(t=n,GE):Rce:t instanceof tf?GE:t instanceof Date?Oce:kce(t)?Ace:Array.isArray(t)?Fce:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Pce:jp)(e,t)}function s_(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function Mce(e,t){t===void 0&&(t=e,e=Du);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(o){var c=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return i[c](o-c)}}function Bce(e){return function(){return e}}function Np(e){return+e}var XE=[0,1];function Vn(e){return e}function S1(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:Bce(isNaN(t)?NaN:.5)}function Lce(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function $ce(e,t,r){var n=e[0],a=e[1],i=t[0],o=t[1];return a<n?(n=S1(a,n),i=r(o,i)):(n=S1(n,a),i=r(i,o)),function(c){return i(n(c))}}function Wce(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)a[o]=S1(e[o],e[o+1]),i[o]=r(t[o],t[o+1]);return function(c){var l=jh(e,c,1,n)-1;return i[l](a[l](c))}}function Dh(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function B0(){var e=XE,t=XE,r=Du,n,a,i,o=Vn,c,l,u;function d(){var h=Math.min(e.length,t.length);return o!==Vn&&(o=Lce(e[0],e[h-1])),c=h>2?Wce:$ce,l=u=null,f}function f(h){return h==null||isNaN(h=+h)?i:(l||(l=c(e.map(n),t,r)))(n(o(h)))}return f.invert=function(h){return o(a((u||(u=c(t,e.map(n),jp)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,Np),d()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),d()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),r=s_,d()},f.clamp=function(h){return arguments.length?(o=h?!0:Vn,d()):o!==Vn},f.interpolate=function(h){return arguments.length?(r=h,d()):r},f.unknown=function(h){return arguments.length?(i=h,f):i},function(h,m){return n=h,a=m,d()}}function o_(){return B0()(Vn,Vn)}function zce(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Dp(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function kl(e){return e=Dp(Math.abs(e)),e?e[1]:NaN}function qce(e,t){return function(r,n){for(var a=r.length,i=[],o=0,c=e[0],l=0;a>0&&c>0&&(l+c+1>n&&(c=Math.max(1,n-l)),i.push(r.substring(a-=c,a+c)),!((l+=c+1)>n));)c=e[o=(o+1)%e.length];return i.reverse().join(t)}}function Hce(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var Vce=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function rf(e){if(!(t=Vce.exec(e)))throw new Error("invalid format: "+e);var t;return new c_({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}rf.prototype=c_.prototype;function c_(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}c_.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Gce(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var FP;function Xce(e,t){var r=Dp(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(FP=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=n.length;return i===o?n:i>o?n+new Array(i-o+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+Dp(e,Math.max(0,t+i-1))[0]}function KE(e,t){var r=Dp(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const YE={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:zce,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>KE(e*100,t),r:KE,s:Xce,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function ZE(e){return e}var JE=Array.prototype.map,QE=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Kce(e){var t=e.grouping===void 0||e.thousands===void 0?ZE:qce(JE.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?ZE:Hce(JE.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",c=e.minus===void 0?"":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(f){f=rf(f);var h=f.fill,m=f.align,x=f.sign,p=f.symbol,g=f.zero,v=f.width,y=f.comma,b=f.precision,_=f.trim,w=f.type;w==="n"?(y=!0,w="g"):YE[w]||(b===void 0&&(b=12),_=!0,w="g"),(g||h==="0"&&m==="=")&&(g=!0,h="0",m="=");var j=p==="$"?r:p==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",N=p==="$"?n:/[%p]/.test(w)?o:"",D=YE[w],S=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function T(A){var E=j,M=N,P,X,q;if(w==="c")M=D(A)+M,A="";else{A=+A;var B=A<0||1/A<0;if(A=isNaN(A)?l:D(Math.abs(A),b),_&&(A=Gce(A)),B&&+A==0&&x!=="+"&&(B=!1),E=(B?x==="("?x:c:x==="-"||x==="("?"":x)+E,M=(w==="s"?QE[8+FP/3]:"")+M+(B&&x==="("?")":""),S){for(P=-1,X=A.length;++P<X;)if(q=A.charCodeAt(P),48>q||q>57){M=(q===46?a+A.slice(P+1):A.slice(P))+M,A=A.slice(0,P);break}}}y&&!g&&(A=t(A,1/0));var O=E.length+A.length+M.length,F=O<v?new Array(v-O+1).join(h):"";switch(y&&g&&(A=t(F+A,F.length?v-M.length:1/0),F=""),m){case"<":A=E+A+M+F;break;case"=":A=E+F+A+M;break;case"^":A=F.slice(0,O=F.length>>1)+E+A+M+F.slice(O);break;default:A=F+E+A+M;break}return i(A)}return T.toString=function(){return f+""},T}function d(f,h){var m=u((f=rf(f),f.type="f",f)),x=Math.max(-8,Math.min(8,Math.floor(kl(h)/3)))*3,p=Math.pow(10,-x),g=QE[8+x/3];return function(v){return m(p*v)+g}}return{format:u,formatPrefix:d}}var om,l_,OP;Yce({thousands:",",grouping:[3],currency:["$",""]});function Yce(e){return om=Kce(e),l_=om.format,OP=om.formatPrefix,om}function Zce(e){return Math.max(0,-kl(Math.abs(e)))}function Jce(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(kl(t)/3)))*3-kl(Math.abs(e)))}function Qce(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,kl(t)-kl(e))+1}function PP(e,t,r,n){var a=_1(e,t,r),i;switch(n=rf(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=Jce(a,o))&&(n.precision=i),OP(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=Qce(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=Zce(a))&&(n.precision=i-(n.type==="%")*2);break}}return l_(n)}function wo(e){var t=e.domain;return e.ticks=function(r){var n=t();return b1(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return PP(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,o=n[a],c=n[i],l,u,d=10;for(c<o&&(u=o,o=c,c=u,u=a,a=i,i=u);d-- >0;){if(u=w1(o,c,r),u===l)return n[a]=o,n[i]=c,t(n);if(u>0)o=Math.floor(o/u)*u,c=Math.ceil(c/u)*u;else if(u<0)o=Math.ceil(o*u)/u,c=Math.floor(c*u)/u;else break;l=u}return e},e}function Sp(){var e=o_();return e.copy=function(){return Dh(e,Sp())},ci.apply(e,arguments),wo(e)}function IP(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Np),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return IP(e).unknown(t)},e=arguments.length?Array.from(e,Np):[0,1],wo(r)}function UP(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],o;return i<a&&(o=r,r=n,n=o,o=a,a=i,i=o),e[r]=t.floor(a),e[n]=t.ceil(i),e}function eT(e){return Math.log(e)}function tT(e){return Math.exp(e)}function ele(e){return-Math.log(-e)}function tle(e){return-Math.exp(-e)}function rle(e){return isFinite(e)?+("1e"+e):e<0?0:e}function nle(e){return e===10?rle:e===Math.E?Math.exp:t=>Math.pow(e,t)}function ale(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function rT(e){return(t,r)=>-e(-t,r)}function u_(e){const t=e(eT,tT),r=t.domain;let n=10,a,i;function o(){return a=ale(n),i=nle(n),r()[0]<0?(a=rT(a),i=rT(i),e(ele,tle)):e(eT,tT),t}return t.base=function(c){return arguments.length?(n=+c,o()):n},t.domain=function(c){return arguments.length?(r(c),o()):r()},t.ticks=c=>{const l=r();let u=l[0],d=l[l.length-1];const f=d<u;f&&([u,d]=[d,u]);let h=a(u),m=a(d),x,p;const g=c==null?10:+c;let v=[];if(!(n%1)&&m-h<g){if(h=Math.floor(h),m=Math.ceil(m),u>0){for(;h<=m;++h)for(x=1;x<n;++x)if(p=h<0?x/i(-h):x*i(h),!(p<u)){if(p>d)break;v.push(p)}}else for(;h<=m;++h)for(x=n-1;x>=1;--x)if(p=h>0?x/i(-h):x*i(h),!(p<u)){if(p>d)break;v.push(p)}v.length*2<g&&(v=b1(u,d,g))}else v=b1(h,m,Math.min(m-h,g)).map(i);return f?v.reverse():v},t.tickFormat=(c,l)=>{if(c==null&&(c=10),l==null&&(l=n===10?"s":","),typeof l!="function"&&(!(n%1)&&(l=rf(l)).precision==null&&(l.trim=!0),l=l_(l)),c===1/0)return l;const u=Math.max(1,n*c/t.ticks().length);return d=>{let f=d/i(Math.round(a(d)));return f*n<n-.5&&(f*=n),f<=u?l(d):""}},t.nice=()=>r(UP(r(),{floor:c=>i(Math.floor(a(c))),ceil:c=>i(Math.ceil(a(c)))})),t}function RP(){const e=u_(B0()).domain([1,10]);return e.copy=()=>Dh(e,RP()).base(e.base()),ci.apply(e,arguments),e}function nT(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function aT(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function d_(e){var t=1,r=e(nT(t),aT(t));return r.constant=function(n){return arguments.length?e(nT(t=+n),aT(t)):t},wo(r)}function MP(){var e=d_(B0());return e.copy=function(){return Dh(e,MP()).constant(e.constant())},ci.apply(e,arguments)}function iT(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function ile(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function sle(e){return e<0?-e*e:e*e}function f_(e){var t=e(Vn,Vn),r=1;function n(){return r===1?e(Vn,Vn):r===.5?e(ile,sle):e(iT(r),iT(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},wo(t)}function h_(){var e=f_(B0());return e.copy=function(){return Dh(e,h_()).exponent(e.exponent())},ci.apply(e,arguments),e}function ole(){return h_.apply(null,arguments).exponent(.5)}function sT(e){return Math.sign(e)*e*e}function cle(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function BP(){var e=o_(),t=[0,1],r=!1,n;function a(i){var o=cle(e(i));return isNaN(o)?n:r?Math.round(o):o}return a.invert=function(i){return e.invert(sT(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,Np)).map(sT)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return BP(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},ci.apply(a,arguments),wo(a)}function LP(){var e=[],t=[],r=[],n;function a(){var o=0,c=Math.max(1,t.length);for(r=new Array(c-1);++o<c;)r[o-1]=hce(e,o/c);return i}function i(o){return o==null||isNaN(o=+o)?n:t[jh(r,o)]}return i.invertExtent=function(o){var c=t.indexOf(o);return c<0?[NaN,NaN]:[c>0?r[c-1]:e[0],c<r.length?r[c]:e[e.length-1]]},i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let c of o)c!=null&&!isNaN(c=+c)&&e.push(c);return e.sort(io),a()},i.range=function(o){return arguments.length?(t=Array.from(o),a()):t.slice()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return LP().domain(e).range(t).unknown(n)},ci.apply(i,arguments)}function $P(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function o(l){return l!=null&&l<=l?a[jh(n,l,0,r)]:i}function c(){var l=-1;for(n=new Array(r);++l<r;)n[l]=((l+1)*t-(l-r)*e)/(r+1);return o}return o.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,c()):[e,t]},o.range=function(l){return arguments.length?(r=(a=Array.from(l)).length-1,c()):a.slice()},o.invertExtent=function(l){var u=a.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},o.unknown=function(l){return arguments.length&&(i=l),o},o.thresholds=function(){return n.slice()},o.copy=function(){return $P().domain([e,t]).range(a).unknown(i)},ci.apply(wo(o),arguments)}function WP(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[jh(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var o=t.indexOf(i);return[e[o-1],e[o]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return WP().domain(e).range(t).unknown(r)},ci.apply(a,arguments)}const $v=new Date,Wv=new Date;function Xr(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const o=a(i),c=a.ceil(i);return i-o<c-i?o:c},a.offset=(i,o)=>(t(i=new Date(+i),o==null?1:Math.floor(o)),i),a.range=(i,o,c)=>{const l=[];if(i=a.ceil(i),c=c==null?1:Math.floor(c),!(i<o)||!(c>0))return l;let u;do l.push(u=new Date(+i)),t(i,c),e(i);while(u<i&&i<o);return l},a.filter=i=>Xr(o=>{if(o>=o)for(;e(o),!i(o);)o.setTime(o-1)},(o,c)=>{if(o>=o)if(c<0)for(;++c<=0;)for(;t(o,-1),!i(o););else for(;--c>=0;)for(;t(o,1),!i(o););}),r&&(a.count=(i,o)=>($v.setTime(+i),Wv.setTime(+o),e($v),e(Wv),Math.floor(r($v,Wv))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?o=>n(o)%i===0:o=>a.count(0,o)%i===0):a)),a}const Ep=Xr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Ep.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Xr(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Ep);Ep.range;const hs=1e3,Ja=hs*60,ms=Ja*60,Ds=ms*24,m_=Ds*7,oT=Ds*30,zv=Ds*365,ec=Xr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*hs)},(e,t)=>(t-e)/hs,e=>e.getUTCSeconds());ec.range;const p_=Xr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*hs)},(e,t)=>{e.setTime(+e+t*Ja)},(e,t)=>(t-e)/Ja,e=>e.getMinutes());p_.range;const x_=Xr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ja)},(e,t)=>(t-e)/Ja,e=>e.getUTCMinutes());x_.range;const g_=Xr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*hs-e.getMinutes()*Ja)},(e,t)=>{e.setTime(+e+t*ms)},(e,t)=>(t-e)/ms,e=>e.getHours());g_.range;const v_=Xr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*ms)},(e,t)=>(t-e)/ms,e=>e.getUTCHours());v_.range;const Sh=Xr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ja)/Ds,e=>e.getDate()-1);Sh.range;const L0=Xr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ds,e=>e.getUTCDate()-1);L0.range;const zP=Xr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ds,e=>Math.floor(e/Ds));zP.range;function Ec(e){return Xr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Ja)/m_)}const $0=Ec(0),Tp=Ec(1),lle=Ec(2),ule=Ec(3),Fl=Ec(4),dle=Ec(5),fle=Ec(6);$0.range;Tp.range;lle.range;ule.range;Fl.range;dle.range;fle.range;function Tc(e){return Xr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/m_)}const W0=Tc(0),Cp=Tc(1),hle=Tc(2),mle=Tc(3),Ol=Tc(4),ple=Tc(5),xle=Tc(6);W0.range;Cp.range;hle.range;mle.range;Ol.range;ple.range;xle.range;const y_=Xr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());y_.range;const b_=Xr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());b_.range;const Ss=Xr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Ss.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Xr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Ss.range;const Es=Xr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Es.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Xr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Es.range;function qP(e,t,r,n,a,i){const o=[[ec,1,hs],[ec,5,5*hs],[ec,15,15*hs],[ec,30,30*hs],[i,1,Ja],[i,5,5*Ja],[i,15,15*Ja],[i,30,30*Ja],[a,1,ms],[a,3,3*ms],[a,6,6*ms],[a,12,12*ms],[n,1,Ds],[n,2,2*Ds],[r,1,m_],[t,1,oT],[t,3,3*oT],[e,1,zv]];function c(u,d,f){const h=d<u;h&&([u,d]=[d,u]);const m=f&&typeof f.range=="function"?f:l(u,d,f),x=m?m.range(u,+d+1):[];return h?x.reverse():x}function l(u,d,f){const h=Math.abs(d-u)/f,m=r_(([,,g])=>g).right(o,h);if(m===o.length)return e.every(_1(u/zv,d/zv,f));if(m===0)return Ep.every(Math.max(_1(u,d,f),1));const[x,p]=o[h/o[m-1][2]<o[m][2]/h?m-1:m];return x.every(p)}return[c,l]}const[gle,vle]=qP(Es,b_,W0,zP,v_,x_),[yle,ble]=qP(Ss,y_,$0,Sh,g_,p_);function qv(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Hv(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Ju(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function wle(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,o=e.shortDays,c=e.months,l=e.shortMonths,u=Qu(a),d=ed(a),f=Qu(i),h=ed(i),m=Qu(o),x=ed(o),p=Qu(c),g=ed(c),v=Qu(l),y=ed(l),b={a:B,A:O,b:F,B:I,c:null,d:hT,e:hT,f:qle,g:eue,G:rue,H:$le,I:Wle,j:zle,L:HP,m:Hle,M:Vle,p:L,q:C,Q:xT,s:gT,S:Gle,u:Xle,U:Kle,V:Yle,w:Zle,W:Jle,x:null,X:null,y:Qle,Y:tue,Z:nue,"%":pT},_={a:k,A:z,b:V,B:Z,c:null,d:mT,e:mT,f:oue,g:gue,G:yue,H:aue,I:iue,j:sue,L:GP,m:cue,M:lue,p:ce,q:ie,Q:xT,s:gT,S:uue,u:due,U:fue,V:hue,w:mue,W:pue,x:null,X:null,y:xue,Y:vue,Z:bue,"%":pT},w={a:T,A,b:E,B:M,c:P,d:dT,e:dT,f:Rle,g:uT,G:lT,H:fT,I:fT,j:Ole,L:Ule,m:Fle,M:Ple,p:S,q:kle,Q:Ble,s:Lle,S:Ile,u:Sle,U:Ele,V:Tle,w:Dle,W:Cle,x:X,X:q,y:uT,Y:lT,Z:Ale,"%":Mle};b.x=j(r,b),b.X=j(n,b),b.c=j(t,b),_.x=j(r,_),_.X=j(n,_),_.c=j(t,_);function j(Q,ne){return function(pe){var W=[],re=-1,U=0,se=Q.length,te,K,H;for(pe instanceof Date||(pe=new Date(+pe));++re<se;)Q.charCodeAt(re)===37&&(W.push(Q.slice(U,re)),(K=cT[te=Q.charAt(++re)])!=null?te=Q.charAt(++re):K=te==="e"?" ":"0",(H=ne[te])&&(te=H(pe,K)),W.push(te),U=re+1);return W.push(Q.slice(U,re)),W.join("")}}function N(Q,ne){return function(pe){var W=Ju(1900,void 0,1),re=D(W,Q,pe+="",0),U,se;if(re!=pe.length)return null;if("Q"in W)return new Date(W.Q);if("s"in W)return new Date(W.s*1e3+("L"in W?W.L:0));if(ne&&!("Z"in W)&&(W.Z=0),"p"in W&&(W.H=W.H%12+W.p*12),W.m===void 0&&(W.m="q"in W?W.q:0),"V"in W){if(W.V<1||W.V>53)return null;"w"in W||(W.w=1),"Z"in W?(U=Hv(Ju(W.y,0,1)),se=U.getUTCDay(),U=se>4||se===0?Cp.ceil(U):Cp(U),U=L0.offset(U,(W.V-1)*7),W.y=U.getUTCFullYear(),W.m=U.getUTCMonth(),W.d=U.getUTCDate()+(W.w+6)%7):(U=qv(Ju(W.y,0,1)),se=U.getDay(),U=se>4||se===0?Tp.ceil(U):Tp(U),U=Sh.offset(U,(W.V-1)*7),W.y=U.getFullYear(),W.m=U.getMonth(),W.d=U.getDate()+(W.w+6)%7)}else("W"in W||"U"in W)&&("w"in W||(W.w="u"in W?W.u%7:"W"in W?1:0),se="Z"in W?Hv(Ju(W.y,0,1)).getUTCDay():qv(Ju(W.y,0,1)).getDay(),W.m=0,W.d="W"in W?(W.w+6)%7+W.W*7-(se+5)%7:W.w+W.U*7-(se+6)%7);return"Z"in W?(W.H+=W.Z/100|0,W.M+=W.Z%100,Hv(W)):qv(W)}}function D(Q,ne,pe,W){for(var re=0,U=ne.length,se=pe.length,te,K;re<U;){if(W>=se)return-1;if(te=ne.charCodeAt(re++),te===37){if(te=ne.charAt(re++),K=w[te in cT?ne.charAt(re++):te],!K||(W=K(Q,pe,W))<0)return-1}else if(te!=pe.charCodeAt(W++))return-1}return W}function S(Q,ne,pe){var W=u.exec(ne.slice(pe));return W?(Q.p=d.get(W[0].toLowerCase()),pe+W[0].length):-1}function T(Q,ne,pe){var W=m.exec(ne.slice(pe));return W?(Q.w=x.get(W[0].toLowerCase()),pe+W[0].length):-1}function A(Q,ne,pe){var W=f.exec(ne.slice(pe));return W?(Q.w=h.get(W[0].toLowerCase()),pe+W[0].length):-1}function E(Q,ne,pe){var W=v.exec(ne.slice(pe));return W?(Q.m=y.get(W[0].toLowerCase()),pe+W[0].length):-1}function M(Q,ne,pe){var W=p.exec(ne.slice(pe));return W?(Q.m=g.get(W[0].toLowerCase()),pe+W[0].length):-1}function P(Q,ne,pe){return D(Q,t,ne,pe)}function X(Q,ne,pe){return D(Q,r,ne,pe)}function q(Q,ne,pe){return D(Q,n,ne,pe)}function B(Q){return o[Q.getDay()]}function O(Q){return i[Q.getDay()]}function F(Q){return l[Q.getMonth()]}function I(Q){return c[Q.getMonth()]}function L(Q){return a[+(Q.getHours()>=12)]}function C(Q){return 1+~~(Q.getMonth()/3)}function k(Q){return o[Q.getUTCDay()]}function z(Q){return i[Q.getUTCDay()]}function V(Q){return l[Q.getUTCMonth()]}function Z(Q){return c[Q.getUTCMonth()]}function ce(Q){return a[+(Q.getUTCHours()>=12)]}function ie(Q){return 1+~~(Q.getUTCMonth()/3)}return{format:function(Q){var ne=j(Q+="",b);return ne.toString=function(){return Q},ne},parse:function(Q){var ne=N(Q+="",!1);return ne.toString=function(){return Q},ne},utcFormat:function(Q){var ne=j(Q+="",_);return ne.toString=function(){return Q},ne},utcParse:function(Q){var ne=N(Q+="",!0);return ne.toString=function(){return Q},ne}}}var cT={"-":"",_:" ",0:"0"},on=/^\s*\d+/,_le=/^%/,jle=/[\\^$*+?|[\]().{}]/g;function Ut(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function Nle(e){return e.replace(jle,"\\$&")}function Qu(e){return new RegExp("^(?:"+e.map(Nle).join("|")+")","i")}function ed(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function Dle(e,t,r){var n=on.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function Sle(e,t,r){var n=on.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function Ele(e,t,r){var n=on.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function Tle(e,t,r){var n=on.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function Cle(e,t,r){var n=on.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function lT(e,t,r){var n=on.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function uT(e,t,r){var n=on.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function Ale(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function kle(e,t,r){var n=on.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function Fle(e,t,r){var n=on.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function dT(e,t,r){var n=on.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function Ole(e,t,r){var n=on.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function fT(e,t,r){var n=on.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function Ple(e,t,r){var n=on.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function Ile(e,t,r){var n=on.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function Ule(e,t,r){var n=on.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function Rle(e,t,r){var n=on.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function Mle(e,t,r){var n=_le.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function Ble(e,t,r){var n=on.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function Lle(e,t,r){var n=on.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function hT(e,t){return Ut(e.getDate(),t,2)}function $le(e,t){return Ut(e.getHours(),t,2)}function Wle(e,t){return Ut(e.getHours()%12||12,t,2)}function zle(e,t){return Ut(1+Sh.count(Ss(e),e),t,3)}function HP(e,t){return Ut(e.getMilliseconds(),t,3)}function qle(e,t){return HP(e,t)+"000"}function Hle(e,t){return Ut(e.getMonth()+1,t,2)}function Vle(e,t){return Ut(e.getMinutes(),t,2)}function Gle(e,t){return Ut(e.getSeconds(),t,2)}function Xle(e){var t=e.getDay();return t===0?7:t}function Kle(e,t){return Ut($0.count(Ss(e)-1,e),t,2)}function VP(e){var t=e.getDay();return t>=4||t===0?Fl(e):Fl.ceil(e)}function Yle(e,t){return e=VP(e),Ut(Fl.count(Ss(e),e)+(Ss(e).getDay()===4),t,2)}function Zle(e){return e.getDay()}function Jle(e,t){return Ut(Tp.count(Ss(e)-1,e),t,2)}function Qle(e,t){return Ut(e.getFullYear()%100,t,2)}function eue(e,t){return e=VP(e),Ut(e.getFullYear()%100,t,2)}function tue(e,t){return Ut(e.getFullYear()%1e4,t,4)}function rue(e,t){var r=e.getDay();return e=r>=4||r===0?Fl(e):Fl.ceil(e),Ut(e.getFullYear()%1e4,t,4)}function nue(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ut(t/60|0,"0",2)+Ut(t%60,"0",2)}function mT(e,t){return Ut(e.getUTCDate(),t,2)}function aue(e,t){return Ut(e.getUTCHours(),t,2)}function iue(e,t){return Ut(e.getUTCHours()%12||12,t,2)}function sue(e,t){return Ut(1+L0.count(Es(e),e),t,3)}function GP(e,t){return Ut(e.getUTCMilliseconds(),t,3)}function oue(e,t){return GP(e,t)+"000"}function cue(e,t){return Ut(e.getUTCMonth()+1,t,2)}function lue(e,t){return Ut(e.getUTCMinutes(),t,2)}function uue(e,t){return Ut(e.getUTCSeconds(),t,2)}function due(e){var t=e.getUTCDay();return t===0?7:t}function fue(e,t){return Ut(W0.count(Es(e)-1,e),t,2)}function XP(e){var t=e.getUTCDay();return t>=4||t===0?Ol(e):Ol.ceil(e)}function hue(e,t){return e=XP(e),Ut(Ol.count(Es(e),e)+(Es(e).getUTCDay()===4),t,2)}function mue(e){return e.getUTCDay()}function pue(e,t){return Ut(Cp.count(Es(e)-1,e),t,2)}function xue(e,t){return Ut(e.getUTCFullYear()%100,t,2)}function gue(e,t){return e=XP(e),Ut(e.getUTCFullYear()%100,t,2)}function vue(e,t){return Ut(e.getUTCFullYear()%1e4,t,4)}function yue(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Ol(e):Ol.ceil(e),Ut(e.getUTCFullYear()%1e4,t,4)}function bue(){return"+0000"}function pT(){return"%"}function xT(e){return+e}function gT(e){return Math.floor(+e/1e3)}var Wc,KP,YP;wue({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function wue(e){return Wc=wle(e),KP=Wc.format,Wc.parse,YP=Wc.utcFormat,Wc.utcParse,Wc}function _ue(e){return new Date(e)}function jue(e){return e instanceof Date?+e:+new Date(+e)}function w_(e,t,r,n,a,i,o,c,l,u){var d=o_(),f=d.invert,h=d.domain,m=u(".%L"),x=u(":%S"),p=u("%I:%M"),g=u("%I %p"),v=u("%a %d"),y=u("%b %d"),b=u("%B"),_=u("%Y");function w(j){return(l(j)<j?m:c(j)<j?x:o(j)<j?p:i(j)<j?g:n(j)<j?a(j)<j?v:y:r(j)<j?b:_)(j)}return d.invert=function(j){return new Date(f(j))},d.domain=function(j){return arguments.length?h(Array.from(j,jue)):h().map(_ue)},d.ticks=function(j){var N=h();return e(N[0],N[N.length-1],j??10)},d.tickFormat=function(j,N){return N==null?w:u(N)},d.nice=function(j){var N=h();return(!j||typeof j.range!="function")&&(j=t(N[0],N[N.length-1],j??10)),j?h(UP(N,j)):d},d.copy=function(){return Dh(d,w_(e,t,r,n,a,i,o,c,l,u))},d}function Nue(){return ci.apply(w_(yle,ble,Ss,y_,$0,Sh,g_,p_,ec,KP).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Due(){return ci.apply(w_(gle,vle,Es,b_,W0,L0,v_,x_,ec,YP).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function z0(){var e=0,t=1,r,n,a,i,o=Vn,c=!1,l;function u(f){return f==null||isNaN(f=+f)?l:o(a===0?.5:(f=(i(f)-r)*a,c?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(f){return arguments.length?(c=!!f,u):c},u.interpolator=function(f){return arguments.length?(o=f,u):o};function d(f){return function(h){var m,x;return arguments.length?([m,x]=h,o=f(m,x),u):[o(0),o(1)]}}return u.range=d(Du),u.rangeRound=d(s_),u.unknown=function(f){return arguments.length?(l=f,u):l},function(f){return i=f,r=f(e),n=f(t),a=r===n?0:1/(n-r),u}}function _o(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function ZP(){var e=wo(z0()(Vn));return e.copy=function(){return _o(e,ZP())},Is.apply(e,arguments)}function JP(){var e=u_(z0()).domain([1,10]);return e.copy=function(){return _o(e,JP()).base(e.base())},Is.apply(e,arguments)}function QP(){var e=d_(z0());return e.copy=function(){return _o(e,QP()).constant(e.constant())},Is.apply(e,arguments)}function __(){var e=f_(z0());return e.copy=function(){return _o(e,__()).exponent(e.exponent())},Is.apply(e,arguments)}function Sue(){return __.apply(null,arguments).exponent(.5)}function e6(){var e=[],t=Vn;function r(n){if(n!=null&&!isNaN(n=+n))return t((jh(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(io),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>fce(e,i/n))},r.copy=function(){return e6(t).domain(e)},Is.apply(r,arguments)}function q0(){var e=0,t=.5,r=1,n=1,a,i,o,c,l,u=Vn,d,f=!1,h;function m(p){return isNaN(p=+p)?h:(p=.5+((p=+d(p))-i)*(n*p<n*i?c:l),u(f?Math.max(0,Math.min(1,p)):p))}m.domain=function(p){return arguments.length?([e,t,r]=p,a=d(e=+e),i=d(t=+t),o=d(r=+r),c=a===i?0:.5/(i-a),l=i===o?0:.5/(o-i),n=i<a?-1:1,m):[e,t,r]},m.clamp=function(p){return arguments.length?(f=!!p,m):f},m.interpolator=function(p){return arguments.length?(u=p,m):u};function x(p){return function(g){var v,y,b;return arguments.length?([v,y,b]=g,u=Mce(p,[v,y,b]),m):[u(0),u(.5),u(1)]}}return m.range=x(Du),m.rangeRound=x(s_),m.unknown=function(p){return arguments.length?(h=p,m):h},function(p){return d=p,a=p(e),i=p(t),o=p(r),c=a===i?0:.5/(i-a),l=i===o?0:.5/(o-i),n=i<a?-1:1,m}}function t6(){var e=wo(q0()(Vn));return e.copy=function(){return _o(e,t6())},Is.apply(e,arguments)}function r6(){var e=u_(q0()).domain([.1,1,10]);return e.copy=function(){return _o(e,r6()).base(e.base())},Is.apply(e,arguments)}function n6(){var e=d_(q0());return e.copy=function(){return _o(e,n6()).constant(e.constant())},Is.apply(e,arguments)}function j_(){var e=f_(q0());return e.copy=function(){return _o(e,j_()).exponent(e.exponent())},Is.apply(e,arguments)}function Eue(){return j_.apply(null,arguments).exponent(.5)}const vT=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Jd,scaleDiverging:t6,scaleDivergingLog:r6,scaleDivergingPow:j_,scaleDivergingSqrt:Eue,scaleDivergingSymlog:n6,scaleIdentity:IP,scaleImplicit:j1,scaleLinear:Sp,scaleLog:RP,scaleOrdinal:n_,scalePoint:Nd,scalePow:h_,scaleQuantile:LP,scaleQuantize:$P,scaleRadial:BP,scaleSequential:ZP,scaleSequentialLog:JP,scaleSequentialPow:__,scaleSequentialQuantile:e6,scaleSequentialSqrt:Sue,scaleSequentialSymlog:QP,scaleSqrt:ole,scaleSymlog:MP,scaleThreshold:WP,scaleTime:Nue,scaleUtc:Due,tickFormat:PP},Symbol.toStringTag,{value:"Module"}));var Tue=mu;function Cue(e,t,r){for(var n=-1,a=e.length;++n<a;){var i=e[n],o=t(i);if(o!=null&&(c===void 0?o===o&&!Tue(o):r(o,c)))var c=o,l=i}return l}var H0=Cue;function Aue(e,t){return e>t}var a6=Aue,kue=H0,Fue=a6,Oue=Nu;function Pue(e){return e&&e.length?kue(e,Oue,Fue):void 0}var Iue=Pue;const V0=Rt(Iue);function Uue(e,t){return e<t}var i6=Uue,Rue=H0,Mue=i6,Bue=Nu;function Lue(e){return e&&e.length?Rue(e,Bue,Mue):void 0}var $ue=Lue;const G0=Rt($ue);var Wue=v0,zue=Ji,que=dP,Hue=Kn;function Vue(e,t){var r=Hue(e)?Wue:que;return r(e,zue(t))}var Gue=Vue,Xue=Jw,Kue=Gue;function Yue(e,t){return Xue(Kue(e,t),1)}var Zue=Yue;const Jue=Rt(Zue);var Que=Zw;function ede(e,t){return Que(e,t)}var tde=ede;const Su=Rt(tde);var Eu=1e9,rde={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},D_,mr=!0,ii="[DecimalError] ",ac=ii+"Invalid argument: ",N_=ii+"Exponent out of range: ",Tu=Math.floor,Vo=Math.pow,nde=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ba,Kr=1e7,or=7,s6=9007199254740991,Ap=Tu(s6/or),Xe={};Xe.absoluteValue=Xe.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Xe.comparedTo=Xe.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};Xe.decimalPlaces=Xe.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*or;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Xe.dividedBy=Xe.div=function(e){return vs(this,new this.constructor(e))};Xe.dividedToIntegerBy=Xe.idiv=function(e){var t=this,r=t.constructor;return Yt(vs(t,new r(e),0,1),r.precision)};Xe.equals=Xe.eq=function(e){return!this.cmp(e)};Xe.exponent=function(){return Mr(this)};Xe.greaterThan=Xe.gt=function(e){return this.cmp(e)>0};Xe.greaterThanOrEqualTo=Xe.gte=function(e){return this.cmp(e)>=0};Xe.isInteger=Xe.isint=function(){return this.e>this.d.length-2};Xe.isNegative=Xe.isneg=function(){return this.s<0};Xe.isPositive=Xe.ispos=function(){return this.s>0};Xe.isZero=function(){return this.s===0};Xe.lessThan=Xe.lt=function(e){return this.cmp(e)<0};Xe.lessThanOrEqualTo=Xe.lte=function(e){return this.cmp(e)<1};Xe.logarithm=Xe.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(ba))throw Error(ii+"NaN");if(r.s<1)throw Error(ii+(r.s?"NaN":"-Infinity"));return r.eq(ba)?new n(0):(mr=!1,t=vs(nf(r,i),nf(e,i),i),mr=!0,Yt(t,a))};Xe.minus=Xe.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?l6(t,e):o6(t,(e.s=-e.s,e))};Xe.modulo=Xe.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(ii+"NaN");return r.s?(mr=!1,t=vs(r,e,0,1).times(e),mr=!0,r.minus(t)):Yt(new n(r),a)};Xe.naturalExponential=Xe.exp=function(){return c6(this)};Xe.naturalLogarithm=Xe.ln=function(){return nf(this)};Xe.negated=Xe.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Xe.plus=Xe.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?o6(t,e):l6(t,(e.s=-e.s,e))};Xe.precision=Xe.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(ac+e);if(t=Mr(a)+1,n=a.d.length-1,r=n*or+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Xe.squareRoot=Xe.sqrt=function(){var e,t,r,n,a,i,o,c=this,l=c.constructor;if(c.s<1){if(!c.s)return new l(0);throw Error(ii+"NaN")}for(e=Mr(c),mr=!1,a=Math.sqrt(+c),a==0||a==1/0?(t=$i(c.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=Tu((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new l(t)):n=new l(a.toString()),r=l.precision,a=o=r+3;;)if(i=n,n=i.plus(vs(c,i,o+2)).times(.5),$i(i.d).slice(0,o)===(t=$i(n.d)).slice(0,o)){if(t=t.slice(o-3,o+1),a==o&&t=="4999"){if(Yt(i,r+1,0),i.times(i).eq(c)){n=i;break}}else if(t!="9999")break;o+=4}return mr=!0,Yt(n,r)};Xe.times=Xe.mul=function(e){var t,r,n,a,i,o,c,l,u,d=this,f=d.constructor,h=d.d,m=(e=new f(e)).d;if(!d.s||!e.s)return new f(0);for(e.s*=d.s,r=d.e+e.e,l=h.length,u=m.length,l<u&&(i=h,h=m,m=i,o=l,l=u,u=o),i=[],o=l+u,n=o;n--;)i.push(0);for(n=u;--n>=0;){for(t=0,a=l+n;a>n;)c=i[a]+m[n]*h[a-n-1]+t,i[a--]=c%Kr|0,t=c/Kr|0;i[a]=(i[a]+t)%Kr|0}for(;!i[--o];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,mr?Yt(e,f.precision):e};Xe.toDecimalPlaces=Xe.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Xi(e,0,Eu),t===void 0?t=n.rounding:Xi(t,0,8),Yt(r,e+Mr(r)+1,t))};Xe.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=hc(n,!0):(Xi(e,0,Eu),t===void 0?t=a.rounding:Xi(t,0,8),n=Yt(new a(n),e+1,t),r=hc(n,!0,e+1)),r};Xe.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?hc(a):(Xi(e,0,Eu),t===void 0?t=i.rounding:Xi(t,0,8),n=Yt(new i(a),e+Mr(a)+1,t),r=hc(n.abs(),!1,e+Mr(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};Xe.toInteger=Xe.toint=function(){var e=this,t=e.constructor;return Yt(new t(e),Mr(e)+1,t.rounding)};Xe.toNumber=function(){return+this};Xe.toPower=Xe.pow=function(e){var t,r,n,a,i,o,c=this,l=c.constructor,u=12,d=+(e=new l(e));if(!e.s)return new l(ba);if(c=new l(c),!c.s){if(e.s<1)throw Error(ii+"Infinity");return c}if(c.eq(ba))return c;if(n=l.precision,e.eq(ba))return Yt(c,n);if(t=e.e,r=e.d.length-1,o=t>=r,i=c.s,o){if((r=d<0?-d:d)<=s6){for(a=new l(ba),t=Math.ceil(n/or+4),mr=!1;r%2&&(a=a.times(c),bT(a.d,t)),r=Tu(r/2),r!==0;)c=c.times(c),bT(c.d,t);return mr=!0,e.s<0?new l(ba).div(a):Yt(a,n)}}else if(i<0)throw Error(ii+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,c.s=1,mr=!1,a=e.times(nf(c,n+u)),mr=!0,a=c6(a),a.s=i,a};Xe.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=Mr(a),n=hc(a,r<=i.toExpNeg||r>=i.toExpPos)):(Xi(e,1,Eu),t===void 0?t=i.rounding:Xi(t,0,8),a=Yt(new i(a),e,t),r=Mr(a),n=hc(a,e<=r||r<=i.toExpNeg,e)),n};Xe.toSignificantDigits=Xe.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Xi(e,1,Eu),t===void 0?t=n.rounding:Xi(t,0,8)),Yt(new n(r),e,t)};Xe.toString=Xe.valueOf=Xe.val=Xe.toJSON=Xe[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Mr(e),r=e.constructor;return hc(e,t<=r.toExpNeg||t>=r.toExpPos)};function o6(e,t){var r,n,a,i,o,c,l,u,d=e.constructor,f=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),mr?Yt(t,f):t;if(l=e.d,u=t.d,o=e.e,a=t.e,l=l.slice(),i=o-a,i){for(i<0?(n=l,i=-i,c=u.length):(n=u,a=o,c=l.length),o=Math.ceil(f/or),c=o>c?o+1:c+1,i>c&&(i=c,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(c=l.length,i=u.length,c-i<0&&(i=c,n=u,u=l,l=n),r=0;i;)r=(l[--i]=l[i]+u[i]+r)/Kr|0,l[i]%=Kr;for(r&&(l.unshift(r),++a),c=l.length;l[--c]==0;)l.pop();return t.d=l,t.e=a,mr?Yt(t,f):t}function Xi(e,t,r){if(e!==~~e||e<t||e>r)throw Error(ac+e)}function $i(e){var t,r,n,a=e.length-1,i="",o=e[0];if(a>0){for(i+=o,t=1;t<a;t++)n=e[t]+"",r=or-n.length,r&&(i+=Vs(r)),i+=n;o=e[t],n=o+"",r=or-n.length,r&&(i+=Vs(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var vs=function(){function e(n,a){var i,o=0,c=n.length;for(n=n.slice();c--;)i=n[c]*a+o,n[c]=i%Kr|0,o=i/Kr|0;return o&&n.unshift(o),n}function t(n,a,i,o){var c,l;if(i!=o)l=i>o?1:-1;else for(c=l=0;c<i;c++)if(n[c]!=a[c]){l=n[c]>a[c]?1:-1;break}return l}function r(n,a,i){for(var o=0;i--;)n[i]-=o,o=n[i]<a[i]?1:0,n[i]=o*Kr+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,o){var c,l,u,d,f,h,m,x,p,g,v,y,b,_,w,j,N,D,S=n.constructor,T=n.s==a.s?1:-1,A=n.d,E=a.d;if(!n.s)return new S(n);if(!a.s)throw Error(ii+"Division by zero");for(l=n.e-a.e,N=E.length,w=A.length,m=new S(T),x=m.d=[],u=0;E[u]==(A[u]||0);)++u;if(E[u]>(A[u]||0)&&--l,i==null?y=i=S.precision:o?y=i+(Mr(n)-Mr(a))+1:y=i,y<0)return new S(0);if(y=y/or+2|0,u=0,N==1)for(d=0,E=E[0],y++;(u<w||d)&&y--;u++)b=d*Kr+(A[u]||0),x[u]=b/E|0,d=b%E|0;else{for(d=Kr/(E[0]+1)|0,d>1&&(E=e(E,d),A=e(A,d),N=E.length,w=A.length),_=N,p=A.slice(0,N),g=p.length;g<N;)p[g++]=0;D=E.slice(),D.unshift(0),j=E[0],E[1]>=Kr/2&&++j;do d=0,c=t(E,p,N,g),c<0?(v=p[0],N!=g&&(v=v*Kr+(p[1]||0)),d=v/j|0,d>1?(d>=Kr&&(d=Kr-1),f=e(E,d),h=f.length,g=p.length,c=t(f,p,h,g),c==1&&(d--,r(f,N<h?D:E,h))):(d==0&&(c=d=1),f=E.slice()),h=f.length,h<g&&f.unshift(0),r(p,f,g),c==-1&&(g=p.length,c=t(E,p,N,g),c<1&&(d++,r(p,N<g?D:E,g))),g=p.length):c===0&&(d++,p=[0]),x[u++]=d,c&&p[0]?p[g++]=A[_]||0:(p=[A[_]],g=1);while((_++<w||p[0]!==void 0)&&y--)}return x[0]||x.shift(),m.e=l,Yt(m,o?i+Mr(m)+1:i)}}();function c6(e,t){var r,n,a,i,o,c,l=0,u=0,d=e.constructor,f=d.precision;if(Mr(e)>16)throw Error(N_+Mr(e));if(!e.s)return new d(ba);for(mr=!1,c=f,o=new d(.03125);e.abs().gte(.1);)e=e.times(o),u+=5;for(n=Math.log(Vo(2,u))/Math.LN10*2+5|0,c+=n,r=a=i=new d(ba),d.precision=c;;){if(a=Yt(a.times(e),c),r=r.times(++l),o=i.plus(vs(a,r,c)),$i(o.d).slice(0,c)===$i(i.d).slice(0,c)){for(;u--;)i=Yt(i.times(i),c);return d.precision=f,t==null?(mr=!0,Yt(i,f)):i}i=o}}function Mr(e){for(var t=e.e*or,r=e.d[0];r>=10;r/=10)t++;return t}function Vv(e,t,r){if(t>e.LN10.sd())throw mr=!0,r&&(e.precision=r),Error(ii+"LN10 precision limit exceeded");return Yt(new e(e.LN10),t)}function Vs(e){for(var t="";e--;)t+="0";return t}function nf(e,t){var r,n,a,i,o,c,l,u,d,f=1,h=10,m=e,x=m.d,p=m.constructor,g=p.precision;if(m.s<1)throw Error(ii+(m.s?"NaN":"-Infinity"));if(m.eq(ba))return new p(0);if(t==null?(mr=!1,u=g):u=t,m.eq(10))return t==null&&(mr=!0),Vv(p,u);if(u+=h,p.precision=u,r=$i(x),n=r.charAt(0),i=Mr(m),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)m=m.times(e),r=$i(m.d),n=r.charAt(0),f++;i=Mr(m),n>1?(m=new p("0."+r),i++):m=new p(n+"."+r.slice(1))}else return l=Vv(p,u+2,g).times(i+""),m=nf(new p(n+"."+r.slice(1)),u-h).plus(l),p.precision=g,t==null?(mr=!0,Yt(m,g)):m;for(c=o=m=vs(m.minus(ba),m.plus(ba),u),d=Yt(m.times(m),u),a=3;;){if(o=Yt(o.times(d),u),l=c.plus(vs(o,new p(a),u)),$i(l.d).slice(0,u)===$i(c.d).slice(0,u))return c=c.times(2),i!==0&&(c=c.plus(Vv(p,u+2,g).times(i+""))),c=vs(c,new p(f),u),p.precision=g,t==null?(mr=!0,Yt(c,g)):c;c=l,a+=2}}function yT(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=Tu(r/or),e.d=[],n=(r+1)%or,r<0&&(n+=or),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=or;n<a;)e.d.push(+t.slice(n,n+=or));t=t.slice(n),n=or-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),mr&&(e.e>Ap||e.e<-Ap))throw Error(N_+r)}else e.s=0,e.e=0,e.d=[0];return e}function Yt(e,t,r){var n,a,i,o,c,l,u,d,f=e.d;for(o=1,i=f[0];i>=10;i/=10)o++;if(n=t-o,n<0)n+=or,a=t,u=f[d=0];else{if(d=Math.ceil((n+1)/or),i=f.length,d>=i)return e;for(u=i=f[d],o=1;i>=10;i/=10)o++;n%=or,a=n-or+o}if(r!==void 0&&(i=Vo(10,o-a-1),c=u/i%10|0,l=t<0||f[d+1]!==void 0||u%i,l=r<4?(c||l)&&(r==0||r==(e.s<0?3:2)):c>5||c==5&&(r==4||l||r==6&&(n>0?a>0?u/Vo(10,o-a):0:f[d-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return l?(i=Mr(e),f.length=1,t=t-i-1,f[0]=Vo(10,(or-t%or)%or),e.e=Tu(-t/or)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=d,i=1,d--):(f.length=d+1,i=Vo(10,or-n),f[d]=a>0?(u/Vo(10,o-a)%Vo(10,a)|0)*i:0),l)for(;;)if(d==0){(f[0]+=i)==Kr&&(f[0]=1,++e.e);break}else{if(f[d]+=i,f[d]!=Kr)break;f[d--]=0,i=1}for(n=f.length;f[--n]===0;)f.pop();if(mr&&(e.e>Ap||e.e<-Ap))throw Error(N_+Mr(e));return e}function l6(e,t){var r,n,a,i,o,c,l,u,d,f,h=e.constructor,m=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),mr?Yt(t,m):t;if(l=e.d,f=t.d,n=t.e,u=e.e,l=l.slice(),o=u-n,o){for(d=o<0,d?(r=l,o=-o,c=f.length):(r=f,n=u,c=l.length),a=Math.max(Math.ceil(m/or),c)+2,o>a&&(o=a,r.length=1),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else{for(a=l.length,c=f.length,d=a<c,d&&(c=a),a=0;a<c;a++)if(l[a]!=f[a]){d=l[a]<f[a];break}o=0}for(d&&(r=l,l=f,f=r,t.s=-t.s),c=l.length,a=f.length-c;a>0;--a)l[c++]=0;for(a=f.length;a>o;){if(l[--a]<f[a]){for(i=a;i&&l[--i]===0;)l[i]=Kr-1;--l[i],l[a]+=Kr}l[a]-=f[a]}for(;l[--c]===0;)l.pop();for(;l[0]===0;l.shift())--n;return l[0]?(t.d=l,t.e=n,mr?Yt(t,m):t):new h(0)}function hc(e,t,r){var n,a=Mr(e),i=$i(e.d),o=i.length;return t?(r&&(n=r-o)>0?i=i.charAt(0)+"."+i.slice(1)+Vs(n):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+Vs(-a-1)+i,r&&(n=r-o)>0&&(i+=Vs(n))):a>=o?(i+=Vs(a+1-o),r&&(n=r-a-1)>0&&(i=i+"."+Vs(n))):((n=a+1)<o&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-o)>0&&(a+1===o&&(i+="."),i+=Vs(n))),e.s<0?"-"+i:i}function bT(e,t){if(e.length>t)return e.length=t,!0}function u6(e){var t,r,n;function a(i){var o=this;if(!(o instanceof a))return new a(i);if(o.constructor=a,i instanceof a){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(ac+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return yT(o,i.toString())}else if(typeof i!="string")throw Error(ac+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,nde.test(i))yT(o,i);else throw Error(ac+i)}if(a.prototype=Xe,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=u6,a.config=a.set=ade,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function ade(e){if(!e||typeof e!="object")throw Error(ii+"Object expected");var t,r,n,a=["precision",1,Eu,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(Tu(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(ac+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(ac+r+": "+n);return this}var D_=u6(rde);ba=new D_(1);const Xt=D_;function ide(e){return lde(e)||cde(e)||ode(e)||sde()}function sde(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ode(e,t){if(e){if(typeof e=="string")return E1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return E1(e,t)}}function cde(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function lde(e){if(Array.isArray(e))return E1(e)}function E1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ude=function(t){return t},d6={},f6=function(t){return t===d6},wT=function(t){return function r(){return arguments.length===0||arguments.length===1&&f6(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},dde=function e(t,r){return t===1?r:wT(function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var o=a.filter(function(c){return c!==d6}).length;return o>=t?r.apply(void 0,a):e(t-o,wT(function(){for(var c=arguments.length,l=new Array(c),u=0;u<c;u++)l[u]=arguments[u];var d=a.map(function(f){return f6(f)?l.shift():f});return r.apply(void 0,ide(d).concat(l))}))})},X0=function(t){return dde(t.length,t)},T1=function(t,r){for(var n=[],a=t;a<r;++a)n[a-t]=a;return n},fde=X0(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),hde=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return ude;var a=r.reverse(),i=a[0],o=a.slice(1);return function(){return o.reduce(function(c,l){return l(c)},i.apply(void 0,arguments))}},C1=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},h6=function(t){var r=null,n=null;return function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return r&&i.every(function(c,l){return c===r[l]})||(r=i,n=t.apply(void 0,i)),n}};function mde(e){var t;return e===0?t=1:t=Math.floor(new Xt(e).abs().log(10).toNumber())+1,t}function pde(e,t,r){for(var n=new Xt(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}var xde=X0(function(e,t,r){var n=+e,a=+t;return n+r*(a-n)}),gde=X0(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),vde=X0(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const K0={rangeStep:pde,getDigitCount:mde,interpolateNumber:xde,uninterpolateNumber:gde,uninterpolateTruncation:vde};function A1(e){return wde(e)||bde(e)||m6(e)||yde()}function yde(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bde(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function wde(e){if(Array.isArray(e))return k1(e)}function af(e,t){return Nde(e)||jde(e,t)||m6(e,t)||_de()}function _de(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function m6(e,t){if(e){if(typeof e=="string")return k1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k1(e,t)}}function k1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jde(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,a=!1,i=void 0;try{for(var o=e[Symbol.iterator](),c;!(n=(c=o.next()).done)&&(r.push(c.value),!(t&&r.length===t));n=!0);}catch(l){a=!0,i=l}finally{try{!n&&o.return!=null&&o.return()}finally{if(a)throw i}}return r}}function Nde(e){if(Array.isArray(e))return e}function p6(e){var t=af(e,2),r=t[0],n=t[1],a=r,i=n;return r>n&&(a=n,i=r),[a,i]}function x6(e,t,r){if(e.lte(0))return new Xt(0);var n=K0.getDigitCount(e.toNumber()),a=new Xt(10).pow(n),i=e.div(a),o=n!==1?.05:.1,c=new Xt(Math.ceil(i.div(o).toNumber())).add(r).mul(o),l=c.mul(a);return t?l:new Xt(Math.ceil(l))}function Dde(e,t,r){var n=1,a=new Xt(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new Xt(10).pow(K0.getDigitCount(e)-1),a=new Xt(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new Xt(Math.floor(e)))}else e===0?a=new Xt(Math.floor((t-1)/2)):r||(a=new Xt(Math.floor(e)));var o=Math.floor((t-1)/2),c=hde(fde(function(l){return a.add(new Xt(l-o).mul(n)).toNumber()}),T1);return c(0,t)}function g6(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new Xt(0),tickMin:new Xt(0),tickMax:new Xt(0)};var i=x6(new Xt(t).sub(e).div(r-1),n,a),o;e<=0&&t>=0?o=new Xt(0):(o=new Xt(e).add(t).div(2),o=o.sub(new Xt(o).mod(i)));var c=Math.ceil(o.sub(e).div(i).toNumber()),l=Math.ceil(new Xt(t).sub(o).div(i).toNumber()),u=c+l+1;return u>r?g6(e,t,r,n,a+1):(u<r&&(l=t>0?l+(r-u):l,c=t>0?c:c+(r-u)),{step:i,tickMin:o.sub(new Xt(c).mul(i)),tickMax:o.add(new Xt(l).mul(i))})}function Sde(e){var t=af(e,2),r=t[0],n=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(a,2),c=p6([r,n]),l=af(c,2),u=l[0],d=l[1];if(u===-1/0||d===1/0){var f=d===1/0?[u].concat(A1(T1(0,a-1).map(function(){return 1/0}))):[].concat(A1(T1(0,a-1).map(function(){return-1/0})),[d]);return r>n?C1(f):f}if(u===d)return Dde(u,a,i);var h=g6(u,d,o,i),m=h.step,x=h.tickMin,p=h.tickMax,g=K0.rangeStep(x,p.add(new Xt(.1).mul(m)),m);return r>n?C1(g):g}function Ede(e,t){var r=af(e,2),n=r[0],a=r[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=p6([n,a]),c=af(o,2),l=c[0],u=c[1];if(l===-1/0||u===1/0)return[n,a];if(l===u)return[l];var d=Math.max(t,2),f=x6(new Xt(u).sub(l).div(d-1),i,0),h=[].concat(A1(K0.rangeStep(new Xt(l),new Xt(u).sub(new Xt(.99).mul(f)),f)),[u]);return n>a?C1(h):h}var Tde=h6(Sde),Cde=h6(Ede),Ade=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Pl(e){"@babel/helpers - typeof";return Pl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pl(e)}function kp(){return kp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kp.apply(this,arguments)}function kde(e,t){return Ide(e)||Pde(e,t)||Ode(e,t)||Fde()}function Fde(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ode(e,t){if(e){if(typeof e=="string")return _T(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _T(e,t)}}function _T(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Pde(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,c=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return c}}function Ide(e){if(Array.isArray(e))return e}function Ude(e,t){if(e==null)return{};var r=Rde(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Rde(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Mde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bde(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b6(n.key),n)}}function Lde(e,t,r){return t&&Bde(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function $de(e,t,r){return t=Fp(t),Wde(e,v6()?Reflect.construct(t,r||[],Fp(e).constructor):t.apply(e,r))}function Wde(e,t){if(t&&(Pl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zde(e)}function zde(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v6(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v6=function(){return!!e})()}function Fp(e){return Fp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fp(e)}function qde(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&F1(e,t)}function F1(e,t){return F1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},F1(e,t)}function y6(e,t,r){return t=b6(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b6(e){var t=Hde(e,"string");return Pl(t)=="symbol"?t:t+""}function Hde(e,t){if(Pl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Pl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Eh=function(e){function t(){return Mde(this,t),$de(this,t,arguments)}return qde(t,e),Lde(t,[{key:"render",value:function(){var n=this.props,a=n.offset,i=n.layout,o=n.width,c=n.dataKey,l=n.data,u=n.dataPointFormatter,d=n.xAxis,f=n.yAxis,h=Ude(n,Ade),m=nt(h,!1);this.props.direction==="x"&&d.type!=="number"&&oo();var x=l.map(function(p){var g=u(p,c),v=g.x,y=g.y,b=g.value,_=g.errorVal;if(!_)return null;var w=[],j,N;if(Array.isArray(_)){var D=kde(_,2);j=D[0],N=D[1]}else j=N=_;if(i==="vertical"){var S=d.scale,T=y+a,A=T+o,E=T-o,M=S(b-j),P=S(b+N);w.push({x1:P,y1:A,x2:P,y2:E}),w.push({x1:M,y1:T,x2:P,y2:T}),w.push({x1:M,y1:A,x2:M,y2:E})}else if(i==="horizontal"){var X=f.scale,q=v+a,B=q-o,O=q+o,F=X(b-j),I=X(b+N);w.push({x1:B,y1:I,x2:O,y2:I}),w.push({x1:q,y1:F,x2:q,y2:I}),w.push({x1:B,y1:F,x2:O,y2:F})}return ge.createElement(Tt,kp({className:"recharts-errorBar",key:"bar-".concat(w.map(function(L){return"".concat(L.x1,"-").concat(L.x2,"-").concat(L.y1,"-").concat(L.y2)}))},m),w.map(function(L){return ge.createElement("line",kp({},L,{key:"line-".concat(L.x1,"-").concat(L.x2,"-").concat(L.y1,"-").concat(L.y2)}))}))});return ge.createElement(Tt,{className:"recharts-errorBars"},x)}}])}(ge.Component);y6(Eh,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});y6(Eh,"displayName","ErrorBar");function sf(e){"@babel/helpers - typeof";return sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sf(e)}function jT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Mo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jT(Object(r),!0).forEach(function(n){Vde(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Vde(e,t,r){return t=Gde(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gde(e){var t=Xde(e,"string");return sf(t)=="symbol"?t:t+""}function Xde(e,t){if(sf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(sf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var w6=function(t){var r=t.children,n=t.formattedGraphicalItems,a=t.legendWidth,i=t.legendContent,o=va(r,ao);if(!o)return null;var c=ao.defaultProps,l=c!==void 0?Mo(Mo({},c),o.props):{},u;return o.props&&o.props.payload?u=o.props&&o.props.payload:i==="children"?u=(n||[]).reduce(function(d,f){var h=f.item,m=f.props,x=m.sectors||m.data||[];return d.concat(x.map(function(p){return{type:o.props.iconType||h.props.legendType,value:p.name,color:p.fill,payload:p}}))},[]):u=(n||[]).map(function(d){var f=d.item,h=f.type.defaultProps,m=h!==void 0?Mo(Mo({},h),f.props):{},x=m.dataKey,p=m.name,g=m.legendType,v=m.hide;return{inactive:v,dataKey:x,type:l.iconType||g||"square",color:S_(f),value:p||x,payload:m}}),Mo(Mo(Mo({},l),ao.getWithHeight(o,a)),{},{payload:u,item:o})};function of(e){"@babel/helpers - typeof";return of=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},of(e)}function NT(e){return Jde(e)||Zde(e)||Yde(e)||Kde()}function Kde(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yde(e,t){if(e){if(typeof e=="string")return O1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return O1(e,t)}}function Zde(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Jde(e){if(Array.isArray(e))return O1(e)}function O1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function DT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function br(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DT(Object(r),!0).forEach(function(n){pl(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pl(e,t,r){return t=Qde(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qde(e){var t=efe(e,"string");return of(t)=="symbol"?t:t+""}function efe(e,t){if(of(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(of(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vr(e,t,r){return ft(e)||ft(t)?r:Hr(t)?Sa(e,t,r):st(t)?t(e):r}function Dd(e,t,r,n){var a=Jue(e,function(c){return vr(c,t)});if(r==="number"){var i=a.filter(function(c){return Re(c)||parseFloat(c)});return i.length?[G0(i),V0(i)]:[1/0,-1/0]}var o=n?a.filter(function(c){return!ft(c)}):a;return o.map(function(c){return Hr(c)||c instanceof Date?c:""})}var tfe=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=-1,c=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(c<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var l=i.range,u=0;u<c;u++){var d=u>0?a[u-1].coordinate:a[c-1].coordinate,f=a[u].coordinate,h=u>=c-1?a[0].coordinate:a[u+1].coordinate,m=void 0;if(qn(f-d)!==qn(h-f)){var x=[];if(qn(h-f)===qn(l[1]-l[0])){m=h;var p=f+l[1]-l[0];x[0]=Math.min(p,(p+d)/2),x[1]=Math.max(p,(p+d)/2)}else{m=d;var g=h+l[1]-l[0];x[0]=Math.min(f,(g+f)/2),x[1]=Math.max(f,(g+f)/2)}var v=[Math.min(f,(m+f)/2),Math.max(f,(m+f)/2)];if(t>v[0]&&t<=v[1]||t>=x[0]&&t<=x[1]){o=a[u].index;break}}else{var y=Math.min(d,h),b=Math.max(d,h);if(t>(y+f)/2&&t<=(b+f)/2){o=a[u].index;break}}}else for(var _=0;_<c;_++)if(_===0&&t<=(n[_].coordinate+n[_+1].coordinate)/2||_>0&&_<c-1&&t>(n[_].coordinate+n[_-1].coordinate)/2&&t<=(n[_].coordinate+n[_+1].coordinate)/2||_===c-1&&t>(n[_].coordinate+n[_-1].coordinate)/2){o=n[_].index;break}return o},S_=function(t){var r,n=t,a=n.type.displayName,i=(r=t.type)!==null&&r!==void 0&&r.defaultProps?br(br({},t.type.defaultProps),t.props):t.props,o=i.stroke,c=i.fill,l;switch(a){case"Line":l=o;break;case"Area":case"Radar":l=o&&o!=="none"?o:c;break;default:l=c;break}return l},rfe=function(t){var r=t.barSize,n=t.totalSize,a=t.stackGroups,i=a===void 0?{}:a;if(!i)return{};for(var o={},c=Object.keys(i),l=0,u=c.length;l<u;l++)for(var d=i[c[l]].stackGroups,f=Object.keys(d),h=0,m=f.length;h<m;h++){var x=d[f[h]],p=x.items,g=x.cateAxisId,v=p.filter(function(N){return gs(N.type).indexOf("Bar")>=0});if(v&&v.length){var y=v[0].type.defaultProps,b=y!==void 0?br(br({},y),v[0].props):v[0].props,_=b.barSize,w=b[g];o[w]||(o[w]=[]);var j=ft(_)?r:_;o[w].push({item:v[0],stackList:v.slice(1),barSize:ft(j)?void 0:Hn(j,n,0)})}}return o},nfe=function(t){var r=t.barGap,n=t.barCategoryGap,a=t.bandSize,i=t.sizeList,o=i===void 0?[]:i,c=t.maxBarSize,l=o.length;if(l<1)return null;var u=Hn(r,a,0,!0),d,f=[];if(o[0].barSize===+o[0].barSize){var h=!1,m=a/l,x=o.reduce(function(_,w){return _+w.barSize||0},0);x+=(l-1)*u,x>=a&&(x-=(l-1)*u,u=0),x>=a&&m>0&&(h=!0,m*=.9,x=l*m);var p=(a-x)/2>>0,g={offset:p-u,size:0};d=o.reduce(function(_,w){var j={item:w.item,position:{offset:g.offset+g.size+u,size:h?m:w.barSize}},N=[].concat(NT(_),[j]);return g=N[N.length-1].position,w.stackList&&w.stackList.length&&w.stackList.forEach(function(D){N.push({item:D,position:g})}),N},f)}else{var v=Hn(n,a,0,!0);a-2*v-(l-1)*u<=0&&(u=0);var y=(a-2*v-(l-1)*u)/l;y>1&&(y>>=0);var b=c===+c?Math.min(y,c):y;d=o.reduce(function(_,w,j){var N=[].concat(NT(_),[{item:w.item,position:{offset:v+(y+u)*j+(y-b)/2,size:b}}]);return w.stackList&&w.stackList.length&&w.stackList.forEach(function(D){N.push({item:D,position:N[N.length-1].position})}),N},f)}return d},afe=function(t,r,n,a){var i=n.children,o=n.width,c=n.margin,l=o-(c.left||0)-(c.right||0),u=w6({children:i,legendWidth:l});if(u){var d=a||{},f=d.width,h=d.height,m=u.align,x=u.verticalAlign,p=u.layout;if((p==="vertical"||p==="horizontal"&&x==="middle")&&m!=="center"&&Re(t[m]))return br(br({},t),{},pl({},m,t[m]+(f||0)));if((p==="horizontal"||p==="vertical"&&m==="center")&&x!=="middle"&&Re(t[x]))return br(br({},t),{},pl({},x,t[x]+(h||0)))}return t},ife=function(t,r,n){return ft(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},_6=function(t,r,n,a,i){var o=r.props.children,c=sa(o,Eh).filter(function(u){return ife(a,i,u.props.direction)});if(c&&c.length){var l=c.map(function(u){return u.props.dataKey});return t.reduce(function(u,d){var f=vr(d,n);if(ft(f))return u;var h=Array.isArray(f)?[G0(f),V0(f)]:[f,f],m=l.reduce(function(x,p){var g=vr(d,p,0),v=h[0]-Math.abs(Array.isArray(g)?g[0]:g),y=h[1]+Math.abs(Array.isArray(g)?g[1]:g);return[Math.min(v,x[0]),Math.max(y,x[1])]},[1/0,-1/0]);return[Math.min(m[0],u[0]),Math.max(m[1],u[1])]},[1/0,-1/0])}return null},sfe=function(t,r,n,a,i){var o=r.map(function(c){return _6(t,c,n,i,a)}).filter(function(c){return!ft(c)});return o&&o.length?o.reduce(function(c,l){return[Math.min(c[0],l[0]),Math.max(c[1],l[1])]},[1/0,-1/0]):null},j6=function(t,r,n,a,i){var o=r.map(function(l){var u=l.props.dataKey;return n==="number"&&u&&_6(t,l,u,a)||Dd(t,u,n,i)});if(n==="number")return o.reduce(function(l,u){return[Math.min(l[0],u[0]),Math.max(l[1],u[1])]},[1/0,-1/0]);var c={};return o.reduce(function(l,u){for(var d=0,f=u.length;d<f;d++)c[u[d]]||(c[u[d]]=!0,l.push(u[d]));return l},[])},N6=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},D6=function(t,r,n,a){if(a)return t.map(function(l){return l.coordinate});var i,o,c=t.map(function(l){return l.coordinate===r&&(i=!0),l.coordinate===n&&(o=!0),l.coordinate});return i||c.push(r),o||c.push(n),c},ps=function(t,r,n){if(!t)return null;var a=t.scale,i=t.duplicateDomain,o=t.type,c=t.range,l=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,u=(r||n)&&o==="category"&&a.bandwidth?a.bandwidth()/l:0;if(u=t.axisType==="angleAxis"&&(c==null?void 0:c.length)>=2?qn(c[0]-c[1])*2*u:u,r&&(t.ticks||t.niceTicks)){var d=(t.ticks||t.niceTicks).map(function(f){var h=i?i.indexOf(f):f;return{coordinate:a(h)+u,value:f,offset:u}});return d.filter(function(f){return!_h(f.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(f,h){return{coordinate:a(f)+u,value:f,index:h,offset:u}}):a.ticks&&!n?a.ticks(t.tickCount).map(function(f){return{coordinate:a(f)+u,value:f,offset:u}}):a.domain().map(function(f,h){return{coordinate:a(f)+u,value:i?i[f]:f,index:h,offset:u}})},Gv=new WeakMap,cm=function(t,r){if(typeof r!="function")return t;Gv.has(t)||Gv.set(t,new WeakMap);var n=Gv.get(t);if(n.has(r))return n.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,a),a},S6=function(t,r,n){var a=t.scale,i=t.type,o=t.layout,c=t.axisType;if(a==="auto")return o==="radial"&&c==="radiusAxis"?{scale:Jd(),realScaleType:"band"}:o==="radial"&&c==="angleAxis"?{scale:Sp(),realScaleType:"linear"}:i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:Nd(),realScaleType:"point"}:i==="category"?{scale:Jd(),realScaleType:"band"}:{scale:Sp(),realScaleType:"linear"};if(lo(a)){var l="scale".concat(k0(a));return{scale:(vT[l]||Nd)(),realScaleType:vT[l]?l:"point"}}return st(a)?{scale:a}:{scale:Nd(),realScaleType:"point"}},ST=1e-4,E6=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,a=t.range(),i=Math.min(a[0],a[1])-ST,o=Math.max(a[0],a[1])+ST,c=t(r[0]),l=t(r[n-1]);(c<i||c>o||l<i||l>o)&&t.domain([r[0],r[n-1]])}},ofe=function(t,r){if(!t)return null;for(var n=0,a=t.length;n<a;n++)if(t[n].item===r)return t[n].position;return null},cfe=function(t,r){if(!r||r.length!==2||!Re(r[0])||!Re(r[1]))return t;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),i=[t[0],t[1]];return(!Re(t[0])||t[0]<n)&&(i[0]=n),(!Re(t[1])||t[1]>a)&&(i[1]=a),i[0]>a&&(i[0]=a),i[1]<n&&(i[1]=n),i},lfe=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,o=0,c=0;c<r;++c){var l=_h(t[c][n][1])?t[c][n][0]:t[c][n][1];l>=0?(t[c][n][0]=i,t[c][n][1]=i+l,i=t[c][n][1]):(t[c][n][0]=o,t[c][n][1]=o+l,o=t[c][n][1])}},ufe=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,o=0;o<r;++o){var c=_h(t[o][n][1])?t[o][n][0]:t[o][n][1];c>=0?(t[o][n][0]=i,t[o][n][1]=i+c,i=t[o][n][1]):(t[o][n][0]=0,t[o][n][1]=0)}},dfe={sign:lfe,expand:WJ,none:Sl,silhouette:zJ,wiggle:qJ,positive:ufe},ffe=function(t,r,n){var a=r.map(function(c){return c.props.dataKey}),i=dfe[n],o=$J().keys(a).value(function(c,l){return+vr(c,l,0)}).order(a1).offset(i);return o(t)},hfe=function(t,r,n,a,i,o){if(!t)return null;var c=o?r.reverse():r,l={},u=c.reduce(function(f,h){var m,x=(m=h.type)!==null&&m!==void 0&&m.defaultProps?br(br({},h.type.defaultProps),h.props):h.props,p=x.stackId,g=x.hide;if(g)return f;var v=x[n],y=f[v]||{hasStack:!1,stackGroups:{}};if(Hr(p)){var b=y.stackGroups[p]||{numericAxisId:n,cateAxisId:a,items:[]};b.items.push(h),y.hasStack=!0,y.stackGroups[p]=b}else y.stackGroups[yu("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[h]};return br(br({},f),{},pl({},v,y))},l),d={};return Object.keys(u).reduce(function(f,h){var m=u[h];if(m.hasStack){var x={};m.stackGroups=Object.keys(m.stackGroups).reduce(function(p,g){var v=m.stackGroups[g];return br(br({},p),{},pl({},g,{numericAxisId:n,cateAxisId:a,items:v.items,stackedData:ffe(t,v.items,i)}))},x)}return br(br({},f),{},pl({},h,m))},d)},T6=function(t,r){var n=r.realScaleType,a=r.type,i=r.tickCount,o=r.originalDomain,c=r.allowDecimals,l=n||r.scale;if(l!=="auto"&&l!=="linear")return null;if(i&&a==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var u=t.domain();if(!u.length)return null;var d=Tde(u,i,c);return t.domain([G0(d),V0(d)]),{niceTicks:d}}if(i&&a==="number"){var f=t.domain(),h=Cde(f,i,c);return{niceTicks:h}}return null};function ET(e){var t=e.axis,r=e.ticks,n=e.bandSize,a=e.entry,i=e.index,o=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!ft(a[t.dataKey])){var c=ip(r,"value",a[t.dataKey]);if(c)return c.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var l=vr(a,ft(o)?t.dataKey:o);return ft(l)?null:t.scale(l)}var TT=function(t){var r=t.axis,n=t.ticks,a=t.offset,i=t.bandSize,o=t.entry,c=t.index;if(r.type==="category")return n[c]?n[c].coordinate+a:null;var l=vr(o,r.dataKey,r.domain[c]);return ft(l)?null:r.scale(l)-i/2+a},mfe=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]);return a<=0&&i>=0?0:i<0?i:a}return n[0]},pfe=function(t,r){var n,a=(n=t.type)!==null&&n!==void 0&&n.defaultProps?br(br({},t.type.defaultProps),t.props):t.props,i=a.stackId;if(Hr(i)){var o=r[i];if(o){var c=o.items.indexOf(t);return c>=0?o.stackedData[c]:null}}return null},xfe=function(t){return t.reduce(function(r,n){return[G0(n.concat([r[0]]).filter(Re)),V0(n.concat([r[1]]).filter(Re))]},[1/0,-1/0])},C6=function(t,r,n){return Object.keys(t).reduce(function(a,i){var o=t[i],c=o.stackedData,l=c.reduce(function(u,d){var f=xfe(d.slice(r,n+1));return[Math.min(u[0],f[0]),Math.max(u[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],a[0]),Math.max(l[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},CT=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,AT=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,P1=function(t,r,n){if(st(t))return t(r,n);if(!Array.isArray(t))return r;var a=[];if(Re(t[0]))a[0]=n?t[0]:Math.min(t[0],r[0]);else if(CT.test(t[0])){var i=+CT.exec(t[0])[1];a[0]=r[0]-i}else st(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(Re(t[1]))a[1]=n?t[1]:Math.max(t[1],r[1]);else if(AT.test(t[1])){var o=+AT.exec(t[1])[1];a[1]=r[1]+o}else st(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},Op=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&r&&r.length>=2){for(var i=e_(r,function(f){return f.coordinate}),o=1/0,c=1,l=i.length;c<l;c++){var u=i[c],d=i[c-1];o=Math.min((u.coordinate||0)-(d.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0},kT=function(t,r,n){return!t||!t.length||Su(t,Sa(n,"type.defaultProps.domain"))?r:t},A6=function(t,r){var n=t.type.defaultProps?br(br({},t.type.defaultProps),t.props):t.props,a=n.dataKey,i=n.name,o=n.unit,c=n.formatter,l=n.tooltipType,u=n.chartType,d=n.hide;return br(br({},nt(t,!1)),{},{dataKey:a,unit:o,formatter:c,name:i||a,color:S_(t),value:vr(r,a),type:l,payload:r,chartType:u,hide:d})};function cf(e){"@babel/helpers - typeof";return cf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cf(e)}function FT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ds(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FT(Object(r),!0).forEach(function(n){k6(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function k6(e,t,r){return t=gfe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gfe(e){var t=vfe(e,"string");return cf(t)=="symbol"?t:t+""}function vfe(e,t){if(cf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(cf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yfe(e,t){return jfe(e)||_fe(e,t)||wfe(e,t)||bfe()}function bfe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wfe(e,t){if(e){if(typeof e=="string")return OT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OT(e,t)}}function OT(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _fe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,c=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return c}}function jfe(e){if(Array.isArray(e))return e}var Pp=Math.PI/180,Nfe=function(t){return t*180/Math.PI},rr=function(t,r,n,a){return{x:t+Math.cos(-Pp*a)*n,y:r+Math.sin(-Pp*a)*n}},F6=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},Dfe=function(t,r,n,a,i){var o=t.width,c=t.height,l=t.startAngle,u=t.endAngle,d=Hn(t.cx,o,o/2),f=Hn(t.cy,c,c/2),h=F6(o,c,n),m=Hn(t.innerRadius,h,0),x=Hn(t.outerRadius,h,h*.8),p=Object.keys(r);return p.reduce(function(g,v){var y=r[v],b=y.domain,_=y.reversed,w;if(ft(y.range))a==="angleAxis"?w=[l,u]:a==="radiusAxis"&&(w=[m,x]),_&&(w=[w[1],w[0]]);else{w=y.range;var j=w,N=yfe(j,2);l=N[0],u=N[1]}var D=S6(y,i),S=D.realScaleType,T=D.scale;T.domain(b).range(w),E6(T);var A=T6(T,ds(ds({},y),{},{realScaleType:S})),E=ds(ds(ds({},y),A),{},{range:w,radius:x,realScaleType:S,scale:T,cx:d,cy:f,innerRadius:m,outerRadius:x,startAngle:l,endAngle:u});return ds(ds({},g),{},k6({},v,E))},{})},Sfe=function(t,r){var n=t.x,a=t.y,i=r.x,o=r.y;return Math.sqrt(Math.pow(n-i,2)+Math.pow(a-o,2))},Efe=function(t,r){var n=t.x,a=t.y,i=r.cx,o=r.cy,c=Sfe({x:n,y:a},{x:i,y:o});if(c<=0)return{radius:c};var l=(n-i)/c,u=Math.acos(l);return a>o&&(u=2*Math.PI-u),{radius:c,angle:Nfe(u),angleInRadian:u}},Tfe=function(t){var r=t.startAngle,n=t.endAngle,a=Math.floor(r/360),i=Math.floor(n/360),o=Math.min(a,i);return{startAngle:r-o*360,endAngle:n-o*360}},Cfe=function(t,r){var n=r.startAngle,a=r.endAngle,i=Math.floor(n/360),o=Math.floor(a/360),c=Math.min(i,o);return t+c*360},PT=function(t,r){var n=t.x,a=t.y,i=Efe({x:n,y:a},r),o=i.radius,c=i.angle,l=r.innerRadius,u=r.outerRadius;if(o<l||o>u)return!1;if(o===0)return!0;var d=Tfe(r),f=d.startAngle,h=d.endAngle,m=c,x;if(f<=h){for(;m>h;)m-=360;for(;m<f;)m+=360;x=m>=f&&m<=h}else{for(;m>f;)m-=360;for(;m<h;)m+=360;x=m>=h&&m<=f}return x?ds(ds({},r),{},{radius:o,angle:Cfe(m,r)}):null},O6=function(t){return!R.isValidElement(t)&&!st(t)&&typeof t!="boolean"?t.className:""};function lf(e){"@babel/helpers - typeof";return lf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lf(e)}var Afe=["offset"];function kfe(e){return Ife(e)||Pfe(e)||Ofe(e)||Ffe()}function Ffe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ofe(e,t){if(e){if(typeof e=="string")return I1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return I1(e,t)}}function Pfe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ife(e){if(Array.isArray(e))return I1(e)}function I1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ufe(e,t){if(e==null)return{};var r=Rfe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Rfe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function IT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $r(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IT(Object(r),!0).forEach(function(n){Mfe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Mfe(e,t,r){return t=Bfe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bfe(e){var t=Lfe(e,"string");return lf(t)=="symbol"?t:t+""}function Lfe(e,t){if(lf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(lf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uf(){return uf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uf.apply(this,arguments)}var $fe=function(t){var r=t.value,n=t.formatter,a=ft(t.children)?r:t.children;return st(n)?n(a):a},Wfe=function(t,r){var n=qn(r-t),a=Math.min(Math.abs(r-t),360);return n*a},zfe=function(t,r,n){var a=t.position,i=t.viewBox,o=t.offset,c=t.className,l=i,u=l.cx,d=l.cy,f=l.innerRadius,h=l.outerRadius,m=l.startAngle,x=l.endAngle,p=l.clockWise,g=(f+h)/2,v=Wfe(m,x),y=v>=0?1:-1,b,_;a==="insideStart"?(b=m+y*o,_=p):a==="insideEnd"?(b=x-y*o,_=!p):a==="end"&&(b=x+y*o,_=p),_=v<=0?_:!_;var w=rr(u,d,g,b),j=rr(u,d,g,b+(_?1:-1)*359),N="M".concat(w.x,",").concat(w.y,`
    A`).concat(g,",").concat(g,",0,1,").concat(_?0:1,`,
    `).concat(j.x,",").concat(j.y),D=ft(t.id)?yu("recharts-radial-line-"):t.id;return ge.createElement("text",uf({},n,{dominantBaseline:"central",className:dt("recharts-radial-bar-label",c)}),ge.createElement("defs",null,ge.createElement("path",{id:D,d:N})),ge.createElement("textPath",{xlinkHref:"#".concat(D)},r))},qfe=function(t){var r=t.viewBox,n=t.offset,a=t.position,i=r,o=i.cx,c=i.cy,l=i.innerRadius,u=i.outerRadius,d=i.startAngle,f=i.endAngle,h=(d+f)/2;if(a==="outside"){var m=rr(o,c,u+n,h),x=m.x,p=m.y;return{x,y:p,textAnchor:x>=o?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:o,y:c,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:o,y:c,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:o,y:c,textAnchor:"middle",verticalAnchor:"end"};var g=(l+u)/2,v=rr(o,c,g,h),y=v.x,b=v.y;return{x:y,y:b,textAnchor:"middle",verticalAnchor:"middle"}},Hfe=function(t){var r=t.viewBox,n=t.parentViewBox,a=t.offset,i=t.position,o=r,c=o.x,l=o.y,u=o.width,d=o.height,f=d>=0?1:-1,h=f*a,m=f>0?"end":"start",x=f>0?"start":"end",p=u>=0?1:-1,g=p*a,v=p>0?"end":"start",y=p>0?"start":"end";if(i==="top"){var b={x:c+u/2,y:l-f*a,textAnchor:"middle",verticalAnchor:m};return $r($r({},b),n?{height:Math.max(l-n.y,0),width:u}:{})}if(i==="bottom"){var _={x:c+u/2,y:l+d+h,textAnchor:"middle",verticalAnchor:x};return $r($r({},_),n?{height:Math.max(n.y+n.height-(l+d),0),width:u}:{})}if(i==="left"){var w={x:c-g,y:l+d/2,textAnchor:v,verticalAnchor:"middle"};return $r($r({},w),n?{width:Math.max(w.x-n.x,0),height:d}:{})}if(i==="right"){var j={x:c+u+g,y:l+d/2,textAnchor:y,verticalAnchor:"middle"};return $r($r({},j),n?{width:Math.max(n.x+n.width-j.x,0),height:d}:{})}var N=n?{width:u,height:d}:{};return i==="insideLeft"?$r({x:c+g,y:l+d/2,textAnchor:y,verticalAnchor:"middle"},N):i==="insideRight"?$r({x:c+u-g,y:l+d/2,textAnchor:v,verticalAnchor:"middle"},N):i==="insideTop"?$r({x:c+u/2,y:l+h,textAnchor:"middle",verticalAnchor:x},N):i==="insideBottom"?$r({x:c+u/2,y:l+d-h,textAnchor:"middle",verticalAnchor:m},N):i==="insideTopLeft"?$r({x:c+g,y:l+h,textAnchor:y,verticalAnchor:x},N):i==="insideTopRight"?$r({x:c+u-g,y:l+h,textAnchor:v,verticalAnchor:x},N):i==="insideBottomLeft"?$r({x:c+g,y:l+d-h,textAnchor:y,verticalAnchor:m},N):i==="insideBottomRight"?$r({x:c+u-g,y:l+d-h,textAnchor:v,verticalAnchor:m},N):pu(i)&&(Re(i.x)||Jo(i.x))&&(Re(i.y)||Jo(i.y))?$r({x:c+Hn(i.x,u),y:l+Hn(i.y,d),textAnchor:"end",verticalAnchor:"end"},N):$r({x:c+u/2,y:l+d/2,textAnchor:"middle",verticalAnchor:"middle"},N)},Vfe=function(t){return"cx"in t&&Re(t.cx)};function Zr(e){var t=e.offset,r=t===void 0?5:t,n=Ufe(e,Afe),a=$r({offset:r},n),i=a.viewBox,o=a.position,c=a.value,l=a.children,u=a.content,d=a.className,f=d===void 0?"":d,h=a.textBreakAll;if(!i||ft(c)&&ft(l)&&!R.isValidElement(u)&&!st(u))return null;if(R.isValidElement(u))return R.cloneElement(u,a);var m;if(st(u)){if(m=R.createElement(u,a),R.isValidElement(m))return m}else m=$fe(a);var x=Vfe(i),p=nt(a,!0);if(x&&(o==="insideStart"||o==="insideEnd"||o==="end"))return zfe(a,m,p);var g=x?qfe(a):Hfe(a);return ge.createElement(fc,uf({className:dt("recharts-label",f)},p,g,{breakAll:h}),m)}Zr.displayName="Label";var P6=function(t){var r=t.cx,n=t.cy,a=t.angle,i=t.startAngle,o=t.endAngle,c=t.r,l=t.radius,u=t.innerRadius,d=t.outerRadius,f=t.x,h=t.y,m=t.top,x=t.left,p=t.width,g=t.height,v=t.clockWise,y=t.labelViewBox;if(y)return y;if(Re(p)&&Re(g)){if(Re(f)&&Re(h))return{x:f,y:h,width:p,height:g};if(Re(m)&&Re(x))return{x:m,y:x,width:p,height:g}}return Re(f)&&Re(h)?{x:f,y:h,width:0,height:0}:Re(r)&&Re(n)?{cx:r,cy:n,startAngle:i||a||0,endAngle:o||a||0,innerRadius:u||0,outerRadius:d||l||c||0,clockWise:v}:t.viewBox?t.viewBox:{}},Gfe=function(t,r){return t?t===!0?ge.createElement(Zr,{key:"label-implicit",viewBox:r}):Hr(t)?ge.createElement(Zr,{key:"label-implicit",viewBox:r,value:t}):R.isValidElement(t)?t.type===Zr?R.cloneElement(t,{key:"label-implicit",viewBox:r}):ge.createElement(Zr,{key:"label-implicit",content:t,viewBox:r}):st(t)?ge.createElement(Zr,{key:"label-implicit",content:t,viewBox:r}):pu(t)?ge.createElement(Zr,uf({viewBox:r},t,{key:"label-implicit"})):null:null},Xfe=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var a=t.children,i=P6(t),o=sa(a,Zr).map(function(l,u){return R.cloneElement(l,{viewBox:r||i,key:"label-".concat(u)})});if(!n)return o;var c=Gfe(t.label,r||i);return[c].concat(kfe(o))};Zr.parseViewBox=P6;Zr.renderCallByParent=Xfe;function Kfe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var I6=Kfe;const Yfe=Rt(I6);function df(e){"@babel/helpers - typeof";return df=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},df(e)}var Zfe=["valueAccessor"],Jfe=["data","dataKey","clockWise","id","textBreakAll"];function Qfe(e){return nhe(e)||rhe(e)||the(e)||ehe()}function ehe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function the(e,t){if(e){if(typeof e=="string")return U1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U1(e,t)}}function rhe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function nhe(e){if(Array.isArray(e))return U1(e)}function U1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ip(){return Ip=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ip.apply(this,arguments)}function UT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function RT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?UT(Object(r),!0).forEach(function(n){ahe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):UT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ahe(e,t,r){return t=ihe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ihe(e){var t=she(e,"string");return df(t)=="symbol"?t:t+""}function she(e,t){if(df(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(df(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MT(e,t){if(e==null)return{};var r=ohe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ohe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var che=function(t){return Array.isArray(t.value)?Yfe(t.value):t.value};function wi(e){var t=e.valueAccessor,r=t===void 0?che:t,n=MT(e,Zfe),a=n.data,i=n.dataKey,o=n.clockWise,c=n.id,l=n.textBreakAll,u=MT(n,Jfe);return!a||!a.length?null:ge.createElement(Tt,{className:"recharts-label-list"},a.map(function(d,f){var h=ft(i)?r(d,f):vr(d&&d.payload,i),m=ft(c)?{}:{id:"".concat(c,"-").concat(f)};return ge.createElement(Zr,Ip({},nt(d,!0),u,m,{parentViewBox:d.parentViewBox,value:h,textBreakAll:l,viewBox:Zr.parseViewBox(ft(o)?d:RT(RT({},d),{},{clockWise:o})),key:"label-".concat(f),index:f}))}))}wi.displayName="LabelList";function lhe(e,t){return e?e===!0?ge.createElement(wi,{key:"labelList-implicit",data:t}):ge.isValidElement(e)||st(e)?ge.createElement(wi,{key:"labelList-implicit",data:t,content:e}):pu(e)?ge.createElement(wi,Ip({data:t},e,{key:"labelList-implicit"})):null:null}function uhe(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,a=sa(n,wi).map(function(o,c){return R.cloneElement(o,{data:t,key:"labelList-".concat(c)})});if(!r)return a;var i=lhe(e.label,t);return[i].concat(Qfe(a))}wi.renderCallByParent=uhe;function ff(e){"@babel/helpers - typeof";return ff=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ff(e)}function R1(){return R1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},R1.apply(this,arguments)}function BT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function LT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BT(Object(r),!0).forEach(function(n){dhe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dhe(e,t,r){return t=fhe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fhe(e){var t=hhe(e,"string");return ff(t)=="symbol"?t:t+""}function hhe(e,t){if(ff(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ff(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mhe=function(t,r){var n=qn(r-t),a=Math.min(Math.abs(r-t),359.999);return n*a},lm=function(t){var r=t.cx,n=t.cy,a=t.radius,i=t.angle,o=t.sign,c=t.isExternal,l=t.cornerRadius,u=t.cornerIsExternal,d=l*(c?1:-1)+a,f=Math.asin(l/d)/Pp,h=u?i:i+o*f,m=rr(r,n,d,h),x=rr(r,n,a,h),p=u?i-o*f:i,g=rr(r,n,d*Math.cos(f*Pp),p);return{center:m,circleTangency:x,lineTangency:g,theta:f}},U6=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,o=t.startAngle,c=t.endAngle,l=mhe(o,c),u=o+l,d=rr(r,n,i,o),f=rr(r,n,i,u),h="M ".concat(d.x,",").concat(d.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(o>u),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(a>0){var m=rr(r,n,a,o),x=rr(r,n,a,u);h+="L ".concat(x.x,",").concat(x.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(o<=u),`,
            `).concat(m.x,",").concat(m.y," Z")}else h+="L ".concat(r,",").concat(n," Z");return h},phe=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,o=t.cornerRadius,c=t.forceCornerRadius,l=t.cornerIsExternal,u=t.startAngle,d=t.endAngle,f=qn(d-u),h=lm({cx:r,cy:n,radius:i,angle:u,sign:f,cornerRadius:o,cornerIsExternal:l}),m=h.circleTangency,x=h.lineTangency,p=h.theta,g=lm({cx:r,cy:n,radius:i,angle:d,sign:-f,cornerRadius:o,cornerIsExternal:l}),v=g.circleTangency,y=g.lineTangency,b=g.theta,_=l?Math.abs(u-d):Math.abs(u-d)-p-b;if(_<0)return c?"M ".concat(x.x,",").concat(x.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):U6({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:u,endAngle:d});var w="M ".concat(x.x,",").concat(x.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(_>180),",").concat(+(f<0),",").concat(v.x,",").concat(v.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(y.x,",").concat(y.y,`
  `);if(a>0){var j=lm({cx:r,cy:n,radius:a,angle:u,sign:f,isExternal:!0,cornerRadius:o,cornerIsExternal:l}),N=j.circleTangency,D=j.lineTangency,S=j.theta,T=lm({cx:r,cy:n,radius:a,angle:d,sign:-f,isExternal:!0,cornerRadius:o,cornerIsExternal:l}),A=T.circleTangency,E=T.lineTangency,M=T.theta,P=l?Math.abs(u-d):Math.abs(u-d)-S-M;if(P<0&&o===0)return"".concat(w,"L").concat(r,",").concat(n,"Z");w+="L".concat(E.x,",").concat(E.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(A.x,",").concat(A.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(P>180),",").concat(+(f>0),",").concat(N.x,",").concat(N.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(D.x,",").concat(D.y,"Z")}else w+="L".concat(r,",").concat(n,"Z");return w},xhe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},R6=function(t){var r=LT(LT({},xhe),t),n=r.cx,a=r.cy,i=r.innerRadius,o=r.outerRadius,c=r.cornerRadius,l=r.forceCornerRadius,u=r.cornerIsExternal,d=r.startAngle,f=r.endAngle,h=r.className;if(o<i||d===f)return null;var m=dt("recharts-sector",h),x=o-i,p=Hn(c,x,0,!0),g;return p>0&&Math.abs(d-f)<360?g=phe({cx:n,cy:a,innerRadius:i,outerRadius:o,cornerRadius:Math.min(p,x/2),forceCornerRadius:l,cornerIsExternal:u,startAngle:d,endAngle:f}):g=U6({cx:n,cy:a,innerRadius:i,outerRadius:o,startAngle:d,endAngle:f}),ge.createElement("path",R1({},nt(r,!0),{className:m,d:g,role:"img"}))};function hf(e){"@babel/helpers - typeof";return hf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hf(e)}function M1(){return M1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},M1.apply(this,arguments)}function $T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function WT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$T(Object(r),!0).forEach(function(n){ghe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$T(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ghe(e,t,r){return t=vhe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vhe(e){var t=yhe(e,"string");return hf(t)=="symbol"?t:t+""}function yhe(e,t){if(hf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(hf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zT={curveBasisClosed:AJ,curveBasisOpen:kJ,curveBasis:CJ,curveBumpX:pJ,curveBumpY:xJ,curveLinearClosed:FJ,curveLinear:O0,curveMonotoneX:OJ,curveMonotoneY:PJ,curveNatural:IJ,curveStep:UJ,curveStepAfter:MJ,curveStepBefore:RJ},um=function(t){return t.x===+t.x&&t.y===+t.y},td=function(t){return t.x},rd=function(t){return t.y},bhe=function(t,r){if(st(t))return t;var n="curve".concat(k0(t));return(n==="curveMonotone"||n==="curveBump")&&r?zT["".concat(n).concat(r==="vertical"?"Y":"X")]:zT[n]||O0},whe=function(t){var r=t.type,n=r===void 0?"linear":r,a=t.points,i=a===void 0?[]:a,o=t.baseLine,c=t.layout,l=t.connectNulls,u=l===void 0?!1:l,d=bhe(n,c),f=u?i.filter(function(p){return um(p)}):i,h;if(Array.isArray(o)){var m=u?o.filter(function(p){return um(p)}):o,x=f.map(function(p,g){return WT(WT({},p),{},{base:m[g]})});return c==="vertical"?h=em().y(rd).x1(td).x0(function(p){return p.base.x}):h=em().x(td).y1(rd).y0(function(p){return p.base.y}),h.defined(um).curve(d),h(x)}return c==="vertical"&&Re(o)?h=em().y(rd).x1(td).x0(o):Re(o)?h=em().x(td).y1(rd).y0(o):h=T5().x(td).y(rd),h.defined(um).curve(d),h(f)},Up=function(t){var r=t.className,n=t.points,a=t.path,i=t.pathRef;if((!n||!n.length)&&!a)return null;var o=n&&n.length?whe(t):a;return R.createElement("path",M1({},nt(t,!1),sp(t),{className:dt("recharts-curve",r),d:o,ref:i}))},_he=Object.getOwnPropertyNames,jhe=Object.getOwnPropertySymbols,Nhe=Object.prototype.hasOwnProperty;function qT(e,t){return function(n,a,i){return e(n,a,i)&&t(n,a,i)}}function dm(e){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,a);var i=a.cache,o=i.get(r),c=i.get(n);if(o&&c)return o===n&&c===r;i.set(r,n),i.set(n,r);var l=e(r,n,a);return i.delete(r),i.delete(n),l}}function HT(e){return _he(e).concat(jhe(e))}var Dhe=Object.hasOwn||function(e,t){return Nhe.call(e,t)};function Cc(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var She="__v",Ehe="__o",The="_owner",VT=Object.getOwnPropertyDescriptor,GT=Object.keys;function Che(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function Ahe(e,t){return Cc(e.getTime(),t.getTime())}function khe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function Fhe(e,t){return e===t}function XT(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),i=e.entries(),o,c,l=0;(o=i.next())&&!o.done;){for(var u=t.entries(),d=!1,f=0;(c=u.next())&&!c.done;){if(a[f]){f++;continue}var h=o.value,m=c.value;if(r.equals(h[0],m[0],l,f,e,t,r)&&r.equals(h[1],m[1],h[0],m[0],e,t,r)){d=a[f]=!0;break}f++}if(!d)return!1;l++}return!0}var Ohe=Cc;function Phe(e,t,r){var n=GT(e),a=n.length;if(GT(t).length!==a)return!1;for(;a-- >0;)if(!M6(e,t,r,n[a]))return!1;return!0}function nd(e,t,r){var n=HT(e),a=n.length;if(HT(t).length!==a)return!1;for(var i,o,c;a-- >0;)if(i=n[a],!M6(e,t,r,i)||(o=VT(e,i),c=VT(t,i),(o||c)&&(!o||!c||o.configurable!==c.configurable||o.enumerable!==c.enumerable||o.writable!==c.writable)))return!1;return!0}function Ihe(e,t){return Cc(e.valueOf(),t.valueOf())}function Uhe(e,t){return e.source===t.source&&e.flags===t.flags}function KT(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),i=e.values(),o,c;(o=i.next())&&!o.done;){for(var l=t.values(),u=!1,d=0;(c=l.next())&&!c.done;){if(!a[d]&&r.equals(o.value,c.value,o.value,c.value,e,t,r)){u=a[d]=!0;break}d++}if(!u)return!1}return!0}function Rhe(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function Mhe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function M6(e,t,r,n){return(n===The||n===Ehe||n===She)&&(e.$$typeof||t.$$typeof)?!0:Dhe(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var Bhe="[object Arguments]",Lhe="[object Boolean]",$he="[object Date]",Whe="[object Error]",zhe="[object Map]",qhe="[object Number]",Hhe="[object Object]",Vhe="[object RegExp]",Ghe="[object Set]",Xhe="[object String]",Khe="[object URL]",Yhe=Array.isArray,YT=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,ZT=Object.assign,Zhe=Object.prototype.toString.call.bind(Object.prototype.toString);function Jhe(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,a=e.areFunctionsEqual,i=e.areMapsEqual,o=e.areNumbersEqual,c=e.areObjectsEqual,l=e.arePrimitiveWrappersEqual,u=e.areRegExpsEqual,d=e.areSetsEqual,f=e.areTypedArraysEqual,h=e.areUrlsEqual;return function(x,p,g){if(x===p)return!0;if(x==null||p==null)return!1;var v=typeof x;if(v!==typeof p)return!1;if(v!=="object")return v==="number"?o(x,p,g):v==="function"?a(x,p,g):!1;var y=x.constructor;if(y!==p.constructor)return!1;if(y===Object)return c(x,p,g);if(Yhe(x))return t(x,p,g);if(YT!=null&&YT(x))return f(x,p,g);if(y===Date)return r(x,p,g);if(y===RegExp)return u(x,p,g);if(y===Map)return i(x,p,g);if(y===Set)return d(x,p,g);var b=Zhe(x);return b===$he?r(x,p,g):b===Vhe?u(x,p,g):b===zhe?i(x,p,g):b===Ghe?d(x,p,g):b===Hhe?typeof x.then!="function"&&typeof p.then!="function"&&c(x,p,g):b===Khe?h(x,p,g):b===Whe?n(x,p,g):b===Bhe?c(x,p,g):b===Lhe||b===qhe||b===Xhe?l(x,p,g):!1}}function Qhe(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,a={areArraysEqual:n?nd:Che,areDatesEqual:Ahe,areErrorsEqual:khe,areFunctionsEqual:Fhe,areMapsEqual:n?qT(XT,nd):XT,areNumbersEqual:Ohe,areObjectsEqual:n?nd:Phe,arePrimitiveWrappersEqual:Ihe,areRegExpsEqual:Uhe,areSetsEqual:n?qT(KT,nd):KT,areTypedArraysEqual:n?nd:Rhe,areUrlsEqual:Mhe};if(r&&(a=ZT({},a,r(a))),t){var i=dm(a.areArraysEqual),o=dm(a.areMapsEqual),c=dm(a.areObjectsEqual),l=dm(a.areSetsEqual);a=ZT({},a,{areArraysEqual:i,areMapsEqual:o,areObjectsEqual:c,areSetsEqual:l})}return a}function eme(e){return function(t,r,n,a,i,o,c){return e(t,r,c)}}function tme(e){var t=e.circular,r=e.comparator,n=e.createState,a=e.equals,i=e.strict;if(n)return function(l,u){var d=n(),f=d.cache,h=f===void 0?t?new WeakMap:void 0:f,m=d.meta;return r(l,u,{cache:h,equals:a,meta:m,strict:i})};if(t)return function(l,u){return r(l,u,{cache:new WeakMap,equals:a,meta:void 0,strict:i})};var o={cache:void 0,equals:a,meta:void 0,strict:i};return function(l,u){return r(l,u,o)}}var rme=jo();jo({strict:!0});jo({circular:!0});jo({circular:!0,strict:!0});jo({createInternalComparator:function(){return Cc}});jo({strict:!0,createInternalComparator:function(){return Cc}});jo({circular:!0,createInternalComparator:function(){return Cc}});jo({circular:!0,createInternalComparator:function(){return Cc},strict:!0});function jo(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,a=e.createState,i=e.strict,o=i===void 0?!1:i,c=Qhe(e),l=Jhe(c),u=n?n(l):eme(l);return tme({circular:r,comparator:l,createState:a,equals:u,strict:o})}function nme(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function JT(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function a(i){r<0&&(r=i),i-r>t?(e(i),r=-1):nme(a)};requestAnimationFrame(n)}function B1(e){"@babel/helpers - typeof";return B1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B1(e)}function ame(e){return cme(e)||ome(e)||sme(e)||ime()}function ime(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sme(e,t){if(e){if(typeof e=="string")return QT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QT(e,t)}}function QT(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ome(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cme(e){if(Array.isArray(e))return e}function lme(){var e={},t=function(){return null},r=!1,n=function a(i){if(!r){if(Array.isArray(i)){if(!i.length)return;var o=i,c=ame(o),l=c[0],u=c.slice(1);if(typeof l=="number"){JT(a.bind(null,u),l);return}a(l),JT(a.bind(null,u));return}B1(i)==="object"&&(e=i,t(e)),typeof i=="function"&&i()}};return{stop:function(){r=!0},start:function(i){r=!1,n(i)},subscribe:function(i){return t=i,function(){t=function(){return null}}}}}function mf(e){"@babel/helpers - typeof";return mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mf(e)}function eC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eC(Object(r),!0).forEach(function(n){B6(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function B6(e,t,r){return t=ume(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ume(e){var t=dme(e,"string");return mf(t)==="symbol"?t:String(t)}function dme(e,t){if(mf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(mf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fme=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,a){return n.filter(function(i){return a.includes(i)})})},hme=function(t){return t},mme=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},Sd=function(t,r){return Object.keys(r).reduce(function(n,a){return tC(tC({},n),{},B6({},a,t(a,r[a])))},{})},rC=function(t,r,n){return t.map(function(a){return"".concat(mme(a)," ").concat(r,"ms ").concat(n)}).join(",")};function pme(e,t){return vme(e)||gme(e,t)||L6(e,t)||xme()}function xme(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gme(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,c=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return c}}function vme(e){if(Array.isArray(e))return e}function yme(e){return _me(e)||wme(e)||L6(e)||bme()}function bme(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function L6(e,t){if(e){if(typeof e=="string")return L1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return L1(e,t)}}function wme(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _me(e){if(Array.isArray(e))return L1(e)}function L1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Rp=1e-4,$6=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},W6=function(t,r){return t.map(function(n,a){return n*Math.pow(r,a)}).reduce(function(n,a){return n+a})},nC=function(t,r){return function(n){var a=$6(t,r);return W6(a,n)}},jme=function(t,r){return function(n){var a=$6(t,r),i=[].concat(yme(a.map(function(o,c){return o*c}).slice(1)),[0]);return W6(i,n)}},aC=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],i=r[1],o=r[2],c=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,i=0,o=1,c=1;break;case"ease":a=.25,i=.1,o=.25,c=1;break;case"ease-in":a=.42,i=0,o=1,c=1;break;case"ease-out":a=.42,i=0,o=.58,c=1;break;case"ease-in-out":a=0,i=0,o=.58,c=1;break;default:{var l=r[0].split("(");if(l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4){var u=l[1].split(")")[0].split(",").map(function(g){return parseFloat(g)}),d=pme(u,4);a=d[0],i=d[1],o=d[2],c=d[3]}}}var f=nC(a,o),h=nC(i,c),m=jme(a,o),x=function(v){return v>1?1:v<0?0:v},p=function(v){for(var y=v>1?1:v,b=y,_=0;_<8;++_){var w=f(b)-y,j=m(b);if(Math.abs(w-y)<Rp||j<Rp)return h(b);b=x(b-w/j)}return h(b)};return p.isStepper=!1,p},Nme=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,a=t.damping,i=a===void 0?8:a,o=t.dt,c=o===void 0?17:o,l=function(d,f,h){var m=-(d-f)*n,x=h*i,p=h+(m-x)*c/1e3,g=h*c/1e3+d;return Math.abs(g-f)<Rp&&Math.abs(p)<Rp?[f,0]:[g,p]};return l.isStepper=!0,l.dt=c,l},Dme=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return aC(a);case"spring":return Nme();default:if(a.split("(")[0]==="cubic-bezier")return aC(a)}return typeof a=="function"?a:null};function pf(e){"@babel/helpers - typeof";return pf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pf(e)}function iC(e){return Tme(e)||Eme(e)||z6(e)||Sme()}function Sme(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Eme(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Tme(e){if(Array.isArray(e))return W1(e)}function sC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sC(Object(r),!0).forEach(function(n){$1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $1(e,t,r){return t=Cme(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cme(e){var t=Ame(e,"string");return pf(t)==="symbol"?t:String(t)}function Ame(e,t){if(pf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(pf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kme(e,t){return Pme(e)||Ome(e,t)||z6(e,t)||Fme()}function Fme(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function z6(e,t){if(e){if(typeof e=="string")return W1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W1(e,t)}}function W1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ome(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,c=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return c}}function Pme(e){if(Array.isArray(e))return e}var Mp=function(t,r,n){return t+(r-t)*n},z1=function(t){var r=t.from,n=t.to;return r!==n},Ime=function e(t,r,n){var a=Sd(function(i,o){if(z1(o)){var c=t(o.from,o.to,o.velocity),l=kme(c,2),u=l[0],d=l[1];return fn(fn({},o),{},{from:u,velocity:d})}return o},r);return n<1?Sd(function(i,o){return z1(o)?fn(fn({},o),{},{velocity:Mp(o.velocity,a[i].velocity,n),from:Mp(o.from,a[i].from,n)}):o},r):e(t,a,n-1)};const Ume=function(e,t,r,n,a){var i=fme(e,t),o=i.reduce(function(g,v){return fn(fn({},g),{},$1({},v,[e[v],t[v]]))},{}),c=i.reduce(function(g,v){return fn(fn({},g),{},$1({},v,{from:e[v],velocity:0,to:t[v]}))},{}),l=-1,u,d,f=function(){return null},h=function(){return Sd(function(v,y){return y.from},c)},m=function(){return!Object.values(c).filter(z1).length},x=function(v){u||(u=v);var y=v-u,b=y/r.dt;c=Ime(r,c,b),a(fn(fn(fn({},e),t),h())),u=v,m()||(l=requestAnimationFrame(f))},p=function(v){d||(d=v);var y=(v-d)/n,b=Sd(function(w,j){return Mp.apply(void 0,iC(j).concat([r(y)]))},o);if(a(fn(fn(fn({},e),t),b)),y<1)l=requestAnimationFrame(f);else{var _=Sd(function(w,j){return Mp.apply(void 0,iC(j).concat([r(1)]))},o);a(fn(fn(fn({},e),t),_))}};return f=r.isStepper?x:p,function(){return requestAnimationFrame(f),function(){cancelAnimationFrame(l)}}};function Il(e){"@babel/helpers - typeof";return Il=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Il(e)}var Rme=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function Mme(e,t){if(e==null)return{};var r=Bme(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Bme(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function Xv(e){return zme(e)||Wme(e)||$me(e)||Lme()}function Lme(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $me(e,t){if(e){if(typeof e=="string")return q1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return q1(e,t)}}function Wme(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zme(e){if(Array.isArray(e))return q1(e)}function q1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ui(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oC(Object(r),!0).forEach(function(n){xd(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xd(e,t,r){return t=q6(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qme(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hme(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,q6(n.key),n)}}function Vme(e,t,r){return t&&Hme(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function q6(e){var t=Gme(e,"string");return Il(t)==="symbol"?t:String(t)}function Gme(e,t){if(Il(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Il(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xme(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&H1(e,t)}function H1(e,t){return H1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},H1(e,t)}function Kme(e){var t=Yme();return function(){var n=Bp(e),a;if(t){var i=Bp(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return V1(this,a)}}function V1(e,t){if(t&&(Il(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return G1(e)}function G1(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bp(e){return Bp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bp(e)}var Ni=function(e){Xme(r,e);var t=Kme(r);function r(n,a){var i;qme(this,r),i=t.call(this,n,a);var o=i.props,c=o.isActive,l=o.attributeName,u=o.from,d=o.to,f=o.steps,h=o.children,m=o.duration;if(i.handleStyleChange=i.handleStyleChange.bind(G1(i)),i.changeStyle=i.changeStyle.bind(G1(i)),!c||m<=0)return i.state={style:{}},typeof h=="function"&&(i.state={style:d}),V1(i);if(f&&f.length)i.state={style:f[0].style};else if(u){if(typeof h=="function")return i.state={style:u},V1(i);i.state={style:l?xd({},l,u):u}}else i.state={style:{}};return i}return Vme(r,[{key:"componentDidMount",value:function(){var a=this.props,i=a.isActive,o=a.canBegin;this.mounted=!0,!(!i||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var i=this.props,o=i.isActive,c=i.canBegin,l=i.attributeName,u=i.shouldReAnimate,d=i.to,f=i.from,h=this.state.style;if(c){if(!o){var m={style:l?xd({},l,d):d};this.state&&h&&(l&&h[l]!==d||!l&&h!==d)&&this.setState(m);return}if(!(rme(a.to,d)&&a.canBegin&&a.isActive)){var x=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var p=x||u?f:a.to;if(this.state&&h){var g={style:l?xd({},l,p):p};(l&&h[l]!==p||!l&&h!==p)&&this.setState(g)}this.runAnimation(ui(ui({},this.props),{},{from:p,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var i=this,o=a.from,c=a.to,l=a.duration,u=a.easing,d=a.begin,f=a.onAnimationEnd,h=a.onAnimationStart,m=Ume(o,c,Dme(u),l,this.changeStyle),x=function(){i.stopJSAnimation=m()};this.manager.start([h,d,x,l,f])}},{key:"runStepAnimation",value:function(a){var i=this,o=a.steps,c=a.begin,l=a.onAnimationStart,u=o[0],d=u.style,f=u.duration,h=f===void 0?0:f,m=function(p,g,v){if(v===0)return p;var y=g.duration,b=g.easing,_=b===void 0?"ease":b,w=g.style,j=g.properties,N=g.onAnimationEnd,D=v>0?o[v-1]:g,S=j||Object.keys(w);if(typeof _=="function"||_==="spring")return[].concat(Xv(p),[i.runJSAnimation.bind(i,{from:D.style,to:w,duration:y,easing:_}),y]);var T=rC(S,y,_),A=ui(ui(ui({},D.style),w),{},{transition:T});return[].concat(Xv(p),[A,y,N]).filter(hme)};return this.manager.start([l].concat(Xv(o.reduce(m,[d,Math.max(h,c)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=lme());var i=a.begin,o=a.duration,c=a.attributeName,l=a.to,u=a.easing,d=a.onAnimationStart,f=a.onAnimationEnd,h=a.steps,m=a.children,x=this.manager;if(this.unSubscribe=x.subscribe(this.handleStyleChange),typeof u=="function"||typeof m=="function"||u==="spring"){this.runJSAnimation(a);return}if(h.length>1){this.runStepAnimation(a);return}var p=c?xd({},c,l):l,g=rC(Object.keys(p),o,u);x.start([d,i,ui(ui({},p),{},{transition:g}),o,f])}},{key:"render",value:function(){var a=this.props,i=a.children;a.begin;var o=a.duration;a.attributeName,a.easing;var c=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var l=Mme(a,Rme),u=R.Children.count(i),d=this.state.style;if(typeof i=="function")return i(d);if(!c||u===0||o<=0)return i;var f=function(m){var x=m.props,p=x.style,g=p===void 0?{}:p,v=x.className,y=R.cloneElement(m,ui(ui({},l),{},{style:ui(ui({},g),d),className:v}));return y};return u===1?f(R.Children.only(i)):ge.createElement("div",null,R.Children.map(i,function(h){return f(h)}))}}]),r}(R.PureComponent);Ni.displayName="Animate";Ni.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Ni.propTypes={from:kt.oneOfType([kt.object,kt.string]),to:kt.oneOfType([kt.object,kt.string]),attributeName:kt.string,duration:kt.number,begin:kt.number,easing:kt.oneOfType([kt.string,kt.func]),steps:kt.arrayOf(kt.shape({duration:kt.number.isRequired,style:kt.object.isRequired,easing:kt.oneOfType([kt.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),kt.func]),properties:kt.arrayOf("string"),onAnimationEnd:kt.func})),children:kt.oneOfType([kt.node,kt.func]),isActive:kt.bool,canBegin:kt.bool,onAnimationEnd:kt.func,shouldReAnimate:kt.bool,onAnimationStart:kt.func,onAnimationReStart:kt.func};function xf(e){"@babel/helpers - typeof";return xf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xf(e)}function Lp(){return Lp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lp.apply(this,arguments)}function Zme(e,t){return tpe(e)||epe(e,t)||Qme(e,t)||Jme()}function Jme(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qme(e,t){if(e){if(typeof e=="string")return cC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cC(e,t)}}function cC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function epe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,c=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return c}}function tpe(e){if(Array.isArray(e))return e}function lC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function uC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lC(Object(r),!0).forEach(function(n){rpe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rpe(e,t,r){return t=npe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function npe(e){var t=ape(e,"string");return xf(t)=="symbol"?t:t+""}function ape(e,t){if(xf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(xf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dC=function(t,r,n,a,i){var o=Math.min(Math.abs(n)/2,Math.abs(a)/2),c=a>=0?1:-1,l=n>=0?1:-1,u=a>=0&&n>=0||a<0&&n<0?1:0,d;if(o>0&&i instanceof Array){for(var f=[0,0,0,0],h=0,m=4;h<m;h++)f[h]=i[h]>o?o:i[h];d="M".concat(t,",").concat(r+c*f[0]),f[0]>0&&(d+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(u,",").concat(t+l*f[0],",").concat(r)),d+="L ".concat(t+n-l*f[1],",").concat(r),f[1]>0&&(d+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(u,`,
        `).concat(t+n,",").concat(r+c*f[1])),d+="L ".concat(t+n,",").concat(r+a-c*f[2]),f[2]>0&&(d+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(u,`,
        `).concat(t+n-l*f[2],",").concat(r+a)),d+="L ".concat(t+l*f[3],",").concat(r+a),f[3]>0&&(d+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(u,`,
        `).concat(t,",").concat(r+a-c*f[3])),d+="Z"}else if(o>0&&i===+i&&i>0){var x=Math.min(o,i);d="M ".concat(t,",").concat(r+c*x,`
            A `).concat(x,",").concat(x,",0,0,").concat(u,",").concat(t+l*x,",").concat(r,`
            L `).concat(t+n-l*x,",").concat(r,`
            A `).concat(x,",").concat(x,",0,0,").concat(u,",").concat(t+n,",").concat(r+c*x,`
            L `).concat(t+n,",").concat(r+a-c*x,`
            A `).concat(x,",").concat(x,",0,0,").concat(u,",").concat(t+n-l*x,",").concat(r+a,`
            L `).concat(t+l*x,",").concat(r+a,`
            A `).concat(x,",").concat(x,",0,0,").concat(u,",").concat(t,",").concat(r+a-c*x," Z")}else d="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return d},ipe=function(t,r){if(!t||!r)return!1;var n=t.x,a=t.y,i=r.x,o=r.y,c=r.width,l=r.height;if(Math.abs(c)>0&&Math.abs(l)>0){var u=Math.min(i,i+c),d=Math.max(i,i+c),f=Math.min(o,o+l),h=Math.max(o,o+l);return n>=u&&n<=d&&a>=f&&a<=h}return!1},spe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},E_=function(t){var r=uC(uC({},spe),t),n=R.useRef(),a=R.useState(-1),i=Zme(a,2),o=i[0],c=i[1];R.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var _=n.current.getTotalLength();_&&c(_)}catch{}},[]);var l=r.x,u=r.y,d=r.width,f=r.height,h=r.radius,m=r.className,x=r.animationEasing,p=r.animationDuration,g=r.animationBegin,v=r.isAnimationActive,y=r.isUpdateAnimationActive;if(l!==+l||u!==+u||d!==+d||f!==+f||d===0||f===0)return null;var b=dt("recharts-rectangle",m);return y?ge.createElement(Ni,{canBegin:o>0,from:{width:d,height:f,x:l,y:u},to:{width:d,height:f,x:l,y:u},duration:p,animationEasing:x,isActive:y},function(_){var w=_.width,j=_.height,N=_.x,D=_.y;return ge.createElement(Ni,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:g,duration:p,isActive:v,easing:x},ge.createElement("path",Lp({},nt(r,!0),{className:b,d:dC(N,D,w,j,h),ref:n})))}):ge.createElement("path",Lp({},nt(r,!0),{className:b,d:dC(l,u,d,f,h)}))},ope=["points","className","baseLinePoints","connectNulls"];function al(){return al=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},al.apply(this,arguments)}function cpe(e,t){if(e==null)return{};var r=lpe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function lpe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function fC(e){return hpe(e)||fpe(e)||dpe(e)||upe()}function upe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dpe(e,t){if(e){if(typeof e=="string")return X1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return X1(e,t)}}function fpe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hpe(e){if(Array.isArray(e))return X1(e)}function X1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var hC=function(t){return t&&t.x===+t.x&&t.y===+t.y},mpe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(function(n){hC(n)?r[r.length-1].push(n):r[r.length-1].length>0&&r.push([])}),hC(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},Ed=function(t,r){var n=mpe(t);r&&(n=[n.reduce(function(i,o){return[].concat(fC(i),fC(o))},[])]);var a=n.map(function(i){return i.reduce(function(o,c,l){return"".concat(o).concat(l===0?"M":"L").concat(c.x,",").concat(c.y)},"")}).join("");return n.length===1?"".concat(a,"Z"):a},ppe=function(t,r,n){var a=Ed(t,n);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat(Ed(r.reverse(),n).slice(1))},xpe=function(t){var r=t.points,n=t.className,a=t.baseLinePoints,i=t.connectNulls,o=cpe(t,ope);if(!r||!r.length)return null;var c=dt("recharts-polygon",n);if(a&&a.length){var l=o.stroke&&o.stroke!=="none",u=ppe(r,a,i);return ge.createElement("g",{className:c},ge.createElement("path",al({},nt(o,!0),{fill:u.slice(-1)==="Z"?o.fill:"none",stroke:"none",d:u})),l?ge.createElement("path",al({},nt(o,!0),{fill:"none",d:Ed(r,i)})):null,l?ge.createElement("path",al({},nt(o,!0),{fill:"none",d:Ed(a,i)})):null)}var d=Ed(r,i);return ge.createElement("path",al({},nt(o,!0),{fill:d.slice(-1)==="Z"?o.fill:"none",className:c,d}))};function K1(){return K1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},K1.apply(this,arguments)}var Y0=function(t){var r=t.cx,n=t.cy,a=t.r,i=t.className,o=dt("recharts-dot",i);return r===+r&&n===+n&&a===+a?R.createElement("circle",K1({},nt(t,!1),sp(t),{className:o,cx:r,cy:n,r:a})):null};function gf(e){"@babel/helpers - typeof";return gf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gf(e)}var gpe=["x","y","top","left","width","height","className"];function Y1(){return Y1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Y1.apply(this,arguments)}function mC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function vpe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mC(Object(r),!0).forEach(function(n){ype(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ype(e,t,r){return t=bpe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bpe(e){var t=wpe(e,"string");return gf(t)=="symbol"?t:t+""}function wpe(e,t){if(gf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(gf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _pe(e,t){if(e==null)return{};var r=jpe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function jpe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Npe=function(t,r,n,a,i,o){return"M".concat(t,",").concat(i,"v").concat(a,"M").concat(o,",").concat(r,"h").concat(n)},Dpe=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,o=t.top,c=o===void 0?0:o,l=t.left,u=l===void 0?0:l,d=t.width,f=d===void 0?0:d,h=t.height,m=h===void 0?0:h,x=t.className,p=_pe(t,gpe),g=vpe({x:n,y:i,top:c,left:u,width:f,height:m},p);return!Re(n)||!Re(i)||!Re(f)||!Re(m)||!Re(c)||!Re(u)?null:ge.createElement("path",Y1({},nt(g,!0),{className:dt("recharts-cross",x),d:Npe(n,i,f,m,c,u)}))},Spe=H0,Epe=a6,Tpe=Ji;function Cpe(e,t){return e&&e.length?Spe(e,Tpe(t),Epe):void 0}var Ape=Cpe;const kpe=Rt(Ape);var Fpe=H0,Ope=Ji,Ppe=i6;function Ipe(e,t){return e&&e.length?Fpe(e,Ope(t),Ppe):void 0}var Upe=Ipe;const Rpe=Rt(Upe);var Mpe=["cx","cy","angle","ticks","axisLine"],Bpe=["ticks","tick","angle","tickFormatter","stroke"];function Ul(e){"@babel/helpers - typeof";return Ul=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ul(e)}function Td(){return Td=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Td.apply(this,arguments)}function pC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Bo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pC(Object(r),!0).forEach(function(n){Z0(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xC(e,t){if(e==null)return{};var r=Lpe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Lpe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function $pe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gC(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,V6(n.key),n)}}function Wpe(e,t,r){return t&&gC(e.prototype,t),r&&gC(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zpe(e,t,r){return t=$p(t),qpe(e,H6()?Reflect.construct(t,r||[],$p(e).constructor):t.apply(e,r))}function qpe(e,t){if(t&&(Ul(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hpe(e)}function Hpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function H6(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(H6=function(){return!!e})()}function $p(e){return $p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$p(e)}function Vpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z1(e,t)}function Z1(e,t){return Z1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Z1(e,t)}function Z0(e,t,r){return t=V6(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function V6(e){var t=Gpe(e,"string");return Ul(t)=="symbol"?t:t+""}function Gpe(e,t){if(Ul(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ul(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var J0=function(e){function t(){return $pe(this,t),zpe(this,t,arguments)}return Vpe(t,e),Wpe(t,[{key:"getTickValueCoord",value:function(n){var a=n.coordinate,i=this.props,o=i.angle,c=i.cx,l=i.cy;return rr(c,l,a,o)}},{key:"getTickTextAnchor",value:function(){var n=this.props.orientation,a;switch(n){case"left":a="end";break;case"right":a="start";break;default:a="middle";break}return a}},{key:"getViewBox",value:function(){var n=this.props,a=n.cx,i=n.cy,o=n.angle,c=n.ticks,l=kpe(c,function(d){return d.coordinate||0}),u=Rpe(c,function(d){return d.coordinate||0});return{cx:a,cy:i,startAngle:o,endAngle:o,innerRadius:u.coordinate||0,outerRadius:l.coordinate||0}}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,i=n.cy,o=n.angle,c=n.ticks,l=n.axisLine,u=xC(n,Mpe),d=c.reduce(function(x,p){return[Math.min(x[0],p.coordinate),Math.max(x[1],p.coordinate)]},[1/0,-1/0]),f=rr(a,i,d[0],o),h=rr(a,i,d[1],o),m=Bo(Bo(Bo({},nt(u,!1)),{},{fill:"none"},nt(l,!1)),{},{x1:f.x,y1:f.y,x2:h.x,y2:h.y});return ge.createElement("line",Td({className:"recharts-polar-radius-axis-line"},m))}},{key:"renderTicks",value:function(){var n=this,a=this.props,i=a.ticks,o=a.tick,c=a.angle,l=a.tickFormatter,u=a.stroke,d=xC(a,Bpe),f=this.getTickTextAnchor(),h=nt(d,!1),m=nt(o,!1),x=i.map(function(p,g){var v=n.getTickValueCoord(p),y=Bo(Bo(Bo(Bo({textAnchor:f,transform:"rotate(".concat(90-c,", ").concat(v.x,", ").concat(v.y,")")},h),{},{stroke:"none",fill:u},m),{},{index:g},v),{},{payload:p});return ge.createElement(Tt,Td({className:dt("recharts-polar-radius-axis-tick",O6(o)),key:"tick-".concat(p.coordinate)},uo(n.props,p,g)),t.renderTickItem(o,y,l?l(p.value,g):p.value))});return ge.createElement(Tt,{className:"recharts-polar-radius-axis-ticks"},x)}},{key:"render",value:function(){var n=this.props,a=n.ticks,i=n.axisLine,o=n.tick;return!a||!a.length?null:ge.createElement(Tt,{className:dt("recharts-polar-radius-axis",this.props.className)},i&&this.renderAxisLine(),o&&this.renderTicks(),Zr.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(n,a,i){var o;return ge.isValidElement(n)?o=ge.cloneElement(n,a):st(n)?o=n(a):o=ge.createElement(fc,Td({},a,{className:"recharts-polar-radius-axis-tick-value"}),i),o}}])}(R.PureComponent);Z0(J0,"displayName","PolarRadiusAxis");Z0(J0,"axisType","radiusAxis");Z0(J0,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function Rl(e){"@babel/helpers - typeof";return Rl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rl(e)}function Ko(){return Ko=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ko.apply(this,arguments)}function vC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Lo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vC(Object(r),!0).forEach(function(n){Q0(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xpe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yC(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,X6(n.key),n)}}function Kpe(e,t,r){return t&&yC(e.prototype,t),r&&yC(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ype(e,t,r){return t=Wp(t),Zpe(e,G6()?Reflect.construct(t,r||[],Wp(e).constructor):t.apply(e,r))}function Zpe(e,t){if(t&&(Rl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jpe(e)}function Jpe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function G6(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(G6=function(){return!!e})()}function Wp(e){return Wp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wp(e)}function Qpe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&J1(e,t)}function J1(e,t){return J1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},J1(e,t)}function Q0(e,t,r){return t=X6(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X6(e){var t=exe(e,"string");return Rl(t)=="symbol"?t:t+""}function exe(e,t){if(Rl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Rl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var txe=Math.PI/180,bC=1e-5,eg=function(e){function t(){return Xpe(this,t),Ype(this,t,arguments)}return Qpe(t,e),Kpe(t,[{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.cx,o=a.cy,c=a.radius,l=a.orientation,u=a.tickSize,d=u||8,f=rr(i,o,c,n.coordinate),h=rr(i,o,c+(l==="inner"?-1:1)*d,n.coordinate);return{x1:f.x,y1:f.y,x2:h.x,y2:h.y}}},{key:"getTickTextAnchor",value:function(n){var a=this.props.orientation,i=Math.cos(-n.coordinate*txe),o;return i>bC?o=a==="outer"?"start":"end":i<-bC?o=a==="outer"?"end":"start":o="middle",o}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,i=n.cy,o=n.radius,c=n.axisLine,l=n.axisLineType,u=Lo(Lo({},nt(this.props,!1)),{},{fill:"none"},nt(c,!1));if(l==="circle")return ge.createElement(Y0,Ko({className:"recharts-polar-angle-axis-line"},u,{cx:a,cy:i,r:o}));var d=this.props.ticks,f=d.map(function(h){return rr(a,i,o,h.coordinate)});return ge.createElement(xpe,Ko({className:"recharts-polar-angle-axis-line"},u,{points:f}))}},{key:"renderTicks",value:function(){var n=this,a=this.props,i=a.ticks,o=a.tick,c=a.tickLine,l=a.tickFormatter,u=a.stroke,d=nt(this.props,!1),f=nt(o,!1),h=Lo(Lo({},d),{},{fill:"none"},nt(c,!1)),m=i.map(function(x,p){var g=n.getTickLineCoord(x),v=n.getTickTextAnchor(x),y=Lo(Lo(Lo({textAnchor:v},d),{},{stroke:"none",fill:u},f),{},{index:p,payload:x,x:g.x2,y:g.y2});return ge.createElement(Tt,Ko({className:dt("recharts-polar-angle-axis-tick",O6(o)),key:"tick-".concat(x.coordinate)},uo(n.props,x,p)),c&&ge.createElement("line",Ko({className:"recharts-polar-angle-axis-tick-line"},h,g)),o&&t.renderTickItem(o,y,l?l(x.value,p):x.value))});return ge.createElement(Tt,{className:"recharts-polar-angle-axis-ticks"},m)}},{key:"render",value:function(){var n=this.props,a=n.ticks,i=n.radius,o=n.axisLine;return i<=0||!a||!a.length?null:ge.createElement(Tt,{className:dt("recharts-polar-angle-axis",this.props.className)},o&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(n,a,i){var o;return ge.isValidElement(n)?o=ge.cloneElement(n,a):st(n)?o=n(a):o=ge.createElement(fc,Ko({},a,{className:"recharts-polar-angle-axis-tick-value"}),i),o}}])}(R.PureComponent);Q0(eg,"displayName","PolarAngleAxis");Q0(eg,"axisType","angleAxis");Q0(eg,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var rxe=J5,nxe=rxe(Object.getPrototypeOf,Object),T_=nxe,axe=Ps,ixe=T_,sxe=Ci,oxe="[object Object]",cxe=Function.prototype,lxe=Object.prototype,K6=cxe.toString,uxe=lxe.hasOwnProperty,dxe=K6.call(Object);function fxe(e){if(!sxe(e)||axe(e)!=oxe)return!1;var t=ixe(e);if(t===null)return!0;var r=uxe.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&K6.call(r)==dxe}var Y6=fxe;const hxe=Rt(Y6);var mxe=Ps,pxe=Ci,xxe="[object Boolean]";function gxe(e){return e===!0||e===!1||pxe(e)&&mxe(e)==xxe}var vxe=gxe;const yxe=Rt(vxe);function vf(e){"@babel/helpers - typeof";return vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vf(e)}function zp(){return zp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zp.apply(this,arguments)}function bxe(e,t){return Nxe(e)||jxe(e,t)||_xe(e,t)||wxe()}function wxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _xe(e,t){if(e){if(typeof e=="string")return wC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wC(e,t)}}function wC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jxe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,c=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return c}}function Nxe(e){if(Array.isArray(e))return e}function _C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function jC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_C(Object(r),!0).forEach(function(n){Dxe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_C(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Dxe(e,t,r){return t=Sxe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sxe(e){var t=Exe(e,"string");return vf(t)=="symbol"?t:t+""}function Exe(e,t){if(vf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(vf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NC=function(t,r,n,a,i){var o=n-a,c;return c="M ".concat(t,",").concat(r),c+="L ".concat(t+n,",").concat(r),c+="L ".concat(t+n-o/2,",").concat(r+i),c+="L ".concat(t+n-o/2-a,",").concat(r+i),c+="L ".concat(t,",").concat(r," Z"),c},Txe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Cxe=function(t){var r=jC(jC({},Txe),t),n=R.useRef(),a=R.useState(-1),i=bxe(a,2),o=i[0],c=i[1];R.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var b=n.current.getTotalLength();b&&c(b)}catch{}},[]);var l=r.x,u=r.y,d=r.upperWidth,f=r.lowerWidth,h=r.height,m=r.className,x=r.animationEasing,p=r.animationDuration,g=r.animationBegin,v=r.isUpdateAnimationActive;if(l!==+l||u!==+u||d!==+d||f!==+f||h!==+h||d===0&&f===0||h===0)return null;var y=dt("recharts-trapezoid",m);return v?ge.createElement(Ni,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:h,x:l,y:u},to:{upperWidth:d,lowerWidth:f,height:h,x:l,y:u},duration:p,animationEasing:x,isActive:v},function(b){var _=b.upperWidth,w=b.lowerWidth,j=b.height,N=b.x,D=b.y;return ge.createElement(Ni,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:g,duration:p,easing:x},ge.createElement("path",zp({},nt(r,!0),{className:y,d:NC(N,D,_,w,j),ref:n})))}):ge.createElement("g",null,ge.createElement("path",zp({},nt(r,!0),{className:y,d:NC(l,u,d,f,h)})))},Axe=["option","shapeType","propTransformer","activeClassName","isActive"];function yf(e){"@babel/helpers - typeof";return yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yf(e)}function kxe(e,t){if(e==null)return{};var r=Fxe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Fxe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function DC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DC(Object(r),!0).forEach(function(n){Oxe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Oxe(e,t,r){return t=Pxe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pxe(e){var t=Ixe(e,"string");return yf(t)=="symbol"?t:t+""}function Ixe(e,t){if(yf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(yf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Uxe(e,t){return qp(qp({},t),e)}function Rxe(e,t){return e==="symbols"}function SC(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return ge.createElement(E_,r);case"trapezoid":return ge.createElement(Cxe,r);case"sector":return ge.createElement(R6,r);case"symbols":if(Rxe(t))return ge.createElement(Bw,r);break;default:return null}}function Z6(e){return R.isValidElement(e)?e.props:e}function C_(e){var t=e.option,r=e.shapeType,n=e.propTransformer,a=n===void 0?Uxe:n,i=e.activeClassName,o=i===void 0?"recharts-active-shape":i,c=e.isActive,l=kxe(e,Axe),u;if(R.isValidElement(t))u=R.cloneElement(t,qp(qp({},l),Z6(t)));else if(st(t))u=t(l);else if(hxe(t)&&!yxe(t)){var d=a(t,l);u=ge.createElement(SC,{shapeType:r,elementProps:d})}else{var f=l;u=ge.createElement(SC,{shapeType:r,elementProps:f})}return c?ge.createElement(Tt,{className:o},u):u}function tg(e,t){return t!=null&&"trapezoids"in e.props}function rg(e,t){return t!=null&&"sectors"in e.props}function bf(e,t){return t!=null&&"points"in e.props}function Mxe(e,t){var r,n,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,i=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return a&&i}function Bxe(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function Lxe(e,t){var r=e.x===t.x,n=e.y===t.y,a=e.z===t.z;return r&&n&&a}function $xe(e,t){var r;return tg(e,t)?r=Mxe:rg(e,t)?r=Bxe:bf(e,t)&&(r=Lxe),r}function Wxe(e,t){var r;return tg(e,t)?r="trapezoids":rg(e,t)?r="sectors":bf(e,t)&&(r="points"),r}function zxe(e,t){if(tg(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(rg(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return bf(e,t)?t.payload:{}}function qxe(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,a=Wxe(r,t),i=zxe(r,t),o=n.filter(function(l,u){var d=Su(i,l),f=r.props[a].filter(function(x){var p=$xe(r,t);return p(x,t)}),h=r.props[a].indexOf(f[f.length-1]),m=u===h;return d&&m}),c=n.indexOf(o[o.length-1]);return c}var Wm;function Ml(e){"@babel/helpers - typeof";return Ml=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ml(e)}function il(){return il=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},il.apply(this,arguments)}function EC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function er(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EC(Object(r),!0).forEach(function(n){Ya(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Hxe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TC(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Q6(n.key),n)}}function Vxe(e,t,r){return t&&TC(e.prototype,t),r&&TC(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gxe(e,t,r){return t=Hp(t),Xxe(e,J6()?Reflect.construct(t,r||[],Hp(e).constructor):t.apply(e,r))}function Xxe(e,t){if(t&&(Ml(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kxe(e)}function Kxe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function J6(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(J6=function(){return!!e})()}function Hp(e){return Hp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hp(e)}function Yxe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q1(e,t)}function Q1(e,t){return Q1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Q1(e,t)}function Ya(e,t,r){return t=Q6(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q6(e){var t=Zxe(e,"string");return Ml(t)=="symbol"?t:t+""}function Zxe(e,t){if(Ml(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ml(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var si=function(e){function t(r){var n;return Hxe(this,t),n=Gxe(this,t,[r]),Ya(n,"pieRef",null),Ya(n,"sectorRefs",[]),Ya(n,"id",yu("recharts-pie-")),Ya(n,"handleAnimationEnd",function(){var a=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),st(a)&&a()}),Ya(n,"handleAnimationStart",function(){var a=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),st(a)&&a()}),n.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},n}return Yxe(t,e),Vxe(t,[{key:"isActiveIndex",value:function(n){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(n)!==-1:n===a}},{key:"hasActiveIndex",value:function(){var n=this.props.activeIndex;return Array.isArray(n)?n.length!==0:n||n===0}},{key:"renderLabels",value:function(n){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.label,c=i.labelLine,l=i.dataKey,u=i.valueKey,d=nt(this.props,!1),f=nt(o,!1),h=nt(c,!1),m=o&&o.offsetRadius||20,x=n.map(function(p,g){var v=(p.startAngle+p.endAngle)/2,y=rr(p.cx,p.cy,p.outerRadius+m,v),b=er(er(er(er({},d),p),{},{stroke:"none"},f),{},{index:g,textAnchor:t.getTextAnchor(y.x,p.cx)},y),_=er(er(er(er({},d),p),{},{fill:"none",stroke:p.fill},h),{},{index:g,points:[rr(p.cx,p.cy,p.outerRadius,v),y]}),w=l;return ft(l)&&ft(u)?w="value":ft(l)&&(w=u),ge.createElement(Tt,{key:"label-".concat(p.startAngle,"-").concat(p.endAngle,"-").concat(p.midAngle,"-").concat(g)},c&&t.renderLabelLineItem(c,_,"line"),t.renderLabelItem(o,b,vr(p,w)))});return ge.createElement(Tt,{className:"recharts-pie-labels"},x)}},{key:"renderSectorsStatically",value:function(n){var a=this,i=this.props,o=i.activeShape,c=i.blendStroke,l=i.inactiveShape;return n.map(function(u,d){if((u==null?void 0:u.startAngle)===0&&(u==null?void 0:u.endAngle)===0&&n.length!==1)return null;var f=a.isActiveIndex(d),h=l&&a.hasActiveIndex()?l:null,m=f?o:h,x=er(er({},u),{},{stroke:c?u.fill:u.stroke,tabIndex:-1});return ge.createElement(Tt,il({ref:function(g){g&&!a.sectorRefs.includes(g)&&a.sectorRefs.push(g)},tabIndex:-1,className:"recharts-pie-sector"},uo(a.props,u,d),{key:"sector-".concat(u==null?void 0:u.startAngle,"-").concat(u==null?void 0:u.endAngle,"-").concat(u.midAngle,"-").concat(d)}),ge.createElement(C_,il({option:m,isActive:f,shapeType:"sector"},x)))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,a=this.props,i=a.sectors,o=a.isAnimationActive,c=a.animationBegin,l=a.animationDuration,u=a.animationEasing,d=a.animationId,f=this.state,h=f.prevSectors,m=f.prevIsAnimationActive;return ge.createElement(Ni,{begin:c,duration:l,isActive:o,easing:u,from:{t:0},to:{t:1},key:"pie-".concat(d,"-").concat(m),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(x){var p=x.t,g=[],v=i&&i[0],y=v.startAngle;return i.forEach(function(b,_){var w=h&&h[_],j=_>0?Sa(b,"paddingAngle",0):0;if(w){var N=gr(w.endAngle-w.startAngle,b.endAngle-b.startAngle),D=er(er({},b),{},{startAngle:y+j,endAngle:y+N(p)+j});g.push(D),y=D.endAngle}else{var S=b.endAngle,T=b.startAngle,A=gr(0,S-T),E=A(p),M=er(er({},b),{},{startAngle:y+j,endAngle:y+E+j});g.push(M),y=M.endAngle}}),ge.createElement(Tt,null,n.renderSectorsStatically(g))})}},{key:"attachKeyboardHandlers",value:function(n){var a=this;n.onkeydown=function(i){if(!i.altKey)switch(i.key){case"ArrowLeft":{var o=++a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[o].focus(),a.setState({sectorToFocus:o});break}case"ArrowRight":{var c=--a.state.sectorToFocus<0?a.sectorRefs.length-1:a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[c].focus(),a.setState({sectorToFocus:c});break}case"Escape":{a.sectorRefs[a.state.sectorToFocus].blur(),a.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var n=this.props,a=n.sectors,i=n.isAnimationActive,o=this.state.prevSectors;return i&&a&&a.length&&(!o||!Su(o,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var n=this,a=this.props,i=a.hide,o=a.sectors,c=a.className,l=a.label,u=a.cx,d=a.cy,f=a.innerRadius,h=a.outerRadius,m=a.isAnimationActive,x=this.state.isAnimationFinished;if(i||!o||!o.length||!Re(u)||!Re(d)||!Re(f)||!Re(h))return null;var p=dt("recharts-pie",c);return ge.createElement(Tt,{tabIndex:this.props.rootTabIndex,className:p,ref:function(v){n.pieRef=v}},this.renderSectors(),l&&this.renderLabels(o),Zr.renderCallByParent(this.props,null,!1),(!m||x)&&wi.renderCallByParent(this.props,o,!1))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return a.prevIsAnimationActive!==n.isAnimationActive?{prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:[],isAnimationFinished:!0}:n.isAnimationActive&&n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:a.curSectors,isAnimationFinished:!0}:n.sectors!==a.curSectors?{curSectors:n.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(n,a){return n>a?"start":n<a?"end":"middle"}},{key:"renderLabelLineItem",value:function(n,a,i){if(ge.isValidElement(n))return ge.cloneElement(n,a);if(st(n))return n(a);var o=dt("recharts-pie-label-line",typeof n!="boolean"?n.className:"");return ge.createElement(Up,il({},a,{key:i,type:"linear",className:o}))}},{key:"renderLabelItem",value:function(n,a,i){if(ge.isValidElement(n))return ge.cloneElement(n,a);var o=i;if(st(n)&&(o=n(a),ge.isValidElement(o)))return o;var c=dt("recharts-pie-label-text",typeof n!="boolean"&&!st(n)?n.className:"");return ge.createElement(fc,il({},a,{alignmentBaseline:"middle",className:c}),o)}}])}(R.PureComponent);Wm=si;Ya(si,"displayName","Pie");Ya(si,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!bo.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Ya(si,"parseDeltaAngle",function(e,t){var r=qn(t-e),n=Math.min(Math.abs(t-e),360);return r*n});Ya(si,"getRealPieData",function(e){var t=e.data,r=e.children,n=nt(e,!1),a=sa(r,Ns);return t&&t.length?t.map(function(i,o){return er(er(er({payload:i},n),i),a&&a[o]&&a[o].props)}):a&&a.length?a.map(function(i){return er(er({},n),i.props)}):[]});Ya(si,"parseCoordinateOfPie",function(e,t){var r=t.top,n=t.left,a=t.width,i=t.height,o=F6(a,i),c=n+Hn(e.cx,a,a/2),l=r+Hn(e.cy,i,i/2),u=Hn(e.innerRadius,o,0),d=Hn(e.outerRadius,o,o*.8),f=e.maxRadius||Math.sqrt(a*a+i*i)/2;return{cx:c,cy:l,innerRadius:u,outerRadius:d,maxRadius:f}});Ya(si,"getComposedData",function(e){var t=e.item,r=e.offset,n=t.type.defaultProps!==void 0?er(er({},t.type.defaultProps),t.props):t.props,a=Wm.getRealPieData(n);if(!a||!a.length)return null;var i=n.cornerRadius,o=n.startAngle,c=n.endAngle,l=n.paddingAngle,u=n.dataKey,d=n.nameKey,f=n.valueKey,h=n.tooltipType,m=Math.abs(n.minAngle),x=Wm.parseCoordinateOfPie(n,r),p=Wm.parseDeltaAngle(o,c),g=Math.abs(p),v=u;ft(u)&&ft(f)?(bi(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),v="value"):ft(u)&&(bi(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),v=f);var y=a.filter(function(D){return vr(D,v,0)!==0}).length,b=(g>=360?y:y-1)*l,_=g-y*m-b,w=a.reduce(function(D,S){var T=vr(S,v,0);return D+(Re(T)?T:0)},0),j;if(w>0){var N;j=a.map(function(D,S){var T=vr(D,v,0),A=vr(D,d,S),E=(Re(T)?T:0)/w,M;S?M=N.endAngle+qn(p)*l*(T!==0?1:0):M=o;var P=M+qn(p)*((T!==0?m:0)+E*_),X=(M+P)/2,q=(x.innerRadius+x.outerRadius)/2,B=[{name:A,value:T,payload:D,dataKey:v,type:h}],O=rr(x.cx,x.cy,q,X);return N=er(er(er({percent:E,cornerRadius:i,name:A,tooltipPayload:B,midAngle:X,middleRadius:q,tooltipPosition:O},D),x),{},{value:vr(D,v),startAngle:M,endAngle:P,payload:D,paddingAngle:qn(p)*l}),N})}return er(er({},x),{},{sectors:j,data:a})});var Jxe=Math.ceil,Qxe=Math.max;function e0e(e,t,r,n){for(var a=-1,i=Qxe(Jxe((t-e)/(r||1)),0),o=Array(i);i--;)o[n?i:++a]=e,e+=r;return o}var t0e=e0e,r0e=yP,CC=1/0,n0e=17976931348623157e292;function a0e(e){if(!e)return e===0?e:0;if(e=r0e(e),e===CC||e===-CC){var t=e<0?-1:1;return t*n0e}return e===e?e:0}var e8=a0e,i0e=t0e,s0e=M0,Kv=e8;function o0e(e){return function(t,r,n){return n&&typeof n!="number"&&s0e(t,r,n)&&(r=n=void 0),t=Kv(t),r===void 0?(r=t,t=0):r=Kv(r),n=n===void 0?t<r?1:-1:Kv(n),i0e(t,r,n,e)}}var c0e=o0e,l0e=c0e,u0e=l0e(),d0e=u0e;const Vp=Rt(d0e);function wf(e){"@babel/helpers - typeof";return wf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wf(e)}function AC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function kC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AC(Object(r),!0).forEach(function(n){t8(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function t8(e,t,r){return t=f0e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f0e(e){var t=h0e(e,"string");return wf(t)=="symbol"?t:t+""}function h0e(e,t){if(wf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(wf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var m0e=["Webkit","Moz","O","ms"],p0e=function(t,r){var n=t.replace(/(\w)/,function(i){return i.toUpperCase()}),a=m0e.reduce(function(i,o){return kC(kC({},i),{},t8({},o+n,r))},{});return a[t]=r,a};function Bl(e){"@babel/helpers - typeof";return Bl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bl(e)}function Gp(){return Gp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gp.apply(this,arguments)}function FC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Yv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FC(Object(r),!0).forEach(function(n){ga(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function x0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OC(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n8(n.key),n)}}function g0e(e,t,r){return t&&OC(e.prototype,t),r&&OC(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function v0e(e,t,r){return t=Xp(t),y0e(e,r8()?Reflect.construct(t,r||[],Xp(e).constructor):t.apply(e,r))}function y0e(e,t){if(t&&(Bl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return b0e(e)}function b0e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function r8(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(r8=function(){return!!e})()}function Xp(e){return Xp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xp(e)}function w0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&e2(e,t)}function e2(e,t){return e2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},e2(e,t)}function ga(e,t,r){return t=n8(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n8(e){var t=_0e(e,"string");return Bl(t)=="symbol"?t:t+""}function _0e(e,t){if(Bl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Bl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var j0e=function(t){var r=t.data,n=t.startIndex,a=t.endIndex,i=t.x,o=t.width,c=t.travellerWidth;if(!r||!r.length)return{};var l=r.length,u=Nd().domain(Vp(0,l)).range([i,i+o-c]),d=u.domain().map(function(f){return u(f)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:u(n),endX:u(a),scale:u,scaleValues:d}},PC=function(t){return t.changedTouches&&!!t.changedTouches.length},Ll=function(e){function t(r){var n;return x0e(this,t),n=v0e(this,t,[r]),ga(n,"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),ga(n,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),ga(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,i=a.endIndex,o=a.onDragEnd,c=a.startIndex;o==null||o({endIndex:i,startIndex:c})}),n.detachDragEndListener()}),ga(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),ga(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),ga(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),ga(n,"handleSlideDragStart",function(a){var i=PC(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return w0e(t,e),g0e(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,i=n.endX,o=this.state.scaleValues,c=this.props,l=c.gap,u=c.data,d=u.length-1,f=Math.min(a,i),h=Math.max(a,i),m=t.getIndexInRange(o,f),x=t.getIndexInRange(o,h);return{startIndex:m-m%l,endIndex:x===d?d:x-x%l}}},{key:"getTextOfTick",value:function(n){var a=this.props,i=a.data,o=a.tickFormatter,c=a.dataKey,l=vr(i[n],c,n);return st(o)?o(l,n):l}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,i=a.slideMoveStartX,o=a.startX,c=a.endX,l=this.props,u=l.x,d=l.width,f=l.travellerWidth,h=l.startIndex,m=l.endIndex,x=l.onChange,p=n.pageX-i;p>0?p=Math.min(p,u+d-f-c,u+d-f-o):p<0&&(p=Math.max(p,u-o,u-c));var g=this.getIndex({startX:o+p,endX:c+p});(g.startIndex!==h||g.endIndex!==m)&&x&&x(g),this.setState({startX:o+p,endX:c+p,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var i=PC(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,i=a.brushMoveStartX,o=a.movingTravellerId,c=a.endX,l=a.startX,u=this.state[o],d=this.props,f=d.x,h=d.width,m=d.travellerWidth,x=d.onChange,p=d.gap,g=d.data,v={startX:this.state.startX,endX:this.state.endX},y=n.pageX-i;y>0?y=Math.min(y,f+h-m-u):y<0&&(y=Math.max(y,f-u)),v[o]=u+y;var b=this.getIndex(v),_=b.startIndex,w=b.endIndex,j=function(){var D=g.length-1;return o==="startX"&&(c>l?_%p===0:w%p===0)||c<l&&w===D||o==="endX"&&(c>l?w%p===0:_%p===0)||c>l&&w===D};this.setState(ga(ga({},o,u+y),"brushMoveStartX",n.pageX),function(){x&&j()&&x(b)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var i=this,o=this.state,c=o.scaleValues,l=o.startX,u=o.endX,d=this.state[a],f=c.indexOf(d);if(f!==-1){var h=f+n;if(!(h===-1||h>=c.length)){var m=c[h];a==="startX"&&m>=u||a==="endX"&&m<=l||this.setState(ga({},a,m),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,c=n.height,l=n.fill,u=n.stroke;return ge.createElement("rect",{stroke:u,fill:l,x:a,y:i,width:o,height:c})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,c=n.height,l=n.data,u=n.children,d=n.padding,f=R.Children.only(u);return f?ge.cloneElement(f,{x:a,y:i,width:o,height:c,margin:d,compact:!0,data:l}):null}},{key:"renderTravellerLayer",value:function(n,a){var i,o,c=this,l=this.props,u=l.y,d=l.travellerWidth,f=l.height,h=l.traveller,m=l.ariaLabel,x=l.data,p=l.startIndex,g=l.endIndex,v=Math.max(n,this.props.x),y=Yv(Yv({},nt(this.props,!1)),{},{x:v,y:u,width:d,height:f}),b=m||"Min value: ".concat((i=x[p])===null||i===void 0?void 0:i.name,", Max value: ").concat((o=x[g])===null||o===void 0?void 0:o.name);return ge.createElement(Tt,{tabIndex:0,role:"slider","aria-label":b,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(w){["ArrowLeft","ArrowRight"].includes(w.key)&&(w.preventDefault(),w.stopPropagation(),c.handleTravellerMoveKeyboard(w.key==="ArrowRight"?1:-1,a))},onFocus:function(){c.setState({isTravellerFocused:!0})},onBlur:function(){c.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(h,y))}},{key:"renderSlide",value:function(n,a){var i=this.props,o=i.y,c=i.height,l=i.stroke,u=i.travellerWidth,d=Math.min(n,a)+u,f=Math.max(Math.abs(a-n)-u,0);return ge.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:l,fillOpacity:.2,x:d,y:o,width:f,height:c})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,i=n.endIndex,o=n.y,c=n.height,l=n.travellerWidth,u=n.stroke,d=this.state,f=d.startX,h=d.endX,m=5,x={pointerEvents:"none",fill:u};return ge.createElement(Tt,{className:"recharts-brush-texts"},ge.createElement(fc,Gp({textAnchor:"end",verticalAnchor:"middle",x:Math.min(f,h)-m,y:o+c/2},x),this.getTextOfTick(a)),ge.createElement(fc,Gp({textAnchor:"start",verticalAnchor:"middle",x:Math.max(f,h)+l+m,y:o+c/2},x),this.getTextOfTick(i)))}},{key:"render",value:function(){var n=this.props,a=n.data,i=n.className,o=n.children,c=n.x,l=n.y,u=n.width,d=n.height,f=n.alwaysShowText,h=this.state,m=h.startX,x=h.endX,p=h.isTextActive,g=h.isSlideMoving,v=h.isTravellerMoving,y=h.isTravellerFocused;if(!a||!a.length||!Re(c)||!Re(l)||!Re(u)||!Re(d)||u<=0||d<=0)return null;var b=dt("recharts-brush",i),_=ge.Children.count(o)===1,w=p0e("userSelect","none");return ge.createElement(Tt,{className:b,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:w},this.renderBackground(),_&&this.renderPanorama(),this.renderSlide(m,x),this.renderTravellerLayer(m,"startX"),this.renderTravellerLayer(x,"endX"),(p||g||v||y||f)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,i=n.y,o=n.width,c=n.height,l=n.stroke,u=Math.floor(i+c/2)-1;return ge.createElement(ge.Fragment,null,ge.createElement("rect",{x:a,y:i,width:o,height:c,fill:l,stroke:"none"}),ge.createElement("line",{x1:a+1,y1:u,x2:a+o-1,y2:u,fill:"none",stroke:"#fff"}),ge.createElement("line",{x1:a+1,y1:u+2,x2:a+o-1,y2:u+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var i;return ge.isValidElement(n)?i=ge.cloneElement(n,a):st(n)?i=n(a):i=t.renderDefaultTraveller(a),i}},{key:"getDerivedStateFromProps",value:function(n,a){var i=n.data,o=n.width,c=n.x,l=n.travellerWidth,u=n.updateId,d=n.startIndex,f=n.endIndex;if(i!==a.prevData||u!==a.prevUpdateId)return Yv({prevData:i,prevTravellerWidth:l,prevUpdateId:u,prevX:c,prevWidth:o},i&&i.length?j0e({data:i,width:o,x:c,travellerWidth:l,startIndex:d,endIndex:f}):{scale:null,scaleValues:null});if(a.scale&&(o!==a.prevWidth||c!==a.prevX||l!==a.prevTravellerWidth)){a.scale.range([c,c+o-l]);var h=a.scale.domain().map(function(m){return a.scale(m)});return{prevData:i,prevTravellerWidth:l,prevUpdateId:u,prevX:c,prevWidth:o,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:h}}return null}},{key:"getIndexInRange",value:function(n,a){for(var i=n.length,o=0,c=i-1;c-o>1;){var l=Math.floor((o+c)/2);n[l]>a?c=l:o=l}return a>=n[c]?c:o}}])}(R.PureComponent);ga(Ll,"displayName","Brush");ga(Ll,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var N0e=Qw;function D0e(e,t){var r;return N0e(e,function(n,a,i){return r=t(n,a,i),!r}),!!r}var S0e=D0e,E0e=z5,T0e=Ji,C0e=S0e,A0e=Kn,k0e=M0;function F0e(e,t,r){var n=A0e(e)?E0e:C0e;return r&&k0e(e,t,r)&&(t=void 0),n(e,T0e(t))}var O0e=F0e;const P0e=Rt(O0e);var qi=function(t,r){var n=t.alwaysShow,a=t.ifOverflow;return n&&(a="extendDomain"),a===r},IC=hP;function I0e(e,t,r){t=="__proto__"&&IC?IC(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var A_=I0e,U0e=A_,R0e=uP,M0e=Ji;function B0e(e,t){var r={};return t=M0e(t),R0e(e,function(n,a,i){U0e(r,a,t(n,a,i))}),r}var L0e=B0e;const $0e=Rt(L0e);function W0e(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var z0e=W0e,q0e=Qw;function H0e(e,t){var r=!0;return q0e(e,function(n,a,i){return r=!!t(n,a,i),r}),r}var V0e=H0e,G0e=z0e,X0e=V0e,K0e=Ji,Y0e=Kn,Z0e=M0;function J0e(e,t,r){var n=Y0e(e)?G0e:X0e;return r&&Z0e(e,t,r)&&(t=void 0),n(e,K0e(t))}var Q0e=J0e;const a8=Rt(Q0e);var ege=["x","y"];function _f(e){"@babel/helpers - typeof";return _f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_f(e)}function t2(){return t2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},t2.apply(this,arguments)}function UC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ad(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?UC(Object(r),!0).forEach(function(n){tge(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):UC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tge(e,t,r){return t=rge(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rge(e){var t=nge(e,"string");return _f(t)=="symbol"?t:t+""}function nge(e,t){if(_f(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(_f(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function age(e,t){if(e==null)return{};var r=ige(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ige(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function sge(e,t){var r=e.x,n=e.y,a=age(e,ege),i="".concat(r),o=parseInt(i,10),c="".concat(n),l=parseInt(c,10),u="".concat(t.height||a.height),d=parseInt(u,10),f="".concat(t.width||a.width),h=parseInt(f,10);return ad(ad(ad(ad(ad({},t),a),o?{x:o}:{}),l?{y:l}:{}),{},{height:d,width:h,name:t.name,radius:t.radius})}function RC(e){return ge.createElement(C_,t2({shapeType:"rectangle",propTransformer:sge,activeClassName:"recharts-active-bar"},e))}var oge=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,a){if(typeof t=="number")return t;var i=Re(n)||tZ(n);return i?t(n,a):(i||oo(),r)}},cge=["value","background"],i8;function $l(e){"@babel/helpers - typeof";return $l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$l(e)}function lge(e,t){if(e==null)return{};var r=uge(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function uge(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Kp(){return Kp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Kp.apply(this,arguments)}function MC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ir(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?MC(Object(r),!0).forEach(function(n){Ys(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):MC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BC(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o8(n.key),n)}}function fge(e,t,r){return t&&BC(e.prototype,t),r&&BC(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hge(e,t,r){return t=Yp(t),mge(e,s8()?Reflect.construct(t,r||[],Yp(e).constructor):t.apply(e,r))}function mge(e,t){if(t&&($l(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pge(e)}function pge(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s8(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(s8=function(){return!!e})()}function Yp(e){return Yp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Yp(e)}function xge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r2(e,t)}function r2(e,t){return r2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},r2(e,t)}function Ys(e,t,r){return t=o8(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o8(e){var t=gge(e,"string");return $l(t)=="symbol"?t:t+""}function gge(e,t){if($l(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if($l(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Ea=function(e){function t(){var r;dge(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=hge(this,t,[].concat(a)),Ys(r,"state",{isAnimationFinished:!1}),Ys(r,"id",yu("recharts-bar-")),Ys(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),o&&o()}),Ys(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),o&&o()}),r}return xge(t,e),fge(t,[{key:"renderRectanglesStatically",value:function(n){var a=this,i=this.props,o=i.shape,c=i.dataKey,l=i.activeIndex,u=i.activeBar,d=nt(this.props,!1);return n&&n.map(function(f,h){var m=h===l,x=m?u:o,p=Ir(Ir(Ir({},d),f),{},{isActive:m,option:x,index:h,dataKey:c,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return ge.createElement(Tt,Kp({className:"recharts-bar-rectangle"},uo(a.props,f,h),{key:"rectangle-".concat(f==null?void 0:f.x,"-").concat(f==null?void 0:f.y,"-").concat(f==null?void 0:f.value,"-").concat(h)}),ge.createElement(RC,p))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,a=this.props,i=a.data,o=a.layout,c=a.isAnimationActive,l=a.animationBegin,u=a.animationDuration,d=a.animationEasing,f=a.animationId,h=this.state.prevData;return ge.createElement(Ni,{begin:l,duration:u,isActive:c,easing:d,from:{t:0},to:{t:1},key:"bar-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(m){var x=m.t,p=i.map(function(g,v){var y=h&&h[v];if(y){var b=gr(y.x,g.x),_=gr(y.y,g.y),w=gr(y.width,g.width),j=gr(y.height,g.height);return Ir(Ir({},g),{},{x:b(x),y:_(x),width:w(x),height:j(x)})}if(o==="horizontal"){var N=gr(0,g.height),D=N(x);return Ir(Ir({},g),{},{y:g.y+g.height-D,height:D})}var S=gr(0,g.width),T=S(x);return Ir(Ir({},g),{},{width:T})});return ge.createElement(Tt,null,n.renderRectanglesStatically(p))})}},{key:"renderRectangles",value:function(){var n=this.props,a=n.data,i=n.isAnimationActive,o=this.state.prevData;return i&&a&&a.length&&(!o||!Su(o,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var n=this,a=this.props,i=a.data,o=a.dataKey,c=a.activeIndex,l=nt(this.props.background,!1);return i.map(function(u,d){u.value;var f=u.background,h=lge(u,cge);if(!f)return null;var m=Ir(Ir(Ir(Ir(Ir({},h),{},{fill:"#eee"},f),l),uo(n.props,u,d)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:o,index:d,className:"recharts-bar-background-rectangle"});return ge.createElement(RC,Kp({key:"background-bar-".concat(d),option:n.props.background,isActive:d===c},m))})}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.data,c=i.xAxis,l=i.yAxis,u=i.layout,d=i.children,f=sa(d,Eh);if(!f)return null;var h=u==="vertical"?o[0].height/2:o[0].width/2,m=function(g,v){var y=Array.isArray(g.value)?g.value[1]:g.value;return{x:g.x,y:g.y,value:y,errorVal:vr(g,v)}},x={clipPath:n?"url(#clipPath-".concat(a,")"):null};return ge.createElement(Tt,x,f.map(function(p){return ge.cloneElement(p,{key:"error-bar-".concat(a,"-").concat(p.props.dataKey),data:o,xAxis:c,yAxis:l,layout:u,offset:h,dataPointFormatter:m})}))}},{key:"render",value:function(){var n=this.props,a=n.hide,i=n.data,o=n.className,c=n.xAxis,l=n.yAxis,u=n.left,d=n.top,f=n.width,h=n.height,m=n.isAnimationActive,x=n.background,p=n.id;if(a||!i||!i.length)return null;var g=this.state.isAnimationFinished,v=dt("recharts-bar",o),y=c&&c.allowDataOverflow,b=l&&l.allowDataOverflow,_=y||b,w=ft(p)?this.id:p;return ge.createElement(Tt,{className:v},y||b?ge.createElement("defs",null,ge.createElement("clipPath",{id:"clipPath-".concat(w)},ge.createElement("rect",{x:y?u:u-f/2,y:b?d:d-h/2,width:y?f:f*2,height:b?h:h*2}))):null,ge.createElement(Tt,{className:"recharts-bar-rectangles",clipPath:_?"url(#clipPath-".concat(w,")"):null},x?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(_,w),(!m||g)&&wi.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(R.PureComponent);i8=Ea;Ys(Ea,"displayName","Bar");Ys(Ea,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!bo.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Ys(Ea,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,a=e.bandSize,i=e.xAxis,o=e.yAxis,c=e.xAxisTicks,l=e.yAxisTicks,u=e.stackedData,d=e.dataStartIndex,f=e.displayedData,h=e.offset,m=ofe(n,r);if(!m)return null;var x=t.layout,p=r.type.defaultProps,g=p!==void 0?Ir(Ir({},p),r.props):r.props,v=g.dataKey,y=g.children,b=g.minPointSize,_=x==="horizontal"?o:i,w=u?_.scale.domain():null,j=mfe({numericAxis:_}),N=sa(y,Ns),D=f.map(function(S,T){var A,E,M,P,X,q;u?A=cfe(u[d+T],w):(A=vr(S,v),Array.isArray(A)||(A=[j,A]));var B=oge(b,i8.defaultProps.minPointSize)(A[1],T);if(x==="horizontal"){var O,F=[o.scale(A[0]),o.scale(A[1])],I=F[0],L=F[1];E=TT({axis:i,ticks:c,bandSize:a,offset:m.offset,entry:S,index:T}),M=(O=L??I)!==null&&O!==void 0?O:void 0,P=m.size;var C=I-L;if(X=Number.isNaN(C)?0:C,q={x:E,y:o.y,width:P,height:o.height},Math.abs(B)>0&&Math.abs(X)<Math.abs(B)){var k=qn(X||B)*(Math.abs(B)-Math.abs(X));M-=k,X+=k}}else{var z=[i.scale(A[0]),i.scale(A[1])],V=z[0],Z=z[1];if(E=V,M=TT({axis:o,ticks:l,bandSize:a,offset:m.offset,entry:S,index:T}),P=Z-V,X=m.size,q={x:i.x,y:M,width:i.width,height:X},Math.abs(B)>0&&Math.abs(P)<Math.abs(B)){var ce=qn(P||B)*(Math.abs(B)-Math.abs(P));P+=ce}}return Ir(Ir(Ir({},S),{},{x:E,y:M,width:P,height:X,value:u?A:A[1],payload:S,background:q},N&&N[T]&&N[T].props),{},{tooltipPayload:[A6(r,S)],tooltipPosition:{x:E+P/2,y:M+X/2}})});return Ir({data:D,layout:x},h)});function jf(e){"@babel/helpers - typeof";return jf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jf(e)}function vge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LC(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c8(n.key),n)}}function yge(e,t,r){return t&&LC(e.prototype,t),r&&LC(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$C(Object(r),!0).forEach(function(n){ng(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$C(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ng(e,t,r){return t=c8(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c8(e){var t=bge(e,"string");return jf(t)=="symbol"?t:t+""}function bge(e,t){if(jf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(jf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var l8=function(t,r,n,a,i){var o=t.width,c=t.height,l=t.layout,u=t.children,d=Object.keys(r),f={left:n.left,leftMirror:n.left,right:o-n.right,rightMirror:o-n.right,top:n.top,topMirror:n.top,bottom:c-n.bottom,bottomMirror:c-n.bottom},h=!!va(u,Ea);return d.reduce(function(m,x){var p=r[x],g=p.orientation,v=p.domain,y=p.padding,b=y===void 0?{}:y,_=p.mirror,w=p.reversed,j="".concat(g).concat(_?"Mirror":""),N,D,S,T,A;if(p.type==="number"&&(p.padding==="gap"||p.padding==="no-gap")){var E=v[1]-v[0],M=1/0,P=p.categoricalDomain.sort(aZ);if(P.forEach(function(z,V){V>0&&(M=Math.min((z||0)-(P[V-1]||0),M))}),Number.isFinite(M)){var X=M/E,q=p.layout==="vertical"?n.height:n.width;if(p.padding==="gap"&&(N=X*q/2),p.padding==="no-gap"){var B=Hn(t.barCategoryGap,X*q),O=X*q/2;N=O-B-(O-B)/q*B}}}a==="xAxis"?D=[n.left+(b.left||0)+(N||0),n.left+n.width-(b.right||0)-(N||0)]:a==="yAxis"?D=l==="horizontal"?[n.top+n.height-(b.bottom||0),n.top+(b.top||0)]:[n.top+(b.top||0)+(N||0),n.top+n.height-(b.bottom||0)-(N||0)]:D=p.range,w&&(D=[D[1],D[0]]);var F=S6(p,i,h),I=F.scale,L=F.realScaleType;I.domain(v).range(D),E6(I);var C=T6(I,fi(fi({},p),{},{realScaleType:L}));a==="xAxis"?(A=g==="top"&&!_||g==="bottom"&&_,S=n.left,T=f[j]-A*p.height):a==="yAxis"&&(A=g==="left"&&!_||g==="right"&&_,S=f[j]-A*p.width,T=n.top);var k=fi(fi(fi({},p),C),{},{realScaleType:L,x:S,y:T,scale:I,width:a==="xAxis"?n.width:p.width,height:a==="yAxis"?n.height:p.height});return k.bandSize=Op(k,C),!p.hide&&a==="xAxis"?f[j]+=(A?-1:1)*k.height:p.hide||(f[j]+=(A?-1:1)*k.width),fi(fi({},m),{},ng({},x,k))},{})},u8=function(t,r){var n=t.x,a=t.y,i=r.x,o=r.y;return{x:Math.min(n,i),y:Math.min(a,o),width:Math.abs(i-n),height:Math.abs(o-a)}},wge=function(t){var r=t.x1,n=t.y1,a=t.x2,i=t.y2;return u8({x:r,y:n},{x:a,y:i})},d8=function(){function e(t){vge(this,e),this.scale=t}return yge(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,i=n.position;if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+o}case"end":{var c=this.bandwidth?this.bandwidth():0;return this.scale(r)+c}default:return this.scale(r)}if(a){var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+l}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),a=n[0],i=n[n.length-1];return a<=i?r>=a&&r<=i:r>=i&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}])}();ng(d8,"EPS",1e-4);var k_=function(t){var r=Object.keys(t).reduce(function(n,a){return fi(fi({},n),{},ng({},a,d8.create(t[a])))},{});return fi(fi({},r),{},{apply:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.bandAware,c=i.position;return $0e(a,function(l,u){return r[u].apply(l,{bandAware:o,position:c})})},isInRange:function(a){return a8(a,function(i,o){return r[o].isInRange(i)})}})};function _ge(e){return(e%180+180)%180}var jge=function(t){var r=t.width,n=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=_ge(a),o=i*Math.PI/180,c=Math.atan(n/r),l=o>c&&o<Math.PI-c?n/Math.sin(o):r/Math.cos(o);return Math.abs(l)},Nge=Ji,Dge=wu,Sge=_u;function Ege(e){return function(t,r,n){var a=Object(t);if(!Dge(t)){var i=Nge(r);t=Sge(t),r=function(c){return i(a[c],c,a)}}var o=e(t,r,n);return o>-1?a[i?t[o]:o]:void 0}}var Tge=Ege,Cge=e8;function Age(e){var t=Cge(e),r=t%1;return t===t?r?t-r:t:0}var kge=Age,Fge=iP,Oge=Ji,Pge=kge,Ige=Math.max;function Uge(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=r==null?0:Pge(r);return a<0&&(a=Ige(n+a,0)),Fge(e,Oge(t),a)}var Rge=Uge,Mge=Tge,Bge=Rge,Lge=Mge(Bge),$ge=Lge;const Wge=Rt($ge);var zge=cY(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),F_=R.createContext(void 0),O_=R.createContext(void 0),f8=R.createContext(void 0),h8=R.createContext({}),m8=R.createContext(void 0),p8=R.createContext(0),x8=R.createContext(0),WC=function(t){var r=t.state,n=r.xAxisMap,a=r.yAxisMap,i=r.offset,o=t.clipPathId,c=t.children,l=t.width,u=t.height,d=zge(i);return ge.createElement(F_.Provider,{value:n},ge.createElement(O_.Provider,{value:a},ge.createElement(h8.Provider,{value:i},ge.createElement(f8.Provider,{value:d},ge.createElement(m8.Provider,{value:o},ge.createElement(p8.Provider,{value:u},ge.createElement(x8.Provider,{value:l},c)))))))},qge=function(){return R.useContext(m8)},g8=function(t){var r=R.useContext(F_);r==null&&oo();var n=r[t];return n==null&&oo(),n},Hge=function(){var t=R.useContext(F_);return Ks(t)},Vge=function(){var t=R.useContext(O_),r=Wge(t,function(n){return a8(n.domain,Number.isFinite)});return r||Ks(t)},v8=function(t){var r=R.useContext(O_);r==null&&oo();var n=r[t];return n==null&&oo(),n},Gge=function(){var t=R.useContext(f8);return t},Xge=function(){return R.useContext(h8)},P_=function(){return R.useContext(x8)},I_=function(){return R.useContext(p8)};function Wl(e){"@babel/helpers - typeof";return Wl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wl(e)}function Kge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yge(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b8(n.key),n)}}function Zge(e,t,r){return t&&Yge(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jge(e,t,r){return t=Zp(t),Qge(e,y8()?Reflect.construct(t,r||[],Zp(e).constructor):t.apply(e,r))}function Qge(e,t){if(t&&(Wl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eve(e)}function eve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y8(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(y8=function(){return!!e})()}function Zp(e){return Zp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zp(e)}function tve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n2(e,t)}function n2(e,t){return n2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},n2(e,t)}function zC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zC(Object(r),!0).forEach(function(n){U_(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function U_(e,t,r){return t=b8(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b8(e){var t=rve(e,"string");return Wl(t)=="symbol"?t:t+""}function rve(e,t){if(Wl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Wl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function nve(e,t){return ove(e)||sve(e,t)||ive(e,t)||ave()}function ave(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ive(e,t){if(e){if(typeof e=="string")return HC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HC(e,t)}}function HC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sve(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,c=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return c}}function ove(e){if(Array.isArray(e))return e}function a2(){return a2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a2.apply(this,arguments)}var cve=function(t,r){var n;return ge.isValidElement(t)?n=ge.cloneElement(t,r):st(t)?n=t(r):n=ge.createElement("line",a2({},r,{className:"recharts-reference-line-line"})),n},lve=function(t,r,n,a,i,o,c,l,u){var d=i.x,f=i.y,h=i.width,m=i.height;if(n){var x=u.y,p=t.y.apply(x,{position:o});if(qi(u,"discard")&&!t.y.isInRange(p))return null;var g=[{x:d+h,y:p},{x:d,y:p}];return l==="left"?g.reverse():g}if(r){var v=u.x,y=t.x.apply(v,{position:o});if(qi(u,"discard")&&!t.x.isInRange(y))return null;var b=[{x:y,y:f+m},{x:y,y:f}];return c==="top"?b.reverse():b}if(a){var _=u.segment,w=_.map(function(j){return t.apply(j,{position:o})});return qi(u,"discard")&&P0e(w,function(j){return!t.isInRange(j)})?null:w}return null};function uve(e){var t=e.x,r=e.y,n=e.segment,a=e.xAxisId,i=e.yAxisId,o=e.shape,c=e.className,l=e.alwaysShow,u=qge(),d=g8(a),f=v8(i),h=Gge();if(!u||!h)return null;bi(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var m=k_({x:d.scale,y:f.scale}),x=Hr(t),p=Hr(r),g=n&&n.length===2,v=lve(m,x,p,g,h,e.position,d.orientation,f.orientation,e);if(!v)return null;var y=nve(v,2),b=y[0],_=b.x,w=b.y,j=y[1],N=j.x,D=j.y,S=qi(e,"hidden")?"url(#".concat(u,")"):void 0,T=qC(qC({clipPath:S},nt(e,!0)),{},{x1:_,y1:w,x2:N,y2:D});return ge.createElement(Tt,{className:dt("recharts-reference-line",c)},cve(o,T),Zr.renderCallByParent(e,wge({x1:_,y1:w,x2:N,y2:D})))}var R_=function(e){function t(){return Kge(this,t),Jge(this,t,arguments)}return tve(t,e),Zge(t,[{key:"render",value:function(){return ge.createElement(uve,this.props)}}])}(ge.Component);U_(R_,"displayName","ReferenceLine");U_(R_,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function i2(){return i2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i2.apply(this,arguments)}function zl(e){"@babel/helpers - typeof";return zl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zl(e)}function VC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function GC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VC(Object(r),!0).forEach(function(n){ag(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fve(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_8(n.key),n)}}function hve(e,t,r){return t&&fve(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function mve(e,t,r){return t=Jp(t),pve(e,w8()?Reflect.construct(t,r||[],Jp(e).constructor):t.apply(e,r))}function pve(e,t){if(t&&(zl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xve(e)}function xve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w8(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(w8=function(){return!!e})()}function Jp(e){return Jp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Jp(e)}function gve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s2(e,t)}function s2(e,t){return s2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},s2(e,t)}function ag(e,t,r){return t=_8(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _8(e){var t=vve(e,"string");return zl(t)=="symbol"?t:t+""}function vve(e,t){if(zl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(zl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var yve=function(t){var r=t.x,n=t.y,a=t.xAxis,i=t.yAxis,o=k_({x:a.scale,y:i.scale}),c=o.apply({x:r,y:n},{bandAware:!0});return qi(t,"discard")&&!o.isInRange(c)?null:c},ig=function(e){function t(){return dve(this,t),mve(this,t,arguments)}return gve(t,e),hve(t,[{key:"render",value:function(){var n=this.props,a=n.x,i=n.y,o=n.r,c=n.alwaysShow,l=n.clipPathId,u=Hr(a),d=Hr(i);if(bi(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!u||!d)return null;var f=yve(this.props);if(!f)return null;var h=f.x,m=f.y,x=this.props,p=x.shape,g=x.className,v=qi(this.props,"hidden")?"url(#".concat(l,")"):void 0,y=GC(GC({clipPath:v},nt(this.props,!0)),{},{cx:h,cy:m});return ge.createElement(Tt,{className:dt("recharts-reference-dot",g)},t.renderDot(p,y),Zr.renderCallByParent(this.props,{x:h-o,y:m-o,width:2*o,height:2*o}))}}])}(ge.Component);ag(ig,"displayName","ReferenceDot");ag(ig,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});ag(ig,"renderDot",function(e,t){var r;return ge.isValidElement(e)?r=ge.cloneElement(e,t):st(e)?r=e(t):r=ge.createElement(Y0,i2({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function o2(){return o2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o2.apply(this,arguments)}function ql(e){"@babel/helpers - typeof";return ql=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ql(e)}function XC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function KC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XC(Object(r),!0).forEach(function(n){sg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wve(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,N8(n.key),n)}}function _ve(e,t,r){return t&&wve(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function jve(e,t,r){return t=Qp(t),Nve(e,j8()?Reflect.construct(t,r||[],Qp(e).constructor):t.apply(e,r))}function Nve(e,t){if(t&&(ql(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dve(e)}function Dve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j8(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(j8=function(){return!!e})()}function Qp(e){return Qp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qp(e)}function Sve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c2(e,t)}function c2(e,t){return c2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},c2(e,t)}function sg(e,t,r){return t=N8(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function N8(e){var t=Eve(e,"string");return ql(t)=="symbol"?t:t+""}function Eve(e,t){if(ql(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ql(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Tve=function(t,r,n,a,i){var o=i.x1,c=i.x2,l=i.y1,u=i.y2,d=i.xAxis,f=i.yAxis;if(!d||!f)return null;var h=k_({x:d.scale,y:f.scale}),m={x:t?h.x.apply(o,{position:"start"}):h.x.rangeMin,y:n?h.y.apply(l,{position:"start"}):h.y.rangeMin},x={x:r?h.x.apply(c,{position:"end"}):h.x.rangeMax,y:a?h.y.apply(u,{position:"end"}):h.y.rangeMax};return qi(i,"discard")&&(!h.isInRange(m)||!h.isInRange(x))?null:u8(m,x)},og=function(e){function t(){return bve(this,t),jve(this,t,arguments)}return Sve(t,e),_ve(t,[{key:"render",value:function(){var n=this.props,a=n.x1,i=n.x2,o=n.y1,c=n.y2,l=n.className,u=n.alwaysShow,d=n.clipPathId;bi(u===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=Hr(a),h=Hr(i),m=Hr(o),x=Hr(c),p=this.props.shape;if(!f&&!h&&!m&&!x&&!p)return null;var g=Tve(f,h,m,x,this.props);if(!g&&!p)return null;var v=qi(this.props,"hidden")?"url(#".concat(d,")"):void 0;return ge.createElement(Tt,{className:dt("recharts-reference-area",l)},t.renderRect(p,KC(KC({clipPath:v},nt(this.props,!0)),g)),Zr.renderCallByParent(this.props,g))}}])}(ge.Component);sg(og,"displayName","ReferenceArea");sg(og,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});sg(og,"renderRect",function(e,t){var r;return ge.isValidElement(e)?r=ge.cloneElement(e,t):st(e)?r=e(t):r=ge.createElement(E_,o2({},t,{className:"recharts-reference-area-rect"})),r});function D8(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function Cve(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return jge(n,r)}function Ave(e,t,r){var n=r==="width",a=e.x,i=e.y,o=e.width,c=e.height;return t===1?{start:n?a:i,end:n?a+o:i+c}:{start:n?a+o:i+c,end:n?a:i}}function ex(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function kve(e,t){return D8(e,t+1)}function Fve(e,t,r,n,a){for(var i=(n||[]).slice(),o=t.start,c=t.end,l=0,u=1,d=o,f=function(){var x=n==null?void 0:n[l];if(x===void 0)return{v:D8(n,u)};var p=l,g,v=function(){return g===void 0&&(g=r(x,p)),g},y=x.coordinate,b=l===0||ex(e,y,v,d,c);b||(l=0,d=o,u+=1),b&&(d=y+e*(v()/2+a),l+=u)},h;u<=i.length;)if(h=f(),h)return h.v;return[]}function Nf(e){"@babel/helpers - typeof";return Nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nf(e)}function YC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Nn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YC(Object(r),!0).forEach(function(n){Ove(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ove(e,t,r){return t=Pve(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pve(e){var t=Ive(e,"string");return Nf(t)=="symbol"?t:t+""}function Ive(e,t){if(Nf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Nf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Uve(e,t,r,n,a){for(var i=(n||[]).slice(),o=i.length,c=t.start,l=t.end,u=function(h){var m=i[h],x,p=function(){return x===void 0&&(x=r(m,h)),x};if(h===o-1){var g=e*(m.coordinate+e*p()/2-l);i[h]=m=Nn(Nn({},m),{},{tickCoord:g>0?m.coordinate-g*e:m.coordinate})}else i[h]=m=Nn(Nn({},m),{},{tickCoord:m.coordinate});var v=ex(e,m.tickCoord,p,c,l);v&&(l=m.tickCoord-e*(p()/2+a),i[h]=Nn(Nn({},m),{},{isShow:!0}))},d=o-1;d>=0;d--)u(d);return i}function Rve(e,t,r,n,a,i){var o=(n||[]).slice(),c=o.length,l=t.start,u=t.end;if(i){var d=n[c-1],f=r(d,c-1),h=e*(d.coordinate+e*f/2-u);o[c-1]=d=Nn(Nn({},d),{},{tickCoord:h>0?d.coordinate-h*e:d.coordinate});var m=ex(e,d.tickCoord,function(){return f},l,u);m&&(u=d.tickCoord-e*(f/2+a),o[c-1]=Nn(Nn({},d),{},{isShow:!0}))}for(var x=i?c-1:c,p=function(y){var b=o[y],_,w=function(){return _===void 0&&(_=r(b,y)),_};if(y===0){var j=e*(b.coordinate-e*w()/2-l);o[y]=b=Nn(Nn({},b),{},{tickCoord:j<0?b.coordinate-j*e:b.coordinate})}else o[y]=b=Nn(Nn({},b),{},{tickCoord:b.coordinate});var N=ex(e,b.tickCoord,w,l,u);N&&(l=b.tickCoord+e*(w()/2+a),o[y]=Nn(Nn({},b),{},{isShow:!0}))},g=0;g<x;g++)p(g);return o}function M_(e,t,r){var n=e.tick,a=e.ticks,i=e.viewBox,o=e.minTickGap,c=e.orientation,l=e.interval,u=e.tickFormatter,d=e.unit,f=e.angle;if(!a||!a.length||!n)return[];if(Re(l)||bo.isSsr)return kve(a,typeof l=="number"&&Re(l)?l:0);var h=[],m=c==="top"||c==="bottom"?"width":"height",x=d&&m==="width"?jd(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},p=function(b,_){var w=st(u)?u(b.value,_):b.value;return m==="width"?Cve(jd(w,{fontSize:t,letterSpacing:r}),x,f):jd(w,{fontSize:t,letterSpacing:r})[m]},g=a.length>=2?qn(a[1].coordinate-a[0].coordinate):1,v=Ave(i,g,m);return l==="equidistantPreserveStart"?Fve(g,v,p,a,o):(l==="preserveStart"||l==="preserveStartEnd"?h=Rve(g,v,p,a,o,l==="preserveStartEnd"):h=Uve(g,v,p,a,o),h.filter(function(y){return y.isShow}))}var Mve=["viewBox"],Bve=["viewBox"],Lve=["ticks"];function Hl(e){"@babel/helpers - typeof";return Hl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hl(e)}function sl(){return sl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sl.apply(this,arguments)}function ZC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Br(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZC(Object(r),!0).forEach(function(n){B_(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Zv(e,t){if(e==null)return{};var r=$ve(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function $ve(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Wve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JC(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,E8(n.key),n)}}function zve(e,t,r){return t&&JC(e.prototype,t),r&&JC(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qve(e,t,r){return t=tx(t),Hve(e,S8()?Reflect.construct(t,r||[],tx(e).constructor):t.apply(e,r))}function Hve(e,t){if(t&&(Hl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vve(e)}function Vve(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S8(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(S8=function(){return!!e})()}function tx(e){return tx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tx(e)}function Gve(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l2(e,t)}function l2(e,t){return l2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},l2(e,t)}function B_(e,t,r){return t=E8(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function E8(e){var t=Xve(e,"string");return Hl(t)=="symbol"?t:t+""}function Xve(e,t){if(Hl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Hl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Cu=function(e){function t(r){var n;return Wve(this,t),n=qve(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return Gve(t,e),zve(t,[{key:"shouldComponentUpdate",value:function(n,a){var i=n.viewBox,o=Zv(n,Mve),c=this.props,l=c.viewBox,u=Zv(c,Bve);return!hl(i,l)||!hl(o,u)||!hl(a,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var a=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.x,o=a.y,c=a.width,l=a.height,u=a.orientation,d=a.tickSize,f=a.mirror,h=a.tickMargin,m,x,p,g,v,y,b=f?-1:1,_=n.tickSize||d,w=Re(n.tickCoord)?n.tickCoord:n.coordinate;switch(u){case"top":m=x=n.coordinate,g=o+ +!f*l,p=g-b*_,y=p-b*h,v=w;break;case"left":p=g=n.coordinate,x=i+ +!f*c,m=x-b*_,v=m-b*h,y=w;break;case"right":p=g=n.coordinate,x=i+ +f*c,m=x+b*_,v=m+b*h,y=w;break;default:m=x=n.coordinate,g=o+ +f*l,p=g+b*_,y=p+b*h,v=w;break}return{line:{x1:m,y1:p,x2:x,y2:g},tick:{x:v,y}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,o;switch(a){case"left":o=i?"start":"end";break;case"right":o=i?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,o="end";switch(a){case"left":case"right":o="middle";break;case"top":o=i?"start":"end";break;default:o=i?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,c=n.height,l=n.orientation,u=n.mirror,d=n.axisLine,f=Br(Br(Br({},nt(this.props,!1)),nt(d,!1)),{},{fill:"none"});if(l==="top"||l==="bottom"){var h=+(l==="top"&&!u||l==="bottom"&&u);f=Br(Br({},f),{},{x1:a,y1:i+h*c,x2:a+o,y2:i+h*c})}else{var m=+(l==="left"&&!u||l==="right"&&u);f=Br(Br({},f),{},{x1:a+m*o,y1:i,x2:a+m*o,y2:i+c})}return ge.createElement("line",sl({},f,{className:dt("recharts-cartesian-axis-line",Sa(d,"className"))}))}},{key:"renderTicks",value:function(n,a,i){var o=this,c=this.props,l=c.tickLine,u=c.stroke,d=c.tick,f=c.tickFormatter,h=c.unit,m=M_(Br(Br({},this.props),{},{ticks:n}),a,i),x=this.getTickTextAnchor(),p=this.getTickVerticalAnchor(),g=nt(this.props,!1),v=nt(d,!1),y=Br(Br({},g),{},{fill:"none"},nt(l,!1)),b=m.map(function(_,w){var j=o.getTickLineCoord(_),N=j.line,D=j.tick,S=Br(Br(Br(Br({textAnchor:x,verticalAnchor:p},g),{},{stroke:"none",fill:u},v),D),{},{index:w,payload:_,visibleTicksCount:m.length,tickFormatter:f});return ge.createElement(Tt,sl({className:"recharts-cartesian-axis-tick",key:"tick-".concat(_.value,"-").concat(_.coordinate,"-").concat(_.tickCoord)},uo(o.props,_,w)),l&&ge.createElement("line",sl({},y,N,{className:dt("recharts-cartesian-axis-tick-line",Sa(l,"className"))})),d&&t.renderTickItem(d,S,"".concat(st(f)?f(_.value,w):_.value).concat(h||"")))});return ge.createElement("g",{className:"recharts-cartesian-axis-ticks"},b)}},{key:"render",value:function(){var n=this,a=this.props,i=a.axisLine,o=a.width,c=a.height,l=a.ticksGenerator,u=a.className,d=a.hide;if(d)return null;var f=this.props,h=f.ticks,m=Zv(f,Lve),x=h;return st(l)&&(x=h&&h.length>0?l(this.props):l(m)),o<=0||c<=0||!x||!x.length?null:ge.createElement(Tt,{className:dt("recharts-cartesian-axis",u),ref:function(g){n.layerReference=g}},i&&this.renderAxisLine(),this.renderTicks(x,this.state.fontSize,this.state.letterSpacing),Zr.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,a,i){var o,c=dt(a.className,"recharts-cartesian-axis-tick-value");return ge.isValidElement(n)?o=ge.cloneElement(n,Br(Br({},a),{},{className:c})):st(n)?o=n(Br(Br({},a),{},{className:c})):o=ge.createElement(fc,sl({},a,{className:"recharts-cartesian-axis-tick-value"}),i),o}}])}(R.Component);B_(Cu,"displayName","CartesianAxis");B_(Cu,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var Kve=["x1","y1","x2","y2","key"],Yve=["offset"];function mc(e){"@babel/helpers - typeof";return mc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mc(e)}function QC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Tn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QC(Object(r),!0).forEach(function(n){Zve(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Zve(e,t,r){return t=Jve(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jve(e){var t=Qve(e,"string");return mc(t)=="symbol"?t:t+""}function Qve(e,t){if(mc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(mc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tc(){return tc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tc.apply(this,arguments)}function eA(e,t){if(e==null)return{};var r=eye(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function eye(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var tye=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,a=t.x,i=t.y,o=t.width,c=t.height,l=t.ry;return ge.createElement("rect",{x:a,y:i,ry:l,width:o,height:c,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function T8(e,t){var r;if(ge.isValidElement(e))r=ge.cloneElement(e,t);else if(st(e))r=e(t);else{var n=t.x1,a=t.y1,i=t.x2,o=t.y2,c=t.key,l=eA(t,Kve),u=nt(l,!1);u.offset;var d=eA(u,Yve);r=ge.createElement("line",tc({},d,{x1:n,y1:a,x2:i,y2:o,fill:"none",key:c}))}return r}function rye(e){var t=e.x,r=e.width,n=e.horizontal,a=n===void 0?!0:n,i=e.horizontalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(c,l){var u=Tn(Tn({},e),{},{x1:t,y1:c,x2:t+r,y2:c,key:"line-".concat(l),index:l});return T8(a,u)});return ge.createElement("g",{className:"recharts-cartesian-grid-horizontal"},o)}function nye(e){var t=e.y,r=e.height,n=e.vertical,a=n===void 0?!0:n,i=e.verticalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(c,l){var u=Tn(Tn({},e),{},{x1:c,y1:t,x2:c,y2:t+r,key:"line-".concat(l),index:l});return T8(a,u)});return ge.createElement("g",{className:"recharts-cartesian-grid-vertical"},o)}function aye(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,a=e.y,i=e.width,o=e.height,c=e.horizontalPoints,l=e.horizontal,u=l===void 0?!0:l;if(!u||!t||!t.length)return null;var d=c.map(function(h){return Math.round(h+a-a)}).sort(function(h,m){return h-m});a!==d[0]&&d.unshift(0);var f=d.map(function(h,m){var x=!d[m+1],p=x?a+o-h:d[m+1]-h;if(p<=0)return null;var g=m%t.length;return ge.createElement("rect",{key:"react-".concat(m),y:h,x:n,height:p,width:i,stroke:"none",fill:t[g],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return ge.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},f)}function iye(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,a=e.fillOpacity,i=e.x,o=e.y,c=e.width,l=e.height,u=e.verticalPoints;if(!r||!n||!n.length)return null;var d=u.map(function(h){return Math.round(h+i-i)}).sort(function(h,m){return h-m});i!==d[0]&&d.unshift(0);var f=d.map(function(h,m){var x=!d[m+1],p=x?i+c-h:d[m+1]-h;if(p<=0)return null;var g=m%n.length;return ge.createElement("rect",{key:"react-".concat(m),x:h,y:o,width:p,height:l,stroke:"none",fill:n[g],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return ge.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},f)}var sye=function(t,r){var n=t.xAxis,a=t.width,i=t.height,o=t.offset;return D6(M_(Tn(Tn(Tn({},Cu.defaultProps),n),{},{ticks:ps(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),o.left,o.left+o.width,r)},oye=function(t,r){var n=t.yAxis,a=t.width,i=t.height,o=t.offset;return D6(M_(Tn(Tn(Tn({},Cu.defaultProps),n),{},{ticks:ps(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),o.top,o.top+o.height,r)},zc={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function xi(e){var t,r,n,a,i,o,c=P_(),l=I_(),u=Xge(),d=Tn(Tn({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:zc.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:zc.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:zc.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:zc.horizontalFill,vertical:(i=e.vertical)!==null&&i!==void 0?i:zc.vertical,verticalFill:(o=e.verticalFill)!==null&&o!==void 0?o:zc.verticalFill,x:Re(e.x)?e.x:u.left,y:Re(e.y)?e.y:u.top,width:Re(e.width)?e.width:u.width,height:Re(e.height)?e.height:u.height}),f=d.x,h=d.y,m=d.width,x=d.height,p=d.syncWithTicks,g=d.horizontalValues,v=d.verticalValues,y=Hge(),b=Vge();if(!Re(m)||m<=0||!Re(x)||x<=0||!Re(f)||f!==+f||!Re(h)||h!==+h)return null;var _=d.verticalCoordinatesGenerator||sye,w=d.horizontalCoordinatesGenerator||oye,j=d.horizontalPoints,N=d.verticalPoints;if((!j||!j.length)&&st(w)){var D=g&&g.length,S=w({yAxis:b?Tn(Tn({},b),{},{ticks:D?g:b.ticks}):void 0,width:c,height:l,offset:u},D?!0:p);bi(Array.isArray(S),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(mc(S),"]")),Array.isArray(S)&&(j=S)}if((!N||!N.length)&&st(_)){var T=v&&v.length,A=_({xAxis:y?Tn(Tn({},y),{},{ticks:T?v:y.ticks}):void 0,width:c,height:l,offset:u},T?!0:p);bi(Array.isArray(A),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(mc(A),"]")),Array.isArray(A)&&(N=A)}return ge.createElement("g",{className:"recharts-cartesian-grid"},ge.createElement(tye,{fill:d.fill,fillOpacity:d.fillOpacity,x:d.x,y:d.y,width:d.width,height:d.height,ry:d.ry}),ge.createElement(rye,tc({},d,{offset:u,horizontalPoints:j,xAxis:y,yAxis:b})),ge.createElement(nye,tc({},d,{offset:u,verticalPoints:N,xAxis:y,yAxis:b})),ge.createElement(aye,tc({},d,{horizontalPoints:j})),ge.createElement(iye,tc({},d,{verticalPoints:N})))}xi.displayName="CartesianGrid";var cye=["type","layout","connectNulls","ref"],lye=["key"];function Vl(e){"@babel/helpers - typeof";return Vl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vl(e)}function tA(e,t){if(e==null)return{};var r=uye(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function uye(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Cd(){return Cd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cd.apply(this,arguments)}function rA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rA(Object(r),!0).forEach(function(n){hi(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qc(e){return mye(e)||hye(e)||fye(e)||dye()}function dye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fye(e,t){if(e){if(typeof e=="string")return u2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u2(e,t)}}function hye(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mye(e){if(Array.isArray(e))return u2(e)}function u2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,A8(n.key),n)}}function xye(e,t,r){return t&&nA(e.prototype,t),r&&nA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gye(e,t,r){return t=rx(t),vye(e,C8()?Reflect.construct(t,r||[],rx(e).constructor):t.apply(e,r))}function vye(e,t){if(t&&(Vl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yye(e)}function yye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C8(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(C8=function(){return!!e})()}function rx(e){return rx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rx(e)}function bye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d2(e,t)}function d2(e,t){return d2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},d2(e,t)}function hi(e,t,r){return t=A8(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A8(e){var t=wye(e,"string");return Vl(t)=="symbol"?t:t+""}function wye(e,t){if(Vl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Vl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Dn=function(e){function t(){var r;pye(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=gye(this,t,[].concat(a)),hi(r,"state",{isAnimationFinished:!0,totalLength:0}),hi(r,"generateSimpleStrokeDasharray",function(o,c){return"".concat(c,"px ").concat(o-c,"px")}),hi(r,"getStrokeDasharray",function(o,c,l){var u=l.reduce(function(v,y){return v+y});if(!u)return r.generateSimpleStrokeDasharray(c,o);for(var d=Math.floor(o/u),f=o%u,h=c-o,m=[],x=0,p=0;x<l.length;p+=l[x],++x)if(p+l[x]>f){m=[].concat(qc(l.slice(0,x)),[f-p]);break}var g=m.length%2===0?[0,h]:[h];return[].concat(qc(t.repeat(l,d)),qc(m),g).map(function(v){return"".concat(v,"px")}).join(", ")}),hi(r,"id",yu("recharts-line-")),hi(r,"pathRef",function(o){r.mainCurve=o}),hi(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),hi(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return bye(t,e),xye(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.points,c=i.xAxis,l=i.yAxis,u=i.layout,d=i.children,f=sa(d,Eh);if(!f)return null;var h=function(p,g){return{x:p.x,y:p.y,value:p.value,errorVal:vr(p.payload,g)}},m={clipPath:n?"url(#clipPath-".concat(a,")"):null};return ge.createElement(Tt,m,f.map(function(x){return ge.cloneElement(x,{key:"bar-".concat(x.props.dataKey),data:o,xAxis:c,yAxis:l,layout:u,dataPointFormatter:h})}))}},{key:"renderDots",value:function(n,a,i){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var c=this.props,l=c.dot,u=c.points,d=c.dataKey,f=nt(this.props,!1),h=nt(l,!0),m=u.map(function(p,g){var v=xa(xa(xa({key:"dot-".concat(g),r:3},f),h),{},{index:g,cx:p.x,cy:p.y,value:p.value,dataKey:d,payload:p.payload,points:u});return t.renderDotItem(l,v)}),x={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return ge.createElement(Tt,Cd({className:"recharts-line-dots",key:"dots"},x),m)}},{key:"renderCurveStatically",value:function(n,a,i,o){var c=this.props,l=c.type,u=c.layout,d=c.connectNulls;c.ref;var f=tA(c,cye),h=xa(xa(xa({},nt(f,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(i,")"):null,points:n},o),{},{type:l,layout:u,connectNulls:d});return ge.createElement(Up,Cd({},h,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,a){var i=this,o=this.props,c=o.points,l=o.strokeDasharray,u=o.isAnimationActive,d=o.animationBegin,f=o.animationDuration,h=o.animationEasing,m=o.animationId,x=o.animateNewValues,p=o.width,g=o.height,v=this.state,y=v.prevPoints,b=v.totalLength;return ge.createElement(Ni,{begin:d,duration:f,isActive:u,easing:h,from:{t:0},to:{t:1},key:"line-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(_){var w=_.t;if(y){var j=y.length/c.length,N=c.map(function(E,M){var P=Math.floor(M*j);if(y[P]){var X=y[P],q=gr(X.x,E.x),B=gr(X.y,E.y);return xa(xa({},E),{},{x:q(w),y:B(w)})}if(x){var O=gr(p*2,E.x),F=gr(g/2,E.y);return xa(xa({},E),{},{x:O(w),y:F(w)})}return xa(xa({},E),{},{x:E.x,y:E.y})});return i.renderCurveStatically(N,n,a)}var D=gr(0,b),S=D(w),T;if(l){var A="".concat(l).split(/[,\s]+/gim).map(function(E){return parseFloat(E)});T=i.getStrokeDasharray(S,b,A)}else T=i.generateSimpleStrokeDasharray(b,S);return i.renderCurveStatically(c,n,a,{strokeDasharray:T})})}},{key:"renderCurve",value:function(n,a){var i=this.props,o=i.points,c=i.isAnimationActive,l=this.state,u=l.prevPoints,d=l.totalLength;return c&&o&&o.length&&(!u&&d>0||!Su(u,o))?this.renderCurveWithAnimation(n,a):this.renderCurveStatically(o,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,o=a.dot,c=a.points,l=a.className,u=a.xAxis,d=a.yAxis,f=a.top,h=a.left,m=a.width,x=a.height,p=a.isAnimationActive,g=a.id;if(i||!c||!c.length)return null;var v=this.state.isAnimationFinished,y=c.length===1,b=dt("recharts-line",l),_=u&&u.allowDataOverflow,w=d&&d.allowDataOverflow,j=_||w,N=ft(g)?this.id:g,D=(n=nt(o,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},S=D.r,T=S===void 0?3:S,A=D.strokeWidth,E=A===void 0?2:A,M=hZ(o)?o:{},P=M.clipDot,X=P===void 0?!0:P,q=T*2+E;return ge.createElement(Tt,{className:b},_||w?ge.createElement("defs",null,ge.createElement("clipPath",{id:"clipPath-".concat(N)},ge.createElement("rect",{x:_?h:h-m/2,y:w?f:f-x/2,width:_?m:m*2,height:w?x:x*2})),!X&&ge.createElement("clipPath",{id:"clipPath-dots-".concat(N)},ge.createElement("rect",{x:h-q/2,y:f-q/2,width:m+q,height:x+q}))):null,!y&&this.renderCurve(j,N),this.renderErrorBar(j,N),(y||o)&&this.renderDots(j,X,N),(!p||v)&&wi.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,a){for(var i=n.length%2!==0?[].concat(qc(n),[0]):n,o=[],c=0;c<a;++c)o=[].concat(qc(o),qc(i));return o}},{key:"renderDotItem",value:function(n,a){var i;if(ge.isValidElement(n))i=ge.cloneElement(n,a);else if(st(n))i=n(a);else{var o=a.key,c=tA(a,lye),l=dt("recharts-line-dot",typeof n!="boolean"?n.className:"");i=ge.createElement(Y0,Cd({key:o},c,{className:l}))}return i}}])}(R.PureComponent);hi(Dn,"displayName","Line");hi(Dn,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!bo.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});hi(Dn,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,a=e.xAxisTicks,i=e.yAxisTicks,o=e.dataKey,c=e.bandSize,l=e.displayedData,u=e.offset,d=t.layout,f=l.map(function(h,m){var x=vr(h,o);return d==="horizontal"?{x:ET({axis:r,ticks:a,bandSize:c,entry:h,index:m}),y:ft(x)?null:n.scale(x),value:x,payload:h}:{x:ft(x)?null:r.scale(x),y:ET({axis:n,ticks:i,bandSize:c,entry:h,index:m}),value:x,payload:h}});return xa({points:f,layout:d},u)});function Gl(e){"@babel/helpers - typeof";return Gl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gl(e)}function _ye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jye(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O8(n.key),n)}}function Nye(e,t,r){return t&&jye(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Dye(e,t,r){return t=nx(t),Sye(e,k8()?Reflect.construct(t,r||[],nx(e).constructor):t.apply(e,r))}function Sye(e,t){if(t&&(Gl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Eye(e)}function Eye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k8(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(k8=function(){return!!e})()}function nx(e){return nx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nx(e)}function Tye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f2(e,t)}function f2(e,t){return f2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},f2(e,t)}function F8(e,t,r){return t=O8(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O8(e){var t=Cye(e,"string");return Gl(t)=="symbol"?t:t+""}function Cye(e,t){if(Gl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Gl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function h2(){return h2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},h2.apply(this,arguments)}function Aye(e){var t=e.xAxisId,r=P_(),n=I_(),a=g8(t);return a==null?null:R.createElement(Cu,h2({},a,{className:dt("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(o){return ps(o,!0)}}))}var ta=function(e){function t(){return _ye(this,t),Dye(this,t,arguments)}return Tye(t,e),Nye(t,[{key:"render",value:function(){return R.createElement(Aye,this.props)}}])}(R.Component);F8(ta,"displayName","XAxis");F8(ta,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Xl(e){"@babel/helpers - typeof";return Xl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xl(e)}function kye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fye(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,U8(n.key),n)}}function Oye(e,t,r){return t&&Fye(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pye(e,t,r){return t=ax(t),Iye(e,P8()?Reflect.construct(t,r||[],ax(e).constructor):t.apply(e,r))}function Iye(e,t){if(t&&(Xl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Uye(e)}function Uye(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P8(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(P8=function(){return!!e})()}function ax(e){return ax=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ax(e)}function Rye(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m2(e,t)}function m2(e,t){return m2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},m2(e,t)}function I8(e,t,r){return t=U8(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U8(e){var t=Mye(e,"string");return Xl(t)=="symbol"?t:t+""}function Mye(e,t){if(Xl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Xl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function p2(){return p2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},p2.apply(this,arguments)}var Bye=function(t){var r=t.yAxisId,n=P_(),a=I_(),i=v8(r);return i==null?null:R.createElement(Cu,p2({},i,{className:dt("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(c){return ps(c,!0)}}))},ra=function(e){function t(){return kye(this,t),Pye(this,t,arguments)}return Rye(t,e),Oye(t,[{key:"render",value:function(){return R.createElement(Bye,this.props)}}])}(R.Component);I8(ra,"displayName","YAxis");I8(ra,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function aA(e){return zye(e)||Wye(e)||$ye(e)||Lye()}function Lye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $ye(e,t){if(e){if(typeof e=="string")return x2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return x2(e,t)}}function Wye(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zye(e){if(Array.isArray(e))return x2(e)}function x2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var g2=function(t,r,n,a,i){var o=sa(t,R_),c=sa(t,ig),l=[].concat(aA(o),aA(c)),u=sa(t,og),d="".concat(a,"Id"),f=a[0],h=r;if(l.length&&(h=l.reduce(function(p,g){if(g.props[d]===n&&qi(g.props,"extendDomain")&&Re(g.props[f])){var v=g.props[f];return[Math.min(p[0],v),Math.max(p[1],v)]}return p},h)),u.length){var m="".concat(f,"1"),x="".concat(f,"2");h=u.reduce(function(p,g){if(g.props[d]===n&&qi(g.props,"extendDomain")&&Re(g.props[m])&&Re(g.props[x])){var v=g.props[m],y=g.props[x];return[Math.min(p[0],v,y),Math.max(p[1],v,y)]}return p},h)}return i&&i.length&&(h=i.reduce(function(p,g){return Re(g)?[Math.min(p[0],g),Math.max(p[1],g)]:p},h)),h},R8={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(l,u,d){this.fn=l,this.context=u,this.once=d||!1}function i(l,u,d,f,h){if(typeof d!="function")throw new TypeError("The listener must be a function");var m=new a(d,f||l,h),x=r?r+u:u;return l._events[x]?l._events[x].fn?l._events[x]=[l._events[x],m]:l._events[x].push(m):(l._events[x]=m,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function c(){this._events=new n,this._eventsCount=0}c.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)t.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},c.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,m=f.length,x=new Array(m);h<m;h++)x[h]=f[h].fn;return x},c.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},c.prototype.emit=function(u,d,f,h,m,x){var p=r?r+u:u;if(!this._events[p])return!1;var g=this._events[p],v=arguments.length,y,b;if(g.fn){switch(g.once&&this.removeListener(u,g.fn,void 0,!0),v){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,d),!0;case 3:return g.fn.call(g.context,d,f),!0;case 4:return g.fn.call(g.context,d,f,h),!0;case 5:return g.fn.call(g.context,d,f,h,m),!0;case 6:return g.fn.call(g.context,d,f,h,m,x),!0}for(b=1,y=new Array(v-1);b<v;b++)y[b-1]=arguments[b];g.fn.apply(g.context,y)}else{var _=g.length,w;for(b=0;b<_;b++)switch(g[b].once&&this.removeListener(u,g[b].fn,void 0,!0),v){case 1:g[b].fn.call(g[b].context);break;case 2:g[b].fn.call(g[b].context,d);break;case 3:g[b].fn.call(g[b].context,d,f);break;case 4:g[b].fn.call(g[b].context,d,f,h);break;default:if(!y)for(w=1,y=new Array(v-1);w<v;w++)y[w-1]=arguments[w];g[b].fn.apply(g[b].context,y)}}return!0},c.prototype.on=function(u,d,f){return i(this,u,d,f,!1)},c.prototype.once=function(u,d,f){return i(this,u,d,f,!0)},c.prototype.removeListener=function(u,d,f,h){var m=r?r+u:u;if(!this._events[m])return this;if(!d)return o(this,m),this;var x=this._events[m];if(x.fn)x.fn===d&&(!h||x.once)&&(!f||x.context===f)&&o(this,m);else{for(var p=0,g=[],v=x.length;p<v;p++)(x[p].fn!==d||h&&!x[p].once||f&&x[p].context!==f)&&g.push(x[p]);g.length?this._events[m]=g.length===1?g[0]:g:o(this,m)}return this},c.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&o(this,d)):(this._events=new n,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=r,c.EventEmitter=c,e.exports=c})(R8);var qye=R8.exports;const Hye=Rt(qye);var Jv=new Hye,Qv="recharts.syncMouseEvents";function Df(e){"@babel/helpers - typeof";return Df=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Df(e)}function Vye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gye(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,M8(n.key),n)}}function Xye(e,t,r){return t&&Gye(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ey(e,t,r){return t=M8(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M8(e){var t=Kye(e,"string");return Df(t)=="symbol"?t:t+""}function Kye(e,t){if(Df(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Df(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Yye=function(){function e(){Vye(this,e),ey(this,"activeIndex",0),ey(this,"coordinateList",[]),ey(this,"layout","horizontal")}return Xye(e,[{key:"setDetails",value:function(r){var n,a=r.coordinateList,i=a===void 0?null:a,o=r.container,c=o===void 0?null:o,l=r.layout,u=l===void 0?null:l,d=r.offset,f=d===void 0?null:d,h=r.mouseHandlerCallback,m=h===void 0?null:h;this.coordinateList=(n=i??this.coordinateList)!==null&&n!==void 0?n:[],this.container=c??this.container,this.layout=u??this.layout,this.offset=f??this.offset,this.mouseHandlerCallback=m??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),i=a.x,o=a.y,c=a.height,l=this.coordinateList[this.activeIndex].coordinate,u=((r=window)===null||r===void 0?void 0:r.scrollX)||0,d=((n=window)===null||n===void 0?void 0:n.scrollY)||0,f=i+l+u,h=o+this.offset.top+c/2+d;this.mouseHandlerCallback({pageX:f,pageY:h})}}}])}();function Zye(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],a=e==null?void 0:e[1];if(n&&a&&Re(n)&&Re(a))return!0}return!1}function Jye(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function B8(e){var t=e.cx,r=e.cy,n=e.radius,a=e.startAngle,i=e.endAngle,o=rr(t,r,n,a),c=rr(t,r,n,i);return{points:[o,c],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function Qye(e,t,r){var n,a,i,o;if(e==="horizontal")n=t.x,i=n,a=r.top,o=r.top+r.height;else if(e==="vertical")a=t.y,o=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var c=t.cx,l=t.cy,u=t.innerRadius,d=t.outerRadius,f=t.angle,h=rr(c,l,u,f),m=rr(c,l,d,f);n=h.x,a=h.y,i=m.x,o=m.y}else return B8(t);return[{x:n,y:a},{x:i,y:o}]}function Sf(e){"@babel/helpers - typeof";return Sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sf(e)}function iA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iA(Object(r),!0).forEach(function(n){ebe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ebe(e,t,r){return t=tbe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tbe(e){var t=rbe(e,"string");return Sf(t)=="symbol"?t:t+""}function rbe(e,t){if(Sf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Sf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nbe(e){var t,r,n=e.element,a=e.tooltipEventType,i=e.isActive,o=e.activeCoordinate,c=e.activePayload,l=e.offset,u=e.activeTooltipIndex,d=e.tooltipAxisBandSize,f=e.layout,h=e.chartName,m=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!m||!i||!o||h!=="ScatterChart"&&a!=="axis")return null;var x,p=Up;if(h==="ScatterChart")x=o,p=Dpe;else if(h==="BarChart")x=Jye(f,o,l,d),p=E_;else if(f==="radial"){var g=B8(o),v=g.cx,y=g.cy,b=g.radius,_=g.startAngle,w=g.endAngle;x={cx:v,cy:y,startAngle:_,endAngle:w,innerRadius:b,outerRadius:b},p=R6}else x={points:Qye(f,o,l)},p=Up;var j=fm(fm(fm(fm({stroke:"#ccc",pointerEvents:"none"},l),x),nt(m,!1)),{},{payload:c,payloadIndex:u,className:dt("recharts-tooltip-cursor",m.className)});return R.isValidElement(m)?R.cloneElement(m,j):R.createElement(p,j)}var abe=["item"],ibe=["children","className","width","height","style","compact","title","desc"];function Kl(e){"@babel/helpers - typeof";return Kl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kl(e)}function ol(){return ol=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ol.apply(this,arguments)}function sA(e,t){return cbe(e)||obe(e,t)||$8(e,t)||sbe()}function sbe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function obe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,c=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return c}}function cbe(e){if(Array.isArray(e))return e}function oA(e,t){if(e==null)return{};var r=lbe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function lbe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function ube(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dbe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,W8(n.key),n)}}function fbe(e,t,r){return t&&dbe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function hbe(e,t,r){return t=ix(t),mbe(e,L8()?Reflect.construct(t,r||[],ix(e).constructor):t.apply(e,r))}function mbe(e,t){if(t&&(Kl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pbe(e)}function pbe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L8(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(L8=function(){return!!e})()}function ix(e){return ix=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ix(e)}function xbe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v2(e,t)}function v2(e,t){return v2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},v2(e,t)}function Yl(e){return ybe(e)||vbe(e)||$8(e)||gbe()}function gbe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $8(e,t){if(e){if(typeof e=="string")return y2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return y2(e,t)}}function vbe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ybe(e){if(Array.isArray(e))return y2(e)}function y2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ee(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cA(Object(r),!0).forEach(function(n){it(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function it(e,t,r){return t=W8(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W8(e){var t=bbe(e,"string");return Kl(t)=="symbol"?t:t+""}function bbe(e,t){if(Kl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Kl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wbe={xAxis:["bottom","top"],yAxis:["left","right"]},_be={width:"100%",height:"100%"},z8={x:0,y:0};function hm(e){return e}var jbe=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},Nbe=function(t,r,n,a){var i=r.find(function(d){return d&&d.index===n});if(i){if(t==="horizontal")return{x:i.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:i.coordinate};if(t==="centric"){var o=i.coordinate,c=a.radius;return Ee(Ee(Ee({},a),rr(a.cx,a.cy,c,o)),{},{angle:o,radius:c})}var l=i.coordinate,u=a.angle;return Ee(Ee(Ee({},a),rr(a.cx,a.cy,l,u)),{},{angle:u,radius:l})}return z8},cg=function(t,r){var n=r.graphicalItems,a=r.dataStartIndex,i=r.dataEndIndex,o=(n??[]).reduce(function(c,l){var u=l.props.data;return u&&u.length?[].concat(Yl(c),Yl(u)):c},[]);return o.length>0?o:t&&t.length&&Re(a)&&Re(i)?t.slice(a,i+1):[]};function q8(e){return e==="number"?[0,"auto"]:void 0}var b2=function(t,r,n,a){var i=t.graphicalItems,o=t.tooltipAxis,c=cg(r,t);return n<0||!i||!i.length||n>=c.length?null:i.reduce(function(l,u){var d,f=(d=u.props.data)!==null&&d!==void 0?d:r;f&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(f=f.slice(t.dataStartIndex,t.dataEndIndex+1));var h;if(o.dataKey&&!o.allowDuplicatedCategory){var m=f===void 0?c:f;h=ip(m,o.dataKey,a)}else h=f&&f[n]||c[n];return h?[].concat(Yl(l),[A6(u,h)]):l},[])},lA=function(t,r,n,a){var i=a||{x:t.chartX,y:t.chartY},o=jbe(i,n),c=t.orderedTooltipTicks,l=t.tooltipAxis,u=t.tooltipTicks,d=tfe(o,c,u,l);if(d>=0&&u){var f=u[d]&&u[d].value,h=b2(t,r,d,f),m=Nbe(n,c,d,i);return{activeTooltipIndex:d,activeLabel:f,activePayload:h,activeCoordinate:m}}return null},Dbe=function(t,r){var n=r.axes,a=r.graphicalItems,i=r.axisType,o=r.axisIdKey,c=r.stackGroups,l=r.dataStartIndex,u=r.dataEndIndex,d=t.layout,f=t.children,h=t.stackOffset,m=N6(d,i);return n.reduce(function(x,p){var g,v=p.type.defaultProps!==void 0?Ee(Ee({},p.type.defaultProps),p.props):p.props,y=v.type,b=v.dataKey,_=v.allowDataOverflow,w=v.allowDuplicatedCategory,j=v.scale,N=v.ticks,D=v.includeHidden,S=v[o];if(x[S])return x;var T=cg(t.data,{graphicalItems:a.filter(function(C){var k,z=o in C.props?C.props[o]:(k=C.type.defaultProps)===null||k===void 0?void 0:k[o];return z===S}),dataStartIndex:l,dataEndIndex:u}),A=T.length,E,M,P;Zye(v.domain,_,y)&&(E=P1(v.domain,null,_),m&&(y==="number"||j!=="auto")&&(P=Dd(T,b,"category")));var X=q8(y);if(!E||E.length===0){var q,B=(q=v.domain)!==null&&q!==void 0?q:X;if(b){if(E=Dd(T,b,y),y==="category"&&m){var O=nZ(E);w&&O?(M=E,E=Vp(0,A)):w||(E=kT(B,E,p).reduce(function(C,k){return C.indexOf(k)>=0?C:[].concat(Yl(C),[k])},[]))}else if(y==="category")w?E=E.filter(function(C){return C!==""&&!ft(C)}):E=kT(B,E,p).reduce(function(C,k){return C.indexOf(k)>=0||k===""||ft(k)?C:[].concat(Yl(C),[k])},[]);else if(y==="number"){var F=sfe(T,a.filter(function(C){var k,z,V=o in C.props?C.props[o]:(k=C.type.defaultProps)===null||k===void 0?void 0:k[o],Z="hide"in C.props?C.props.hide:(z=C.type.defaultProps)===null||z===void 0?void 0:z.hide;return V===S&&(D||!Z)}),b,i,d);F&&(E=F)}m&&(y==="number"||j!=="auto")&&(P=Dd(T,b,"category"))}else m?E=Vp(0,A):c&&c[S]&&c[S].hasStack&&y==="number"?E=h==="expand"?[0,1]:C6(c[S].stackGroups,l,u):E=j6(T,a.filter(function(C){var k=o in C.props?C.props[o]:C.type.defaultProps[o],z="hide"in C.props?C.props.hide:C.type.defaultProps.hide;return k===S&&(D||!z)}),y,d,!0);if(y==="number")E=g2(f,E,S,i,N),B&&(E=P1(B,E,_));else if(y==="category"&&B){var I=B,L=E.every(function(C){return I.indexOf(C)>=0});L&&(E=I)}}return Ee(Ee({},x),{},it({},S,Ee(Ee({},v),{},{axisType:i,domain:E,categoricalDomain:P,duplicateDomain:M,originalDomain:(g=v.domain)!==null&&g!==void 0?g:X,isCategorical:m,layout:d})))},{})},Sbe=function(t,r){var n=r.graphicalItems,a=r.Axis,i=r.axisType,o=r.axisIdKey,c=r.stackGroups,l=r.dataStartIndex,u=r.dataEndIndex,d=t.layout,f=t.children,h=cg(t.data,{graphicalItems:n,dataStartIndex:l,dataEndIndex:u}),m=h.length,x=N6(d,i),p=-1;return n.reduce(function(g,v){var y=v.type.defaultProps!==void 0?Ee(Ee({},v.type.defaultProps),v.props):v.props,b=y[o],_=q8("number");if(!g[b]){p++;var w;return x?w=Vp(0,m):c&&c[b]&&c[b].hasStack?(w=C6(c[b].stackGroups,l,u),w=g2(f,w,b,i)):(w=P1(_,j6(h,n.filter(function(j){var N,D,S=o in j.props?j.props[o]:(N=j.type.defaultProps)===null||N===void 0?void 0:N[o],T="hide"in j.props?j.props.hide:(D=j.type.defaultProps)===null||D===void 0?void 0:D.hide;return S===b&&!T}),"number",d),a.defaultProps.allowDataOverflow),w=g2(f,w,b,i)),Ee(Ee({},g),{},it({},b,Ee(Ee({axisType:i},a.defaultProps),{},{hide:!0,orientation:Sa(wbe,"".concat(i,".").concat(p%2),null),domain:w,originalDomain:_,isCategorical:x,layout:d})))}return g},{})},Ebe=function(t,r){var n=r.axisType,a=n===void 0?"xAxis":n,i=r.AxisComp,o=r.graphicalItems,c=r.stackGroups,l=r.dataStartIndex,u=r.dataEndIndex,d=t.children,f="".concat(a,"Id"),h=sa(d,i),m={};return h&&h.length?m=Dbe(t,{axes:h,graphicalItems:o,axisType:a,axisIdKey:f,stackGroups:c,dataStartIndex:l,dataEndIndex:u}):o&&o.length&&(m=Sbe(t,{Axis:i,graphicalItems:o,axisType:a,axisIdKey:f,stackGroups:c,dataStartIndex:l,dataEndIndex:u})),m},Tbe=function(t){var r=Ks(t),n=ps(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:e_(n,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:Op(r,n)}},uA=function(t){var r=t.children,n=t.defaultShowTooltip,a=va(r,Ll),i=0,o=0;return t.data&&t.data.length!==0&&(o=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(i=a.props.startIndex),a.props.endIndex>=0&&(o=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!n}},Cbe=function(t){return!t||!t.length?!1:t.some(function(r){var n=gs(r&&r.type);return n&&n.indexOf("Bar")>=0})},dA=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},Abe=function(t,r){var n=t.props,a=t.graphicalItems,i=t.xAxisMap,o=i===void 0?{}:i,c=t.yAxisMap,l=c===void 0?{}:c,u=n.width,d=n.height,f=n.children,h=n.margin||{},m=va(f,Ll),x=va(f,ao),p=Object.keys(l).reduce(function(w,j){var N=l[j],D=N.orientation;return!N.mirror&&!N.hide?Ee(Ee({},w),{},it({},D,w[D]+N.width)):w},{left:h.left||0,right:h.right||0}),g=Object.keys(o).reduce(function(w,j){var N=o[j],D=N.orientation;return!N.mirror&&!N.hide?Ee(Ee({},w),{},it({},D,Sa(w,"".concat(D))+N.height)):w},{top:h.top||0,bottom:h.bottom||0}),v=Ee(Ee({},g),p),y=v.bottom;m&&(v.bottom+=m.props.height||Ll.defaultProps.height),x&&r&&(v=afe(v,a,n,r));var b=u-v.left-v.right,_=d-v.top-v.bottom;return Ee(Ee({brushBottom:y},v),{},{width:Math.max(b,0),height:Math.max(_,0)})},kbe=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},lg=function(t){var r=t.chartName,n=t.GraphicalChild,a=t.defaultTooltipEventType,i=a===void 0?"axis":a,o=t.validateTooltipEventTypes,c=o===void 0?["axis"]:o,l=t.axisComponents,u=t.legendContent,d=t.formatAxisMap,f=t.defaultProps,h=function(v,y){var b=y.graphicalItems,_=y.stackGroups,w=y.offset,j=y.updateId,N=y.dataStartIndex,D=y.dataEndIndex,S=v.barSize,T=v.layout,A=v.barGap,E=v.barCategoryGap,M=v.maxBarSize,P=dA(T),X=P.numericAxisName,q=P.cateAxisName,B=Cbe(b),O=[];return b.forEach(function(F,I){var L=cg(v.data,{graphicalItems:[F],dataStartIndex:N,dataEndIndex:D}),C=F.type.defaultProps!==void 0?Ee(Ee({},F.type.defaultProps),F.props):F.props,k=C.dataKey,z=C.maxBarSize,V=C["".concat(X,"Id")],Z=C["".concat(q,"Id")],ce={},ie=l.reduce(function(le,he){var ee=y["".concat(he.axisType,"Map")],ae=C["".concat(he.axisType,"Id")];ee&&ee[ae]||he.axisType==="zAxis"||oo();var xe=ee[ae];return Ee(Ee({},le),{},it(it({},he.axisType,xe),"".concat(he.axisType,"Ticks"),ps(xe)))},ce),Q=ie[q],ne=ie["".concat(q,"Ticks")],pe=_&&_[V]&&_[V].hasStack&&pfe(F,_[V].stackGroups),W=gs(F.type).indexOf("Bar")>=0,re=Op(Q,ne),U=[],se=B&&rfe({barSize:S,stackGroups:_,totalSize:kbe(ie,q)});if(W){var te,K,H=ft(z)?M:z,oe=(te=(K=Op(Q,ne,!0))!==null&&K!==void 0?K:H)!==null&&te!==void 0?te:0;U=nfe({barGap:A,barCategoryGap:E,bandSize:oe!==re?oe:re,sizeList:se[Z],maxBarSize:H}),oe!==re&&(U=U.map(function(le){return Ee(Ee({},le),{},{position:Ee(Ee({},le.position),{},{offset:le.position.offset-oe/2})})}))}var J=F&&F.type&&F.type.getComposedData;J&&O.push({props:Ee(Ee({},J(Ee(Ee({},ie),{},{displayedData:L,props:v,dataKey:k,item:F,bandSize:re,barPosition:U,offset:w,stackedData:pe,layout:T,dataStartIndex:N,dataEndIndex:D}))),{},it(it(it({key:F.key||"item-".concat(I)},X,ie[X]),q,ie[q]),"animationId",j)),childIndex:xZ(F,v.children),item:F})}),O},m=function(v,y){var b=v.props,_=v.dataStartIndex,w=v.dataEndIndex,j=v.updateId;if(!NS({props:b}))return null;var N=b.children,D=b.layout,S=b.stackOffset,T=b.data,A=b.reverseStackOrder,E=dA(D),M=E.numericAxisName,P=E.cateAxisName,X=sa(N,n),q=hfe(T,X,"".concat(M,"Id"),"".concat(P,"Id"),S,A),B=l.reduce(function(C,k){var z="".concat(k.axisType,"Map");return Ee(Ee({},C),{},it({},z,Ebe(b,Ee(Ee({},k),{},{graphicalItems:X,stackGroups:k.axisType===M&&q,dataStartIndex:_,dataEndIndex:w}))))},{}),O=Abe(Ee(Ee({},B),{},{props:b,graphicalItems:X}),y==null?void 0:y.legendBBox);Object.keys(B).forEach(function(C){B[C]=d(b,B[C],O,C.replace("Map",""),r)});var F=B["".concat(P,"Map")],I=Tbe(F),L=h(b,Ee(Ee({},B),{},{dataStartIndex:_,dataEndIndex:w,updateId:j,graphicalItems:X,stackGroups:q,offset:O}));return Ee(Ee({formattedGraphicalItems:L,graphicalItems:X,offset:O,stackGroups:q},I),B)},x=function(g){function v(y){var b,_,w;return ube(this,v),w=hbe(this,v,[y]),it(w,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),it(w,"accessibilityManager",new Yye),it(w,"handleLegendBBoxUpdate",function(j){if(j){var N=w.state,D=N.dataStartIndex,S=N.dataEndIndex,T=N.updateId;w.setState(Ee({legendBBox:j},m({props:w.props,dataStartIndex:D,dataEndIndex:S,updateId:T},Ee(Ee({},w.state),{},{legendBBox:j}))))}}),it(w,"handleReceiveSyncEvent",function(j,N,D){if(w.props.syncId===j){if(D===w.eventEmitterSymbol&&typeof w.props.syncMethod!="function")return;w.applySyncEvent(N)}}),it(w,"handleBrushChange",function(j){var N=j.startIndex,D=j.endIndex;if(N!==w.state.dataStartIndex||D!==w.state.dataEndIndex){var S=w.state.updateId;w.setState(function(){return Ee({dataStartIndex:N,dataEndIndex:D},m({props:w.props,dataStartIndex:N,dataEndIndex:D,updateId:S},w.state))}),w.triggerSyncEvent({dataStartIndex:N,dataEndIndex:D})}}),it(w,"handleMouseEnter",function(j){var N=w.getMouseInfo(j);if(N){var D=Ee(Ee({},N),{},{isTooltipActive:!0});w.setState(D),w.triggerSyncEvent(D);var S=w.props.onMouseEnter;st(S)&&S(D,j)}}),it(w,"triggeredAfterMouseMove",function(j){var N=w.getMouseInfo(j),D=N?Ee(Ee({},N),{},{isTooltipActive:!0}):{isTooltipActive:!1};w.setState(D),w.triggerSyncEvent(D);var S=w.props.onMouseMove;st(S)&&S(D,j)}),it(w,"handleItemMouseEnter",function(j){w.setState(function(){return{isTooltipActive:!0,activeItem:j,activePayload:j.tooltipPayload,activeCoordinate:j.tooltipPosition||{x:j.cx,y:j.cy}}})}),it(w,"handleItemMouseLeave",function(){w.setState(function(){return{isTooltipActive:!1}})}),it(w,"handleMouseMove",function(j){j.persist(),w.throttleTriggeredAfterMouseMove(j)}),it(w,"handleMouseLeave",function(j){w.throttleTriggeredAfterMouseMove.cancel();var N={isTooltipActive:!1};w.setState(N),w.triggerSyncEvent(N);var D=w.props.onMouseLeave;st(D)&&D(N,j)}),it(w,"handleOuterEvent",function(j){var N=pZ(j),D=Sa(w.props,"".concat(N));if(N&&st(D)){var S,T;/.*touch.*/i.test(N)?T=w.getMouseInfo(j.changedTouches[0]):T=w.getMouseInfo(j),D((S=T)!==null&&S!==void 0?S:{},j)}}),it(w,"handleClick",function(j){var N=w.getMouseInfo(j);if(N){var D=Ee(Ee({},N),{},{isTooltipActive:!0});w.setState(D),w.triggerSyncEvent(D);var S=w.props.onClick;st(S)&&S(D,j)}}),it(w,"handleMouseDown",function(j){var N=w.props.onMouseDown;if(st(N)){var D=w.getMouseInfo(j);N(D,j)}}),it(w,"handleMouseUp",function(j){var N=w.props.onMouseUp;if(st(N)){var D=w.getMouseInfo(j);N(D,j)}}),it(w,"handleTouchMove",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&w.throttleTriggeredAfterMouseMove(j.changedTouches[0])}),it(w,"handleTouchStart",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&w.handleMouseDown(j.changedTouches[0])}),it(w,"handleTouchEnd",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&w.handleMouseUp(j.changedTouches[0])}),it(w,"handleDoubleClick",function(j){var N=w.props.onDoubleClick;if(st(N)){var D=w.getMouseInfo(j);N(D,j)}}),it(w,"handleContextMenu",function(j){var N=w.props.onContextMenu;if(st(N)){var D=w.getMouseInfo(j);N(D,j)}}),it(w,"triggerSyncEvent",function(j){w.props.syncId!==void 0&&Jv.emit(Qv,w.props.syncId,j,w.eventEmitterSymbol)}),it(w,"applySyncEvent",function(j){var N=w.props,D=N.layout,S=N.syncMethod,T=w.state.updateId,A=j.dataStartIndex,E=j.dataEndIndex;if(j.dataStartIndex!==void 0||j.dataEndIndex!==void 0)w.setState(Ee({dataStartIndex:A,dataEndIndex:E},m({props:w.props,dataStartIndex:A,dataEndIndex:E,updateId:T},w.state)));else if(j.activeTooltipIndex!==void 0){var M=j.chartX,P=j.chartY,X=j.activeTooltipIndex,q=w.state,B=q.offset,O=q.tooltipTicks;if(!B)return;if(typeof S=="function")X=S(O,j);else if(S==="value"){X=-1;for(var F=0;F<O.length;F++)if(O[F].value===j.activeLabel){X=F;break}}var I=Ee(Ee({},B),{},{x:B.left,y:B.top}),L=Math.min(M,I.x+I.width),C=Math.min(P,I.y+I.height),k=O[X]&&O[X].value,z=b2(w.state,w.props.data,X),V=O[X]?{x:D==="horizontal"?O[X].coordinate:L,y:D==="horizontal"?C:O[X].coordinate}:z8;w.setState(Ee(Ee({},j),{},{activeLabel:k,activeCoordinate:V,activePayload:z,activeTooltipIndex:X}))}else w.setState(j)}),it(w,"renderCursor",function(j){var N,D=w.state,S=D.isTooltipActive,T=D.activeCoordinate,A=D.activePayload,E=D.offset,M=D.activeTooltipIndex,P=D.tooltipAxisBandSize,X=w.getTooltipEventType(),q=(N=j.props.active)!==null&&N!==void 0?N:S,B=w.props.layout,O=j.key||"_recharts-cursor";return ge.createElement(nbe,{key:O,activeCoordinate:T,activePayload:A,activeTooltipIndex:M,chartName:r,element:j,isActive:q,layout:B,offset:E,tooltipAxisBandSize:P,tooltipEventType:X})}),it(w,"renderPolarAxis",function(j,N,D){var S=Sa(j,"type.axisType"),T=Sa(w.state,"".concat(S,"Map")),A=j.type.defaultProps,E=A!==void 0?Ee(Ee({},A),j.props):j.props,M=T&&T[E["".concat(S,"Id")]];return R.cloneElement(j,Ee(Ee({},M),{},{className:dt(S,M.className),key:j.key||"".concat(N,"-").concat(D),ticks:ps(M,!0)}))}),it(w,"renderPolarGrid",function(j){var N=j.props,D=N.radialLines,S=N.polarAngles,T=N.polarRadius,A=w.state,E=A.radiusAxisMap,M=A.angleAxisMap,P=Ks(E),X=Ks(M),q=X.cx,B=X.cy,O=X.innerRadius,F=X.outerRadius;return R.cloneElement(j,{polarAngles:Array.isArray(S)?S:ps(X,!0).map(function(I){return I.coordinate}),polarRadius:Array.isArray(T)?T:ps(P,!0).map(function(I){return I.coordinate}),cx:q,cy:B,innerRadius:O,outerRadius:F,key:j.key||"polar-grid",radialLines:D})}),it(w,"renderLegend",function(){var j=w.state.formattedGraphicalItems,N=w.props,D=N.children,S=N.width,T=N.height,A=w.props.margin||{},E=S-(A.left||0)-(A.right||0),M=w6({children:D,formattedGraphicalItems:j,legendWidth:E,legendContent:u});if(!M)return null;var P=M.item,X=oA(M,abe);return R.cloneElement(P,Ee(Ee({},X),{},{chartWidth:S,chartHeight:T,margin:A,onBBoxUpdate:w.handleLegendBBoxUpdate}))}),it(w,"renderTooltip",function(){var j,N=w.props,D=N.children,S=N.accessibilityLayer,T=va(D,_r);if(!T)return null;var A=w.state,E=A.isTooltipActive,M=A.activeCoordinate,P=A.activePayload,X=A.activeLabel,q=A.offset,B=(j=T.props.active)!==null&&j!==void 0?j:E;return R.cloneElement(T,{viewBox:Ee(Ee({},q),{},{x:q.left,y:q.top}),active:B,label:X,payload:B?P:[],coordinate:M,accessibilityLayer:S})}),it(w,"renderBrush",function(j){var N=w.props,D=N.margin,S=N.data,T=w.state,A=T.offset,E=T.dataStartIndex,M=T.dataEndIndex,P=T.updateId;return R.cloneElement(j,{key:j.key||"_recharts-brush",onChange:cm(w.handleBrushChange,j.props.onChange),data:S,x:Re(j.props.x)?j.props.x:A.left,y:Re(j.props.y)?j.props.y:A.top+A.height+A.brushBottom-(D.bottom||0),width:Re(j.props.width)?j.props.width:A.width,startIndex:E,endIndex:M,updateId:"brush-".concat(P)})}),it(w,"renderReferenceElement",function(j,N,D){if(!j)return null;var S=w,T=S.clipPathId,A=w.state,E=A.xAxisMap,M=A.yAxisMap,P=A.offset,X=j.type.defaultProps||{},q=j.props,B=q.xAxisId,O=B===void 0?X.xAxisId:B,F=q.yAxisId,I=F===void 0?X.yAxisId:F;return R.cloneElement(j,{key:j.key||"".concat(N,"-").concat(D),xAxis:E[O],yAxis:M[I],viewBox:{x:P.left,y:P.top,width:P.width,height:P.height},clipPathId:T})}),it(w,"renderActivePoints",function(j){var N=j.item,D=j.activePoint,S=j.basePoint,T=j.childIndex,A=j.isRange,E=[],M=N.props.key,P=N.item.type.defaultProps!==void 0?Ee(Ee({},N.item.type.defaultProps),N.item.props):N.item.props,X=P.activeDot,q=P.dataKey,B=Ee(Ee({index:T,dataKey:q,cx:D.x,cy:D.y,r:4,fill:S_(N.item),strokeWidth:2,stroke:"#fff",payload:D.payload,value:D.value},nt(X,!1)),sp(X));return E.push(v.renderActiveDot(X,B,"".concat(M,"-activePoint-").concat(T))),S?E.push(v.renderActiveDot(X,Ee(Ee({},B),{},{cx:S.x,cy:S.y}),"".concat(M,"-basePoint-").concat(T))):A&&E.push(null),E}),it(w,"renderGraphicChild",function(j,N,D){var S=w.filterFormatItem(j,N,D);if(!S)return null;var T=w.getTooltipEventType(),A=w.state,E=A.isTooltipActive,M=A.tooltipAxis,P=A.activeTooltipIndex,X=A.activeLabel,q=w.props.children,B=va(q,_r),O=S.props,F=O.points,I=O.isRange,L=O.baseLine,C=S.item.type.defaultProps!==void 0?Ee(Ee({},S.item.type.defaultProps),S.item.props):S.item.props,k=C.activeDot,z=C.hide,V=C.activeBar,Z=C.activeShape,ce=!!(!z&&E&&B&&(k||V||Z)),ie={};T!=="axis"&&B&&B.props.trigger==="click"?ie={onClick:cm(w.handleItemMouseEnter,j.props.onClick)}:T!=="axis"&&(ie={onMouseLeave:cm(w.handleItemMouseLeave,j.props.onMouseLeave),onMouseEnter:cm(w.handleItemMouseEnter,j.props.onMouseEnter)});var Q=R.cloneElement(j,Ee(Ee({},S.props),ie));function ne(he){return typeof M.dataKey=="function"?M.dataKey(he.payload):null}if(ce)if(P>=0){var pe,W;if(M.dataKey&&!M.allowDuplicatedCategory){var re=typeof M.dataKey=="function"?ne:"payload.".concat(M.dataKey.toString());pe=ip(F,re,X),W=I&&L&&ip(L,re,X)}else pe=F==null?void 0:F[P],W=I&&L&&L[P];if(Z||V){var U=j.props.activeIndex!==void 0?j.props.activeIndex:P;return[R.cloneElement(j,Ee(Ee(Ee({},S.props),ie),{},{activeIndex:U})),null,null]}if(!ft(pe))return[Q].concat(Yl(w.renderActivePoints({item:S,activePoint:pe,basePoint:W,childIndex:P,isRange:I})))}else{var se,te=(se=w.getItemByXY(w.state.activeCoordinate))!==null&&se!==void 0?se:{graphicalItem:Q},K=te.graphicalItem,H=K.item,oe=H===void 0?j:H,J=K.childIndex,le=Ee(Ee(Ee({},S.props),ie),{},{activeIndex:J});return[R.cloneElement(oe,le),null,null]}return I?[Q,null,null]:[Q,null]}),it(w,"renderCustomized",function(j,N,D){return R.cloneElement(j,Ee(Ee({key:"recharts-customized-".concat(D)},w.props),w.state))}),it(w,"renderMap",{CartesianGrid:{handler:hm,once:!0},ReferenceArea:{handler:w.renderReferenceElement},ReferenceLine:{handler:hm},ReferenceDot:{handler:w.renderReferenceElement},XAxis:{handler:hm},YAxis:{handler:hm},Brush:{handler:w.renderBrush,once:!0},Bar:{handler:w.renderGraphicChild},Line:{handler:w.renderGraphicChild},Area:{handler:w.renderGraphicChild},Radar:{handler:w.renderGraphicChild},RadialBar:{handler:w.renderGraphicChild},Scatter:{handler:w.renderGraphicChild},Pie:{handler:w.renderGraphicChild},Funnel:{handler:w.renderGraphicChild},Tooltip:{handler:w.renderCursor,once:!0},PolarGrid:{handler:w.renderPolarGrid,once:!0},PolarAngleAxis:{handler:w.renderPolarAxis},PolarRadiusAxis:{handler:w.renderPolarAxis},Customized:{handler:w.renderCustomized}}),w.clipPathId="".concat((b=y.id)!==null&&b!==void 0?b:yu("recharts"),"-clip"),w.throttleTriggeredAfterMouseMove=bP(w.triggeredAfterMouseMove,(_=y.throttleDelay)!==null&&_!==void 0?_:1e3/60),w.state={},w}return xbe(v,g),fbe(v,[{key:"componentDidMount",value:function(){var b,_;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(b=this.props.margin.left)!==null&&b!==void 0?b:0,top:(_=this.props.margin.top)!==null&&_!==void 0?_:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var b=this.props,_=b.children,w=b.data,j=b.height,N=b.layout,D=va(_,_r);if(D){var S=D.props.defaultIndex;if(!(typeof S!="number"||S<0||S>this.state.tooltipTicks.length-1)){var T=this.state.tooltipTicks[S]&&this.state.tooltipTicks[S].value,A=b2(this.state,w,S,T),E=this.state.tooltipTicks[S].coordinate,M=(this.state.offset.top+j)/2,P=N==="horizontal",X=P?{x:E,y:M}:{y:E,x:M},q=this.state.formattedGraphicalItems.find(function(O){var F=O.item;return F.type.name==="Scatter"});q&&(X=Ee(Ee({},X),q.props.points[S].tooltipPosition),A=q.props.points[S].tooltipPayload);var B={activeTooltipIndex:S,isTooltipActive:!0,activeLabel:T,activePayload:A,activeCoordinate:X};this.setState(B),this.renderCursor(D),this.accessibilityManager.setIndex(S)}}}},{key:"getSnapshotBeforeUpdate",value:function(b,_){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==_.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==b.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==b.margin){var w,j;this.accessibilityManager.setDetails({offset:{left:(w=this.props.margin.left)!==null&&w!==void 0?w:0,top:(j=this.props.margin.top)!==null&&j!==void 0?j:0}})}return null}},{key:"componentDidUpdate",value:function(b){Kb([va(b.children,_r)],[va(this.props.children,_r)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var b=va(this.props.children,_r);if(b&&typeof b.props.shared=="boolean"){var _=b.props.shared?"axis":"item";return c.indexOf(_)>=0?_:i}return i}},{key:"getMouseInfo",value:function(b){if(!this.container)return null;var _=this.container,w=_.getBoundingClientRect(),j=Aoe(w),N={chartX:Math.round(b.pageX-j.left),chartY:Math.round(b.pageY-j.top)},D=w.width/_.offsetWidth||1,S=this.inRange(N.chartX,N.chartY,D);if(!S)return null;var T=this.state,A=T.xAxisMap,E=T.yAxisMap,M=this.getTooltipEventType(),P=lA(this.state,this.props.data,this.props.layout,S);if(M!=="axis"&&A&&E){var X=Ks(A).scale,q=Ks(E).scale,B=X&&X.invert?X.invert(N.chartX):null,O=q&&q.invert?q.invert(N.chartY):null;return Ee(Ee({},N),{},{xValue:B,yValue:O},P)}return P?Ee(Ee({},N),P):null}},{key:"inRange",value:function(b,_){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,j=this.props.layout,N=b/w,D=_/w;if(j==="horizontal"||j==="vertical"){var S=this.state.offset,T=N>=S.left&&N<=S.left+S.width&&D>=S.top&&D<=S.top+S.height;return T?{x:N,y:D}:null}var A=this.state,E=A.angleAxisMap,M=A.radiusAxisMap;if(E&&M){var P=Ks(E);return PT({x:N,y:D},P)}return null}},{key:"parseEventsOfWrapper",value:function(){var b=this.props.children,_=this.getTooltipEventType(),w=va(b,_r),j={};w&&_==="axis"&&(w.props.trigger==="click"?j={onClick:this.handleClick}:j={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var N=sp(this.props,this.handleOuterEvent);return Ee(Ee({},N),j)}},{key:"addListener",value:function(){Jv.on(Qv,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){Jv.removeListener(Qv,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(b,_,w){for(var j=this.state.formattedGraphicalItems,N=0,D=j.length;N<D;N++){var S=j[N];if(S.item===b||S.props.key===b.key||_===gs(S.item.type)&&w===S.childIndex)return S}return null}},{key:"renderClipPath",value:function(){var b=this.clipPathId,_=this.state.offset,w=_.left,j=_.top,N=_.height,D=_.width;return ge.createElement("defs",null,ge.createElement("clipPath",{id:b},ge.createElement("rect",{x:w,y:j,height:N,width:D})))}},{key:"getXScales",value:function(){var b=this.state.xAxisMap;return b?Object.entries(b).reduce(function(_,w){var j=sA(w,2),N=j[0],D=j[1];return Ee(Ee({},_),{},it({},N,D.scale))},{}):null}},{key:"getYScales",value:function(){var b=this.state.yAxisMap;return b?Object.entries(b).reduce(function(_,w){var j=sA(w,2),N=j[0],D=j[1];return Ee(Ee({},_),{},it({},N,D.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(b){var _;return(_=this.state.xAxisMap)===null||_===void 0||(_=_[b])===null||_===void 0?void 0:_.scale}},{key:"getYScaleByAxisId",value:function(b){var _;return(_=this.state.yAxisMap)===null||_===void 0||(_=_[b])===null||_===void 0?void 0:_.scale}},{key:"getItemByXY",value:function(b){var _=this.state,w=_.formattedGraphicalItems,j=_.activeItem;if(w&&w.length)for(var N=0,D=w.length;N<D;N++){var S=w[N],T=S.props,A=S.item,E=A.type.defaultProps!==void 0?Ee(Ee({},A.type.defaultProps),A.props):A.props,M=gs(A.type);if(M==="Bar"){var P=(T.data||[]).find(function(O){return ipe(b,O)});if(P)return{graphicalItem:S,payload:P}}else if(M==="RadialBar"){var X=(T.data||[]).find(function(O){return PT(b,O)});if(X)return{graphicalItem:S,payload:X}}else if(tg(S,j)||rg(S,j)||bf(S,j)){var q=qxe({graphicalItem:S,activeTooltipItem:j,itemData:E.data}),B=E.activeIndex===void 0?q:E.activeIndex;return{graphicalItem:Ee(Ee({},S),{},{childIndex:B}),payload:bf(S,j)?E.data[q]:S.props.data[q]}}}return null}},{key:"render",value:function(){var b=this;if(!NS(this))return null;var _=this.props,w=_.children,j=_.className,N=_.width,D=_.height,S=_.style,T=_.compact,A=_.title,E=_.desc,M=oA(_,ibe),P=nt(M,!1);if(T)return ge.createElement(WC,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},ge.createElement(Zb,ol({},P,{width:N,height:D,title:A,desc:E}),this.renderClipPath(),SS(w,this.renderMap)));if(this.props.accessibilityLayer){var X,q;P.tabIndex=(X=this.props.tabIndex)!==null&&X!==void 0?X:0,P.role=(q=this.props.role)!==null&&q!==void 0?q:"application",P.onKeyDown=function(O){b.accessibilityManager.keyboardEvent(O)},P.onFocus=function(){b.accessibilityManager.focus()}}var B=this.parseEventsOfWrapper();return ge.createElement(WC,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},ge.createElement("div",ol({className:dt("recharts-wrapper",j),style:Ee({position:"relative",cursor:"default",width:N,height:D},S)},B,{ref:function(F){b.container=F}}),ge.createElement(Zb,ol({},P,{width:N,height:D,title:A,desc:E,style:_be}),this.renderClipPath(),SS(w,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(R.Component);it(x,"displayName",r),it(x,"defaultProps",Ee({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},f)),it(x,"getDerivedStateFromProps",function(g,v){var y=g.dataKey,b=g.data,_=g.children,w=g.width,j=g.height,N=g.layout,D=g.stackOffset,S=g.margin,T=v.dataStartIndex,A=v.dataEndIndex;if(v.updateId===void 0){var E=uA(g);return Ee(Ee(Ee({},E),{},{updateId:0},m(Ee(Ee({props:g},E),{},{updateId:0}),v)),{},{prevDataKey:y,prevData:b,prevWidth:w,prevHeight:j,prevLayout:N,prevStackOffset:D,prevMargin:S,prevChildren:_})}if(y!==v.prevDataKey||b!==v.prevData||w!==v.prevWidth||j!==v.prevHeight||N!==v.prevLayout||D!==v.prevStackOffset||!hl(S,v.prevMargin)){var M=uA(g),P={chartX:v.chartX,chartY:v.chartY,isTooltipActive:v.isTooltipActive},X=Ee(Ee({},lA(v,b,N)),{},{updateId:v.updateId+1}),q=Ee(Ee(Ee({},M),P),X);return Ee(Ee(Ee({},q),m(Ee({props:g},q),v)),{},{prevDataKey:y,prevData:b,prevWidth:w,prevHeight:j,prevLayout:N,prevStackOffset:D,prevMargin:S,prevChildren:_})}if(!Kb(_,v.prevChildren)){var B,O,F,I,L=va(_,Ll),C=L&&(B=(O=L.props)===null||O===void 0?void 0:O.startIndex)!==null&&B!==void 0?B:T,k=L&&(F=(I=L.props)===null||I===void 0?void 0:I.endIndex)!==null&&F!==void 0?F:A,z=C!==T||k!==A,V=!ft(b),Z=V&&!z?v.updateId:v.updateId+1;return Ee(Ee({updateId:Z},m(Ee(Ee({props:g},v),{},{updateId:Z,dataStartIndex:C,dataEndIndex:k}),v)),{},{prevChildren:_,dataStartIndex:C,dataEndIndex:k})}return null}),it(x,"renderActiveDot",function(g,v,y){var b;return R.isValidElement(g)?b=R.cloneElement(g,v):st(g)?b=g(v):b=ge.createElement(Y0,v),ge.createElement(Tt,{className:"recharts-active-dot",key:y},b)});var p=R.forwardRef(function(v,y){return ge.createElement(x,ol({},v,{ref:y}))});return p.displayName=x.displayName,p},sx=lg({chartName:"LineChart",GraphicalChild:Dn,axisComponents:[{axisType:"xAxis",AxisComp:ta},{axisType:"yAxis",AxisComp:ra}],formatAxisMap:l8}),xl=lg({chartName:"BarChart",GraphicalChild:Ea,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:ta},{axisType:"yAxis",AxisComp:ra}],formatAxisMap:l8}),ox=lg({chartName:"PieChart",GraphicalChild:si,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:eg},{axisType:"radiusAxis",AxisComp:J0}],formatAxisMap:Dfe,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});function Fbe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e}var Obe=Fbe,Pbe=A_,Ibe=m0,Ube=Object.prototype,Rbe=Ube.hasOwnProperty;function Mbe(e,t,r){var n=e[t];(!(Rbe.call(e,t)&&Ibe(n,r))||r===void 0&&!(t in e))&&Pbe(e,t,r)}var H8=Mbe,Bbe=H8,Lbe=A_;function $be(e,t,r,n){var a=!r;r||(r={});for(var i=-1,o=t.length;++i<o;){var c=t[i],l=n?n(r[c],e[c],c,r,e):void 0;l===void 0&&(l=e[c]),a?Lbe(r,c,l):Bbe(r,c,l)}return r}var Th=$be,Wbe=Th,zbe=_u;function qbe(e,t){return e&&Wbe(t,zbe(t),e)}var Hbe=qbe;function Vbe(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var Gbe=Vbe,Xbe=Ai,Kbe=Yw,Ybe=Gbe,Zbe=Object.prototype,Jbe=Zbe.hasOwnProperty;function Qbe(e){if(!Xbe(e))return Ybe(e);var t=Kbe(e),r=[];for(var n in e)n=="constructor"&&(t||!Jbe.call(e,n))||r.push(n);return r}var e1e=Qbe,t1e=Z5,r1e=e1e,n1e=wu;function a1e(e){return n1e(e)?t1e(e,!0):r1e(e)}var L_=a1e,i1e=Th,s1e=L_;function o1e(e,t){return e&&i1e(t,s1e(t),e)}var c1e=o1e,cx={exports:{}};cx.exports;(function(e,t){var r=Ti,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,o=i?r.Buffer:void 0,c=o?o.allocUnsafe:void 0;function l(u,d){if(d)return u.slice();var f=u.length,h=c?c(f):new u.constructor(f);return u.copy(h),h}e.exports=l})(cx,cx.exports);var l1e=cx.exports;function u1e(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var d1e=u1e,f1e=Th,h1e=qw;function m1e(e,t){return f1e(e,h1e(e),t)}var p1e=m1e,x1e=zw,g1e=T_,v1e=qw,y1e=X5,b1e=Object.getOwnPropertySymbols,w1e=b1e?function(e){for(var t=[];e;)x1e(t,v1e(e)),e=g1e(e);return t}:y1e,V8=w1e,_1e=Th,j1e=V8;function N1e(e,t){return _1e(e,j1e(e),t)}var D1e=N1e,S1e=G5,E1e=V8,T1e=L_;function C1e(e){return S1e(e,T1e,E1e)}var G8=C1e,A1e=Object.prototype,k1e=A1e.hasOwnProperty;function F1e(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&k1e.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var O1e=F1e,fA=V5;function P1e(e){var t=new e.constructor(e.byteLength);return new fA(t).set(new fA(e)),t}var $_=P1e,I1e=$_;function U1e(e,t){var r=t?I1e(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var R1e=U1e,M1e=/\w*$/;function B1e(e){var t=new e.constructor(e.source,M1e.exec(e));return t.lastIndex=e.lastIndex,t}var L1e=B1e,hA=hu,mA=hA?hA.prototype:void 0,pA=mA?mA.valueOf:void 0;function $1e(e){return pA?Object(pA.call(e)):{}}var W1e=$1e,z1e=$_;function q1e(e,t){var r=t?z1e(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var H1e=q1e,V1e=$_,G1e=R1e,X1e=L1e,K1e=W1e,Y1e=H1e,Z1e="[object Boolean]",J1e="[object Date]",Q1e="[object Map]",e2e="[object Number]",t2e="[object RegExp]",r2e="[object Set]",n2e="[object String]",a2e="[object Symbol]",i2e="[object ArrayBuffer]",s2e="[object DataView]",o2e="[object Float32Array]",c2e="[object Float64Array]",l2e="[object Int8Array]",u2e="[object Int16Array]",d2e="[object Int32Array]",f2e="[object Uint8Array]",h2e="[object Uint8ClampedArray]",m2e="[object Uint16Array]",p2e="[object Uint32Array]";function x2e(e,t,r){var n=e.constructor;switch(t){case i2e:return V1e(e);case Z1e:case J1e:return new n(+e);case s2e:return G1e(e,r);case o2e:case c2e:case l2e:case u2e:case d2e:case f2e:case h2e:case m2e:case p2e:return Y1e(e,r);case Q1e:return new n;case e2e:case n2e:return new n(e);case t2e:return X1e(e);case r2e:return new n;case a2e:return K1e(e)}}var g2e=x2e,v2e=Ai,xA=Object.create,y2e=function(){function e(){}return function(t){if(!v2e(t))return{};if(xA)return xA(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),b2e=y2e,w2e=b2e,_2e=T_,j2e=Yw;function N2e(e){return typeof e.constructor=="function"&&!j2e(e)?w2e(_2e(e)):{}}var D2e=N2e,S2e=U0,E2e=Ci,T2e="[object Map]";function C2e(e){return E2e(e)&&S2e(e)==T2e}var A2e=C2e,k2e=A2e,F2e=I0,gA=Kw,vA=gA&&gA.isMap,O2e=vA?F2e(vA):k2e,P2e=O2e,I2e=U0,U2e=Ci,R2e="[object Set]";function M2e(e){return U2e(e)&&I2e(e)==R2e}var B2e=M2e,L2e=B2e,$2e=I0,yA=Kw,bA=yA&&yA.isSet,W2e=bA?$2e(bA):L2e,z2e=W2e,q2e=$w,H2e=Obe,V2e=H8,G2e=Hbe,X2e=c1e,K2e=l1e,Y2e=d1e,Z2e=p1e,J2e=D1e,Q2e=Q5,ewe=G8,twe=U0,rwe=O1e,nwe=g2e,awe=D2e,iwe=Kn,swe=Vw,owe=P2e,cwe=Ai,lwe=z2e,uwe=_u,dwe=L_,fwe=1,hwe=2,mwe=4,X8="[object Arguments]",pwe="[object Array]",xwe="[object Boolean]",gwe="[object Date]",vwe="[object Error]",K8="[object Function]",ywe="[object GeneratorFunction]",bwe="[object Map]",wwe="[object Number]",Y8="[object Object]",_we="[object RegExp]",jwe="[object Set]",Nwe="[object String]",Dwe="[object Symbol]",Swe="[object WeakMap]",Ewe="[object ArrayBuffer]",Twe="[object DataView]",Cwe="[object Float32Array]",Awe="[object Float64Array]",kwe="[object Int8Array]",Fwe="[object Int16Array]",Owe="[object Int32Array]",Pwe="[object Uint8Array]",Iwe="[object Uint8ClampedArray]",Uwe="[object Uint16Array]",Rwe="[object Uint32Array]",Qt={};Qt[X8]=Qt[pwe]=Qt[Ewe]=Qt[Twe]=Qt[xwe]=Qt[gwe]=Qt[Cwe]=Qt[Awe]=Qt[kwe]=Qt[Fwe]=Qt[Owe]=Qt[bwe]=Qt[wwe]=Qt[Y8]=Qt[_we]=Qt[jwe]=Qt[Nwe]=Qt[Dwe]=Qt[Pwe]=Qt[Iwe]=Qt[Uwe]=Qt[Rwe]=!0;Qt[vwe]=Qt[K8]=Qt[Swe]=!1;function zm(e,t,r,n,a,i){var o,c=t&fwe,l=t&hwe,u=t&mwe;if(r&&(o=a?r(e,n,a,i):r(e)),o!==void 0)return o;if(!cwe(e))return e;var d=iwe(e);if(d){if(o=rwe(e),!c)return Y2e(e,o)}else{var f=twe(e),h=f==K8||f==ywe;if(swe(e))return K2e(e,c);if(f==Y8||f==X8||h&&!a){if(o=l||h?{}:awe(e),!c)return l?J2e(e,X2e(o,e)):Z2e(e,G2e(o,e))}else{if(!Qt[f])return a?e:{};o=nwe(e,f,c)}}i||(i=new q2e);var m=i.get(e);if(m)return m;i.set(e,o),lwe(e)?e.forEach(function(g){o.add(zm(g,t,r,g,e,i))}):owe(e)&&e.forEach(function(g,v){o.set(v,zm(g,t,r,v,e,i))});var x=u?l?ewe:Q2e:l?dwe:uwe,p=d?void 0:x(e);return H2e(p||e,function(g,v){p&&(v=g,g=e[v]),V2e(o,v,zm(g,t,r,v,e,i))}),o}var Mwe=zm,Bwe=b0,Lwe=p5;function $we(e,t){return t.length<2?e:Bwe(e,Lwe(t,0,-1))}var Wwe=$we,zwe=y0,qwe=I6,Hwe=Wwe,Vwe=wh;function Gwe(e,t){return t=zwe(t,e),e=Hwe(e,t),e==null||delete e[Vwe(qwe(t))]}var Xwe=Gwe,Kwe=Y6;function Ywe(e){return Kwe(e)?void 0:e}var Zwe=Ywe,Jwe=Jw;function Qwe(e){var t=e==null?0:e.length;return t?Jwe(e,1):[]}var e_e=Qwe,t_e=e_e,r_e=fP,n_e=mP;function a_e(e){return n_e(r_e(e,void 0,t_e),e+"")}var i_e=a_e,s_e=v0,o_e=Mwe,c_e=Xwe,l_e=y0,u_e=Th,d_e=Zwe,f_e=i_e,h_e=G8,m_e=1,p_e=2,x_e=4,g_e=f_e(function(e,t){var r={};if(e==null)return r;var n=!1;t=s_e(t,function(i){return i=l_e(i,e),n||(n=i.length>1),i}),u_e(e,h_e(e),r),n&&(r=o_e(r,m_e|p_e|x_e,d_e));for(var a=t.length;a--;)c_e(r,t[a]);return r}),v_e=g_e;const y_e=Rt(v_e);function Ef(e){"@babel/helpers - typeof";return Ef=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ef(e)}function w2(){return w2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},w2.apply(this,arguments)}function wA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ty(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wA(Object(r),!0).forEach(function(n){b_e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function b_e(e,t,r){return t=w_e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w_e(e){var t=__e(e,"string");return Ef(t)=="symbol"?t:t+""}function __e(e,t){if(Ef(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ef(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function j_e(e,t){var r="".concat(t.x||e.x),n=parseInt(r,10),a="".concat(t.y||e.y),i=parseInt(a,10),o="".concat((t==null?void 0:t.height)||(e==null?void 0:e.height)),c=parseInt(o,10);return ty(ty(ty({},t),Z6(e)),{},{height:c,x:n,y:i})}function N_e(e){return ge.createElement(C_,w2({shapeType:"trapezoid",propTransformer:j_e},e))}var _2;function _A(e,t){return T_e(e)||E_e(e,t)||S_e(e,t)||D_e()}function D_e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function S_e(e,t){if(e){if(typeof e=="string")return jA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jA(e,t)}}function jA(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function E_e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,o,c=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(d){u=!0,a=d}finally{try{if(!l&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return c}}function T_e(e){if(Array.isArray(e))return e}function Zl(e){"@babel/helpers - typeof";return Zl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zl(e)}function lx(){return lx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lx.apply(this,arguments)}function NA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Wr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NA(Object(r),!0).forEach(function(n){ys(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function C_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,J8(n.key),n)}}function A_e(e,t,r){return t&&DA(e.prototype,t),r&&DA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function k_e(e,t,r){return t=ux(t),F_e(e,Z8()?Reflect.construct(t,r||[],ux(e).constructor):t.apply(e,r))}function F_e(e,t){if(t&&(Zl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return O_e(e)}function O_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Z8(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Z8=function(){return!!e})()}function ux(e){return ux=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ux(e)}function P_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j2(e,t)}function j2(e,t){return j2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},j2(e,t)}function ys(e,t,r){return t=J8(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J8(e){var t=I_e(e,"string");return Zl(t)=="symbol"?t:t+""}function I_e(e,t){if(Zl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Zl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var No=function(e){function t(){var r;C_e(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=k_e(this,t,[].concat(a)),ys(r,"state",{isAnimationFinished:!1}),ys(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),st(o)&&o()}),ys(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),st(o)&&o()}),r}return P_e(t,e),A_e(t,[{key:"isActiveIndex",value:function(n){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(n)!==-1:n===a}},{key:"renderTrapezoidsStatically",value:function(n){var a=this,i=this.props,o=i.shape,c=i.activeShape;return n.map(function(l,u){var d=a.isActiveIndex(u)?c:o,f=Wr(Wr({},l),{},{isActive:a.isActiveIndex(u),stroke:l.stroke});return ge.createElement(Tt,lx({className:"recharts-funnel-trapezoid"},uo(a.props,l,u),{key:"trapezoid-".concat(l==null?void 0:l.x,"-").concat(l==null?void 0:l.y,"-").concat(l==null?void 0:l.name,"-").concat(l==null?void 0:l.value),role:"img"}),ge.createElement(N_e,lx({option:d},f)))})}},{key:"renderTrapezoidsWithAnimation",value:function(){var n=this,a=this.props,i=a.trapezoids,o=a.isAnimationActive,c=a.animationBegin,l=a.animationDuration,u=a.animationEasing,d=a.animationId,f=this.state.prevTrapezoids;return ge.createElement(Ni,{begin:c,duration:l,isActive:o,easing:u,from:{t:0},to:{t:1},key:"funnel-".concat(d),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(h){var m=h.t,x=i.map(function(p,g){var v=f&&f[g];if(v){var y=gr(v.x,p.x),b=gr(v.y,p.y),_=gr(v.upperWidth,p.upperWidth),w=gr(v.lowerWidth,p.lowerWidth),j=gr(v.height,p.height);return Wr(Wr({},p),{},{x:y(m),y:b(m),upperWidth:_(m),lowerWidth:w(m),height:j(m)})}var N=gr(p.x+p.upperWidth/2,p.x),D=gr(p.y+p.height/2,p.y),S=gr(0,p.upperWidth),T=gr(0,p.lowerWidth),A=gr(0,p.height);return Wr(Wr({},p),{},{x:N(m),y:D(m),upperWidth:S(m),lowerWidth:T(m),height:A(m)})});return ge.createElement(Tt,null,n.renderTrapezoidsStatically(x))})}},{key:"renderTrapezoids",value:function(){var n=this.props,a=n.trapezoids,i=n.isAnimationActive,o=this.state.prevTrapezoids;return i&&a&&a.length&&(!o||!Su(o,a))?this.renderTrapezoidsWithAnimation():this.renderTrapezoidsStatically(a)}},{key:"render",value:function(){var n=this.props,a=n.hide,i=n.trapezoids,o=n.className,c=n.isAnimationActive,l=this.state.isAnimationFinished;if(a||!i||!i.length)return null;var u=dt("recharts-trapezoids",o);return ge.createElement(Tt,{className:u},this.renderTrapezoids(),(!c||l)&&wi.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curTrapezoids:n.trapezoids,prevTrapezoids:a.curTrapezoids}:n.trapezoids!==a.curTrapezoids?{curTrapezoids:n.trapezoids}:null}}])}(R.PureComponent);_2=No;ys(No,"displayName","Funnel");ys(No,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",labelLine:!0,hide:!1,isAnimationActive:!bo.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",lastShapeType:"triangle"});ys(No,"getRealFunnelData",function(e){var t=e.props,r=t.data,n=t.children,a=nt(e.props,!1),i=sa(n,Ns);return r&&r.length?r.map(function(o,c){return Wr(Wr(Wr({payload:o},a),o),i&&i[c]&&i[c].props)}):i&&i.length?i.map(function(o){return Wr(Wr({},a),o.props)}):[]});ys(No,"getRealWidthHeight",function(e,t){var r=e.props.width,n=t.width,a=t.height,i=t.left,o=t.right,c=t.top,l=t.bottom,u=a,d=n;return m5(r)?d=r:lo(r)&&(d=d*parseFloat(r)/100),{realWidth:d-i-o-50,realHeight:u-l-c,offsetX:(n-d)/2,offsetY:(a-u)/2}});ys(No,"getComposedData",function(e){var t=e.item,r=e.offset,n=_2.getRealFunnelData(t),a=t.props,i=a.dataKey,o=a.nameKey,c=a.tooltipType,l=a.lastShapeType,u=a.reversed,d=r.left,f=r.top,h=_2.getRealWidthHeight(t,r),m=h.realHeight,x=h.realWidth,p=h.offsetX,g=h.offsetY,v=Math.max.apply(null,n.map(function(j){return vr(j,i,0)})),y=n.length,b=m/y,_={x:r.left,y:r.top,width:r.width,height:r.height},w=n.map(function(j,N){var D=vr(j,i,0),S=vr(j,o,N),T=D,A;if(N!==y-1){if(A=vr(n[N+1],i,0),A instanceof Array){var E=A,M=_A(E,1);A=M[0]}}else if(D instanceof Array&&D.length===2){var P=_A(D,2);T=P[0],A=P[1]}else l==="rectangle"?A=T:A=0;var X=(v-T)*x/(2*v)+f+25+p,q=b*N+d+g,B=T/v*x,O=A/v*x,F=[{name:S,value:T,payload:j,dataKey:i,type:c}],I={x:X+B/2,y:q+b/2};return Wr(Wr({x:X,y:q,width:Math.max(B,O),upperWidth:B,lowerWidth:O,height:b,name:S,val:T,tooltipPayload:F,tooltipPosition:I},y_e(j,"width")),{},{payload:j,parentViewBox:_,labelViewBox:{x:X+(B-O)/4,y:q,width:Math.abs(B-O)/2+Math.min(B,O),height:b}})});return u&&(w=w.map(function(j,N){var D=j.y-N*b+(y-1-N)*b;return Wr(Wr({},j),{},{upperWidth:j.lowerWidth,lowerWidth:j.upperWidth,x:j.x-(j.lowerWidth-j.upperWidth)/2,y:j.y-N*b+(y-1-N)*b,tooltipPosition:Wr(Wr({},j.tooltipPosition),{},{y:D+b/2}),labelViewBox:Wr(Wr({},j.labelViewBox),{},{y:D})})})),{trapezoids:w,data:n}});var U_e=lg({chartName:"FunnelChart",GraphicalChild:No,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",axisComponents:[],defaultProps:{layout:"centric"}});const R_e=()=>{const{theme:e,toggleTheme:t}=R.useContext(PF);return s.jsx("button",{onClick:t,className:"p-2 text-text-secondary hover:text-text-primary transition-colors duration-150 ease-smooth",title:e==="light"?"Switch to Dark Mode":"Switch to Light Mode",children:s.jsx(G,{name:e==="light"?"Moon":"Sun",size:20})})},Ta=()=>{const{signOut:e,user:t,userProfile:r,hasPermission:n,refreshPermissions:a,permissions:i}=Pt(),o=Os(),[c,l]=R.useState(!1),[u,d]=R.useState(!1),f=V2();console.log(" Header - Current permissions:",i),console.log(" Header - User:",t==null?void 0:t.email,"Role:",t==null?void 0:t.role);const h=[{label:"Dashboard",path:"/sales-dashboard",icon:"BarChart3",tooltip:"Pipeline overview and metrics",requiredPermission:"dashboard.view_stats"},{label:"Campaigns",path:"/campaign-management",icon:"Megaphone",tooltip:"Marketing campaign management",requiredPermission:"campaigns.view_own"},{label:"Contacts",path:"/contact-management",icon:"Users",tooltip:"Customer relationship management",requiredPermission:"contacts.view_own"},{label:"Deals",path:"/deal-management",icon:"Target",tooltip:"Manage deal lifecycle and opportunities",requiredPermission:"deals.view_own"},{label:"Companies",path:"/company-management",icon:"Building2",tooltip:"Company management and relationships",requiredPermission:"companies.view_own"},{label:"Analytics",path:"/pipeline-analytics",icon:"TrendingUp",tooltip:"Performance insights and analysis",requiredPermission:"analytics.view_personal"},{label:"Activity",path:"/activity-timeline",icon:"Clock",tooltip:"Interaction timeline and history",requiredPermission:"activities.view_own"}],m=[{label:"Settings",path:"/settings-administration",icon:"Settings",requiredPermission:"settings.view_profile"},{label:"Logout",action:"logout",icon:"LogOut"}],x=h.filter(j=>{if(!j.requiredPermission)return!0;const N=n(j.requiredPermission);return console.log(` Nav item "${j.label}": requires "${j.requiredPermission}" - ${N?" ALLOWED":" DENIED"}`),N}),p=m.filter(j=>j.requiredPermission?n(j.requiredPermission):!0),g=j=>f.pathname===j,v=()=>{l(!c)},y=()=>{d(!u)},b=()=>{d(!1),l(!1)},_=async()=>{console.log("handleLogout called");try{l(!1),d(!1),console.log("Calling signOut..."),await e(),console.log("SignOut completed"),Be.success("Logged out successfully!"),o("/login")}catch(j){console.error("Logout error:",j),Be.error("Failed to logout. Please try again.")}},w=j=>{j.action==="logout"?_():b()};return s.jsxs(s.Fragment,{children:[s.jsx("header",{className:"fixed top-0 left-0 right-0 bg-surface border-b border-border z-1000",children:s.jsx("div",{className:"px-6 py-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"flex items-center",children:s.jsxs(hr,{to:"/sales-dashboard",className:"flex items-center space-x-3",onClick:b,children:[s.jsx("div",{className:"w-8 h-8 bg-primary rounded-lg flex items-center justify-center",children:s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[s.jsx("path",{d:"M3 13L12 4L21 13",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M9 21V13H15V21",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),s.jsx("span",{className:"text-xl font-semibold text-text-primary font-heading",children:"SalesForce Lite"})]})}),s.jsx("nav",{className:"hidden lg:flex items-center space-x-1",children:x==null?void 0:x.map(j=>s.jsxs(hr,{to:j==null?void 0:j.path,onClick:b,className:`px-6 py-4 rounded-lg text-sm font-medium transition-all duration-150 ease-smooth flex items-center space-x-2 ${g(j==null?void 0:j.path)?"bg-primary-50 text-primary border border-primary-100":"text-text-secondary hover:text-primary"}`,title:j==null?void 0:j.tooltip,children:[s.jsx(G,{name:j==null?void 0:j.icon,size:16}),s.jsx("span",{children:j==null?void 0:j.label})]},j==null?void 0:j.path))}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx(R_e,{}),s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:v,className:"flex items-center space-x-3 p-2 rounded-lg hover:bg-surface-hover transition-colors duration-150 ease-smooth",children:[s.jsx("div",{className:"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center",children:s.jsx(G,{name:"User",size:16,className:"text-primary"})}),s.jsxs("div",{className:"hidden md:block text-left",children:[s.jsx("div",{className:"text-sm font-medium text-text-primary",children:(r==null?void 0:r.full_name)||(r==null?void 0:r.first_name)||(t==null?void 0:t.email)||"User"}),s.jsx("div",{className:"text-xs text-text-secondary",children:(r==null?void 0:r.role)==="admin"?"Administrator":(r==null?void 0:r.role)==="sales_manager"?"Sales Manager":(r==null?void 0:r.role)==="sales_rep"?"Sales Rep":"User"})]}),s.jsx(G,{name:"ChevronDown",size:16,className:"text-text-secondary"})]}),c&&s.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-surface rounded-lg shadow-lg border border-border z-1100",children:s.jsx("div",{className:"py-2",children:p==null?void 0:p.map(j=>j.action==="logout"?s.jsxs("div",{onClick:_,className:"w-full text-left flex items-center space-x-3 px-4 py-2 text-sm text-text-secondary hover:text-primary ",children:[s.jsx(G,{name:j==null?void 0:j.icon,size:16}),s.jsx("span",{children:j==null?void 0:j.label})]},j.label):s.jsxs(hr,{to:j==null?void 0:j.path,onClick:()=>w(j),className:"flex items-center space-x-3 px-4 py-2 text-sm text-text-secondary hover:text-primary ",children:[s.jsx(G,{name:j==null?void 0:j.icon,size:16}),s.jsx("span",{children:j==null?void 0:j.label})]},j==null?void 0:j.path))})})]}),s.jsx("button",{onClick:y,className:"lg:hidden p-2 text-text-secondary hover:text-text-primary transition-colors duration-150 ease-smooth",children:s.jsx(G,{name:u?"X":"Menu",size:20})})]})]})})}),u&&s.jsxs("div",{className:"fixed inset-0 z-1200 lg:hidden",children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:y}),s.jsx("div",{className:"fixed left-0 top-0 bottom-0 w-80 bg-surface shadow-xl",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-8",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-8 h-8 bg-primary rounded-lg flex items-center justify-center",children:s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[s.jsx("path",{d:"M3 13L12 4L21 13",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M9 21V13H15V21",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),s.jsx("span",{className:"text-xl font-semibold text-text-primary font-heading",children:"SalesForce Lite"})]}),s.jsx("button",{onClick:y,className:"p-2 text-text-secondary hover:text-text-primary transition-colors duration-150 ease-smooth",children:s.jsx(G,{name:"X",size:20})})]}),s.jsxs("nav",{className:"space-y-2",children:[x==null?void 0:x.map(j=>s.jsxs(hr,{to:j==null?void 0:j.path,onClick:b,className:`flex items-center space-x-3 px-4 py-3 rounded-lg text-base font-medium transition-all duration-150 ease-smooth ${g(j==null?void 0:j.path)?"bg-primary-50 text-primary border border-primary-100":"text-text-secondary hover:text-text-primary hover:bg-surface-hover"}`,children:[s.jsx(G,{name:j==null?void 0:j.icon,size:20}),s.jsx("span",{children:j==null?void 0:j.label})]},j==null?void 0:j.path)),s.jsx("div",{className:"border-t border-border my-4"}),p==null?void 0:p.map(j=>j.action==="logout"?s.jsxs("div",{onClick:_,className:"w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-base font-medium text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-smooth cursor-pointer",children:[s.jsx(G,{name:j==null?void 0:j.icon,size:20}),s.jsx("span",{children:j==null?void 0:j.label})]},j.label):s.jsxs(hr,{to:j==null?void 0:j.path,onClick:()=>w(j),className:"flex items-center space-x-3 px-4 py-3 rounded-lg text-base font-medium text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-smooth",children:[s.jsx(G,{name:j==null?void 0:j.icon,size:20}),s.jsx("span",{children:j==null?void 0:j.label})]},j==null?void 0:j.path))]})]})})]}),c&&s.jsx("div",{className:"fixed inset-0 z-1050",onClick:()=>l(!1)})]})},Ki=()=>{const e=V2(),t={"/sales-dashboard":{label:"Dashboard",parent:null},"/deal-management":{label:"Deal Management",parent:"/sales-dashboard"},"/contact-management":{label:"Contact Management",parent:"/sales-dashboard"},"/pipeline-analytics":{label:"Pipeline Analytics",parent:"/sales-dashboard"},"/activity-timeline":{label:"Activity Timeline",parent:"/sales-dashboard"},"/settings-administration":{label:"Settings & Administration",parent:"/sales-dashboard"},"/login":{label:"Login",parent:null}},n=(()=>{var c,l,u;const a=e.pathname,i=[];if(!(t!=null&&t[a]))return i;let o=a;for(;o&&(t!=null&&t[o]);)i==null||i.unshift({label:(c=t==null?void 0:t[o])==null?void 0:c.label,path:o,isActive:o===a}),o=(l=t==null?void 0:t[o])==null?void 0:l.parent;return(i==null?void 0:i.length)>0&&((u=i==null?void 0:i[0])==null?void 0:u.path)!=="/sales-dashboard"&&a!=="/sales-dashboard"&&(i==null||i.unshift({label:"Dashboard",path:"/sales-dashboard",isActive:!1})),i})();return e.pathname==="/login"||(n==null?void 0:n.length)<=1?null:s.jsxs("nav",{className:"flex items-center space-x-2 text-sm mb-6","aria-label":"Breadcrumb",children:[s.jsx(G,{name:"Home",size:16,className:"text-text-tertiary"}),n==null?void 0:n.map((a,i)=>s.jsxs(ge.Fragment,{children:[i>0&&s.jsx(G,{name:"ChevronRight",size:14,className:"text-text-tertiary"}),a!=null&&a.isActive?s.jsx("span",{className:"text-text-primary font-medium","aria-current":"page",children:a==null?void 0:a.label}):s.jsx(hr,{to:a==null?void 0:a.path,className:"text-text-secondary hover:text-primary transition-colors duration-150 ease-smooth",children:a==null?void 0:a.label})]},a==null?void 0:a.path))]})};class M_e{constructor(){this.config=null,this.loaded=!1}async loadConfiguration(){try{const{data:t,error:r}=await be.get("/api/v1/system-config/current");if(r)throw r;return this.config=t,this.loaded=!0,t}catch(t){return console.error("Failed to load system configuration:",t),this.config={general:{currency:"USD",time_format:"12",date_format:"MM/DD/YYYY",company_name:"Your Company"}},this.loaded=!0,this.config}}async getConfig(){return this.loaded||await this.loadConfiguration(),this.config}getCurrency(){var t,r;return((r=(t=this.config)==null?void 0:t.general)==null?void 0:r.currency)||"USD"}getTimeFormat(){var t,r;return((r=(t=this.config)==null?void 0:t.general)==null?void 0:r.time_format)||"12"}getDateFormat(){var t,r;return((r=(t=this.config)==null?void 0:t.general)==null?void 0:r.date_format)||"MM/DD/YYYY"}getCompanyName(){var t,r;return((r=(t=this.config)==null?void 0:t.general)==null?void 0:r.company_name)||"Your Company"}formatCurrency(t){const r=this.getCurrency();return new Intl.NumberFormat("en-US",{style:"currency",currency:r}).format(t)}formatDate(t){const r=this.getDateFormat(),n=new Date(t);switch(r){case"DD/MM/YYYY":return`${n.getDate().toString().padStart(2,"0")}/${(n.getMonth()+1).toString().padStart(2,"0")}/${n.getFullYear()}`;case"YYYY-MM-DD":return`${n.getFullYear()}-${(n.getMonth()+1).toString().padStart(2,"0")}-${n.getDate().toString().padStart(2,"0")}`;case"DD-MM-YYYY":return`${n.getDate().toString().padStart(2,"0")}-${(n.getMonth()+1).toString().padStart(2,"0")}-${n.getFullYear()}`;default:return`${(n.getMonth()+1).toString().padStart(2,"0")}/${n.getDate().toString().padStart(2,"0")}/${n.getFullYear()}`}}formatTime(t){const r=this.getTimeFormat(),n=new Date(t);return r==="24"?n.toLocaleTimeString("en-US",{hour12:!1}):n.toLocaleTimeString("en-US",{hour12:!0})}}const kr=new M_e,Nt={async getUserContacts(){console.log("[contactsService] Fetching all user contacts...");const{data:e,error:t}=await be.get("/api/v1/contacts");if(t)throw console.error("[contactsService] Error fetching contacts:",t),t;return console.log(`[contactsService] Fetched ${(e==null?void 0:e.length)||0} contacts`),e||[]},async getContactsForActivityFilters(){console.log("[contactsService] Fetching contacts for activity filters...");const{data:e,error:t}=await be.get("/api/v1/contacts/activity-filters");if(t)throw console.error("[contactsService] Error fetching contacts for activity filters:",t),t;return console.log(`[contactsService] Fetched ${(e==null?void 0:e.length)||0} contacts with activity counts`),e||[]},async getContactById(e){const{data:t,error:r}=await be.get(`/api/v1/contacts/${e}`);if(r){if(r.status===404)return null;throw r}return t},async createContact(e){const t={first_name:e.first_name,last_name:e.last_name,email:e.email||null,phone:e.phone||null,mobile:e.mobile||null,position:e.position||null,status:e.status||"active",notes:e.notes||null,social_linkedin:e.social_linkedin||null,social_twitter:e.social_twitter||null,company_id:e.company_id||null,custom_fields:e.custom_fields||void 0},{data:r,error:n}=await be.post("/api/v1/contacts",t);if(n)throw n;return r},async updateContact(e,t){const r={first_name:t.first_name,last_name:t.last_name,email:t.email||null,phone:t.phone||null,mobile:t.mobile||null,position:t.position||null,status:t.status||null,notes:t.notes||null,social_linkedin:t.social_linkedin||null,social_twitter:t.social_twitter||null,company_id:t.company_id||null,custom_fields:t.custom_fields||void 0};Object.keys(r).forEach(i=>{r[i]===void 0&&delete r[i]});const{data:n,error:a}=await be.put(`/api/v1/contacts/${e}`,r);if(a)throw a;return n},async deleteContact(e){const{data:t,error:r}=await be.delete(`/api/v1/contacts/${e}`);if(r)throw r;return!0},async deleteContacts(e){try{return await Promise.all(e.map(t=>this.deleteContact(t))),!0}catch(t){throw t}},async searchContacts(e){const{data:t,error:r}=await be.get(`/api/v1/contacts?search=${encodeURIComponent(e)}`);if(r)throw r;return t||[]},async filterContacts(e){const t=new URLSearchParams;e!=null&&e.status&&e.status.length>0&&t.append("status",e.status.join(",")),e!=null&&e.companies&&e.companies.length>0&&t.append("companies",e.companies.join(",")),e!=null&&e.leadSources&&e.leadSources.length>0&&t.append("lead_sources",e.leadSources.join(",")),e!=null&&e.dateRange&&(t.append("date_start",e.dateRange.start),t.append("date_end",e.dateRange.end));const r=t.toString(),n=r?`/api/v1/contacts?${r}`:"/api/v1/contacts",{data:a,error:i}=await be.get(n);if(i)throw i;return a||[]},async getContactStats(){const{data:e,error:t}=await be.get("/api/v1/contacts/stats");if(t){const r=await this.getUserContacts(),n={total:r.length||0,active:r.filter(a=>a.status==="active").length||0,prospects:r.filter(a=>a.status==="prospect").length||0,customers:r.filter(a=>a.status==="customer").length||0,leadSources:{}};return r.forEach(a=>{const i=a.lead_source||"unknown";n.leadSources[i]=(n.leadSources[i]||0)+1}),n}return e},subscribeToContacts(e){return{unsubscribe:()=>{}}},async importContacts(e){console.log("Importing contacts via API:",e);const{data:t,error:r}=await be.post("/api/v1/contacts/import",e);if(r)throw console.error("Import API error:",r),r;return console.log("Import API response:",t),t!=null&&t.errors&&t.errors.length>0&&console.error("Import errors from backend:",t.errors),t},async mergeContacts(e,t,r){const{data:n,error:a}=await be.post(`/api/v1/contacts/${e}/merge`,{duplicate_id:t,merged_data:r});if(a)throw a;return n}},ut={async getUserDeals(e={}){try{const t=new URLSearchParams;e.dateRange&&t.append("date_range",e.dateRange),e.probabilityRange&&t.append("probability_range",e.probabilityRange),e.ownerId&&t.append("owner_id",e.ownerId),e.stage&&t.append("stage",e.stage);const r=t.toString(),n=r?`/api/v1/deals?${r}`:"/api/v1/deals",{data:a,error:i}=await be.get(n);if(i)throw i;return a||[]}catch(t){throw console.error("Error fetching user deals:",t),t}},async getPipelineDeals(e={}){try{const t=new URLSearchParams;e.dateRange&&t.append("date_range",e.dateRange),e.probabilityRange&&t.append("probability_range",e.probabilityRange),e.ownerId&&t.append("owner_id",e.ownerId);const r=t.toString(),n=r?`/api/v1/deals/pipeline?${r}`:"/api/v1/deals/pipeline",{data:a,error:i}=await be.get(n);if(i)throw i;return a}catch(t){throw console.error("Error fetching pipeline deals:",t),t}},async getDealById(e){try{const{data:t,error:r}=await be.get(`/api/v1/deals/${e}`);if(r){if(r.status===404)return null;throw r}return t}catch(t){throw console.error("Error fetching deal:",t),t}},async createDeal(e){try{console.log("dealsService.createDeal called with:",e);const t={name:e.name,value:e.value||null,stage:e.stage||"lead",probability:e.probability||0,expected_close_date:e.expected_close_date||null,description:e.description||null,source:e.source||null,next_action:e.next_action||null,company_id:e.company_id||null,contact_id:e.contact_id||null};console.log("Sending to API:",t);const{data:r,error:n}=await be.post("/api/v1/deals",t);if(n)throw console.error("API returned error:",n),n;return console.log("API returned data:",r),r}catch(t){throw console.error("Error creating deal:",t),t}},async updateDeal(e,t){try{console.log("Updating deal:",e,"with data:",t);const{data:r,error:n}=await be.put(`/api/v1/deals/${e}`,t);if(n)throw console.error("API returned error:",n),console.error("Error details:",JSON.stringify(n,null,2)),n;return console.log("Deal updated successfully:",r),r}catch(r){throw console.error("Error updating deal:",r),r}},async deleteDeal(e){try{const{data:t,error:r}=await be.delete(`/api/v1/deals/${e}`);if(r)throw r;return!0}catch(t){throw console.error("Error deleting deal:",t),t}},async deleteDeals(e){try{return await Promise.all(e.map(t=>this.deleteDeal(t))),!0}catch(t){throw t}},async updateDealStage(e,t){try{const r={stage:t};return(t==="closed_won"||t==="closed_lost")&&(r.actual_close_date=new Date().toISOString()),await this.updateDeal(e,r)}catch(r){throw console.error("Error updating deal stage:",r),r}},async moveDeal(e,t){return await this.updateDealStage(e,t)},async getDealsByStage(e){try{const{data:t,error:r}=await be.get(`/api/v1/deals?stage=${encodeURIComponent(e)}`);if(r)throw r;return t||[]}catch(t){throw console.error("Error fetching deals by stage:",t),t}},async searchDeals(e){try{const{data:t,error:r}=await be.get(`/api/v1/deals?search=${encodeURIComponent(e)}`);if(r)throw r;return t||[]}catch(t){throw console.error("Error searching deals:",t),t}},async filterDeals(e){try{const t=new URLSearchParams;e!=null&&e.stage&&e.stage.length>0&&t.append("stage",e.stage.join(",")),e!=null&&e.owner&&e.owner.length>0&&t.append("owner",e.owner.join(",")),e!=null&&e.valueRange&&(e.valueRange.min!==void 0&&t.append("min_value",e.valueRange.min),e.valueRange.max!==void 0&&t.append("max_value",e.valueRange.max)),e!=null&&e.dateRange&&(t.append("date_start",e.dateRange.start),t.append("date_end",e.dateRange.end));const r=t.toString(),n=r?`/api/v1/deals?${r}`:"/api/v1/deals",{data:a,error:i}=await be.get(n);if(i)throw i;return a||[]}catch(t){throw console.error("Error filtering deals:",t),t}},async getDealStats(){try{const{data:e,error:t}=await be.get("/api/v1/deals/stats/overview");if(t){const r=await this.getUserDeals(),n=r.reduce((c,l)=>c+(l.value||0),0),a=r.filter(c=>c.stage==="closed_won"),i=r.filter(c=>c.stage==="closed_lost"),o=r.filter(c=>!["closed_won","closed_lost"].includes(c.stage));return{total_deals:r.length,active_deals:o.length,won_deals:a.length,lost_deals:i.length,total_value:n,won_value:a.reduce((c,l)=>c+(l.value||0),0),pipeline_value:o.reduce((c,l)=>c+(l.value||0),0),conversion_rate:a.length+i.length>0?Math.round(a.length/(a.length+i.length)*100*100)/100:0}}return e}catch(e){throw console.error("Error fetching deal stats:",e),e}},async getPipelineMetrics(){try{const e=await this.getPipelineDeals(),t={stages:{},totalValue:0,totalDeals:0};return Object.keys(e).forEach(r=>{const n=e[r],a=n.deals.reduce((i,o)=>i+(o.value||0),0);t.stages[r]={count:n.deals.length,value:a,title:n.title},t.totalValue+=a,t.totalDeals+=n.deals.length}),t}catch(e){throw console.error("Error fetching pipeline metrics:",e),e}},async cloneDeal(e){try{const t=await this.getDealById(e);if(!t)throw new Error("Deal not found");const r={name:`${t.name} (Copy)`,value:t.value,stage:"lead",probability:0,description:t.description,source:t.source,company_id:t.company_id,contact_id:t.contact_id};return await this.createDeal(r)}catch(t){throw console.error("Error cloning deal:",t),t}},subscribeToDeals(e){return{unsubscribe:()=>{}}},async getRevenueData(e={}){try{const t=new URLSearchParams;e.dateRange&&t.append("date_range",e.dateRange),e.ownerId&&t.append("owner_id",e.ownerId);const r=t.toString(),n=r?`/api/v1/deals/analytics/revenue?${r}`:"/api/v1/deals/analytics/revenue",{data:a,error:i}=await be.get(n);if(i){const o=await this.getUserDeals(),c=new Date,l=[];for(let u=11;u>=0;u--){const d=new Date(c.getFullYear(),c.getMonth()-u,1),f=d.toLocaleDateString("en-US",{month:"short"}),h=o.filter(v=>{if(v.actual_close_date){const y=new Date(v.actual_close_date);return y.getMonth()===d.getMonth()&&y.getFullYear()===d.getFullYear()}return!1}),m=h.filter(v=>v.stage==="closed_won"),x=m.reduce((v,y)=>v+(y.value||0),0),p=x>0?x*1.1:Math.random()*5e4+3e4,g=p*.9;l.push({month:f,actual:x,forecast:Math.round(p),target:Math.round(g),actualDealsCount:m.length,totalDealsCount:h.length})}return l}return a}catch(t){throw console.error("Error fetching revenue data:",t),t}},async getPerformanceMetrics(e={}){try{const t=new URLSearchParams;e.dateRange&&t.append("date_range",e.dateRange),e.ownerId&&t.append("owner_id",e.ownerId);const r=t.toString(),n=r?`/api/v1/deals/analytics/performance?${r}`:"/api/v1/deals/analytics/performance",{data:a,error:i}=await be.get(n);if(i){const o=await this.getUserDeals(),c=o.filter(x=>x.stage==="closed_won"),l=o.filter(x=>x.stage==="closed_lost"),u=c.length+l.length,d=c.reduce((x,p)=>x+(p.value||0),0),f=Math.max(d*1.3,5e5),h=c.length>0?d/c.length:0,m=u>0?c.length/u*100:0;return{achieved:d,quota:f,quota:f,percentage:Math.round(d/f*100),avgDealSize:Math.round(h),conversionRate:m,dealsWon:c.length,dealsLost:l.length,totalDeals:o.length}}return a}catch(t){throw console.error("Error fetching performance metrics:",t),t}},async getFilterOptions(){try{const{data:e,error:t}=await be.get("/api/v1/deals/analytics/filter-options");return t?{reps:[{value:"all",label:"All Representatives"}],dateRanges:[{value:"all",label:"All Time"},{value:"thisquarter",label:"This Quarter"},{value:"lastquarter",label:"Last Quarter"},{value:"thisyear",label:"This Year"},{value:"lastyear",label:"Last Year"}]}:e}catch(e){throw console.error("Error fetching filter options:",e),e}},async getWinRateData(e={}){try{const t=new URLSearchParams;e.dateRange&&t.append("date_range",e.dateRange),e.ownerId&&t.append("owner_id",e.ownerId);const r=t.toString(),n=`/api/v1/deals/analytics/winrate${r?`?${r}`:""}`,{data:a,error:i}=await be.get(n);if(i){const o=await this.getUserDeals();return["Q1","Q2","Q3","Q4"].map(l=>{const u=o.filter(m=>m.stage==="closed_won").length,d=o.filter(m=>m.stage==="closed_lost").length,f=u+d,h=f>0?Math.round(u/f*100):0;return{period:l,winRate:h+Math.floor(Math.random()*20)-10}})}return a}catch(t){throw console.error("Error fetching win rate data:",t),t}},async exportDeals(e={}){try{const t=new URLSearchParams;e.dateRange&&t.append("date_range",e.dateRange),e.probabilityRange&&t.append("probability_range",e.probabilityRange),e.ownerId&&t.append("owner_id",e.ownerId),e.stage&&t.append("stage",e.stage);const r=t.toString(),n=r?`/api/v1/deals/export?${r}`:"/api/v1/deals/export",{data:a,error:i}=await be.get(n);if(i)throw i;return a||[]}catch(t){throw console.error("Error exporting deals:",t),t}}},Qa={async getUserActivities(e=50){console.log("Fetching user activities (new architecture)...");const{data:t,error:r}=await be.get(`/api/v1/activities?limit=${e}`);if(r)throw console.error("Error fetching activities:",r),r;return console.log("Fetched activities data from v2 (with relations):",t),t||[]},async getRecentActivity(e=10){return this.getUserActivities(e)},async getDealActivities(e){const{data:t,error:r}=await be.get(`/api/v1/deals/${e}/activities`);if(r)throw r;return t||[]},async getContactActivities(e){const{data:t,error:r}=await be.get(`/api/v1/contacts/${e}/activities`);if(r)throw r;return t||[]},async getActivityById(e){console.log("Fetching activity by ID (new architecture):",e);const{data:t,error:r}=await be.get(`/api/v1/activities/${e}`);if(r)throw console.error("Error fetching activity:",r),r;return console.log("Fetched activity data:",t),t},async createActivity(e){console.log("Creating activity with data:",e);const t={type:e.type,subject:e.subject,description:e.description||null,duration_minutes:e.duration_minutes||null,outcome:e.outcome||null,contact_id:e.contact_id||null,deal_id:e.deal_id||null,custom_fields:e.custom_fields||void 0};console.log("Sending clean activity data:",t);const{data:r,error:n}=await be.post("/api/v1/activities",t);if(n)throw console.error("Error creating activity:",n),n;return console.log("Created activity response:",r),r},async updateActivity(e,t){console.log("Updating activity with data:",t);const r={type:t.type,subject:t.subject,description:t.description||null,duration_minutes:t.duration_minutes||null,outcome:t.outcome||null,contact_id:t.contact_id||null,deal_id:t.deal_id||null,custom_fields:t.custom_fields||void 0};console.log("Sending clean update data:",r);const{data:n,error:a}=await be.put(`/api/v1/activities/${e}`,r);if(a)throw console.error("Error updating activity:",a),a;return console.log("Updated activity response:",n),n},async deleteActivity(e){const{data:t,error:r}=await be.delete(`/api/v1/activities/${e}`);if(r)throw r;return!0},async deleteActivities(e){try{return await Promise.all(e.map(t=>this.deleteActivity(t))),!0}catch(t){throw t}},async searchActivities(e,t={}){const r=new URLSearchParams;e&&r.append("search",e),t.type&&t.type.length>0&&r.append("type",t.type.join(",")),t.dateRange&&(r.append("date_start",t.dateRange.start),r.append("date_end",t.dateRange.end));const n=r.toString(),a=n?`/api/v1/activities?${n}`:"/api/v1/activities",{data:i,error:o}=await be.get(a);if(o)throw o;return i||[]},async getActivityStats(){const{data:e,error:t}=await be.get("/api/v1/activities/stats");if(t){const r=await this.getUserActivities();return{total:r.length||0,calls:r.filter(a=>a.type==="call").length||0,emails:r.filter(a=>a.type==="email").length||0,meetings:r.filter(a=>a.type==="meeting").length||0,notes:r.filter(a=>a.type==="note").length||0,tasks:r.filter(a=>a.type==="task").length||0}}return e},async filterActivities(e){const t=new URLSearchParams;e.type&&e.type.length>0&&t.append("type",e.type.join(",")),e.contact&&e.contact.length>0&&t.append("contact",e.contact.join(",")),e.deal&&e.deal.length>0&&t.append("deal",e.deal.join(",")),e.dateRange&&(t.append("date_start",e.dateRange.start),t.append("date_end",e.dateRange.end));const r=t.toString(),n=r?`/api/v1/activities?${r}`:"/api/v1/activities",{data:a,error:i}=await be.get(n);if(i)throw i;return a||[]},subscribeToActivities(e){return{unsubscribe:()=>{}}},async logCall(e){return await this.createActivity({type:"call",subject:e.subject||"Phone Call",description:e.description,duration_minutes:e.duration_minutes,outcome:e.outcome,contact_id:e.contact_id,deal_id:e.deal_id})},async logEmail(e){return await this.createActivity({type:"email",subject:e.subject||"Email",description:e.description,contact_id:e.contact_id,deal_id:e.deal_id})},async logMeeting(e){return await this.createActivity({type:"meeting",subject:e.subject||"Meeting",description:e.description,duration_minutes:e.duration_minutes,outcome:e.outcome,contact_id:e.contact_id,deal_id:e.deal_id})},async addNote(e){return await this.createActivity({type:"note",subject:e.subject||"Note",description:e.description,contact_id:e.contact_id,deal_id:e.deal_id})},async completeTask(e){return await this.updateActivity(e,{outcome:"completed"})}},B_e=()=>{const{user:e}=Pt(),[t,r]=R.useState([]),[n,a]=R.useState(!1),[i,o]=R.useState(""),c=Os();R.useEffect(()=>{e&&l()},[e]);const l=async()=>{try{a(!0),o("");const m=(await(Qa==null?void 0:Qa.getRecentActivity(10))||[]).map(x=>{var p,g,v,y;return{id:x.id,type:x.type,title:x.subject,contact:x.contact?`${x.contact.first_name} ${x.contact.last_name}`:null,company:((g=(p=x.contact)==null?void 0:p.company)==null?void 0:g.name)||((y=(v=x.deal)==null?void 0:v.company)==null?void 0:y.name)||null,user:x.user?`${x.user.first_name} ${x.user.last_name}`:"System",time:x.created_at}});r(m)}catch(h){console.error("Error loading recent activity:",h),o("Failed to load activity")}finally{a(!1)}},u=h=>{const m={email:"Mail",call:"Phone",meeting:"Calendar",note:"FileText",task:"CheckSquare",demo:"Play",proposal_sent:"Send"};return(m==null?void 0:m[h])||"Activity"},d=h=>{const m={email:"text-blue-600",call:"text-green-600",meeting:"text-purple-600",note:"text-gray-600",task:"text-orange-600",demo:"text-indigo-600",proposal_sent:"text-red-600"};return(m==null?void 0:m[h])||"text-gray-600"},f=h=>{const m=new Date,x=new Date(h),p=Math.floor((m-x)/(1e3*60));if(p<1)return"Just now";if(p<60)return`${p}m ago`;const g=Math.floor(p/60);if(g<24)return`${g}h ago`;const v=Math.floor(g/24);return v<7?`${v}d ago`:x==null?void 0:x.toLocaleDateString()};return e?s.jsxs("div",{className:"card p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Recent Activity"}),s.jsx("button",{onClick:l,className:"text-text-tertiary hover:text-text-secondary",disabled:n,children:s.jsx(G,{name:"RefreshCw",size:16,className:n?"animate-spin":""})})]}),i&&s.jsx("div",{className:"bg-error-50 text-error text-sm p-3 rounded-lg mb-4",children:i}),n?s.jsx("div",{className:"space-y-3",children:[...Array(5)].map((h,m)=>s.jsxs("div",{className:"flex items-center space-x-3 animate-pulse",children:[s.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"h-3 bg-gray-200 rounded w-3/4 mb-1"}),s.jsx("div",{className:"h-2 bg-gray-200 rounded w-1/2"})]})]},m))}):(t==null?void 0:t.length)===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(G,{name:"Activity",size:32,className:"text-text-tertiary mx-auto mb-3"}),s.jsx("p",{className:"text-text-secondary text-sm",children:"No recent activity"})]}):s.jsxs("div",{className:"space-y-4",children:[t==null?void 0:t.map(h=>s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${(h==null?void 0:h.type)==="email"?"bg-blue-100":(h==null?void 0:h.type)==="call"?"bg-green-100":(h==null?void 0:h.type)==="meeting"?"bg-purple-100":(h==null?void 0:h.type)==="note"?"bg-gray-100":"bg-orange-100"}`,children:s.jsx(G,{name:u(h==null?void 0:h.type),size:16,className:d(h==null?void 0:h.type)})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm text-text-primary font-medium truncate",children:h==null?void 0:h.title}),s.jsxs("div",{className:"flex items-center space-x-2 text-xs text-text-secondary mt-1",children:[s.jsx("span",{children:h==null?void 0:h.user}),(h==null?void 0:h.contact)&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsx("span",{children:h==null?void 0:h.contact})]}),(h==null?void 0:h.company)&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsx("span",{children:h==null?void 0:h.company})]})]}),s.jsx("p",{className:"text-xs text-text-tertiary mt-1",children:f(h==null?void 0:h.time)})]})]},h==null?void 0:h.id)),s.jsx("div",{className:"pt-3 border-t border-border",children:s.jsx("button",{onClick:()=>c("/activity-timeline"),className:"text-sm text-primary hover:text-primary-600 font-medium",children:"View all activity "})})]})]}):s.jsxs("div",{className:"card p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Recent Activity"}),s.jsxs("div",{className:"text-center py-8",children:[s.jsx(G,{name:"Activity",size:32,className:"text-text-tertiary mx-auto mb-3"}),s.jsx("p",{className:"text-text-secondary text-sm",children:"Sign in to view recent activity"})]})]})},L_e={async getUserTasks(e=null,t=null){let r="/api/v1/tasks";const n=new URLSearchParams;e&&n.append("status",e),t&&n.append("priority",t),n.toString()&&(r+=`?${n.toString()}`);const{data:a,error:i}=await be.get(r);if(i)throw i;return a||[]},async getUpcomingTasks(e=7){const t=await this.getUserTasks(),r=new Date,n=new Date;return n.setDate(r.getDate()+e),t.filter(a=>{if(!a.due_date)return!1;const i=new Date(a.due_date);return i>=r&&i<=n&&a.status!=="completed"})},async getOverdueTasks(){const e=await this.getUserTasks(),t=new Date;return e.filter(r=>r.due_date?new Date(r.due_date)<t&&r.status!=="completed":!1)},async getTaskById(e){const{data:t,error:r}=await be.get(`/api/v1/tasks/${e}`);if(r){if(r.status===404)return null;throw r}return t},async createTask(e){const t={title:e.title,description:e.description||null,status:e.status||"pending",priority:e.priority||"medium",due_date:e.due_date||null,contact_id:e.contact_id||null,deal_id:e.deal_id||null,assigned_to:e.assigned_to||null},{data:r,error:n}=await be.post("/api/v1/tasks",t);if(n)throw n;return r},async updateTask(e,t){const{data:r,error:n}=await be.put(`/api/v1/tasks/${e}`,t);if(n)throw n;return r},async deleteTask(e){const{data:t,error:r}=await be.delete(`/api/v1/tasks/${e}`);if(r)throw r;return!0},async getTaskStats(){const{data:e,error:t}=await be.get("/api/v1/tasks/stats/overview");if(t){const r=await this.getUserTasks();return{total:r.length||0,completed:r.filter(a=>a.status==="completed").length||0,pending:r.filter(a=>a.status==="pending").length||0,in_progress:r.filter(a=>a.status==="in_progress").length||0,overdue:r.filter(a=>a.due_date?new Date(a.due_date)<new Date&&a.status!=="completed":!1).length||0,high_priority:r.filter(a=>a.priority==="high").length||0}}return e},async filterTasks(e){const t=new URLSearchParams;e.status&&e.status.length>0&&t.append("status",e.status.join(",")),e.priority&&e.priority.length>0&&t.append("priority",e.priority.join(",")),e.assigned_to&&e.assigned_to.length>0&&t.append("assigned_to",e.assigned_to.join(",")),e.dateRange&&(t.append("date_start",e.dateRange.start),t.append("date_end",e.dateRange.end));const r=t.toString(),n=r?`/tasks?${r}`:"/tasks",{data:a,error:i}=await be.get(n);if(i)throw i;return a||[]},subscribeToTasks(e){return{unsubscribe:()=>{}}},async completeTask(e){return await this.updateTask(e,{status:"completed"})}};function Ts({src:e,alt:t="Image Name",className:r="",...n}){return s.jsx("img",{src:e,alt:t,className:r,onError:a=>{a.target.src="/assets/images/no_image.png"},...n})}const $_e=({stage:e,totalValue:t,weightedValue:r})=>{var o;R.useEffect(()=>{kr.loadConfiguration()},[]);const n=c=>{const l=kr.getCurrency(),u=new Intl.NumberFormat("en-US",{style:"currency",currency:l,minimumFractionDigits:0,maximumFractionDigits:0});return c>=1e6?u.format(c/1e6).replace(/\.0/,"")+"M":c>=1e3?u.format(c/1e3).replace(/\.0/,"")+"K":u.format(c)},a=c=>{const l={lead:"bg-surface border-border",qualified:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-700/50",proposal:"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-700/50",negotiation:"bg-orange-50 dark:bg-orange-900/20 border-orange-200 dark:border-orange-700/50",closed:"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-700/50"};return(l==null?void 0:l[c])||"bg-surface border-border"},i=c=>{const l={lead:"UserPlus",qualified:"CheckCircle",proposal:"FileText",negotiation:"MessageSquare",closed:"Trophy"};return(l==null?void 0:l[c])||"Circle"};return s.jsxs("div",{className:`rounded-lg border-2 border-dashed p-3 h-full ${a(e==null?void 0:e.id)}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:i(e==null?void 0:e.id),size:14,className:"text-text-secondary"}),s.jsx("h3",{className:"font-semibold text-sm text-text-primary",children:e==null?void 0:e.title})]}),s.jsx("span",{className:"text-xs font-semibold text-text-secondary bg-surface px-2 py-0.5 rounded-full",children:(o=e==null?void 0:e.deals)==null?void 0:o.length})]}),s.jsxs("div",{className:"mb-3 space-y-1 pb-3 border-b border-border",children:[s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-text-secondary",children:"Total:"}),s.jsx("span",{className:"font-semibold text-text-primary",children:n(t)})]}),s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-text-secondary",children:"Weighted:"}),s.jsx("span",{className:"font-semibold text-text-primary",children:n(r)})]})]}),s.jsx(t5,{droppableId:e==null?void 0:e.id,children:(c,l)=>{var u,d,f;return s.jsxs("div",{ref:c==null?void 0:c.innerRef,...c==null?void 0:c.droppableProps,className:`max-h-[500px] overflow-y-auto space-y-2 pr-1 scrollbar-thin scrollbar-thumb-border scrollbar-track-transparent ${l!=null&&l.isDraggingOver?"bg-primary-50 dark:bg-primary-900/20 rounded":""}`,style:{minHeight:((u=e==null?void 0:e.deals)==null?void 0:u.length)===0?"120px":"200px"},children:[(d=e==null?void 0:e.deals)==null?void 0:d.map((h,m)=>s.jsx(bG,{draggableId:h==null?void 0:h.id,index:m,children:(x,p)=>s.jsxs("div",{ref:x==null?void 0:x.innerRef,...x==null?void 0:x.draggableProps,...x==null?void 0:x.dragHandleProps,className:`bg-surface rounded-lg p-2.5 border border-border shadow-sm cursor-move transition-all duration-150 hover:shadow-md hover:border-primary ${p!=null&&p.isDragging?"rotate-2 shadow-lg ring-2 ring-primary":""}`,children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsx("h4",{className:"text-xs font-semibold text-text-primary line-clamp-2 flex-1 pr-1",children:h==null?void 0:h.title}),s.jsx(G,{name:"GripVertical",size:12,className:"text-text-tertiary flex-shrink-0"})]}),s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-sm font-bold text-text-primary",children:n(h==null?void 0:h.value)}),s.jsxs("span",{className:"text-xs px-1.5 py-0.5 bg-primary-50 dark:bg-primary-900/30 text-primary dark:text-primary-400 rounded-full font-medium",children:[h==null?void 0:h.probability,"%"]})]}),s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx(Ts,{src:h==null?void 0:h.avatar,alt:h==null?void 0:h.contact,className:"w-5 h-5 rounded-full object-cover flex-shrink-0"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-xs font-medium text-text-primary truncate",children:h==null?void 0:h.contact}),s.jsx("p",{className:"text-xs text-text-secondary truncate",children:h==null?void 0:h.company})]})]}),s.jsxs("div",{className:"flex items-center justify-between text-xs text-text-tertiary pt-2 border-t border-border",children:[s.jsxs("span",{className:"truncate",children:[h==null?void 0:h.daysInStage,"d"]}),s.jsx("span",{className:"truncate",children:h==null?void 0:h.lastActivity})]})]})},h==null?void 0:h.id)),c==null?void 0:c.placeholder,((f=e==null?void 0:e.deals)==null?void 0:f.length)===0&&s.jsxs("div",{className:"flex flex-col items-center justify-center py-6 text-text-tertiary",children:[s.jsx(G,{name:"Plus",size:20,className:"mb-1"}),s.jsx("span",{className:"text-xs",children:"Drop deals here"})]})]})}})]})},W_e=({data:e,revenueData:t=[]})=>{R.useEffect(()=>{kr.loadConfiguration()},[]);const r=c=>{const l=kr.getCurrency(),u=new Intl.NumberFormat("en-US",{style:"currency",currency:l,minimumFractionDigits:1,maximumFractionDigits:1});return c>=1e6?u.format(c/1e6).replace(/\.0/,"")+"M":c>=1e3?u.format(c/1e3).replace(/\.0/,"")+"K":u.format(c)},n=[{name:"Achieved",value:e==null?void 0:e.achieved,color:"#10B981"},{name:"Remaining",value:(e==null?void 0:e.quota)-(e==null?void 0:e.achieved),color:"#E5E7EB"}],a=[{name:"Won",value:e==null?void 0:e.dealsWon,color:"#10B981"},{name:"Lost",value:e==null?void 0:e.dealsLost,color:"#EF4444"}];t.length>0&&t.map(c=>({month:c.month,target:c.target,actual:c.actual}));const i=Math.PI/180,o=({cx:c,cy:l,midAngle:u,innerRadius:d,outerRadius:f,percent:h})=>{const m=d+(f-d)*.5,x=c+m*Math.cos(-u*i),p=l+m*Math.sin(-u*i);return s.jsx("text",{x,y:p,fill:"white",textAnchor:x>c?"start":"end",dominantBaseline:"central",fontSize:"12",fontWeight:"600",children:`${(h*100).toFixed(0)}%`})};return s.jsxs("div",{className:"card p-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-6",children:"Performance Metrics"}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium text-text-primary mb-4",children:"Quota Achievement"}),s.jsxs("div",{className:"flex items-center space-x-6",children:[s.jsx("div",{className:"w-32 h-32",children:s.jsx(zn,{width:"100%",height:"100%",children:s.jsx(ox,{children:s.jsx(si,{data:n,cx:"50%",cy:"50%",labelLine:!1,label:o,outerRadius:60,fill:"#8884d8",dataKey:"value",strokeWidth:0,children:n==null?void 0:n.map((c,l)=>s.jsx(Ns,{fill:c==null?void 0:c.color},`cell-${l}`))})})})}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-text-secondary",children:"Quota"}),s.jsx("p",{className:"text-lg font-semibold text-text-primary",children:r(e==null?void 0:e.quota)})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-text-secondary",children:"Achieved"}),s.jsx("p",{className:"text-lg font-semibold text-success",children:r(e==null?void 0:e.achieved)})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-text-secondary",children:"Remaining"}),s.jsx("p",{className:"text-lg font-semibold text-text-primary",children:r((e==null?void 0:e.quota)-(e==null?void 0:e.achieved))})]})]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium text-text-primary mb-4",children:"Deal Outcomes"}),s.jsxs("div",{className:"flex items-center space-x-6",children:[s.jsx("div",{className:"w-32 h-32",children:s.jsx(zn,{width:"100%",height:"100%",children:s.jsx(ox,{children:s.jsx(si,{data:a,cx:"50%",cy:"50%",labelLine:!1,label:o,outerRadius:60,fill:"#8884d8",dataKey:"value",strokeWidth:0,children:a==null?void 0:a.map((c,l)=>s.jsx(Ns,{fill:c==null?void 0:c.color},`cell-${l}`))})})})}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-text-secondary",children:"Deals Won"}),s.jsx("p",{className:"text-lg font-semibold text-success",children:e==null?void 0:e.dealsWon})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-text-secondary",children:"Deals Lost"}),s.jsx("p",{className:"text-lg font-semibold text-error",children:e==null?void 0:e.dealsLost})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-text-secondary",children:"Win Rate"}),s.jsxs("p",{className:"text-lg font-semibold text-text-primary",children:[((e==null?void 0:e.dealsWon)/((e==null?void 0:e.dealsWon)+(e==null?void 0:e.dealsLost))*100).toFixed(1),"%"]})]})]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mt-8 pt-6 border-t border-border",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-12 h-12 bg-primary-50 rounded-lg flex items-center justify-center mx-auto mb-2",children:s.jsx(G,{name:"DollarSign",size:20,className:"text-primary"})}),s.jsx("p",{className:"text-sm text-text-secondary",children:"Avg Deal Size"}),s.jsx("p",{className:"text-lg font-semibold text-text-primary",children:r(e==null?void 0:e.avgDealSize)})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-12 h-12 bg-success-50 rounded-lg flex items-center justify-center mx-auto mb-2",children:s.jsx(G,{name:"TrendingUp",size:20,className:"text-success"})}),s.jsx("p",{className:"text-sm text-text-secondary",children:"Conversion Rate"}),s.jsxs("p",{className:"text-lg font-semibold text-text-primary",children:[e==null?void 0:e.conversionRate,"%"]})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-12 h-12 bg-accent-50 rounded-lg flex items-center justify-center mx-auto mb-2",children:s.jsx(G,{name:"Clock",size:20,className:"text-accent"})}),s.jsx("p",{className:"text-sm text-text-secondary",children:"Avg Sales Cycle"}),s.jsx("p",{className:"text-lg font-semibold text-text-primary",children:"45 days"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-12 h-12 bg-secondary-50 rounded-lg flex items-center justify-center mx-auto mb-2",children:s.jsx(G,{name:"Target",size:20,className:"text-secondary"})}),s.jsx("p",{className:"text-sm text-text-secondary",children:"Activities"}),s.jsx("p",{className:"text-lg font-semibold text-text-primary",children:"127"})]})]})]})},z_e=()=>{var X,q,B,O;const{user:e,loading:t}=Pt(),[r,n]=R.useState("all"),[a,i]=R.useState("all"),[o,c]=R.useState("all"),[l,u]=R.useState(new Date),[d,f]=R.useState({}),[h,m]=R.useState([]),[x,p]=R.useState({}),[g,v]=R.useState(!0),[y,b]=R.useState(!1),[_,w]=R.useState("");R.useEffect(()=>{kr.loadConfiguration()},[]);const j=F=>{try{return kr.formatCurrency(F)}catch{return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(F)}},N=F=>{try{const I=kr.getCurrency(),L=new Intl.NumberFormat("en-US",{style:"currency",currency:I,minimumFractionDigits:1,maximumFractionDigits:1});return F>=1e6?L.format(F/1e6).replace(/\.0/,"")+"M":F>=1e3?L.format(F/1e3).replace(/\.0/,"")+"K":L.format(F)}catch{const L=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:1,maximumFractionDigits:1});return F>=1e6?L.format(F/1e6).replace(/\.0/,"")+"M":F>=1e3?L.format(F/1e3).replace(/\.0/,"")+"K":L.format(F)}},D=async(F=!1)=>{if(e)try{F?b(!0):v(!0),w("");const I={dateRange:r!=="all"?r:null,probabilityRange:a!=="all"?a:null,ownerId:o!=="all"?o:null},[L,C,k]=await Promise.all([ut==null?void 0:ut.getPipelineDeals(I),ut==null?void 0:ut.getRevenueData(),ut==null?void 0:ut.getPerformanceMetrics()]);f(L||{}),m(C||[]),p(k||{}),u(new Date)}catch(I){console.error("Error loading dashboard data:",I),w("Failed to load dashboard data. Please try again.")}finally{v(!1),b(!1)}};R.useEffect(()=>{e&&D()},[e]),R.useEffect(()=>{e&&D(!0)},[r,a,o]),R.useEffect(()=>{const F=setInterval(()=>{e&&D()},3e5);return()=>clearInterval(F)},[e]);const S=async F=>{var k,z;const{destination:I,source:L,draggableId:C}=F;if(I&&!((I==null?void 0:I.droppableId)===(L==null?void 0:L.droppableId)&&(I==null?void 0:I.index)===(L==null?void 0:L.index)))try{await(ut==null?void 0:ut.updateDealStage(C,I==null?void 0:I.droppableId));const V=d==null?void 0:d[L==null?void 0:L.droppableId],Z=d==null?void 0:d[I==null?void 0:I.droppableId],ce=(k=V==null?void 0:V.deals)==null?void 0:k.find(ie=>(ie==null?void 0:ie.id)===C);if(ce){const ie={lead:10,qualified:25,proposal:50,negotiation:75,closed_won:100,closed_lost:0},Q={...ce,probability:(ie==null?void 0:ie[I==null?void 0:I.droppableId])||(ce==null?void 0:ce.probability),daysInStage:0},ne=(z=V==null?void 0:V.deals)==null?void 0:z.filter(W=>(W==null?void 0:W.id)!==C),pe=[...(Z==null?void 0:Z.deals)||[]];pe==null||pe.splice(I==null?void 0:I.index,0,Q),f({...d,[L==null?void 0:L.droppableId]:{...V,deals:ne},[I==null?void 0:I.droppableId]:{...Z,deals:pe}})}}catch(V){console.error("Error updating deal stage:",V),w("Failed to update deal stage. Please try again.")}},T=F=>{var I;return((I=F==null?void 0:F.deals)==null?void 0:I.reduce((L,C)=>{const k=typeof(C==null?void 0:C.value)=="string"?parseFloat(C.value):(C==null?void 0:C.value)||0;return L+(isNaN(k)?0:k)},0))||0},A=F=>{var I;return((I=F==null?void 0:F.deals)==null?void 0:I.reduce((L,C)=>L+((C==null?void 0:C.value)||0)*((C==null?void 0:C.probability)||0)/100,0))||0},E=(X=Object.values(d))==null?void 0:X.reduce((F,I)=>F+T(I),0),M=(q=Object.values(d))==null?void 0:q.reduce((F,I)=>F+A(I),0),P=(B=Object.values(d))==null?void 0:B.reduce((F,I)=>{var L;return F+(((L=I==null?void 0:I.deals)==null?void 0:L.length)||0)},0);return t?s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),s.jsx("span",{className:"text-text-secondary",children:"Loading dashboard..."})]})}):e?s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(Ta,{}),s.jsx("main",{className:"pt-20 px-6 pb-8",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx(Ki,{}),s.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-8",children:s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-text-primary mb-2",children:"Sales Dashboard"}),s.jsxs("p",{className:"text-text-secondary",children:["Last updated: ",l==null?void 0:l.toLocaleTimeString(),"  Auto-refresh every 5 minutes"]})]})}),_&&s.jsxs("div",{className:"bg-error-50 border border-error-200 text-error p-4 rounded-lg mb-6 flex items-center space-x-2",children:[s.jsx(G,{name:"AlertCircle",size:20}),s.jsx("span",{children:_}),s.jsx("button",{onClick:()=>w(""),className:"ml-auto text-error hover:text-error-600",children:s.jsx(G,{name:"X",size:16})})]}),g?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),s.jsx("span",{className:"text-text-secondary",children:"Loading dashboard data..."})]})}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsx("div",{className:"card p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-text-secondary text-sm font-normal",children:"Total Pipeline"}),s.jsx("p",{className:"text-2xl font-normal text-text-primary",children:N(E)})]}),s.jsx("div",{className:"w-12 h-12 bg-primary-50 rounded-lg flex items-center justify-center",children:s.jsx(G,{name:"TrendingUp",size:24,className:"text-primary"})})]})}),s.jsx("div",{className:"card p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-text-secondary text-sm font-normal",children:"Weighted Pipeline"}),s.jsx("p",{className:"text-2xl font-normal text-text-primary",children:N(M)})]}),s.jsx("div",{className:"w-12 h-12 bg-success-50 rounded-lg flex items-center justify-center",children:s.jsx(G,{name:"Target",size:24,className:"text-success"})})]})}),s.jsx("div",{className:"card p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-text-secondary text-sm font-normal",children:"Active Deals"}),s.jsx("p",{className:"text-2xl font-normal text-text-primary",children:P})]}),s.jsx("div",{className:"w-12 h-12 bg-secondary-50 rounded-lg flex items-center justify-center",children:s.jsx(G,{name:"Briefcase",size:24,className:"text-secondary"})})]})}),s.jsx("div",{className:"card p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-text-secondary text-sm font-normal",children:"Quota Achievement"}),s.jsxs("p",{className:"text-2xl font-normal text-text-primary",children:[(x==null?void 0:x.percentage)||0,"%"]})]}),s.jsx("div",{className:"w-12 h-12 bg-accent-50 rounded-lg flex items-center justify-center",children:s.jsx(G,{name:"Award",size:24,className:"text-accent"})})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-4 gap-8",children:[s.jsxs("div",{className:"xl:col-span-3 space-y-8",children:[s.jsxs("div",{className:"card p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-xl font-normal text-text-primary",children:"Sales Pipeline"}),s.jsxs("div",{className:"flex items-center space-x-4",children:[y&&s.jsxs("div",{className:"flex items-center space-x-2 text-sm text-text-secondary",children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"}),s.jsx("span",{children:"Applying filters..."})]}),s.jsxs("div",{className:"hidden md:flex items-center space-x-2 text-sm text-text-secondary",children:[s.jsx(G,{name:"RefreshCw",size:16}),s.jsx("span",{children:"Drag deals to update stages"})]})]})]}),s.jsx(RV,{onDragEnd:S,children:s.jsx("div",{className:"overflow-x-auto pb-2 -mx-6 px-6",children:s.jsx("div",{className:"flex gap-4 min-w-max",children:(O=Object.values(d))==null?void 0:O.map(F=>s.jsx("div",{className:"w-72 flex-shrink-0",children:s.jsx($_e,{stage:F,totalValue:T(F),weightedValue:A(F)})},F==null?void 0:F.id))})})})]}),s.jsxs("div",{className:"card p-6",children:[s.jsx("h2",{className:"text-xl font-normal text-text-primary mb-6",children:"Monthly Revenue Forecast"}),s.jsx("div",{className:"h-80",children:s.jsx(zn,{width:"100%",height:"100%",children:s.jsxs(xl,{data:h,children:[s.jsx(xi,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),s.jsx(ta,{dataKey:"month",stroke:"#6B7280"}),s.jsx(ra,{stroke:"#6B7280",tickFormatter:F=>{const I=kr.getCurrency();return`${new Intl.NumberFormat("en-US",{style:"currency",currency:I}).formatToParts(0).find(C=>C.type==="currency").value}${F/1e3}K`}}),s.jsx(_r,{content:({active:F,payload:I})=>{if(F&&I&&I.length>0){const L=I[0].payload;return s.jsxs("div",{className:"bg-white p-3 border border-border rounded-lg shadow-lg",children:[s.jsx("p",{className:"font-semibold text-text-primary mb-2",children:L.month}),I.map((C,k)=>s.jsx("div",{className:"mb-1",children:s.jsxs("div",{className:"flex items-center justify-between gap-3",children:[s.jsxs("span",{className:"text-sm text-text-secondary",children:[C.name,":"]}),s.jsx("span",{className:"text-sm font-semibold",style:{color:C.color},children:j(C.value)})]})},k)),L.actualDealsCount!==void 0&&s.jsxs("div",{className:"mt-2 pt-2 border-t border-border",children:[s.jsxs("p",{className:"text-xs text-text-tertiary",children:[L.actualDealsCount," ",L.actualDealsCount===1?"deal":"deals"," closed"]}),L.totalDealsCount>0&&s.jsxs("p",{className:"text-xs text-text-tertiary",children:[L.totalDealsCount," total ",L.totalDealsCount===1?"deal":"deals"]})]})]})}return null}}),s.jsx(Ea,{dataKey:"forecast",fill:"var(--color-primary)",name:"Forecast"}),s.jsx(Ea,{dataKey:"actual",fill:"var(--color-success)",name:"Actual"})]})})})]}),s.jsx(W_e,{data:x,revenueData:h})]}),s.jsx("div",{className:"space-y-6",children:s.jsx(B_e,{})})]})]})]})})]}):s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(Ta,{}),s.jsx("main",{className:"pt-20 px-6 pb-8",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg mb-6",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"Info",size:20,className:"text-blue-600"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-blue-800 font-medium",children:"Preview Mode"}),s.jsxs("p",{className:"text-blue-700 text-sm",children:["This is how the sales dashboard looks when authenticated."," ",s.jsx("a",{href:"/login",className:"font-medium underline hover:text-primary-600",children:"Sign in to access real data"})]})]})]})}),s.jsxs("div",{className:"opacity-75",children:[s.jsx("h1",{className:"text-3xl font-bold text-text-primary mb-2",children:"Sales Dashboard"}),s.jsx("p",{className:"text-text-secondary mb-8",children:"Preview of your sales pipeline and performance metrics"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsx("div",{className:"card p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-text-secondary text-sm",children:"Total Pipeline"}),s.jsx("p",{className:"text-2xl font-normal text-text-primary",children:N(21e5)})]}),s.jsx("div",{className:"w-12 h-12 bg-primary-50 rounded-lg flex items-center justify-center",children:s.jsx(G,{name:"TrendingUp",size:24,className:"text-primary"})})]})}),s.jsx("div",{className:"card p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-text-secondary text-sm",children:"Weighted Pipeline"}),s.jsx("p",{className:"text-2xl font-normal text-text-primary",children:N(12e5)})]}),s.jsx("div",{className:"w-12 h-12 bg-success-50 rounded-lg flex items-center justify-center",children:s.jsx(G,{name:"Target",size:24,className:"text-success"})})]})}),s.jsx("div",{className:"card p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-text-secondary text-sm",children:"Active Deals"}),s.jsx("p",{className:"text-2xl font-normal text-text-primary",children:"24"})]}),s.jsx("div",{className:"w-12 h-12 bg-secondary-50 rounded-lg flex items-center justify-center",children:s.jsx(G,{name:"Briefcase",size:24,className:"text-secondary"})})]})}),s.jsx("div",{className:"card p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-text-secondary text-sm",children:"Quota Achievement"}),s.jsx("p",{className:"text-2xl font-normal text-text-primary",children:"74%"})]}),s.jsx("div",{className:"w-12 h-12 bg-accent-50 rounded-lg flex items-center justify-center",children:s.jsx(G,{name:"Award",size:24,className:"text-accent"})})]})})]}),s.jsxs("div",{className:"card p-6",children:[s.jsx("h2",{className:"text-xl font-normal text-text-primary mb-6",children:"Pipeline Preview"}),s.jsxs("div",{className:"text-center py-12",children:[s.jsx(G,{name:"BarChart3",size:48,className:"text-text-tertiary mx-auto mb-4"}),s.jsx("p",{className:"text-text-secondary",children:"Sign in to view your interactive sales pipeline"})]})]})]})]})})]})},dx=({currentPage:e,totalPages:t,totalItems:r,itemsPerPage:n,onPageChange:a,showInfo:i=!0})=>{if(t<=1)return null;const o=()=>{const d=[],f=Math.max(1,e-2),h=Math.min(t,e+2);f>1&&(d.push(1),f>2&&d.push("..."));for(let m=f;m<=h;m++)d.push(m);return h<t&&(h<t-1&&d.push("..."),d.push(t)),d},c=(e-1)*n+1,l=Math.min(e*n,r);return s.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 py-4",children:[i&&s.jsxs("div",{className:"text-sm text-text-secondary",children:["Showing ",c," to ",l," of ",r," items"]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("button",{onClick:()=>a(e-1),disabled:e===1,className:"p-2 rounded-lg border border-border text-text-secondary hover:text-text-primary hover:bg-surface-hover disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150",title:"Previous page",children:s.jsx(G,{name:"ChevronLeft",size:16})}),s.jsx("div",{className:"flex items-center gap-1",children:o().map((u,d)=>s.jsx(ge.Fragment,{children:u==="..."?s.jsx("span",{className:"px-3 py-2 text-text-tertiary",children:"..."}):s.jsx("button",{onClick:()=>a(u),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors duration-150 ${u===e?"bg-primary text-white":"text-text-secondary hover:text-text-primary hover:bg-surface-hover"}`,children:u})},d))}),s.jsx("button",{onClick:()=>a(e+1),disabled:e===t,className:"p-2 rounded-lg border border-border text-text-secondary hover:text-text-primary hover:bg-surface-hover disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150",title:"Next page",children:s.jsx(G,{name:"ChevronRight",size:16})})]})]})},Wt={async getAllCompanies(){console.log("DEBUG: companiesService.getAllCompanies() called");try{const{data:e,error:t}=await be.get("/api/v1/companies");if(console.log("DEBUG: getAllCompanies response - data:",e,"error:",t),t)throw t;return e||[]}catch(e){throw console.error("DEBUG: getAllCompanies error:",e),e}},async getCompanyById(e){const{data:t,error:r}=await be.get(`/api/v1/companies/${e}`);if(r){if(r.status===404)return null;throw r}return t},async createCompany(e){const t={name:e.name,industry:e.industry||null,size:e.size||null,website:e.website||null,phone:e.phone||null,email:e.email||null,address:e.address||null,city:e.city||null,state:e.state||null,zip_code:e.zip_code||null,country:e.country||null,description:e.description||null,revenue:e.revenue||null,custom_fields:e.custom_fields||void 0},{data:r,error:n}=await be.post("/api/v1/companies",t);if(n)throw n;return r},async updateCompany(e,t){const r={name:t.name,industry:t.industry||null,size:t.size||null,website:t.website||null,phone:t.phone||null,email:t.email||null,address:t.address||null,city:t.city||null,state:t.state||null,zip_code:t.zip_code||null,country:t.country||null,description:t.description||null,revenue:t.revenue||null,custom_fields:t.custom_fields||void 0},{data:n,error:a}=await be.put(`/api/v1/companies/${e}`,r);if(a)throw a;return n},async deleteCompany(e){const{data:t,error:r}=await be.delete(`/api/v1/companies/${e}`);if(r)throw r;return!0},async searchCompanies(e){const{data:t,error:r}=await be.get(`/api/v1/companies/search?q=${encodeURIComponent(e)}`);if(r)throw r;return t||[]},async getCompaniesByIndustry(e){const{data:t,error:r}=await be.get(`/api/v1/companies?industry=${encodeURIComponent(e)}`);if(r)throw r;return t||[]},async getCompanyStats(){console.log("DEBUG: companiesService.getCompanyStats() called");try{const{data:e,error:t}=await be.get("/api/v1/companies/statistics");if(console.log("DEBUG: getCompanyStats response - data:",e,"error:",t),t){console.log("DEBUG: getCompanyStats API failed, using fallback");const r=await this.getAllCompanies(),n={total:r.length||0,industries:{},sizes:{},recentlyAdded:r.filter(a=>{const i=new Date(a.created_at),o=new Date;return o.setDate(o.getDate()-30),i>o}).length};return r.forEach(a=>{const i=a.industry||"unknown";n.industries[i]=(n.industries[i]||0)+1}),r.forEach(a=>{const i=a.size||"unknown";n.sizes[i]=(n.sizes[i]||0)+1}),console.log("DEBUG: getCompanyStats fallback result:",n),n}return console.log("DEBUG: getCompanyStats success result:",e),e}catch(e){throw console.error("DEBUG: getCompanyStats error:",e),e}},async getCompaniesWithData(){const{data:e,error:t}=await be.get("/api/v1/companies?include=contacts,deals");if(t)throw t;return e||[]},async filterCompanies(e){const t=new URLSearchParams;e.industry&&e.industry.length>0&&t.append("industry",e.industry.join(",")),e.size&&e.size.length>0&&t.append("size",e.size.join(",")),e.location&&e.location.length>0&&t.append("location",e.location.join(",")),e.revenueRange&&(e.revenueRange.min!==void 0&&t.append("min_revenue",e.revenueRange.min),e.revenueRange.max!==void 0&&t.append("max_revenue",e.revenueRange.max)),e.dateRange&&(t.append("date_start",e.dateRange.start),t.append("date_end",e.dateRange.end));const r=t.toString(),n=r?`/api/v1/companies?${r}`:"/api/v1/companies",{data:a,error:i}=await be.get(n);if(i)throw i;return a||[]},async getCompanyWithRelations(e){const{data:t,error:r}=await be.get(`/api/v1/companies/${e}?include=contacts,deals,activities`);if(r){if(r.status===404)return null;throw r}return t},async importCompanies(e){try{return await Promise.all(e.map(r=>this.createCompany(r)))}catch(t){throw t}},subscribeToCompanies(e){return{unsubscribe:()=>{}}}},W_="-",q_e=e=>{const t=V_e(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:o=>{const c=o.split(W_);return c[0]===""&&c.length!==1&&c.shift(),Q8(c,t)||H_e(o)},getConflictingClassGroupIds:(o,c)=>{const l=r[o]||[];return c&&n[o]?[...l,...n[o]]:l}}},Q8=(e,t)=>{var o;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),a=n?Q8(e.slice(1),n):void 0;if(a)return a;if(t.validators.length===0)return;const i=e.join(W_);return(o=t.validators.find(({validator:c})=>c(i)))==null?void 0:o.classGroupId},SA=/^\[(.+)\]$/,H_e=e=>{if(SA.test(e)){const t=SA.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},V_e=e=>{const{theme:t,classGroups:r}=e,n={nextPart:new Map,validators:[]};for(const a in r)N2(r[a],n,a,t);return n},N2=(e,t,r,n)=>{e.forEach(a=>{if(typeof a=="string"){const i=a===""?t:EA(t,a);i.classGroupId=r;return}if(typeof a=="function"){if(G_e(a)){N2(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([i,o])=>{N2(o,EA(t,i),r,n)})})},EA=(e,t)=>{let r=e;return t.split(W_).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},G_e=e=>e.isThemeGetter,X_e=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const a=(i,o)=>{r.set(i,o),t++,t>e&&(t=0,n=r,r=new Map)};return{get(i){let o=r.get(i);if(o!==void 0)return o;if((o=n.get(i))!==void 0)return a(i,o),o},set(i,o){r.has(i)?r.set(i,o):a(i,o)}}},D2="!",S2=":",K_e=S2.length,Y_e=e=>{const{prefix:t,experimentalParseClassName:r}=e;let n=a=>{const i=[];let o=0,c=0,l=0,u;for(let x=0;x<a.length;x++){let p=a[x];if(o===0&&c===0){if(p===S2){i.push(a.slice(l,x)),l=x+K_e;continue}if(p==="/"){u=x;continue}}p==="["?o++:p==="]"?o--:p==="("?c++:p===")"&&c--}const d=i.length===0?a:a.substring(l),f=Z_e(d),h=f!==d,m=u&&u>l?u-l:void 0;return{modifiers:i,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:m}};if(t){const a=t+S2,i=n;n=o=>o.startsWith(a)?i(o.substring(a.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:o,maybePostfixModifierPosition:void 0}}if(r){const a=n;n=i=>r({className:i,parseClassName:a})}return n},Z_e=e=>e.endsWith(D2)?e.substring(0,e.length-1):e.startsWith(D2)?e.substring(1):e,J_e=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(n=>[n,!0]));return n=>{if(n.length<=1)return n;const a=[];let i=[];return n.forEach(o=>{o[0]==="["||t[o]?(a.push(...i.sort(),o),i=[]):i.push(o)}),a.push(...i.sort()),a}},Q_e=e=>({cache:X_e(e.cacheSize),parseClassName:Y_e(e),sortModifiers:J_e(e),...q_e(e)}),eje=/\s+/,tje=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a,sortModifiers:i}=t,o=[],c=e.trim().split(eje);let l="";for(let u=c.length-1;u>=0;u-=1){const d=c[u],{isExternal:f,modifiers:h,hasImportantModifier:m,baseClassName:x,maybePostfixModifierPosition:p}=r(d);if(f){l=d+(l.length>0?" "+l:l);continue}let g=!!p,v=n(g?x.substring(0,p):x);if(!v){if(!g){l=d+(l.length>0?" "+l:l);continue}if(v=n(x),!v){l=d+(l.length>0?" "+l:l);continue}g=!1}const y=i(h).join(":"),b=m?y+D2:y,_=b+v;if(o.includes(_))continue;o.push(_);const w=a(v,g);for(let j=0;j<w.length;++j){const N=w[j];o.push(b+N)}l=d+(l.length>0?" "+l:l)}return l};function rje(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=eI(t))&&(n&&(n+=" "),n+=r);return n}const eI=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=eI(e[n]))&&(r&&(r+=" "),r+=t);return r};function nje(e,...t){let r,n,a,i=o;function o(l){const u=t.reduce((d,f)=>f(d),e());return r=Q_e(u),n=r.cache.get,a=r.cache.set,i=c,c(l)}function c(l){const u=n(l);if(u)return u;const d=tje(l,r);return a(l,d),d}return function(){return i(rje.apply(null,arguments))}}const Lr=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},tI=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,rI=/^\((?:(\w[\w-]*):)?(.+)\)$/i,aje=/^\d+\/\d+$/,ije=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,sje=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,oje=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,cje=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,lje=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Hc=e=>aje.test(e),wt=e=>!!e&&!Number.isNaN(Number(e)),$s=e=>!!e&&Number.isInteger(Number(e)),ry=e=>e.endsWith("%")&&wt(e.slice(0,-1)),ss=e=>ije.test(e),uje=()=>!0,dje=e=>sje.test(e)&&!oje.test(e),nI=()=>!1,fje=e=>cje.test(e),hje=e=>lje.test(e),mje=e=>!Ke(e)&&!Ye(e),pje=e=>Au(e,sI,nI),Ke=e=>tI.test(e),$o=e=>Au(e,oI,dje),ny=e=>Au(e,bje,wt),TA=e=>Au(e,aI,nI),xje=e=>Au(e,iI,hje),mm=e=>Au(e,cI,fje),Ye=e=>rI.test(e),id=e=>ku(e,oI),gje=e=>ku(e,wje),CA=e=>ku(e,aI),vje=e=>ku(e,sI),yje=e=>ku(e,iI),pm=e=>ku(e,cI,!0),Au=(e,t,r)=>{const n=tI.exec(e);return n?n[1]?t(n[1]):r(n[2]):!1},ku=(e,t,r=!1)=>{const n=rI.exec(e);return n?n[1]?t(n[1]):r:!1},aI=e=>e==="position"||e==="percentage",iI=e=>e==="image"||e==="url",sI=e=>e==="length"||e==="size"||e==="bg-size",oI=e=>e==="length",bje=e=>e==="number",wje=e=>e==="family-name",cI=e=>e==="shadow",_je=()=>{const e=Lr("color"),t=Lr("font"),r=Lr("text"),n=Lr("font-weight"),a=Lr("tracking"),i=Lr("leading"),o=Lr("breakpoint"),c=Lr("container"),l=Lr("spacing"),u=Lr("radius"),d=Lr("shadow"),f=Lr("inset-shadow"),h=Lr("text-shadow"),m=Lr("drop-shadow"),x=Lr("blur"),p=Lr("perspective"),g=Lr("aspect"),v=Lr("ease"),y=Lr("animate"),b=()=>["auto","avoid","all","avoid-page","page","left","right","column"],_=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],w=()=>[..._(),Ye,Ke],j=()=>["auto","hidden","clip","visible","scroll"],N=()=>["auto","contain","none"],D=()=>[Ye,Ke,l],S=()=>[Hc,"full","auto",...D()],T=()=>[$s,"none","subgrid",Ye,Ke],A=()=>["auto",{span:["full",$s,Ye,Ke]},$s,Ye,Ke],E=()=>[$s,"auto",Ye,Ke],M=()=>["auto","min","max","fr",Ye,Ke],P=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],X=()=>["start","end","center","stretch","center-safe","end-safe"],q=()=>["auto",...D()],B=()=>[Hc,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...D()],O=()=>[e,Ye,Ke],F=()=>[..._(),CA,TA,{position:[Ye,Ke]}],I=()=>["no-repeat",{repeat:["","x","y","space","round"]}],L=()=>["auto","cover","contain",vje,pje,{size:[Ye,Ke]}],C=()=>[ry,id,$o],k=()=>["","none","full",u,Ye,Ke],z=()=>["",wt,id,$o],V=()=>["solid","dashed","dotted","double"],Z=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ce=()=>[wt,ry,CA,TA],ie=()=>["","none",x,Ye,Ke],Q=()=>["none",wt,Ye,Ke],ne=()=>["none",wt,Ye,Ke],pe=()=>[wt,Ye,Ke],W=()=>[Hc,"full",...D()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[ss],breakpoint:[ss],color:[uje],container:[ss],"drop-shadow":[ss],ease:["in","out","in-out"],font:[mje],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[ss],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[ss],shadow:[ss],spacing:["px",wt],text:[ss],"text-shadow":[ss],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Hc,Ke,Ye,g]}],container:["container"],columns:[{columns:[wt,Ke,Ye,c]}],"break-after":[{"break-after":b()}],"break-before":[{"break-before":b()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:w()}],overflow:[{overflow:j()}],"overflow-x":[{"overflow-x":j()}],"overflow-y":[{"overflow-y":j()}],overscroll:[{overscroll:N()}],"overscroll-x":[{"overscroll-x":N()}],"overscroll-y":[{"overscroll-y":N()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:S()}],"inset-x":[{"inset-x":S()}],"inset-y":[{"inset-y":S()}],start:[{start:S()}],end:[{end:S()}],top:[{top:S()}],right:[{right:S()}],bottom:[{bottom:S()}],left:[{left:S()}],visibility:["visible","invisible","collapse"],z:[{z:[$s,"auto",Ye,Ke]}],basis:[{basis:[Hc,"full","auto",c,...D()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[wt,Hc,"auto","initial","none",Ke]}],grow:[{grow:["",wt,Ye,Ke]}],shrink:[{shrink:["",wt,Ye,Ke]}],order:[{order:[$s,"first","last","none",Ye,Ke]}],"grid-cols":[{"grid-cols":T()}],"col-start-end":[{col:A()}],"col-start":[{"col-start":E()}],"col-end":[{"col-end":E()}],"grid-rows":[{"grid-rows":T()}],"row-start-end":[{row:A()}],"row-start":[{"row-start":E()}],"row-end":[{"row-end":E()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":M()}],"auto-rows":[{"auto-rows":M()}],gap:[{gap:D()}],"gap-x":[{"gap-x":D()}],"gap-y":[{"gap-y":D()}],"justify-content":[{justify:[...P(),"normal"]}],"justify-items":[{"justify-items":[...X(),"normal"]}],"justify-self":[{"justify-self":["auto",...X()]}],"align-content":[{content:["normal",...P()]}],"align-items":[{items:[...X(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...X(),{baseline:["","last"]}]}],"place-content":[{"place-content":P()}],"place-items":[{"place-items":[...X(),"baseline"]}],"place-self":[{"place-self":["auto",...X()]}],p:[{p:D()}],px:[{px:D()}],py:[{py:D()}],ps:[{ps:D()}],pe:[{pe:D()}],pt:[{pt:D()}],pr:[{pr:D()}],pb:[{pb:D()}],pl:[{pl:D()}],m:[{m:q()}],mx:[{mx:q()}],my:[{my:q()}],ms:[{ms:q()}],me:[{me:q()}],mt:[{mt:q()}],mr:[{mr:q()}],mb:[{mb:q()}],ml:[{ml:q()}],"space-x":[{"space-x":D()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":D()}],"space-y-reverse":["space-y-reverse"],size:[{size:B()}],w:[{w:[c,"screen",...B()]}],"min-w":[{"min-w":[c,"screen","none",...B()]}],"max-w":[{"max-w":[c,"screen","none","prose",{screen:[o]},...B()]}],h:[{h:["screen","lh",...B()]}],"min-h":[{"min-h":["screen","lh","none",...B()]}],"max-h":[{"max-h":["screen","lh",...B()]}],"font-size":[{text:["base",r,id,$o]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,Ye,ny]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",ry,Ke]}],"font-family":[{font:[gje,Ke,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[a,Ye,Ke]}],"line-clamp":[{"line-clamp":[wt,"none",Ye,ny]}],leading:[{leading:[i,...D()]}],"list-image":[{"list-image":["none",Ye,Ke]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Ye,Ke]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:O()}],"text-color":[{text:O()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...V(),"wavy"]}],"text-decoration-thickness":[{decoration:[wt,"from-font","auto",Ye,$o]}],"text-decoration-color":[{decoration:O()}],"underline-offset":[{"underline-offset":[wt,"auto",Ye,Ke]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:D()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ye,Ke]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ye,Ke]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:F()}],"bg-repeat":[{bg:I()}],"bg-size":[{bg:L()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},$s,Ye,Ke],radial:["",Ye,Ke],conic:[$s,Ye,Ke]},yje,xje]}],"bg-color":[{bg:O()}],"gradient-from-pos":[{from:C()}],"gradient-via-pos":[{via:C()}],"gradient-to-pos":[{to:C()}],"gradient-from":[{from:O()}],"gradient-via":[{via:O()}],"gradient-to":[{to:O()}],rounded:[{rounded:k()}],"rounded-s":[{"rounded-s":k()}],"rounded-e":[{"rounded-e":k()}],"rounded-t":[{"rounded-t":k()}],"rounded-r":[{"rounded-r":k()}],"rounded-b":[{"rounded-b":k()}],"rounded-l":[{"rounded-l":k()}],"rounded-ss":[{"rounded-ss":k()}],"rounded-se":[{"rounded-se":k()}],"rounded-ee":[{"rounded-ee":k()}],"rounded-es":[{"rounded-es":k()}],"rounded-tl":[{"rounded-tl":k()}],"rounded-tr":[{"rounded-tr":k()}],"rounded-br":[{"rounded-br":k()}],"rounded-bl":[{"rounded-bl":k()}],"border-w":[{border:z()}],"border-w-x":[{"border-x":z()}],"border-w-y":[{"border-y":z()}],"border-w-s":[{"border-s":z()}],"border-w-e":[{"border-e":z()}],"border-w-t":[{"border-t":z()}],"border-w-r":[{"border-r":z()}],"border-w-b":[{"border-b":z()}],"border-w-l":[{"border-l":z()}],"divide-x":[{"divide-x":z()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":z()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...V(),"hidden","none"]}],"divide-style":[{divide:[...V(),"hidden","none"]}],"border-color":[{border:O()}],"border-color-x":[{"border-x":O()}],"border-color-y":[{"border-y":O()}],"border-color-s":[{"border-s":O()}],"border-color-e":[{"border-e":O()}],"border-color-t":[{"border-t":O()}],"border-color-r":[{"border-r":O()}],"border-color-b":[{"border-b":O()}],"border-color-l":[{"border-l":O()}],"divide-color":[{divide:O()}],"outline-style":[{outline:[...V(),"none","hidden"]}],"outline-offset":[{"outline-offset":[wt,Ye,Ke]}],"outline-w":[{outline:["",wt,id,$o]}],"outline-color":[{outline:O()}],shadow:[{shadow:["","none",d,pm,mm]}],"shadow-color":[{shadow:O()}],"inset-shadow":[{"inset-shadow":["none",f,pm,mm]}],"inset-shadow-color":[{"inset-shadow":O()}],"ring-w":[{ring:z()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:O()}],"ring-offset-w":[{"ring-offset":[wt,$o]}],"ring-offset-color":[{"ring-offset":O()}],"inset-ring-w":[{"inset-ring":z()}],"inset-ring-color":[{"inset-ring":O()}],"text-shadow":[{"text-shadow":["none",h,pm,mm]}],"text-shadow-color":[{"text-shadow":O()}],opacity:[{opacity:[wt,Ye,Ke]}],"mix-blend":[{"mix-blend":[...Z(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Z()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[wt]}],"mask-image-linear-from-pos":[{"mask-linear-from":ce()}],"mask-image-linear-to-pos":[{"mask-linear-to":ce()}],"mask-image-linear-from-color":[{"mask-linear-from":O()}],"mask-image-linear-to-color":[{"mask-linear-to":O()}],"mask-image-t-from-pos":[{"mask-t-from":ce()}],"mask-image-t-to-pos":[{"mask-t-to":ce()}],"mask-image-t-from-color":[{"mask-t-from":O()}],"mask-image-t-to-color":[{"mask-t-to":O()}],"mask-image-r-from-pos":[{"mask-r-from":ce()}],"mask-image-r-to-pos":[{"mask-r-to":ce()}],"mask-image-r-from-color":[{"mask-r-from":O()}],"mask-image-r-to-color":[{"mask-r-to":O()}],"mask-image-b-from-pos":[{"mask-b-from":ce()}],"mask-image-b-to-pos":[{"mask-b-to":ce()}],"mask-image-b-from-color":[{"mask-b-from":O()}],"mask-image-b-to-color":[{"mask-b-to":O()}],"mask-image-l-from-pos":[{"mask-l-from":ce()}],"mask-image-l-to-pos":[{"mask-l-to":ce()}],"mask-image-l-from-color":[{"mask-l-from":O()}],"mask-image-l-to-color":[{"mask-l-to":O()}],"mask-image-x-from-pos":[{"mask-x-from":ce()}],"mask-image-x-to-pos":[{"mask-x-to":ce()}],"mask-image-x-from-color":[{"mask-x-from":O()}],"mask-image-x-to-color":[{"mask-x-to":O()}],"mask-image-y-from-pos":[{"mask-y-from":ce()}],"mask-image-y-to-pos":[{"mask-y-to":ce()}],"mask-image-y-from-color":[{"mask-y-from":O()}],"mask-image-y-to-color":[{"mask-y-to":O()}],"mask-image-radial":[{"mask-radial":[Ye,Ke]}],"mask-image-radial-from-pos":[{"mask-radial-from":ce()}],"mask-image-radial-to-pos":[{"mask-radial-to":ce()}],"mask-image-radial-from-color":[{"mask-radial-from":O()}],"mask-image-radial-to-color":[{"mask-radial-to":O()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":_()}],"mask-image-conic-pos":[{"mask-conic":[wt]}],"mask-image-conic-from-pos":[{"mask-conic-from":ce()}],"mask-image-conic-to-pos":[{"mask-conic-to":ce()}],"mask-image-conic-from-color":[{"mask-conic-from":O()}],"mask-image-conic-to-color":[{"mask-conic-to":O()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:F()}],"mask-repeat":[{mask:I()}],"mask-size":[{mask:L()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Ye,Ke]}],filter:[{filter:["","none",Ye,Ke]}],blur:[{blur:ie()}],brightness:[{brightness:[wt,Ye,Ke]}],contrast:[{contrast:[wt,Ye,Ke]}],"drop-shadow":[{"drop-shadow":["","none",m,pm,mm]}],"drop-shadow-color":[{"drop-shadow":O()}],grayscale:[{grayscale:["",wt,Ye,Ke]}],"hue-rotate":[{"hue-rotate":[wt,Ye,Ke]}],invert:[{invert:["",wt,Ye,Ke]}],saturate:[{saturate:[wt,Ye,Ke]}],sepia:[{sepia:["",wt,Ye,Ke]}],"backdrop-filter":[{"backdrop-filter":["","none",Ye,Ke]}],"backdrop-blur":[{"backdrop-blur":ie()}],"backdrop-brightness":[{"backdrop-brightness":[wt,Ye,Ke]}],"backdrop-contrast":[{"backdrop-contrast":[wt,Ye,Ke]}],"backdrop-grayscale":[{"backdrop-grayscale":["",wt,Ye,Ke]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[wt,Ye,Ke]}],"backdrop-invert":[{"backdrop-invert":["",wt,Ye,Ke]}],"backdrop-opacity":[{"backdrop-opacity":[wt,Ye,Ke]}],"backdrop-saturate":[{"backdrop-saturate":[wt,Ye,Ke]}],"backdrop-sepia":[{"backdrop-sepia":["",wt,Ye,Ke]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":D()}],"border-spacing-x":[{"border-spacing-x":D()}],"border-spacing-y":[{"border-spacing-y":D()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Ye,Ke]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[wt,"initial",Ye,Ke]}],ease:[{ease:["linear","initial",v,Ye,Ke]}],delay:[{delay:[wt,Ye,Ke]}],animate:[{animate:["none",y,Ye,Ke]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[p,Ye,Ke]}],"perspective-origin":[{"perspective-origin":w()}],rotate:[{rotate:Q()}],"rotate-x":[{"rotate-x":Q()}],"rotate-y":[{"rotate-y":Q()}],"rotate-z":[{"rotate-z":Q()}],scale:[{scale:ne()}],"scale-x":[{"scale-x":ne()}],"scale-y":[{"scale-y":ne()}],"scale-z":[{"scale-z":ne()}],"scale-3d":["scale-3d"],skew:[{skew:pe()}],"skew-x":[{"skew-x":pe()}],"skew-y":[{"skew-y":pe()}],transform:[{transform:[Ye,Ke,"","none","gpu","cpu"]}],"transform-origin":[{origin:w()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:W()}],"translate-x":[{"translate-x":W()}],"translate-y":[{"translate-y":W()}],"translate-z":[{"translate-z":W()}],"translate-none":["translate-none"],accent:[{accent:O()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:O()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ye,Ke]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":D()}],"scroll-mx":[{"scroll-mx":D()}],"scroll-my":[{"scroll-my":D()}],"scroll-ms":[{"scroll-ms":D()}],"scroll-me":[{"scroll-me":D()}],"scroll-mt":[{"scroll-mt":D()}],"scroll-mr":[{"scroll-mr":D()}],"scroll-mb":[{"scroll-mb":D()}],"scroll-ml":[{"scroll-ml":D()}],"scroll-p":[{"scroll-p":D()}],"scroll-px":[{"scroll-px":D()}],"scroll-py":[{"scroll-py":D()}],"scroll-ps":[{"scroll-ps":D()}],"scroll-pe":[{"scroll-pe":D()}],"scroll-pt":[{"scroll-pt":D()}],"scroll-pr":[{"scroll-pr":D()}],"scroll-pb":[{"scroll-pb":D()}],"scroll-pl":[{"scroll-pl":D()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ye,Ke]}],fill:[{fill:["none",...O()]}],"stroke-w":[{stroke:[wt,id,$o,ny]}],stroke:[{stroke:["none",...O()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},jje=nje(_je);function Xa(...e){return jje(dt(e))}function AA(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Nje(...e){return t=>{let r=!1;const n=e.map(a=>{const i=AA(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():AA(e[a],null)}}}}function Dje(e){const t=Eje(e),r=R.forwardRef((n,a)=>{const{children:i,...o}=n,c=R.Children.toArray(i),l=c.find(Cje);if(l){const u=l.props.children,d=c.map(f=>f===l?R.Children.count(u)>1?R.Children.only(null):R.isValidElement(u)?u.props.children:null:f);return s.jsx(t,{...o,ref:a,children:R.isValidElement(u)?R.cloneElement(u,void 0,d):null})}return s.jsx(t,{...o,ref:a,children:i})});return r.displayName=`${e}.Slot`,r}var Sje=Dje("Slot");function Eje(e){const t=R.forwardRef((r,n)=>{const{children:a,...i}=r;if(R.isValidElement(a)){const o=kje(a),c=Aje(i,a.props);return a.type!==R.Fragment&&(c.ref=n?Nje(n,o):o),R.cloneElement(a,c)}return R.Children.count(a)>1?R.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Tje=Symbol("radix.slottable");function Cje(e){return R.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Tje}function Aje(e,t){const r={...t};for(const n in t){const a=e[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...c)=>{const l=i(...c);return a(...c),l}:a&&(r[n]=a):n==="style"?r[n]={...a,...i}:n==="className"&&(r[n]=[a,i].filter(Boolean).join(" "))}return{...e,...r}}function kje(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}const kA=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,FA=dt,Fje=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return FA(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:i}=t,o=Object.keys(a).map(u=>{const d=r==null?void 0:r[u],f=i==null?void 0:i[u];if(d===null)return null;const h=kA(d)||kA(f);return a[u][h]}),c=r&&Object.entries(r).reduce((u,d)=>{let[f,h]=d;return h===void 0||(u[f]=h),u},{}),l=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((u,d)=>{let{class:f,className:h,...m}=d;return Object.entries(m).every(x=>{let[p,g]=x;return Array.isArray(g)?g.includes({...i,...c}[p]):{...i,...c}[p]===g})?[...u,f,h]:u},[]);return FA(e,o,l,r==null?void 0:r.class,r==null?void 0:r.className)},Oje=Fje("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",success:"bg-success text-success-foreground hover:bg-success/90",warning:"bg-warning text-warning-foreground hover:bg-warning/90",danger:"bg-error text-error-foreground hover:bg-error/90"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10",xs:"h-8 rounded-md px-2 text-xs",xl:"h-12 rounded-md px-10 text-base"}},defaultVariants:{variant:"default",size:"default"}}),lI=ge.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,children:a,loading:i=!1,iconName:o=null,iconPosition:c="left",iconSize:l=null,fullWidth:u=!1,disabled:d=!1,...f},h)=>{const m=n?Sje:"button",x={xs:12,sm:14,default:16,lg:18,xl:20,icon:16},p=l||(x==null?void 0:x[r])||16,g=()=>s.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),v=()=>o?s.jsx(G,{name:o,size:p,className:Xa(a&&c==="left"&&"mr-2",a&&c==="right"&&"ml-2")}):null;return s.jsxs(m,{className:Xa(Oje({variant:t,size:r,className:e}),u&&"w-full"),ref:h,disabled:d||i,...f,children:[i&&s.jsx(g,{}),o&&c==="left"&&v(),a,o&&c==="right"&&v()]})});lI.displayName="Button";const uI=ge.forwardRef(({className:e,type:t="text",label:r,description:n,error:a,required:i=!1,id:o,...c},l)=>{var f,h;const u=o||`input-${(h=(f=Math.random())==null?void 0:f.toString(36))==null?void 0:h.substr(2,9)}`,d="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50";return t==="checkbox"?s.jsx("input",{type:"checkbox",className:Xa("h-4 w-4 rounded border border-input bg-background text-primary focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:l,id:u,...c}):t==="radio"?s.jsx("input",{type:"radio",className:Xa("h-4 w-4 rounded-full border border-input bg-background text-primary focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:l,id:u,...c}):s.jsxs("div",{className:"space-y-2",children:[r&&s.jsxs("label",{htmlFor:u,className:Xa("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",a?"text-destructive":"text-foreground"),children:[r,i&&s.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),s.jsx("input",{type:t,className:Xa(d,a&&"border-destructive focus-visible:ring-destructive",e),ref:l,id:u,...c}),n&&!a&&s.jsx("p",{className:"text-sm text-muted-foreground",children:n}),a&&s.jsx("p",{className:"text-sm text-destructive",children:a})]})});uI.displayName="Input";const dI=ge.forwardRef(({className:e,options:t=[],value:r,defaultValue:n,placeholder:a="Select an option",multiple:i=!1,disabled:o=!1,required:c=!1,label:l,description:u,error:d,searchable:f=!1,clearable:h=!1,loading:m=!1,id:x,name:p,onChange:g,onOpenChange:v,...y},b)=>{var O,F;const[_,w]=R.useState(!1),[j,N]=R.useState(""),D=R.useRef(null),S=x||`select-${(F=(O=Math.random())==null?void 0:O.toString(36))==null?void 0:F.substr(2,9)}`;R.useEffect(()=>{const I=L=>{D.current&&!D.current.contains(L.target)&&(w(!1),v==null||v(!1),N(""))};return _&&document.addEventListener("mousedown",I),()=>{document.removeEventListener("mousedown",I)}},[_,v]);const T=f&&j?t==null?void 0:t.filter(I=>{var L,C,k,z,V;return((C=(L=I==null?void 0:I.label)==null?void 0:L.toLowerCase())==null?void 0:C.includes(j==null?void 0:j.toLowerCase()))||(I==null?void 0:I.value)&&((V=(z=(k=I==null?void 0:I.value)==null?void 0:k.toString())==null?void 0:z.toLowerCase())==null?void 0:V.includes(j==null?void 0:j.toLowerCase()))}):t,A=()=>{var L;if(!r)return a;if(i){const C=t==null?void 0:t.filter(k=>r==null?void 0:r.includes(k==null?void 0:k.value));return(C==null?void 0:C.length)===0?a:(L=C==null?void 0:C.map(k=>k==null?void 0:k.label))==null?void 0:L.join(", ")}const I=t==null?void 0:t.find(C=>(C==null?void 0:C.value)===r);return I?I==null?void 0:I.label:a},E=()=>{if(!o){const I=!_;w(I),v==null||v(I),I||N("")}},M=I=>{if(i){const L=r||[],C=L!=null&&L.includes(I==null?void 0:I.value)?L==null?void 0:L.filter(k=>k!==(I==null?void 0:I.value)):[...L,I==null?void 0:I.value];g==null||g(C)}else g==null||g(I==null?void 0:I.value),w(!1),v==null||v(!1)},P=I=>{I==null||I.stopPropagation(),g==null||g(i?[]:"")},X=I=>{var L;N((L=I==null?void 0:I.target)==null?void 0:L.value)},q=I=>i?(r==null?void 0:r.includes(I))||!1:r===I,B=i?(r==null?void 0:r.length)>0:r!==void 0&&r!=="";return s.jsxs("div",{ref:D,className:Xa("relative",e),children:[l&&s.jsxs("label",{htmlFor:S,className:Xa("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 mb-2 block",d?"text-destructive":"text-foreground"),children:[l,c&&s.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsxs("button",{ref:b,id:S,type:"button",className:Xa("flex h-10 w-full items-center justify-between rounded-md border border-input bg-white text-black px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",d&&"border-destructive focus:ring-destructive",!B&&"text-muted-foreground"),onClick:E,disabled:o,"aria-expanded":_,"aria-haspopup":"listbox",...y,children:[s.jsx("span",{className:"truncate",children:A()}),s.jsxs("div",{className:"flex items-center gap-1",children:[m&&s.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),h&&B&&!m&&s.jsx(lI,{variant:"ghost",size:"icon",className:"h-4 w-4",onClick:P,children:s.jsx(Z4,{className:"h-3 w-3"})}),s.jsx(JL,{className:Xa("h-4 w-4 transition-transform",_&&"rotate-180")})]})]}),s.jsxs("select",{name:p,value:r||"",onChange:()=>{},className:"sr-only",tabIndex:-1,multiple:i,required:c,children:[s.jsx("option",{value:"",children:"Select..."}),t==null?void 0:t.map(I=>s.jsx("option",{value:I==null?void 0:I.value,children:I==null?void 0:I.label},I==null?void 0:I.value))]}),_&&s.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white text-black border border-gray-200 rounded-md shadow-lg animate-in fade-in-0 zoom-in-95",children:[f&&s.jsx("div",{className:"p-2 border-b border-gray-100",children:s.jsxs("div",{className:"relative",children:[s.jsx(QL,{className:"absolute left-2 top-2.5 h-4 w-4 text-gray-400"}),s.jsx(uI,{placeholder:"Search options...",value:j,onChange:X,className:"pl-8"})]})}),s.jsx("div",{className:"py-1 max-h-60 overflow-auto",children:(T==null?void 0:T.length)===0?s.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:j?"No options found":"No options available"}):T==null?void 0:T.map(I=>s.jsxs("div",{className:Xa("relative flex cursor-pointer select-none items-center rounded-sm px-3 py-2 text-sm outline-none transition-colors",i?"hover:bg-gray-100":q(I==null?void 0:I.value)?"bg-blue-50 text-blue-900":"hover:bg-gray-100",(I==null?void 0:I.disabled)&&"pointer-events-none opacity-50"),onClick:()=>!(I!=null&&I.disabled)&&M(I),children:[i&&s.jsx("div",{className:"flex items-center mr-2",children:s.jsx("div",{className:Xa("w-4 h-4 border-2 rounded flex items-center justify-center transition-colors",q(I==null?void 0:I.value)?"bg-blue-600 border-blue-600":"border-gray-300 bg-white"),children:q(I==null?void 0:I.value)&&s.jsx(tD,{className:"h-3 w-3 text-white",strokeWidth:3})})}),s.jsx("span",{className:"flex-1",children:I==null?void 0:I.label}),!i&&q(I==null?void 0:I.value)&&s.jsx(tD,{className:"h-4 w-4 text-blue-600"}),(I==null?void 0:I.description)&&s.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:I==null?void 0:I.description})]},I==null?void 0:I.value))})]})]}),u&&!d&&s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:u}),d&&s.jsx("p",{className:"text-sm text-destructive mt-1",children:d})]})});dI.displayName="Select";const Pje=({field:e,value:t,onChange:r,error:n,disabled:a=!1})=>{if(!e||typeof e!="object")return console.error("CustomFieldInput: field prop is required and must be an object",e),null;const{field_type:i="text",name:o="Unnamed Field",placeholder:c="",help_text:l="",is_required:u=!1,field_config:d={},field_key:f=""}=e,h=x=>{f&&r&&r(f,x)},m=()=>{var x,p;switch(i){case"text":return s.jsx("input",{type:"text",value:t||"",onChange:y=>h(y.target.value),placeholder:c,disabled:a,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n?"border-red-500":"border-gray-300"} ${a?"bg-gray-100":""}`,maxLength:d==null?void 0:d.max_length,minLength:d==null?void 0:d.min_length});case"textarea":return s.jsx("textarea",{value:t||"",onChange:y=>h(y.target.value),placeholder:c,disabled:a,rows:3,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n?"border-red-500":"border-gray-300"} ${a?"bg-gray-100":""}`,maxLength:d==null?void 0:d.max_length,minLength:d==null?void 0:d.min_length});case"number":case"currency":case"percentage":return s.jsxs("div",{className:"relative",children:[(d==null?void 0:d.prefix)&&s.jsx("span",{className:"absolute left-3 top-2 text-gray-500",children:d.prefix}),s.jsx("input",{type:"number",value:t||"",onChange:y=>h(y.target.value),placeholder:c,disabled:a,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n?"border-red-500":"border-gray-300"} ${a?"bg-gray-100":""} ${d!=null&&d.prefix?"pl-8":""} ${d!=null&&d.suffix?"pr-8":""}`,min:d==null?void 0:d.min_value,max:d==null?void 0:d.max_value,step:i==="percentage"?"0.01":d!=null&&d.decimal_places?`0.${"0".repeat(d.decimal_places-1)}1`:"0.01"}),(d==null?void 0:d.suffix)&&s.jsx("span",{className:"absolute right-3 top-2 text-gray-500",children:d.suffix})]});case"email":return s.jsxs("div",{className:"relative",children:[s.jsx(r9,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"email",value:t||"",onChange:y=>h(y.target.value),placeholder:c||"email@example.com",disabled:a,className:`w-full pl-10 pr-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n?"border-red-500":"border-gray-300"} ${a?"bg-gray-100":""}`})]});case"phone":return s.jsxs("div",{className:"relative",children:[s.jsx(t9,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"tel",value:t||"",onChange:y=>h(y.target.value),placeholder:c||"+1 (555) 123-4567",disabled:a,className:`w-full pl-10 pr-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n?"border-red-500":"border-gray-300"} ${a?"bg-gray-100":""}`})]});case"url":return s.jsxs("div",{className:"relative",children:[s.jsx(e9,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"url",value:t||"",onChange:y=>h(y.target.value),placeholder:c||"https://example.com",disabled:a,className:`w-full pl-10 pr-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n?"border-red-500":"border-gray-300"} ${a?"bg-gray-100":""}`})]});case"date":return s.jsxs("div",{className:"relative",children:[s.jsx(rD,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"date",value:t||"",onChange:y=>h(y.target.value),disabled:a,className:`w-full pl-10 pr-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n?"border-red-500":"border-gray-300"} ${a?"bg-gray-100":""}`,min:d==null?void 0:d.min_date,max:d==null?void 0:d.max_date})]});case"datetime":return s.jsxs("div",{className:"relative",children:[s.jsx(rD,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"datetime-local",value:t||"",onChange:y=>h(y.target.value),disabled:a,className:`w-full pl-10 pr-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n?"border-red-500":"border-gray-300"} ${a?"bg-gray-100":""}`,min:d==null?void 0:d.min_date,max:d==null?void 0:d.max_date})]});case"boolean":return s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:t==="true"||t===!0,onChange:y=>h(y.target.checked.toString()),disabled:a,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),s.jsx("label",{className:"ml-2 text-sm text-gray-900",children:c||"Yes"})]});case"select":return s.jsxs("select",{value:t||"",onChange:y=>h(y.target.value),disabled:a,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n?"border-red-500":"border-gray-300"} ${a?"bg-gray-100":""}`,children:[s.jsx("option",{value:"",children:"Select an option..."}),(x=d.options)==null?void 0:x.map((y,b)=>s.jsx("option",{value:y.value,children:y.label},b))]});case"multi_select":const g=((p=d.options)==null?void 0:p.map(y=>({value:y.value,label:y.label})))||[],v=t?(t||"").split(",").filter(y=>y):[];return s.jsx(dI,{multiple:!0,options:g,value:v,onChange:y=>{h(Array.isArray(y)?y.join(","):"")},placeholder:"Select options...",disabled:a,searchable:g.length>5,className:n?"border-red-500":""});default:return s.jsx("input",{type:"text",value:t||"",onChange:y=>h(y.target.value),placeholder:c,disabled:a,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n?"border-red-500":"border-gray-300"} ${a?"bg-gray-100":""}`})}};return s.jsxs("div",{className:"mb-4",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[o,u&&s.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),m(),l&&s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:l}),n&&s.jsx("p",{className:"mt-1 text-xs text-red-600",children:n})]})},ug=({fields:e,values:t={},onChange:r,errors:n={},disabled:a=!1})=>!Array.isArray(e)||e.length===0?(console.log("CustomFieldsGroup: No fields to render",e),null):r?s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b pb-2",children:"Custom Fields"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.map((i,o)=>{const c=(i==null?void 0:i.id)||(i==null?void 0:i.field_key)||`field-${o}`;return s.jsx(Pje,{field:i,value:t[i==null?void 0:i.field_key]||"",onChange:r,error:n[i==null?void 0:i.field_key],disabled:a},c)})})]}):(console.error("CustomFieldsGroup: onChange prop is required"),null),vi={getAllFields:async(e={})=>{const t=new URLSearchParams;return e.entity_type&&t.append("entity_type",e.entity_type),e.is_active!==void 0&&t.append("is_active",e.is_active),e.placement&&t.append("placement",e.placement),(await be.get(`/api/v1/custom-fields/?${t}`)).data},getField:async e=>(await be.get(`/api/v1/custom-fields/${e}`)).data,createField:async e=>(await be.post("/api/v1/custom-fields/",e)).data,updateField:async(e,t)=>(await be.put(`/api/v1/custom-fields/${e}`,t)).data,deleteField:async e=>(await be.delete(`/api/v1/custom-fields/${e}`)).data,getEntityCustomFields:async(e,t)=>(await be.get(`/api/v1/custom-fields/values/${e}/${t}`)).data,createFieldValue:async e=>(await be.post("/api/v1/custom-fields/values/",e)).data,bulkUpdateFieldValues:async e=>(await be.put("/api/v1/custom-fields/values/bulk",e)).data,deleteEntityFieldValues:async(e,t)=>(await be.delete(`/api/v1/custom-fields/values/${e}/${t}`)).data,getFieldTypes:async()=>(await be.get("/api/v1/custom-fields/types/field-types")).data,getEntityTypes:async()=>(await be.get("/api/v1/custom-fields/types/entity-types")).data},fs={async getAllConfigurations(e=null){const t=e?`/api/v1/system-config?category=${encodeURIComponent(e)}`:"/api/v1/system-config",{data:r,error:n}=await be.get(t);if(n)throw n;return r||[]},async getConfigurationsGrouped(){const{data:e,error:t}=await be.get("/api/v1/system-config/grouped");if(t)throw t;return e||{}},async getCompanyEmail(){var e;try{const t=await this.getConfigurationsGrouped();return((e=t==null?void 0:t.general)==null?void 0:e.company_email)||"noreply@company.com"}catch(t){return console.error("Failed to get company email:",t),"noreply@company.com"}},async getConfigurationsByCategories(){const{data:e,error:t}=await be.get("/api/v1/system-config/categories");if(t)throw t;return e||[]},async getConfigurationSchema(){const{data:e,error:t}=await be.get("/api/v1/system-config/schema");if(t)throw t;return e||{}},async createConfiguration(e){const{data:t,error:r}=await be.post("/api/v1/system-config",e);if(r)throw r;return t},async updateConfiguration(e,t){const{data:r,error:n}=await be.put(`/api/v1/system-config/${e}`,t);if(n)throw n;return r},async updateConfigurationsBulk(e){console.log(" About to send bulk update request"),console.log(" Raw configurations:",e),console.log(" Configurations count:",e.length),console.log(" Sample configuration:",e[0]);const t={configurations:e};console.log(" Request payload:",JSON.stringify(t,null,2));const{data:r,error:n}=await be.put("/api/v1/system-config/bulk",t);if(n)throw n;return r},async deleteConfiguration(e){const{data:t,error:r}=await be.delete(`/api/v1/system-config/${e}`);if(r)throw r;return t},async exportConfiguration(){const{data:e,error:t}=await be.get("/api/v1/system-config/export");if(t)throw t;return e},async validateConfigurations(e){const{data:t,error:r}=await be.post("/api/v1/system-config/validate",e);if(r)throw r;return t},async initializeDefaultConfigurations(){const{data:e,error:t}=await be.post("/api/v1/system-config/initialize");if(t)throw t;return e},transformConfigurationsForUI(e){const t={general:{},sales:{},notifications:{},security:{},backup:{},integrations:{},performance:{}};return e.forEach(r=>{const n=r.key.split(".");if(n.length===2){const[a,i]=n;t[a]&&(t[a][i]=r.value)}}),t},transformConfigurationsFromUI(e){const t=[];return Object.entries(e).forEach(([r,n])=>{n&&typeof n=="object"&&Object.entries(n).forEach(([a,i])=>{if(i!=null&&i!==""){let o=i;const c=`${r}.${a}`;if((c.includes("_days")||c.includes("_minutes")||c.includes("_seconds")||c.includes("_length")||c.includes("_limit")||c.includes("_timeout")||c.includes("_attempts")||c.includes("_results"))&&(o=typeof i=="string"?parseInt(i,10):i,isNaN(o))){console.warn(`Invalid numeric value for ${c}: ${i}`);return}t.push({key:c,value:o})}})}),t},getDefaultConfiguration(){return{general:{company_name:"SalesFlow Pro Inc.",company_email:"admin@salesflowpro.com",company_phone:"+1-555-123-4567",company_address:"123 Business Street, Suite 100, Business City, BC 12345",timezone:"America/New_York",date_format:"MM/DD/YYYY",time_format:"12",currency:"USD",language:"en"},sales:{default_pipeline_stage:"prospecting",deal_currency:"USD",require_deal_value:!0,auto_progress_deals:!1,deal_inactivity_warning_days:30,lead_scoring_enabled:!0,opportunity_auto_close_days:90},notifications:{email_notifications:!0,deal_update_notifications:!0,task_reminders:!0,weekly_reports:!0,system_alerts:!0,lead_assignment_alerts:!0,quota_achievement_alerts:!0},security:{password_complexity:!0,min_password_length:8,two_factor_auth:!1,session_timeout_minutes:480,max_login_attempts:5,lockout_duration_minutes:30,data_encryption_at_rest:!0,audit_log_retention_days:365},backup:{enable_automatic_backups:!0,backup_frequency:"daily",backup_retention_days:30,backup_location:"local",compress_backups:!0},integrations:{email_service_provider:"sendgrid",calendar_integration:"google",crm_sync_enabled:!1,api_rate_limit:1e3},performance:{enable_caching:!0,cache_ttl_seconds:3600,max_search_results:100,database_query_timeout:30}}},getFieldOptions(){return{timezone:["America/New_York","America/Chicago","America/Denver","America/Los_Angeles","Europe/London","Europe/Paris","Asia/Tokyo","Australia/Sydney"],date_format:["MM/DD/YYYY","DD/MM/YYYY","YYYY-MM-DD"],time_format:["12","24"],currency:["USD","EUR","GBP","JPY","CAD","AUD"],language:["en","es","fr","de","it","pt","ja","zh"],default_pipeline_stage:["prospecting","qualification","proposal","negotiation","closed_won","closed_lost"],backup_frequency:["daily","weekly","monthly"],backup_location:["local","s3","azure","google_cloud"],email_service_provider:["sendgrid","mailgun","ses","smtp"],calendar_integration:["google","outlook","none"]}},validateConfigurationValue(e,t){return e.includes("email")&&typeof t=="string"?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t):(e.includes("days")||e.includes("minutes")||e.includes("seconds"))&&typeof t=="number"?t>0:e.includes("enable")||e.includes("require")||e.includes("auto")?typeof t=="boolean":!0}},Ije=({deal:e=null,contacts:t=[],companies:r=[],stages:n=[],onSubmit:a,onCancel:i,isSaving:o=!1})=>{var F,I,L;const{user:c}=Pt(),[l,u]=R.useState(!1),[d,f]=R.useState(!1),h=R.useRef(null),[m,x]=R.useState([]),[p,g]=R.useState({}),[v,y]=R.useState(!1),[b,_]=R.useState(!0),[w,j]=R.useState({name:"",description:"",value:"",stage:"lead",probability:10,expected_close_date:"",contact_id:"",company_id:"",lead_source:"website",owner_id:(c==null?void 0:c.id)||""}),[N,D]=R.useState({});R.useEffect(()=>{var C;if(console.log("DealForm useEffect triggered with deal:",e),A(),S(),e)if(console.log("Populating form with deal data:",e),j({name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||"",value:((C=e==null?void 0:e.value)==null?void 0:C.toString())||"",stage:(e==null?void 0:e.stage)||"lead",probability:(e==null?void 0:e.probability)||10,expected_close_date:(e==null?void 0:e.expected_close_date)||"",contact_id:(e==null?void 0:e.contact_id)||"",company_id:(e==null?void 0:e.company_id)||"",lead_source:(e==null?void 0:e.lead_source)||"website",owner_id:(e==null?void 0:e.owner_id)||(c==null?void 0:c.id)||""}),e!=null&&e.custom_fields){console.log("Using custom fields from deal object:",e.custom_fields);const k={};Object.entries(e.custom_fields).forEach(([z,V])=>{(V==null?void 0:V.value)!==null&&(V==null?void 0:V.value)!==void 0&&(k[z]=V.value)}),console.log("Custom field values extracted:",k),g(k)}else e!=null&&e.id&&E(e.id);else T()},[e]);const S=async()=>{var C;try{const k=await fs.getConfigurationsGrouped(),z=((C=k==null?void 0:k.sales)==null?void 0:C.require_deal_value)??!0;console.log("Loaded system config - require value:",z),_(z)}catch(k){console.error("Error loading system config:",k),_(!0)}},T=async()=>{var C,k;try{const z=await fs.getConfigurationsGrouped(),V=((C=z==null?void 0:z.sales)==null?void 0:C.default_pipeline_stage)||"lead",Z=((k=z==null?void 0:z.sales)==null?void 0:k.require_deal_value)??!0;console.log("Loaded system config - default stage:",V,"require value:",Z),_(Z),j({name:"",description:"",value:"",stage:V,probability:10,expected_close_date:"",contact_id:"",company_id:"",lead_source:"website",owner_id:(c==null?void 0:c.id)||""}),g({})}catch(z){console.error("Error loading default stage:",z),j({name:"",description:"",value:"",stage:"lead",probability:10,expected_close_date:"",contact_id:"",company_id:"",lead_source:"website",owner_id:(c==null?void 0:c.id)||""}),g({})}},A=async()=>{y(!0);try{console.log("Loading custom fields for deals...");const k=(await vi.getAllFields({entity_type:"deal",is_active:!0})||[]).filter(z=>z.placement==="form"||z.placement==="both");console.log("Custom fields loaded:",k),x(k)}catch(C){console.error("Error loading custom fields:",C),x([])}finally{y(!1)}},E=async C=>{try{console.log("Loading custom field values for deal:",C);const k=await vi.getEntityCustomFields("deal",C),z={};k.forEach(V=>{V.current_value!==null&&V.current_value!==void 0&&(z[V.field_key]=V.current_value)}),console.log("Custom field values loaded:",z),g(z)}catch(k){console.error("Error loading custom field values:",k),g({})}},M=async C=>{var z;if(C==null||C.preventDefault(),l||d||h.current){console.log("Form submission blocked - already processing");return}const k=Date.now();h.current=k,console.log("Starting form submission...",k),u(!0),f(!0),D({});try{const V=["name"];b&&V.push("value");const Z={};if(V==null||V.forEach(ie=>{var Q,ne;(ne=(Q=w==null?void 0:w[ie])==null?void 0:Q.toString())!=null&&ne.trim()||(Z[ie]=`${ie==null?void 0:ie.replace("_"," ")} is required`)}),w!=null&&w.value&&(isNaN(w==null?void 0:w.value)||parseFloat(w==null?void 0:w.value)<0)&&(Z.value="Please enter a valid deal value"),w!=null&&w.expected_close_date&&new Date(w==null?void 0:w.expected_close_date)<new Date&&(Z.expected_close_date="Expected close date cannot be in the past"),((z=Object.keys(Z))==null?void 0:z.length)>0){D(Z),u(!1);return}const ce={name:w.name,description:w.description||null,value:parseFloat(w==null?void 0:w.value)||null,stage:w.stage||"lead",probability:parseInt(w.probability)||0,expected_close_date:(w==null?void 0:w.expected_close_date)||null,source:w.source||null,next_action:w.next_action||null,company_id:w.company_id||null,contact_id:w.contact_id||null,custom_fields:Object.keys(p).length>0?p:void 0};Object.keys(ce).forEach(ie=>{ce[ie]===void 0&&delete ce[ie]}),console.log("Submitting form data to parent component:",ce),await a(ce),console.log("Form submission completed successfully")}catch(V){console.error("Error in form submission:",V);let Z="Failed to save deal. Please try again.";V!=null&&V.message&&(Array.isArray(V.message)?Z=V.message.map(ce=>ce.msg||ce).join(", "):typeof V.message=="string"&&(Z=V.message)),D({submit:Z})}finally{console.log("Form submission completed, resetting states..."),u(!1),f(!1),h.current=null}},P=(C,k)=>{if(j(z=>({...z,[C]:k})),C==="stage"){const z={lead:10,qualified:25,proposal:50,negotiation:75,closed_won:100,closed_lost:0};j(V=>({...V,[C]:k,probability:(z==null?void 0:z[k])||(V==null?void 0:V.probability)}))}N!=null&&N[C]&&D(z=>{const V={...z};return V==null||delete V[C],V})},X=(C,k)=>{C&&(g(z=>({...z,[C]:k})),N!=null&&N[C]&&D(z=>{const V={...z};return V==null||delete V[C],V}))},q=C=>{const k=t==null?void 0:t.find(z=>(z==null?void 0:z.id)===C);j(z=>({...z,contact_id:C,company_id:(k==null?void 0:k.company_id)||(z==null?void 0:z.company_id)}))},B=n.length>0?n:[{value:"lead",label:"Lead"},{value:"qualified",label:"Qualified"},{value:"proposal",label:"Proposal"},{value:"negotiation",label:"Negotiation"},{value:"closed_won",label:"Closed Won"},{value:"closed_lost",label:"Closed Lost"}],O=[{value:"website",label:"Website"},{value:"referral",label:"Referral"},{value:"cold_call",label:"Cold Call"},{value:"email_campaign",label:"Email Campaign"},{value:"social_media",label:"Social Media"},{value:"event",label:"Event"},{value:"partner",label:"Partner"},{value:"other",label:"Other"}];return console.log("DealForm rendering - deal:",e==null?void 0:e.id,"contacts:",t.length,"companies:",r.length,"stages:",n.length),s.jsxs("form",{onSubmit:M,className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center py-4 border-b border-border",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:e?"Edit Deal":"Create New Deal"}),s.jsxs("button",{type:"submit",disabled:l||o||d,className:"bg-primary text-white px-6 py-2 rounded-lg hover:bg-primary-600 transition-colors duration-150 ease-smooth flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[(l||o||d)&&s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx("span",{children:e?"Update Deal":"Create Deal"})]})]}),(N==null?void 0:N.submit)&&s.jsxs("div",{className:"bg-error-50 border border-error-200 text-error p-4 rounded-lg flex items-center space-x-2",children:[s.jsx(G,{name:"AlertCircle",size:20}),s.jsx("span",{children:N==null?void 0:N.submit})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Deal Name *"}),s.jsx("input",{type:"text",value:w==null?void 0:w.name,onChange:C=>{var k;return P("name",(k=C==null?void 0:C.target)==null?void 0:k.value)},className:`w-full px-3 py-2 border rounded-lg bg-surface text-text-primary placeholder-text-tertiary focus:ring-primary focus:border-primary ${N!=null&&N.name?"border-error":"border-border"}`,placeholder:"Enterprise Software License - Acme Corp",required:!0}),(N==null?void 0:N.name)&&s.jsx("p",{className:"text-sm text-error mt-1",children:N==null?void 0:N.name})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Deal Value ",b&&"*"]}),s.jsxs("div",{className:"relative",children:[s.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-secondary",children:"$"}),s.jsx("input",{type:"number",min:"0",step:"0.01",value:w==null?void 0:w.value,onChange:C=>{var k;return P("value",(k=C==null?void 0:C.target)==null?void 0:k.value)},className:`w-full pl-8 pr-3 py-2 border rounded-lg bg-surface text-text-primary placeholder-text-tertiary focus:ring-primary focus:border-primary ${N!=null&&N.value?"border-error":"border-border"}`,placeholder:"50000",required:b})]}),(N==null?void 0:N.value)&&s.jsx("p",{className:"text-sm text-error mt-1",children:N==null?void 0:N.value})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Stage"}),s.jsx("select",{value:w==null?void 0:w.stage,onChange:C=>{var k;return P("stage",(k=C==null?void 0:C.target)==null?void 0:k.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary focus:ring-primary focus:border-primary",children:B==null?void 0:B.map(C=>s.jsx("option",{value:C==null?void 0:C.value,children:C==null?void 0:C.label},C==null?void 0:C.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Probability (%)"}),s.jsx("input",{type:"number",min:"0",max:"100",value:w==null?void 0:w.probability,onChange:C=>{var k;return P("probability",parseInt((k=C==null?void 0:C.target)==null?void 0:k.value)||0)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary focus:ring-primary focus:border-primary"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Primary Contact"}),s.jsxs("select",{value:w==null?void 0:w.contact_id,onChange:C=>{var k;return q((k=C==null?void 0:C.target)==null?void 0:k.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary focus:ring-primary focus:border-primary",children:[s.jsx("option",{value:"",children:"Select Contact"}),t==null?void 0:t.map(C=>{var k;return s.jsxs("option",{value:C==null?void 0:C.id,children:[(C==null?void 0:C.full_name)||`${C==null?void 0:C.first_name} ${C==null?void 0:C.last_name}`," - ",(k=C==null?void 0:C.company)==null?void 0:k.name]},C==null?void 0:C.id)})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Company"}),s.jsxs("select",{value:w==null?void 0:w.company_id,onChange:C=>{var k;return P("company_id",(k=C==null?void 0:C.target)==null?void 0:k.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary focus:ring-primary focus:border-primary",children:[s.jsx("option",{value:"",children:"Select Company"}),r==null?void 0:r.map(C=>s.jsx("option",{value:C==null?void 0:C.id,children:C==null?void 0:C.name},C==null?void 0:C.id))]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Expected Close Date"}),s.jsx("input",{type:"date",value:w==null?void 0:w.expected_close_date,onChange:C=>{var k;return P("expected_close_date",(k=C==null?void 0:C.target)==null?void 0:k.value)},className:`w-full px-3 py-2 border rounded-lg bg-surface text-text-primary focus:ring-primary focus:border-primary ${N!=null&&N.expected_close_date?"border-error":"border-border"}`,min:(L=(I=(F=new Date)==null?void 0:F.toISOString())==null?void 0:I.split("T"))==null?void 0:L[0]}),(N==null?void 0:N.expected_close_date)&&s.jsx("p",{className:"text-sm text-error mt-1",children:N==null?void 0:N.expected_close_date})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Lead Source"}),s.jsx("select",{value:w==null?void 0:w.lead_source,onChange:C=>{var k;return P("lead_source",(k=C==null?void 0:C.target)==null?void 0:k.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary focus:ring-primary focus:border-primary",children:O==null?void 0:O.map(C=>s.jsx("option",{value:C==null?void 0:C.value,children:C==null?void 0:C.label},C==null?void 0:C.value))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Description"}),s.jsx("textarea",{value:w==null?void 0:w.description,onChange:C=>{var k;return P("description",(k=C==null?void 0:C.target)==null?void 0:k.value)},rows:4,className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary placeholder-text-tertiary focus:ring-primary focus:border-primary",placeholder:"Describe the deal, requirements, and key details..."})]}),v&&s.jsx("div",{className:"pt-6 border-t border-border",children:s.jsxs("div",{className:"text-center py-4 text-gray-500",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),s.jsx("p",{className:"mt-2",children:"Loading custom fields..."})]})}),!v&&Array.isArray(m)&&m.length>0&&s.jsx("div",{className:"pt-6 border-t border-border",children:s.jsx(ug,{fields:m,values:p||{},onChange:X,errors:N||{}})})]})},Uje=({deal:e,contacts:t,companies:r,stages:n,onEdit:a})=>{const i=d=>kr.formatCurrency(d),o=n.find(d=>d.value===(e==null?void 0:e.stage)),c=t.find(d=>d.id===(e==null?void 0:e.contact_id)),l=r.find(d=>d.id===(e==null?void 0:e.company_id)),u={website:"Website",referral:"Referral",cold_call:"Cold Call",email_campaign:"Email Campaign",social_media:"Social Media",event:"Event",partner:"Partner",other:"Other"};return s.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-border flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Deal Details"}),a&&s.jsxs("button",{onClick:a,className:"btn-primary flex items-center space-x-2",children:[s.jsx(G,{name:"Edit",size:16}),s.jsx("span",{children:"Edit Deal"})]})]}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Deal Name"}),s.jsx("p",{className:"text-text-primary text-base font-medium",children:(e==null?void 0:e.name)||"N/A"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Deal Value"}),s.jsx("p",{className:"text-text-primary text-base font-semibold",children:i((e==null?void 0:e.value)||0)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Stage"}),s.jsx("span",{className:`inline-block px-3 py-1 text-sm font-medium rounded-full ${(o==null?void 0:o.color)||"bg-gray-100 text-gray-800"}`,children:(o==null?void 0:o.label)||(e==null?void 0:e.stage)||"N/A"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Probability"}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2.5",children:s.jsx("div",{className:"bg-primary h-2.5 rounded-full transition-all duration-300",style:{width:`${(e==null?void 0:e.probability)||0}%`}})}),s.jsxs("span",{className:"text-text-primary text-sm font-medium",children:[(e==null?void 0:e.probability)||0,"%"]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Primary Contact"}),s.jsx("p",{className:"text-text-primary text-base",children:c?s.jsxs("span",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"User",size:16,className:"text-text-tertiary"}),s.jsxs("span",{children:[c.first_name," ",c.last_name]})]}):"No contact assigned"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Company"}),s.jsx("p",{className:"text-text-primary text-base",children:l?s.jsxs("span",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"Building",size:16,className:"text-text-tertiary"}),s.jsx("span",{children:l.name})]}):"No company assigned"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Expected Close Date"}),s.jsx("p",{className:"text-text-primary text-base",children:e!=null&&e.expected_close_date?s.jsxs("span",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"Calendar",size:16,className:"text-text-tertiary"}),s.jsx("span",{children:new Date(e.expected_close_date).toLocaleDateString()})]}):"No date set"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Lead Source"}),s.jsx("p",{className:"text-text-primary text-base",children:u[e==null?void 0:e.lead_source]||(e==null?void 0:e.lead_source)||"N/A"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Description"}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-border",children:s.jsx("p",{className:"text-text-primary text-base whitespace-pre-wrap",children:(e==null?void 0:e.description)||"No description provided"})})]}),(e==null?void 0:e.custom_fields)&&Object.keys(e.custom_fields).length>0&&(()=>{const d=Object.entries(e.custom_fields).map(([f,h])=>{let m=null,x=f;if(h!=null)if(typeof h=="object"){const p=h.value;h.field_name&&(x=h.field_name),p!=null&&p!==""&&(m=String(p))}else h!==""&&(m=String(h));return m?{key:f,fieldName:x,displayValue:m}:null}).filter(f=>f!==null);return d.length===0?null:s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Custom Fields"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:d.map(({key:f,fieldName:h,displayValue:m})=>s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:h.replace(/_/g," ").replace(/\b\w/g,x=>x.toUpperCase())}),s.jsx("p",{className:"text-text-primary text-base",children:m})]},f))})]})})(),s.jsx("div",{className:"pt-4 border-t border-border",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-text-tertiary mb-1",children:"Deal ID"}),s.jsxs("p",{className:"text-text-secondary font-mono",children:["#",e==null?void 0:e.id]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-text-tertiary mb-1",children:"Created"}),s.jsx("p",{className:"text-text-secondary",children:e!=null&&e.created_at?new Date(e.created_at).toLocaleString():"N/A"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-text-tertiary mb-1",children:"Last Updated"}),s.jsx("p",{className:"text-text-secondary",children:e!=null&&e.updated_at?new Date(e.updated_at).toLocaleString():"N/A"})]})]})})]})]})},Rje="http://localhost:8000/",fr={async getDealDocuments(e){try{const{data:t,error:r}=await be.get(`/api/v1/deals/${e}/documents`);if(r)throw r;return t||[]}catch(t){throw console.error("Error fetching deal documents:",t),t}},async uploadDealDocument(e,t,r=null){try{const n=new FormData;n.append("file",t);const a=localStorage.getItem("access_token"),i=await fetch(`${Rje}/api/v1/deals/${e}/documents`,{method:"POST",headers:{Authorization:`Bearer ${a}`},body:n});if(!i.ok){const c=await i.json();throw new Error(c.detail||"Upload failed")}return await i.json()}catch(n){throw console.error("Error uploading deal document:",n),n}},async deleteDealDocument(e){try{const{data:t,error:r}=await be.delete(`/api/v1/documents/${e}`);if(r)throw r;return!0}catch(t){throw console.error("Error deleting deal document:",t),t}},async getDocumentDownloadUrl(e){try{const{data:t,error:r}=await be.get(`/api/v1/documents/${e}/download`);if(r)throw r;return(t==null?void 0:t.download_url)||null}catch(t){throw console.error("Error getting document download URL:",t),t}},subscribeToDealDocuments(e,t){return{unsubscribe:()=>{}}},async uploadDocument(e,t,r="other"){return this.uploadDealDocument(t,e,`${r}_${e.name}`)},async deleteDocument(e,t=null){return this.deleteDealDocument(e)},subscribeToDocumentChanges(e,t){return this.subscribeToDealDocuments(e,t)},unsubscribeFromDocumentChanges(e){e&&e.unsubscribe&&e.unsubscribe()},formatFileSize(e){if(e===0)return"0 Bytes";const t=1024,r=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,n)).toFixed(2))+" "+r[n]},getFileExtension(e){return e.split(".").pop().toLowerCase()},getFileIcon(e){const t=this.getFileExtension(e),r={pdf:"FileText",doc:"FileText",docx:"FileText",txt:"FileText",xls:"FileSpreadsheet",xlsx:"FileSpreadsheet",csv:"FileSpreadsheet",ppt:"Presentation",pptx:"Presentation",jpg:"Image",jpeg:"Image",png:"Image",gif:"Image",svg:"Image",zip:"FileArchive",rar:"FileArchive","7z":"FileArchive",default:"File"};return r[t]||r.default},async getDocumentUrl(e){return`/api/v1/deals/documents/${e}/download`}},Mje=({fileUrl:e,fileName:t})=>{const[r,n]=R.useState(""),[a,i]=R.useState(!0),[o,c]=R.useState(null);return R.useEffect(()=>{e&&(async()=>{try{i(!0),c(null);const u=await fetch(e);if(!u.ok)throw new Error("Failed to load file");const d=await u.text();n(d)}catch(u){c(u.message)}finally{i(!1)}})()},[e]),a?s.jsx("div",{className:"flex items-center justify-center h-full min-h-[400px]",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2"}),s.jsx("p",{className:"text-text-secondary",children:"Loading text file..."})]})}):o?s.jsxs("div",{className:"flex flex-col items-center justify-center h-full min-h-[400px] text-center",children:[s.jsx(G,{name:"AlertCircle",size:48,className:"text-error mb-4"}),s.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-2",children:"Failed to load file"}),s.jsx("p",{className:"text-text-secondary",children:o})]}):s.jsx("div",{className:"h-full",children:s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-h-[600px] overflow-auto",children:s.jsx("pre",{className:"text-sm text-text-primary font-mono whitespace-pre-wrap break-words",children:r||"File is empty"})})})};var fI={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(e,t){((r,n)=>{e.exports=n()})(gt,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},a,i=!n.document&&!!n.postMessage,o=n.IS_PAPA_WORKER||!1,c={},l=0,u={};function d(D){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(S){var T=w(S);T.chunkSize=parseInt(T.chunkSize),S.step||S.chunk||(T.chunkSize=null),this._handle=new p(T),(this._handle.streamer=this)._config=T}).call(this,D),this.parseChunk=function(S,T){var A=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<A){let M=this._config.newline;M||(E=this._config.quoteChar||'"',M=this._handle.guessLineEndings(S,E)),S=[...S.split(M).slice(A)].join(M)}this.isFirstChunk&&N(this._config.beforeFirstChunk)&&(E=this._config.beforeFirstChunk(S))!==void 0&&(S=E),this.isFirstChunk=!1,this._halted=!1;var A=this._partialLine+S,E=(this._partialLine="",this._handle.parse(A,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(S=E.meta.cursor,A=(this._finished||(this._partialLine=A.substring(S-this._baseIndex),this._baseIndex=S),E&&E.data&&(this._rowCount+=E.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),o)n.postMessage({results:E,workerId:u.WORKER_ID,finished:A});else if(N(this._config.chunk)&&!T){if(this._config.chunk(E,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=E=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(E.data),this._completeResults.errors=this._completeResults.errors.concat(E.errors),this._completeResults.meta=E.meta),this._completed||!A||!N(this._config.complete)||E&&E.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),A||E&&E.meta.paused||this._nextChunk(),E}this._halted=!0},this._sendError=function(S){N(this._config.error)?this._config.error(S):o&&this._config.error&&n.postMessage({workerId:u.WORKER_ID,error:S,finished:!1})}}function f(D){var S;(D=D||{}).chunkSize||(D.chunkSize=u.RemoteChunkSize),d.call(this,D),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(T){this._input=T,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(S=new XMLHttpRequest,this._config.withCredentials&&(S.withCredentials=this._config.withCredentials),i||(S.onload=j(this._chunkLoaded,this),S.onerror=j(this._chunkError,this)),S.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var T,A=this._config.downloadRequestHeaders;for(T in A)S.setRequestHeader(T,A[T])}var E;this._config.chunkSize&&(E=this._start+this._config.chunkSize-1,S.setRequestHeader("Range","bytes="+this._start+"-"+E));try{S.send(this._config.downloadRequestBody)}catch(M){this._chunkError(M.message)}i&&S.status===0&&this._chunkError()}},this._chunkLoaded=function(){S.readyState===4&&(S.status<200||400<=S.status?this._chunkError():(this._start+=this._config.chunkSize||S.responseText.length,this._finished=!this._config.chunkSize||this._start>=(T=>(T=T.getResponseHeader("Content-Range"))!==null?parseInt(T.substring(T.lastIndexOf("/")+1)):-1)(S),this.parseChunk(S.responseText)))},this._chunkError=function(T){T=S.statusText||T,this._sendError(new Error(T))}}function h(D){(D=D||{}).chunkSize||(D.chunkSize=u.LocalChunkSize),d.call(this,D);var S,T,A=typeof FileReader<"u";this.stream=function(E){this._input=E,T=E.slice||E.webkitSlice||E.mozSlice,A?((S=new FileReader).onload=j(this._chunkLoaded,this),S.onerror=j(this._chunkError,this)):S=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var E=this._input,M=(this._config.chunkSize&&(M=Math.min(this._start+this._config.chunkSize,this._input.size),E=T.call(E,this._start,M)),S.readAsText(E,this._config.encoding));A||this._chunkLoaded({target:{result:M}})},this._chunkLoaded=function(E){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(E.target.result)},this._chunkError=function(){this._sendError(S.error)}}function m(D){var S;d.call(this,D=D||{}),this.stream=function(T){return S=T,this._nextChunk()},this._nextChunk=function(){var T,A;if(!this._finished)return T=this._config.chunkSize,S=T?(A=S.substring(0,T),S.substring(T)):(A=S,""),this._finished=!S,this.parseChunk(A)}}function x(D){d.call(this,D=D||{});var S=[],T=!0,A=!1;this.pause=function(){d.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){d.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(E){this._input=E,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){A&&S.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),S.length?this.parseChunk(S.shift()):T=!0},this._streamData=j(function(E){try{S.push(typeof E=="string"?E:E.toString(this._config.encoding)),T&&(T=!1,this._checkIsFinished(),this.parseChunk(S.shift()))}catch(M){this._streamError(M)}},this),this._streamError=j(function(E){this._streamCleanUp(),this._sendError(E)},this),this._streamEnd=j(function(){this._streamCleanUp(),A=!0,this._streamData("")},this),this._streamCleanUp=j(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function p(D){var S,T,A,E,M=Math.pow(2,53),P=-M,X=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,q=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,B=this,O=0,F=0,I=!1,L=!1,C=[],k={data:[],errors:[],meta:{}};function z(ie){return D.skipEmptyLines==="greedy"?ie.join("").trim()==="":ie.length===1&&ie[0].length===0}function V(){if(k&&A&&(ce("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+u.DefaultDelimiter+"'"),A=!1),D.skipEmptyLines&&(k.data=k.data.filter(function(pe){return!z(pe)})),Z()){let pe=function(W,re){N(D.transformHeader)&&(W=D.transformHeader(W,re)),C.push(W)};if(k)if(Array.isArray(k.data[0])){for(var ie=0;Z()&&ie<k.data.length;ie++)k.data[ie].forEach(pe);k.data.splice(0,1)}else k.data.forEach(pe)}function Q(pe,W){for(var re=D.header?{}:[],U=0;U<pe.length;U++){var se=U,te=pe[U],te=((K,H)=>(oe=>(D.dynamicTypingFunction&&D.dynamicTyping[oe]===void 0&&(D.dynamicTyping[oe]=D.dynamicTypingFunction(oe)),(D.dynamicTyping[oe]||D.dynamicTyping)===!0))(K)?H==="true"||H==="TRUE"||H!=="false"&&H!=="FALSE"&&((oe=>{if(X.test(oe)&&(oe=parseFloat(oe),P<oe&&oe<M))return 1})(H)?parseFloat(H):q.test(H)?new Date(H):H===""?null:H):H)(se=D.header?U>=C.length?"__parsed_extra":C[U]:se,te=D.transform?D.transform(te,se):te);se==="__parsed_extra"?(re[se]=re[se]||[],re[se].push(te)):re[se]=te}return D.header&&(U>C.length?ce("FieldMismatch","TooManyFields","Too many fields: expected "+C.length+" fields but parsed "+U,F+W):U<C.length&&ce("FieldMismatch","TooFewFields","Too few fields: expected "+C.length+" fields but parsed "+U,F+W)),re}var ne;k&&(D.header||D.dynamicTyping||D.transform)&&(ne=1,!k.data.length||Array.isArray(k.data[0])?(k.data=k.data.map(Q),ne=k.data.length):k.data=Q(k.data,0),D.header&&k.meta&&(k.meta.fields=C),F+=ne)}function Z(){return D.header&&C.length===0}function ce(ie,Q,ne,pe){ie={type:ie,code:Q,message:ne},pe!==void 0&&(ie.row=pe),k.errors.push(ie)}N(D.step)&&(E=D.step,D.step=function(ie){k=ie,Z()?V():(V(),k.data.length!==0&&(O+=ie.data.length,D.preview&&O>D.preview?T.abort():(k.data=k.data[0],E(k,B))))}),this.parse=function(ie,Q,ne){var pe=D.quoteChar||'"',pe=(D.newline||(D.newline=this.guessLineEndings(ie,pe)),A=!1,D.delimiter?N(D.delimiter)&&(D.delimiter=D.delimiter(ie),k.meta.delimiter=D.delimiter):((pe=((W,re,U,se,te)=>{var K,H,oe,J;te=te||[",","	","|",";",u.RECORD_SEP,u.UNIT_SEP];for(var le=0;le<te.length;le++){for(var he,ee=te[le],ae=0,xe=0,ye=0,Ce=(oe=void 0,new v({comments:se,delimiter:ee,newline:re,preview:10}).parse(W)),Ie=0;Ie<Ce.data.length;Ie++)U&&z(Ce.data[Ie])?ye++:(he=Ce.data[Ie].length,xe+=he,oe===void 0?oe=he:0<he&&(ae+=Math.abs(he-oe),oe=he));0<Ce.data.length&&(xe/=Ce.data.length-ye),(H===void 0||ae<=H)&&(J===void 0||J<xe)&&1.99<xe&&(H=ae,K=ee,J=xe)}return{successful:!!(D.delimiter=K),bestDelimiter:K}})(ie,D.newline,D.skipEmptyLines,D.comments,D.delimitersToGuess)).successful?D.delimiter=pe.bestDelimiter:(A=!0,D.delimiter=u.DefaultDelimiter),k.meta.delimiter=D.delimiter),w(D));return D.preview&&D.header&&pe.preview++,S=ie,T=new v(pe),k=T.parse(S,Q,ne),V(),I?{meta:{paused:!0}}:k||{meta:{paused:!1}}},this.paused=function(){return I},this.pause=function(){I=!0,T.abort(),S=N(D.chunk)?"":S.substring(T.getCharIndex())},this.resume=function(){B.streamer._halted?(I=!1,B.streamer.parseChunk(S,!0)):setTimeout(B.resume,3)},this.aborted=function(){return L},this.abort=function(){L=!0,T.abort(),k.meta.aborted=!0,N(D.complete)&&D.complete(k),S=""},this.guessLineEndings=function(W,pe){W=W.substring(0,1048576);var pe=new RegExp(g(pe)+"([^]*?)"+g(pe),"gm"),ne=(W=W.replace(pe,"")).split("\r"),pe=W.split(`
`),W=1<pe.length&&pe[0].length<ne[0].length;if(ne.length===1||W)return`
`;for(var re=0,U=0;U<ne.length;U++)ne[U][0]===`
`&&re++;return re>=ne.length/2?`\r
`:"\r"}}function g(D){return D.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function v(D){var S=(D=D||{}).delimiter,T=D.newline,A=D.comments,E=D.step,M=D.preview,P=D.fastMode,X=null,q=!1,B=D.quoteChar==null?'"':D.quoteChar,O=B;if(D.escapeChar!==void 0&&(O=D.escapeChar),(typeof S!="string"||-1<u.BAD_DELIMITERS.indexOf(S))&&(S=","),A===S)throw new Error("Comment character same as delimiter");A===!0?A="#":(typeof A!="string"||-1<u.BAD_DELIMITERS.indexOf(A))&&(A=!1),T!==`
`&&T!=="\r"&&T!==`\r
`&&(T=`
`);var F=0,I=!1;this.parse=function(L,C,k){if(typeof L!="string")throw new Error("Input must be a string");var z=L.length,V=S.length,Z=T.length,ce=A.length,ie=N(E),Q=[],ne=[],pe=[],W=F=0;if(!L)return ae();if(P||P!==!1&&L.indexOf(B)===-1){for(var re=L.split(T),U=0;U<re.length;U++){if(pe=re[U],F+=pe.length,U!==re.length-1)F+=T.length;else if(k)return ae();if(!A||pe.substring(0,ce)!==A){if(ie){if(Q=[],J(pe.split(S)),xe(),I)return ae()}else J(pe.split(S));if(M&&M<=U)return Q=Q.slice(0,M),ae(!0)}}return ae()}for(var se=L.indexOf(S,F),te=L.indexOf(T,F),K=new RegExp(g(O)+g(B),"g"),H=L.indexOf(B,F);;)if(L[F]===B)for(H=F,F++;;){if((H=L.indexOf(B,H+1))===-1)return k||ne.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:Q.length,index:F}),he();if(H===z-1)return he(L.substring(F,H).replace(K,B));if(B===O&&L[H+1]===O)H++;else if(B===O||H===0||L[H-1]!==O){se!==-1&&se<H+1&&(se=L.indexOf(S,H+1));var oe=le((te=te!==-1&&te<H+1?L.indexOf(T,H+1):te)===-1?se:Math.min(se,te));if(L.substr(H+1+oe,V)===S){pe.push(L.substring(F,H).replace(K,B)),L[F=H+1+oe+V]!==B&&(H=L.indexOf(B,F)),se=L.indexOf(S,F),te=L.indexOf(T,F);break}if(oe=le(te),L.substring(H+1+oe,H+1+oe+Z)===T){if(pe.push(L.substring(F,H).replace(K,B)),ee(H+1+oe+Z),se=L.indexOf(S,F),H=L.indexOf(B,F),ie&&(xe(),I))return ae();if(M&&Q.length>=M)return ae(!0);break}ne.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:Q.length,index:F}),H++}}else if(A&&pe.length===0&&L.substring(F,F+ce)===A){if(te===-1)return ae();F=te+Z,te=L.indexOf(T,F),se=L.indexOf(S,F)}else if(se!==-1&&(se<te||te===-1))pe.push(L.substring(F,se)),F=se+V,se=L.indexOf(S,F);else{if(te===-1)break;if(pe.push(L.substring(F,te)),ee(te+Z),ie&&(xe(),I))return ae();if(M&&Q.length>=M)return ae(!0)}return he();function J(ye){Q.push(ye),W=F}function le(ye){var Ce=0;return Ce=ye!==-1&&(ye=L.substring(H+1,ye))&&ye.trim()===""?ye.length:Ce}function he(ye){return k||(ye===void 0&&(ye=L.substring(F)),pe.push(ye),F=z,J(pe),ie&&xe()),ae()}function ee(ye){F=ye,J(pe),pe=[],te=L.indexOf(T,F)}function ae(ye){if(D.header&&!C&&Q.length&&!q){var Ce=Q[0],Ie=Object.create(null),Ze=new Set(Ce);let Fe=!1;for(let He=0;He<Ce.length;He++){let rt=Ce[He];if(Ie[rt=N(D.transformHeader)?D.transformHeader(rt,He):rt]){let Je,Gt=Ie[rt];for(;Je=rt+"_"+Gt,Gt++,Ze.has(Je););Ze.add(Je),Ce[He]=Je,Ie[rt]++,Fe=!0,(X=X===null?{}:X)[Je]=rt}else Ie[rt]=1,Ce[He]=rt;Ze.add(rt)}Fe&&console.warn("Duplicate headers found and renamed."),q=!0}return{data:Q,errors:ne,meta:{delimiter:S,linebreak:T,aborted:I,truncated:!!ye,cursor:W+(C||0),renamedHeaders:X}}}function xe(){E(ae()),Q=[],ne=[]}},this.abort=function(){I=!0},this.getCharIndex=function(){return F}}function y(D){var S=D.data,T=c[S.workerId],A=!1;if(S.error)T.userError(S.error,S.file);else if(S.results&&S.results.data){var E={abort:function(){A=!0,b(S.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:_,resume:_};if(N(T.userStep)){for(var M=0;M<S.results.data.length&&(T.userStep({data:S.results.data[M],errors:S.results.errors,meta:S.results.meta},E),!A);M++);delete S.results}else N(T.userChunk)&&(T.userChunk(S.results,E,S.file),delete S.results)}S.finished&&!A&&b(S.workerId,S.results)}function b(D,S){var T=c[D];N(T.userComplete)&&T.userComplete(S),T.terminate(),delete c[D]}function _(){throw new Error("Not implemented.")}function w(D){if(typeof D!="object"||D===null)return D;var S,T=Array.isArray(D)?[]:{};for(S in D)T[S]=w(D[S]);return T}function j(D,S){return function(){D.apply(S,arguments)}}function N(D){return typeof D=="function"}return u.parse=function(D,S){var T=(S=S||{}).dynamicTyping||!1;if(N(T)&&(S.dynamicTypingFunction=T,T={}),S.dynamicTyping=T,S.transform=!!N(S.transform)&&S.transform,!S.worker||!u.WORKERS_SUPPORTED)return T=null,u.NODE_STREAM_INPUT,typeof D=="string"?(D=(A=>A.charCodeAt(0)!==65279?A:A.slice(1))(D),T=new(S.download?f:m)(S)):D.readable===!0&&N(D.read)&&N(D.on)?T=new x(S):(n.File&&D instanceof File||D instanceof Object)&&(T=new h(S)),T.stream(D);(T=(()=>{var A;return!!u.WORKERS_SUPPORTED&&(A=(()=>{var E=n.URL||n.webkitURL||null,M=r.toString();return u.BLOB_URL||(u.BLOB_URL=E.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",M,")();"],{type:"text/javascript"})))})(),(A=new n.Worker(A)).onmessage=y,A.id=l++,c[A.id]=A)})()).userStep=S.step,T.userChunk=S.chunk,T.userComplete=S.complete,T.userError=S.error,S.step=N(S.step),S.chunk=N(S.chunk),S.complete=N(S.complete),S.error=N(S.error),delete S.worker,T.postMessage({input:D,config:S,workerId:T.id})},u.unparse=function(D,S){var T=!1,A=!0,E=",",M=`\r
`,P='"',X=P+P,q=!1,B=null,O=!1,F=((()=>{if(typeof S=="object"){if(typeof S.delimiter!="string"||u.BAD_DELIMITERS.filter(function(C){return S.delimiter.indexOf(C)!==-1}).length||(E=S.delimiter),typeof S.quotes!="boolean"&&typeof S.quotes!="function"&&!Array.isArray(S.quotes)||(T=S.quotes),typeof S.skipEmptyLines!="boolean"&&typeof S.skipEmptyLines!="string"||(q=S.skipEmptyLines),typeof S.newline=="string"&&(M=S.newline),typeof S.quoteChar=="string"&&(P=S.quoteChar),typeof S.header=="boolean"&&(A=S.header),Array.isArray(S.columns)){if(S.columns.length===0)throw new Error("Option columns is empty");B=S.columns}S.escapeChar!==void 0&&(X=S.escapeChar+P),S.escapeFormulae instanceof RegExp?O=S.escapeFormulae:typeof S.escapeFormulae=="boolean"&&S.escapeFormulae&&(O=/^[=+\-@\t\r].*$/)}})(),new RegExp(g(P),"g"));if(typeof D=="string"&&(D=JSON.parse(D)),Array.isArray(D)){if(!D.length||Array.isArray(D[0]))return I(null,D,q);if(typeof D[0]=="object")return I(B||Object.keys(D[0]),D,q)}else if(typeof D=="object")return typeof D.data=="string"&&(D.data=JSON.parse(D.data)),Array.isArray(D.data)&&(D.fields||(D.fields=D.meta&&D.meta.fields||B),D.fields||(D.fields=Array.isArray(D.data[0])?D.fields:typeof D.data[0]=="object"?Object.keys(D.data[0]):[]),Array.isArray(D.data[0])||typeof D.data[0]=="object"||(D.data=[D.data])),I(D.fields||[],D.data||[],q);throw new Error("Unable to serialize unrecognized input");function I(C,k,z){var V="",Z=(typeof C=="string"&&(C=JSON.parse(C)),typeof k=="string"&&(k=JSON.parse(k)),Array.isArray(C)&&0<C.length),ce=!Array.isArray(k[0]);if(Z&&A){for(var ie=0;ie<C.length;ie++)0<ie&&(V+=E),V+=L(C[ie],ie);0<k.length&&(V+=M)}for(var Q=0;Q<k.length;Q++){var ne=(Z?C:k[Q]).length,pe=!1,W=Z?Object.keys(k[Q]).length===0:k[Q].length===0;if(z&&!Z&&(pe=z==="greedy"?k[Q].join("").trim()==="":k[Q].length===1&&k[Q][0].length===0),z==="greedy"&&Z){for(var re=[],U=0;U<ne;U++){var se=ce?C[U]:U;re.push(k[Q][se])}pe=re.join("").trim()===""}if(!pe){for(var te=0;te<ne;te++){0<te&&!W&&(V+=E);var K=Z&&ce?C[te]:te;V+=L(k[Q][K],te)}Q<k.length-1&&(!z||0<ne&&!W)&&(V+=M)}}return V}function L(C,k){var z,V;return C==null?"":C.constructor===Date?JSON.stringify(C).slice(1,25):(V=!1,O&&typeof C=="string"&&O.test(C)&&(C="'"+C,V=!0),z=C.toString().replace(F,X),(V=V||T===!0||typeof T=="function"&&T(C,k)||Array.isArray(T)&&T[k]||((Z,ce)=>{for(var ie=0;ie<ce.length;ie++)if(-1<Z.indexOf(ce[ie]))return!0;return!1})(z,u.BAD_DELIMITERS)||-1<z.indexOf(E)||z.charAt(0)===" "||z.charAt(z.length-1)===" ")?P+z+P:z)}},u.RECORD_SEP="",u.UNIT_SEP="",u.BYTE_ORDER_MARK="\uFEFF",u.BAD_DELIMITERS=["\r",`
`,'"',u.BYTE_ORDER_MARK],u.WORKERS_SUPPORTED=!i&&!!n.Worker,u.NODE_STREAM_INPUT=1,u.LocalChunkSize=10485760,u.RemoteChunkSize=5242880,u.DefaultDelimiter=",",u.Parser=v,u.ParserHandle=p,u.NetworkStreamer=f,u.FileStreamer=h,u.StringStreamer=m,u.ReadableStreamStreamer=x,n.jQuery&&((a=n.jQuery).fn.parse=function(D){var S=D.config||{},T=[];return this.each(function(M){if(!(a(this).prop("tagName").toUpperCase()==="INPUT"&&a(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var P=0;P<this.files.length;P++)T.push({file:this.files[P],inputElem:this,instanceConfig:a.extend({},S)})}),A(),this;function A(){if(T.length===0)N(D.complete)&&D.complete();else{var M,P,X,q,B=T[0];if(N(D.before)){var O=D.before(B.file,B.inputElem);if(typeof O=="object"){if(O.action==="abort")return M="AbortError",P=B.file,X=B.inputElem,q=O.reason,void(N(D.error)&&D.error({name:M},P,X,q));if(O.action==="skip")return void E();typeof O.config=="object"&&(B.instanceConfig=a.extend(B.instanceConfig,O.config))}else if(O==="skip")return void E()}var F=B.instanceConfig.complete;B.instanceConfig.complete=function(I){N(F)&&F(I,B.file,B.inputElem),E()},u.parse(B.file,B.instanceConfig)}}function E(){T.splice(0,1),A()}}),o&&(n.onmessage=function(D){D=D.data,u.WORKER_ID===void 0&&D&&(u.WORKER_ID=D.workerId),typeof D.input=="string"?n.postMessage({workerId:u.WORKER_ID,results:u.parse(D.input,D.config),finished:!0}):(n.File&&D.input instanceof File||D.input instanceof Object)&&(D=u.parse(D.input,D.config))&&n.postMessage({workerId:u.WORKER_ID,results:D,finished:!0})}),(f.prototype=Object.create(d.prototype)).constructor=f,(h.prototype=Object.create(d.prototype)).constructor=h,(m.prototype=Object.create(m.prototype)).constructor=m,(x.prototype=Object.create(d.prototype)).constructor=x,u})})(fI);var Bje=fI.exports;const Tf=Rt(Bje),Lje=({fileUrl:e,fileName:t})=>{const[r,n]=R.useState([]),[a,i]=R.useState([]),[o,c]=R.useState(!0),[l,u]=R.useState(null),[d,f]=R.useState(1),h=50;if(R.useEffect(()=>{e&&(async()=>{try{c(!0),u(null);const y=await fetch(e);if(!y.ok)throw new Error("Failed to load file");const b=await y.text();Tf.parse(b,{header:!0,skipEmptyLines:!0,complete:_=>{if(_.errors.length>0&&console.warn("CSV parsing warnings:",_.errors),_.data.length===0){u("CSV file is empty"),c(!1);return}i(_.meta.fields||Object.keys(_.data[0])),n(_.data),c(!1)},error:_=>{u(_.message),c(!1)}})}catch(y){u(y.message),c(!1)}})()},[e]),o)return s.jsx("div",{className:"flex items-center justify-center h-full min-h-[400px]",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2"}),s.jsx("p",{className:"text-text-secondary",children:"Loading CSV file..."})]})});if(l)return s.jsxs("div",{className:"flex flex-col items-center justify-center h-full min-h-[400px] text-center",children:[s.jsx(G,{name:"AlertCircle",size:48,className:"text-error mb-4"}),s.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-2",children:"Failed to load CSV"}),s.jsx("p",{className:"text-text-secondary",children:l})]});const m=Math.ceil(r.length/h),x=(d-1)*h,p=x+h,g=r.slice(x,p);return s.jsxs("div",{className:"h-full flex flex-col",children:[s.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 px-4 py-2 rounded-t-lg flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4 text-sm text-text-secondary",children:[s.jsxs("span",{children:[s.jsx("strong",{children:r.length})," rows"]}),s.jsx("span",{children:""}),s.jsxs("span",{children:[s.jsx("strong",{children:a.length})," columns"]})]}),m>1&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>f(v=>Math.max(1,v-1)),disabled:d===1,className:"p-1 rounded hover:bg-white dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(G,{name:"ChevronLeft",size:16})}),s.jsxs("span",{className:"text-sm text-text-secondary",children:["Page ",d," of ",m]}),s.jsx("button",{onClick:()=>f(v=>Math.min(m,v+1)),disabled:d===m,className:"p-1 rounded hover:bg-white dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(G,{name:"ChevronRight",size:16})})]})]}),s.jsx("div",{className:"flex-1 overflow-auto bg-white dark:bg-gray-800 rounded-b-lg",children:s.jsxs("table",{className:"w-full border-collapse",children:[s.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700 sticky top-0",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-text-secondary border-b border-border w-12",children:"#"}),a.map((v,y)=>s.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-text-secondary border-b border-border whitespace-nowrap",children:v},y))]})}),s.jsx("tbody",{children:g.map((v,y)=>s.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[s.jsx("td",{className:"px-4 py-2 text-xs text-text-tertiary border-b border-border",children:x+y+1}),a.map((b,_)=>s.jsx("td",{className:"px-4 py-2 text-sm text-text-primary border-b border-border whitespace-nowrap",children:v[b]||""},_))]},x+y))})]})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Cf={};Cf.version="0.18.5";var Ca=1200,pc=1252,$je=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],z_={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},dg=function(e){$je.indexOf(e)!=-1&&(pc=z_[0]=e)};function Wje(){dg(1252)}var ei=function(e){Ca=e,dg(e)};function fg(){ei(1200),Wje()}function fx(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function zje(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function hI(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var cl=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?zje(e.slice(2)):t==254&&r==255?hI(e.slice(2)):t==65279?e.slice(1):e},gd=function(t){return String.fromCharCode(t)},E2=function(t){return String.fromCharCode(t)},Ct;function qje(e){Ct=e,ei=function(t){Ca=t,dg(t)},cl=function(t){return t.charCodeAt(0)===255&&t.charCodeAt(1)===254?Ct.utils.decode(1200,fx(t.slice(2))):t},gd=function(r){return Ca===1200?String.fromCharCode(r):Ct.utils.decode(Ca,[r&255,r>>8])[0]},E2=function(r){return Ct.utils.decode(pc,[r])[0]},WI()}var Zs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Af(e){for(var t="",r=0,n=0,a=0,i=0,o=0,c=0,l=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,n=e.charCodeAt(u++),o=(r&3)<<4|n>>4,a=e.charCodeAt(u++),c=(n&15)<<2|a>>6,l=a&63,isNaN(n)?c=l=64:isNaN(a)&&(l=64),t+=Zs.charAt(i)+Zs.charAt(o)+Zs.charAt(c)+Zs.charAt(l);return t}function Aa(e){var t="",r=0,n=0,a=0,i=0,o=0,c=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=Zs.indexOf(e.charAt(u++)),o=Zs.indexOf(e.charAt(u++)),r=i<<2|o>>4,t+=String.fromCharCode(r),c=Zs.indexOf(e.charAt(u++)),n=(o&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(n)),l=Zs.indexOf(e.charAt(u++)),a=(c&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var _t=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Us=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function fo(e){return _t?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function OA(e){return _t?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var wa=function(t){return _t?Us(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Ch(e){if(typeof ArrayBuffer>"u")return wa(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Do(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Hje(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function q_(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return q_(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Qr=_t?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Us(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function Vje(e){for(var t=[],r=0,n=e.length+250,a=fo(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var c=e.charCodeAt(++i)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|c>>6&15|(o&3)<<4,a[r++]=128|c&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(t.push(a.slice(0,r)),r=0,a=fo(65535),n=65530)}return t.push(a.slice(0,r)),Qr(t)}var On=/\u0000/g,vd=/[\u0001-\u0006]/g;function gl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function yi(e,t){var r=""+e;return r.length>=t?r:wr("0",t-r.length)+r}function H_(e,t){var r=""+e;return r.length>=t?r:wr(" ",t-r.length)+r}function hx(e,t){var r=""+e;return r.length>=t?r:r+wr(" ",t-r.length)}function Gje(e,t){var r=""+Math.round(e);return r.length>=t?r:wr("0",t-r.length)+r}function Xje(e,t){var r=""+e;return r.length>=t?r:wr("0",t-r.length)+r}var PA=Math.pow(2,32);function Vc(e,t){if(e>PA||e<-PA)return Gje(e,t);var r=Math.round(e);return Xje(r,t)}function mx(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var IA=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ay=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Kje(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var at={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},UA={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Yje={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function px(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,o=1,c=0,l=1,u=0,d=0,f=Math.floor(a);u<t&&(f=Math.floor(a),c=f*o+i,d=f*u+l,!(a-f<5e-8));)a=1/(a-f),i=o,o=c,l=u,u=d;if(d>t&&(u>t?(d=l,c=i):(d=u,c=o)),!r)return[0,n*c,d];var h=Math.floor(n*c/d);return[h,n*c-h*d,d]}function Js(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,o=[],c={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++n,++c.D)),n===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=rNe(l,o))}return c.y=o[0],c.m=o[1],c.d=o[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=i,c}var mI=new Date(1899,11,31,0,0,0),Zje=mI.getTime(),Jje=new Date(1900,2,1,0,0,0);function pI(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Jje&&(r+=24*60*60*1e3),(r-(Zje+(e.getTimezoneOffset()-mI.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function V_(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Qje(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function eNe(e){var t=e<0?12:11,r=V_(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function tNe(e){var t=V_(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function kf(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=eNe(e):t===10?r=e.toFixed(10).substr(0,12):r=tNe(e),V_(Qje(r.toUpperCase()))}function xc(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):kf(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ka(14,pI(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function rNe(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function nNe(e,t,r,n){var a="",i=0,o=0,c=r.y,l,u=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:l=c%100,u=2;break;default:l=c%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,u=t.length;break;case 3:return ay[r.m-1][1];case 5:return ay[r.m-1][0];default:return ay[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,u=t.length;break;case 3:return IA[r.q][0];default:return IA[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?yi(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(a=yi(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=c,u=1;break}var d=u>0?yi(l,u):"";return d}function Qs(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var xI=/%/g;function aNe(e,t,r){var n=t.replace(xI,""),a=t.length-n.length;return bs(e,n,r*Math.pow(10,2*a))+wr("%",a)}function iNe(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return bs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function gI(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+gI(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,l,u,d){return l+u+d.substr(0,(a+i)%a)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var vI=/# (\?+)( ?)\/( ?)(\d+)/;function sNe(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),o=a-i*n,c=n;return r+(i===0?"":""+i)+" "+(o===0?wr(" ",e[1].length+1+e[4].length):H_(o,e[1].length)+e[2]+"/"+e[3]+yi(c,e[4].length))}function oNe(e,t,r){return r+(t===0?"":""+t)+wr(" ",e[1].length+2+e[4].length)}var yI=/^#*0*\.([0#]+)/,bI=/\).*[0#]/,wI=/\(###\) ###\\?-####/;function $n(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function RA(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function MA(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function cNe(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function lNe(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function $a(e,t,r){if(e.charCodeAt(0)===40&&!t.match(bI)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?$a("n",n,r):"("+$a("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return iNe(e,t,r);if(t.indexOf("%")!==-1)return aNe(e,t,r);if(t.indexOf("E")!==-1)return gI(t,r);if(t.charCodeAt(0)===36)return"$"+$a(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,o,c,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Vc(l,t.length);if(t.match(/^[#?]+$/))return a=Vc(r,0),a==="0"&&(a=""),a.length>t.length?a:$n(t.substr(0,t.length-a.length))+a;if(i=t.match(vI))return sNe(i,l,u);if(t.match(/^#+0+$/))return u+Vc(l,t.length-t.indexOf("0"));if(i=t.match(yI))return a=RA(r,i[1].length).replace(/^([^\.]+)$/,"$1."+$n(i[1])).replace(/\.$/,"."+$n(i[1])).replace(/\.(\d*)$/,function(x,p){return"."+p+wr("0",$n(i[1]).length-p.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+RA(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Qs(Vc(l,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+$a(e,t,-r):Qs(""+(Math.floor(r)+cNe(r,i[1].length)))+"."+yi(MA(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return $a(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=gl($a(e,t.replace(/[\\-]/g,""),r)),o=0,gl(gl(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<a.length?a.charAt(o++):x==="0"?"0":""}));if(t.match(wI))return a=$a(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),c=px(l,Math.pow(10,o)-1,!1),a=""+u,d=bs("n",i[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+i[2]+"/"+i[3],d=hx(c[2],o),d.length<i[4].length&&(d=$n(i[4].substr(i[4].length-d.length))+d),a+=d,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),c=px(l,Math.pow(10,o)-1,!0),u+(c[0]||(c[1]?"":"0"))+" "+(c[1]?H_(c[1],o)+i[2]+"/"+i[3]+hx(c[2],o):wr(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Vc(r,0),t.length<=a.length?a:$n(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=t.indexOf(".")-o,h=t.length-a.length-f;return $n(t.substr(0,f)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=MA(r,i[1].length),r<0?"-"+$a(e,t,-r):Qs(lNe(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?yi(0,3-x.length):"")+x})+"."+yi(o,i[1].length);switch(t){case"###,##0.00":return $a(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Qs(Vc(l,0));return m!=="0"?u+m:"";case"###,###.00":return $a(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return $a(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function uNe(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return bs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function dNe(e,t,r){var n=t.replace(xI,""),a=t.length-n.length;return bs(e,n,r*Math.pow(10,2*a))+wr("%",a)}function _I(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+_I(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,l,u,d){return l+u+d.substr(0,(a+i)%a)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ri(e,t,r){if(e.charCodeAt(0)===40&&!t.match(bI)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ri("n",n,r):"("+Ri("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return uNe(e,t,r);if(t.indexOf("%")!==-1)return dNe(e,t,r);if(t.indexOf("E")!==-1)return _I(t,r);if(t.charCodeAt(0)===36)return"$"+Ri(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,o,c,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+yi(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:$n(t.substr(0,t.length-a.length))+a;if(i=t.match(vI))return oNe(i,l,u);if(t.match(/^#+0+$/))return u+yi(l,t.length-t.indexOf("0"));if(i=t.match(yI))return a=(""+r).replace(/^([^\.]+)$/,"$1."+$n(i[1])).replace(/\.$/,"."+$n(i[1])),a=a.replace(/\.(\d*)$/,function(x,p){return"."+p+wr("0",$n(i[1]).length-p.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Qs(""+l);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ri(e,t,-r):Qs(""+r)+"."+wr("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Ri(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=gl(Ri(e,t.replace(/[\\-]/g,""),r)),o=0,gl(gl(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<a.length?a.charAt(o++):x==="0"?"0":""}));if(t.match(wI))return a=Ri(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),c=px(l,Math.pow(10,o)-1,!1),a=""+u,d=bs("n",i[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+i[2]+"/"+i[3],d=hx(c[2],o),d.length<i[4].length&&(d=$n(i[4].substr(i[4].length-d.length))+d),a+=d,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),c=px(l,Math.pow(10,o)-1,!0),u+(c[0]||(c[1]?"":"0"))+" "+(c[1]?H_(c[1],o)+i[2]+"/"+i[3]+hx(c[2],o):wr(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:$n(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=t.indexOf(".")-o,h=t.length-a.length-f;return $n(t.substr(0,f)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ri(e,t,-r):Qs(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?yi(0,3-x.length):"")+x})+"."+yi(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=Qs(""+l);return m!=="0"?u+m:"";default:if(t.match(/\.[0#?]*$/))return Ri(e,t.slice(0,t.lastIndexOf(".")),r)+$n(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function bs(e,t,r){return(r|0)===r?Ri(e,t,r):$a(e,t,r)}function fNe(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var jI=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ac(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":mx(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(jI))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function hNe(e,t,r,n){for(var a=[],i="",o=0,c="",l="t",u,d,f,h="H";o<e.length;)switch(c=e.charAt(o)){case"G":if(!mx(e,o))throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(f=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(f);a[a.length]={t:"t",v:i},++o;break;case"\\":var m=e.charAt(++o),x=m==="("||m===")"?m:"t";a[a.length]={t:x,v:m},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=Js(t,r,e.charAt(o+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(o,2)},l=c,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Js(t,r),u==null))return"";for(i=c;++o<e.length&&e.charAt(o).toLowerCase()===c;)i+=c;c==="m"&&l.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=h),a[a.length]={t:c,v:i},l=c;break;case"A":case"a":case"":var p={t:c,v:c};if(u==null&&(u=Js(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",h="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",o+=5,h="h"):e.substr(o,5).toUpperCase()==="/"?(u!=null&&(p.v=u.H>=12?"":""),p.t="T",o+=5,h="h"):(p.t="t",++o),u==null&&p.t==="T")return"";a[a.length]=p,l=c;break;case"[":for(i=c;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(jI)){if(u==null&&(u=Js(t,r),u==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ac(e)||(a[a.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=c;++o<e.length&&(c=e.charAt(o))==="0";)i+=c;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++o<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(o))>-1;)i+=c;a[a.length]={t:"n",v:i};break;case"?":for(i=c;e.charAt(++o)===c;)i+=c;a[a.length]={t:c,v:i},l=c;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":c,v:c},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:c,v:c},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"t",v:c},++o;break}var g=0,v=0,y;for(o=a.length-1,l="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=h,l="h",g<1&&(g=1);break;case"s":(y=a[o].v.match(/\.0+$/))&&(v=Math.max(v,y[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=a[o].t;break;case"m":l==="s"&&(a[o].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&a[o].v.match(/[Hh]/)&&(g=1),g<2&&a[o].v.match(/[Mm]/)&&(g=2),g<3&&a[o].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var b="",_;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=nNe(a[o].t.charCodeAt(0),a[o].v,u,v),a[o].t="t";break;case"n":case"?":for(_=o+1;a[_]!=null&&((c=a[_].t)==="?"||c==="D"||(c===" "||c==="t")&&a[_+1]!=null&&(a[_+1].t==="?"||a[_+1].t==="t"&&a[_+1].v==="/")||a[o].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[_].v==="/"||a[_].v===" "&&a[_+1]!=null&&a[_+1].t=="?"));)a[o].v+=a[_].v,a[_]={v:"",t:";"},++_;b+=a[o].v,o=_-1;break;case"G":a[o].t="t",a[o].v=xc(t,r);break}var w="",j,N;if(b.length>0){b.charCodeAt(0)==40?(j=t<0&&b.charCodeAt(0)===45?-t:t,N=bs("n",b,j)):(j=t<0&&n>1?-t:t,N=bs("n",b,j),j<0&&a[0]&&a[0].t=="t"&&(N=N.substr(1),a[0].v="-"+a[0].v)),_=N.length-1;var D=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){D=o;break}var S=a.length;if(D===a.length&&N.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(_>=a[o].v.length-1?(_-=a[o].v.length,a[o].v=N.substr(_+1,a[o].v.length)):_<0?a[o].v="":(a[o].v=N.substr(0,_+1),_=-1),a[o].t="t",S=o);_>=0&&S<a.length&&(a[S].v=N.substr(0,_+1)+a[S].v)}else if(D!==a.length&&N.indexOf("E")===-1){for(_=N.indexOf(".")-1,o=D;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(d=a[o].v.indexOf(".")>-1&&o===D?a[o].v.indexOf(".")-1:a[o].v.length-1,w=a[o].v.substr(d+1);d>=0;--d)_>=0&&(a[o].v.charAt(d)==="0"||a[o].v.charAt(d)==="#")&&(w=N.charAt(_--)+w);a[o].v=w,a[o].t="t",S=o}for(_>=0&&S<a.length&&(a[S].v=N.substr(0,_+1)+a[S].v),_=N.indexOf(".")+1,o=D;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==D)){for(d=a[o].v.indexOf(".")>-1&&o===D?a[o].v.indexOf(".")+1:0,w=a[o].v.substr(0,d);d<a[o].v.length;++d)_<N.length&&(w+=N.charAt(_++));a[o].v=w,a[o].t="t",S=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(j=n>1&&t<0&&o>0&&a[o-1].v==="-"?-t:t,a[o].v=bs(a[o].t,a[o].v,j),a[o].t="t");var T="";for(o=0;o!==a.length;++o)a[o]!=null&&(T+=a[o].v);return T}var BA=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function LA(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function mNe(e,t){var r=fNe(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(BA),c=r[1].match(BA);return LA(t,o)?[n,r[0]]:LA(t,c)?[n,r[1]]:[n,r[o!=null&&c!=null?2:1]]}return[n,i]}function ka(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:at)[e],n==null&&(n=r.table&&r.table[UA[e]]||at[UA[e]]),n==null&&(n=Yje[e]||"General");break}if(mx(n,0))return xc(t,r);t instanceof Date&&(t=pI(t,r.date1904));var a=mNe(n,t);if(mx(a[1]))return xc(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return hNe(a[1],t,r,a[0])}function Hi(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(at[r]==null){t<0&&(t=r);continue}if(at[r]==e){t=r;break}}t<0&&(t=391)}return at[t]=e,t}function Ah(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Hi(e[t],t)}function Fu(){at=Kje()}var NI={format:ka,load:Hi,_table:at,load_table:Ah,parse_date_code:Js,is_date:Ac,get_table:function(){return NI._table=at}},pNe={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},DI=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function xNe(e){var t=typeof e=="number"?at[e]:e;return t=t.replace(DI,"(\\d+)"),new RegExp("^"+t+"$")}function gNe(e,t,r){var n=-1,a=-1,i=-1,o=-1,c=-1,l=-1;(t.match(DI)||[]).forEach(function(f,h){var m=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=m;break;case"d":i=m;break;case"h":o=m;break;case"s":l=m;break;case"m":o>=0?c=m:a=m;break}}),l>=0&&c==-1&&a>=0&&(c=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&c==-1&&l==-1?u:n==-1&&a==-1&&i==-1?d:u+"T"+d}var vNe=function(){var e={};e.version="1.2.0";function t(){for(var N=0,D=new Array(256),S=0;S!=256;++S)N=S,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,D[S]=N;return typeof Int32Array<"u"?new Int32Array(D):D}var r=t();function n(N){var D=0,S=0,T=0,A=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(T=0;T!=256;++T)A[T]=N[T];for(T=0;T!=256;++T)for(S=N[T],D=256+T;D<4096;D+=256)S=A[D]=S>>>8^N[S&255];var E=[];for(T=1;T!=16;++T)E[T-1]=typeof Int32Array<"u"?A.subarray(T*256,T*256+256):A.slice(T*256,T*256+256);return E}var a=n(r),i=a[0],o=a[1],c=a[2],l=a[3],u=a[4],d=a[5],f=a[6],h=a[7],m=a[8],x=a[9],p=a[10],g=a[11],v=a[12],y=a[13],b=a[14];function _(N,D){for(var S=D^-1,T=0,A=N.length;T<A;)S=S>>>8^r[(S^N.charCodeAt(T++))&255];return~S}function w(N,D){for(var S=D^-1,T=N.length-15,A=0;A<T;)S=b[N[A++]^S&255]^y[N[A++]^S>>8&255]^v[N[A++]^S>>16&255]^g[N[A++]^S>>>24]^p[N[A++]]^x[N[A++]]^m[N[A++]]^h[N[A++]]^f[N[A++]]^d[N[A++]]^u[N[A++]]^l[N[A++]]^c[N[A++]]^o[N[A++]]^i[N[A++]]^r[N[A++]];for(T+=15;A<T;)S=S>>>8^r[(S^N[A++])&255];return~S}function j(N,D){for(var S=D^-1,T=0,A=N.length,E=0,M=0;T<A;)E=N.charCodeAt(T++),E<128?S=S>>>8^r[(S^E)&255]:E<2048?(S=S>>>8^r[(S^(192|E>>6&31))&255],S=S>>>8^r[(S^(128|E&63))&255]):E>=55296&&E<57344?(E=(E&1023)+64,M=N.charCodeAt(T++)&1023,S=S>>>8^r[(S^(240|E>>8&7))&255],S=S>>>8^r[(S^(128|E>>2&63))&255],S=S>>>8^r[(S^(128|M>>6&15|(E&3)<<4))&255],S=S>>>8^r[(S^(128|M&63))&255]):(S=S>>>8^r[(S^(224|E>>12&15))&255],S=S>>>8^r[(S^(128|E>>6&63))&255],S=S>>>8^r[(S^(128|E&63))&255]);return~S}return e.table=r,e.bstr=_,e.buf=w,e.str=j,e}(),et=function(){var t={};t.version="1.2.1";function r(Y,fe){for(var ue=Y.split("/"),de=fe.split("/"),me=0,ve=0,_e=Math.min(ue.length,de.length);me<_e;++me){if(ve=ue[me].length-de[me].length)return ve;if(ue[me]!=de[me])return ue[me]<de[me]?-1:1}return ue.length-de.length}function n(Y){if(Y.charAt(Y.length-1)=="/")return Y.slice(0,-1).indexOf("/")===-1?Y:n(Y.slice(0,-1));var fe=Y.lastIndexOf("/");return fe===-1?Y:Y.slice(0,fe+1)}function a(Y){if(Y.charAt(Y.length-1)=="/")return a(Y.slice(0,-1));var fe=Y.lastIndexOf("/");return fe===-1?Y:Y.slice(fe+1)}function i(Y,fe){typeof fe=="string"&&(fe=new Date(fe));var ue=fe.getHours();ue=ue<<6|fe.getMinutes(),ue=ue<<5|fe.getSeconds()>>>1,Y.write_shift(2,ue);var de=fe.getFullYear()-1980;de=de<<4|fe.getMonth()+1,de=de<<5|fe.getDate(),Y.write_shift(2,de)}function o(Y){var fe=Y.read_shift(2)&65535,ue=Y.read_shift(2)&65535,de=new Date,me=ue&31;ue>>>=5;var ve=ue&15;ue>>>=4,de.setMilliseconds(0),de.setFullYear(ue+1980),de.setMonth(ve-1),de.setDate(me);var _e=fe&31;fe>>>=5;var Te=fe&63;return fe>>>=6,de.setHours(fe),de.setMinutes(Te),de.setSeconds(_e<<1),de}function c(Y){hn(Y,0);for(var fe={},ue=0;Y.l<=Y.length-4;){var de=Y.read_shift(2),me=Y.read_shift(2),ve=Y.l+me,_e={};switch(de){case 21589:ue=Y.read_shift(1),ue&1&&(_e.mtime=Y.read_shift(4)),me>5&&(ue&2&&(_e.atime=Y.read_shift(4)),ue&4&&(_e.ctime=Y.read_shift(4))),_e.mtime&&(_e.mt=new Date(_e.mtime*1e3));break}Y.l=ve,fe[de]=_e}return fe}var l;function u(){return l||(l={})}function d(Y,fe){if(Y[0]==80&&Y[1]==75)return bt(Y,fe);if((Y[0]|32)==109&&(Y[1]|32)==105)return Xh(Y,fe);if(Y.length<512)throw new Error("CFB file size "+Y.length+" < 512");var ue=3,de=512,me=0,ve=0,_e=0,Te=0,we=0,je=[],Ne=Y.slice(0,512);hn(Ne,0);var Pe=f(Ne);switch(ue=Pe[0],ue){case 3:de=512;break;case 4:de=4096;break;case 0:if(Pe[1]==0)return bt(Y,fe);default:throw new Error("Major Version: Expected 3 or 4 saw "+ue)}de!==512&&(Ne=Y.slice(0,de),hn(Ne,28));var ze=Y.slice(0,de);h(Ne,ue);var Ve=Ne.read_shift(4,"i");if(ue===3&&Ve!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ve);Ne.l+=4,_e=Ne.read_shift(4,"i"),Ne.l+=4,Ne.chk("00100000","Mini Stream Cutoff Size: "),Te=Ne.read_shift(4,"i"),me=Ne.read_shift(4,"i"),we=Ne.read_shift(4,"i"),ve=Ne.read_shift(4,"i");for(var Ue=-1,qe=0;qe<109&&(Ue=Ne.read_shift(4,"i"),!(Ue<0));++qe)je[qe]=Ue;var mt=m(Y,de);g(we,ve,mt,de,je);var pr=y(mt,_e,je,de);pr[_e].name="!Directory",me>0&&Te!==M&&(pr[Te].name="!MiniFAT"),pr[je[0]].name="!FAT",pr.fat_addrs=je,pr.ssz=de;var xr={},wn=[],Wu=[],zu=[];b(_e,pr,mt,wn,me,xr,Wu,Te),x(Wu,zu,wn),wn.shift();var qu={FileIndex:Wu,FullPaths:zu};return fe&&fe.raw&&(qu.raw={header:ze,sectors:mt}),qu}function f(Y){if(Y[Y.l]==80&&Y[Y.l+1]==75)return[0,0];Y.chk(P,"Header Signature: "),Y.l+=16;var fe=Y.read_shift(2,"u");return[Y.read_shift(2,"u"),fe]}function h(Y,fe){var ue=9;switch(Y.l+=2,ue=Y.read_shift(2)){case 9:if(fe!=3)throw new Error("Sector Shift: Expected 9 saw "+ue);break;case 12:if(fe!=4)throw new Error("Sector Shift: Expected 12 saw "+ue);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ue)}Y.chk("0600","Mini Sector Shift: "),Y.chk("000000000000","Reserved: ")}function m(Y,fe){for(var ue=Math.ceil(Y.length/fe)-1,de=[],me=1;me<ue;++me)de[me-1]=Y.slice(me*fe,(me+1)*fe);return de[ue-1]=Y.slice(ue*fe),de}function x(Y,fe,ue){for(var de=0,me=0,ve=0,_e=0,Te=0,we=ue.length,je=[],Ne=[];de<we;++de)je[de]=Ne[de]=de,fe[de]=ue[de];for(;Te<Ne.length;++Te)de=Ne[Te],me=Y[de].L,ve=Y[de].R,_e=Y[de].C,je[de]===de&&(me!==-1&&je[me]!==me&&(je[de]=je[me]),ve!==-1&&je[ve]!==ve&&(je[de]=je[ve])),_e!==-1&&(je[_e]=de),me!==-1&&de!=je[de]&&(je[me]=je[de],Ne.lastIndexOf(me)<Te&&Ne.push(me)),ve!==-1&&de!=je[de]&&(je[ve]=je[de],Ne.lastIndexOf(ve)<Te&&Ne.push(ve));for(de=1;de<we;++de)je[de]===de&&(ve!==-1&&je[ve]!==ve?je[de]=je[ve]:me!==-1&&je[me]!==me&&(je[de]=je[me]));for(de=1;de<we;++de)if(Y[de].type!==0){if(Te=de,Te!=je[Te])do Te=je[Te],fe[de]=fe[Te]+"/"+fe[de];while(Te!==0&&je[Te]!==-1&&Te!=je[Te]);je[de]=-1}for(fe[0]+="/",de=1;de<we;++de)Y[de].type!==2&&(fe[de]+="/")}function p(Y,fe,ue){for(var de=Y.start,me=Y.size,ve=[],_e=de;ue&&me>0&&_e>=0;)ve.push(fe.slice(_e*E,_e*E+E)),me-=E,_e=Yo(ue,_e*4);return ve.length===0?Se(0):Qr(ve).slice(0,Y.size)}function g(Y,fe,ue,de,me){var ve=M;if(Y===M){if(fe!==0)throw new Error("DIFAT chain shorter than expected")}else if(Y!==-1){var _e=ue[Y],Te=(de>>>2)-1;if(!_e)return;for(var we=0;we<Te&&(ve=Yo(_e,we*4))!==M;++we)me.push(ve);g(Yo(_e,de-4),fe-1,ue,de,me)}}function v(Y,fe,ue,de,me){var ve=[],_e=[];me||(me=[]);var Te=de-1,we=0,je=0;for(we=fe;we>=0;){me[we]=!0,ve[ve.length]=we,_e.push(Y[we]);var Ne=ue[Math.floor(we*4/de)];if(je=we*4&Te,de<4+je)throw new Error("FAT boundary crossed: "+we+" 4 "+de);if(!Y[Ne])break;we=Yo(Y[Ne],je)}return{nodes:ve,data:JA([_e])}}function y(Y,fe,ue,de){var me=Y.length,ve=[],_e=[],Te=[],we=[],je=de-1,Ne=0,Pe=0,ze=0,Ve=0;for(Ne=0;Ne<me;++Ne)if(Te=[],ze=Ne+fe,ze>=me&&(ze-=me),!_e[ze]){we=[];var Ue=[];for(Pe=ze;Pe>=0;){Ue[Pe]=!0,_e[Pe]=!0,Te[Te.length]=Pe,we.push(Y[Pe]);var qe=ue[Math.floor(Pe*4/de)];if(Ve=Pe*4&je,de<4+Ve)throw new Error("FAT boundary crossed: "+Pe+" 4 "+de);if(!Y[qe]||(Pe=Yo(Y[qe],Ve),Ue[Pe]))break}ve[ze]={nodes:Te,data:JA([we])}}return ve}function b(Y,fe,ue,de,me,ve,_e,Te){for(var we=0,je=de.length?2:0,Ne=fe[Y].data,Pe=0,ze=0,Ve;Pe<Ne.length;Pe+=128){var Ue=Ne.slice(Pe,Pe+128);hn(Ue,64),ze=Ue.read_shift(2),Ve=xg(Ue,0,ze-je),de.push(Ve);var qe={name:Ve,type:Ue.read_shift(1),color:Ue.read_shift(1),L:Ue.read_shift(4,"i"),R:Ue.read_shift(4,"i"),C:Ue.read_shift(4,"i"),clsid:Ue.read_shift(16),state:Ue.read_shift(4,"i"),start:0,size:0},mt=Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2);mt!==0&&(qe.ct=_(Ue,Ue.l-8));var pr=Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2);pr!==0&&(qe.mt=_(Ue,Ue.l-8)),qe.start=Ue.read_shift(4,"i"),qe.size=Ue.read_shift(4,"i"),qe.size<0&&qe.start<0&&(qe.size=qe.type=0,qe.start=M,qe.name=""),qe.type===5?(we=qe.start,me>0&&we!==M&&(fe[we].name="!StreamData")):qe.size>=4096?(qe.storage="fat",fe[qe.start]===void 0&&(fe[qe.start]=v(ue,qe.start,fe.fat_addrs,fe.ssz)),fe[qe.start].name=qe.name,qe.content=fe[qe.start].data.slice(0,qe.size)):(qe.storage="minifat",qe.size<0?qe.size=0:we!==M&&qe.start!==M&&fe[we]&&(qe.content=p(qe,fe[we].data,(fe[Te]||{}).data))),qe.content&&hn(qe.content,0),ve[Ve]=qe,_e.push(qe)}}function _(Y,fe){return new Date((Jr(Y,fe+4)/1e7*Math.pow(2,32)+Jr(Y,fe)/1e7-11644473600)*1e3)}function w(Y,fe){return u(),d(l.readFileSync(Y),fe)}function j(Y,fe){var ue=fe&&fe.type;switch(ue||_t&&Buffer.isBuffer(Y)&&(ue="buffer"),ue||"base64"){case"file":return w(Y,fe);case"base64":return d(wa(Aa(Y)),fe);case"binary":return d(wa(Y),fe)}return d(Y,fe)}function N(Y,fe){var ue=fe||{},de=ue.root||"Root Entry";if(Y.FullPaths||(Y.FullPaths=[]),Y.FileIndex||(Y.FileIndex=[]),Y.FullPaths.length!==Y.FileIndex.length)throw new Error("inconsistent CFB structure");Y.FullPaths.length===0&&(Y.FullPaths[0]=de+"/",Y.FileIndex[0]={name:de,type:5}),ue.CLSID&&(Y.FileIndex[0].clsid=ue.CLSID),D(Y)}function D(Y){var fe="Sh33tJ5";if(!et.find(Y,"/"+fe)){var ue=Se(4);ue[0]=55,ue[1]=ue[3]=50,ue[2]=54,Y.FileIndex.push({name:fe,type:2,content:ue,size:4,L:69,R:69,C:69}),Y.FullPaths.push(Y.FullPaths[0]+fe),S(Y)}}function S(Y,fe){N(Y);for(var ue=!1,de=!1,me=Y.FullPaths.length-1;me>=0;--me){var ve=Y.FileIndex[me];switch(ve.type){case 0:de?ue=!0:(Y.FileIndex.pop(),Y.FullPaths.pop());break;case 1:case 2:case 5:de=!0,isNaN(ve.R*ve.L*ve.C)&&(ue=!0),ve.R>-1&&ve.L>-1&&ve.R==ve.L&&(ue=!0);break;default:ue=!0;break}}if(!(!ue&&!fe)){var _e=new Date(1987,1,19),Te=0,we=Object.create?Object.create(null):{},je=[];for(me=0;me<Y.FullPaths.length;++me)we[Y.FullPaths[me]]=!0,Y.FileIndex[me].type!==0&&je.push([Y.FullPaths[me],Y.FileIndex[me]]);for(me=0;me<je.length;++me){var Ne=n(je[me][0]);de=we[Ne],de||(je.push([Ne,{name:a(Ne).replace("/",""),type:1,clsid:q,ct:_e,mt:_e,content:null}]),we[Ne]=!0)}for(je.sort(function(Ve,Ue){return r(Ve[0],Ue[0])}),Y.FullPaths=[],Y.FileIndex=[],me=0;me<je.length;++me)Y.FullPaths[me]=je[me][0],Y.FileIndex[me]=je[me][1];for(me=0;me<je.length;++me){var Pe=Y.FileIndex[me],ze=Y.FullPaths[me];if(Pe.name=a(ze).replace("/",""),Pe.L=Pe.R=Pe.C=-(Pe.color=1),Pe.size=Pe.content?Pe.content.length:0,Pe.start=0,Pe.clsid=Pe.clsid||q,me===0)Pe.C=je.length>1?1:-1,Pe.size=0,Pe.type=5;else if(ze.slice(-1)=="/"){for(Te=me+1;Te<je.length&&n(Y.FullPaths[Te])!=ze;++Te);for(Pe.C=Te>=je.length?-1:Te,Te=me+1;Te<je.length&&n(Y.FullPaths[Te])!=n(ze);++Te);Pe.R=Te>=je.length?-1:Te,Pe.type=1}else n(Y.FullPaths[me+1]||"")==n(ze)&&(Pe.R=me+1),Pe.type=2}}}function T(Y,fe){var ue=fe||{};if(ue.fileType=="mad")return Oe(Y,ue);switch(S(Y),ue.fileType){case"zip":return ln(Y,ue)}var de=function(Ve){for(var Ue=0,qe=0,mt=0;mt<Ve.FileIndex.length;++mt){var pr=Ve.FileIndex[mt];if(pr.content){var xr=pr.content.length;xr>0&&(xr<4096?Ue+=xr+63>>6:qe+=xr+511>>9)}}for(var wn=Ve.FullPaths.length+3>>2,Wu=Ue+7>>3,zu=Ue+127>>7,qu=Wu+qe+wn+zu,Uo=qu+127>>7,fv=Uo<=109?0:Math.ceil((Uo-109)/127);qu+Uo+fv+127>>7>Uo;)fv=++Uo<=109?0:Math.ceil((Uo-109)/127);var ns=[1,fv,Uo,zu,wn,qe,Ue,0];return Ve.FileIndex[0].size=Ue<<6,ns[7]=(Ve.FileIndex[0].start=ns[0]+ns[1]+ns[2]+ns[3]+ns[4]+ns[5])+(ns[6]+7>>3),ns}(Y),me=Se(de[7]<<9),ve=0,_e=0;{for(ve=0;ve<8;++ve)me.write_shift(1,X[ve]);for(ve=0;ve<8;++ve)me.write_shift(2,0);for(me.write_shift(2,62),me.write_shift(2,3),me.write_shift(2,65534),me.write_shift(2,9),me.write_shift(2,6),ve=0;ve<3;++ve)me.write_shift(2,0);for(me.write_shift(4,0),me.write_shift(4,de[2]),me.write_shift(4,de[0]+de[1]+de[2]+de[3]-1),me.write_shift(4,0),me.write_shift(4,4096),me.write_shift(4,de[3]?de[0]+de[1]+de[2]-1:M),me.write_shift(4,de[3]),me.write_shift(-4,de[1]?de[0]-1:M),me.write_shift(4,de[1]),ve=0;ve<109;++ve)me.write_shift(-4,ve<de[2]?de[1]+ve:-1)}if(de[1])for(_e=0;_e<de[1];++_e){for(;ve<236+_e*127;++ve)me.write_shift(-4,ve<de[2]?de[1]+ve:-1);me.write_shift(-4,_e===de[1]-1?M:_e+1)}var Te=function(Ve){for(_e+=Ve;ve<_e-1;++ve)me.write_shift(-4,ve+1);Ve&&(++ve,me.write_shift(-4,M))};for(_e=ve=0,_e+=de[1];ve<_e;++ve)me.write_shift(-4,B.DIFSECT);for(_e+=de[2];ve<_e;++ve)me.write_shift(-4,B.FATSECT);Te(de[3]),Te(de[4]);for(var we=0,je=0,Ne=Y.FileIndex[0];we<Y.FileIndex.length;++we)Ne=Y.FileIndex[we],Ne.content&&(je=Ne.content.length,!(je<4096)&&(Ne.start=_e,Te(je+511>>9)));for(Te(de[6]+7>>3);me.l&511;)me.write_shift(-4,B.ENDOFCHAIN);for(_e=ve=0,we=0;we<Y.FileIndex.length;++we)Ne=Y.FileIndex[we],Ne.content&&(je=Ne.content.length,!(!je||je>=4096)&&(Ne.start=_e,Te(je+63>>6)));for(;me.l&511;)me.write_shift(-4,B.ENDOFCHAIN);for(ve=0;ve<de[4]<<2;++ve){var Pe=Y.FullPaths[ve];if(!Pe||Pe.length===0){for(we=0;we<17;++we)me.write_shift(4,0);for(we=0;we<3;++we)me.write_shift(4,-1);for(we=0;we<12;++we)me.write_shift(4,0);continue}Ne=Y.FileIndex[ve],ve===0&&(Ne.start=Ne.size?Ne.start-1:M);var ze=ve===0&&ue.root||Ne.name;if(je=2*(ze.length+1),me.write_shift(64,ze,"utf16le"),me.write_shift(2,je),me.write_shift(1,Ne.type),me.write_shift(1,Ne.color),me.write_shift(-4,Ne.L),me.write_shift(-4,Ne.R),me.write_shift(-4,Ne.C),Ne.clsid)me.write_shift(16,Ne.clsid,"hex");else for(we=0;we<4;++we)me.write_shift(4,0);me.write_shift(4,Ne.state||0),me.write_shift(4,0),me.write_shift(4,0),me.write_shift(4,0),me.write_shift(4,0),me.write_shift(4,Ne.start),me.write_shift(4,Ne.size),me.write_shift(4,0)}for(ve=1;ve<Y.FileIndex.length;++ve)if(Ne=Y.FileIndex[ve],Ne.size>=4096)if(me.l=Ne.start+1<<9,_t&&Buffer.isBuffer(Ne.content))Ne.content.copy(me,me.l,0,Ne.size),me.l+=Ne.size+511&-512;else{for(we=0;we<Ne.size;++we)me.write_shift(1,Ne.content[we]);for(;we&511;++we)me.write_shift(1,0)}for(ve=1;ve<Y.FileIndex.length;++ve)if(Ne=Y.FileIndex[ve],Ne.size>0&&Ne.size<4096)if(_t&&Buffer.isBuffer(Ne.content))Ne.content.copy(me,me.l,0,Ne.size),me.l+=Ne.size+63&-64;else{for(we=0;we<Ne.size;++we)me.write_shift(1,Ne.content[we]);for(;we&63;++we)me.write_shift(1,0)}if(_t)me.l=me.length;else for(;me.l<me.length;)me.write_shift(1,0);return me}function A(Y,fe){var ue=Y.FullPaths.map(function(we){return we.toUpperCase()}),de=ue.map(function(we){var je=we.split("/");return je[je.length-(we.slice(-1)=="/"?2:1)]}),me=!1;fe.charCodeAt(0)===47?(me=!0,fe=ue[0].slice(0,-1)+fe):me=fe.indexOf("/")!==-1;var ve=fe.toUpperCase(),_e=me===!0?ue.indexOf(ve):de.indexOf(ve);if(_e!==-1)return Y.FileIndex[_e];var Te=!ve.match(vd);for(ve=ve.replace(On,""),Te&&(ve=ve.replace(vd,"!")),_e=0;_e<ue.length;++_e)if((Te?ue[_e].replace(vd,"!"):ue[_e]).replace(On,"")==ve||(Te?de[_e].replace(vd,"!"):de[_e]).replace(On,"")==ve)return Y.FileIndex[_e];return null}var E=64,M=-2,P="d0cf11e0a1b11ae1",X=[208,207,17,224,161,177,26,225],q="00000000000000000000000000000000",B={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:M,FREESECT:-1,HEADER_SIGNATURE:P,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function O(Y,fe,ue){u();var de=T(Y,ue);l.writeFileSync(fe,de)}function F(Y){for(var fe=new Array(Y.length),ue=0;ue<Y.length;++ue)fe[ue]=String.fromCharCode(Y[ue]);return fe.join("")}function I(Y,fe){var ue=T(Y,fe);switch(fe&&fe.type||"buffer"){case"file":return u(),l.writeFileSync(fe.filename,ue),ue;case"binary":return typeof ue=="string"?ue:F(ue);case"base64":return Af(typeof ue=="string"?ue:F(ue));case"buffer":if(_t)return Buffer.isBuffer(ue)?ue:Us(ue);case"array":return typeof ue=="string"?wa(ue):ue}return ue}var L;function C(Y){try{var fe=Y.InflateRaw,ue=new fe;if(ue._processChunk(new Uint8Array([3,0]),ue._finishFlushFlag),ue.bytesRead)L=Y;else throw new Error("zlib does not expose bytesRead")}catch(de){console.error("cannot use native zlib: "+(de.message||de))}}function k(Y,fe){if(!L)return vt(Y,fe);var ue=L.InflateRaw,de=new ue,me=de._processChunk(Y.slice(Y.l),de._finishFlushFlag);return Y.l+=de.bytesRead,me}function z(Y){return L?L.deflateRawSync(Y):Fe(Y)}var V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ce=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ie(Y){var fe=(Y<<1|Y<<11)&139536|(Y<<5|Y<<15)&558144;return(fe>>16|fe>>8|fe)&255}for(var Q=typeof Uint8Array<"u",ne=Q?new Uint8Array(256):[],pe=0;pe<256;++pe)ne[pe]=ie(pe);function W(Y,fe){var ue=ne[Y&255];return fe<=8?ue>>>8-fe:(ue=ue<<8|ne[Y>>8&255],fe<=16?ue>>>16-fe:(ue=ue<<8|ne[Y>>16&255],ue>>>24-fe))}function re(Y,fe){var ue=fe&7,de=fe>>>3;return(Y[de]|(ue<=6?0:Y[de+1]<<8))>>>ue&3}function U(Y,fe){var ue=fe&7,de=fe>>>3;return(Y[de]|(ue<=5?0:Y[de+1]<<8))>>>ue&7}function se(Y,fe){var ue=fe&7,de=fe>>>3;return(Y[de]|(ue<=4?0:Y[de+1]<<8))>>>ue&15}function te(Y,fe){var ue=fe&7,de=fe>>>3;return(Y[de]|(ue<=3?0:Y[de+1]<<8))>>>ue&31}function K(Y,fe){var ue=fe&7,de=fe>>>3;return(Y[de]|(ue<=1?0:Y[de+1]<<8))>>>ue&127}function H(Y,fe,ue){var de=fe&7,me=fe>>>3,ve=(1<<ue)-1,_e=Y[me]>>>de;return ue<8-de||(_e|=Y[me+1]<<8-de,ue<16-de)||(_e|=Y[me+2]<<16-de,ue<24-de)||(_e|=Y[me+3]<<24-de),_e&ve}function oe(Y,fe,ue){var de=fe&7,me=fe>>>3;return de<=5?Y[me]|=(ue&7)<<de:(Y[me]|=ue<<de&255,Y[me+1]=(ue&7)>>8-de),fe+3}function J(Y,fe,ue){var de=fe&7,me=fe>>>3;return ue=(ue&1)<<de,Y[me]|=ue,fe+1}function le(Y,fe,ue){var de=fe&7,me=fe>>>3;return ue<<=de,Y[me]|=ue&255,ue>>>=8,Y[me+1]=ue,fe+8}function he(Y,fe,ue){var de=fe&7,me=fe>>>3;return ue<<=de,Y[me]|=ue&255,ue>>>=8,Y[me+1]=ue&255,Y[me+2]=ue>>>8,fe+16}function ee(Y,fe){var ue=Y.length,de=2*ue>fe?2*ue:fe+5,me=0;if(ue>=fe)return Y;if(_t){var ve=OA(de);if(Y.copy)Y.copy(ve);else for(;me<Y.length;++me)ve[me]=Y[me];return ve}else if(Q){var _e=new Uint8Array(de);if(_e.set)_e.set(Y);else for(;me<ue;++me)_e[me]=Y[me];return _e}return Y.length=de,Y}function ae(Y){for(var fe=new Array(Y),ue=0;ue<Y;++ue)fe[ue]=0;return fe}function xe(Y,fe,ue){var de=1,me=0,ve=0,_e=0,Te=0,we=Y.length,je=Q?new Uint16Array(32):ae(32);for(ve=0;ve<32;++ve)je[ve]=0;for(ve=we;ve<ue;++ve)Y[ve]=0;we=Y.length;var Ne=Q?new Uint16Array(we):ae(we);for(ve=0;ve<we;++ve)je[me=Y[ve]]++,de<me&&(de=me),Ne[ve]=0;for(je[0]=0,ve=1;ve<=de;++ve)je[ve+16]=Te=Te+je[ve-1]<<1;for(ve=0;ve<we;++ve)Te=Y[ve],Te!=0&&(Ne[ve]=je[Te+16]++);var Pe=0;for(ve=0;ve<we;++ve)if(Pe=Y[ve],Pe!=0)for(Te=W(Ne[ve],de)>>de-Pe,_e=(1<<de+4-Pe)-1;_e>=0;--_e)fe[Te|_e<<Pe]=Pe&15|ve<<4;return de}var ye=Q?new Uint16Array(512):ae(512),Ce=Q?new Uint16Array(32):ae(32);if(!Q){for(var Ie=0;Ie<512;++Ie)ye[Ie]=0;for(Ie=0;Ie<32;++Ie)Ce[Ie]=0}(function(){for(var Y=[],fe=0;fe<32;fe++)Y.push(5);xe(Y,Ce,32);var ue=[];for(fe=0;fe<=143;fe++)ue.push(8);for(;fe<=255;fe++)ue.push(9);for(;fe<=279;fe++)ue.push(7);for(;fe<=287;fe++)ue.push(8);xe(ue,ye,288)})();var Ze=function(){for(var fe=Q?new Uint8Array(32768):[],ue=0,de=0;ue<ce.length-1;++ue)for(;de<ce[ue+1];++de)fe[de]=ue;for(;de<32768;++de)fe[de]=29;var me=Q?new Uint8Array(259):[];for(ue=0,de=0;ue<Z.length-1;++ue)for(;de<Z[ue+1];++de)me[de]=ue;function ve(Te,we){for(var je=0;je<Te.length;){var Ne=Math.min(65535,Te.length-je),Pe=je+Ne==Te.length;for(we.write_shift(1,+Pe),we.write_shift(2,Ne),we.write_shift(2,~Ne&65535);Ne-- >0;)we[we.l++]=Te[je++]}return we.l}function _e(Te,we){for(var je=0,Ne=0,Pe=Q?new Uint16Array(32768):[];Ne<Te.length;){var ze=Math.min(65535,Te.length-Ne);if(ze<10){for(je=oe(we,je,+(Ne+ze==Te.length)),je&7&&(je+=8-(je&7)),we.l=je/8|0,we.write_shift(2,ze),we.write_shift(2,~ze&65535);ze-- >0;)we[we.l++]=Te[Ne++];je=we.l*8;continue}je=oe(we,je,+(Ne+ze==Te.length)+2);for(var Ve=0;ze-- >0;){var Ue=Te[Ne];Ve=(Ve<<5^Ue)&32767;var qe=-1,mt=0;if((qe=Pe[Ve])&&(qe|=Ne&-32768,qe>Ne&&(qe-=32768),qe<Ne))for(;Te[qe+mt]==Te[Ne+mt]&&mt<250;)++mt;if(mt>2){Ue=me[mt],Ue<=22?je=le(we,je,ne[Ue+1]>>1)-1:(le(we,je,3),je+=5,le(we,je,ne[Ue-23]>>5),je+=3);var pr=Ue<8?0:Ue-4>>2;pr>0&&(he(we,je,mt-Z[Ue]),je+=pr),Ue=fe[Ne-qe],je=le(we,je,ne[Ue]>>3),je-=3;var xr=Ue<4?0:Ue-2>>1;xr>0&&(he(we,je,Ne-qe-ce[Ue]),je+=xr);for(var wn=0;wn<mt;++wn)Pe[Ve]=Ne&32767,Ve=(Ve<<5^Te[Ne])&32767,++Ne;ze-=mt-1}else Ue<=143?Ue=Ue+48:je=J(we,je,1),je=le(we,je,ne[Ue]),Pe[Ve]=Ne&32767,++Ne}je=le(we,je,0)-1}return we.l=(je+7)/8|0,we.l}return function(we,je){return we.length<8?ve(we,je):_e(we,je)}}();function Fe(Y){var fe=Se(50+Math.floor(Y.length*1.1)),ue=Ze(Y,fe);return fe.slice(0,ue)}var He=Q?new Uint16Array(32768):ae(32768),rt=Q?new Uint16Array(32768):ae(32768),Je=Q?new Uint16Array(128):ae(128),Gt=1,ma=1;function yn(Y,fe){var ue=te(Y,fe)+257;fe+=5;var de=te(Y,fe)+1;fe+=5;var me=se(Y,fe)+4;fe+=4;for(var ve=0,_e=Q?new Uint8Array(19):ae(19),Te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],we=1,je=Q?new Uint8Array(8):ae(8),Ne=Q?new Uint8Array(8):ae(8),Pe=_e.length,ze=0;ze<me;++ze)_e[V[ze]]=ve=U(Y,fe),we<ve&&(we=ve),je[ve]++,fe+=3;var Ve=0;for(je[0]=0,ze=1;ze<=we;++ze)Ne[ze]=Ve=Ve+je[ze-1]<<1;for(ze=0;ze<Pe;++ze)(Ve=_e[ze])!=0&&(Te[ze]=Ne[Ve]++);var Ue=0;for(ze=0;ze<Pe;++ze)if(Ue=_e[ze],Ue!=0){Ve=ne[Te[ze]]>>8-Ue;for(var qe=(1<<7-Ue)-1;qe>=0;--qe)Je[Ve|qe<<Ue]=Ue&7|ze<<3}var mt=[];for(we=1;mt.length<ue+de;)switch(Ve=Je[K(Y,fe)],fe+=Ve&7,Ve>>>=3){case 16:for(ve=3+re(Y,fe),fe+=2,Ve=mt[mt.length-1];ve-- >0;)mt.push(Ve);break;case 17:for(ve=3+U(Y,fe),fe+=3;ve-- >0;)mt.push(0);break;case 18:for(ve=11+K(Y,fe),fe+=7;ve-- >0;)mt.push(0);break;default:mt.push(Ve),we<Ve&&(we=Ve);break}var pr=mt.slice(0,ue),xr=mt.slice(ue);for(ze=ue;ze<286;++ze)pr[ze]=0;for(ze=de;ze<30;++ze)xr[ze]=0;return Gt=xe(pr,He,286),ma=xe(xr,rt,30),fe}function Qe(Y,fe){if(Y[0]==3&&!(Y[1]&3))return[fo(fe),2];for(var ue=0,de=0,me=OA(fe||1<<18),ve=0,_e=me.length>>>0,Te=0,we=0;!(de&1);){if(de=U(Y,ue),ue+=3,de>>>1)de>>1==1?(Te=9,we=5):(ue=yn(Y,ue),Te=Gt,we=ma);else{ue&7&&(ue+=8-(ue&7));var je=Y[ue>>>3]|Y[(ue>>>3)+1]<<8;if(ue+=32,je>0)for(!fe&&_e<ve+je&&(me=ee(me,ve+je),_e=me.length);je-- >0;)me[ve++]=Y[ue>>>3],ue+=8;continue}for(;;){!fe&&_e<ve+32767&&(me=ee(me,ve+32767),_e=me.length);var Ne=H(Y,ue,Te),Pe=de>>>1==1?ye[Ne]:He[Ne];if(ue+=Pe&15,Pe>>>=4,!(Pe>>>8&255))me[ve++]=Pe;else{if(Pe==256)break;Pe-=257;var ze=Pe<8?0:Pe-4>>2;ze>5&&(ze=0);var Ve=ve+Z[Pe];ze>0&&(Ve+=H(Y,ue,ze),ue+=ze),Ne=H(Y,ue,we),Pe=de>>>1==1?Ce[Ne]:rt[Ne],ue+=Pe&15,Pe>>>=4;var Ue=Pe<4?0:Pe-2>>1,qe=ce[Pe];for(Ue>0&&(qe+=H(Y,ue,Ue),ue+=Ue),!fe&&_e<Ve&&(me=ee(me,Ve+100),_e=me.length);ve<Ve;)me[ve]=me[ve-qe],++ve}}}return fe?[me,ue+7>>>3]:[me.slice(0,ve),ue+7>>>3]}function vt(Y,fe){var ue=Y.slice(Y.l||0),de=Qe(ue,fe);return Y.l+=de[1],de[0]}function At(Y,fe){if(Y)typeof console<"u"&&console.error(fe);else throw new Error(fe)}function bt(Y,fe){var ue=Y;hn(ue,0);var de=[],me=[],ve={FileIndex:de,FullPaths:me};N(ve,{root:fe.root});for(var _e=ue.length-4;(ue[_e]!=80||ue[_e+1]!=75||ue[_e+2]!=5||ue[_e+3]!=6)&&_e>=0;)--_e;ue.l=_e+4,ue.l+=4;var Te=ue.read_shift(2);ue.l+=6;var we=ue.read_shift(4);for(ue.l=we,_e=0;_e<Te;++_e){ue.l+=20;var je=ue.read_shift(4),Ne=ue.read_shift(4),Pe=ue.read_shift(2),ze=ue.read_shift(2),Ve=ue.read_shift(2);ue.l+=8;var Ue=ue.read_shift(4),qe=c(ue.slice(ue.l+Pe,ue.l+Pe+ze));ue.l+=Pe+ze+Ve;var mt=ue.l;ue.l=Ue+4,Yn(ue,je,Ne,ve,qe),ue.l=mt}return ve}function Yn(Y,fe,ue,de,me){Y.l+=2;var ve=Y.read_shift(2),_e=Y.read_shift(2),Te=o(Y);if(ve&8257)throw new Error("Unsupported ZIP encryption");for(var we=Y.read_shift(4),je=Y.read_shift(4),Ne=Y.read_shift(4),Pe=Y.read_shift(2),ze=Y.read_shift(2),Ve="",Ue=0;Ue<Pe;++Ue)Ve+=String.fromCharCode(Y[Y.l++]);if(ze){var qe=c(Y.slice(Y.l,Y.l+ze));(qe[21589]||{}).mt&&(Te=qe[21589].mt),((me||{})[21589]||{}).mt&&(Te=me[21589].mt)}Y.l+=ze;var mt=Y.slice(Y.l,Y.l+je);switch(_e){case 8:mt=k(Y,Ne);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+_e)}var pr=!1;ve&8&&(we=Y.read_shift(4),we==134695760&&(we=Y.read_shift(4),pr=!0),je=Y.read_shift(4),Ne=Y.read_shift(4)),je!=fe&&At(pr,"Bad compressed size: "+fe+" != "+je),Ne!=ue&&At(pr,"Bad uncompressed size: "+ue+" != "+Ne),Me(de,Ve,mt,{unsafe:!0,mt:Te})}function ln(Y,fe){var ue=fe||{},de=[],me=[],ve=Se(1),_e=ue.compression?8:0,Te=0,we=0,je=0,Ne=0,Pe=0,ze=Y.FullPaths[0],Ve=ze,Ue=Y.FileIndex[0],qe=[],mt=0;for(we=1;we<Y.FullPaths.length;++we)if(Ve=Y.FullPaths[we].slice(ze.length),Ue=Y.FileIndex[we],!(!Ue.size||!Ue.content||Ve=="Sh33tJ5")){var pr=Ne,xr=Se(Ve.length);for(je=0;je<Ve.length;++je)xr.write_shift(1,Ve.charCodeAt(je)&127);xr=xr.slice(0,xr.l),qe[Pe]=vNe.buf(Ue.content,0);var wn=Ue.content;_e==8&&(wn=z(wn)),ve=Se(30),ve.write_shift(4,67324752),ve.write_shift(2,20),ve.write_shift(2,Te),ve.write_shift(2,_e),Ue.mt?i(ve,Ue.mt):ve.write_shift(4,0),ve.write_shift(-4,qe[Pe]),ve.write_shift(4,wn.length),ve.write_shift(4,Ue.content.length),ve.write_shift(2,xr.length),ve.write_shift(2,0),Ne+=ve.length,de.push(ve),Ne+=xr.length,de.push(xr),Ne+=wn.length,de.push(wn),ve=Se(46),ve.write_shift(4,33639248),ve.write_shift(2,0),ve.write_shift(2,20),ve.write_shift(2,Te),ve.write_shift(2,_e),ve.write_shift(4,0),ve.write_shift(-4,qe[Pe]),ve.write_shift(4,wn.length),ve.write_shift(4,Ue.content.length),ve.write_shift(2,xr.length),ve.write_shift(2,0),ve.write_shift(2,0),ve.write_shift(2,0),ve.write_shift(2,0),ve.write_shift(4,0),ve.write_shift(4,pr),mt+=ve.l,me.push(ve),mt+=xr.length,me.push(xr),++Pe}return ve=Se(22),ve.write_shift(4,101010256),ve.write_shift(2,0),ve.write_shift(2,0),ve.write_shift(2,Pe),ve.write_shift(2,Pe),ve.write_shift(4,mt),ve.write_shift(4,Ne),ve.write_shift(2,0),Qr([Qr(de),Qr(me),ve])}var bn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Oo(Y,fe){if(Y.ctype)return Y.ctype;var ue=Y.name||"",de=ue.match(/\.([^\.]+)$/);return de&&bn[de[1]]||fe&&(de=(ue=fe).match(/[\.\\]([^\.\\])+$/),de&&bn[de[1]])?bn[de[1]]:"application/octet-stream"}function $u(Y){for(var fe=Af(Y),ue=[],de=0;de<fe.length;de+=76)ue.push(fe.slice(de,de+76));return ue.join(`\r
`)+`\r
`}function Po(Y){var fe=Y.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(je){var Ne=je.charCodeAt(0).toString(16).toUpperCase();return"="+(Ne.length==1?"0"+Ne:Ne)});fe=fe.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),fe.charAt(0)==`
`&&(fe="=0D"+fe.slice(1)),fe=fe.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ue=[],de=fe.split(`\r
`),me=0;me<de.length;++me){var ve=de[me];if(ve.length==0){ue.push("");continue}for(var _e=0;_e<ve.length;){var Te=76,we=ve.slice(_e,_e+Te);we.charAt(Te-1)=="="?Te--:we.charAt(Te-2)=="="?Te-=2:we.charAt(Te-3)=="="&&(Te-=3),we=ve.slice(_e,_e+Te),_e+=Te,_e<ve.length&&(we+="="),ue.push(we)}}return ue.join(`\r
`)}function Io(Y){for(var fe=[],ue=0;ue<Y.length;++ue){for(var de=Y[ue];ue<=Y.length&&de.charAt(de.length-1)=="=";)de=de.slice(0,de.length-1)+Y[++ue];fe.push(de)}for(var me=0;me<fe.length;++me)fe[me]=fe[me].replace(/[=][0-9A-Fa-f]{2}/g,function(ve){return String.fromCharCode(parseInt(ve.slice(1),16))});return wa(fe.join(`\r
`))}function Gh(Y,fe,ue){for(var de="",me="",ve="",_e,Te=0;Te<10;++Te){var we=fe[Te];if(!we||we.match(/^\s*$/))break;var je=we.match(/^(.*?):\s*([^\s].*)$/);if(je)switch(je[1].toLowerCase()){case"content-location":de=je[2].trim();break;case"content-type":ve=je[2].trim();break;case"content-transfer-encoding":me=je[2].trim();break}}switch(++Te,me.toLowerCase()){case"base64":_e=wa(Aa(fe.slice(Te).join("")));break;case"quoted-printable":_e=Io(fe.slice(Te));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+me)}var Ne=Me(Y,de.slice(ue.length),_e,{unsafe:!0});ve&&(Ne.ctype=ve)}function Xh(Y,fe){if(F(Y.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ue=fe&&fe.root||"",de=(_t&&Buffer.isBuffer(Y)?Y.toString("binary"):F(Y)).split(`\r
`),me=0,ve="";for(me=0;me<de.length;++me)if(ve=de[me],!!/^Content-Location:/i.test(ve)&&(ve=ve.slice(ve.indexOf("file")),ue||(ue=ve.slice(0,ve.lastIndexOf("/")+1)),ve.slice(0,ue.length)!=ue))for(;ue.length>0&&(ue=ue.slice(0,ue.length-1),ue=ue.slice(0,ue.lastIndexOf("/")+1),ve.slice(0,ue.length)!=ue););var _e=(de[1]||"").match(/boundary="(.*?)"/);if(!_e)throw new Error("MAD cannot find boundary");var Te="--"+(_e[1]||""),we=[],je=[],Ne={FileIndex:we,FullPaths:je};N(Ne);var Pe,ze=0;for(me=0;me<de.length;++me){var Ve=de[me];Ve!==Te&&Ve!==Te+"--"||(ze++&&Gh(Ne,de.slice(Pe,me),ue),Pe=me)}return Ne}function Oe(Y,fe){var ue=fe||{},de=ue.boundary||"SheetJS";de="------="+de;for(var me=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+de.slice(2)+'"',"","",""],ve=Y.FullPaths[0],_e=ve,Te=Y.FileIndex[0],we=1;we<Y.FullPaths.length;++we)if(_e=Y.FullPaths[we].slice(ve.length),Te=Y.FileIndex[we],!(!Te.size||!Te.content||_e=="Sh33tJ5")){_e=_e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(mt){return"_x"+mt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(mt){return"_u"+mt.charCodeAt(0).toString(16)+"_"});for(var je=Te.content,Ne=_t&&Buffer.isBuffer(je)?je.toString("binary"):F(je),Pe=0,ze=Math.min(1024,Ne.length),Ve=0,Ue=0;Ue<=ze;++Ue)(Ve=Ne.charCodeAt(Ue))>=32&&Ve<128&&++Pe;var qe=Pe>=ze*4/5;me.push(de),me.push("Content-Location: "+(ue.root||"file:///C:/SheetJS/")+_e),me.push("Content-Transfer-Encoding: "+(qe?"quoted-printable":"base64")),me.push("Content-Type: "+Oo(Te,_e)),me.push(""),me.push(qe?Po(Ne):$u(Ne))}return me.push(de+`--\r
`),me.join(`\r
`)}function Ge(Y){var fe={};return N(fe,Y),fe}function Me(Y,fe,ue,de){var me=de&&de.unsafe;me||N(Y);var ve=!me&&et.find(Y,fe);if(!ve){var _e=Y.FullPaths[0];fe.slice(0,_e.length)==_e?_e=fe:(_e.slice(-1)!="/"&&(_e+="/"),_e=(_e+fe).replace("//","/")),ve={name:a(fe),type:2},Y.FileIndex.push(ve),Y.FullPaths.push(_e),me||et.utils.cfb_gc(Y)}return ve.content=ue,ve.size=ue?ue.length:0,de&&(de.CLSID&&(ve.clsid=de.CLSID),de.mt&&(ve.mt=de.mt),de.ct&&(ve.ct=de.ct)),ve}function ht(Y,fe){N(Y);var ue=et.find(Y,fe);if(ue){for(var de=0;de<Y.FileIndex.length;++de)if(Y.FileIndex[de]==ue)return Y.FileIndex.splice(de,1),Y.FullPaths.splice(de,1),!0}return!1}function ar(Y,fe,ue){N(Y);var de=et.find(Y,fe);if(de){for(var me=0;me<Y.FileIndex.length;++me)if(Y.FileIndex[me]==de)return Y.FileIndex[me].name=a(ue),Y.FullPaths[me]=ue,!0}return!1}function rs(Y){S(Y,!0)}return t.find=A,t.read=j,t.parse=d,t.write=I,t.writeFile=O,t.utils={cfb_new:Ge,cfb_add:Me,cfb_del:ht,cfb_mov:ar,cfb_gc:rs,ReadShift:Ad,CheckField:zI,prep_blob:hn,bconcat:Qr,use_zlib:C,_deflateRaw:Fe,_inflateRaw:vt,consts:B},t}();let eo;function yNe(e){eo=e}function bNe(e){return typeof e=="string"?Ch(e):Array.isArray(e)?Hje(e):e}function kh(e,t,r){if(typeof eo<"u"&&eo.writeFileSync)return r?eo.writeFileSync(e,t,r):eo.writeFileSync(e,t);if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Ch(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Wi(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([bNe(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(e);return c.open("w"),c.encoding="binary",Array.isArray(t)&&(t=Do(t)),c.write(t),c.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function wNe(e){if(typeof eo<"u")return eo.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Er(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function $A(e,t){for(var r=[],n=Er(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function hg(e){for(var t=[],r=Er(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function mg(e){for(var t=[],r=Er(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function _Ne(e){for(var t=[],r=Er(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var xx=new Date(1899,11,30,0,0,0);function Vr(e,t){var r=e.getTime(),n=xx.getTime()+(e.getTimezoneOffset()-xx.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var SI=new Date,jNe=xx.getTime()+(SI.getTimezoneOffset()-xx.getTimezoneOffset())*6e4,WA=SI.getTimezoneOffset();function pg(e){var t=new Date;return t.setTime(e*24*60*60*1e3+jNe),t.getTimezoneOffset()!==WA&&t.setTime(t.getTime()+(t.getTimezoneOffset()-WA)*6e4),t}function NNe(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var zA=new Date("2017-02-19T19:06:09.000Z"),EI=isNaN(zA.getFullYear())?new Date("2/19/17"):zA,DNe=EI.getFullYear()==2017;function ur(e,t){var r=new Date(e);if(DNe)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(EI.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function gc(e,t){if(_t&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Wi(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Wi(hI(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Wi(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Wi(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Zt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Zt(e[r]));return t}function wr(e,t){for(var r="";r.length<t;)r+=e;return r}function _i(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var SNe=["january","february","march","april","may","june","july","august","september","october","november","december"];function Jl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&SNe.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var ENe=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),o=[i[0]],c=1;c<i.length;++c)o.push(a),o.push(i[c]);return o}}();function TI(e){return e?e.content&&e.type?gc(e.content,!0):e.data?cl(e.data):e.asNodeBuffer&&_t?cl(e.asNodeBuffer().toString("binary")):e.asBinary?cl(e.asBinary()):e._data&&e._data.getContent?cl(gc(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function CI(e){if(!e)return null;if(e.data)return fx(e.data);if(e.asNodeBuffer&&_t)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?fx(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function TNe(e){return e&&e.name.slice(-4)===".bin"?CI(e):TI(e)}function qa(e,t){for(var r=e.FullPaths||Er(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function G_(e,t){var r=qa(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Ur(e,t,r){if(!r)return TNe(G_(e,t));if(!t)return null;try{return Ur(e,t)}catch{return null}}function _a(e,t,r){if(!r)return TI(G_(e,t));if(!t)return null;try{return _a(e,t)}catch{return null}}function CNe(e,t,r){return CI(G_(e,t))}function qA(e){for(var t=e.FullPaths||Er(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function yt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return _t?n=Us(r):n=Vje(r),et.utils.cfb_add(e,t,n)}et.utils.cfb_add(e,t,r)}else e.file(t,r)}function X_(){return et.utils.cfb_new()}function AI(e,t){switch(t.type){case"base64":return et.read(e,{type:"base64"});case"binary":return et.read(e,{type:"binary"});case"buffer":case"array":return et.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function yd(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Fr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,ANe=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,HA=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,kNe=/<[^>]*>/g,Rn=Fr.match(HA)?HA:kNe,FNe=/<\w*:/,ONe=/<(\/?)\w+:/;function lt(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var o=e.match(ANe),c=0,l="",u=0,d="",f="",h=1;if(o)for(u=0;u!=o.length;++u){for(f=o[u],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(d=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(h=(a=f.charCodeAt(i+1))==34||a==39?1:0,l=f.slice(i+1+h,f.length-h),c=0;c!=d.length&&d.charCodeAt(c)!==58;++c);if(c===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=l,n[d.toLowerCase()]=l;else{var m=(c===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(c+1);if(n[m]&&d.slice(c-3,c)=="ext")continue;n[m]=l,n[m.toLowerCase()]=l}}return n}function Qi(e){return e.replace(ONe,"<$1")}var kI={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},K_=hg(kI),Ot=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(c,l){return kI[c]||String.fromCharCode(parseInt(l,c.indexOf("x")>-1?16:10))||c}).replace(t,function(c,l){return String.fromCharCode(parseInt(l,16))});var o=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,o)+r(a.slice(o+3))}}(),Y_=/[&<>'"]/g,PNe=/[\u0000-\u0008\u000b-\u001f]/g;function zt(e){var t=e+"";return t.replace(Y_,function(r){return K_[r]}).replace(PNe,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function VA(e){return zt(e).replace(/ /g,"_x0020_")}var FI=/[\u0000-\u001f]/g;function Z_(e){var t=e+"";return t.replace(Y_,function(r){return K_[r]}).replace(/\n/g,"<br/>").replace(FI,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function INe(e){var t=e+"";return t.replace(Y_,function(r){return K_[r]}).replace(FI,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var GA=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function UNe(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function cr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function iy(e){for(var t="",r=0,n=0,a=0,i=0,o=0,c=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}o=e.charCodeAt(r++),c=((n&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function XA(e){var t=fo(2*e.length),r,n,a=1,i=0,o=0,c;for(n=0;n<e.length;n+=a)a=1,(c=e.charCodeAt(n))<128?r=c:c<224?(r=(c&31)*64+(e.charCodeAt(n+1)&63),a=2):c<240?(r=(c&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(c&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function KA(e){return Us(e,"binary").toString("utf8")}var xm="foo bar baz",Kt=_t&&(KA(xm)==iy(xm)&&KA||XA(xm)==iy(xm)&&XA)||iy,Wi=_t?function(e){return Us(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Ff=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),OI=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),RNe=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),MNe=/<\/?(?:vt:)?variant>/g,BNe=/<(?:vt:)([^>]*)>([\s\S]*)</;function YA(e,t){var r=lt(e),n=e.match(RNe(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var o=i.replace(MNe,"").match(BNe);o&&a.push({v:Kt(o[2]),t:o[1]})}),a}var PI=/(^\s|\s$|\n)/;function mn(e,t){return"<"+e+(t.match(PI)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Of(e){return Er(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Le(e,t,r){return"<"+e+(r!=null?Of(r):"")+(t!=null?(t.match(PI)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function T2(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function LNe(e,t){switch(typeof e){case"string":var r=Le("vt:lpwstr",zt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Le((e|0)==e?"vt:i4":"vt:r8",zt(String(e)));case"boolean":return Le("vt:bool",e?"true":"false")}if(e instanceof Date)return Le("vt:filetime",T2(e));throw new Error("Unable to serialize "+e)}function J_(e){if(_t&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Kt(Do(q_(e)));throw new Error("Bad input format: expected Buffer or string")}var Pf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,qr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},kc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ya={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function $Ne(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function WNe(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,o=n?-t:t;isFinite(o)?o==0?a=i=0:(a=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var c=0;c<=5;++c,i/=256)e[r+c]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var ZA=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},JA=_t?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Us(t)})):ZA(e)}:ZA,QA=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(xs(e,a)));return n.join("").replace(On,"")},xg=_t?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(On,""):QA(e,t,r)}:QA,ek=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},II=_t?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):ek(e,t,r)}:ek,tk=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(rl(e,a)));return n.join("")},Ou=_t?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):tk(t,r,n)}:tk,UI=function(e,t){var r=Jr(e,t);return r>0?Ou(e,t+4,t+4+r-1):""},Q_=UI,RI=function(e,t){var r=Jr(e,t);return r>0?Ou(e,t+4,t+4+r-1):""},ej=RI,MI=function(e,t){var r=2*Jr(e,t);return r>0?Ou(e,t+4,t+4+r-1):""},tj=MI,BI=function(t,r){var n=Jr(t,r);return n>0?xg(t,r+4,r+4+n):""},rj=BI,LI=function(e,t){var r=Jr(e,t);return r>0?Ou(e,t+4,t+4+r):""},nj=LI,$I=function(e,t){return $Ne(e,t)},gx=$I,aj=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};_t&&(Q_=function(t,r){if(!Buffer.isBuffer(t))return UI(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},ej=function(t,r){if(!Buffer.isBuffer(t))return RI(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},tj=function(t,r){if(!Buffer.isBuffer(t))return MI(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},rj=function(t,r){if(!Buffer.isBuffer(t))return BI(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},nj=function(t,r){if(!Buffer.isBuffer(t))return LI(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},gx=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):$I(t,r)},aj=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});function WI(){xg=function(e,t,r){return Ct.utils.decode(1200,e.slice(t,r)).replace(On,"")},Ou=function(e,t,r){return Ct.utils.decode(65001,e.slice(t,r))},Q_=function(e,t){var r=Jr(e,t);return r>0?Ct.utils.decode(pc,e.slice(t+4,t+4+r-1)):""},ej=function(e,t){var r=Jr(e,t);return r>0?Ct.utils.decode(Ca,e.slice(t+4,t+4+r-1)):""},tj=function(e,t){var r=2*Jr(e,t);return r>0?Ct.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},rj=function(e,t){var r=Jr(e,t);return r>0?Ct.utils.decode(1200,e.slice(t+4,t+4+r)):""},nj=function(e,t){var r=Jr(e,t);return r>0?Ct.utils.decode(65001,e.slice(t+4,t+4+r)):""}}typeof Ct<"u"&&WI();var rl=function(e,t){return e[t]},xs=function(e,t){return e[t+1]*256+e[t]},zNe=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Jr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Yo=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},qNe=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ad(e,t){var r="",n,a,i=[],o,c,l,u;switch(t){case"dbcs":if(u=this.l,_t&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(xs(this,u)),u+=2;e*=2;break;case"utf8":r=Ou(this,this.l,this.l+e);break;case"utf16le":e*=2,r=xg(this,this.l,this.l+e);break;case"wstr":if(typeof Ct<"u")r=Ct.utils.decode(Ca,this.slice(this.l,this.l+2*e));else return Ad.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":r=Q_(this,this.l),e=4+Jr(this,this.l);break;case"lpstr-cp":r=ej(this,this.l),e=4+Jr(this,this.l);break;case"lpwstr":r=tj(this,this.l),e=4+2*Jr(this,this.l);break;case"lpp4":e=4+Jr(this,this.l),r=rj(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Jr(this,this.l),r=nj(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=rl(this,this.l+e++))!==0;)i.push(gd(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=xs(this,this.l+e))!==0;)i.push(gd(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=rl(this,u),this.l=u+1,c=Ad.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(gd(xs(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":if(typeof Ct<"u"){r=Ct.utils.decode(Ca,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(r="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=rl(this,u),this.l=u+1,c=Ad.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(gd(rl(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return n=rl(this,this.l),this.l++,n;case 2:return n=(t==="i"?zNe:xs)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Yo:qNe)(this,this.l),this.l+=4,n):(a=Jr(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=gx(this,this.l):a=gx([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=II(this,this.l,e);break}}return this.l+=e,r}var HNe=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},VNe=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},GNe=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function XNe(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)GNe(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){if(typeof Ct<"u"&&pc==874)for(a=0;a!=t.length;++a){var i=Ct.utils.encode(pc,t.charAt(a));this[this.l+a]=i[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var c=t.charCodeAt(a);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,HNe(this,t,this.l);break;case 8:if(n=8,r==="f"){WNe(this,t,this.l);break}case 16:break;case-4:n=4,VNe(this,t,this.l);break}return this.l+=n,this}function zI(e,t){var r=II(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function hn(e,t){e.l=t,e.read_shift=Ad,e.chk=zI,e.write_shift=XNe}function In(e,t){e.l+=t}function Se(e){var t=fo(e);return hn(t,0),t}function Rs(e,t,r){if(e){var n,a,i;hn(e,e.l||0);for(var o=e.length,c=0,l=0;e.l<o;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var u=Lf[c]||Lf[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;l=e.l+i;var d=u.f&&u.f(e,i,r);if(e.l=l,t(d,u,c))return}}}function oa(){var e=[],t=_t?256:2048,r=function(u){var d=Se(u);return hn(d,0),d},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},o=function(){return a(),Qr(e)},c=function(u){a(),n=u,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:c,end:o,_bufs:e}}function Ae(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=Lf[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var o=e.next(i);a<=127?o.write_shift(1,a):(o.write_shift(1,(a&127)+128),o.write_shift(1,a>>7));for(var c=0;c!=4;++c)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&aj(r)&&e.push(r)}}function kd(e,t,r){var n=Zt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function rk(e,t,r){var n=Zt(e);return n.s=kd(n.s,t.s,r),n.e=kd(n.e,t.s,r),n}function Fd(e,t){if(e.cRel&&e.c<0)for(e=Zt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Zt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ot(e);return!e.cRel&&e.cRel!=null&&(r=ZNe(r)),!e.rRel&&e.rRel!=null&&(r=KNe(r)),r}function sy(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+lr(e.s.c)+":"+(e.e.cRel?"":"$")+lr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Nr(e.s.r)+":"+(e.e.rRel?"":"$")+Nr(e.e.r):Fd(e.s,t.biff)+":"+Fd(e.e,t.biff)}function ij(e){return parseInt(YNe(e),10)-1}function Nr(e){return""+(e+1)}function KNe(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function YNe(e){return e.replace(/\$(\d+)$/,"$1")}function sj(e){for(var t=JNe(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function lr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function ZNe(e){return e.replace(/^([A-Z])/,"$$$1")}function JNe(e){return e.replace(/^\$([A-Z])/,"$1")}function QNe(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function yr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function ot(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Gn(e){var t=e.indexOf(":");return t==-1?{s:yr(e),e:yr(e)}:{s:yr(e.slice(0,t)),e:yr(e.slice(t+1))}}function xt(e,t){return typeof t>"u"||typeof t=="number"?xt(e.s,e.e):(typeof e!="string"&&(e=ot(e)),typeof t!="string"&&(t=ot(t)),e==t?e:e+":"+t)}function Dt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function nk(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ka(e.z,r?Vr(t):t)}catch{}try{return e.w=ka((e.XF||{}).numFmtId||(r?14:0),r?Vr(t):t)}catch{return""+t}}function Yi(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ms[e.v]||e.v:t==null?nk(e,e.v):nk(e,t))}function So(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function qI(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),o=0,c=0;if(i&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?yr(n.origin):n.origin;o=l.r,c=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=Dt(i["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var m={v:t[f][h]},x=o+f,p=c+h;if(u.s.r>x&&(u.s.r=x),u.s.c>p&&(u.s.c=p),u.e.r<x&&(u.e.r=x),u.e.c<p&&(u.e.c=p),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))m=t[f][h];else if(Array.isArray(m.v)&&(m.f=t[f][h][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||at[14],n.cellDates?(m.t="d",m.w=ka(m.z,Vr(m.v))):(m.t="n",m.v=Vr(m.v),m.w=ka(m.z,m.v))):m.t="s";if(a)i[x]||(i[x]=[]),i[x][p]&&i[x][p].z&&(m.z=i[x][p].z),i[x][p]=m;else{var g=ot({c:p,r:x});i[g]&&i[g].z&&(m.z=i[g].z),i[g]=m}}}return u.s.c<1e7&&(i["!ref"]=xt(u)),i}function Pu(e,t){return qI(null,e,t)}function eDe(e){return e.read_shift(4,"i")}function ji(e,t){return t||(t=Se(4)),t.write_shift(4,e),t}function Pn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function en(e,t){var r=!1;return t==null&&(r=!0,t=Se(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function tDe(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function rDe(e,t){return t||(t=Se(4)),t.write_shift(2,0),t.write_shift(2,0),t}function oj(e,t){var r=e.l,n=e.read_shift(1),a=Pn(e),i=[],o={t:a,h:a};if(n&1){for(var c=e.read_shift(4),l=0;l!=c;++l)i.push(tDe(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function nDe(e,t){var r=!1;return t==null&&(r=!0,t=Se(15+4*e.t.length)),t.write_shift(1,0),en(e.t,t),r?t.slice(0,t.l):t}var aDe=oj;function iDe(e,t){var r=!1;return t==null&&(r=!0,t=Se(23+4*e.t.length)),t.write_shift(1,1),en(e.t,t),t.write_shift(4,1),rDe({},t),r?t.slice(0,t.l):t}function li(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Fc(e,t){return t==null&&(t=Se(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Oc(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Pc(e,t){return t==null&&(t=Se(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var sDe=Pn,HI=en;function cj(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function vx(e,t){var r=!1;return t==null&&(r=!0,t=Se(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var oDe=Pn,C2=cj,lj=vx;function uj(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?gx([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Yo(t,0)>>2;return r?a/100:a}function VI(e,t){t==null&&(t=Se(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function GI(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function cDe(e,t){return t||(t=Se(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Ic=GI,Iu=cDe;function kn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function vc(e,t){return(t||Se(8)).write_shift(8,e,"f")}function lDe(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),c=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=ic[a];u&&(t.rgb=Uf(u));break;case 2:t.rgb=Uf([o,c,l]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function yx(e,t){if(t||(t=Se(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function uDe(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function dDe(e,t){t||(t=Se(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function XI(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function fDe(e){return XI(e,1)}function hDe(e){return XI(e,2)}var dj=2,Qn=3,gm=11,ak=12,bx=19,vm=64,mDe=65,pDe=71,xDe=4108,gDe=4126,Yr=80,KI=81,vDe=[Yr,KI],A2={1:{n:"CodePage",t:dj},2:{n:"Category",t:Yr},3:{n:"PresentationFormat",t:Yr},4:{n:"ByteCount",t:Qn},5:{n:"LineCount",t:Qn},6:{n:"ParagraphCount",t:Qn},7:{n:"SlideCount",t:Qn},8:{n:"NoteCount",t:Qn},9:{n:"HiddenCount",t:Qn},10:{n:"MultimediaClipCount",t:Qn},11:{n:"ScaleCrop",t:gm},12:{n:"HeadingPairs",t:xDe},13:{n:"TitlesOfParts",t:gDe},14:{n:"Manager",t:Yr},15:{n:"Company",t:Yr},16:{n:"LinksUpToDate",t:gm},17:{n:"CharacterCount",t:Qn},19:{n:"SharedDoc",t:gm},22:{n:"HyperlinksChanged",t:gm},23:{n:"AppVersion",t:Qn,p:"version"},24:{n:"DigSig",t:mDe},26:{n:"ContentType",t:Yr},27:{n:"ContentStatus",t:Yr},28:{n:"Language",t:Yr},29:{n:"Version",t:Yr},255:{},2147483648:{n:"Locale",t:bx},2147483651:{n:"Behavior",t:bx},1919054434:{}},k2={1:{n:"CodePage",t:dj},2:{n:"Title",t:Yr},3:{n:"Subject",t:Yr},4:{n:"Author",t:Yr},5:{n:"Keywords",t:Yr},6:{n:"Comments",t:Yr},7:{n:"Template",t:Yr},8:{n:"LastAuthor",t:Yr},9:{n:"RevNumber",t:Yr},10:{n:"EditTime",t:vm},11:{n:"LastPrinted",t:vm},12:{n:"CreatedDate",t:vm},13:{n:"ModifiedDate",t:vm},14:{n:"PageCount",t:Qn},15:{n:"WordCount",t:Qn},16:{n:"CharCount",t:Qn},17:{n:"Thumbnail",t:pDe},18:{n:"Application",t:Yr},19:{n:"DocSecurity",t:Qn},255:{},2147483648:{n:"Locale",t:bx},2147483651:{n:"Behavior",t:bx},1919054434:{}},ik={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},yDe=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function bDe(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var wDe=bDe([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ic=Zt(wDe),Ms={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},YI={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},F2={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ym={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function fj(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function _De(e){var t=fj();if(!e||!e.match)return t;var r={};if((e.match(Rn)||[]).forEach(function(n){var a=lt(n);switch(a[0].replace(FNe,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[F2[a.ContentType]]!==void 0&&t[F2[a.ContentType]].push(a.PartName);break}}),t.xmlns!==qr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function ZI(e,t){var r=_Ne(F2),n=[],a;n[n.length]=Fr,n[n.length]=Le("Types",null,{xmlns:qr.CT,"xmlns:xsd":qr.xsd,"xmlns:xsi":qr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Le("Default",null,{Extension:l[0],ContentType:l[1]})}));var i=function(l){e[l]&&e[l].length>0&&(a=e[l][0],n[n.length]=Le("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:ym[l][t.bookType]||ym[l].xlsx}))},o=function(l){(e[l]||[]).forEach(function(u){n[n.length]=Le("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:ym[l][t.bookType]||ym[l].xlsx})})},c=function(l){(e[l]||[]).forEach(function(u){n[n.length]=Le("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return i("workbooks"),o("sheets"),o("charts"),c("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),o("metadata"),c("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var jt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function If(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Od(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Rn)||[]).forEach(function(a){var i=lt(a);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var c=i.TargetMode==="External"?i.Target:yd(i.Target,t);r[c]=o,n[i.Id]=o}}),r["!id"]=n,r}function vl(e){var t=[Fr,Le("Relationships",null,{xmlns:qr.RELS})];return Er(e["!id"]).forEach(function(r){t[t.length]=Le("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function $t(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[jt.HLINK,jt.XPATH,jt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var jDe="application/vnd.oasis.opendocument.spreadsheet";function NDe(e,t){for(var r=J_(e),n,a;n=Pf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=lt(n[0],!1),a.path=="/"&&a.type!==jDe)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function DDe(e){var t=[Fr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function sk(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function SDe(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function EDe(e){var t=[Fr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(sk(e[r][0],e[r][1])),t.push(SDe("",e[r][0]));return t.push(sk("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function JI(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Cf.version+"</meta:generator></office:meta></office:document-meta>"}var ri=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],TDe=function(){for(var e=new Array(ri.length),t=0;t<ri.length;++t){var r=ri[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function QI(e){var t={};e=Kt(e);for(var r=0;r<ri.length;++r){var n=ri[r],a=e.match(TDe[r]);a!=null&&a.length>0&&(t[n[1]]=Ot(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=ur(t[n[1]]))}return t}function oy(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=zt(t),n[n.length]=r?Le(e,t,r):mn(e,t))}function eU(e,t){var r=t||{},n=[Fr,Le("cp:coreProperties",null,{"xmlns:cp":qr.CORE_PROPS,"xmlns:dc":qr.dc,"xmlns:dcterms":qr.dcterms,"xmlns:dcmitype":qr.dcmitype,"xmlns:xsi":qr.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&oy("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:T2(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&oy("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:T2(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=ri.length;++i){var o=ri[i],c=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&oy(o[0],c,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var sc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],tU=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function rU(e,t,r,n){var a=[];if(typeof e=="string")a=YA(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(d){return{v:d}}));var o=typeof t=="string"?YA(t,n).map(function(d){return d.v}):t,c=0,l=0;if(o.length>0)for(var u=0;u!==a.length;u+=2){switch(l=+a[u+1].v,a[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=o.slice(c,c+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=o.slice(c,c+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=o.slice(c,c+l);break}c+=l}}function CDe(e,t,r){var n={};return t||(t={}),e=Kt(e),sc.forEach(function(a){var i=(e.match(Ff(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=Ot(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var o=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(n[a[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&rU(n.HeadingPairs,n.TitlesOfParts,t,r),t}function nU(e){var t=[],r=Le;return e||(e={}),e.Application="SheetJS",t[t.length]=Fr,t[t.length]=Le("Properties",null,{xmlns:qr.EXT_PROPS,"xmlns:vt":qr.vt}),sc.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=zt(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+zt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var ADe=/<[^>]+>[^<]*/g;function kDe(e,t){var r={},n="",a=e.match(ADe);if(a)for(var i=0;i!=a.length;++i){var o=a[i],c=lt(o);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ot(c.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var l=o.split(">"),u=l[0].slice(4),d=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=Ot(d);break;case"bool":r[n]=cr(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=ur(d);break;case"cy":case"error":r[n]=Ot(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,l)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function aU(e){var t=[Fr,Le("Properties",null,{xmlns:qr.CUST_PROPS,"xmlns:vt":qr.vt})];if(!e)return t.join("");var r=1;return Er(e).forEach(function(a){++r,t[t.length]=Le("property",LNe(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:zt(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var O2={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},cy;function FDe(e,t,r){cy||(cy=hg(O2)),t=cy[t]||t,e[t]=r}function ODe(e,t){var r=[];return Er(O2).map(function(n){for(var a=0;a<ri.length;++a)if(ri[a][1]==n)return ri[a];for(a=0;a<sc.length;++a)if(sc[a][1]==n)return sc[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(mn(O2[n[1]]||n[1],a))}}),Le("DocumentProperties",r.join(""),{xmlns:ya.o})}function PDe(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Er(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var o=0;o<ri.length;++o)if(i==ri[o][1])return;for(o=0;o<sc.length;++o)if(i==sc[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var c=e[i],l="string";typeof c=="number"?(l="float",c=String(c)):c===!0||c===!1?(l="boolean",c=c?"1":"0"):c=String(c),a.push(Le(VA(i),c,{"dt:dt":l}))}}),t&&Er(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var o=t[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o instanceof Date?(c="dateTime.tz",o=o.toISOString()):o=String(o),a.push(Le(VA(i),o,{"dt:dt":c}))}}),"<"+n+' xmlns="'+ya.o+'">'+a.join("")+"</"+n+">"}function hj(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function IDe(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var o=Se(8);return o.write_shift(4,n),o.write_shift(4,a),o}function iU(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function sU(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function oU(e,t,r){return t===31?sU(e):iU(e,t,r)}function P2(e,t,r){return oU(e,t,r===!1?0:4)}function UDe(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return oU(e,t,0)}function RDe(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(On,""),e.l-a&2&&(e.l+=2)}return r}function MDe(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(On,"");return r}function BDe(e){var t=e.l,r=wx(e,KI);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=wx(e,Qn);return[r,n]}function LDe(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(BDe(e));return r}function ok(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),o=e.read_shift(4);n[i]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(On,"").replace(vd,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function cU(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function $De(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function wx(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==ak&&n!==t&&vDe.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===ak?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return iU(e,n,4).replace(On,"");case 31:return sU(e);case 64:return hj(e);case 65:return cU(e);case 71:return $De(e);case 80:return P2(e,n,!i.raw).replace(On,"");case 81:return UDe(e,n).replace(On,"");case 4108:return LDe(e);case 4126:case 4127:return n==4127?RDe(e):MDe(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function ck(e,t){var r=Se(4),n=Se(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Se(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=IDe(t);break;case 31:case 80:for(n=Se(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Qr([r,n])}function lk(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],o=0,c=0,l=-1,u={};for(o=0;o!=a;++o){var d=e.read_shift(4),f=e.read_shift(4);i[o]=[d,f+r]}i.sort(function(y,b){return y[1]-b[1]});var h={};for(o=0;o!=a;++o){if(e.l!==i[o][1]){var m=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,m=!1);break;case 80:e.l<=i[o][1]&&(e.l=i[o][1],m=!1);break;case 4108:e.l<=i[o][1]&&(e.l=i[o][1],m=!1);break}if((!t||o==0)&&e.l<=i[o][1]&&(m=!1,e.l=i[o][1]),m)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var x=t[i[o][0]];if(h[x.n]=wx(e,x.t,{raw:!0}),x.p==="version"&&(h[x.n]=String(h[x.n]>>16)+"."+("0000"+String(h[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(h[x.n]){case 0:h[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ei(c=h[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[x.n])}}else if(i[o][0]===1){if(c=h.CodePage=wx(e,dj),ei(c),l!==-1){var p=e.l;e.l=i[l][1],u=ok(e,c),e.l=p}}else if(i[o][0]===0){if(c===0){l=o,e.l=i[o+1][1];continue}u=ok(e,c)}else{var g=u[i[o][0]],v;switch(e[e.l]){case 65:e.l+=4,v=cU(e);break;case 30:e.l+=4,v=P2(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=P2(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=Cr(e,4);break;case 64:e.l+=4,v=ur(hj(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=v}}return e.l=r+n,h}var lU=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function WDe(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function uk(e,t,r){var n=Se(8),a=[],i=[],o=8,c=0,l=Se(8),u=Se(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),i.push(l),a.push(u),o+=8+l.length,!t){u=Se(8),u.write_shift(4,0),a.unshift(u);var d=[Se(4)];for(d[0].write_shift(4,e.length),c=0;c<e.length;++c){var f=e[c][0];for(l=Se(8+2*(f.length+1)+(f.length%2?0:2)),l.write_shift(4,c+2),l.write_shift(4,f.length+1),l.write_shift(0,f,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=Qr(d),i.unshift(l),o+=8+l.length}for(c=0;c<e.length;++c)if(!(t&&!t[e[c][0]])&&!(lU.indexOf(e[c][0])>-1||tU.indexOf(e[c][0])>-1)&&e[c][1]!=null){var h=e[c][1],m=0;if(t){m=+t[e[c][0]];var x=r[m];if(x.p=="version"&&typeof h=="string"){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}l=ck(x.t,h)}else{var g=WDe(h);g==-1&&(g=31,h=String(h)),l=ck(g,h)}i.push(l),u=Se(8),u.write_shift(4,t?m:2+c),a.push(u),o+=8+l.length}var v=8*(i.length+1);for(c=0;c<i.length;++c)a[c].write_shift(4,v),v+=i[c].length;return n.write_shift(4,o),n.write_shift(4,i.length),Qr([n].concat(a).concat(i))}function dk(e,t,r){var n=e.content;if(!n)return{};hn(n,0);var a,i,o,c,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==et.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),c=n.read_shift(4),a===1&&c!==n.l)throw new Error("Length mismatch: "+c+" !== "+n.l);a===2&&(o=n.read_shift(16),l=n.read_shift(4));var f=lk(n,t),h={SystemIdentifier:u};for(var m in f)h[m]=f[m];if(h.FMTID=i,a===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var x;try{x=lk(n,null)}catch{}for(m in x)h[m]=x[m];return h.FMTID=[i,o],h}function fk(e,t,r,n,a,i){var o=Se(a?68:48),c=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,et.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,a?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,a?68:48);var l=uk(e,r,n);if(c.push(l),a){var u=uk(a,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+l.length),c.push(u)}return Qr(c)}function Ws(e,t){return e.read_shift(t),null}function zDe(e,t){t||(t=Se(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function qDe(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Cr(e,t){return e.read_shift(t)===1}function Wn(e,t){return t||(t=Se(2)),t.write_shift(2,+!!e),t}function Rr(e){return e.read_shift(2,"u")}function Va(e,t){return t||(t=Se(2)),t.write_shift(2,e),t}function uU(e,t){return qDe(e,t,Rr)}function HDe(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function dU(e,t,r){return r||(r=Se(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Fh(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont",i=Ca;if(r&&r.biff>=8&&(Ca=1200),!r||r.biff==8){var o=e.read_shift(1);o&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var c=n?e.read_shift(n,a):"";return Ca=i,c}function VDe(e){var t=Ca;Ca=1200;var r=e.read_shift(2),n=e.read_shift(1),a=n&4,i=n&8,o=1+(n&1),c=0,l,u={};i&&(c=e.read_shift(2)),a&&(l=e.read_shift(4));var d=o==2?"dbcs-cont":"sbcs-cont",f=r===0?"":e.read_shift(r,d);return i&&(e.l+=4*c),a&&(e.l+=l),u.t=f,i||(u.raw="<t>"+u.t+"</t>",u.r=u.t),Ca=t,u}function GDe(e){var t=e.t||"",r=Se(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Se(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Qr(a)}function yc(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Oh(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):yc(e,n,r)}function Uc(e,t,r){if(r.biff>5)return Oh(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function fU(e,t,r){return r||(r=Se(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function XDe(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function KDe(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(On,"");return n&&(e.l+=24),a}function YDe(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(i>>1,"utf16le").replace(On,"");return r+o}function ZDe(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return KDe(e);case"0303000000000000c000000000000046":return YDe(e);default:throw new Error("Unsupported Moniker "+r)}}function bm(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(On,""):"";return r}function hk(e,t){t||(t=Se(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function JDe(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,o,c,l,u="",d,f;a&16&&(i=bm(e,r-e.l)),a&128&&(o=bm(e,r-e.l)),(a&257)===257&&(c=bm(e,r-e.l)),(a&257)===1&&(l=ZDe(e,r-e.l)),a&8&&(u=bm(e,r-e.l)),a&32&&(d=e.read_shift(16)),a&64&&(f=hj(e)),e.l=r;var h=o||c||l||"";h&&u&&(h+="#"+u),h||(h="#"+u),a&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var m={Target:h};return d&&(m.guid=d),f&&(m.time=f),i&&(m.Tooltip=i),m}function QDe(e){var t=Se(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(i==28)n=n.slice(1),hk(n,t);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var c=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(c.length+1)),r=0;r<c.length;++r)t.write_shift(2,c.charCodeAt(r));t.write_shift(2,0),i&8&&hk(a>-1?n.slice(a+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function hU(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function mU(e,t){var r=hU(e);return r[3]=0,r}function es(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function bc(e,t,r,n){return n||(n=Se(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function eSe(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function tSe(e,t,r){return t===0?"":Uc(e,t,r)}function rSe(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[a,i,o]}function pU(e){var t=e.read_shift(2),r=uj(e);return[t,r]}function nSe(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=Fh(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function gg(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function xU(e,t){return t||(t=Se(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function gU(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var aSe=gU;function vU(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function iSe(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function sSe(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function _n(e){e.l+=2,e.l+=e.read_shift(2)}var oSe={0:_n,4:_n,5:_n,6:_n,7:sSe,8:_n,9:_n,10:_n,11:_n,12:_n,13:iSe,14:_n,15:_n,16:_n,17:_n,18:_n,19:_n,20:_n,21:vU};function cSe(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(oSe[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function wm(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function mj(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Se(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function lSe(e,t){return t===0||e.read_shift(2),1200}function uSe(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Uc(e,0,r);return e.read_shift(t+n-e.l),a}function dSe(e,t){var r=!t||t.biff==8,n=Se(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function fSe(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function hSe(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=Fh(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:a,dt:i,name:o}}function mSe(e,t){var r=!t||t.biff>=8?2:1,n=Se(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function pSe(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],o=0;o!=a&&e.l<r;++o)i.push(VDe(e));return i.Count=n,i.Unique=a,i}function xSe(e,t){var r=Se(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=GDe(e[a]);var i=Qr([r].concat(n));return i.parts=[r.length].concat(n.map(function(o){return o.length})),i}function gSe(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function vSe(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function ySe(e){var t=eSe(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function bSe(e){return e.read_shift(2),e.read_shift(4)}function mk(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function wSe(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:o,FirstTab:c,Selected:l,TabRatio:u}}function _Se(){var e=Se(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function jSe(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function NSe(e){var t=Se(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function DSe(){}function SSe(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Fh(e,0,r),n}function ESe(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=Se(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function TSe(e){var t=es(e);return t.isst=e.read_shift(4),t}function CSe(e,t,r,n){var a=Se(10);return bc(e,t,n,a),a.write_shift(4,r),a}function ASe(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=es(e);r.biff==2&&e.l++;var i=Oh(e,n-e.l,r);return a.val=i,a}function kSe(e,t,r,n,a){var i=!a||a.biff==8,o=Se(8+ +i+(1+i)*r.length);return bc(e,t,n,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function FSe(e,t,r){var n=e.read_shift(2),a=Uc(e,0,r);return[n,a]}function OSe(e,t,r,n){var a=r&&r.biff==5;n||(n=Se(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var PSe=Uc;function pk(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),o=e.read_shift(a),c=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:i,c},e:{r:o,c:l}}}function ISe(e,t){var r=t.biff==8||!t.biff?4:2,n=Se(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function USe(e){var t=e.read_shift(2),r=e.read_shift(2),n=pU(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function RSe(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(pU(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:i}}function MSe(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:i}}function BSe(e,t,r,n){var a={},i=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(4),l=e.read_shift(2);return a.patternType=yDe[c>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function LSe(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=BSe(e,t,n.fStyle,r),n}function xk(e,t,r,n){var a=r&&r.biff==5;n||(n=Se(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function $Se(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function WSe(e){var t=Se(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function gk(e,t,r){var n=es(e);(r.biff==2||t==9)&&++e.l;var a=HDe(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function zSe(e,t,r,n,a,i){var o=Se(8);return bc(e,t,n,o),dU(r,i,o),o}function qSe(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=es(e),a=kn(e);return n.val=a,n}function HSe(e,t,r,n){var a=Se(14);return bc(e,t,n,a),vc(r,a),a}var vk=tSe;function VSe(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=yc(e,i),c=[];n>e.l;)c.push(Oh(e));return[i,a,o,c]}function yk(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=nSe(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var GSe=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function bk(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=yc(e,o,r);a&32&&(u=GSe[u.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var f=n==e.l||c===0||!(d>0)?[]:cke(e,d,r,c);return{chKey:i,Name:u,itab:l,rgce:f}}function yU(e,t,r){if(r.biff<8)return XSe(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(rSe(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function XSe(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Fh(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function KSe(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=yc(e,n,r),o=yc(e,a,r);return[i,o]}function YSe(e,t,r){var n=gU(e);e.l++;var a=e.read_shift(1);return t-=8,[lke(e,t,r),a,n]}function wk(e,t,r){var n=aSe(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,ske(e,t,r)]}function ZSe(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function JSe(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=Uc(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},c,o,i]}}function QSe(e,t,r){return JSe(e,t,r)}function eEe(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(gg(e));return r}function tEe(e){var t=Se(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)xU(e[r],t);return t}function rEe(e,t,r){if(r&&r.biff<8)return aEe(e,t,r);var n=vU(e),a=cSe(e,t-22,n[1]);return{cmo:n,ft:a}}var nEe={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function aEe(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((nEe[n]||In)(e,t,r)),{cmo:[a,n,i],ft:o}}function iEe(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:o=XDe(e,6,r);var c=e.read_shift(2);e.read_shift(2),Rr(e,2);var l=e.read_shift(2);e.l+=l;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=yc(e,e.lens[u+1]-e.lens[u]-1);if(a+=f,a.length>=(d?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function sEe(e,t){var r=gg(e);e.l+=16;var n=JDe(e,t-24);return[r,n]}function oEe(e){var t=Se(24),r=yr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Qr([t,QDe(e[1])])}function cEe(e,t){e.read_shift(2);var r=gg(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(On,""),[r,n]}function lEe(e){var t=e[1].Tooltip,r=Se(10+2*(t.length+1));r.write_shift(2,2048);var n=yr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function uEe(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=ik[r]||r,r=e.read_shift(2),t[1]=ik[r]||r,t}function dEe(e){return e||(e=Se(4)),e.write_shift(2,1),e.write_shift(2,1),e}function fEe(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(mU(e));return r}function hEe(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(mU(e));return r}function mEe(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function bU(e,t,r){if(!r.cellStyles)return In(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:i,w:o,ixfe:c,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function pEe(e,t){var r=Se(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function xEe(e,t){var r={};return t<32||(e.l+=16,r.header=kn(e),r.footer=kn(e),e.l+=2),r}function gEe(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function vEe(e){for(var t=Se(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var yEe=es,bEe=uU,wEe=Oh;function _Ee(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function jEe(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=es(e);++e.l;var a=Uc(e,t-7,r);return n.t="str",n.val=a,n}function NEe(e){var t=es(e);++e.l;var r=kn(e);return t.t="n",t.val=r,t}function DEe(e,t,r){var n=Se(15);return Rh(n,e,t),n.write_shift(8,r,"f"),n}function SEe(e){var t=es(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function EEe(e,t,r){var n=Se(9);return Rh(n,e,t),n.write_shift(2,r),n}function TEe(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function CEe(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function AEe(e,t,r){var n=e.l+t,a=es(e),i=e.read_shift(2),o=yc(e,i,r);return e.l=n,a.t="str",a.val=o,a}var kEe=[2,3,48,49,131,139,140,245],I2=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=hg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,l){var u=[],d=fo(1);switch(l.type){case"base64":d=wa(Aa(c));break;case"binary":d=wa(c);break;case"buffer":case"array":d=c;break}hn(d,0);var f=d.read_shift(1),h=!!(f&136),m=!1,x=!1;switch(f){case 2:break;case 3:break;case 48:m=!0,h=!0;break;case 49:m=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,g=521;f==2&&(p=d.read_shift(2)),d.l+=3,f!=2&&(p=d.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(g=d.read_shift(2));var v=d.read_shift(2),y=l.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(y=e[d[d.l]]),d.l+=1,d.l+=2),x&&(d.l+=36);for(var b=[],_={},w=Math.min(d.length,f==2?521:g-10-(m?264:0)),j=x?32:11;d.l<w&&d[d.l]!=13;)switch(_={},_.name=Ct.utils.decode(y,d.slice(d.l,d.l+j)).replace(/[\u0000\r\n].*$/g,""),d.l+=j,_.type=String.fromCharCode(d.read_shift(1)),f!=2&&!x&&(_.offset=d.read_shift(4)),_.len=d.read_shift(1),f==2&&(_.offset=d.read_shift(2)),_.dec=d.read_shift(1),_.name.length&&b.push(_),f!=2&&(d.l+=x?13:14),_.type){case"B":(!m||_.len!=8)&&l.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(d[d.l]!==13&&(d.l=g-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=g;var N=0,D=0;for(u[0]=[],D=0;D!=b.length;++D)u[0][D]=b[D].name;for(;p-- >0;){if(d[d.l]===42){d.l+=v;continue}for(++d.l,u[++N]=[],D=0,D=0;D!=b.length;++D){var S=d.slice(d.l,d.l+b[D].len);d.l+=b[D].len,hn(S,0);var T=Ct.utils.decode(y,S);switch(b[D].type){case"C":T.trim().length&&(u[N][D]=T.replace(/\s+$/,""));break;case"D":T.length===8?u[N][D]=new Date(+T.slice(0,4),+T.slice(4,6)-1,+T.slice(6,8)):u[N][D]=T;break;case"F":u[N][D]=parseFloat(T.trim());break;case"+":case"I":u[N][D]=x?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(T.trim().toUpperCase()){case"Y":case"T":u[N][D]=!0;break;case"N":case"F":u[N][D]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+T+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[N][D]="##MEMO##"+(x?parseInt(T.trim(),10):S.read_shift(4));break;case"N":T=T.replace(/\u0000/g,"").trim(),T&&T!="."&&(u[N][D]=+T||0);break;case"@":u[N][D]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":u[N][D]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":u[N][D]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[N][D]=-S.read_shift(-8,"f");break;case"B":if(m&&b[D].len==8){u[N][D]=S.read_shift(8,"f");break}case"G":case"P":S.l+=b[D].len;break;case"0":if(b[D].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[D].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=b,u}function n(c,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var d=Pu(r(c,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function a(c,l){try{return So(n(c,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(c,l){var u=l||{};if(+u.codepage>=0&&ei(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=oa(),f=Nx(c,{header:1,raw:!0,cellDates:!0}),h=f[0],m=f.slice(1),x=c["!cols"]||[],p=0,g=0,v=0,y=1;for(p=0;p<h.length;++p){if(((x[p]||{}).DBF||{}).name){h[p]=x[p].DBF.name,++v;continue}if(h[p]!=null){if(++v,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(g=0;g<1024;++g)if(h.indexOf(h[p]+"_"+g)==-1){h[p]+="_"+g;break}}}}var b=Dt(c["!ref"]),_=[],w=[],j=[];for(p=0;p<=b.e.c-b.s.c;++p){var N="",D="",S=0,T=[];for(g=0;g<m.length;++g)m[g][p]!=null&&T.push(m[g][p]);if(T.length==0||h[p]==null){_[p]="?";continue}for(g=0;g<T.length;++g){switch(typeof T[g]){case"number":D="B";break;case"string":D="C";break;case"boolean":D="L";break;case"object":D=T[g]instanceof Date?"D":"C";break;default:D="C"}S=Math.max(S,String(T[g]).length),N=N&&N!=D?"C":D}S>250&&(S=250),D=((x[p]||{}).DBF||{}).type,D=="C"&&x[p].DBF.len>S&&(S=x[p].DBF.len),N=="B"&&D=="N"&&(N="N",j[p]=x[p].DBF.dec,S=x[p].DBF.len),w[p]=N=="C"||D=="N"?S:i[N]||0,y+=w[p],_[p]=N}var A=d.next(32);for(A.write_shift(4,318902576),A.write_shift(4,m.length),A.write_shift(2,296+32*v),A.write_shift(2,y),p=0;p<4;++p)A.write_shift(4,0);for(A.write_shift(4,0|(+t[pc]||3)<<8),p=0,g=0;p<h.length;++p)if(h[p]!=null){var E=d.next(32),M=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);E.write_shift(1,M,"sbcs"),E.write_shift(1,_[p]=="?"?"C":_[p],"sbcs"),E.write_shift(4,g),E.write_shift(1,w[p]||i[_[p]]||0),E.write_shift(1,j[p]||0),E.write_shift(1,2),E.write_shift(4,0),E.write_shift(1,0),E.write_shift(4,0),E.write_shift(4,0),g+=w[p]||i[_[p]]||0}var P=d.next(264);for(P.write_shift(4,13),p=0;p<65;++p)P.write_shift(4,0);for(p=0;p<m.length;++p){var X=d.next(y);for(X.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(_[g]){case"L":X.write_shift(1,m[p][g]==null?63:m[p][g]?84:70);break;case"B":X.write_shift(8,m[p][g]||0,"f");break;case"N":var q="0";for(typeof m[p][g]=="number"&&(q=m[p][g].toFixed(j[g]||0)),v=0;v<w[g]-q.length;++v)X.write_shift(1,32);X.write_shift(1,q,"sbcs");break;case"D":m[p][g]?(X.write_shift(4,("0000"+m[p][g].getFullYear()).slice(-4),"sbcs"),X.write_shift(2,("00"+(m[p][g].getMonth()+1)).slice(-2),"sbcs"),X.write_shift(2,("00"+m[p][g].getDate()).slice(-2),"sbcs")):X.write_shift(8,"00000000","sbcs");break;case"C":var B=String(m[p][g]!=null?m[p][g]:"").slice(0,w[g]);for(X.write_shift(1,B,"sbcs"),v=0;v<w[g]-B.length;++v)X.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}}(),wU=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Er(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,m){var x=e[m];return typeof x=="number"?E2(x):x},n=function(h,m,x){var p=m.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return p==59?h:E2(p)};e["|"]=254;function a(h,m){switch(m.type){case"base64":return i(Aa(h),m);case"binary":return i(h,m);case"buffer":return i(_t&&Buffer.isBuffer(h)?h.toString("binary"):Do(h),m);case"array":return i(gc(h),m)}throw new Error("Unrecognized type "+m.type)}function i(h,m){var x=h.split(/[\n\r]+/),p=-1,g=-1,v=0,y=0,b=[],_=[],w=null,j={},N=[],D=[],S=[],T=0,A;for(+m.codepage>=0&&ei(+m.codepage);v!==x.length;++v){T=0;var E=x[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),M=E.replace(/;;/g,"\0").split(";").map(function(V){return V.replace(/\u0000/g,";")}),P=M[0],X;if(E.length>0)switch(P){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":M[1].charAt(0)=="P"&&_.push(E.slice(3).replace(/;;/g,";"));break;case"C":var q=!1,B=!1,O=!1,F=!1,I=-1,L=-1;for(y=1;y<M.length;++y)switch(M[y].charAt(0)){case"A":break;case"X":g=parseInt(M[y].slice(1))-1,B=!0;break;case"Y":for(p=parseInt(M[y].slice(1))-1,B||(g=0),A=b.length;A<=p;++A)b[A]=[];break;case"K":X=M[y].slice(1),X.charAt(0)==='"'?X=X.slice(1,X.length-1):X==="TRUE"?X=!0:X==="FALSE"?X=!1:isNaN(_i(X))?isNaN(Jl(X).getDate())||(X=ur(X)):(X=_i(X),w!==null&&Ac(w)&&(X=pg(X))),typeof Ct<"u"&&typeof X=="string"&&(m||{}).type!="string"&&(m||{}).codepage&&(X=Ct.utils.decode(m.codepage,X)),q=!0;break;case"E":F=!0;var C=yl(M[y].slice(1),{r:p,c:g});b[p][g]=[b[p][g],C];break;case"S":O=!0,b[p][g]=[b[p][g],"S5S"];break;case"G":break;case"R":I=parseInt(M[y].slice(1))-1;break;case"C":L=parseInt(M[y].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+E)}if(q&&(b[p][g]&&b[p][g].length==2?b[p][g][0]=X:b[p][g]=X,w=null),O){if(F)throw new Error("SYLK shared formula cannot have own formula");var k=I>-1&&b[I][L];if(!k||!k[1])throw new Error("SYLK shared formula cannot find base");b[p][g][1]=BU(k[1],{r:p-I,c:g-L})}break;case"F":var z=0;for(y=1;y<M.length;++y)switch(M[y].charAt(0)){case"X":g=parseInt(M[y].slice(1))-1,++z;break;case"Y":for(p=parseInt(M[y].slice(1))-1,A=b.length;A<=p;++A)b[A]=[];break;case"M":T=parseInt(M[y].slice(1))/20;break;case"F":break;case"G":break;case"P":w=_[parseInt(M[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=M[y].slice(1).split(" "),A=parseInt(S[0],10);A<=parseInt(S[1],10);++A)T=parseInt(S[2],10),D[A-1]=T===0?{hidden:!0}:{wch:T},ho(D[A-1]);break;case"C":g=parseInt(M[y].slice(1))-1,D[g]||(D[g]={});break;case"R":p=parseInt(M[y].slice(1))-1,N[p]||(N[p]={}),T>0?(N[p].hpt=T,N[p].hpx=eu(T)):T===0&&(N[p].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+E)}z<1&&(w=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+E)}}return N.length>0&&(j["!rows"]=N),D.length>0&&(j["!cols"]=D),m&&m.sheetRows&&(b=b.slice(0,m.sheetRows)),[b,j]}function o(h,m){var x=a(h,m),p=x[0],g=x[1],v=Pu(p,m);return Er(g).forEach(function(y){v[y]=g[y]}),v}function c(h,m){return So(o(h,m),m)}function l(h,m,x,p){var g="C;Y"+(x+1)+";X"+(p+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+bj(h.f,{r:x,c:p}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function u(h,m){m.forEach(function(x,p){var g="F;W"+(p+1)+" "+(p+1)+" ";x.hidden?g+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=Rf(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=Mf(x.wpx)),typeof x.wch=="number"&&(g+=Math.round(x.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function d(h,m){m.forEach(function(x,p){var g="F;";x.hidden?g+="M0;":x.hpt?g+="M"+20*x.hpt+";":x.hpx&&(g+="M"+20*Bf(x.hpx)+";"),g.length>2&&h.push(g+"R"+(p+1))})}function f(h,m){var x=["ID;PWXL;N;E"],p=[],g=Dt(h["!ref"]),v,y=Array.isArray(h),b=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&u(x,h["!cols"]),h["!rows"]&&d(x,h["!rows"]),x.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var _=g.s.r;_<=g.e.r;++_)for(var w=g.s.c;w<=g.e.c;++w){var j=ot({r:_,c:w});v=y?(h[_]||[])[w]:h[j],!(!v||v.v==null&&(!v.f||v.F))&&p.push(l(v,h,_,w))}return x.join(b)+b+p.join(b)+b+"E"+b}return{to_workbook:c,to_sheet:o,from_sheet:f}}(),_U=function(){function e(i,o){switch(o.type){case"base64":return t(Aa(i),o);case"binary":return t(i,o);case"buffer":return t(_t&&Buffer.isBuffer(i)?i.toString("binary"):Do(i),o);case"array":return t(gc(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var c=i.split(`
`),l=-1,u=-1,d=0,f=[];d!==c.length;++d){if(c[d].trim()==="BOT"){f[++l]=[],u=0;continue}if(!(l<0)){var h=c[d].trim().split(","),m=h[0],x=h[1];++d;for(var p=c[d]||"";(p.match(/["]/g)||[]).length&1&&d<c.length-1;)p+=`
`+c[++d];switch(p=p.trim(),+m){case-1:if(p==="BOT"){f[++l]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[l][u]=!0:p==="FALSE"?f[l][u]=!1:isNaN(_i(x))?isNaN(Jl(x).getDate())?f[l][u]=x:f[l][u]=ur(x):f[l][u]=_i(x),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[l][u++]=p!==""?p:null;break}if(p==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(i,o){return Pu(e(i,o),o)}function n(i,o){return So(r(i,o),o)}var a=function(){var i=function(l,u,d,f,h){l.push(u),l.push(d+","+f),l.push('"'+h.replace(/"/g,'""')+'"')},o=function(l,u,d,f){l.push(u+","+d),l.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var u=[],d=Dt(l["!ref"]),f,h=Array.isArray(l);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,d.e.r-d.s.r+1,""),i(u,"TUPLES",0,d.e.c-d.s.c+1,""),i(u,"DATA",0,0,"");for(var m=d.s.r;m<=d.e.r;++m){o(u,-1,0,"BOT");for(var x=d.s.c;x<=d.e.c;++x){var p=ot({r:m,c:x});if(f=h?(l[m]||[])[x]:l[p],!f){o(u,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?o(u,1,0,"="+f.f):o(u,1,0,""):o(u,0,g,"V");break;case"b":o(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=ka(f.z||at[14],Vr(ur(f.v)))),o(u,0,f.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var v=`\r
`,y=u.join(v);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),jU=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var m=f.split(`
`),x=-1,p=-1,g=0,v=[];g!==m.length;++g){var y=m[g].trim().split(":");if(y[0]==="cell"){var b=yr(y[1]);if(v.length<=b.r)for(x=v.length;x<=b.r;++x)v[x]||(v[x]=[]);switch(x=b.r,p=b.c,y[2]){case"t":v[x][p]=e(y[3]);break;case"v":v[x][p]=+y[3];break;case"vtf":var _=y[y.length-1];case"vtc":switch(y[3]){case"nl":v[x][p]=!!+y[4];break;default:v[x][p]=+y[4];break}y[2]=="vtf"&&(v[x][p]=[v[x][p],_])}}}return h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),v}function n(f,h){return Pu(r(f,h),h)}function a(f,h){return So(n(f,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var h=[],m=[],x,p="",g=Gn(f["!ref"]),v=Array.isArray(f),y=g.s.r;y<=g.e.r;++y)for(var b=g.s.c;b<=g.e.c;++b)if(p=ot({r:y,c:b}),x=v?(f[y]||[])[b]:f[p],!(!x||x.v==null||x.t==="z")){switch(m=["cell",p,"t"],x.t){case"s":case"str":m.push(t(x.v));break;case"n":x.f?(m[2]="vtf",m[3]="n",m[4]=x.v,m[5]=t(x.f)):(m[2]="v",m[3]=x.v);break;case"b":m[2]="vt"+(x.f?"f":"c"),m[3]="nl",m[4]=x.v?"1":"0",m[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var _=Vr(ur(x.v));m[2]="vtc",m[3]="nd",m[4]=""+_,m[5]=x.w||ka(x.z||at[14],_);break;case"e":continue}h.push(m.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[i,o,c,o,u(f),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}}(),Ql=function(){function e(d,f,h,m,x){x.raw?f[h][m]=d:d===""||(d==="TRUE"?f[h][m]=!0:d==="FALSE"?f[h][m]=!1:isNaN(_i(d))?isNaN(Jl(d).getDate())?f[h][m]=d:f[h][m]=ur(d):f[h][m]=_i(d))}function t(d,f){var h=f||{},m=[];if(!d||d.length===0)return m;for(var x=d.split(/[\r\n]/),p=x.length-1;p>=0&&x[p].length===0;)--p;for(var g=10,v=0,y=0;y<=p;++y)v=x[y].indexOf(" "),v==-1?v=x[y].length:v++,g=Math.max(g,v);for(y=0;y<=p;++y){m[y]=[];var b=0;for(e(x[y].slice(0,g).trim(),m,y,b,h),b=1;b<=(x[y].length-g)/10+1;++b)e(x[y].slice(g+(b-1)*10,g+b*10).trim(),m,y,b,h)}return h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var f={},h=!1,m=0,x=0;m<d.length;++m)(x=d.charCodeAt(m))==34?h=!h:!h&&x in r&&(f[x]=(f[x]||0)+1);x=[];for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&x.push([f[m],m]);if(!x.length){f=n;for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&x.push([f[m],m])}return x.sort(function(p,g){return p[0]-g[0]||n[p[1]]-n[g[1]]}),r[x.pop()[1]]||44}function i(d,f){var h=f||{},m="",x=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(m=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(m=d.charAt(4),d=d.slice(6)):m=a(d.slice(0,1024)):h&&h.FS?m=h.FS:m=a(d.slice(0,1024));var g=0,v=0,y=0,b=0,_=0,w=m.charCodeAt(0),j=!1,N=0,D=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var S=h.dateNF!=null?xNe(h.dateNF):null;function T(){var A=d.slice(b,_),E={};if(A.charAt(0)=='"'&&A.charAt(A.length-1)=='"'&&(A=A.slice(1,-1).replace(/""/g,'"')),A.length===0)E.t="z";else if(h.raw)E.t="s",E.v=A;else if(A.trim().length===0)E.t="s",E.v=A;else if(A.charCodeAt(0)==61)A.charCodeAt(1)==34&&A.charCodeAt(A.length-1)==34?(E.t="s",E.v=A.slice(2,-1).replace(/""/g,'"')):VCe(A)?(E.t="n",E.f=A.slice(1)):(E.t="s",E.v=A);else if(A=="TRUE")E.t="b",E.v=!0;else if(A=="FALSE")E.t="b",E.v=!1;else if(!isNaN(y=_i(A)))E.t="n",h.cellText!==!1&&(E.w=A),E.v=y;else if(!isNaN(Jl(A).getDate())||S&&A.match(S)){E.z=h.dateNF||at[14];var M=0;S&&A.match(S)&&(A=gNe(A,h.dateNF,A.match(S)||[]),M=1),h.cellDates?(E.t="d",E.v=ur(A,M)):(E.t="n",E.v=Vr(ur(A,M))),h.cellText!==!1&&(E.w=ka(E.z,E.v instanceof Date?Vr(E.v):E.v)),h.cellNF||delete E.z}else E.t="s",E.v=A;if(E.t=="z"||(h.dense?(x[g]||(x[g]=[]),x[g][v]=E):x[ot({c:v,r:g})]=E),b=_+1,D=d.charCodeAt(b),p.e.c<v&&(p.e.c=v),p.e.r<g&&(p.e.r=g),N==w)++v;else if(v=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;_<d.length;++_)switch(N=d.charCodeAt(_)){case 34:D===34&&(j=!j);break;case w:case 10:case 13:if(!j&&T())break e;break}return _-b>0&&T(),x["!ref"]=xt(p),x}function o(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,f):Pu(t(d,f),f)}function c(d,f){var h="",m=f.type=="string"?[0,0,0,0]:Cj(d,f);switch(f.type){case"base64":h=Aa(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof Ct<"u"?h=Ct.utils.decode(f.codepage,d):h=_t&&Buffer.isBuffer(d)?d.toString("binary"):Do(d);break;case"array":h=gc(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return m[0]==239&&m[1]==187&&m[2]==191?h=Kt(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=Kt(h):f.type=="binary"&&typeof Ct<"u"&&f.codepage&&(h=Ct.utils.decode(f.codepage,Ct.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?jU.to_sheet(f.type=="string"?h:Kt(h),f):o(h,f)}function l(d,f){return So(c(d,f),f)}function u(d){for(var f=[],h=Dt(d["!ref"]),m,x=Array.isArray(d),p=h.s.r;p<=h.e.r;++p){for(var g=[],v=h.s.c;v<=h.e.c;++v){var y=ot({r:p,c:v});if(m=x?(d[p]||[])[v]:d[y],!m||m.v==null){g.push("          ");continue}for(var b=(m.w||(Yi(m),m.w)||"").slice(0,10);b.length<10;)b+=" ";g.push(b+(v===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:c,from_sheet:u}}();function FEe(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=wU.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Ql.to_workbook(e,t)}}var oc=function(){function e(C,k,z){if(C){hn(C,C.l||0);for(var V=z.Enum||I;C.l<C.length;){var Z=C.read_shift(2),ce=V[Z]||V[65535],ie=C.read_shift(2),Q=C.l+ie,ne=ce.f&&ce.f(C,ie,z);if(C.l=Q,k(ne,ce,Z))return}}}function t(C,k){switch(k.type){case"base64":return r(wa(Aa(C)),k);case"binary":return r(wa(C),k);case"buffer":case"array":return r(C,k)}throw"Unsupported type "+k.type}function r(C,k){if(!C)return C;var z=k||{},V=z.dense?[]:{},Z="Sheet1",ce="",ie=0,Q={},ne=[],pe=[],W={s:{r:0,c:0},e:{r:0,c:0}},re=z.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)z.Enum=I,e(C,function(K,H,oe){switch(oe){case 0:z.vers=K,K>=4096&&(z.qpro=!0);break;case 6:W=K;break;case 204:K&&(ce=K);break;case 222:ce=K;break;case 15:case 51:z.qpro||(K[1].v=K[1].v.slice(1));case 13:case 14:case 16:oe==14&&(K[2]&112)==112&&(K[2]&15)>1&&(K[2]&15)<15&&(K[1].z=z.dateNF||at[14],z.cellDates&&(K[1].t="d",K[1].v=pg(K[1].v))),z.qpro&&K[3]>ie&&(V["!ref"]=xt(W),Q[Z]=V,ne.push(Z),V=z.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},ie=K[3],Z=ce||"Sheet"+(ie+1),ce="");var J=z.dense?(V[K[0].r]||[])[K[0].c]:V[ot(K[0])];if(J){J.t=K[1].t,J.v=K[1].v,K[1].z!=null&&(J.z=K[1].z),K[1].f!=null&&(J.f=K[1].f);break}z.dense?(V[K[0].r]||(V[K[0].r]=[]),V[K[0].r][K[0].c]=K[1]):V[ot(K[0])]=K[1];break}},z);else if(C[2]==26||C[2]==14)z.Enum=L,C[2]==14&&(z.qpro=!0,C.l=0),e(C,function(K,H,oe){switch(oe){case 204:Z=K;break;case 22:K[1].v=K[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(K[3]>ie&&(V["!ref"]=xt(W),Q[Z]=V,ne.push(Z),V=z.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},ie=K[3],Z="Sheet"+(ie+1)),re>0&&K[0].r>=re)break;z.dense?(V[K[0].r]||(V[K[0].r]=[]),V[K[0].r][K[0].c]=K[1]):V[ot(K[0])]=K[1],W.e.c<K[0].c&&(W.e.c=K[0].c),W.e.r<K[0].r&&(W.e.r=K[0].r);break;case 27:K[14e3]&&(pe[K[14e3][0]]=K[14e3][1]);break;case 1537:pe[K[0]]=K[1],K[0]==ie&&(Z=K[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(V["!ref"]=xt(W),Q[ce||Z]=V,ne.push(ce||Z),!pe.length)return{SheetNames:ne,Sheets:Q};for(var U={},se=[],te=0;te<pe.length;++te)Q[ne[te]]?(se.push(pe[te]||ne[te]),U[pe[te]]=Q[pe[te]]||Q[ne[te]]):(se.push(pe[te]),U[pe[te]]={"!ref":"A1"});return{SheetNames:se,Sheets:U}}function n(C,k){var z=k||{};if(+z.codepage>=0&&ei(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var V=oa(),Z=Dt(C["!ref"]),ce=Array.isArray(C),ie=[];$e(V,0,i(1030)),$e(V,6,l(Z));for(var Q=Math.min(Z.e.r,8191),ne=Z.s.r;ne<=Q;++ne)for(var pe=Nr(ne),W=Z.s.c;W<=Z.e.c;++W){ne===Z.s.r&&(ie[W]=lr(W));var re=ie[W]+pe,U=ce?(C[ne]||[])[W]:C[re];if(!(!U||U.t=="z"))if(U.t=="n")(U.v|0)==U.v&&U.v>=-32768&&U.v<=32767?$e(V,13,m(ne,W,U.v)):$e(V,14,p(ne,W,U.v));else{var se=Yi(U);$e(V,15,f(ne,W,se.slice(0,239)))}}return $e(V,1),V.end()}function a(C,k){var z=k||{};if(+z.codepage>=0&&ei(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var V=oa();$e(V,0,o(C));for(var Z=0,ce=0;Z<C.SheetNames.length;++Z)(C.Sheets[C.SheetNames[Z]]||{})["!ref"]&&$e(V,27,F(C.SheetNames[Z],ce++));var ie=0;for(Z=0;Z<C.SheetNames.length;++Z){var Q=C.Sheets[C.SheetNames[Z]];if(!(!Q||!Q["!ref"])){for(var ne=Dt(Q["!ref"]),pe=Array.isArray(Q),W=[],re=Math.min(ne.e.r,8191),U=ne.s.r;U<=re;++U)for(var se=Nr(U),te=ne.s.c;te<=ne.e.c;++te){U===ne.s.r&&(W[te]=lr(te));var K=W[te]+se,H=pe?(Q[U]||[])[te]:Q[K];if(!(!H||H.t=="z"))if(H.t=="n")$e(V,23,T(U,te,ie,H.v));else{var oe=Yi(H);$e(V,22,N(U,te,ie,oe.slice(0,239)))}}++ie}}return $e(V,1),V.end()}function i(C){var k=Se(2);return k.write_shift(2,C),k}function o(C){var k=Se(26);k.write_shift(2,4096),k.write_shift(2,4),k.write_shift(4,0);for(var z=0,V=0,Z=0,ce=0;ce<C.SheetNames.length;++ce){var ie=C.SheetNames[ce],Q=C.Sheets[ie];if(!(!Q||!Q["!ref"])){++Z;var ne=Gn(Q["!ref"]);z<ne.e.r&&(z=ne.e.r),V<ne.e.c&&(V=ne.e.c)}}return z>8191&&(z=8191),k.write_shift(2,z),k.write_shift(1,Z),k.write_shift(1,V),k.write_shift(2,0),k.write_shift(2,0),k.write_shift(1,1),k.write_shift(1,2),k.write_shift(4,0),k.write_shift(4,0),k}function c(C,k,z){var V={s:{c:0,r:0},e:{c:0,r:0}};return k==8&&z.qpro?(V.s.c=C.read_shift(1),C.l++,V.s.r=C.read_shift(2),V.e.c=C.read_shift(1),C.l++,V.e.r=C.read_shift(2),V):(V.s.c=C.read_shift(2),V.s.r=C.read_shift(2),k==12&&z.qpro&&(C.l+=2),V.e.c=C.read_shift(2),V.e.r=C.read_shift(2),k==12&&z.qpro&&(C.l+=2),V.s.c==65535&&(V.s.c=V.e.c=V.s.r=V.e.r=0),V)}function l(C){var k=Se(8);return k.write_shift(2,C.s.c),k.write_shift(2,C.s.r),k.write_shift(2,C.e.c),k.write_shift(2,C.e.r),k}function u(C,k,z){var V=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(V[0].c=C.read_shift(1),V[3]=C.read_shift(1),V[0].r=C.read_shift(2),C.l+=2):(V[2]=C.read_shift(1),V[0].c=C.read_shift(2),V[0].r=C.read_shift(2)),V}function d(C,k,z){var V=C.l+k,Z=u(C,k,z);if(Z[1].t="s",z.vers==20768){C.l++;var ce=C.read_shift(1);return Z[1].v=C.read_shift(ce,"utf8"),Z}return z.qpro&&C.l++,Z[1].v=C.read_shift(V-C.l,"cstr"),Z}function f(C,k,z){var V=Se(7+z.length);V.write_shift(1,255),V.write_shift(2,k),V.write_shift(2,C),V.write_shift(1,39);for(var Z=0;Z<V.length;++Z){var ce=z.charCodeAt(Z);V.write_shift(1,ce>=128?95:ce)}return V.write_shift(1,0),V}function h(C,k,z){var V=u(C,k,z);return V[1].v=C.read_shift(2,"i"),V}function m(C,k,z){var V=Se(7);return V.write_shift(1,255),V.write_shift(2,k),V.write_shift(2,C),V.write_shift(2,z,"i"),V}function x(C,k,z){var V=u(C,k,z);return V[1].v=C.read_shift(8,"f"),V}function p(C,k,z){var V=Se(13);return V.write_shift(1,255),V.write_shift(2,k),V.write_shift(2,C),V.write_shift(8,z,"f"),V}function g(C,k,z){var V=C.l+k,Z=u(C,k,z);if(Z[1].v=C.read_shift(8,"f"),z.qpro)C.l=V;else{var ce=C.read_shift(2);_(C.slice(C.l,C.l+ce),Z),C.l+=ce}return Z}function v(C,k,z){var V=k&32768;return k&=-32769,k=(V?C:0)+(k>=8192?k-16384:k),(V?"":"$")+(z?lr(k):Nr(k))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(C,k){hn(C,0);for(var z=[],V=0,Z="",ce="",ie="",Q="";C.l<C.length;){var ne=C[C.l++];switch(ne){case 0:z.push(C.read_shift(8,"f"));break;case 1:ce=v(k[0].c,C.read_shift(2),!0),Z=v(k[0].r,C.read_shift(2),!1),z.push(ce+Z);break;case 2:{var pe=v(k[0].c,C.read_shift(2),!0),W=v(k[0].r,C.read_shift(2),!1);ce=v(k[0].c,C.read_shift(2),!0),Z=v(k[0].r,C.read_shift(2),!1),z.push(pe+W+":"+ce+Z)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(C.read_shift(2));break;case 6:{for(var re="";ne=C[C.l++];)re+=String.fromCharCode(ne);z.push('"'+re.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:Q=z.pop(),ie=z.pop(),z.push(["AND","OR"][ne-20]+"("+ie+","+Q+")");break;default:if(ne<32&&b[ne])Q=z.pop(),ie=z.pop(),z.push(ie+b[ne]+Q);else if(y[ne]){if(V=y[ne][1],V==69&&(V=C[C.l++]),V>z.length){console.error("WK1 bad formula parse 0x"+ne.toString(16)+":|"+z.join("|")+"|");return}var U=z.slice(-V);z.length-=V,z.push(y[ne][0]+"("+U.join(",")+")")}else return ne<=7?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=24?console.error("WK1 unsupported op "+ne.toString(16)):ne<=30?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=115?console.error("WK1 unsupported function opcode "+ne.toString(16)):console.error("WK1 unrecognized opcode "+ne.toString(16))}}z.length==1?k[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function w(C){var k=[{c:0,r:0},{t:"n",v:0},0];return k[0].r=C.read_shift(2),k[3]=C[C.l++],k[0].c=C[C.l++],k}function j(C,k){var z=w(C);return z[1].t="s",z[1].v=C.read_shift(k-4,"cstr"),z}function N(C,k,z,V){var Z=Se(6+V.length);Z.write_shift(2,C),Z.write_shift(1,z),Z.write_shift(1,k),Z.write_shift(1,39);for(var ce=0;ce<V.length;++ce){var ie=V.charCodeAt(ce);Z.write_shift(1,ie>=128?95:ie)}return Z.write_shift(1,0),Z}function D(C,k){var z=w(C);z[1].v=C.read_shift(2);var V=z[1].v>>1;if(z[1].v&1)switch(V&7){case 0:V=(V>>3)*5e3;break;case 1:V=(V>>3)*500;break;case 2:V=(V>>3)/20;break;case 3:V=(V>>3)/200;break;case 4:V=(V>>3)/2e3;break;case 5:V=(V>>3)/2e4;break;case 6:V=(V>>3)/16;break;case 7:V=(V>>3)/64;break}return z[1].v=V,z}function S(C,k){var z=w(C),V=C.read_shift(4),Z=C.read_shift(4),ce=C.read_shift(2);if(ce==65535)return V===0&&Z===3221225472?(z[1].t="e",z[1].v=15):V===0&&Z===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var ie=ce&32768;return ce=(ce&32767)-16446,z[1].v=(1-ie*2)*(Z*Math.pow(2,ce+32)+V*Math.pow(2,ce)),z}function T(C,k,z,V){var Z=Se(14);if(Z.write_shift(2,C),Z.write_shift(1,z),Z.write_shift(1,k),V==0)return Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(2,65535),Z;var ce=0,ie=0,Q=0,ne=0;return V<0&&(ce=1,V=-V),ie=Math.log2(V)|0,V/=Math.pow(2,ie-31),ne=V>>>0,ne&2147483648||(V/=2,++ie,ne=V>>>0),V-=ne,ne|=2147483648,ne>>>=0,V*=Math.pow(2,32),Q=V>>>0,Z.write_shift(4,Q),Z.write_shift(4,ne),ie+=16383+(ce?32768:0),Z.write_shift(2,ie),Z}function A(C,k){var z=S(C);return C.l+=k-14,z}function E(C,k){var z=w(C),V=C.read_shift(4);return z[1].v=V>>6,z}function M(C,k){var z=w(C),V=C.read_shift(8,"f");return z[1].v=V,z}function P(C,k){var z=M(C);return C.l+=k-10,z}function X(C,k){return C[C.l+k-1]==0?C.read_shift(k,"cstr"):""}function q(C,k){var z=C[C.l++];z>k-1&&(z=k-1);for(var V="";V.length<z;)V+=String.fromCharCode(C[C.l++]);return V}function B(C,k,z){if(!(!z.qpro||k<21)){var V=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var Z=C.read_shift(k-21,"cstr");return[V,Z]}}function O(C,k){for(var z={},V=C.l+k;C.l<V;){var Z=C.read_shift(2);if(Z==14e3){for(z[Z]=[0,""],z[Z][0]=C.read_shift(2);C[C.l];)z[Z][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return z}function F(C,k){var z=Se(5+C.length);z.write_shift(2,14e3),z.write_shift(2,k);for(var V=0;V<C.length;++V){var Z=C.charCodeAt(V);z[z.l++]=Z>127?95:Z}return z[z.l++]=0,z}var I={0:{n:"BOF",f:Rr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:X},222:{n:"SHEETNAMELP",f:q},65535:{n:""}},L={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:j},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:D},25:{n:"FORMULA19",f:A},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:O},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:E},38:{n:"??"},39:{n:"NUMBER27",f:M},40:{n:"FORMULA28",f:P},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:X},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:B},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function OEe(e){var t={},r=e.match(Rn),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=lt(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=z_[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var PEe=function(){var e=Ff("t"),t=Ff("rPr");function r(i){var o=i.match(e);if(!o)return{t:"s",v:""};var c={t:"s",v:Ot(o[1])},l=i.match(t);return l&&(c.s=OEe(l[1])),c}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(a).map(r).filter(function(c){return c.v})}}(),IEe=function(){var t=/(\r\n|\n)/g;function r(a,i,o){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),i.push('<span style="'+c.join("")+'">'),a.b&&(i.push("<b>"),o.push("</b>")),a.i&&(i.push("<i>"),o.push("</i>")),a.strike&&(i.push("<s>"),o.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(i.push("<"+l+">"),o.push("</"+l+">")),o.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),UEe=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,REe=/<(?:\w+:)?r>/,MEe=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function pj(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ot(Kt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Kt(e),r&&(n.h=Z_(n.t))):e.match(REe)&&(n.r=Kt(e),n.t=Ot(Kt((e.replace(MEe,"").match(UEe)||[]).join("").replace(Rn,""))),r&&(n.h=IEe(PEe(n.r)))),n):{t:""}}var BEe=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,LEe=/<(?:\w+:)?(?:si|sstItem)>/g,$Ee=/<\/(?:\w+:)?(?:si|sstItem)>/;function WEe(e,t){var r=[],n="";if(!e)return r;var a=e.match(BEe);if(a){n=a[2].replace(LEe,"").split($Ee);for(var i=0;i!=n.length;++i){var o=pj(n[i].trim(),t);o!=null&&(r[r.length]=o)}a=lt(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var zEe=/^\s|\s$|[\t\n\r]/;function NU(e,t){if(!t.bookSST)return"";var r=[Fr];r[r.length]=Le("sst",null,{xmlns:kc[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(zEe)&&(i+=' xml:space="preserve"'),i+=">"+zt(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function qEe(e){return[e.read_shift(4),e.read_shift(4)]}function HEe(e,t){var r=[],n=!1;return Rs(e,function(i,o,c){switch(c){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function VEe(e,t){return t||(t=Se(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var GEe=nDe;function XEe(e){var t=oa();Ae(t,159,VEe(e));for(var r=0;r<e.length;++r)Ae(t,19,GEe(e[r]));return Ae(t,160),t.end()}function DU(e){if(typeof Ct<"u")return Ct.utils.encode(pc,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ws(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function KEe(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ws(e,4),t.U=ws(e,4),t.W=ws(e,4),t}function YEe(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function ZEe(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(YEe(e));return t}function JEe(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function QEe(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ws(e,4),t.U=ws(e,4),t.W=ws(e,4),t}function eTe(e){var t=QEe(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function SU(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function EU(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function tTe(e){var t=ws(e);switch(t.Minor){case 2:return[t.Minor,rTe(e)];case 3:return[t.Minor,nTe()];case 4:return[t.Minor,aTe(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function rTe(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=SU(e,r),a=EU(e,e.length-e.l);return{t:"Std",h:n,v:a}}function nTe(){throw new Error("File is password-protected: ECMA-376 Extensible")}function aTe(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Rn,function(i){var o=lt(i);switch(Qi(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(c){n[c]=o[c]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function iTe(e,t){var r={},n=r.EncryptionVersionInfo=ws(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=SU(e,a),t-=a,r.EncryptionVerifier=EU(e,t),r}function sTe(e){var t={},r=t.EncryptionVersionInfo=ws(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function xj(e){var t=0,r,n=DU(e),a=n.length+1,i,o,c,l,u;for(r=fo(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)o=r[i],c=t&16384?1:0,l=t<<1&32767,u=c|l,t=u^o;return t^52811}var TU=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},a=function(o,c){return n(o^c)},i=function(o){for(var c=t[o.length-1],l=104,u=o.length-1;u>=0;--u)for(var d=o[u],f=0;f!=7;++f)d&64&&(c^=r[l]),d*=2,--l;return c};return function(o){for(var c=DU(o),l=i(c),u=c.length,d=fo(16),f=0;f!=16;++f)d[f]=0;var h,m,x;for((u&1)===1&&(h=l>>8,d[u]=a(e[0],h),--u,h=l&255,m=c[c.length-1],d[u]=a(m,h));u>0;)--u,h=l>>8,d[u]=a(c[u],h),--u,h=l&255,d[u]=a(c[u],h);for(u=15,x=15-c.length;x>0;)h=l>>8,d[u]=a(e[x],h),--u,--x,h=l&255,d[u]=a(c[u],h),--u,--x;return d}}(),oTe=function(e,t,r,n,a){a||(a=t),n||(n=TU(e));var i,o;for(i=0;i!=t.length;++i)o=t[i],o^=n[r],o=(o>>5|o<<3)&255,a[i]=o,++r;return[a,r,n]},cTe=function(e){var t=0,r=TU(e);return function(n){var a=oTe("",n,t,r);return t=a[1],a[0]}};function lTe(e,t,r,n){var a={key:Rr(e),verificationBytes:Rr(e)};return r.password&&(a.verifier=xj(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=cTe(r.password)),a}function uTe(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=sTe(e):n.Data=iTe(e,t),n}function dTe(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?uTe(e,t-2,n):lTe(e,r.biff>=8?t:t-2,r,n),n}var CU=function(){function e(a,i){switch(i.type){case"base64":return t(Aa(a),i);case"binary":return t(a,i);case"buffer":return t(_t&&Buffer.isBuffer(a)?a.toString("binary"):Do(a),i);case"array":return t(gc(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var o=i||{},c=o.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(d,f){Array.isArray(c)&&(c[f]=[]);for(var h=/\\\w+\b/g,m=0,x,p=-1;x=h.exec(d);){switch(x[0]){case"\\cell":var g=d.slice(m,h.lastIndex-x[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var v={v:g,t:"s"};Array.isArray(c)?c[f][p]=v:c[ot({r:f,c:p})]=v}break}m=h.lastIndex}p>u.e.c&&(u.e.c=p)}),c["!ref"]=xt(u),c}function r(a,i){return So(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],o=Dt(a["!ref"]),c,l=Array.isArray(a),u=o.s.r;u<=o.e.r;++u){i.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var f=ot({r:u,c:d});c=l?(a[u]||[])[d]:a[f],!(!c||c.v==null&&(!c.f||c.F))&&(i.push(" "+(c.w||(Yi(c),c.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function fTe(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Uf(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function hTe(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),o=a-i;if(o===0)return[0,0,t];var c=0,l=0,u=a+i;switch(l=o/(u>1?2-u:u),a){case t:c=((r-n)/o+6)%6;break;case r:c=(n-t)/o+2;break;case n:c=(t-r)/o+4;break}return[c/6,l,u/2]}function mTe(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,o=[i,i,i],c=6*t,l;if(r!==0)switch(c|0){case 0:case 6:l=a*c,o[0]+=a,o[1]+=l;break;case 1:l=a*(2-c),o[0]+=l,o[1]+=a;break;case 2:l=a*(c-2),o[1]+=a,o[2]+=l;break;case 3:l=a*(4-c),o[1]+=l,o[2]+=a;break;case 4:l=a*(c-4),o[2]+=a,o[0]+=l;break;case 5:l=a*(6-c),o[2]+=l,o[0]+=a;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function _x(e,t){if(t===0)return e;var r=hTe(fTe(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Uf(mTe(r))}var AU=6,pTe=15,xTe=1,Cn=AU;function Rf(e){return Math.floor((e+Math.round(128/Cn)/256)*Cn)}function Mf(e){return Math.floor((e-5)/Cn*100+.5)/100}function jx(e){return Math.round((e*Cn+5)/Cn*256)/256}function ly(e){return jx(Mf(Rf(e)))}function gj(e){var t=Math.abs(e-ly(e)),r=Cn;if(t>.005)for(Cn=xTe;Cn<pTe;++Cn)Math.abs(e-ly(e))<=t&&(t=Math.abs(e-ly(e)),r=Cn);Cn=r}function ho(e){e.width?(e.wpx=Rf(e.width),e.wch=Mf(e.wpx),e.MDW=Cn):e.wpx?(e.wch=Mf(e.wpx),e.width=jx(e.wch),e.MDW=Cn):typeof e.wch=="number"&&(e.width=jx(e.wch),e.wpx=Rf(e.width),e.MDW=Cn),e.customWidth&&delete e.customWidth}var gTe=96,kU=gTe;function Bf(e){return e*96/kU}function eu(e){return e*kU/96}var vTe={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function yTe(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(Rn)||[]).forEach(function(o){var c=lt(o);switch(Qi(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=cr(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=cr(c.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in borders")}})}function bTe(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(Rn)||[]).forEach(function(o){var c=lt(o);switch(Qi(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fills")}})}function wTe(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(Rn)||[]).forEach(function(o){var c=lt(o);switch(Qi(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=Kt(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?cr(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?cr(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?cr(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?cr(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?cr(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?cr(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?cr(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=z_[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=cr(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var l=ic[a.color.index];a.color.index==81&&(l=ic[1]),l||(l=ic[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=_x(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fonts")}})}function _Te(e,t,r){t.NumberFmt=[];for(var n=Er(at),a=0;a<n.length;++a)t.NumberFmt[n[a]]=at[n[a]];var i=e[0].match(Rn);if(i)for(a=0;a<i.length;++a){var o=lt(i[a]);switch(Qi(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Ot(Kt(o.formatCode)),l=parseInt(o.numFmtId,10);if(t.NumberFmt[l]=c,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=c}Hi(c,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function jTe(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Le("numFmt",null,{numFmtId:n,formatCode:zt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Le("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var _m=["numFmtId","fillId","fontId","borderId","xfId"],jm=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function NTe(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Rn)||[]).forEach(function(i){var o=lt(i),c=0;switch(Qi(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],c=0;c<_m.length;++c)n[_m[c]]&&(n[_m[c]]=parseInt(n[_m[c]],10));for(c=0;c<jm.length;++c)n[jm[c]]&&(n[jm[c]]=cr(n[jm[c]]));if(t.NumberFmt&&n.numFmtId>392){for(c=392;c>60;--c)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[c]){n.numFmtId=c;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};o.vertical&&(l.vertical=o.vertical),o.horizontal&&(l.horizontal=o.horizontal),o.textRotation!=null&&(l.textRotation=o.textRotation),o.indent&&(l.indent=o.indent),o.wrapText&&(l.wrapText=cr(o.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function DTe(e){var t=[];return t[t.length]=Le("cellXfs",null),e.forEach(function(r){t[t.length]=Le("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Le("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var STe=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,l,u){var d={};if(!c)return d;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=c.match(t))&&_Te(f,d,u),(f=c.match(a))&&wTe(f,d,l,u),(f=c.match(n))&&bTe(f,d,l,u),(f=c.match(i))&&yTe(f,d,l,u),(f=c.match(r))&&NTe(f,d,u),d}}();function FU(e,t){var r=[Fr,Le("styleSheet",null,{xmlns:kc[0],"xmlns:vt":qr.vt})],n;return e.SSF&&(n=jTe(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=DTe(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function ETe(e,t){var r=e.read_shift(2),n=Pn(e);return[r,n]}function TTe(e,t,r){r||(r=Se(6+4*t.length)),r.write_shift(2,e),en(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function CTe(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=uDe(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var c=e.read_shift(1);c>0&&(n.family=c);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=lDe(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Pn(e),n}function ATe(e,t){t||(t=Se(25+4*32)),t.write_shift(2,e.sz*20),dDe(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),yx(e.color,t);var n=0;return n=2,t.write_shift(1,n),en(e.name,t),t.length>t.l?t.slice(0,t.l):t}var kTe=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],uy,FTe=In;function _k(e,t){t||(t=Se(4*3+8*7+16*1)),uy||(uy=hg(kTe));var r=uy[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(yx({auto:1},t),yx({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function OTe(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function OU(e,t,r){r||(r=Se(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function sd(e,t){return t||(t=Se(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var PTe=In;function ITe(e,t){return t||(t=Se(51)),t.write_shift(1,0),sd(null,t),sd(null,t),sd(null,t),sd(null,t),sd(null,t),t.length>t.l?t.slice(0,t.l):t}function UTe(e,t){return t||(t=Se(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),vx(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function RTe(e,t,r){var n=Se(2052);return n.write_shift(4,e),vx(t,n),vx(r,n),n.length>n.l?n.slice(0,n.l):n}function MTe(e,t,r){var n={};n.NumberFmt=[];for(var a in at)n.NumberFmt[a]=at[a];n.CellXf=[],n.Fonts=[];var i=[],o=!1;return Rs(e,function(l,u,d){switch(d){case 44:n.NumberFmt[l[0]]=l[1],Hi(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=_x(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(d),o=!0;break;case 38:i.pop(),o=!1;break;default:if(u.T>0)i.push(d);else if(u.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function BTe(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(Ae(e,615,ji(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Ae(e,44,TTe(a,t[a]))}),Ae(e,616))}}function LTe(e){var t=1;Ae(e,611,ji(t)),Ae(e,43,ATe({sz:12,color:{theme:1},name:"Calibri",family:2})),Ae(e,612)}function $Te(e){var t=2;Ae(e,603,ji(t)),Ae(e,45,_k({patternType:"none"})),Ae(e,45,_k({patternType:"gray125"})),Ae(e,604)}function WTe(e){var t=1;Ae(e,613,ji(t)),Ae(e,46,ITe()),Ae(e,614)}function zTe(e){var t=1;Ae(e,626,ji(t)),Ae(e,47,OU({numFmtId:0},65535)),Ae(e,627)}function qTe(e,t){Ae(e,617,ji(t.length)),t.forEach(function(r){Ae(e,47,OU(r,0))}),Ae(e,618)}function HTe(e){var t=1;Ae(e,619,ji(t)),Ae(e,48,UTe({xfId:0,name:"Normal"})),Ae(e,620)}function VTe(e){var t=0;Ae(e,505,ji(t)),Ae(e,506)}function GTe(e){var t=0;Ae(e,508,RTe(t,"TableStyleMedium9","PivotStyleMedium4")),Ae(e,509)}function XTe(e,t){var r=oa();return Ae(r,278),BTe(r,e.SSF),LTe(r),$Te(r),WTe(r),zTe(r),qTe(r,t.cellXfs),HTe(r),VTe(r),GTe(r),Ae(r,279),r.end()}var KTe=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function YTe(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Rn)||[]).forEach(function(a){var i=lt(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[KTe.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function ZTe(){}function JTe(){}var QTe=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,eCe=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,tCe=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function rCe(e,t,r){t.themeElements={};var n;[["clrScheme",QTe,YTe],["fontScheme",eCe,ZTe],["fmtScheme",tCe,JTe]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var nCe=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function PU(e,t){(!e||e.length===0)&&(e=vj());var r,n={};if(!(r=e.match(nCe)))throw new Error("themeElements not found in theme");return rCe(r[0],n,t),n.raw=e,n}function vj(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Fr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function aCe(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var o;try{o=AI(i,{type:"array"})}catch{return}var c=_a(o,"theme/theme/theme1.xml",!0);if(c)return PU(c,r)}}function iCe(e){return e.read_shift(4)}function sCe(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=oCe(e,4);break;case 2:t.xclrValue=hU(e);break;case 3:t.xclrValue=iCe(e);break;case 4:e.l+=4;break}return e.l+=8,t}function oCe(e,t){return In(e,t)}function cCe(e,t){return In(e,t)}function lCe(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=sCe(e);break;case 6:n[1]=cCe(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function uCe(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(lCe(e,r-e.l));return{ixfe:n,ext:i}}function dCe(e,t){t.forEach(function(r){switch(r[0]){}})}function fCe(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Pn(e)}}function hCe(e){var t=Se(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),en(e.name,t),t.slice(0,t.l)}function mCe(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function pCe(e){var t=Se(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function xCe(e,t){var r=Se(8+2*t.length);return r.write_shift(4,e),en(t,r),r.slice(0,r.l)}function gCe(e){return e.l+=4,e.read_shift(4)!=0}function vCe(e,t){var r=Se(8);return r.write_shift(4,e),r.write_shift(4,1),r}function yCe(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],o=!1,c=2;return Rs(e,function(l,u,d){switch(d){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(f){c==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):c==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:c=l?1:0;break;case 338:c=2;break;case 35:i.push(d),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!u.T){if(!o||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function bCe(){var e=oa();return Ae(e,332),Ae(e,334,ji(1)),Ae(e,335,hCe({name:"XLDAPR",version:12e4,flags:3496657072})),Ae(e,336),Ae(e,339,xCe(1,"XLDAPR")),Ae(e,52),Ae(e,35,ji(514)),Ae(e,4096,ji(0)),Ae(e,4097,Va(1)),Ae(e,36),Ae(e,53),Ae(e,340),Ae(e,337,vCe(1)),Ae(e,51,pCe([[1,0]])),Ae(e,338),Ae(e,333),e.end()}function wCe(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,o;return e.replace(Rn,function(c){var l=lt(c);switch(Qi(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):i==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+l.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return c}),n}function IU(){var e=[Fr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function _Ce(e){var t=[];if(!e)return t;var r=1;return(e.match(Rn)||[]).forEach(function(n){var a=lt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function jCe(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ot(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function NCe(e,t,r){var n=[];return Rs(e,function(i,o,c){switch(c){case 63:n.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function DCe(e,t,r,n){if(!e)return e;var a=n||{},i=!1;Rs(e,function(c,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function SCe(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var ll=1024;function UU(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Le("xml",null,{"xmlns:v":ya.v,"xmlns:o":ya.o,"xmlns:x":ya.x,"xmlns:mv":ya.mv}).replace(/\/>/,">"),Le("o:shapelayout",Le("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Le("v:shapetype",[Le("v:stroke",null,{joinstyle:"miter"}),Le("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];ll<e*1e3;)ll+=1e3;return t.forEach(function(i){var o=yr(i[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var l=c.type=="gradient"?Le("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Le("v:fill",l,c),d={on:"t",obscured:"t"};++ll,a=a.concat(["<v:shape"+Of({id:"_x0000_s"+ll,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Le("v:shadow",null,d),Le("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",mn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),mn("x:AutoFill","False"),mn("x:Row",String(o.r)),mn("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function jk(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(o){var c=yr(o.ref);if(a?(e[c.r]||(e[c.r]=[]),i=e[c.r][c.c]):i=e[o.ref],!i){i={t:"z"},a?e[c.r][c.c]=i:e[o.ref]=i;var l=Dt(e["!ref"]||"BDWGO1000001:A1");l.s.r>c.r&&(l.s.r=c.r),l.e.r<c.r&&(l.e.r=c.r),l.s.c>c.c&&(l.s.c=c.c),l.e.c<c.c&&(l.e.c=c.c);var u=xt(l);u!==e["!ref"]&&(e["!ref"]=u)}i.c||(i.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}i.c.push(d)})}function ECe(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?comment[^>]*>/);if(c){var l=lt(c[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},d=yr(l.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&pj(f[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function RU(e){var t=[Fr,Le("comments",null,{xmlns:kc[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=zt(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(a=r.indexOf(zt(l.a))),i.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(mn("t",zt(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,c=1;c<i.length;++c)o+=`Reply:
    `+i[c]+`
`;t.push(mn("t",zt(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function TCe(e,t){var r=[],n=!1,a={},i=0;return e.replace(Rn,function(c,l){var u=lt(c);switch(Qi(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=l+c.length;break;case"</text>":a.t=e.slice(i,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return c}),r}function CCe(e,t,r){var n=[Fr,Le("ThreadedComments",null,{xmlns:qr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(o,c){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var l={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};c==0?i=l.id:l.parentId=i,o.ID=l.id,o.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(Le("threadedComment",mn("text",o.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function ACe(e,t){var r=[],n=!1;return e.replace(Rn,function(i){var o=lt(i);switch(Qi(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function kCe(e){var t=[Fr,Le("personList",null,{xmlns:qr.TCMNT,"xmlns:x":kc[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Le("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function FCe(e){var t={};t.iauthor=e.read_shift(4);var r=Ic(e);return t.rfx=r.s,t.ref=ot(r.s),e.l+=16,t}function OCe(e,t){return t==null&&(t=Se(36)),t.write_shift(4,e[1].iauthor),Iu(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var PCe=Pn;function ICe(e){return en(e.slice(0,54))}function UCe(e,t){var r=[],n=[],a={},i=!1;return Rs(e,function(c,l,u){switch(u){case 632:n.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function RCe(e){var t=oa(),r=[];return Ae(t,628),Ae(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Ae(t,632,ICe(a.a)))})}),Ae(t,631),Ae(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:yr(n[0]),e:yr(n[0])};Ae(t,635,OCe([i,a])),a.t&&a.t.length>0&&Ae(t,637,iDe(a)),Ae(t,636),delete a.iauthor})}),Ae(t,634),Ae(t,629),t.end()}var MCe="application/vnd.ms-office.vbaProject";function BCe(e){var t=et.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");et.utils.cfb_add(t,a,e.FileIndex[n].content)}}),et.write(t)}function LCe(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&et.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var MU=["xlsb","xlsm","xlam","biff8","xla"];function $Ce(){return{"!type":"dialog"}}function WCe(){return{"!type":"dialog"}}function zCe(){return{"!type":"macro"}}function qCe(){return{"!type":"macro"}}var yl=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,o){var c=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return c?d+=t.c:--d,l?u+=t.r:--u,a+(c?"":"$")+lr(d)+(l?"":"$")+Nr(u)}return function(a,i){return t=i,a.replace(e,r)}}(),yj=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,bj=function(){return function(t,r){return t.replace(yj,function(n,a,i,o,c,l){var u=sj(o)-(i?0:r.c),d=ij(l)-(c?0:r.r),f=d==0?"":c?d+1:"["+d+"]",h=u==0?"":i?u+1:"["+u+"]";return a+"R"+f+"C"+h})}}();function BU(e,t){return e.replace(yj,function(r,n,a,i,o,c){return n+(a=="$"?a+i:lr(sj(i)+t.c))+(o=="$"?o+c:Nr(ij(c)+t.r))})}function HCe(e,t,r){var n=Gn(t),a=n.s,i=yr(r),o={r:i.r-a.r,c:i.c-a.c};return BU(e,o)}function VCe(e){return e.length!=1}function Nk(e){return e.replace(/_xlfn\./g,"")}function Pr(e){e.l+=1}function mo(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function LU(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return $U(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),o=mo(e),c=mo(e);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function $U(e){var t=mo(e),r=mo(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function GCe(e,t,r){if(r.biff<8)return $U(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=mo(e),o=mo(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function WU(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return XCe(e);var n=e.read_shift(r&&r.biff==12?4:2),a=mo(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function XCe(e){var t=mo(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function KCe(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function YCe(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return ZCe(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;a>524287;)a-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:o,rRel:c}}function ZCe(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function JCe(e,t,r){var n=(e[e.l++]&96)>>5,a=LU(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function QCe(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=LU(e,i,r);return[n,a,o]}function eAe(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function tAe(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function rAe(e,t,r){var n=(e[e.l++]&96)>>5,a=GCe(e,t-1,r);return[n,a]}function nAe(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Dk(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function aAe(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function iAe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function sAe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function oAe(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function cAe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function zU(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function lAe(e){return e.read_shift(2),zU(e)}function uAe(e){return e.read_shift(2),zU(e)}function dAe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=WU(e,0,r);return[n,a]}function fAe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=YCe(e,0,r);return[n,a]}function hAe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=WU(e,0,r);return[n,a,i]}function mAe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[gke[a],VU[a],n]}function pAe(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:xAe(e);return[a,(i[0]===0?VU:xke)[i[1]]]}function xAe(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function gAe(e,t,r){e.l+=r&&r.biff==2?3:4}function vAe(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function yAe(e){return e.l++,Ms[e.read_shift(1)]}function bAe(e){return e.l++,e.read_shift(2)}function wAe(e){return e.l++,e.read_shift(1)!==0}function _Ae(e){return e.l++,kn(e)}function jAe(e,t,r){return e.l++,Fh(e,t-1,r)}function NAe(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Cr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ms[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=kn(e);break;case 2:r[1]=Uc(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function DAe(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?Ic:gg)(e));return a}function SAe(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var c=0;c!=a;++c)o[i][c]=NAe(e,r.biff);return o}function EAe(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function TAe(e,t,r){if(r.biff==5)return CAe(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function CAe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function AAe(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function kAe(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function FAe(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function OAe(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var PAe=In,IAe=In,UAe=In;function Ph(e,t,r){return e.l+=2,[KCe(e)]}function wj(e){return e.l+=6,[]}var RAe=Ph,MAe=wj,BAe=wj,LAe=Ph;function qU(e){return e.l+=2,[Rr(e),e.read_shift(2)&1]}var $Ae=Ph,WAe=qU,zAe=wj,qAe=Ph,HAe=Ph,VAe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function GAe(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),o=VAe[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:a,C:i}}function XAe(e){return e.l+=2,[e.read_shift(4)]}function KAe(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function YAe(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function ZAe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function JAe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function QAe(e){return e.l+=4,[0,0]}var Sk={1:{n:"PtgExp",f:vAe},2:{n:"PtgTbl",f:UAe},3:{n:"PtgAdd",f:Pr},4:{n:"PtgSub",f:Pr},5:{n:"PtgMul",f:Pr},6:{n:"PtgDiv",f:Pr},7:{n:"PtgPower",f:Pr},8:{n:"PtgConcat",f:Pr},9:{n:"PtgLt",f:Pr},10:{n:"PtgLe",f:Pr},11:{n:"PtgEq",f:Pr},12:{n:"PtgGe",f:Pr},13:{n:"PtgGt",f:Pr},14:{n:"PtgNe",f:Pr},15:{n:"PtgIsect",f:Pr},16:{n:"PtgUnion",f:Pr},17:{n:"PtgRange",f:Pr},18:{n:"PtgUplus",f:Pr},19:{n:"PtgUminus",f:Pr},20:{n:"PtgPercent",f:Pr},21:{n:"PtgParen",f:Pr},22:{n:"PtgMissArg",f:Pr},23:{n:"PtgStr",f:jAe},26:{n:"PtgSheet",f:KAe},27:{n:"PtgEndSheet",f:YAe},28:{n:"PtgErr",f:yAe},29:{n:"PtgBool",f:wAe},30:{n:"PtgInt",f:bAe},31:{n:"PtgNum",f:_Ae},32:{n:"PtgArray",f:nAe},33:{n:"PtgFunc",f:mAe},34:{n:"PtgFuncVar",f:pAe},35:{n:"PtgName",f:EAe},36:{n:"PtgRef",f:dAe},37:{n:"PtgArea",f:JCe},38:{n:"PtgMemArea",f:AAe},39:{n:"PtgMemErr",f:PAe},40:{n:"PtgMemNoMem",f:IAe},41:{n:"PtgMemFunc",f:kAe},42:{n:"PtgRefErr",f:FAe},43:{n:"PtgAreaErr",f:eAe},44:{n:"PtgRefN",f:fAe},45:{n:"PtgAreaN",f:rAe},46:{n:"PtgMemAreaN",f:ZAe},47:{n:"PtgMemNoMemN",f:JAe},57:{n:"PtgNameX",f:TAe},58:{n:"PtgRef3d",f:hAe},59:{n:"PtgArea3d",f:QCe},60:{n:"PtgRefErr3d",f:OAe},61:{n:"PtgAreaErr3d",f:tAe},255:{}},eke={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},tke={1:{n:"PtgElfLel",f:qU},2:{n:"PtgElfRw",f:qAe},3:{n:"PtgElfCol",f:RAe},6:{n:"PtgElfRwV",f:HAe},7:{n:"PtgElfColV",f:LAe},10:{n:"PtgElfRadical",f:$Ae},11:{n:"PtgElfRadicalS",f:zAe},13:{n:"PtgElfColS",f:MAe},15:{n:"PtgElfColSV",f:BAe},16:{n:"PtgElfRadicalLel",f:WAe},25:{n:"PtgList",f:GAe},29:{n:"PtgSxName",f:XAe},255:{}},rke={0:{n:"PtgAttrNoop",f:QAe},1:{n:"PtgAttrSemi",f:cAe},2:{n:"PtgAttrIf",f:sAe},4:{n:"PtgAttrChoose",f:aAe},8:{n:"PtgAttrGoto",f:iAe},16:{n:"PtgAttrSum",f:gAe},32:{n:"PtgAttrBaxcel",f:Dk},33:{n:"PtgAttrBaxcel",f:Dk},64:{n:"PtgAttrSpace",f:lAe},65:{n:"PtgAttrSpaceSemi",f:uAe},128:{n:"PtgAttrIfError",f:oAe},255:{}};function Ih(e,t,r,n){if(n.biff<8)return In(e,t);for(var a=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=SAe(e,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=DAe(e,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=a-e.l,t!==0&&i.push(In(e,t)),i}function Uh(e,t,r){for(var n=e.l+t,a,i,o=[];n!=e.l;)t=n-e.l,i=e[e.l],a=Sk[i]||Sk[eke[i]],(i===24||i===25)&&(a=(i===24?tke:rke)[e[e.l+1]]),!a||!a.f?In(e,t):o.push([a.n,a.f(e,t,r)]);return o}function nke(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var o=n[i];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var ake={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function ike(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function HU(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Ek(e,t,r){var n=HU(e,t,r);return n=="#REF"?n:ike(n,r)}function En(e,t,r,n,a){var i=a&&a.biff||8,o={s:{c:0,r:0}},c=[],l,u,d,f=0,h=0,m,x="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",v=0,y=e[0].length;v<y;++v){var b=e[0][v];switch(b[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=c.pop(),u=c.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=wr(" ",e[0][p][1][1]);break;case 1:g=wr("\r",e[0][p][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}u=u+g,p=-1}c.push(u+ake[b[0]]+l);break;case"PtgIsect":l=c.pop(),u=c.pop(),c.push(u+" "+l);break;case"PtgUnion":l=c.pop(),u=c.pop(),c.push(u+","+l);break;case"PtgRange":l=c.pop(),u=c.pop(),c.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=kd(b[1][1],o,a),c.push(Fd(d,i));break;case"PtgRefN":d=r?kd(b[1][1],r,a):b[1][1],c.push(Fd(d,i));break;case"PtgRef3d":f=b[1][1],d=kd(b[1][2],o,a),x=Ek(n,f,a),c.push(x+"!"+Fd(d,i));break;case"PtgFunc":case"PtgFuncVar":var _=b[1][0],w=b[1][1];_||(_=0),_&=127;var j=_==0?[]:c.slice(-_);c.length-=_,w==="User"&&(w=j.shift()),c.push(w+"("+j.join(",")+")");break;case"PtgBool":c.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(b[1]);break;case"PtgNum":c.push(String(b[1]));break;case"PtgStr":c.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(b[1]);break;case"PtgAreaN":m=rk(b[1][1],r?{s:r}:o,a),c.push(sy(m,a));break;case"PtgArea":m=rk(b[1][1],o,a),c.push(sy(m,a));break;case"PtgArea3d":f=b[1][1],m=b[1][2],x=Ek(n,f,a),c.push(x+"!"+sy(m,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=b[1][2];var N=(n.names||[])[h-1]||(n[0]||[])[h],D=N?N.Name:"SH33TJSNAME"+String(h);D&&D.slice(0,6)=="_xlfn."&&!a.xlfn&&(D=D.slice(6)),c.push(D);break;case"PtgNameX":var S=b[1][1];h=b[1][2];var T;if(a.biff<=5)S<0&&(S=-S),n[S]&&(T=n[S][h]);else{var A="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][h]&&n[S][h].itab>0&&(A=n.SheetNames[n[S][h].itab-1]+"!"):A=n.SheetNames[h-1]+"!"),n[S]&&n[S][h])A+=n[S][h].Name;else if(n[0]&&n[0][h])A+=n[0][h].Name;else{var E=(HU(n,S,a)||"").split(";;");E[h-1]?A=E[h-1]:A+="SH33TJSERRX"}c.push(A);break}T||(T={Name:"SH33TJSERRY"}),c.push(T.Name);break;case"PtgParen":var M="(",P=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:M=wr(" ",e[0][p][1][1])+M;break;case 3:M=wr("\r",e[0][p][1][1])+M;break;case 4:P=wr(" ",e[0][p][1][1])+P;break;case 5:P=wr("\r",e[0][p][1][1])+P;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}c.push(M+c.pop()+P);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":d={c:b[1][1],r:b[1][0]};var X={c:r.c,r:r.r};if(n.sharedf[ot(d)]){var q=n.sharedf[ot(d)];c.push(En(q,o,X,n,a))}else{var B=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){c.push(En(u[1],o,X,n,a)),B=!0;break}B||c.push(b[1])}break;case"PtgArray":c.push("{"+nke(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var O=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&p>=0&&O.indexOf(e[0][v][0])==-1){b=e[0][p];var F=!0;switch(b[1][0]){case 4:F=!1;case 0:g=wr(" ",b[1][1]);break;case 5:F=!1;case 1:g=wr("\r",b[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}c.push((F?g:"")+c.pop()+(F?"":g)),p=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function ske(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,o=e.read_shift(a);if(o==65535)return[[],In(e,t-2)];var c=Uh(e,o,r);return t!==o+a&&(i=Ih(e,t-o-a,c,r)),e.l=n,[c,i]}function oke(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,o=e.read_shift(a);if(o==65535)return[[],In(e,t-2)];var c=Uh(e,o,r);return t!==o+a&&(i=Ih(e,t-o-a,c,r)),e.l=n,[c,i]}function cke(e,t,r,n){var a=e.l+t,i=Uh(e,n,r),o;return a!==e.l&&(o=Ih(e,a-e.l,i,r)),[i,o]}function lke(e,t,r){var n=e.l+t,a,i=e.read_shift(2),o=Uh(e,i,r);return i==65535?[[],In(e,t-2)]:(t!==i+2&&(a=Ih(e,n-i-2,o,r)),[o,a])}function uke(e){var t;if(xs(e,e.l+6)!==65535)return[kn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function dke(e){if(e==null){var t=Se(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return vc(e);return vc(0)}function dy(e,t,r){var n=e.l+t,a=es(e);r.biff==2&&++e.l;var i=uke(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var c=oke(e,n-e.l,r);return{cell:a,val:i[0],formula:c,shared:o>>3&1,tt:i[1]}}function fke(e,t,r,n,a){var i=bc(t,r,a),o=dke(e.v),c=Se(6),l=33;c.write_shift(2,l),c.write_shift(4,0);for(var u=Se(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=Qr([i,o,c,u]);return f}function vg(e,t,r){var n=e.read_shift(4),a=Uh(e,n,r),i=e.read_shift(4),o=i>0?Ih(e,i,a,r):null;return[a,o]}var hke=vg,yg=vg,mke=vg,pke=vg,xke={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},VU={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},gke={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Tk(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function vke(e){var t="of:="+e.replace(yj,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function fy(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function yke(e){return e.replace(/\./,"!")}var Pd={},bl={},Id=typeof Map<"u";function _j(e,t,r){var n=0,a=e.length;if(r){if(Id?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Id?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Id?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function bg(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Cn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Mf(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=jx(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function cc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Eo(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){Hi(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function GU(e,t,r,n,a,i){try{n.cellNF&&(e.z=at[t])}catch(c){if(n.WTF)throw c}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=ur(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(at[t]==null&&Hi(pNe[t]||"General",t),e.t==="e")e.w=e.w||Ms[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=kf(e.v);else if(e.t==="d"){var o=Vr(e.v);(o|0)===o?e.w=o.toString(10):e.w=kf(o)}else{if(e.v===void 0)return"";e.w=xc(e.v,bl)}else e.t==="d"?e.w=ka(t,Vr(e.v),bl):e.w=ka(t,e.v,bl)}catch(c){if(n.WTF)throw c}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=_x(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=_x(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(n.WTF&&i.Fills)throw c}}}function bke(e,t,r){if(e&&e["!ref"]){var n=Dt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function wke(e,t){var r=Dt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=xt(r))}var _ke=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,jke=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Nke=/<(?:\w:)?hyperlink [^>]*>/mg,Dke=/"(\w*:\w*)"/,Ske=/<(?:\w:)?col\b[^>]*[\/]?>/g,Eke=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Tke=/<(?:\w:)?pageMargins[^>]*\/>/g,XU=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Cke=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Ake=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function kke(e,t,r,n,a,i,o){if(!e)return e;n||(n={"!id":{}});var c=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(jke);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var h=u.match(XU);h?jj(h[0],c,a,r):(h=u.match(Cke))&&Oke(h[0],h[1]||"",c,a,r);var m=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var x=u.slice(m,m+50).match(Dke);x&&wke(c,x[1])}var p=u.match(Ake);p&&p[1]&&Vke(p[1],a);var g=[];if(t.cellStyles){var v=u.match(Ske);v&&$ke(g,v)}f&&Kke(f[1],c,t,l,i,o);var y=d.match(Eke);y&&(c["!autofilter"]=zke(y[0]));var b=[],_=d.match(_ke);if(_)for(m=0;m!=_.length;++m)b[m]=Dt(_[m].slice(_[m].indexOf('"')+1));var w=d.match(Nke);w&&Mke(c,w,n);var j=d.match(Tke);if(j&&(c["!margins"]=Bke(lt(j[0]))),!c["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(c["!ref"]=xt(l)),t.sheetRows>0&&c["!ref"]){var N=Dt(c["!ref"]);t.sheetRows<=+N.e.r&&(N.e.r=t.sheetRows-1,N.e.r>l.e.r&&(N.e.r=l.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>l.e.c&&(N.e.c=l.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),c["!fullref"]=c["!ref"],c["!ref"]=xt(N))}return g.length>0&&(c["!cols"]=g),b.length>0&&(c["!merges"]=b),c}function Fke(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+xt(e[r])+'"/>';return t+"</mergeCells>"}function jj(e,t,r,n){var a=lt(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Ot(Kt(a.codeName)))}function Oke(e,t,r,n,a){jj(e.slice(0,e.indexOf(">")),r,n,a)}function Pke(e,t,r,n,a){var i=!1,o={},c=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}i=!0,o.codeName=Wi(zt(l))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),c=(c||"")+Le("outlinePr",null,u)}!i&&!c||(a[a.length]=Le("sheetPr",c,o))}var Ike=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Uke=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Rke(e){var t={sheet:1};return Ike.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),Uke.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=xj(e.password).toString(16).toUpperCase()),Le("sheetProtection",null,t)}function Mke(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=lt(Kt(t[a]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+Ot(i.location))):(i.Target="#"+Ot(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var c=Dt(i.ref),l=c.s.r;l<=c.e.r;++l)for(var u=c.s.c;u<=c.e.c;++u){var d=ot({c:u,r:l});n?(e[l]||(e[l]=[]),e[l][u]||(e[l][u]={t:"z",v:void 0}),e[l][u].l=i):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=i)}}}function Bke(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function Lke(e){return cc(e),Le("pageMargins",null,e)}function $ke(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=lt(t[n],!0);a.hidden&&(a.hidden=cr(a.hidden));var i=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,gj(a.width)),ho(a);i<=o;)e[i++]=Zt(a)}}function Wke(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Le("col",null,bg(a,n)));return r[r.length]="</cols>",r.join("")}function zke(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function qke(e,t,r,n){var a=typeof e.ref=="string"?e.ref:xt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Gn(a);o.s.r==o.e.r&&(o.e.r=Gn(t["!ref"]).e.r,a=xt(o));for(var c=0;c<i.length;++c){var l=i[c];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Le("autoFilter",null,{ref:a})}var Hke=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Vke(e,t){t.Views||(t.Views=[{}]),(e.match(Hke)||[]).forEach(function(r,n){var a=lt(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),cr(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function Gke(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Le("sheetViews",Le("sheetView",null,a),{})}function Xke(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Ms[e.v];break;case"d":n&&n.cellDates?a=ur(e.v,-1).toISOString():(e=Zt(e),e.t="n",a=""+(e.v=Vr(ur(e.v)))),typeof e.z>"u"&&(e.z=at[14]);break;default:a=e.v;break}var c=mn("v",zt(a)),l={r:t},u=Eo(n.cellXfs,e,n);switch(u!==0&&(l.s=u),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){c=mn("v",""+_j(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=i&&(e.t=i,e.v=o),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;c=Le("f",zt(e.f),d)+(e.v!=null?c:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),Le("c",c,l)}var Kke=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=Ff("v"),o=Ff("f");return function(l,u,d,f,h,m){for(var x=0,p="",g=[],v=[],y=0,b=0,_=0,w="",j,N,D=0,S=0,T,A,E=0,M=0,P=Array.isArray(m.CellXf),X,q=[],B=[],O=Array.isArray(u),F=[],I={},L=!1,C=!!d.sheetStubs,k=l.split(t),z=0,V=k.length;z!=V;++z){p=k[z].trim();var Z=p.length;if(Z!==0){var ce=0;e:for(x=0;x<Z;++x)switch(p[x]){case">":if(p[x-1]!="/"){++x;break e}if(d&&d.cellStyles){if(N=lt(p.slice(ce,x),!0),D=N.r!=null?parseInt(N.r,10):D+1,S=-1,d.sheetRows&&d.sheetRows<D)continue;I={},L=!1,N.ht&&(L=!0,I.hpt=parseFloat(N.ht),I.hpx=eu(I.hpt)),N.hidden=="1"&&(L=!0,I.hidden=!0),N.outlineLevel!=null&&(L=!0,I.level=+N.outlineLevel),L&&(F[D-1]=I)}break;case"<":ce=x;break}if(ce>=x)break;if(N=lt(p.slice(ce,x),!0),D=N.r!=null?parseInt(N.r,10):D+1,S=-1,!(d.sheetRows&&d.sheetRows<D)){f.s.r>D-1&&(f.s.r=D-1),f.e.r<D-1&&(f.e.r=D-1),d&&d.cellStyles&&(I={},L=!1,N.ht&&(L=!0,I.hpt=parseFloat(N.ht),I.hpx=eu(I.hpt)),N.hidden=="1"&&(L=!0,I.hidden=!0),N.outlineLevel!=null&&(L=!0,I.level=+N.outlineLevel),L&&(F[D-1]=I)),g=p.slice(x).split(e);for(var ie=0;ie!=g.length&&g[ie].trim().charAt(0)=="<";++ie);for(g=g.slice(ie),x=0;x!=g.length;++x)if(p=g[x].trim(),p.length!==0){if(v=p.match(r),y=x,b=0,_=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,v!=null&&v.length===2){for(y=0,w=v[1],b=0;b!=w.length&&!((_=w.charCodeAt(b)-64)<1||_>26);++b)y=26*y+_;--y,S=y}else++S;for(b=0;b!=p.length&&p.charCodeAt(b)!==62;++b);if(++b,N=lt(p.slice(0,b),!0),N.r||(N.r=ot({r:D-1,c:S})),w=p.slice(b),j={t:""},(v=w.match(i))!=null&&v[1]!==""&&(j.v=Ot(v[1])),d.cellFormula){if((v=w.match(o))!=null&&v[1]!==""){if(j.f=Ot(Kt(v[1])).replace(/\r\n/g,`
`),d.xlfn||(j.f=Nk(j.f)),v[0].indexOf('t="array"')>-1)j.F=(w.match(a)||[])[1],j.F.indexOf(":")>-1&&q.push([Dt(j.F),j.F]);else if(v[0].indexOf('t="shared"')>-1){A=lt(v[0]);var Q=Ot(Kt(v[1]));d.xlfn||(Q=Nk(Q)),B[parseInt(A.si,10)]=[A,Q,N.r]}}else(v=w.match(/<f[^>]*\/>/))&&(A=lt(v[0]),B[A.si]&&(j.f=HCe(B[A.si][1],B[A.si][2],N.r)));var ne=yr(N.r);for(b=0;b<q.length;++b)ne.r>=q[b][0].s.r&&ne.r<=q[b][0].e.r&&ne.c>=q[b][0].s.c&&ne.c<=q[b][0].e.c&&(j.F=q[b][1])}if(N.t==null&&j.v===void 0)if(j.f||j.F)j.v=0,j.t="n";else if(C)j.t="z";else continue;else j.t=N.t||"n";switch(f.s.c>S&&(f.s.c=S),f.e.c<S&&(f.e.c=S),j.t){case"n":if(j.v==""||j.v==null){if(!C)continue;j.t="z"}else j.v=parseFloat(j.v);break;case"s":if(typeof j.v>"u"){if(!C)continue;j.t="z"}else T=Pd[parseInt(j.v,10)],j.v=T.t,j.r=T.r,d.cellHTML&&(j.h=T.h);break;case"str":j.t="s",j.v=j.v!=null?Kt(j.v):"",d.cellHTML&&(j.h=Z_(j.v));break;case"inlineStr":v=w.match(n),j.t="s",v!=null&&(T=pj(v[1]))?(j.v=T.t,d.cellHTML&&(j.h=T.h)):j.v="";break;case"b":j.v=cr(j.v);break;case"d":d.cellDates?j.v=ur(j.v,1):(j.v=Vr(ur(j.v,1)),j.t="n");break;case"e":(!d||d.cellText!==!1)&&(j.w=j.v),j.v=YI[j.v];break}if(E=M=0,X=null,P&&N.s!==void 0&&(X=m.CellXf[N.s],X!=null&&(X.numFmtId!=null&&(E=X.numFmtId),d.cellStyles&&X.fillId!=null&&(M=X.fillId))),GU(j,E,M,d,h,m),d.cellDates&&P&&j.t=="n"&&Ac(at[E])&&(j.t="d",j.v=pg(j.v)),N.cm&&d.xlmeta){var pe=(d.xlmeta.Cell||[])[+N.cm-1];pe&&pe.type=="XLDAPR"&&(j.D=!0)}if(O){var W=yr(N.r);u[W.r]||(u[W.r]=[]),u[W.r][W.c]=j}else u[N.r]=j}}}}F.length>0&&(u["!rows"]=F)}}();function Yke(e,t,r,n){var a=[],i=[],o=Dt(e["!ref"]),c="",l,u="",d=[],f=0,h=0,m=e["!rows"],x=Array.isArray(e),p={r:u},g,v=-1;for(h=o.s.c;h<=o.e.c;++h)d[h]=lr(h);for(f=o.s.r;f<=o.e.r;++f){for(i=[],u=Nr(f),h=o.s.c;h<=o.e.c;++h){l=d[h]+u;var y=x?(e[f]||[])[h]:e[l];y!==void 0&&(c=Xke(y,l,e,t))!=null&&i.push(c)}(i.length>0||m&&m[f])&&(p={r:u},m&&m[f]&&(g=m[f],g.hidden&&(p.hidden=1),v=-1,g.hpx?v=Bf(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(p.ht=v,p.customHeight=1),g.level&&(p.outlineLevel=g.level)),a[a.length]=Le("row",i.join(""),p))}if(m)for(;f<m.length;++f)m&&m[f]&&(p={r:f+1},g=m[f],g.hidden&&(p.hidden=1),v=-1,g.hpx?v=Bf(g.hpx):g.hpt&&(v=g.hpt),v>-1&&(p.ht=v,p.customHeight=1),g.level&&(p.outlineLevel=g.level),a[a.length]=Le("row","",p));return a.join("")}function KU(e,t,r,n){var a=[Fr,Le("worksheet",null,{xmlns:kc[0],"xmlns:r":qr.r})],i=r.SheetNames[e],o=0,c="",l=r.Sheets[i];l==null&&(l={});var u=l["!ref"]||"A1",d=Dt(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=xt(d)}n||(n={}),l["!comments"]=[];var f=[];Pke(l,r,e,t,a),a[a.length]=Le("dimension",null,{ref:u}),a[a.length]=Gke(l,t,e,r),t.sheetFormat&&(a[a.length]=Le("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(a[a.length]=Wke(l,l["!cols"])),a[o=a.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(c=Yke(l,t),c.length>0&&(a[a.length]=c)),a.length>o+1&&(a[a.length]="</sheetData>",a[o]=a[o].replace("/>",">")),l["!protect"]&&(a[a.length]=Rke(l["!protect"])),l["!autofilter"]!=null&&(a[a.length]=qke(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(a[a.length]=Fke(l["!merges"]));var h=-1,m,x=-1;return l["!links"].length>0&&(a[a.length]="<hyperlinks>",l["!links"].forEach(function(p){p[1].Target&&(m={ref:p[0]},p[1].Target.charAt(0)!="#"&&(x=$t(n,-1,zt(p[1].Target).replace(/#.*$/,""),jt.HLINK),m["r:id"]="rId"+x),(h=p[1].Target.indexOf("#"))>-1&&(m.location=zt(p[1].Target.slice(h+1))),p[1].Tooltip&&(m.tooltip=zt(p[1].Tooltip)),a[a.length]=Le("hyperlink",null,m))}),a[a.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(a[a.length]=Lke(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=mn("ignoredErrors",Le("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(x=$t(n,-1,"../drawings/drawing"+(e+1)+".xml",jt.DRAW),a[a.length]=Le("drawing",null,{"r:id":"rId"+x}),l["!drawing"]=f),l["!comments"].length>0&&(x=$t(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",jt.VML),a[a.length]=Le("legacyDrawing",null,{"r:id":"rId"+x}),l["!legacy"]=x),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function Zke(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function Jke(e,t,r){var n=Se(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=Bf(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var o=0;a.level&&(o|=a.level),a.hidden&&(o|=16),(a.hpx||a.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var c=0,l=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,h=-1,m=d<<10;m<d+1<<10;++m){u.c=m;var x=Array.isArray(r)?(r[u.r]||[])[u.c]:r[ot(u)];x&&(f<0&&(f=m),h=m)}f<0||(++c,n.write_shift(4,f),n.write_shift(4,h))}var p=n.l;return n.l=l,n.write_shift(4,c),n.l=p,n.length>n.l?n.slice(0,n.l):n}function Qke(e,t,r,n){var a=Jke(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&Ae(e,0,a)}var e3e=Ic,t3e=Iu;function r3e(){}function n3e(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=sDe(e),r}function a3e(e,t,r){r==null&&(r=Se(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return yx({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),HI(e,r),r.slice(0,r.l)}function i3e(e){var t=li(e);return[t]}function s3e(e,t,r){return r==null&&(r=Se(8)),Fc(t,r)}function o3e(e){var t=Oc(e);return[t]}function c3e(e,t,r){return r==null&&(r=Se(4)),Pc(t,r)}function l3e(e){var t=li(e),r=e.read_shift(1);return[t,r,"b"]}function u3e(e,t,r){return r==null&&(r=Se(9)),Fc(t,r),r.write_shift(1,e.v?1:0),r}function d3e(e){var t=Oc(e),r=e.read_shift(1);return[t,r,"b"]}function f3e(e,t,r){return r==null&&(r=Se(5)),Pc(t,r),r.write_shift(1,e.v?1:0),r}function h3e(e){var t=li(e),r=e.read_shift(1);return[t,r,"e"]}function m3e(e,t,r){return r==null&&(r=Se(9)),Fc(t,r),r.write_shift(1,e.v),r}function p3e(e){var t=Oc(e),r=e.read_shift(1);return[t,r,"e"]}function x3e(e,t,r){return r==null&&(r=Se(8)),Pc(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function g3e(e){var t=li(e),r=e.read_shift(4);return[t,r,"s"]}function v3e(e,t,r){return r==null&&(r=Se(12)),Fc(t,r),r.write_shift(4,t.v),r}function y3e(e){var t=Oc(e),r=e.read_shift(4);return[t,r,"s"]}function b3e(e,t,r){return r==null&&(r=Se(8)),Pc(t,r),r.write_shift(4,t.v),r}function w3e(e){var t=li(e),r=kn(e);return[t,r,"n"]}function _3e(e,t,r){return r==null&&(r=Se(16)),Fc(t,r),vc(e.v,r),r}function YU(e){var t=Oc(e),r=kn(e);return[t,r,"n"]}function j3e(e,t,r){return r==null&&(r=Se(12)),Pc(t,r),vc(e.v,r),r}function N3e(e){var t=li(e),r=uj(e);return[t,r,"n"]}function D3e(e,t,r){return r==null&&(r=Se(12)),Fc(t,r),VI(e.v,r),r}function S3e(e){var t=Oc(e),r=uj(e);return[t,r,"n"]}function E3e(e,t,r){return r==null&&(r=Se(8)),Pc(t,r),VI(e.v,r),r}function T3e(e){var t=li(e),r=oj(e);return[t,r,"is"]}function C3e(e){var t=li(e),r=Pn(e);return[t,r,"str"]}function A3e(e,t,r){return r==null&&(r=Se(12+4*e.v.length)),Fc(t,r),en(e.v,r),r.length>r.l?r.slice(0,r.l):r}function k3e(e){var t=Oc(e),r=Pn(e);return[t,r,"str"]}function F3e(e,t,r){return r==null&&(r=Se(8+4*e.v.length)),Pc(t,r),en(e.v,r),r.length>r.l?r.slice(0,r.l):r}function O3e(e,t,r){var n=e.l+t,a=li(e);a.r=r["!row"];var i=e.read_shift(1),o=[a,i,"b"];if(r.cellFormula){e.l+=2;var c=yg(e,n-e.l,r);o[3]=En(c,null,a,r.supbooks,r)}else e.l=n;return o}function P3e(e,t,r){var n=e.l+t,a=li(e);a.r=r["!row"];var i=e.read_shift(1),o=[a,i,"e"];if(r.cellFormula){e.l+=2;var c=yg(e,n-e.l,r);o[3]=En(c,null,a,r.supbooks,r)}else e.l=n;return o}function I3e(e,t,r){var n=e.l+t,a=li(e);a.r=r["!row"];var i=kn(e),o=[a,i,"n"];if(r.cellFormula){e.l+=2;var c=yg(e,n-e.l,r);o[3]=En(c,null,a,r.supbooks,r)}else e.l=n;return o}function U3e(e,t,r){var n=e.l+t,a=li(e);a.r=r["!row"];var i=Pn(e),o=[a,i,"str"];if(r.cellFormula){e.l+=2;var c=yg(e,n-e.l,r);o[3]=En(c,null,a,r.supbooks,r)}else e.l=n;return o}var R3e=Ic,M3e=Iu;function B3e(e,t){return t==null&&(t=Se(4)),t.write_shift(4,e),t}function L3e(e,t){var r=e.l+t,n=Ic(e),a=cj(e),i=Pn(e),o=Pn(e),c=Pn(e);e.l=r;var l={rfx:n,relId:a,loc:i,display:c};return o&&(l.Tooltip=o),l}function $3e(e,t){var r=Se(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Iu({s:yr(e[0]),e:yr(e[0])},r),lj("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return en(a||"",r),en(e[1].Tooltip||"",r),en("",r),r.slice(0,r.l)}function W3e(){}function z3e(e,t,r){var n=e.l+t,a=GI(e),i=e.read_shift(1),o=[a];if(o[2]=i,r.cellFormula){var c=hke(e,n-e.l,r);o[1]=c}else e.l=n;return o}function q3e(e,t,r){var n=e.l+t,a=Ic(e),i=[a];if(r.cellFormula){var o=pke(e,n-e.l,r);i[1]=o,e.l=n}else e.l=n;return i}function H3e(e,t,r){r==null&&(r=Se(18));var n=bg(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var ZU=["left","right","top","bottom","header","footer"];function V3e(e){var t={};return ZU.forEach(function(r){t[r]=kn(e)}),t}function G3e(e,t){return t==null&&(t=Se(6*8)),cc(e),ZU.forEach(function(r){vc(e[r],t)}),t}function X3e(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function K3e(e,t,r){r==null&&(r=Se(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Y3e(e){var t=Se(24);return t.write_shift(4,4),t.write_shift(4,1),Iu(e,t),t}function Z3e(e,t){return t==null&&(t=Se(16*4+2)),t.write_shift(2,e.password?xj(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function J3e(){}function Q3e(){}function e4e(e,t,r,n,a,i,o){if(!e)return e;var c=t||{};n||(n={"!id":{}});var l=c.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,m,x,p,g,v,y,b,_,w,j=[];c.biff=12,c["!row"]=0;var N=0,D=!1,S=[],T={},A=c.supbooks||a.supbooks||[[]];if(A.sharedf=T,A.arrayf=S,A.SheetNames=a.SheetNames||a.Sheets.map(function(O){return O.name}),!c.supbooks&&(c.supbooks=A,a.Names))for(var E=0;E<a.Names.length;++E)A[0][E+1]=a.Names[E];var M=[],P=[],X=!1;Lf[16]={n:"BrtShortReal",f:YU};var q;if(Rs(e,function(F,I,L){if(!h)switch(L){case 148:u=F;break;case 0:m=F,c.sheetRows&&c.sheetRows<=m.r&&(h=!0),_=Nr(g=m.r),c["!row"]=m.r,(F.hidden||F.hpt||F.level!=null)&&(F.hpt&&(F.hpx=eu(F.hpt)),P[F.r]=F);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:F[2]},F[2]){case"n":x.v=F[1];break;case"s":b=Pd[F[1]],x.v=b.t,x.r=b.r;break;case"b":x.v=!!F[1];break;case"e":x.v=F[1],c.cellText!==!1&&(x.w=Ms[x.v]);break;case"str":x.t="s",x.v=F[1];break;case"is":x.t="s",x.v=F[1].t;break}if((p=o.CellXf[F[0].iStyleRef])&&GU(x,p.numFmtId,null,c,i,o),v=F[0].c==-1?v+1:F[0].c,c.dense?(l[g]||(l[g]=[]),l[g][v]=x):l[lr(v)+_]=x,c.cellFormula){for(D=!1,N=0;N<S.length;++N){var C=S[N];m.r>=C[0].s.r&&m.r<=C[0].e.r&&v>=C[0].s.c&&v<=C[0].e.c&&(x.F=xt(C[0]),D=!0)}!D&&F.length>3&&(x.f=F[3])}if(d.s.r>m.r&&(d.s.r=m.r),d.s.c>v&&(d.s.c=v),d.e.r<m.r&&(d.e.r=m.r),d.e.c<v&&(d.e.c=v),c.cellDates&&p&&x.t=="n"&&Ac(at[p.numFmtId])){var k=Js(x.v);k&&(x.t="d",x.v=new Date(k.y,k.m-1,k.d,k.H,k.M,k.S,k.u))}q&&(q.type=="XLDAPR"&&(x.D=!0),q=void 0);break;case 1:case 12:if(!c.sheetStubs||f)break;x={t:"z",v:void 0},v=F[0].c==-1?v+1:F[0].c,c.dense?(l[g]||(l[g]=[]),l[g][v]=x):l[lr(v)+_]=x,d.s.r>m.r&&(d.s.r=m.r),d.s.c>v&&(d.s.c=v),d.e.r<m.r&&(d.e.r=m.r),d.e.c<v&&(d.e.c=v),q&&(q.type=="XLDAPR"&&(x.D=!0),q=void 0);break;case 176:j.push(F);break;case 49:q=((c.xlmeta||{}).Cell||[])[F-1];break;case 494:var z=n["!id"][F.relId];for(z?(F.Target=z.Target,F.loc&&(F.Target+="#"+F.loc),F.Rel=z):F.relId==""&&(F.Target="#"+F.loc),g=F.rfx.s.r;g<=F.rfx.e.r;++g)for(v=F.rfx.s.c;v<=F.rfx.e.c;++v)c.dense?(l[g]||(l[g]=[]),l[g][v]||(l[g][v]={t:"z",v:void 0}),l[g][v].l=F):(y=ot({c:v,r:g}),l[y]||(l[y]={t:"z",v:void 0}),l[y].l=F);break;case 426:if(!c.cellFormula)break;S.push(F),w=c.dense?l[g][v]:l[lr(v)+_],w.f=En(F[1],d,{r:m.r,c:v},A,c),w.F=xt(F[0]);break;case 427:if(!c.cellFormula)break;T[ot(F[0].s)]=F[1],w=c.dense?l[g][v]:l[lr(v)+_],w.f=En(F[1],d,{r:m.r,c:v},A,c);break;case 60:if(!c.cellStyles)break;for(;F.e>=F.s;)M[F.e--]={width:F.w/256,hidden:!!(F.flags&1),level:F.level},X||(X=!0,gj(F.w/256)),ho(M[F.e+1]);break;case 161:l["!autofilter"]={ref:xt(F)};break;case 476:l["!margins"]=F;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),F.name&&(a.Sheets[r].CodeName=F.name),(F.above||F.left)&&(l["!outline"]={above:F.above,left:F.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),F.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!I.T){if(!f||c.WTF)throw new Error("Unexpected record 0x"+L.toString(16))}}},c),delete c.supbooks,delete c["!row"],!l["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=xt(u||d)),c.sheetRows&&l["!ref"]){var B=Dt(l["!ref"]);c.sheetRows<=+B.e.r&&(B.e.r=c.sheetRows-1,B.e.r>d.e.r&&(B.e.r=d.e.r),B.e.r<B.s.r&&(B.s.r=B.e.r),B.e.c>d.e.c&&(B.e.c=d.e.c),B.e.c<B.s.c&&(B.s.c=B.e.c),l["!fullref"]=l["!ref"],l["!ref"]=xt(B))}return j.length>0&&(l["!merges"]=j),M.length>0&&(l["!cols"]=M),P.length>0&&(l["!rows"]=P),l}function t4e(e,t,r,n,a,i,o){if(t.v===void 0)return!1;var c="";switch(t.t){case"b":c=t.v?"1":"0";break;case"d":t=Zt(t),t.z=t.z||at[14],t.v=Vr(ur(t.v)),t.t="n";break;case"n":case"e":c=""+t.v;break;default:c=t.v;break}var l={r,c:n};switch(l.s=Eo(a.cellXfs,t,a),t.l&&i["!links"].push([ot(l),t.l]),t.c&&i["!comments"].push([ot(l),t.c]),t.t){case"s":case"str":return a.bookSST?(c=_j(a.Strings,t.v,a.revStrings),l.t="s",l.v=c,o?Ae(e,18,b3e(t,l)):Ae(e,7,v3e(t,l))):(l.t="str",o?Ae(e,17,F3e(t,l)):Ae(e,6,A3e(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?Ae(e,13,E3e(t,l)):Ae(e,2,D3e(t,l)):o?Ae(e,16,j3e(t,l)):Ae(e,5,_3e(t,l)),!0;case"b":return l.t="b",o?Ae(e,15,f3e(t,l)):Ae(e,4,u3e(t,l)),!0;case"e":return l.t="e",o?Ae(e,14,x3e(t,l)):Ae(e,3,m3e(t,l)),!0}return o?Ae(e,12,c3e(t,l)):Ae(e,1,s3e(t,l)),!0}function r4e(e,t,r,n){var a=Dt(t["!ref"]||"A1"),i,o="",c=[];Ae(e,145);var l=Array.isArray(t),u=a.e.r;t["!rows"]&&(u=Math.max(a.e.r,t["!rows"].length-1));for(var d=a.s.r;d<=u;++d){o=Nr(d),Qke(e,t,a,d);var f=!1;if(d<=a.e.r)for(var h=a.s.c;h<=a.e.c;++h){d===a.s.r&&(c[h]=lr(h)),i=c[h]+o;var m=l?(t[d]||[])[h]:t[i];if(!m){f=!1;continue}f=t4e(e,m,d,h,n,t,f)}}Ae(e,146)}function n4e(e,t){!t||!t["!merges"]||(Ae(e,177,B3e(t["!merges"].length)),t["!merges"].forEach(function(r){Ae(e,176,M3e(r))}),Ae(e,178))}function a4e(e,t){!t||!t["!cols"]||(Ae(e,390),t["!cols"].forEach(function(r,n){r&&Ae(e,60,H3e(n,r))}),Ae(e,391))}function i4e(e,t){!t||!t["!ref"]||(Ae(e,648),Ae(e,649,Y3e(Dt(t["!ref"]))),Ae(e,650))}function s4e(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=$t(r,-1,n[1].Target.replace(/#.*$/,""),jt.HLINK);Ae(e,494,$3e(n,a))}}),delete t["!links"]}function o4e(e,t,r,n){if(t["!comments"].length>0){var a=$t(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",jt.VML);Ae(e,551,lj("rId"+a)),t["!legacy"]=a}}function c4e(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:xt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,c=Gn(i);c.s.r==c.e.r&&(c.e.r=Gn(t["!ref"]).e.r,i=xt(c));for(var l=0;l<o.length;++l){var u=o[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+i;break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Ae(e,161,Iu(Dt(i))),Ae(e,162)}}function l4e(e,t,r){Ae(e,133),Ae(e,137,K3e(t,r)),Ae(e,138),Ae(e,134)}function u4e(e,t){t["!protect"]&&Ae(e,535,Z3e(t["!protect"]))}function d4e(e,t,r,n){var a=oa(),i=r.SheetNames[e],o=r.Sheets[i]||{},c=i;try{r&&r.Workbook&&(c=r.Workbook.Sheets[e].CodeName||c)}catch{}var l=Dt(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Ae(a,129),(r.vbaraw||o["!outline"])&&Ae(a,147,a3e(c,o["!outline"])),Ae(a,148,t3e(l)),l4e(a,o,r.Workbook),a4e(a,o),r4e(a,o,e,t),u4e(a,o),c4e(a,o,r,e),n4e(a,o),s4e(a,o,n),o["!margins"]&&Ae(a,476,G3e(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&i4e(a,o),o4e(a,o,e,n),Ae(a,130),a.end()}function f4e(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var a=Ot((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function h4e(e,t,r,n,a,i){var o=i||{"!type":"chart"};if(!e)return i;var c=0,l=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=f4e(f);d.s.r=d.s.c=0,d.e.c=c,u=lr(c),h[0].forEach(function(m,x){o[u+Nr(x)]={t:"n",v:m,z:h[1]},l=x}),d.e.r<l&&(d.e.r=l),++c}),c>0&&(o["!ref"]=xt(d)),o}function m4e(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,c=e.match(XU);return c&&jj(c[0],i,a,r),(o=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function p4e(e,t){e.l+=10;var r=Pn(e);return{name:r}}function x4e(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Rs(e,function(l,u,d){switch(d){case 550:i["!rel"]=l;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),l.name&&(a.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var Nj=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],g4e=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],v4e=[],y4e=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Ck(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=cr(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function Ak(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=cr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function JU(e){Ak(e.WBProps,Nj),Ak(e.CalcPr,y4e),Ck(e.WBView,g4e),Ck(e.Sheets,v4e),bl.date1904=cr(e.WBProps.date1904)}function b4e(e){return!e.Workbook||!e.Workbook.WBProps?"false":cr(e.Workbook.WBProps.date1904)?"true":"false"}var w4e="][*?/\\".split("");function QU(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return w4e.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function _4e(e,t,r){e.forEach(function(n,a){QU(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[a]&&t[a].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function eR(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];_4e(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)bke(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var j4e=/<\w+:workbook/;function N4e(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},o=0;if(e.replace(Rn,function(l,u){var d=lt(l);switch(Qi(d[0])){case"<?xml":break;case"<workbook":l.match(j4e)&&(a="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=d[a];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Nj.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=cr(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=Kt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Ot(Kt(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Kt(d.name),d.comment&&(i.Comment=d.comment),d.localSheetId&&(i.Sheet=+d.localSheetId),cr(d.hidden||"0")&&(i.Hidden=!0),o=u+l.length;break;case"</definedName>":i.Ref=Ot(Kt(e.slice(o,u))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return l}),kc.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return JU(r),r}function tR(e){var t=[Fr];t[t.length]=Le("workbook",null,{xmlns:kc[0],"xmlns:r":qr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Nj.forEach(function(c){e.Workbook.WBProps[c[0]]!=null&&e.Workbook.WBProps[c[0]]!=c[1]&&(n[c[0]]=e.Workbook.WBProps[c[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Le("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:zt(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Le("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(c){var l={name:c.Name};c.Comment&&(l.comment=c.Comment),c.Sheet!=null&&(l.localSheetId=""+c.Sheet),c.Hidden&&(l.hidden="1"),c.Ref&&(t[t.length]=Le("definedName",zt(c.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function D4e(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=C2(e),r.name=Pn(e),r}function S4e(e,t){return t||(t=Se(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),lj(e.strRelID,t),en(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function E4e(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Pn(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function T4e(e,t){t||(t=Se(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),HI(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function C4e(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function A4e(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=oDe(e),o=mke(e,0,r),c=cj(e);e.l=n;var l={Name:i,Ptg:o};return a<268435455&&(l.Sheet=a),c&&(l.Comment=c),l}function k4e(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],Lf[16]={n:"BrtFRTArchID$",f:C4e},Rs(e,function(l,u,d){switch(d){case 156:o.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=En(l.Ptg,null,null,o,t),delete t.SID,delete l.Ptg,i.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,l]):o[0]=[d,l],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(l),o.XTI=o.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(d),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),JU(r),r.Names=i,r.supbooks=o,r}function F4e(e,t){Ae(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Ae(e,156,S4e(a))}Ae(e,144)}function O4e(e,t){t||(t=Se(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return en("SheetJS",t),en(Cf.version,t),en(Cf.version,t),en("7262",t),t.length>t.l?t.slice(0,t.l):t}function P4e(e,t){t||(t=Se(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function I4e(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(Ae(e,135),Ae(e,158,P4e(a)),Ae(e,136))}}function U4e(e,t){var r=oa();return Ae(r,131),Ae(r,128,O4e()),Ae(r,153,T4e(e.Workbook&&e.Workbook.WBProps||null)),I4e(r,e),F4e(r,e),Ae(r,132),r.end()}function R4e(e,t,r){return t.slice(-4)===".bin"?k4e(e,r):N4e(e,r)}function M4e(e,t,r,n,a,i,o,c){return t.slice(-4)===".bin"?e4e(e,n,r,a,i,o,c):kke(e,n,r,a,i,o,c)}function B4e(e,t,r,n,a,i,o,c){return t.slice(-4)===".bin"?x4e(e,n,r,a,i):m4e(e,n,r,a,i)}function L4e(e,t,r,n,a,i,o,c){return t.slice(-4)===".bin"?zCe():qCe()}function $4e(e,t,r,n,a,i,o,c){return t.slice(-4)===".bin"?$Ce():WCe()}function W4e(e,t,r,n){return t.slice(-4)===".bin"?MTe(e,r,n):STe(e,r,n)}function z4e(e,t,r){return PU(e,r)}function q4e(e,t,r){return t.slice(-4)===".bin"?HEe(e,r):WEe(e,r)}function H4e(e,t,r){return t.slice(-4)===".bin"?UCe(e,r):ECe(e,r)}function V4e(e,t,r){return t.slice(-4)===".bin"?NCe(e):_Ce(e)}function G4e(e,t,r,n){return r.slice(-4)===".bin"?DCe(e,t,r,n):void 0}function X4e(e,t,r){return t.slice(-4)===".bin"?yCe(e,t,r):wCe(e,t,r)}function K4e(e,t,r){return(t.slice(-4)===".bin"?U4e:tR)(e)}function Y4e(e,t,r,n,a){return(t.slice(-4)===".bin"?d4e:KU)(e,r,n,a)}function Z4e(e,t,r){return(t.slice(-4)===".bin"?XTe:FU)(e,r)}function J4e(e,t,r){return(t.slice(-4)===".bin"?XEe:NU)(e,r)}function Q4e(e,t,r){return(t.slice(-4)===".bin"?RCe:RU)(e)}function eFe(e){return(e.slice(-4)===".bin"?bCe:IU)()}var rR=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,nR=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function di(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(rR),i,o,c,l;if(a)for(l=0;l!=a.length;++l)i=a[l].match(nR),(o=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(o+1),n[c]=i[2].slice(1,i[2].length-1));return n}function tFe(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(rR),a,i,o,c;if(n)for(c=0;c!=n.length;++c)a=n[c].match(nR),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),r[o]=a[2].slice(1,a[2].length-1));return r}var Ud;function rFe(e,t){var r=Ud[e]||Ot(e);return r==="General"?xc(t):ka(r,t)}function nFe(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=cr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=ur(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ot(t)]=a}function aFe(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ms[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=kf(e.v):e.w=xc(e.v):e.w=rFe(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Ud[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Ac(n)){var a=Js(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function iFe(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=vTe[n.Pattern]||n.Pattern)}e[t.ID]=t}function sFe(e,t,r,n,a,i,o,c,l,u){var d="General",f=n.StyleID,h={};u=u||{};var m=[],x=0;for(f===void 0&&c&&(f=c.StyleID),f===void 0&&o&&(f=o.StyleID);i[f]!==void 0&&(i[f].nf&&(d=i[f].nf),i[f].Interior&&m.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=cr(e);break;case"String":n.t="s",n.r=GA(Ot(e)),n.v=e.indexOf("<")>-1?Ot(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(ur(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ot(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=YI[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=GA(t||e));break}if(aFe(n,d,u),u.cellFormula!==!1)if(n.Formula){var p=Ot(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=yl(p,a),delete n.Formula,n.ArrayRange=="RC"?n.F=yl("RC:RC",a):n.ArrayRange&&(n.F=yl(n.ArrayRange,a),l.push([Dt(n.F),n.F]))}else for(x=0;x<l.length;++x)a.r>=l[x][0].s.r&&a.r<=l[x][0].e.r&&a.c>=l[x][0].s.c&&a.c<=l[x][0].e.c&&(n.F=l[x][1]);u.cellStyles&&(m.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function oFe(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function hy(e,t){var r=t||{};Fu();var n=cl(J_(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof Ct<"u"?n=Ct.utils.decode(65001,fx(n)):n=Kt(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=Zt(r);return o.type="string",Ql.to_workbook(n,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(H){a.indexOf("<"+H)>=0&&(i=!0)}),i)return zFe(n,r);Ud={"General Number":"General","General Date":at[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":at[15],"Short Date":at[14],"Long Time":at[19],"Medium Time":at[18],"Short Time":at[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:at[2],Standard:at[4],Percent:at[10],Scientific:at[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,l=[],u,d={},f=[],h=r.dense?[]:{},m="",x={},p={},g=di('<Data ss:Type="String">'),v=0,y=0,b=0,_={s:{r:2e6,c:2e6},e:{r:0,c:0}},w={},j={},N="",D=0,S=[],T={},A={},E=0,M=[],P=[],X={},q=[],B,O=!1,F=[],I=[],L={},C=0,k=0,z={Sheets:[],WBProps:{date1904:!1}},V={};Pf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Z="";c=Pf.exec(n);)switch(c[3]=(Z=c[3]).toLowerCase()){case"data":if(Z=="data"){if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&l.push([c[3],!0]);break}if(l[l.length-1][1])break;c[1]==="/"?sFe(n.slice(v,c.index),N,g,l[l.length-1][0]=="comment"?X:x,{c:y,r:b},w,q[y],p,F,r):(N="",g=di(c[0]),v=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(P.length>0&&(x.c=P),(!r.sheetRows||r.sheetRows>b)&&x.v!==void 0&&(r.dense?(h[b]||(h[b]=[]),h[b][y]=x):h[lr(y)+Nr(b)]=x),x.HRef&&(x.l={Target:Ot(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(C=y+(parseInt(x.MergeAcross,10)|0),k=b+(parseInt(x.MergeDown,10)|0),S.push({s:{c:y,r:b},e:{c:C,r:k}})),!r.sheetStubs)x.MergeAcross?y=C+1:++y;else if(x.MergeAcross||x.MergeDown){for(var ce=y;ce<=C;++ce)for(var ie=b;ie<=k;++ie)(ce>y||ie>b)&&(r.dense?(h[ie]||(h[ie]=[]),h[ie][ce]={t:"z"}):h[lr(ce)+Nr(ie)]={t:"z"});y=C+1}else++y;else x=tFe(c[0]),x.Index&&(y=+x.Index-1),y<_.s.c&&(_.s.c=y),y>_.e.c&&(_.e.c=y),c[0].slice(-2)==="/>"&&++y,P=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(b<_.s.r&&(_.s.r=b),b>_.e.r&&(_.e.r=b),c[0].slice(-2)==="/>"&&(p=di(c[0]),p.Index&&(b=+p.Index-1)),y=0,++b):(p=di(c[0]),p.Index&&(b=+p.Index-1),L={},(p.AutoFitHeight=="0"||p.Height)&&(L.hpx=parseInt(p.Height,10),L.hpt=Bf(L.hpx),I[b]=L),p.Hidden=="1"&&(L.hidden=!0,I[b]=L));break;case"worksheet":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"));f.push(m),_.s.r<=_.e.r&&_.s.c<=_.e.c&&(h["!ref"]=xt(_),r.sheetRows&&r.sheetRows<=_.e.r&&(h["!fullref"]=h["!ref"],_.e.r=r.sheetRows-1,h["!ref"]=xt(_))),S.length&&(h["!merges"]=S),q.length>0&&(h["!cols"]=q),I.length>0&&(h["!rows"]=I),d[m]=h}else _={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=y=0,l.push([c[3],!1]),u=di(c[0]),m=Ot(u.Name),h=r.dense?[]:{},S=[],F=[],I=[],V={name:m,Hidden:0},z.Sheets.push(V);break;case"table":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else{if(c[0].slice(-2)=="/>")break;l.push([c[3],!1]),q=[],O=!1}break;case"style":c[1]==="/"?iFe(w,j,r):j=di(c[0]);break;case"numberformat":j.nf=Ot(di(c[0]).Format||"General"),Ud[j.nf]&&(j.nf=Ud[j.nf]);for(var Q=0;Q!=392&&at[Q]!=j.nf;++Q);if(Q==392){for(Q=57;Q!=392;++Q)if(at[Q]==null){Hi(j.nf,Q);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(B=di(c[0]),B.Hidden&&(B.hidden=!0,delete B.Hidden),B.Width&&(B.wpx=parseInt(B.Width,10)),!O&&B.wpx>10){O=!0,Cn=AU;for(var ne=0;ne<q.length;++ne)q[ne]&&ho(q[ne])}O&&ho(B),q[B.Index-1||q.length]=B;for(var pe=0;pe<+B.Span;++pe)q[q.length]=Zt(B);break;case"namedrange":if(c[1]==="/")break;z.Names||(z.Names=[]);var W=lt(c[0]),re={Name:W.Name,Ref:yl(W.RefersTo.slice(1),{r:0,c:0})};z.Sheets.length>0&&(re.Sheet=z.Sheets.length-1),z.Names.push(re);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?N+=n.slice(D,c.index):D=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;j.Interior=di(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?FDe(T,Z,n.slice(E,c.index)):E=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else l.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"));oFe(X),P.push(X)}else l.push([c[3],!1]),u=di(c[0]),X={a:u.Author};break;case"autofilter":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var U=di(c[0]);h["!autofilter"]={ref:yl(U.Range).replace(/\$/g,"")},l.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&l.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((u=l.pop())[0]!==c[3])throw new Error("Bad state: "+u.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&l.push([c[3],!0]);break;case"null":break;default:if(l.length==0&&c[3]=="document"||l.length==0&&c[3]=="uof")return Ik(n,r);var se=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:se=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:se=!1}break;case"excelworkbook":switch(c[3]){case"date1904":z.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:se=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:se=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(n.slice(E,c.index)){case"SheetHidden":V.Hidden=1;break;case"SheetVeryHidden":V.Hidden=2;break}else E=c.index+c[0].length;break;case"header":h["!margins"]||cc(h["!margins"]={},"xlml"),isNaN(+lt(c[0]).Margin)||(h["!margins"].header=+lt(c[0]).Margin);break;case"footer":h["!margins"]||cc(h["!margins"]={},"xlml"),isNaN(+lt(c[0]).Margin)||(h["!margins"].footer=+lt(c[0]).Margin);break;case"pagemargins":var te=lt(c[0]);h["!margins"]||cc(h["!margins"]={},"xlml"),isNaN(+te.Top)||(h["!margins"].top=+te.Top),isNaN(+te.Left)||(h["!margins"].left=+te.Left),isNaN(+te.Right)||(h["!margins"].right=+te.Right),isNaN(+te.Bottom)||(h["!margins"].bottom=+te.Bottom);break;case"displayrighttoleft":z.Views||(z.Views=[]),z.Views[0]||(z.Views[0]={}),z.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:se=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:se=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:se=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:se=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:se=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:se=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:se=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:se=!1}break;case"smarttags":break;default:se=!1;break}if(se||c[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?nFe(A,Z,M,n.slice(E,c.index)):(M=c,E=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+l.join("|")}var K={};return!r.bookSheets&&!r.bookProps&&(K.Sheets=d),K.SheetNames=f,K.Workbook=z,K.SSF=Zt(at),K.Props=T,K.Custprops=A,K}function U2(e,t){switch(Ej(t=t||{}),t.type||"base64"){case"base64":return hy(Aa(e),t);case"binary":case"buffer":case"file":return hy(e,t);case"array":return hy(Do(e),t)}}function cFe(e,t){var r=[];return e.Props&&r.push(ODe(e.Props,t)),e.Custprops&&r.push(PDe(e.Props,e.Custprops)),r.join("")}function lFe(){return""}function uFe(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(Le("NumberFormat",null,{"ss:Format":zt(at[n.numFmtId])}));var o={"ss:ID":"s"+(21+a)};r.push(Le("Style",i.join(""),o))}),Le("Styles",r.join(""))}function aR(e){return Le("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+bj(e.Ref,{r:0,c:0})})}function dFe(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(aR(a)))}return Le("Names",r.join(""))}function fFe(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],o=0;o<a.length;++o){var c=a[o];c.Sheet==r&&(c.Name.match(/^_xlfn\./)||i.push(aR(c)))}return i.join("")}function hFe(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Le("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Le("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Le("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Le("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(mn("ProtectContents","True")),e["!protect"].objects&&a.push(mn("ProtectObjects","True")),e["!protect"].scenarios&&a.push(mn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(mn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(mn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&a.push("<"+o[1]+"/>")})),a.length==0?"":Le("WorksheetOptions",a.join(""),{xmlns:ya.x})}function mFe(e){return e.map(function(t){var r=UNe(t.t||""),n=Le("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Le("Comment",n,{"ss:Author":t.a})}).join("")}function pFe(e,t,r,n,a,i,o){if(!e||e.v==null&&e.f==null)return"";var c={};if(e.f&&(c["ss:Formula"]="="+zt(bj(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var l=yr(e.F.slice(t.length+1));c["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(e.l&&e.l.Target&&(c["ss:HRef"]=zt(e.l.Target),e.l.Tooltip&&(c["x:HRefScreenTip"]=zt(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=o.c||u[d].s.r!=o.r||(u[d].e.c>u[d].s.c&&(c["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(c["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=Ms[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||at[14]);break;case"s":f="String",h=INe(e.v||"");break}var m=Eo(n.cellXfs,e,n);c["ss:StyleID"]="s"+(21+m),c["ss:Index"]=o.c+1;var x=e.v!=null?h:"",p=e.t=="z"?"":'<Data ss:Type="'+f+'">'+x+"</Data>";return(e.c||[]).length>0&&(p+=mFe(e.c)),Le("Cell",p,c)}function xFe(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=eu(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function gFe(e,t,r,n){if(!e["!ref"])return"";var a=Dt(e["!ref"]),i=e["!merges"]||[],o=0,c=[];e["!cols"]&&e["!cols"].forEach(function(g,v){ho(g);var y=!!g.width,b=bg(v,g),_={"ss:Index":v+1};y&&(_["ss:Width"]=Rf(b.width)),g.hidden&&(_["ss:Hidden"]="1"),c.push(Le("Column",null,_))});for(var l=Array.isArray(e),u=a.s.r;u<=a.e.r;++u){for(var d=[xFe(u,(e["!rows"]||[])[u])],f=a.s.c;f<=a.e.c;++f){var h=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>f)&&!(i[o].s.r>u)&&!(i[o].e.c<f)&&!(i[o].e.r<u)){(i[o].s.c!=f||i[o].s.r!=u)&&(h=!0);break}if(!h){var m={r:u,c:f},x=ot(m),p=l?(e[u]||[])[f]:e[x];d.push(pFe(p,x,e,t,r,n,m))}}d.push("</Row>"),d.length>2&&c.push(d.join(""))}return c.join("")}function vFe(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],o=i?fFe(i,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=i?gFe(i,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(hFe(i,t,e,r)),n.join("")}function yFe(e,t){t||(t={}),e.SSF||(e.SSF=Zt(at)),e.SSF&&(Fu(),Ah(e.SSF),t.revssf=mg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Eo(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(cFe(e,t)),r.push(lFe()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Le("Worksheet",vFe(n,t,e),{"ss:Name":zt(e.SheetNames[n])}));return r[2]=uFe(e,t),r[3]=dFe(e),Fr+Le("Workbook",r.join(""),{xmlns:ya.ss,"xmlns:o":ya.o,"xmlns:x":ya.x,"xmlns:ss":ya.ss,"xmlns:dt":ya.dt,"xmlns:html":ya.html})}function bFe(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=fDe(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=hDe(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var wFe=[60,1084,2066,2165,2175];function _Fe(e,t,r,n,a){var i=n,o=[],c=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}o.push(c),r.l+=i;for(var l=xs(r,r.l),u=R2[l],d=0;u!=null&&wFe.indexOf(l)>-1;)i=xs(r,r.l+2),d=r.l+4,l==2066?d+=4:(l==2165||l==2175)&&(d+=12),c=r.slice(d,r.l+4+i),o.push(c),r.l+=4+i,u=R2[l=xs(r,r.l)];var f=Qr(o);hn(f,0);var h=0;f.lens=[];for(var m=0;m<o.length;++m)f.lens.push(h),h+=o[m].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,a)}function Ui(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=at[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ms[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=kf(e.v):e.w=xc(e.v):e.w=ka(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&Ac(at[n]||String(n))){var a=Js(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Nm(e,t,r){return{v:e,ixfe:t,t:r}}function jFe(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},o={},c=null,l=[],u="",d={},f,h="",m,x,p,g,v={},y=[],b,_,w=[],j=[],N={Sheets:[],WBProps:{date1904:!1},Views:[{}]},D={},S=function(Fe){return Fe<8?ic[Fe]:Fe<64&&j[Fe-8]||ic[Fe]},T=function(Fe,He,rt){var Je=He.XF.data;if(!(!Je||!Je.patternType||!rt||!rt.cellStyles)){He.s={},He.s.patternType=Je.patternType;var Gt;(Gt=Uf(S(Je.icvFore)))&&(He.s.fgColor={rgb:Gt}),(Gt=Uf(S(Je.icvBack)))&&(He.s.bgColor={rgb:Gt})}},A=function(Fe,He,rt){if(!(L>1)&&!(rt.sheetRows&&Fe.r>=rt.sheetRows)){if(rt.cellStyles&&He.XF&&He.XF.data&&T(Fe,He,rt),delete He.ixfe,delete He.XF,f=Fe,h=ot(Fe),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Fe.r<o.s.r&&(o.s.r=Fe.r),Fe.c<o.s.c&&(o.s.c=Fe.c),Fe.r+1>o.e.r&&(o.e.r=Fe.r+1),Fe.c+1>o.e.c&&(o.e.c=Fe.c+1),rt.cellFormula&&He.f){for(var Je=0;Je<y.length;++Je)if(!(y[Je][0].s.c>Fe.c||y[Je][0].s.r>Fe.r)&&!(y[Je][0].e.c<Fe.c||y[Je][0].e.r<Fe.r)){He.F=xt(y[Je][0]),(y[Je][0].s.c!=Fe.c||y[Je][0].s.r!=Fe.r)&&delete He.f,He.f&&(He.f=""+En(y[Je][1],o,Fe,F,E));break}}rt.dense?(a[Fe.r]||(a[Fe.r]=[]),a[Fe.r][Fe.c]=He):a[h]=He}},E={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(E.password=t.password);var M,P=[],X=[],q=[],B=[],O=!1,F=[];F.SheetNames=E.snames,F.sharedf=E.sharedf,F.arrayf=E.arrayf,F.names=[],F.XTI=[];var I=0,L=0,C=0,k=[],z=[],V;E.codepage=1200,ei(1200);for(var Z=!1;e.l<e.length-1;){var ce=e.l,ie=e.read_shift(2);if(ie===0&&I===10)break;var Q=e.l===e.length?0:e.read_shift(2),ne=R2[ie];if(ne&&ne.f){if(t.bookSheets&&I===133&&ie!==133)break;if(I=ie,ne.r===2||ne.r==12){var pe=e.read_shift(2);if(Q-=2,!E.enc&&pe!==ie&&((pe&255)<<8|pe>>8)!==ie)throw new Error("rt mismatch: "+pe+"!="+ie);ne.r==12&&(e.l+=10,Q-=10)}var W={};if(ie===10?W=ne.f(e,Q,E):W=_Fe(ie,ne,e,Q,E),L==0&&[9,521,1033,2057].indexOf(I)===-1)continue;switch(ie){case 34:r.opts.Date1904=N.WBProps.date1904=W;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(E.enc||(e.l=0),E.enc=W,!t.password)throw new Error("File is password-protected");if(W.valid==null)throw new Error("Encryption scheme unsupported");if(!W.valid)throw new Error("Password is incorrect");break;case 92:E.lastuser=W;break;case 66:var re=Number(W);switch(re){case 21010:re=1200;break;case 32768:re=1e4;break;case 32769:re=1252;break}ei(E.codepage=re),Z=!0;break;case 317:E.rrtabid=W;break;case 25:E.winlocked=W;break;case 439:r.opts.RefreshAll=W;break;case 12:r.opts.CalcCount=W;break;case 16:r.opts.CalcDelta=W;break;case 17:r.opts.CalcIter=W;break;case 13:r.opts.CalcMode=W;break;case 14:r.opts.CalcPrecision=W;break;case 95:r.opts.CalcSaveRecalc=W;break;case 15:E.CalcRefMode=W;break;case 2211:r.opts.FullCalc=W;break;case 129:W.fDialog&&(a["!type"]="dialog"),W.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),W.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:w.push(W);break;case 430:F.push([W]),F[F.length-1].XTI=[];break;case 35:case 547:F[F.length-1].push(W);break;case 24:case 536:V={Name:W.Name,Ref:En(W.rgce,o,null,F,E)},W.itab>0&&(V.Sheet=W.itab-1),F.names.push(V),F[0]||(F[0]=[],F[0].XTI=[]),F[F.length-1].push(W),W.Name=="_xlnm._FilterDatabase"&&W.itab>0&&W.rgce&&W.rgce[0]&&W.rgce[0][0]&&W.rgce[0][0][0]=="PtgArea3d"&&(z[W.itab-1]={ref:xt(W.rgce[0][0][1][2])});break;case 22:E.ExternCount=W;break;case 23:F.length==0&&(F[0]=[],F[0].XTI=[]),F[F.length-1].XTI=F[F.length-1].XTI.concat(W),F.XTI=F.XTI.concat(W);break;case 2196:if(E.biff<8)break;V!=null&&(V.Comment=W[1]);break;case 18:a["!protect"]=W;break;case 19:W!==0&&E.WTF&&console.error("Password verifier: "+W);break;case 133:i[W.pos]=W,E.snames.push(W.name);break;case 10:{if(--L)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=xt(o),t.sheetRows&&t.sheetRows<=o.e.r){var U=o.e.r;o.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=xt(o),o.e.r=U}o.e.r++,o.e.c++}P.length>0&&(a["!merges"]=P),X.length>0&&(a["!objects"]=X),q.length>0&&(a["!cols"]=q),B.length>0&&(a["!rows"]=B),N.Sheets.push(D)}u===""?d=a:n[u]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(E.biff===8&&(E.biff={9:2,521:3,1033:4}[ie]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[W.BIFFVer]||8),E.biffguess=W.BIFFVer==0,W.BIFFVer==0&&W.dt==4096&&(E.biff=5,Z=!0,ei(E.codepage=28591)),E.biff==8&&W.BIFFVer==0&&W.dt==16&&(E.biff=2),L++)break;if(a=t.dense?[]:{},E.biff<8&&!Z&&(Z=!0,ei(E.codepage=t.codepage||1252)),E.biff<5||W.BIFFVer==0&&W.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var se={pos:e.l-Q,name:u};i[se.pos]=se,E.snames.push(u)}else u=(i[ce]||{name:""}).name;W.dt==32&&(a["!type"]="chart"),W.dt==64&&(a["!type"]="macro"),P=[],X=[],E.arrayf=y=[],q=[],B=[],O=!1,D={Hidden:(i[ce]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[W.r]||[])[W.c]:a[ot({c:W.c,r:W.r})])&&++W.c,b={ixfe:W.ixfe,XF:w[W.ixfe]||{},v:W.val,t:"n"},C>0&&(b.z=k[b.ixfe>>8&63]),Ui(b,t,r.opts.Date1904),A({c:W.c,r:W.r},b,t);break;case 5:case 517:b={ixfe:W.ixfe,XF:w[W.ixfe],v:W.val,t:W.t},C>0&&(b.z=k[b.ixfe>>8&63]),Ui(b,t,r.opts.Date1904),A({c:W.c,r:W.r},b,t);break;case 638:b={ixfe:W.ixfe,XF:w[W.ixfe],v:W.rknum,t:"n"},C>0&&(b.z=k[b.ixfe>>8&63]),Ui(b,t,r.opts.Date1904),A({c:W.c,r:W.r},b,t);break;case 189:for(var te=W.c;te<=W.C;++te){var K=W.rkrec[te-W.c][0];b={ixfe:K,XF:w[K],v:W.rkrec[te-W.c][1],t:"n"},C>0&&(b.z=k[b.ixfe>>8&63]),Ui(b,t,r.opts.Date1904),A({c:te,r:W.r},b,t)}break;case 6:case 518:case 1030:{if(W.val=="String"){c=W;break}if(b=Nm(W.val,W.cell.ixfe,W.tt),b.XF=w[b.ixfe],t.cellFormula){var H=W.formula;if(H&&H[0]&&H[0][0]&&H[0][0][0]=="PtgExp"){var oe=H[0][0][1][0],J=H[0][0][1][1],le=ot({r:oe,c:J});v[le]?b.f=""+En(W.formula,o,W.cell,F,E):b.F=((t.dense?(a[oe]||[])[J]:a[le])||{}).F}else b.f=""+En(W.formula,o,W.cell,F,E)}C>0&&(b.z=k[b.ixfe>>8&63]),Ui(b,t,r.opts.Date1904),A(W.cell,b,t),c=W}break;case 7:case 519:if(c)c.val=W,b=Nm(W,c.cell.ixfe,"s"),b.XF=w[b.ixfe],t.cellFormula&&(b.f=""+En(c.formula,o,c.cell,F,E)),C>0&&(b.z=k[b.ixfe>>8&63]),Ui(b,t,r.opts.Date1904),A(c.cell,b,t),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(W);var he=ot(W[0].s);if(m=t.dense?(a[W[0].s.r]||[])[W[0].s.c]:a[he],t.cellFormula&&m){if(!c||!he||!m)break;m.f=""+En(W[1],o,W[0],F,E),m.F=xt(W[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!c)break;v[ot(c.cell)]=W[0],m=t.dense?(a[c.cell.r]||[])[c.cell.c]:a[ot(c.cell)],(m||{}).f=""+En(W[0],o,f,F,E)}}break;case 253:b=Nm(l[W.isst].t,W.ixfe,"s"),l[W.isst].h&&(b.h=l[W.isst].h),b.XF=w[b.ixfe],C>0&&(b.z=k[b.ixfe>>8&63]),Ui(b,t,r.opts.Date1904),A({c:W.c,r:W.r},b,t);break;case 513:t.sheetStubs&&(b={ixfe:W.ixfe,XF:w[W.ixfe],t:"z"},C>0&&(b.z=k[b.ixfe>>8&63]),Ui(b,t,r.opts.Date1904),A({c:W.c,r:W.r},b,t));break;case 190:if(t.sheetStubs)for(var ee=W.c;ee<=W.C;++ee){var ae=W.ixfe[ee-W.c];b={ixfe:ae,XF:w[ae],t:"z"},C>0&&(b.z=k[b.ixfe>>8&63]),Ui(b,t,r.opts.Date1904),A({c:ee,r:W.r},b,t)}break;case 214:case 516:case 4:b=Nm(W.val,W.ixfe,"s"),b.XF=w[b.ixfe],C>0&&(b.z=k[b.ixfe>>8&63]),Ui(b,t,r.opts.Date1904),A({c:W.c,r:W.r},b,t);break;case 0:case 512:L===1&&(o=W);break;case 252:l=W;break;case 1054:if(E.biff==4){k[C++]=W[1];for(var xe=0;xe<C+163&&at[xe]!=W[1];++xe);xe>=163&&Hi(W[1],C+163)}else Hi(W[1],W[0]);break;case 30:{k[C++]=W;for(var ye=0;ye<C+163&&at[ye]!=W;++ye);ye>=163&&Hi(W,C+163)}break;case 229:P=P.concat(W);break;case 93:X[W.cmo[0]]=E.lastobj=W;break;case 438:E.lastobj.TxO=W;break;case 127:E.lastobj.ImData=W;break;case 440:for(g=W[0].s.r;g<=W[0].e.r;++g)for(p=W[0].s.c;p<=W[0].e.c;++p)m=t.dense?(a[g]||[])[p]:a[ot({c:p,r:g})],m&&(m.l=W[1]);break;case 2048:for(g=W[0].s.r;g<=W[0].e.r;++g)for(p=W[0].s.c;p<=W[0].e.c;++p)m=t.dense?(a[g]||[])[p]:a[ot({c:p,r:g})],m&&m.l&&(m.l.Tooltip=W[1]);break;case 28:{if(E.biff<=5&&E.biff>=2)break;m=t.dense?(a[W[0].r]||[])[W[0].c]:a[ot(W[0])];var Ce=X[W[2]];m||(t.dense?(a[W[0].r]||(a[W[0].r]=[]),m=a[W[0].r][W[0].c]={t:"z"}):m=a[ot(W[0])]={t:"z"},o.e.r=Math.max(o.e.r,W[0].r),o.s.r=Math.min(o.s.r,W[0].r),o.e.c=Math.max(o.e.c,W[0].c),o.s.c=Math.min(o.s.c,W[0].c)),m.c||(m.c=[]),x={a:W[1],t:Ce.TxO.t},m.c.push(x)}break;case 2173:dCe(w[W.ixfe],W.ext);break;case 125:{if(!E.cellStyles)break;for(;W.e>=W.s;)q[W.e--]={width:W.w/256,level:W.level||0,hidden:!!(W.flags&1)},O||(O=!0,gj(W.w/256)),ho(q[W.e+1])}break;case 520:{var Ie={};W.level!=null&&(B[W.r]=Ie,Ie.level=W.level),W.hidden&&(B[W.r]=Ie,Ie.hidden=!0),W.hpt&&(B[W.r]=Ie,Ie.hpt=W.hpt,Ie.hpx=eu(W.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||cc(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ie]]=W;break;case 161:a["!margins"]||cc(a["!margins"]={}),a["!margins"].header=W.header,a["!margins"].footer=W.footer;break;case 574:W.RTL&&(N.Views[0].RTL=!0);break;case 146:j=W;break;case 2198:M=W;break;case 140:_=W;break;case 442:u?D.CodeName=W||D.name:N.WBProps.CodeName=W||"ThisWorkbook";break}}else ne||console.error("Missing Info for XLS Record 0x"+ie.toString(16)),e.l+=Q}return r.SheetNames=Er(i).sort(function(Ze,Fe){return Number(Ze)-Number(Fe)}).map(function(Ze){return i[Ze].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&z.forEach(function(Ze,Fe){r.Sheets[r.SheetNames[Fe]]["!autofilter"]=Ze}),r.Strings=l,r.SSF=Zt(at),E.enc&&(r.Encryption=E.enc),M&&(r.Themes=M),r.Metadata={},_!==void 0&&(r.Metadata.Country=_),F.names.length>0&&(N.Names=F.names),r.Workbook=N,r}var Rd={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function NFe(e,t,r){var n=et.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=dk(n,A2,Rd.DSI);for(var i in a)t[i]=a[i]}catch(u){if(r.WTF)throw u}var o=et.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var c=dk(o,k2,Rd.SI);for(var l in c)t[l]==null&&(t[l]=c[l])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(rU(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function DFe(e,t){var r=[],n=[],a=[],i=0,o,c=$A(A2,"n"),l=$A(k2,"n");if(e.Props)for(o=Er(e.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(c,o[i])?r:Object.prototype.hasOwnProperty.call(l,o[i])?n:a).push([o[i],e.Props[o[i]]]);if(e.Custprops)for(o=Er(e.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(c,o[i])?r:Object.prototype.hasOwnProperty.call(l,o[i])?n:a).push([o[i],e.Custprops[o[i]]]);var u=[];for(i=0;i<a.length;++i)lU.indexOf(a[i][0])>-1||tU.indexOf(a[i][0])>-1||a[i][1]!=null&&u.push(a[i]);n.length&&et.utils.cfb_add(t,"/SummaryInformation",fk(n,Rd.SI,l,k2)),(r.length||u.length)&&et.utils.cfb_add(t,"/DocumentSummaryInformation",fk(r,Rd.DSI,c,A2,u.length?u:null,Rd.UDI))}function Dj(e,t){t||(t={}),Ej(t),fg(),t.codepage&&dg(t.codepage);var r,n;if(e.FullPaths){if(et.find(e,"/encryption"))throw new Error("File is password-protected");r=et.find(e,"!CompObj"),n=et.find(e,"/Workbook")||et.find(e,"/Book")}else{switch(t.type){case"base64":e=wa(Aa(e));break;case"binary":e=wa(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}hn(e,0),n={content:e}}var a,i;if(r&&bFe(r),t.bookProps&&!t.bookSheets)a={};else{var o=_t?"buffer":"array";if(n&&n.content)a=jFe(n.content,t);else if((i=et.find(e,"PerfectOffice_MAIN"))&&i.content)a=oc.to_workbook(i.content,(t.type=o,t));else if((i=et.find(e,"NativeContent_MAIN"))&&i.content)a=oc.to_workbook(i.content,(t.type=o,t));else throw(i=et.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&et.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=BCe(e))}var c={};return e.FullPaths&&NFe(e,c,t),a.Props=a.Custprops=c,t.bookFiles&&(a.cfb=e),a}function SFe(e,t){var r=t||{},n=et.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return et.utils.cfb_add(n,a,iR(e,r)),r.biff==8&&(e.Props||e.Custprops)&&DFe(e,n),r.biff==8&&e.vbaraw&&LCe(n,et.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Lf={0:{f:Zke},1:{f:i3e},2:{f:N3e},3:{f:h3e},4:{f:l3e},5:{f:w3e},6:{f:C3e},7:{f:g3e},8:{f:U3e},9:{f:I3e},10:{f:O3e},11:{f:P3e},12:{f:o3e},13:{f:S3e},14:{f:p3e},15:{f:d3e},16:{f:YU},17:{f:k3e},18:{f:y3e},19:{f:oj},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:A4e},40:{},42:{},43:{f:CTe},44:{f:ETe},45:{f:FTe},46:{f:PTe},47:{f:OTe},48:{},49:{f:eDe},50:{},51:{f:mCe},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:bU},62:{f:T3e},63:{f:jCe},64:{f:J3e},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:In,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:X3e},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:n3e},148:{f:e3e,p:16},151:{f:W3e},152:{},153:{f:E4e},154:{},155:{},156:{f:D4e},157:{},158:{},159:{T:1,f:qEe},160:{T:-1},161:{T:1,f:Ic},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:R3e},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:fCe},336:{T:-1},337:{f:gCe,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:C2},357:{},358:{},359:{},360:{T:1},361:{},362:{f:yU},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:z3e},427:{f:q3e},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:V3e},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:r3e},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:L3e},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:C2},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:PCe},633:{T:1},634:{T:-1},635:{T:1,f:FCe},636:{T:-1},637:{f:aDe},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:p4e},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Q3e},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},R2={6:{f:dy},10:{f:Ws},12:{f:Rr},13:{f:Rr},14:{f:Cr},15:{f:Cr},16:{f:kn},17:{f:Cr},18:{f:Cr},19:{f:Rr},20:{f:vk},21:{f:vk},23:{f:yU},24:{f:bk},25:{f:Cr},26:{},27:{},28:{f:QSe},29:{},34:{f:Cr},35:{f:yk},38:{f:kn},39:{f:kn},40:{f:kn},41:{f:kn},42:{f:Cr},43:{f:Cr},47:{f:dTe},49:{f:SSe},51:{f:Rr},60:{},61:{f:wSe},64:{f:Cr},65:{f:DSe},66:{f:Rr},77:{},80:{},81:{},82:{},85:{f:Rr},89:{},90:{},91:{},92:{f:uSe},93:{f:rEe},94:{},95:{f:Cr},96:{},97:{},99:{f:Cr},125:{f:bU},128:{f:$Se},129:{f:fSe},130:{f:Rr},131:{f:Cr},132:{f:Cr},133:{f:hSe},134:{},140:{f:uEe},141:{f:Rr},144:{},146:{f:hEe},151:{},152:{},153:{},154:{},155:{},156:{f:Rr},157:{},158:{},160:{f:bEe},161:{f:xEe},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:RSe},190:{f:MSe},193:{f:Ws},197:{},198:{},199:{},200:{},201:{},202:{f:Cr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Rr},220:{},221:{f:Cr},222:{},224:{f:LSe},225:{f:lSe},226:{f:Ws},227:{},229:{f:eEe},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:pSe},253:{f:TSe},255:{f:gSe},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:uU},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Cr},353:{f:Ws},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:VSe},431:{f:Cr},432:{},433:{},434:{},437:{},438:{f:iEe},439:{f:Cr},440:{f:sEe},441:{},442:{f:Oh},443:{},444:{f:Rr},445:{},446:{},448:{f:Ws},449:{f:bSe,r:2},450:{f:Ws},512:{f:pk},513:{f:yEe},515:{f:qSe},516:{f:ASe},517:{f:gk},519:{f:wEe},520:{f:vSe},523:{},545:{f:wk},549:{f:mk},566:{},574:{f:jSe},638:{f:USe},659:{},1048:{},1054:{f:FSe},1084:{},1212:{f:YSe},2048:{f:cEe},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:wm},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ws},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:mEe,r:12},2173:{f:uCe,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Cr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:KSe,r:12},2197:{},2198:{f:aCe,r:12},2199:{},2200:{},2201:{},2202:{f:ZSe,r:12},2203:{f:Ws},2204:{},2205:{},2206:{},2207:{},2211:{f:ySe},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Rr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:gEe},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:fEe},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:pk},1:{},2:{f:SEe},3:{f:NEe},4:{f:jEe},5:{f:gk},7:{f:TEe},8:{},9:{f:wm},11:{},22:{f:Rr},30:{f:PSe},31:{},32:{},33:{f:wk},36:{},37:{f:mk},50:{f:CEe},62:{},52:{},67:{},68:{f:Rr},69:{},86:{},126:{},127:{f:_Ee},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:AEe},223:{},234:{},354:{},421:{},518:{f:dy},521:{f:wm},536:{f:bk},547:{f:yk},561:{},579:{},1030:{f:dy},1033:{f:wm},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function $e(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,a),o.write_shift(2,i),i>0&&aj(r)&&e.push(r)}}function EFe(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return $e(e,t,r,a);var i=t;if(!isNaN(i)){for(var o=r.parts||[],c=0,l=0,u=0;u+(o[c]||8224)<=8224;)u+=o[c]||8224,c++;var d=e.next(4);for(d.write_shift(2,i),d.write_shift(2,u),e.push(r.slice(l,l+u)),l+=u;l<a;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(o[c]||8224)<=8224;)u+=o[c]||8224,c++;d.write_shift(2,u),e.push(r.slice(l,l+u)),l+=u}}}function Rh(e,t,r){return e||(e=Se(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function TFe(e,t,r,n){var a=Se(9);return Rh(a,e,t),dU(r,n||"b",a),a}function CFe(e,t,r){var n=Se(8+2*r.length);return Rh(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function AFe(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?Vr(ur(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?$e(e,2,EEe(r,n,a)):$e(e,3,DEe(r,n,a));return;case"b":case"e":$e(e,5,TFe(r,n,t.v,t.t));return;case"s":case"str":$e(e,4,CFe(r,n,(t.v||"").slice(0,255)));return}$e(e,1,Rh(null,r,n))}function kFe(e,t,r,n){var a=Array.isArray(t),i=Dt(t["!ref"]||"A1"),o,c="",l=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=xt(i)}for(var u=i.s.r;u<=i.e.r;++u){c=Nr(u);for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(l[d]=lr(d)),o=l[d]+c;var f=a?(t[u]||[])[d]:t[o];f&&AFe(e,f,u,d)}}}function FFe(e,t){for(var r=t||{},n=oa(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return $e(n,r.biff==4?1033:r.biff==3?521:9,mj(e,16,r)),kFe(n,e.Sheets[e.SheetNames[a]],a,r),$e(n,10),n.end()}function OFe(e,t,r){$e(e,49,ESe({sz:12,name:"Arial"},r))}function PFe(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&$e(e,1054,OSe(a,t[a],r))})}function IFe(e,t){var r=Se(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),$e(e,2151,r),r=Se(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),xU(Dt(t["!ref"]||"A1"),r),r.write_shift(4,4),$e(e,2152,r)}function UFe(e,t){for(var r=0;r<16;++r)$e(e,224,xk({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){$e(e,224,xk(n,0,t))})}function RFe(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];$e(e,440,oEe(n)),n[1].Tooltip&&$e(e,2048,lEe(n))}delete t["!links"]}function MFe(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&$e(e,125,pEe(bg(a,n),a))})}}function BFe(e,t,r,n,a){var i=16+Eo(a.cellXfs,t,a);if(t.v==null&&!t.bf){$e(e,513,bc(r,n,i));return}if(t.bf)$e(e,6,fke(t,r,n,a,i));else switch(t.t){case"d":case"n":var o=t.t=="d"?Vr(ur(t.v)):t.v;$e(e,515,HSe(r,n,o,i));break;case"b":case"e":$e(e,517,zSe(r,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var c=_j(a.Strings,t.v,a.revStrings);$e(e,253,CSe(r,n,c,i))}else $e(e,516,kSe(r,n,(t.v||"").slice(0,255),i,a));break;default:$e(e,513,bc(r,n,i))}}function LFe(e,t,r){var n=oa(),a=r.SheetNames[e],i=r.Sheets[a]||{},o=(r||{}).Workbook||{},c=(o.Sheets||[])[e]||{},l=Array.isArray(i),u=t.biff==8,d,f="",h=[],m=Dt(i["!ref"]||"A1"),x=u?65536:16384;if(m.e.c>255||m.e.r>=x){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,x-1)}$e(n,2057,mj(r,16,t)),$e(n,13,Va(1)),$e(n,12,Va(100)),$e(n,15,Wn(!0)),$e(n,17,Wn(!1)),$e(n,16,vc(.001)),$e(n,95,Wn(!0)),$e(n,42,Wn(!1)),$e(n,43,Wn(!1)),$e(n,130,Va(1)),$e(n,128,WSe()),$e(n,131,Wn(!1)),$e(n,132,Wn(!1)),u&&MFe(n,i["!cols"]),$e(n,512,ISe(m,t)),u&&(i["!links"]=[]);for(var p=m.s.r;p<=m.e.r;++p){f=Nr(p);for(var g=m.s.c;g<=m.e.c;++g){p===m.s.r&&(h[g]=lr(g)),d=h[g]+f;var v=l?(i[p]||[])[g]:i[d];v&&(BFe(n,v,p,g,t),u&&v.l&&i["!links"].push([d,v.l]))}}var y=c.CodeName||c.name||a;return u&&$e(n,574,NSe((o.Views||[])[0])),u&&(i["!merges"]||[]).length&&$e(n,229,tEe(i["!merges"])),u&&RFe(n,i),$e(n,442,fU(y)),u&&IFe(n,i),$e(n,10),n.end()}function $Fe(e,t,r){var n=oa(),a=(e||{}).Workbook||{},i=a.Sheets||[],o=a.WBProps||{},c=r.biff==8,l=r.biff==5;if($e(n,2057,mj(e,5,r)),r.bookType=="xla"&&$e(n,135),$e(n,225,c?Va(1200):null),$e(n,193,zDe(2)),l&&$e(n,191),l&&$e(n,192),$e(n,226),$e(n,92,dSe("SheetJS",r)),$e(n,66,Va(c?1200:1252)),c&&$e(n,353,Va(0)),c&&$e(n,448),$e(n,317,vEe(e.SheetNames.length)),c&&e.vbaraw&&$e(n,211),c&&e.vbaraw){var u=o.CodeName||"ThisWorkbook";$e(n,442,fU(u))}$e(n,156,Va(17)),$e(n,25,Wn(!1)),$e(n,18,Wn(!1)),$e(n,19,Va(0)),c&&$e(n,431,Wn(!1)),c&&$e(n,444,Va(0)),$e(n,61,_Se()),$e(n,64,Wn(!1)),$e(n,141,Va(0)),$e(n,34,Wn(b4e(e)=="true")),$e(n,14,Wn(!0)),c&&$e(n,439,Wn(!1)),$e(n,218,Va(0)),OFe(n,e,r),PFe(n,e.SSF,r),UFe(n,r),c&&$e(n,352,Wn(!1));var d=n.end(),f=oa();c&&$e(f,140,dEe()),c&&r.Strings&&EFe(f,252,xSe(r.Strings)),$e(f,10);var h=f.end(),m=oa(),x=0,p=0;for(p=0;p<e.SheetNames.length;++p)x+=(c?12:11)+(c?2:1)*e.SheetNames[p].length;var g=d.length+x+h.length;for(p=0;p<e.SheetNames.length;++p){var v=i[p]||{};$e(m,133,mSe({pos:g,hs:v.Hidden||0,dt:0,name:e.SheetNames[p]},r)),g+=t[p].length}var y=m.end();if(x!=y.length)throw new Error("BS8 "+x+" != "+y.length);var b=[];return d.length&&b.push(d),y.length&&b.push(y),h.length&&b.push(h),Qr(b)}function WFe(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Zt(at)),e&&e.SSF&&(Fu(),Ah(e.SSF),r.revssf=mg(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Tj(r),r.cellXfs=[],Eo(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=LFe(a,r,e);return n.unshift($Fe(e,n,r)),Qr(n)}function iR(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Gn(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return WFe(e,t);case 4:case 3:case 2:return FFe(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function kk(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=a.index,c=i&&i.index||e.length,l=ENe(e.slice(o,c),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,h=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(o=0;o<l.length;++o){var p=l[o].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(g!="<td"&&g!="<th")){var v=p.split(/<\/t[dh]>/i);for(c=0;c<v.length;++c){var y=v[c].trim();if(y.match(/<t[dh]/i)){for(var b=y,_=0;b.charAt(0)=="<"&&(_=b.indexOf(">"))>-1;)b=b.slice(_+1);for(var w=0;w<x.length;++w){var j=x[w];j.s.c==d&&j.s.r<u&&u<=j.e.r&&(d=j.e.c+1,w=-1)}var N=lt(y.slice(0,y.indexOf(">")));h=N.colspan?+N.colspan:1,((f=+N.rowspan)>1||h>1)&&x.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+h-1}});var D=N.t||N["data-t"]||"";if(!b.length){d+=h;continue}if(b=OI(b),m.s.r>u&&(m.s.r=u),m.e.r<u&&(m.e.r=u),m.s.c>d&&(m.s.c=d),m.e.c<d&&(m.e.c=d),!b.length){d+=h;continue}var S={t:"s",v:b};r.raw||!b.trim().length||D=="s"||(b==="TRUE"?S={t:"b",v:!0}:b==="FALSE"?S={t:"b",v:!1}:isNaN(_i(b))?isNaN(Jl(b).getDate())||(S={t:"d",v:ur(b)},r.cellDates||(S={t:"n",v:Vr(S.v)}),S.z=r.dateNF||at[14]):S={t:"n",v:_i(b)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=S):n[ot({r:u,c:d})]=S,d+=h}}}}return n["!ref"]=xt(m),x.length&&(n["!merges"]=x),n}function sR(e,t,r,n){for(var a=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var c=0,l=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>o)&&!(a[u].e.r<r||a[u].e.c<o)){if(a[u].s.r<r||a[u].s.c<o){c=-1;break}c=a[u].e.r-a[u].s.r+1,l=a[u].e.c-a[u].s.c+1;break}if(!(c<0)){var d=ot({r,c:o}),f=n.dense?(e[r]||[])[o]:e[d],h=f&&f.v!=null&&(f.h||Z_(f.w||(Yi(f),f.w)||""))||"",m={};c>1&&(m.rowspan=c),l>1&&(m.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(m["data-t"]=f&&f.t||"z",f.v!=null&&(m["data-v"]=f.v),f.z!=null&&(m["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),m.id=(n.id||"sjs")+"-"+d,i.push(Le("td",h,m))}}var x="<tr>";return x+i.join("")+"</tr>"}var oR='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',cR="</body></html>";function zFe(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return So(kk(r[0],t),t);var n=Oj();return r.forEach(function(a,i){Pj(n,kk(a,t),"Sheet"+(i+1))}),n}function lR(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function uR(e,t){var r=t||{},n=r.header!=null?r.header:oR,a=r.footer!=null?r.footer:cR,i=[n],o=Gn(e["!ref"]);r.dense=Array.isArray(e),i.push(lR(e,o,r));for(var c=o.s.r;c<=o.e.r;++c)i.push(sR(e,o,c,r));return i.push("</table>"+a),i.join("")}function dR(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?yr(n.origin):n.origin;a=o.r,i=o.c}var c=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,c.length),u={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var d=Gn(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),a==-1&&(u.e.r=a=d.e.r+1)}var f=[],h=0,m=e["!rows"]||(e["!rows"]=[]),x=0,p=0,g=0,v=0,y=0,b=0;for(e["!cols"]||(e["!cols"]=[]);x<c.length&&p<l;++x){var _=c[x];if(Fk(_)){if(n.display)continue;m[p]={hidden:!0}}var w=_.children;for(g=v=0;g<w.length;++g){var j=w[g];if(!(n.display&&Fk(j))){var N=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):OI(j.innerHTML),D=j.getAttribute("data-z")||j.getAttribute("z");for(h=0;h<f.length;++h){var S=f[h];S.s.c==v+i&&S.s.r<p+a&&p+a<=S.e.r&&(v=S.e.c+1-i,h=-1)}b=+j.getAttribute("colspan")||1,((y=+j.getAttribute("rowspan")||1)>1||b>1)&&f.push({s:{r:p+a,c:v+i},e:{r:p+a+(y||1)-1,c:v+i+(b||1)-1}});var T={t:"s",v:N},A=j.getAttribute("data-t")||j.getAttribute("t")||"";N!=null&&(N.length==0?T.t=A||"z":n.raw||N.trim().length==0||A=="s"||(N==="TRUE"?T={t:"b",v:!0}:N==="FALSE"?T={t:"b",v:!1}:isNaN(_i(N))?isNaN(Jl(N).getDate())||(T={t:"d",v:ur(N)},n.cellDates||(T={t:"n",v:Vr(T.v)}),T.z=n.dateNF||at[14]):T={t:"n",v:_i(N)})),T.z===void 0&&D!=null&&(T.z=D);var E="",M=j.getElementsByTagName("A");if(M&&M.length)for(var P=0;P<M.length&&!(M[P].hasAttribute("href")&&(E=M[P].getAttribute("href"),E.charAt(0)!="#"));++P);E&&E.charAt(0)!="#"&&(T.l={Target:E}),n.dense?(e[p+a]||(e[p+a]=[]),e[p+a][v+i]=T):e[ot({c:v+i,r:p+a})]=T,u.e.c<v+i&&(u.e.c=v+i),v+=b}}++p}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,p-1+a),e["!ref"]=xt(u),p>=l&&(e["!fullref"]=xt((u.e.r=c.length-x+p-1+a,u))),e}function fR(e,t){var r=t||{},n=r.dense?[]:{};return dR(n,e,t)}function qFe(e,t){return So(fR(e,t),t)}function Fk(e){var t="",r=HFe(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function HFe(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function VFe(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ot(t.replace(/<[^>]*>/g,""));return[r]}var Ok={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function hR(e,t){var r=t||{},n=J_(e),a=[],i,o,c={name:""},l="",u=0,d,f,h={},m=[],x=r.dense?[]:{},p,g,v={value:""},y="",b=0,_=[],w=-1,j=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},D=0,S={},T=[],A={},E=0,M=0,P=[],X=1,q=1,B=[],O={Names:[]},F={},I=["",""],L=[],C={},k="",z=0,V=!1,Z=!1,ce=0;for(Pf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Pf.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(N.e.c>=N.s.c&&N.e.r>=N.s.r?x["!ref"]=xt(N):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=N.e.r&&(x["!fullref"]=x["!ref"],N.e.r=r.sheetRows-1,x["!ref"]=xt(N)),T.length&&(x["!merges"]=T),P.length&&(x["!rows"]=P),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),m.push(d.name),h[d.name]=x,Z=!1):p[0].charAt(p[0].length-2)!=="/"&&(d=lt(p[0],!1),w=j=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,x=r.dense?[]:{},T=[],P=[],Z=!0);break;case"table-row-group":p[1]==="/"?--D:++D;break;case"table-row":case"":if(p[1]==="/"){w+=X,X=1;break}if(f=lt(p[0],!1),f.?w=f.-1:w==-1&&(w=0),X=+f["number-rows-repeated"]||1,X<10)for(ce=0;ce<X;++ce)D>0&&(P[w+ce]={level:D});j=-1;break;case"covered-table-cell":p[1]!=="/"&&++j,r.sheetStubs&&(r.dense?(x[w]||(x[w]=[]),x[w][j]={t:"z"}):x[ot({r:w,c:j})]={t:"z"}),y="",_=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++j,v=lt(p[0],!1),q=parseInt(v["number-columns-repeated"]||"1",10),g={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(g.f=Tk(Ot(v.formula))),(v.||v["value-type"])=="string"&&(g.t="s",g.v=Ot(v["string-value"]||""),r.dense?(x[w]||(x[w]=[]),x[w][j]=g):x[ot({r:w,c:j})]=g),j+=q-1;else if(p[1]!=="/"){++j,y="",b=0,_=[],q=1;var ie=X?w+X-1:w;if(j>N.e.c&&(N.e.c=j),j<N.s.c&&(N.s.c=j),w<N.s.r&&(N.s.r=w),ie>N.e.r&&(N.e.r=ie),v=lt(p[0],!1),L=[],C={},g={t:v.||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=Ot(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(E=parseInt(v["number-matrix-rows-spanned"],10)||0,M=parseInt(v["number-matrix-columns-spanned"],10)||0,A={s:{r:w,c:j},e:{r:w+E-1,c:j+M-1}},g.F=xt(A),B.push([A,g.F])),v.formula)g.f=Tk(v.formula);else for(ce=0;ce<B.length;++ce)w>=B[ce][0].s.r&&w<=B[ce][0].e.r&&j>=B[ce][0].s.c&&j<=B[ce][0].e.c&&(g.F=B[ce][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(E=parseInt(v["number-rows-spanned"],10)||0,M=parseInt(v["number-columns-spanned"],10)||0,A={s:{r:w,c:j},e:{r:w+E-1,c:j+M-1}},T.push(A)),v["number-columns-repeated"]&&(q=parseInt(v["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=cr(v["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(v.value);break;case"percentage":g.t="n",g.v=parseFloat(v.value);break;case"currency":g.t="n",g.v=parseFloat(v.value);break;case"date":g.t="d",g.v=ur(v["date-value"]),r.cellDates||(g.t="n",g.v=Vr(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=NNe(v["time-value"])/86400,r.cellDates&&(g.t="d",g.v=pg(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(v.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",v["string-value"]!=null&&(y=Ot(v["string-value"]),_=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(V=!1,g.t==="s"&&(g.v=y||"",_.length&&(g.R=_),V=b==0),F.Target&&(g.l=F),L.length>0&&(g.c=L,L=[]),y&&r.cellText!==!1&&(g.w=y),V&&(g.t="z",delete g.v),(!V||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=w))for(var Q=0;Q<X;++Q){if(q=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(x[w+Q]||(x[w+Q]=[]),x[w+Q][j]=Q==0?g:Zt(g);--q>0;)x[w+Q][j+q]=Zt(g);else for(x[ot({r:w+Q,c:j})]=g;--q>0;)x[ot({r:w+Q,c:j+q})]=Zt(g);N.e.c<=j&&(N.e.c=j)}q=parseInt(v["number-columns-repeated"]||"1",10),j+=q-1,q=0,g={},y="",_=[]}F={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((i=a.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((i=a.pop())[0]!==p[3])throw"Bad state: "+i;C.t=y,_.length&&(C.R=_),C.a=k,L.push(C)}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);k="",z=0,y="",b=0,_=[];break;case"creator":p[1]==="/"?k=n.slice(z,p.index):z=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((i=a.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);y="",b=0,_=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(S[c.name]=l,(i=a.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&(l="",c=lt(p[0],!1),a.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=lt(p[0],!1),l+=Ok[p[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=lt(p[0],!1),l+=Ok[p[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,p.index);break}else u=p.index+p[0].length;break;case"named-range":o=lt(p[0],!1),I=fy(o["cell-range-address"]);var ne={Name:o.name,Ref:I[0]+"!"+I[1]};Z&&(ne.Sheet=m.length),O.Names.push(ne);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(p[1]==="/"&&(!v||!v["string-value"])){var pe=VFe(n.slice(b,p.index));y=(y.length>0?y+`
`:"")+pe[0]}else lt(p[0],!1),b=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{I=fy(lt(p[0])["target-range-address"]),h[I[0]]["!autofilter"]={ref:I[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(F=lt(p[0],!1),!F.href)break;F.Target=Ot(F.href),delete F.href,F.Target.charAt(0)=="#"&&F.Target.indexOf(".")>-1?(I=fy(F.Target.slice(1)),F.Target="#"+I[0]+"!"+I[1]):F.Target.match(/^\.\.[\\\/]/)&&(F.Target=F.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var W={Sheets:h,SheetNames:m,Workbook:O};return r.bookSheets&&delete W.Sheets,W}function Pk(e,t){t=t||{},qa(e,"META-INF/manifest.xml")&&NDe(Ur(e,"META-INF/manifest.xml"),t);var r=_a(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=hR(Kt(r),t);return qa(e,"meta.xml")&&(n.Props=QI(Ur(e,"meta.xml"))),n}function Ik(e,t){return hR(e,t)}var GFe=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Of({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Fr+t}}(),Uk=function(){var e=function(i){return zt(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,o,c){var l=[];l.push('      <table:table table:name="'+zt(o.SheetNames[c])+`" table:style-name="ta1">
`);var u=0,d=0,f=Gn(i["!ref"]||"A1"),h=i["!merges"]||[],m=0,x=Array.isArray(i);if(i["!cols"])for(d=0;d<=f.e.c;++d)l.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var p="",g=i["!rows"]||[];for(u=0;u<f.s.r;++u)p=g[u]?' table:style-name="ro'+g[u].ods+'"':"",l.push("        <table:table-row"+p+`></table:table-row>
`);for(;u<=f.e.r;++u){for(p=g[u]?' table:style-name="ro'+g[u].ods+'"':"",l.push("        <table:table-row"+p+`>
`),d=0;d<f.s.c;++d)l.push(t);for(;d<=f.e.c;++d){var v=!1,y={},b="";for(m=0;m!=h.length;++m)if(!(h[m].s.c>d)&&!(h[m].s.r>u)&&!(h[m].e.c<d)&&!(h[m].e.r<u)){(h[m].s.c!=d||h[m].s.r!=u)&&(v=!0),y["table:number-columns-spanned"]=h[m].e.c-h[m].s.c+1,y["table:number-rows-spanned"]=h[m].e.r-h[m].s.r+1;break}if(v){l.push(r);continue}var _=ot({r:u,c:d}),w=x?(i[u]||[])[d]:i[_];if(w&&w.f&&(y["table:formula"]=zt(vke(w.f)),w.F&&w.F.slice(0,_.length)==_)){var j=Gn(w.F);y["table:number-matrix-columns-spanned"]=j.e.c-j.s.c+1,y["table:number-matrix-rows-spanned"]=j.e.r-j.s.r+1}if(!w){l.push(t);continue}switch(w.t){case"b":b=w.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=w.v?"true":"false";break;case"n":b=w.w||String(w.v||0),y["office:value-type"]="float",y["office:value"]=w.v||0;break;case"s":case"str":b=w.v==null?"":w.v,y["office:value-type"]="string";break;case"d":b=w.w||ur(w.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=ur(w.v).toISOString(),y["table:style-name"]="ce1";break;default:l.push(t);continue}var N=e(b);if(w.l&&w.l.Target){var D=w.l.Target;D=D.charAt(0)=="#"?"#"+yke(D.slice(1)):D,D.charAt(0)!="#"&&!D.match(/^\w+:/)&&(D="../"+D),N=Le("text:a",N,{"xlink:href":D.replace(/&/g,"&amp;")})}l.push("          "+Le("table:table-cell",Le("text:p",N,{}),y)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},a=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;ho(f),f.ods=c;var h=u["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),i.push(`  </style:style>
`),++c}}});var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=l;var f=u["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++l}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,c){var l=[Fr],u=Of({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Of({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(l.push("<office:document"+u+d+`>
`),l.push(JI().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),a(l,o),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)l.push(n(o.Sheets[o.SheetNames[f]],o,f));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),c.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function mR(e,t){if(t.bookType=="fods")return Uk(e,t);var r=X_(),n="",a=[],i=[];return n="mimetype",yt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",yt(r,n,Uk(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",yt(r,n,GFe(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",yt(r,n,Fr+JI()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",yt(r,n,EDe(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",yt(r,n,DDe(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function wc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function M2(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Kt(Do(e))}function XFe(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):wa(Wi(e))}function KFe(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function po(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function Rk(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function YFe(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function ZFe(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function $f(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Bt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Dr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function It(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=$f(e,r),i=a&7;a=Math.floor(a/8);var o=0,c;if(a==0)break;switch(i){case 0:{for(var l=r[0];e[r[0]++]>=128;);c=e.slice(l,r[0])}break;case 5:o=4,c=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,c=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=$f(e,r),c=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var u={data:c,type:i};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function dn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(Bt(n*8+a.type)),a.type==2&&t.push(Bt(a.data.length)),t.push(a.data))})}),po(t)}function Sj(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Wa(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=$f(e,n),i=It(e.slice(n[0],n[0]+a));n[0]+=a;var o={id:Dr(i[1][0].data),messages:[]};i[2].forEach(function(c){var l=It(c.data),u=Dr(l[3][0].data);o.messages.push({meta:l,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=i[3])!=null&&t[0]&&(o.merge=Dr(i[3][0].data)>>>0>0),r.push(o)}return r}function Gc(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Bt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Bt(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(o){a.push(o.data),o.meta[3]=[{type:0,data:Bt(o.data.length)}],n[2].push({data:dn(o.meta),type:2})});var i=dn(n);t.push(Bt(i.length)),t.push(i),a.forEach(function(o){return t.push(o)})}),po(t)}function JFe(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=$f(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var c=o-59;o=t[r[0]],c>1&&(o|=t[r[0]+1]<<8),c>2&&(o|=t[r[0]+2]<<16),c>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=c}a.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var l=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[po(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(a.push(a[0].slice(-l)),u-=l;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-l,-l+u))}}var d=po(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function za(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(JFe(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return po(t)}function Xc(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=Bt(n),o=i.length;t.push(i),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,a[0]=0,a[1]=o&255,a[2]=o>>8&255,a[3]=o>>16&255,r+=n}return po(t)}function QFe(e,t,r,n){var a=wc(e),i=a.getUint32(4,!0),o=(n>1?12:8)+Rk(i&(n>1?3470:398))*4,c=-1,l=-1,u=NaN,d=new Date(2001,0,1);i&512&&(c=a.getUint32(o,!0),o+=4),o+=Rk(i&(n>1?12288:4096))*4,i&16&&(l=a.getUint32(o,!0),o+=4),i&32&&(u=a.getFloat64(o,!0),o+=8),i&64&&(d.setTime(d.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(c>-1)f={t:"s",v:r[c]};else if(l>-1)f={t:"s",v:t[l]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function eOe(e,t,r){var n=wc(e),a=n.getUint32(8,!0),i=12,o=-1,c=-1,l=NaN,u=NaN,d=new Date(2001,0,1);a&1&&(l=YFe(e,i),i+=16),a&2&&(u=n.getFloat64(i,!0),i+=8),a&4&&(d.setTime(d.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(c=n.getUint32(i,!0),i+=4),a&16&&(o=n.getUint32(i,!0),i+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return f}function my(e,t){var r=new Uint8Array(32),n=wc(r),a=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,ZFe(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,a)}function py(e,t){var r=new Uint8Array(32),n=wc(r),a=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,a)}function tOe(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return QFe(e,t,r,e[0]);case 5:return eOe(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Sn(e){var t=It(e);return $f(t[1][0].data)}function Mk(e,t){var r=It(t.data),n=Dr(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(o){var c=It(o.data),l=Dr(c[1][0].data)>>>0;switch(n){case 1:i[l]=M2(c[3][0].data);break;case 8:{var u=e[Sn(c[9][0].data)][0],d=It(u.data),f=e[Sn(d[1][0].data)][0],h=Dr(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var m=It(f.data);i[l]=m[3].map(function(x){return M2(x.data)}).join("")}break}}),i}function rOe(e,t){var r,n,a,i,o,c,l,u,d,f,h,m,x,p,g=It(e),v=Dr(g[1][0].data)>>>0,y=Dr(g[2][0].data)>>>0,b=((n=(r=g[8])==null?void 0:r[0])==null?void 0:n.data)&&Dr(g[8][0].data)>0||!1,_,w;if((i=(a=g[7])==null?void 0:a[0])!=null&&i.data&&t!=0)_=(c=(o=g[7])==null?void 0:o[0])==null?void 0:c.data,w=(u=(l=g[6])==null?void 0:l[0])==null?void 0:u.data;else if((f=(d=g[4])==null?void 0:d[0])!=null&&f.data&&t!=1)_=(m=(h=g[4])==null?void 0:h[0])==null?void 0:m.data,w=(p=(x=g[3])==null?void 0:x[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var j=b?4:1,N=wc(_),D=[],S=0;S<_.length/2;++S){var T=N.getUint16(S*2,!0);T<65535&&D.push([S,T])}if(D.length!=y)throw"Expected ".concat(y," cells, found ").concat(D.length);var A=[];for(S=0;S<D.length-1;++S)A[D[S][0]]=w.subarray(D[S][1]*j,D[S+1][1]*j);return D.length>=1&&(A[D[D.length-1][0]]=w.subarray(D[D.length-1][1]*j)),{R:v,cells:A}}function nOe(e,t){var r,n=It(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Dr(n[7][0].data)>>>0>0?1:0:-1,i=Sj(n[5],function(o){return rOe(o,a)});return{nrows:Dr(n[4][0].data)>>>0,data:i.reduce(function(o,c){return o[c.R]||(o[c.R]=[]),c.cells.forEach(function(l,u){if(o[c.R][u])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(u));o[c.R][u]=l}),o},[])}}function aOe(e,t,r){var n,a=It(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Dr(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(Dr(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=xt(i);var o=It(a[4][0].data),c=Mk(e,e[Sn(o[4][0].data)][0]),l=(n=o[17])!=null&&n[0]?Mk(e,e[Sn(o[17][0].data)][0]):[],u=It(o[3][0].data),d=0;u[1].forEach(function(f){var h=It(f.data),m=e[Sn(h[2][0].data)][0],x=Dr(m.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var p=nOe(e,m);p.data.forEach(function(g,v){g.forEach(function(y,b){var _=ot({r:d+v,c:b}),w=tOe(y,c,l);w&&(r[_]=w)})}),d+=p.nrows})}function iOe(e,t){var r=It(t.data),n={"!ref":"A1"},a=e[Sn(r[2][0].data)],i=Dr(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return aOe(e,a[0],n),n}function sOe(e,t){var r,n=It(t.data),a={name:(r=n[1])!=null&&r[0]?M2(n[1][0].data):"",sheets:[]},i=Sj(n[2],Sn);return i.forEach(function(o){e[o].forEach(function(c){var l=Dr(c.meta[1][0].data);l==6e3&&a.sheets.push(iOe(e,c))})}),a}function oOe(e,t){var r=Oj(),n=It(t.data),a=Sj(n[1],Sn);if(a.forEach(function(i){e[i].forEach(function(o){var c=Dr(o.meta[1][0].data);if(c==2){var l=sOe(e,o);l.sheets.forEach(function(u,d){Pj(r,u,d==0?l.name:l.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function xy(e){var t,r,n,a,i={},o=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=za(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var d;try{d=Wa(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){i[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var c=((a=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Dr(i[1][0].meta[1][0].data)==1&&i[1][0];if(c||o.forEach(function(l){i[l].forEach(function(u){var d=Dr(u.meta[1][0].data)>>>0;if(d==1)if(!c)c=u;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return oOe(i,c)}function cOe(e,t,r){var n,a,i,o;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var c=((o=(i=e[8])==null?void 0:i[0])==null?void 0:o.data)&&Dr(e[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var l=0,u=wc(e[7][0].data),d=0,f=[],h=wc(e[4][0].data),m=0,x=[],p=0;p<t.length;++p){if(t[p]==null){u.setUint16(p*2,65535,!0),h.setUint16(p*2,65535);continue}u.setUint16(p*2,d,!0),h.setUint16(p*2,m,!0);var g,v;switch(typeof t[p]){case"string":g=my({t:"s",v:t[p]},r),v=py({t:"s",v:t[p]},r);break;case"number":g=my({t:"n",v:t[p]},r),v=py({t:"n",v:t[p]},r);break;case"boolean":g=my({t:"b",v:t[p]},r),v=py({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}f.push(g),d+=g.length,x.push(v),m+=v.length,++l}for(e[2][0].data=Bt(l);p<e[7][0].data.length/2;++p)u.setUint16(p*2,65535,!0),h.setUint16(p*2,65535,!0);return e[6][0].data=po(f),e[3][0].data=po(x),l}function lOe(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Gn(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(xt(n)));var i=Nx(r,{range:n,header:1}),o=["~Sh33tJ5~"];i.forEach(function(k){return k.forEach(function(z){typeof z=="string"&&o.push(z)})});var c={},l=[],u=et.read(t.numbers,{type:"base64"});u.FileIndex.map(function(k,z){return[k,u.FullPaths[z]]}).forEach(function(k){var z=k[0],V=k[1];if(z.type==2&&z.name.match(/\.iwa/)){var Z=z.content,ce=za(Z),ie=Wa(ce);ie.forEach(function(Q){l.push(Q.id),c[Q.id]={deps:[],location:V,type:Dr(Q.messages[0].meta[1][0].data)}})}}),l.sort(function(k,z){return k-z});var d=l.filter(function(k){return k>1}).map(function(k){return[k,Bt(k)]});u.FileIndex.map(function(k,z){return[k,u.FullPaths[z]]}).forEach(function(k){var z=k[0];if(k[1],!!z.name.match(/\.iwa/)){var V=Wa(za(z.content));V.forEach(function(Z){Z.messages.forEach(function(ce){d.forEach(function(ie){Z.messages.some(function(Q){return Dr(Q.meta[1][0].data)!=11006&&KFe(Q.data,ie[1])})&&c[ie[0]].deps.push(Z.id)})})})}});for(var f=et.find(u,c[1].location),h=Wa(za(f.content)),m,x=0;x<h.length;++x){var p=h[x];p.id==1&&(m=p)}var g=Sn(It(m.messages[0].data)[1][0].data);for(f=et.find(u,c[g].location),h=Wa(za(f.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(m=p);for(g=Sn(It(m.messages[0].data)[2][0].data),f=et.find(u,c[g].location),h=Wa(za(f.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(m=p);for(g=Sn(It(m.messages[0].data)[2][0].data),f=et.find(u,c[g].location),h=Wa(za(f.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(m=p);var v=It(m.messages[0].data);{v[6][0].data=Bt(n.e.r+1),v[7][0].data=Bt(n.e.c+1);var y=Sn(v[46][0].data),b=et.find(u,c[y].location),_=Wa(za(b.content));{for(var w=0;w<_.length&&_[w].id!=y;++w);if(_[w].id!=y)throw"Bad ColumnRowUIDMapArchive";var j=It(_[w].messages[0].data);j[1]=[],j[2]=[],j[3]=[];for(var N=0;N<=n.e.c;++N){var D=[];D[1]=D[2]=[{type:0,data:Bt(N+420690)}],j[1].push({type:2,data:dn(D)}),j[2].push({type:0,data:Bt(N)}),j[3].push({type:0,data:Bt(N)})}j[4]=[],j[5]=[],j[6]=[];for(var S=0;S<=n.e.r;++S)D=[],D[1]=D[2]=[{type:0,data:Bt(S+726270)}],j[4].push({type:2,data:dn(D)}),j[5].push({type:0,data:Bt(S)}),j[6].push({type:0,data:Bt(S)});_[w].messages[0].data=dn(j)}b.content=Xc(Gc(_)),b.size=b.content.length,delete v[46];var T=It(v[4][0].data);{T[7][0].data=Bt(n.e.r+1);var A=It(T[1][0].data),E=Sn(A[2][0].data);b=et.find(u,c[E].location),_=Wa(za(b.content));{if(_[0].id!=E)throw"Bad HeaderStorageBucket";var M=It(_[0].messages[0].data);for(S=0;S<i.length;++S){var P=It(M[2][0].data);P[1][0].data=Bt(S),P[4][0].data=Bt(i[S].length),M[2][S]={type:M[2][0].type,data:dn(P)}}_[0].messages[0].data=dn(M)}b.content=Xc(Gc(_)),b.size=b.content.length;var X=Sn(T[2][0].data);b=et.find(u,c[X].location),_=Wa(za(b.content));{if(_[0].id!=X)throw"Bad HeaderStorageBucket";for(M=It(_[0].messages[0].data),N=0;N<=n.e.c;++N)P=It(M[2][0].data),P[1][0].data=Bt(N),P[4][0].data=Bt(n.e.r+1),M[2][N]={type:M[2][0].type,data:dn(P)};_[0].messages[0].data=dn(M)}b.content=Xc(Gc(_)),b.size=b.content.length;var q=Sn(T[4][0].data);(function(){for(var k=et.find(u,c[q].location),z=Wa(za(k.content)),V,Z=0;Z<z.length;++Z){var ce=z[Z];ce.id==q&&(V=ce)}var ie=It(V.messages[0].data);{ie[3]=[];var Q=[];o.forEach(function(W,re){Q[1]=[{type:0,data:Bt(re)}],Q[2]=[{type:0,data:Bt(1)}],Q[3]=[{type:2,data:XFe(W)}],ie[3].push({type:2,data:dn(Q)})})}V.messages[0].data=dn(ie);var ne=Gc(z),pe=Xc(ne);k.content=pe,k.size=k.content.length})();var B=It(T[3][0].data);{var O=B[1][0];delete B[2];var F=It(O.data);{var I=Sn(F[2][0].data);(function(){for(var k=et.find(u,c[I].location),z=Wa(za(k.content)),V,Z=0;Z<z.length;++Z){var ce=z[Z];ce.id==I&&(V=ce)}var ie=It(V.messages[0].data);{delete ie[6],delete B[7];var Q=new Uint8Array(ie[5][0].data);ie[5]=[];for(var ne=0,pe=0;pe<=n.e.r;++pe){var W=It(Q);ne+=cOe(W,i[pe],o),W[1][0].data=Bt(pe),ie[5].push({data:dn(W),type:2})}ie[1]=[{type:0,data:Bt(n.e.c+1)}],ie[2]=[{type:0,data:Bt(n.e.r+1)}],ie[3]=[{type:0,data:Bt(ne)}],ie[4]=[{type:0,data:Bt(n.e.r+1)}]}V.messages[0].data=dn(ie);var re=Gc(z),U=Xc(re);k.content=U,k.size=k.content.length})()}O.data=dn(F)}T[3][0].data=dn(B)}v[4][0].data=dn(T)}m.messages[0].data=dn(v);var L=Gc(h),C=Xc(L);return f.content=C,f.size=f.content.length,u}function pR(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Ej(e){pR([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Tj(e){pR([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function uOe(e){return jt.WS.indexOf(e)>-1?"sheet":e==jt.CS?"chart":e==jt.DS?"dialog":e==jt.MS?"macro":e&&e.length?e:"sheet"}function dOe(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,uOe(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function fOe(e,t,r,n,a,i,o,c,l,u,d,f){try{i[n]=Od(_a(e,r,!0),t);var h=Ur(e,t),m;switch(c){case"sheet":m=M4e(h,t,a,l,i[n],u,d,f);break;case"chart":if(m=B4e(h,t,a,l,i[n],u,d,f),!m||!m["!drawel"])break;var x=yd(m["!drawel"].Target,t),p=If(x),g=SCe(_a(e,x,!0),Od(_a(e,p,!0),x)),v=yd(g,x),y=If(v);m=h4e(_a(e,v,!0),v,l,Od(_a(e,y,!0),v),u,m);break;case"macro":m=L4e(h,t,a,l,i[n],u,d,f);break;case"dialog":m=$4e(h,t,a,l,i[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+c)}o[n]=m;var b=[];i&&i[n]&&Er(i[n]).forEach(function(_){var w="";if(i[n][_].Type==jt.CMNT){w=yd(i[n][_].Target,t);var j=H4e(Ur(e,w,!0),w,l);if(!j||!j.length)return;jk(m,j,!1)}i[n][_].Type==jt.TCMNT&&(w=yd(i[n][_].Target,t),b=b.concat(TCe(Ur(e,w,!0),l)))}),b&&b.length&&jk(m,b,!0,l.people||[])}catch(_){if(l.WTF)throw _}}function Ba(e){return e.charAt(0)=="/"?e.slice(1):e}function xR(e,t){if(Fu(),t=t||{},Ej(t),qa(e,"META-INF/manifest.xml")||qa(e,"objectdata.xml"))return Pk(e,t);if(qa(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof xy<"u"){if(e.FileIndex)return xy(e);var r=et.utils.cfb_new();return qA(e).forEach(function(P){yt(r,P,CNe(e,P))}),xy(r)}throw new Error("Unsupported NUMBERS file")}if(!qa(e,"[Content_Types].xml"))throw qa(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):qa(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=qA(e),a=_De(_a(e,"[Content_Types].xml")),i=!1,o,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",Ur(e,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!Ur(e,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var l={},u={};if(!t.bookSheets&&!t.bookProps){if(Pd=[],a.sst)try{Pd=q4e(Ur(e,Ba(a.sst)),a.sst,t)}catch(P){if(t.WTF)throw P}t.cellStyles&&a.themes.length&&(l=z4e(_a(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(u=W4e(Ur(e,Ba(a.style)),a.style,l,t))}a.links.map(function(P){try{var X=Od(_a(e,If(Ba(P))),P);return G4e(Ur(e,Ba(P)),X,P,t)}catch{}});var d=R4e(Ur(e,Ba(a.workbooks[0])),a.workbooks[0],t),f={},h="";a.coreprops.length&&(h=Ur(e,Ba(a.coreprops[0]),!0),h&&(f=QI(h)),a.extprops.length!==0&&(h=Ur(e,Ba(a.extprops[0]),!0),h&&CDe(h,f,t)));var m={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(h=_a(e,Ba(a.custprops[0]),!0),h&&(m=kDe(h,t)));var x={};if((t.bookSheets||t.bookProps)&&(d.Sheets?o=d.Sheets.map(function(X){return X.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),t.bookProps&&(x.Props=f,x.Custprops=m),t.bookSheets&&typeof o<"u"&&(x.SheetNames=o),t.bookSheets?x.SheetNames:t.bookProps))return x;o={};var p={};t.bookDeps&&a.calcchain&&(p=V4e(Ur(e,Ba(a.calcchain)),a.calcchain));var g=0,v={},y,b;{var _=d.Sheets;f.Worksheets=_.length,f.SheetNames=[];for(var w=0;w!=_.length;++w)f.SheetNames[w]=_[w].name}var j=i?"bin":"xml",N=a.workbooks[0].lastIndexOf("/"),D=(a.workbooks[0].slice(0,N+1)+"_rels/"+a.workbooks[0].slice(N+1)+".rels").replace(/^\//,"");qa(e,D)||(D="xl/_rels/workbook."+j+".rels");var S=Od(_a(e,D,!0),D.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=X4e(Ur(e,Ba(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=ACe(Ur(e,Ba(a.people[0])),t)),S&&(S=dOe(S,d.Sheets));var T=Ur(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=f.Worksheets;++g){var A="sheet";if(S&&S[g]?(y="xl/"+S[g][1].replace(/[\/]?xl\//,""),qa(e,y)||(y=S[g][1]),qa(e,y)||(y=D.replace(/_rels\/.*$/,"")+S[g][1]),A=S[g][2]):(y="xl/worksheets/sheet"+(g+1-T)+"."+j,y=y.replace(/sheet0\./,"sheet.")),b=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(f.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var E=!1,M=0;M!=t.sheets.length;++M)typeof t.sheets[M]=="number"&&t.sheets[M]==g&&(E=1),typeof t.sheets[M]=="string"&&t.sheets[M].toLowerCase()==f.SheetNames[g].toLowerCase()&&(E=1);if(!E)continue e}}fOe(e,y,b,f.SheetNames[g],g,v,o,A,t,d,l,u)}return x={Directory:a,Workbook:d,Props:f,Custprops:m,Deps:p,Sheets:o,SheetNames:f.SheetNames,Strings:Pd,Styles:u,Themes:l,SSF:Zt(at)},t&&t.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(P,X){P=P.replace(/^Root Entry[\/]/,""),x.keys.push(P),x.files[P]=e.FileIndex[X]}))),t&&t.bookVBA&&(a.vba.length>0?x.vbaraw=Ur(e,Ba(a.vba[0]),!0):a.defaults&&a.defaults.bin===MCe&&(x.vbaraw=Ur(e,"xl/vbaProject.bin",!0))),x}function hOe(e,t){var r=t||{},n="Workbook",a=et.find(e,n);try{if(n="/!DataSpaces/Version",a=et.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(KEe(a.content),n="/!DataSpaces/DataSpaceMap",a=et.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=ZEe(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=et.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=JEe(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=et.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);eTe(a.content)}catch{}if(n="/EncryptionInfo",a=et.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=tTe(a.content);if(n="/EncryptedPackage",a=et.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function mOe(e,t){return t.bookType=="ods"?mR(e,t):t.bookType=="numbers"?lOe(e,t):t.bookType=="xlsb"?pOe(e,t):gR(e,t)}function pOe(e,t){ll=1024,e&&!e.SSF&&(e.SSF=Zt(at)),e&&e.SSF&&(Fu(),Ah(e.SSF),t.revssf=mg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Id?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=MU.indexOf(t.bookType)>-1,a=fj();Tj(t=t||{});var i=X_(),o="",c=0;if(t.cellXfs=[],Eo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",yt(i,o,eU(e.Props,t)),a.coreprops.push(o),$t(t.rels,2,o,jt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,yt(i,o,nU(e.Props)),a.extprops.push(o),$t(t.rels,3,o,jt.EXT_PROPS),e.Custprops!==e.Props&&Er(e.Custprops||{}).length>0&&(o="docProps/custom.xml",yt(i,o,aU(e.Custprops)),a.custprops.push(o),$t(t.rels,4,o,jt.CUST_PROPS)),c=1;c<=e.SheetNames.length;++c){var d={"!id":{}},f=e.Sheets[e.SheetNames[c-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+c+"."+r,yt(i,o,Y4e(c-1,o,t,e,d)),a.sheets.push(o),$t(t.wbrels,-1,"worksheets/sheet"+c+"."+r,jt.WS[0])}if(f){var m=f["!comments"],x=!1,p="";m&&m.length>0&&(p="xl/comments"+c+"."+r,yt(i,p,Q4e(m,p)),a.comments.push(p),$t(d,-1,"../comments"+c+"."+r,jt.CMNT),x=!0),f["!legacy"]&&x&&yt(i,"xl/drawings/vmlDrawing"+c+".vml",UU(c,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&yt(i,If(o),vl(d))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,yt(i,o,J4e(t.Strings,o,t)),a.strs.push(o),$t(t.wbrels,-1,"sharedStrings."+r,jt.SST)),o="xl/workbook."+r,yt(i,o,K4e(e,o)),a.workbooks.push(o),$t(t.rels,1,o,jt.WB),o="xl/theme/theme1.xml",yt(i,o,vj(e.Themes,t)),a.themes.push(o),$t(t.wbrels,-1,"theme/theme1.xml",jt.THEME),o="xl/styles."+r,yt(i,o,Z4e(e,o,t)),a.styles.push(o),$t(t.wbrels,-1,"styles."+r,jt.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",yt(i,o,e.vbaraw),a.vba.push(o),$t(t.wbrels,-1,"vbaProject.bin",jt.VBA)),o="xl/metadata."+r,yt(i,o,eFe(o)),a.metadata.push(o),$t(t.wbrels,-1,"metadata."+r,jt.XLMETA),yt(i,"[Content_Types].xml",ZI(a,t)),yt(i,"_rels/.rels",vl(t.rels)),yt(i,"xl/_rels/workbook."+r+".rels",vl(t.wbrels)),delete t.revssf,delete t.ssf,i}function gR(e,t){ll=1024,e&&!e.SSF&&(e.SSF=Zt(at)),e&&e.SSF&&(Fu(),Ah(e.SSF),t.revssf=mg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Id?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=MU.indexOf(t.bookType)>-1,a=fj();Tj(t=t||{});var i=X_(),o="",c=0;if(t.cellXfs=[],Eo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",yt(i,o,eU(e.Props,t)),a.coreprops.push(o),$t(t.rels,2,o,jt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,yt(i,o,nU(e.Props)),a.extprops.push(o),$t(t.rels,3,o,jt.EXT_PROPS),e.Custprops!==e.Props&&Er(e.Custprops||{}).length>0&&(o="docProps/custom.xml",yt(i,o,aU(e.Custprops)),a.custprops.push(o),$t(t.rels,4,o,jt.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,c=1;c<=e.SheetNames.length;++c){var f={"!id":{}},h=e.Sheets[e.SheetNames[c-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:o="xl/worksheets/sheet"+c+"."+r,yt(i,o,KU(c-1,t,e,f)),a.sheets.push(o),$t(t.wbrels,-1,"worksheets/sheet"+c+"."+r,jt.WS[0])}if(h){var x=h["!comments"],p=!1,g="";if(x&&x.length>0){var v=!1;x.forEach(function(y){y[1].forEach(function(b){b.T==!0&&(v=!0)})}),v&&(g="xl/threadedComments/threadedComment"+c+"."+r,yt(i,g,CCe(x,d,t)),a.threadedcomments.push(g),$t(f,-1,"../threadedComments/threadedComment"+c+"."+r,jt.TCMNT)),g="xl/comments"+c+"."+r,yt(i,g,RU(x)),a.comments.push(g),$t(f,-1,"../comments"+c+"."+r,jt.CMNT),p=!0}h["!legacy"]&&p&&yt(i,"xl/drawings/vmlDrawing"+c+".vml",UU(c,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&yt(i,If(o),vl(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,yt(i,o,NU(t.Strings,t)),a.strs.push(o),$t(t.wbrels,-1,"sharedStrings."+r,jt.SST)),o="xl/workbook."+r,yt(i,o,tR(e)),a.workbooks.push(o),$t(t.rels,1,o,jt.WB),o="xl/theme/theme1.xml",yt(i,o,vj(e.Themes,t)),a.themes.push(o),$t(t.wbrels,-1,"theme/theme1.xml",jt.THEME),o="xl/styles."+r,yt(i,o,FU(e,t)),a.styles.push(o),$t(t.wbrels,-1,"styles."+r,jt.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",yt(i,o,e.vbaraw),a.vba.push(o),$t(t.wbrels,-1,"vbaProject.bin",jt.VBA)),o="xl/metadata."+r,yt(i,o,IU()),a.metadata.push(o),$t(t.wbrels,-1,"metadata."+r,jt.XLMETA),d.length>1&&(o="xl/persons/person.xml",yt(i,o,kCe(d)),a.people.push(o),$t(t.wbrels,-1,"persons/person.xml",jt.PEOPLE)),yt(i,"[Content_Types].xml",ZI(a,t)),yt(i,"_rels/.rels",vl(t.rels)),yt(i,"xl/_rels/workbook."+r+".rels",vl(t.wbrels)),delete t.revssf,delete t.ssf,i}function Cj(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Aa(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function xOe(e,t){return et.find(e,"EncryptedPackage")?hOe(e,t):Dj(e,t)}function gOe(e,t){var r,n=e,a=t||{};return a.type||(a.type=_t&&Buffer.isBuffer(e)?"buffer":"base64"),r=AI(n,a),xR(r,a)}function vR(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return U2(e.slice(r),t);default:break e}return Ql.to_workbook(e,t)}function vOe(e,t){var r="",n=Cj(e,t);switch(t.type){case"base64":r=Aa(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=gc(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Kt(r)),t.type="binary",vR(r,t)}function yOe(e,t){var r=e;return t.type=="base64"&&(r=Aa(r)),r=Ct.utils.decode(1200,r.slice(2),"str"),t.type="binary",vR(r,t)}function bOe(e){return e.match(/[^\x00-\x7F]/)?Wi(e):e}function gy(e,t,r,n){return n?(r.type="string",Ql.to_workbook(e,r)):Ql.to_workbook(t,r)}function Wf(e,t){fg();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Wf(new Uint8Array(e),(r=Zt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),bl={},r.dateNF&&(bl.dateNF=r.dateNF),r.type||(r.type=_t&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=_t?"buffer":"binary",n=wNe(e),typeof Uint8Array<"u"&&!_t&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=bOe(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),c=new Uint8Array(o);if(c.foo="bar",!c.foo)return r=Zt(r),r.type="array",Wf(q_(n),r)}switch((a=Cj(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return xOe(et.read(n,r),r);break;case 9:if(a[1]<=8)return Dj(n,r);break;case 60:return U2(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return FEe(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return _U.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?gOe(n,r):gy(e,n,r,i);case 239:return a[3]===60?U2(n,r):gy(e,n,r,i);case 255:if(a[1]===254)return yOe(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return oc.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return oc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return I2.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return CU.to_workbook(n,r);break;case 10:case 13:case 32:return vOe(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return kEe.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?I2.to_workbook(n,r):gy(e,n,r,i)}function Bk(e,t){var r=t||{};return r.type="file",Wf(e,r)}function yR(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return kh(t.file,et.write(e,{type:_t?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return et.write(e,t)}function wOe(e,t){var r=Zt(t||{}),n=mOe(e,r);return bR(n,r)}function _Oe(e,t){var r=Zt(t||{}),n=gR(e,r);return bR(n,r)}function bR(e,t){var r={},n=_t?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?et.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Ch(a))}return t.password&&typeof encrypt_agile<"u"?yR(encrypt_agile(a,t.password),t):t.type==="file"?kh(t.file,a):t.type=="string"?Kt(a):a}function jOe(e,t){var r=t||{},n=SFe(e,r);return yR(n,r)}function Mi(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Af(Wi(n));case"binary":return Wi(n);case"string":return e;case"file":return kh(t.file,n,"utf8");case"buffer":return _t?Us(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Mi(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function NOe(e,t){switch(t.type){case"base64":return Af(e);case"binary":return e;case"string":return e;case"file":return kh(t.file,e,"binary");case"buffer":return _t?Us(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Dm(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Af(r):t.type=="string"?Kt(r):r;case"file":return kh(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Aj(e,t){fg(),eR(e);var r=Zt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Aj(e,r);return r.type="array",Ch(n)}return _Oe(e,r)}function wg(e,t){fg(),eR(e);var r=Zt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=wg(e,r);return r.type="array",Ch(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Mi(yFe(e,r),r);case"slk":case"sylk":return Mi(wU.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return Mi(uR(e.Sheets[e.SheetNames[a]],r),r);case"txt":return NOe(jR(e.Sheets[e.SheetNames[a]],r),r);case"csv":return Mi(Fj(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return Mi(_U.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return Dm(I2.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return Mi(Ql.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return Mi(CU.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return Mi(jU.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return Mi(mR(e,r),r);case"wk1":return Dm(oc.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return Dm(oc.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Dm(iR(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),jOe(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return wOe(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function kj(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Lk(e,t,r){var n=r||{};return n.type="file",n.file=t,kj(n),wg(e,n)}function DOe(e,t,r){var n=r||{};return n.type="file",n.file=t,kj(n),Aj(e,n)}function SOe(e,t,r,n){var a=r||{};a.type="file",a.file=e,kj(a),a.type="buffer";var i=n;return i instanceof Function||(i=r),eo.writeFile(e,wg(t,a),i)}function wR(e,t,r,n,a,i,o,c){var l=Nr(r),u=c.defval,d=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),f=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!o||e[r])for(var m=t.s.c;m<=t.e.c;++m){var x=o?e[r][m]:e[n[m]+l];if(x===void 0||x.t===void 0){if(u===void 0)continue;i[m]!=null&&(h[i[m]]=u);continue}var p=x.v;switch(x.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[m]!=null){if(p==null)if(x.t=="e"&&p===null)h[i[m]]=null;else if(u!==void 0)h[i[m]]=u;else if(d&&p===null)h[i[m]]=null;else continue;else h[i[m]]=d&&(x.t!=="n"||x.t==="n"&&c.rawNumbers!==!1)?p:Yi(x,p,c);p!=null&&(f=!1)}}return{row:h,isempty:f}}function Nx(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],o=0,c="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":l=Dt(d);break;case"number":l=Dt(e["!ref"]),l.s.r=d;break;default:l=d}n>0&&(a=0);var f=Nr(l.s.r),h=[],m=[],x=0,p=0,g=Array.isArray(e),v=l.s.r,y=0,b={};g&&!e[v]&&(e[v]=[]);var _=u.skipHidden&&e["!cols"]||[],w=u.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(_[y]||{}).hidden)switch(h[y]=lr(y),r=g?e[v][y]:e[h[y]+f],n){case 1:i[y]=y-l.s.c;break;case 2:i[y]=h[y];break;case 3:i[y]=u.header[y-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=o=Yi(r,null,u),p=b[o]||0,!p)b[o]=1;else{do c=o+"_"+p++;while(b[c]);b[o]=p,b[c]=1}i[y]=c}for(v=l.s.r+a;v<=l.e.r;++v)if(!(w[v]||{}).hidden){var j=wR(e,l,v,h,n,i,g,u);(j.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(m[x++]=j.row)}return m.length=x,m}var $k=/"/g;function _R(e,t,r,n,a,i,o,c){for(var l=!0,u=[],d="",f=Nr(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var m=c.dense?(e[r]||[])[h]:e[n[h]+f];if(m==null)d="";else if(m.v!=null){l=!1,d=""+(c.rawNumbers&&m.t=="n"?m.v:Yi(m,null,c));for(var x=0,p=0;x!==d.length;++x)if((p=d.charCodeAt(x))===a||p===i||p===34||c.forceQuotes){d='"'+d.replace($k,'""')+'"';break}d=="ID"&&(d='"ID"')}else m.f!=null&&!m.F?(l=!1,d="="+m.f,d.indexOf(",")>=0&&(d='"'+d.replace($k,'""')+'"')):d="";u.push(d)}return c.blankrows===!1&&l?null:u.join(o)}function Fj(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Dt(e["!ref"]),i=n.FS!==void 0?n.FS:",",o=i.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,l=c.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],m=n.skipHidden&&e["!rows"]||[],x=a.s.c;x<=a.e.c;++x)(h[x]||{}).hidden||(f[x]=lr(x));for(var p=0,g=a.s.r;g<=a.e.r;++g)(m[g]||{}).hidden||(d=_R(e,a,g,f,o,l,i,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((p++?c:"")+d)));return delete n.dense,r.join("")}function jR(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Fj(e,t);if(typeof Ct>"u"||t.type=="string")return r;var n=Ct.utils.encode(1200,r,"str");return""+n}function EOe(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Dt(e["!ref"]),i="",o=[],c,l=[],u=Array.isArray(e);for(c=a.s.c;c<=a.e.c;++c)o[c]=lr(c);for(var d=a.s.r;d<=a.e.r;++d)for(i=Nr(d),c=a.s.c;c<=a.e.c;++c)if(t=o[c]+i,r=u?(e[d]||[])[c]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function NR(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},o=0,c=0;if(i&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?yr(n.origin):n.origin;o=l.r,c=l.c}var u,d={s:{c:0,r:0},e:{c,r:o+t.length-1+a}};if(i["!ref"]){var f=Dt(i["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),o==-1&&(o=f.e.r+1,d.e.r=o+t.length-1+a)}else o==-1&&(o=0,d.e.r=t.length-1+a);var h=n.header||[],m=0;t.forEach(function(p,g){Er(p).forEach(function(v){(m=h.indexOf(v))==-1&&(h[m=h.length]=v);var y=p[v],b="z",_="",w=ot({c:c+m,r:o+g+a});u=zf(i,w),y&&typeof y=="object"&&!(y instanceof Date)?i[w]=y:(typeof y=="number"?b="n":typeof y=="boolean"?b="b":typeof y=="string"?b="s":y instanceof Date?(b="d",n.cellDates||(b="n",y=Vr(y)),_=n.dateNF||at[14]):y===null&&n.nullError&&(b="e",y=0),u?(u.t=b,u.v=y,delete u.w,delete u.R,_&&(u.z=_)):i[w]=u={t:b,v:y},_&&(u.z=_))})}),d.e.c=Math.max(d.e.c,c+h.length-1);var x=Nr(o);if(a)for(m=0;m<h.length;++m)i[lr(m+c)+x]={t:"s",v:h[m]};return i["!ref"]=xt(d),i}function TOe(e,t){return NR(null,e,t)}function zf(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=yr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?zf(e,ot(t)):zf(e,ot({r:t,c:r||0}))}function COe(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Oj(){return{SheetNames:[],Sheets:{}}}function Pj(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var o=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=o+a)!=-1;++a);}if(QU(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function AOe(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=COe(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function kOe(e,t){return e.z=t,e}function DR(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function FOe(e,t,r){return DR(e,"#"+t,r)}function OOe(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function POe(e,t,r,n){for(var a=typeof t!="string"?t:Dt(t),i=typeof t=="string"?t:xt(t),o=a.s.r;o<=a.e.r;++o)for(var c=a.s.c;c<=a.e.c;++c){var l=zf(e,o,c);l.t="n",l.F=i,delete l.v,o==a.s.r&&c==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var SR={encode_col:lr,encode_row:Nr,encode_cell:ot,encode_range:xt,decode_col:sj,decode_row:ij,split_cell:QNe,decode_cell:yr,decode_range:Gn,format_cell:Yi,sheet_add_aoa:qI,sheet_add_json:NR,sheet_add_dom:dR,aoa_to_sheet:Pu,json_to_sheet:TOe,table_to_sheet:fR,table_to_book:qFe,sheet_to_csv:Fj,sheet_to_txt:jR,sheet_to_json:Nx,sheet_to_html:uR,sheet_to_formulae:EOe,sheet_to_row_object_array:Nx,sheet_get_cell:zf,book_new:Oj,book_append_sheet:Pj,book_set_sheet_visibility:AOe,cell_set_number_format:kOe,cell_set_hyperlink:DR,cell_set_internal_link:FOe,cell_add_comment:OOe,sheet_set_array_formula:POe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},_g;function IOe(e){_g=e}function UOe(e,t){var r=_g(),n=t??{};if(e==null||e["!ref"]==null)return r.push(null),r;var a=Dt(e["!ref"]),i=n.FS!==void 0?n.FS:",",o=i.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,l=c.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],m=n.skipHidden&&e["!rows"]||[],x=a.s.c;x<=a.e.c;++x)(h[x]||{}).hidden||(f[x]=lr(x));var p=a.s.r,g=!1,v=0;return r._read=function(){if(!g)return g=!0,r.push("\uFEFF");for(;p<=a.e.r;)if(++p,!(m[p-1]||{}).hidden&&(d=_R(e,a,p-1,f,o,l,i,n),d!=null&&(n.strip&&(d=d.replace(u,"")),d||n.blankrows!==!1)))return r.push((v++?c:"")+d);return r.push(null)},r}function ROe(e,t){var r=_g(),n=t||{},a=n.header!=null?n.header:oR,i=n.footer!=null?n.footer:cR;r.push(a);var o=Gn(e["!ref"]);n.dense=Array.isArray(e),r.push(lR(e,o,n));var c=o.s.r,l=!1;return r._read=function(){if(c>o.e.r)return l||(l=!0,r.push("</table>"+i)),r.push(null);for(;c<=o.e.r;){r.push(sR(e,o,c,n)),++c;break}},r}function MOe(e,t){var r=_g({objectMode:!0});if(e==null||e["!ref"]==null)return r.push(null),r;var n={t:"n",v:0},a=0,i=1,o=[],c=0,l="",u={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},f=d.range!=null?d.range:e["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)&&(a=3),typeof f){case"string":u=Dt(f);break;case"number":u=Dt(e["!ref"]),u.s.r=f;break;default:u=f}a>0&&(i=0);var h=Nr(u.s.r),m=[],x=0,p=Array.isArray(e),g=u.s.r,v=0,y={};p&&!e[g]&&(e[g]=[]);var b=d.skipHidden&&e["!cols"]||[],_=d.skipHidden&&e["!rows"]||[];for(v=u.s.c;v<=u.e.c;++v)if(!(b[v]||{}).hidden)switch(m[v]=lr(v),n=p?e[g][v]:e[m[v]+h],a){case 1:o[v]=v-u.s.c;break;case 2:o[v]=m[v];break;case 3:o[v]=d.header[v-u.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),l=c=Yi(n,null,d),x=y[c]||0,!x)y[c]=1;else{do l=c+"_"+x++;while(y[l]);y[c]=x,y[l]=1}o[v]=l}return g=u.s.r+i,r._read=function(){for(;g<=u.e.r;)if(!(_[g-1]||{}).hidden){var w=wR(e,u,g,m,a,o,p,d);if(++g,w.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows)){r.push(w.row);return}}return r.push(null)},r}var BOe={to_json:MOe,to_html:ROe,to_csv:UOe,set_readable:IOe};const LOe=Cf.version,$Oe=Object.freeze(Object.defineProperty({__proto__:null,CFB:et,SSF:NI,parse_xlscfb:Dj,parse_zip:xR,read:Wf,readFile:Bk,readFileSync:Bk,set_cptable:qje,set_fs:yNe,stream:BOe,utils:SR,version:LOe,write:wg,writeFile:Lk,writeFileAsync:SOe,writeFileSync:Lk,writeFileXLSX:DOe,writeXLSX:Aj},Symbol.toStringTag,{value:"Module"})),WOe=({fileUrl:e,fileName:t})=>{const[r,n]=R.useState(null),[a,i]=R.useState([]),[o,c]=R.useState(""),[l,u]=R.useState([]),[d,f]=R.useState([]),[h,m]=R.useState(!0),[x,p]=R.useState(null),[g,v]=R.useState(1),y=50;R.useEffect(()=>{e&&(async()=>{try{m(!0),p(null);const T=await fetch(e);if(!T.ok)throw new Error("Failed to load file");const A=await T.arrayBuffer(),E=new Uint8Array(A),M=Wf(E,{type:"array"});if(M.SheetNames.length===0){p("Excel file has no sheets"),m(!1);return}n(M),i(M.SheetNames),c(M.SheetNames[0]),b(M,M.SheetNames[0]),m(!1)}catch(T){p(T.message),m(!1)}})()},[e]);const b=(S,T)=>{try{const A=S.Sheets[T],E=SR.sheet_to_json(A,{header:1,defval:""});if(E.length===0){f([]),u([]);return}const M=E[0],P=E.slice(1);f(M),u(P),v(1)}catch(A){console.error("Error loading sheet:",A),f([]),u([])}},_=S=>{c(S),b(r,S)};if(h)return s.jsx("div",{className:"flex items-center justify-center h-full min-h-[400px]",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2"}),s.jsx("p",{className:"text-text-secondary",children:"Loading Excel file..."})]})});if(x)return s.jsxs("div",{className:"flex flex-col items-center justify-center h-full min-h-[400px] text-center",children:[s.jsx(G,{name:"AlertCircle",size:48,className:"text-error mb-4"}),s.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-2",children:"Failed to load Excel file"}),s.jsx("p",{className:"text-text-secondary",children:x})]});const w=Math.ceil(l.length/y),j=(g-1)*y,N=j+y,D=l.slice(j,N);return s.jsxs("div",{className:"h-full flex flex-col",children:[a.length>1&&s.jsx("div",{className:"flex items-center space-x-1 px-2 py-2 bg-gray-100 dark:bg-gray-800 rounded-t-lg overflow-x-auto",children:a.map(S=>s.jsx("button",{onClick:()=>_(S),className:`px-4 py-2 text-sm font-medium rounded transition-colors whitespace-nowrap ${o===S?"bg-white dark:bg-gray-700 text-primary shadow":"text-text-secondary hover:text-text-primary hover:bg-gray-50 dark:hover:bg-gray-700/50"}`,children:S},S))}),s.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 px-4 py-2 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4 text-sm text-text-secondary",children:[s.jsxs("span",{children:[s.jsx("strong",{children:l.length})," rows"]}),s.jsx("span",{children:""}),s.jsxs("span",{children:[s.jsx("strong",{children:d.length})," columns"]}),a.length>1&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsxs("span",{children:[s.jsx("strong",{children:a.length})," sheets"]})]})]}),w>1&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>v(S=>Math.max(1,S-1)),disabled:g===1,className:"p-1 rounded hover:bg-white dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(G,{name:"ChevronLeft",size:16})}),s.jsxs("span",{className:"text-sm text-text-secondary",children:["Page ",g," of ",w]}),s.jsx("button",{onClick:()=>v(S=>Math.min(w,S+1)),disabled:g===w,className:"p-1 rounded hover:bg-white dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(G,{name:"ChevronRight",size:16})})]})]}),s.jsx("div",{className:"flex-1 overflow-auto bg-white dark:bg-gray-800 rounded-b-lg",children:d.length===0?s.jsx("div",{className:"flex items-center justify-center h-full min-h-[200px]",children:s.jsx("p",{className:"text-text-secondary",children:"Sheet is empty"})}):s.jsxs("table",{className:"w-full border-collapse",children:[s.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700 sticky top-0",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-text-secondary border-b border-border w-12",children:"#"}),d.map((S,T)=>s.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-text-secondary border-b border-border whitespace-nowrap",children:S||`Column ${T+1}`},T))]})}),s.jsx("tbody",{children:D.map((S,T)=>s.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[s.jsx("td",{className:"px-4 py-2 text-xs text-text-tertiary border-b border-border",children:j+T+1}),d.map((A,E)=>s.jsx("td",{className:"px-4 py-2 text-sm text-text-primary border-b border-border whitespace-nowrap",children:S[E]!==void 0&&S[E]!==null?String(S[E]):""},E))]},j+T))})]})})]})};var Fi={},Ij="1.13.7",Wk=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||Function("return this")()||{},jg=Array.prototype,Uj=Object.prototype,zk=typeof Symbol<"u"?Symbol.prototype:null,zOe=jg.push,Mh=jg.slice,qf=Uj.toString,qOe=Uj.hasOwnProperty,ER=typeof ArrayBuffer<"u",HOe=typeof DataView<"u",VOe=Array.isArray,qk=Object.keys,Hk=Object.create,Vk=ER&&ArrayBuffer.isView,GOe=isNaN,XOe=isFinite,TR=!{toString:null}.propertyIsEnumerable("toString"),Gk=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],KOe=Math.pow(2,53)-1;function Xn(e,t){return t=t==null?e.length-1:+t,function(){for(var r=Math.max(arguments.length-t,0),n=Array(r),a=0;a<r;a++)n[a]=arguments[a+t];switch(t){case 0:return e.call(this,n);case 1:return e.call(this,arguments[0],n);case 2:return e.call(this,arguments[0],arguments[1],n)}var i=Array(t+1);for(a=0;a<t;a++)i[a]=arguments[a];return i[t]=n,e.apply(this,i)}}function To(e){var t=typeof e;return t==="function"||t==="object"&&!!e}function CR(e){return e===null}function Rj(e){return e===void 0}function Mj(e){return e===!0||e===!1||qf.call(e)==="[object Boolean]"}function AR(e){return!!(e&&e.nodeType===1)}function Mn(e){var t="[object "+e+"]";return function(r){return qf.call(r)===t}}const Ng=Mn("String"),Bj=Mn("Number"),kR=Mn("Date"),FR=Mn("RegExp"),OR=Mn("Error"),Lj=Mn("Symbol"),$j=Mn("ArrayBuffer");var PR=Mn("Function"),YOe=Wk.document&&Wk.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof YOe!="function"&&(PR=function(e){return typeof e=="function"||!1});const Un=PR,IR=Mn("Object");var UR=HOe&&(!/\[native code\]/.test(String(DataView))||IR(new DataView(new ArrayBuffer(8)))),Wj=typeof Map<"u"&&IR(new Map),ZOe=Mn("DataView");function JOe(e){return e!=null&&Un(e.getInt8)&&$j(e.buffer)}const Hf=UR?JOe:ZOe,Co=VOe||Mn("Array");function Ao(e,t){return e!=null&&qOe.call(e,t)}var B2=Mn("Arguments");(function(){B2(arguments)||(B2=function(e){return Ao(e,"callee")})})();const Dg=B2;function RR(e){return!Lj(e)&&XOe(e)&&!isNaN(parseFloat(e))}function zj(e){return Bj(e)&&GOe(e)}function qj(e){return function(){return e}}function MR(e){return function(t){var r=e(t);return typeof r=="number"&&r>=0&&r<=KOe}}function BR(e){return function(t){return t==null?void 0:t[e]}}const Dx=BR("byteLength"),QOe=MR(Dx);var e5e=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;function t5e(e){return Vk?Vk(e)&&!Hf(e):QOe(e)&&e5e.test(qf.call(e))}const Hj=ER?t5e:qj(!1),ca=BR("length");function r5e(e){for(var t={},r=e.length,n=0;n<r;++n)t[e[n]]=!0;return{contains:function(a){return t[a]===!0},push:function(a){return t[a]=!0,e.push(a)}}}function LR(e,t){t=r5e(t);var r=Gk.length,n=e.constructor,a=Un(n)&&n.prototype||Uj,i="constructor";for(Ao(e,i)&&!t.contains(i)&&t.push(i);r--;)i=Gk[r],i in e&&e[i]!==a[i]&&!t.contains(i)&&t.push(i)}function Gr(e){if(!To(e))return[];if(qk)return qk(e);var t=[];for(var r in e)Ao(e,r)&&t.push(r);return TR&&LR(e,t),t}function $R(e){if(e==null)return!0;var t=ca(e);return typeof t=="number"&&(Co(e)||Ng(e)||Dg(e))?t===0:ca(Gr(e))===0}function Vj(e,t){var r=Gr(t),n=r.length;if(e==null)return!n;for(var a=Object(e),i=0;i<n;i++){var o=r[i];if(t[o]!==a[o]||!(o in a))return!1}return!0}function Mt(e){if(e instanceof Mt)return e;if(!(this instanceof Mt))return new Mt(e);this._wrapped=e}Mt.VERSION=Ij;Mt.prototype.value=function(){return this._wrapped};Mt.prototype.valueOf=Mt.prototype.toJSON=Mt.prototype.value;Mt.prototype.toString=function(){return String(this._wrapped)};function Xk(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,Dx(e))}var Kk="[object DataView]";function L2(e,t,r,n){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var a=typeof e;return a!=="function"&&a!=="object"&&typeof t!="object"?!1:WR(e,t,r,n)}function WR(e,t,r,n){e instanceof Mt&&(e=e._wrapped),t instanceof Mt&&(t=t._wrapped);var a=qf.call(e);if(a!==qf.call(t))return!1;if(UR&&a=="[object Object]"&&Hf(e)){if(!Hf(t))return!1;a=Kk}switch(a){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return zk.valueOf.call(e)===zk.valueOf.call(t);case"[object ArrayBuffer]":case Kk:return WR(Xk(e),Xk(t),r,n)}var i=a==="[object Array]";if(!i&&Hj(e)){var o=Dx(e);if(o!==Dx(t))return!1;if(e.buffer===t.buffer&&e.byteOffset===t.byteOffset)return!0;i=!0}if(!i){if(typeof e!="object"||typeof t!="object")return!1;var c=e.constructor,l=t.constructor;if(c!==l&&!(Un(c)&&c instanceof c&&Un(l)&&l instanceof l)&&"constructor"in e&&"constructor"in t)return!1}r=r||[],n=n||[];for(var u=r.length;u--;)if(r[u]===e)return n[u]===t;if(r.push(e),n.push(t),i){if(u=e.length,u!==t.length)return!1;for(;u--;)if(!L2(e[u],t[u],r,n))return!1}else{var d=Gr(e),f;if(u=d.length,Gr(t).length!==u)return!1;for(;u--;)if(f=d[u],!(Ao(t,f)&&L2(e[f],t[f],r,n)))return!1}return r.pop(),n.pop(),!0}function zR(e,t){return L2(e,t)}function Uu(e){if(!To(e))return[];var t=[];for(var r in e)t.push(r);return TR&&LR(e,t),t}function Gj(e){var t=ca(e);return function(r){if(r==null)return!1;var n=Uu(r);if(ca(n))return!1;for(var a=0;a<t;a++)if(!Un(r[e[a]]))return!1;return e!==VR||!Un(r[Xj])}}var Xj="forEach",qR="has",Kj=["clear","delete"],HR=["get",qR,"set"],n5e=Kj.concat(Xj,HR),VR=Kj.concat(HR),a5e=["add"].concat(Kj,Xj,qR);const GR=Wj?Gj(n5e):Mn("Map"),XR=Wj?Gj(VR):Mn("WeakMap"),KR=Wj?Gj(a5e):Mn("Set"),YR=Mn("WeakSet");function Rc(e){for(var t=Gr(e),r=t.length,n=Array(r),a=0;a<r;a++)n[a]=e[t[a]];return n}function ZR(e){for(var t=Gr(e),r=t.length,n=Array(r),a=0;a<r;a++)n[a]=[t[a],e[t[a]]];return n}function Yj(e){for(var t={},r=Gr(e),n=0,a=r.length;n<a;n++)t[e[r[n]]]=r[n];return t}function Vf(e){var t=[];for(var r in e)Un(e[r])&&t.push(r);return t.sort()}function Zj(e,t){return function(r){var n=arguments.length;if(t&&(r=Object(r)),n<2||r==null)return r;for(var a=1;a<n;a++)for(var i=arguments[a],o=e(i),c=o.length,l=0;l<c;l++){var u=o[l];(!t||r[u]===void 0)&&(r[u]=i[u])}return r}}const Jj=Zj(Uu),tu=Zj(Gr),Qj=Zj(Uu,!0);function i5e(){return function(){}}function JR(e){if(!To(e))return{};if(Hk)return Hk(e);var t=i5e();t.prototype=e;var r=new t;return t.prototype=null,r}function QR(e,t){var r=JR(e);return t&&tu(r,t),r}function eM(e){return To(e)?Co(e)?e.slice():Jj({},e):e}function tM(e,t){return t(e),e}function eN(e){return Co(e)?e:[e]}Mt.toPath=eN;function Bh(e){return Mt.toPath(e)}function tN(e,t){for(var r=t.length,n=0;n<r;n++){if(e==null)return;e=e[t[n]]}return r?e:void 0}function rN(e,t,r){var n=tN(e,Bh(t));return Rj(n)?r:n}function rM(e,t){t=Bh(t);for(var r=t.length,n=0;n<r;n++){var a=t[n];if(!Ao(e,a))return!1;e=e[a]}return!!r}function Sg(e){return e}function _c(e){return e=tu({},e),function(t){return Vj(t,e)}}function Eg(e){return e=Bh(e),function(t){return tN(t,e)}}function Lh(e,t,r){if(t===void 0)return e;switch(r??3){case 1:return function(n){return e.call(t,n)};case 3:return function(n,a,i){return e.call(t,n,a,i)};case 4:return function(n,a,i,o){return e.call(t,n,a,i,o)}}return function(){return e.apply(t,arguments)}}function nM(e,t,r){return e==null?Sg:Un(e)?Lh(e,t,r):To(e)&&!Co(e)?_c(e):Eg(e)}function Tg(e,t){return nM(e,t,1/0)}Mt.iteratee=Tg;function ua(e,t,r){return Mt.iteratee!==Tg?Mt.iteratee(e,t):nM(e,t,r)}function aM(e,t,r){t=ua(t,r);for(var n=Gr(e),a=n.length,i={},o=0;o<a;o++){var c=n[o];i[c]=t(e[c],c,e)}return i}function nN(){}function iM(e){return e==null?nN:function(t){return rN(e,t)}}function sM(e,t,r){var n=Array(Math.max(0,e));t=Lh(t,r,1);for(var a=0;a<e;a++)n[a]=t(a);return n}function Sx(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}const ru=Date.now||function(){return new Date().getTime()};function oM(e){var t=function(i){return e[i]},r="(?:"+Gr(e).join("|")+")",n=RegExp(r),a=RegExp(r,"g");return function(i){return i=i==null?"":""+i,n.test(i)?i.replace(a,t):i}}const cM={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},lM=oM(cM),s5e=Yj(cM),uM=oM(s5e),dM=Mt.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var vy=/(.)^/,o5e={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},c5e=/\\|'|\r|\n|\u2028|\u2029/g;function l5e(e){return"\\"+o5e[e]}var u5e=/^\s*(\w|\$)+\s*$/;function fM(e,t,r){!t&&r&&(t=r),t=Qj({},t,Mt.templateSettings);var n=RegExp([(t.escape||vy).source,(t.interpolate||vy).source,(t.evaluate||vy).source].join("|")+"|$","g"),a=0,i="__p+='";e.replace(n,function(u,d,f,h,m){return i+=e.slice(a,m).replace(c5e,l5e),a=m+u.length,d?i+=`'+
((__t=(`+d+`))==null?'':_.escape(__t))+
'`:f?i+=`'+
((__t=(`+f+`))==null?'':__t)+
'`:h&&(i+=`';
`+h+`
__p+='`),u}),i+=`';
`;var o=t.variable;if(o){if(!u5e.test(o))throw new Error("variable is not a bare identifier: "+o)}else i=`with(obj||{}){
`+i+`}
`,o="obj";i=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+i+`return __p;
`;var c;try{c=new Function(o,"_",i)}catch(u){throw u.source=i,u}var l=function(u){return c.call(this,u,Mt)};return l.source="function("+o+`){
`+i+"}",l}function hM(e,t,r){t=Bh(t);var n=t.length;if(!n)return Un(r)?r.call(e):r;for(var a=0;a<n;a++){var i=e==null?void 0:e[t[a]];i===void 0&&(i=r,a=n),e=Un(i)?i.call(e):i}return e}var d5e=0;function mM(e){var t=++d5e+"";return e?e+t:t}function pM(e){var t=Mt(e);return t._chain=!0,t}function xM(e,t,r,n,a){if(!(n instanceof t))return e.apply(r,a);var i=JR(e.prototype),o=e.apply(i,a);return To(o)?o:i}var Mc=Xn(function(e,t){var r=Mc.placeholder,n=function(){for(var a=0,i=t.length,o=Array(i),c=0;c<i;c++)o[c]=t[c]===r?arguments[a++]:t[c];for(;a<arguments.length;)o.push(arguments[a++]);return xM(e,n,this,this,o)};return n});Mc.placeholder=Mt;const aN=Xn(function(e,t,r){if(!Un(e))throw new TypeError("Bind must be called on a function");var n=Xn(function(a){return xM(e,n,t,this,r.concat(a))});return n}),Oa=MR(ca);function Bc(e,t,r,n){if(n=n||[],!t&&t!==0)t=1/0;else if(t<=0)return n.concat(e);for(var a=n.length,i=0,o=ca(e);i<o;i++){var c=e[i];if(Oa(c)&&(Co(c)||Dg(c)))if(t>1)Bc(c,t-1,r,n),a=n.length;else for(var l=0,u=c.length;l<u;)n[a++]=c[l++];else r||(n[a++]=c)}return n}const gM=Xn(function(e,t){t=Bc(t,!1,!1);var r=t.length;if(r<1)throw new Error("bindAll must be passed function names");for(;r--;){var n=t[r];e[n]=aN(e[n],e)}return e});function vM(e,t){var r=function(n){var a=r.cache,i=""+(t?t.apply(this,arguments):n);return Ao(a,i)||(a[i]=e.apply(this,arguments)),a[i]};return r.cache={},r}const iN=Xn(function(e,t,r){return setTimeout(function(){return e.apply(null,r)},t)}),yM=Mc(iN,Mt,1);function bM(e,t,r){var n,a,i,o,c=0;r||(r={});var l=function(){c=r.leading===!1?0:ru(),n=null,o=e.apply(a,i),n||(a=i=null)},u=function(){var d=ru();!c&&r.leading===!1&&(c=d);var f=t-(d-c);return a=this,i=arguments,f<=0||f>t?(n&&(clearTimeout(n),n=null),c=d,o=e.apply(a,i),n||(a=i=null)):!n&&r.trailing!==!1&&(n=setTimeout(l,f)),o};return u.cancel=function(){clearTimeout(n),c=0,n=a=i=null},u}function wM(e,t,r){var n,a,i,o,c,l=function(){var d=ru()-a;t>d?n=setTimeout(l,t-d):(n=null,r||(o=e.apply(c,i)),n||(i=c=null))},u=Xn(function(d){return c=this,i=d,a=ru(),n||(n=setTimeout(l,t),r&&(o=e.apply(c,i))),o});return u.cancel=function(){clearTimeout(n),n=i=c=null},u}function _M(e,t){return Mc(t,e)}function Cg(e){return function(){return!e.apply(this,arguments)}}function jM(){var e=arguments,t=e.length-1;return function(){for(var r=t,n=e[t].apply(this,arguments);r--;)n=e[r].call(this,n);return n}}function NM(e,t){return function(){if(--e<1)return t.apply(this,arguments)}}function sN(e,t){var r;return function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=null),r}}const DM=Mc(sN,2);function oN(e,t,r){t=ua(t,r);for(var n=Gr(e),a,i=0,o=n.length;i<o;i++)if(a=n[i],t(e[a],a,e))return a}function SM(e){return function(t,r,n){r=ua(r,n);for(var a=ca(t),i=e>0?0:a-1;i>=0&&i<a;i+=e)if(r(t[i],i,t))return i;return-1}}const Ag=SM(1),cN=SM(-1);function lN(e,t,r,n){r=ua(r,n,1);for(var a=r(t),i=0,o=ca(e);i<o;){var c=Math.floor((i+o)/2);r(e[c])<a?i=c+1:o=c}return i}function EM(e,t,r){return function(n,a,i){var o=0,c=ca(n);if(typeof i=="number")e>0?o=i>=0?i:Math.max(i+c,o):c=i>=0?Math.min(i+1,c):i+c+1;else if(r&&i&&c)return i=r(n,a),n[i]===a?i:-1;if(a!==a)return i=t(Mh.call(n,o,c),zj),i>=0?i+o:-1;for(i=e>0?o:c-1;i>=0&&i<c;i+=e)if(n[i]===a)return i;return-1}}const uN=EM(1,Ag,lN),TM=EM(-1,cN);function Gf(e,t,r){var n=Oa(e)?Ag:oN,a=n(e,t,r);if(a!==void 0&&a!==-1)return e[a]}function CM(e,t){return Gf(e,_c(t))}function Di(e,t,r){t=Lh(t,r);var n,a;if(Oa(e))for(n=0,a=e.length;n<a;n++)t(e[n],n,e);else{var i=Gr(e);for(n=0,a=i.length;n<a;n++)t(e[i[n]],i[n],e)}return e}function Cs(e,t,r){t=ua(t,r);for(var n=!Oa(e)&&Gr(e),a=(n||e).length,i=Array(a),o=0;o<a;o++){var c=n?n[o]:o;i[o]=t(e[c],c,e)}return i}function AM(e){var t=function(r,n,a,i){var o=!Oa(r)&&Gr(r),c=(o||r).length,l=e>0?0:c-1;for(i||(a=r[o?o[l]:l],l+=e);l>=0&&l<c;l+=e){var u=o?o[l]:l;a=n(a,r[u],u,r)}return a};return function(r,n,a,i){var o=arguments.length>=3;return t(r,Lh(n,i,4),a,o)}}const wl=AM(1),Ex=AM(-1);function xo(e,t,r){var n=[];return t=ua(t,r),Di(e,function(a,i,o){t(a,i,o)&&n.push(a)}),n}function kM(e,t,r){return xo(e,Cg(ua(t)),r)}function Tx(e,t,r){t=ua(t,r);for(var n=!Oa(e)&&Gr(e),a=(n||e).length,i=0;i<a;i++){var o=n?n[i]:i;if(!t(e[o],o,e))return!1}return!0}function Cx(e,t,r){t=ua(t,r);for(var n=!Oa(e)&&Gr(e),a=(n||e).length,i=0;i<a;i++){var o=n?n[i]:i;if(t(e[o],o,e))return!0}return!1}function ni(e,t,r,n){return Oa(e)||(e=Rc(e)),(typeof r!="number"||n)&&(r=0),uN(e,t,r)>=0}const FM=Xn(function(e,t,r){var n,a;return Un(t)?a=t:(t=Bh(t),n=t.slice(0,-1),t=t[t.length-1]),Cs(e,function(i){var o=a;if(!o){if(n&&n.length&&(i=tN(i,n)),i==null)return;o=i[t]}return o==null?o:o.apply(i,r)})});function kg(e,t){return Cs(e,Eg(t))}function OM(e,t){return xo(e,_c(t))}function dN(e,t,r){var n=-1/0,a=-1/0,i,o;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=Oa(e)?e:Rc(e);for(var c=0,l=e.length;c<l;c++)i=e[c],i!=null&&i>n&&(n=i)}else t=ua(t,r),Di(e,function(u,d,f){o=t(u,d,f),(o>a||o===-1/0&&n===-1/0)&&(n=u,a=o)});return n}function PM(e,t,r){var n=1/0,a=1/0,i,o;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=Oa(e)?e:Rc(e);for(var c=0,l=e.length;c<l;c++)i=e[c],i!=null&&i<n&&(n=i)}else t=ua(t,r),Di(e,function(u,d,f){o=t(u,d,f),(o<a||o===1/0&&n===1/0)&&(n=u,a=o)});return n}var f5e=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function fN(e){return e?Co(e)?Mh.call(e):Ng(e)?e.match(f5e):Oa(e)?Cs(e,Sg):Rc(e):[]}function hN(e,t,r){if(t==null||r)return Oa(e)||(e=Rc(e)),e[Sx(e.length-1)];var n=fN(e),a=ca(n);t=Math.max(Math.min(t,a),0);for(var i=a-1,o=0;o<t;o++){var c=Sx(o,i),l=n[o];n[o]=n[c],n[c]=l}return n.slice(0,t)}function IM(e){return hN(e,1/0)}function UM(e,t,r){var n=0;return t=ua(t,r),kg(Cs(e,function(a,i,o){return{value:a,index:n++,criteria:t(a,i,o)}}).sort(function(a,i){var o=a.criteria,c=i.criteria;if(o!==c){if(o>c||o===void 0)return 1;if(o<c||c===void 0)return-1}return a.index-i.index}),"value")}function Fg(e,t){return function(r,n,a){var i=t?[[],[]]:{};return n=ua(n,a),Di(r,function(o,c){var l=n(o,c,r);e(i,o,l)}),i}}const RM=Fg(function(e,t,r){Ao(e,r)?e[r].push(t):e[r]=[t]}),MM=Fg(function(e,t,r){e[r]=t}),BM=Fg(function(e,t,r){Ao(e,r)?e[r]++:e[r]=1}),LM=Fg(function(e,t,r){e[r?0:1].push(t)},!0);function $M(e){return e==null?0:Oa(e)?e.length:Gr(e).length}function h5e(e,t,r){return t in r}const mN=Xn(function(e,t){var r={},n=t[0];if(e==null)return r;Un(n)?(t.length>1&&(n=Lh(n,t[1])),t=Uu(e)):(n=h5e,t=Bc(t,!1,!1),e=Object(e));for(var a=0,i=t.length;a<i;a++){var o=t[a],c=e[o];n(c,o,e)&&(r[o]=c)}return r}),WM=Xn(function(e,t){var r=t[0],n;return Un(r)?(r=Cg(r),t.length>1&&(n=t[1])):(t=Cs(Bc(t,!1,!1),String),r=function(a,i){return!ni(t,i)}),mN(e,r,n)});function pN(e,t,r){return Mh.call(e,0,Math.max(0,e.length-(t==null||r?1:t)))}function _l(e,t,r){return e==null||e.length<1?t==null||r?void 0:[]:t==null||r?e[0]:pN(e,e.length-t)}function lc(e,t,r){return Mh.call(e,t==null||r?1:t)}function zM(e,t,r){return e==null||e.length<1?t==null||r?void 0:[]:t==null||r?e[e.length-1]:lc(e,Math.max(0,e.length-t))}function qM(e){return xo(e,Boolean)}function HM(e,t){return Bc(e,t,!1)}const xN=Xn(function(e,t){return t=Bc(t,!0,!0),xo(e,function(r){return!ni(t,r)})}),VM=Xn(function(e,t){return xN(e,t)});function Xf(e,t,r,n){Mj(t)||(n=r,r=t,t=!1),r!=null&&(r=ua(r,n));for(var a=[],i=[],o=0,c=ca(e);o<c;o++){var l=e[o],u=r?r(l,o,e):l;t&&!r?((!o||i!==u)&&a.push(l),i=u):r?ni(i,u)||(i.push(u),a.push(l)):ni(a,l)||a.push(l)}return a}const GM=Xn(function(e){return Xf(Bc(e,!0,!0))});function XM(e){for(var t=[],r=arguments.length,n=0,a=ca(e);n<a;n++){var i=e[n];if(!ni(t,i)){var o;for(o=1;o<r&&ni(arguments[o],i);o++);o===r&&t.push(i)}}return t}function Kf(e){for(var t=e&&dN(e,ca).length||0,r=Array(t),n=0;n<t;n++)r[n]=kg(e,n);return r}const KM=Xn(Kf);function YM(e,t){for(var r={},n=0,a=ca(e);n<a;n++)t?r[e[n]]=t[n]:r[e[n][0]]=e[n][1];return r}function ZM(e,t,r){t==null&&(t=e||0,e=0),r||(r=t<e?-1:1);for(var n=Math.max(Math.ceil((t-e)/r),0),a=Array(n),i=0;i<n;i++,e+=r)a[i]=e;return a}function JM(e,t){if(t==null||t<1)return[];for(var r=[],n=0,a=e.length;n<a;)r.push(Mh.call(e,n,n+=t));return r}function gN(e,t){return e._chain?Mt(t).chain():t}function vN(e){return Di(Vf(e),function(t){var r=Mt[t]=e[t];Mt.prototype[t]=function(){var n=[this._wrapped];return zOe.apply(n,arguments),gN(this,r.apply(Mt,n))}}),Mt}Di(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=jg[e];Mt.prototype[e]=function(){var r=this._wrapped;return r!=null&&(t.apply(r,arguments),(e==="shift"||e==="splice")&&r.length===0&&delete r[0]),gN(this,r)}});Di(["concat","join","slice"],function(e){var t=jg[e];Mt.prototype[e]=function(){var r=this._wrapped;return r!=null&&(r=t.apply(r,arguments)),gN(this,r)}});const m5e=Object.freeze(Object.defineProperty({__proto__:null,VERSION:Ij,after:NM,all:Tx,allKeys:Uu,any:Cx,assign:tu,before:sN,bind:aN,bindAll:gM,chain:pM,chunk:JM,clone:eM,collect:Cs,compact:qM,compose:jM,constant:qj,contains:ni,countBy:BM,create:QR,debounce:wM,default:Mt,defaults:Qj,defer:yM,delay:iN,detect:Gf,difference:xN,drop:lc,each:Di,escape:lM,every:Tx,extend:Jj,extendOwn:tu,filter:xo,find:Gf,findIndex:Ag,findKey:oN,findLastIndex:cN,findWhere:CM,first:_l,flatten:HM,foldl:wl,foldr:Ex,forEach:Di,functions:Vf,get:rN,groupBy:RM,has:rM,head:_l,identity:Sg,include:ni,includes:ni,indexBy:MM,indexOf:uN,initial:pN,inject:wl,intersection:XM,invert:Yj,invoke:FM,isArguments:Dg,isArray:Co,isArrayBuffer:$j,isBoolean:Mj,isDataView:Hf,isDate:kR,isElement:AR,isEmpty:$R,isEqual:zR,isError:OR,isFinite:RR,isFunction:Un,isMap:GR,isMatch:Vj,isNaN:zj,isNull:CR,isNumber:Bj,isObject:To,isRegExp:FR,isSet:KR,isString:Ng,isSymbol:Lj,isTypedArray:Hj,isUndefined:Rj,isWeakMap:XR,isWeakSet:YR,iteratee:Tg,keys:Gr,last:zM,lastIndexOf:TM,map:Cs,mapObject:aM,matcher:_c,matches:_c,max:dN,memoize:vM,methods:Vf,min:PM,mixin:vN,negate:Cg,noop:nN,now:ru,object:YM,omit:WM,once:DM,pairs:ZR,partial:Mc,partition:LM,pick:mN,pluck:kg,property:Eg,propertyOf:iM,random:Sx,range:ZM,reduce:wl,reduceRight:Ex,reject:kM,rest:lc,restArguments:Xn,result:hM,sample:hN,select:xo,shuffle:IM,size:$M,some:Cx,sortBy:UM,sortedIndex:lN,tail:lc,take:_l,tap:tM,template:fM,templateSettings:dM,throttle:bM,times:sM,toArray:fN,toPath:eN,transpose:Kf,unescape:uM,union:GM,uniq:Xf,unique:Xf,uniqueId:mM,unzip:Kf,values:Rc,where:OM,without:VM,wrap:_M,zip:KM},Symbol.toStringTag,{value:"Module"}));var $2=vN(m5e);$2._=$2;const p5e=Object.freeze(Object.defineProperty({__proto__:null,VERSION:Ij,after:NM,all:Tx,allKeys:Uu,any:Cx,assign:tu,before:sN,bind:aN,bindAll:gM,chain:pM,chunk:JM,clone:eM,collect:Cs,compact:qM,compose:jM,constant:qj,contains:ni,countBy:BM,create:QR,debounce:wM,default:$2,defaults:Qj,defer:yM,delay:iN,detect:Gf,difference:xN,drop:lc,each:Di,escape:lM,every:Tx,extend:Jj,extendOwn:tu,filter:xo,find:Gf,findIndex:Ag,findKey:oN,findLastIndex:cN,findWhere:CM,first:_l,flatten:HM,foldl:wl,foldr:Ex,forEach:Di,functions:Vf,get:rN,groupBy:RM,has:rM,head:_l,identity:Sg,include:ni,includes:ni,indexBy:MM,indexOf:uN,initial:pN,inject:wl,intersection:XM,invert:Yj,invoke:FM,isArguments:Dg,isArray:Co,isArrayBuffer:$j,isBoolean:Mj,isDataView:Hf,isDate:kR,isElement:AR,isEmpty:$R,isEqual:zR,isError:OR,isFinite:RR,isFunction:Un,isMap:GR,isMatch:Vj,isNaN:zj,isNull:CR,isNumber:Bj,isObject:To,isRegExp:FR,isSet:KR,isString:Ng,isSymbol:Lj,isTypedArray:Hj,isUndefined:Rj,isWeakMap:XR,isWeakSet:YR,iteratee:Tg,keys:Gr,last:zM,lastIndexOf:TM,map:Cs,mapObject:aM,matcher:_c,matches:_c,max:dN,memoize:vM,methods:Vf,min:PM,mixin:vN,negate:Cg,noop:nN,now:ru,object:YM,omit:WM,once:DM,pairs:ZR,partial:Mc,partition:LM,pick:mN,pluck:kg,property:Eg,propertyOf:iM,random:Sx,range:ZM,reduce:wl,reduceRight:Ex,reject:kM,rest:lc,restArguments:Xn,result:hM,sample:hN,select:xo,shuffle:IM,size:$M,some:Cx,sortBy:UM,sortedIndex:lN,tail:lc,take:_l,tap:tM,template:fM,templateSettings:dM,throttle:bM,times:sM,toArray:fN,toPath:eN,transpose:Kf,unescape:uM,union:GM,uniq:Xf,unique:Xf,uniqueId:mM,unzip:Kf,values:Rc,where:OM,without:VM,wrap:_M,zip:KM},Symbol.toStringTag,{value:"Module"})),Or=VL(p5e);var yN={},cn={},QM={exports:{}},Sm={exports:{}},Yk;function Ru(){if(Yk)return Sm.exports;Yk=1;var e=function(){return this===void 0}();if(e)Sm.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:e,propertyIsWritable:function(d,f){var h=Object.getOwnPropertyDescriptor(d,f);return!!(!h||h.writable||h.set)}};else{var t={}.hasOwnProperty,r={}.toString,n={}.constructor.prototype,a=function(d){var f=[];for(var h in d)t.call(d,h)&&f.push(h);return f},i=function(d,f){return{value:d[f]}},o=function(d,f,h){return d[f]=h.value,d},c=function(d){return d},l=function(d){try{return Object(d).constructor.prototype}catch{return n}},u=function(d){try{return r.call(d)==="[object Array]"}catch{return!1}};Sm.exports={isArray:u,keys:a,names:a,defineProperty:o,getDescriptor:i,freeze:c,getPrototypeOf:l,isES5:e,propertyIsWritable:function(){return!0}}}return Sm.exports}var yy,Zk;function nr(){if(Zk)return yy;Zk=1;var e={},t=Ru(),r=typeof navigator>"u",n={e:{}},a,i=typeof self<"u"?self:typeof window<"u"?window:typeof gt<"u"?gt:gt!==void 0?gt:null;function o(){try{var k=a;return a=null,k.apply(this,arguments)}catch(z){return n.e=z,n}}function c(k){return a=k,o}var l=function(k,z){var V={}.hasOwnProperty;function Z(){this.constructor=k,this.constructor$=z;for(var ce in z.prototype)V.call(z.prototype,ce)&&ce.charAt(ce.length-1)!=="$"&&(this[ce+"$"]=z.prototype[ce])}return Z.prototype=z.prototype,k.prototype=new Z,k.prototype};function u(k){return k==null||k===!0||k===!1||typeof k=="string"||typeof k=="number"}function d(k){return typeof k=="function"||typeof k=="object"&&k!==null}function f(k){return u(k)?new Error(N(k)):k}function h(k,z){var V=k.length,Z=new Array(V+1),ce;for(ce=0;ce<V;++ce)Z[ce]=k[ce];return Z[ce]=z,Z}function m(k,z,V){if(t.isES5){var Z=Object.getOwnPropertyDescriptor(k,z);if(Z!=null)return Z.get==null&&Z.set==null?Z.value:V}else return{}.hasOwnProperty.call(k,z)?k[z]:void 0}function x(k,z,V){if(u(k))return k;var Z={value:V,configurable:!0,enumerable:!1,writable:!0};return t.defineProperty(k,z,Z),k}function p(k){throw k}var g=function(){var k=[Array.prototype,Object.prototype,Function.prototype],z=function(ce){for(var ie=0;ie<k.length;++ie)if(k[ie]===ce)return!0;return!1};if(t.isES5){var V=Object.getOwnPropertyNames;return function(ce){for(var ie=[],Q=Object.create(null);ce!=null&&!z(ce);){var ne;try{ne=V(ce)}catch{return ie}for(var pe=0;pe<ne.length;++pe){var W=ne[pe];if(!Q[W]){Q[W]=!0;var re=Object.getOwnPropertyDescriptor(ce,W);re!=null&&re.get==null&&re.set==null&&ie.push(W)}}ce=t.getPrototypeOf(ce)}return ie}}else{var Z={}.hasOwnProperty;return function(ce){if(z(ce))return[];var ie=[];e:for(var Q in ce)if(Z.call(ce,Q))ie.push(Q);else{for(var ne=0;ne<k.length;++ne)if(Z.call(k[ne],Q))continue e;ie.push(Q)}return ie}}}(),v=/this\s*\.\s*\S+\s*=/;function y(k){try{if(typeof k=="function"){var z=t.names(k.prototype),V=t.isES5&&z.length>1,Z=z.length>0&&!(z.length===1&&z[0]==="constructor"),ce=v.test(k+"")&&t.names(k).length>0;if(V||Z||ce)return!0}return!1}catch{return!1}}function b(k){return k}var _=/^[a-z$_][a-z$_0-9]*$/i;function w(k){return _.test(k)}function j(k,z,V){for(var Z=new Array(k),ce=0;ce<k;++ce)Z[ce]=z+ce+V;return Z}function N(k){try{return k+""}catch{return"[no string representation]"}}function D(k){return k!==null&&typeof k=="object"&&typeof k.message=="string"&&typeof k.name=="string"}function S(k){try{x(k,"isOperational",!0)}catch{}}function T(k){return k==null?!1:k instanceof Error.__BluebirdErrorTypes__.OperationalError||k.isOperational===!0}function A(k){return D(k)&&t.propertyIsWritable(k,"stack")}var E=function(){return"stack"in new Error?function(k){return A(k)?k:new Error(N(k))}:function(k){if(A(k))return k;try{throw new Error(N(k))}catch(z){return z}}}();function M(k){return{}.toString.call(k)}function P(k,z,V){for(var Z=t.names(k),ce=0;ce<Z.length;++ce){var ie=Z[ce];if(V(ie))try{t.defineProperty(z,ie,t.getDescriptor(k,ie))}catch{}}}var X=function(k){return t.isArray(k)?k:null};if(typeof Symbol<"u"&&Symbol.iterator){var q=typeof Array.from=="function"?function(k){return Array.from(k)}:function(k){for(var z=[],V=k[Symbol.iterator](),Z;!(Z=V.next()).done;)z.push(Z.value);return z};X=function(k){return t.isArray(k)?k:k!=null&&typeof k[Symbol.iterator]=="function"?q(k):null}}var B=typeof process<"u"&&M(process).toLowerCase()==="[object process]",O=typeof process<"u"&&typeof e<"u";function F(k){return O?e[k]:void 0}function I(){if(typeof Promise=="function")try{var k=new Promise(function(){});if({}.toString.call(k)==="[object Promise]")return Promise}catch{}}function L(k,z){return k.bind(z)}var C={isClass:y,isIdentifier:w,inheritedDataKeys:g,getDataPropertyOrDefault:m,thrower:p,isArray:t.isArray,asArray:X,notEnumerableProp:x,isPrimitive:u,isObject:d,isError:D,canEvaluate:r,errorObj:n,tryCatch:c,inherits:l,withAppended:h,maybeWrapAsError:f,toFastProperties:b,filledRange:j,toString:N,canAttachTrace:A,ensureErrorObject:E,originatesFromRejection:T,markAsOriginatingFromRejection:S,classString:M,copyDescriptors:P,hasDevTools:typeof chrome<"u"&&chrome&&typeof chrome.loadTimes=="function",isNode:B,hasEnvVariables:O,env:F,global:i,getNativePromise:I,domainBind:L};C.isRecentNode=C.isNode&&function(){var k=process.versions.node.split(".").map(Number);return k[0]===0&&k[1]>10||k[0]>0}(),C.isNode&&C.toFastProperties(process);try{throw new Error}catch(k){C.lastLineError=k}return yy=C,yy}var Em={exports:{}},by,Jk;function x5e(){if(Jk)return by;Jk=1;var e=nr(),t,r=function(){throw new Error(`No async scheduler available

    See http://goo.gl/MqrFmX
`)},n=e.getNativePromise();if(e.isNode&&typeof MutationObserver>"u"){var a=gt.setImmediate,i=process.nextTick;t=e.isRecentNode?function(c){a.call(gt,c)}:function(c){i.call(process,c)}}else if(typeof n=="function"&&typeof n.resolve=="function"){var o=n.resolve();t=function(c){o.then(c)}}else typeof MutationObserver<"u"&&!(typeof window<"u"&&window.navigator&&(window.navigator.standalone||window.cordova))?t=function(){var c=document.createElement("div"),l={attributes:!0},u=!1,d=document.createElement("div"),f=new MutationObserver(function(){c.classList.toggle("foo"),u=!1});f.observe(d,l);var h=function(){u||(u=!0,d.classList.toggle("foo"))};return function(x){var p=new MutationObserver(function(){p.disconnect(),x()});p.observe(c,l),h()}}():typeof setImmediate<"u"?t=function(c){setImmediate(c)}:typeof setTimeout<"u"?t=function(c){setTimeout(c,0)}:t=r;return by=t,by}var wy,Qk;function g5e(){if(Qk)return wy;Qk=1;function e(r,n,a,i,o){for(var c=0;c<o;++c)a[c+i]=r[c+n],r[c+n]=void 0}function t(r){this._capacity=r,this._length=0,this._front=0}return t.prototype._willBeOverCapacity=function(r){return this._capacity<r},t.prototype._pushOne=function(r){var n=this.length();this._checkCapacity(n+1);var a=this._front+n&this._capacity-1;this[a]=r,this._length=n+1},t.prototype.push=function(r,n,a){var i=this.length()+3;if(this._willBeOverCapacity(i)){this._pushOne(r),this._pushOne(n),this._pushOne(a);return}var o=this._front+i-3;this._checkCapacity(i);var c=this._capacity-1;this[o+0&c]=r,this[o+1&c]=n,this[o+2&c]=a,this._length=i},t.prototype.shift=function(){var r=this._front,n=this[r];return this[r]=void 0,this._front=r+1&this._capacity-1,this._length--,n},t.prototype.length=function(){return this._length},t.prototype._checkCapacity=function(r){this._capacity<r&&this._resizeTo(this._capacity<<1)},t.prototype._resizeTo=function(r){var n=this._capacity;this._capacity=r;var a=this._front,i=this._length,o=a+i&n-1;e(this,0,this,n,o)},wy=t,wy}var e3;function v5e(){if(e3)return Em.exports;e3=1;var e;try{throw new Error}catch(l){e=l}var t=x5e(),r=g5e(),n=nr();function a(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new r(16),this._normalQueue=new r(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var l=this;this.drainQueues=function(){l._drainQueues()},this._schedule=t}a.prototype.setScheduler=function(l){var u=this._schedule;return this._schedule=l,this._customScheduler=!0,u},a.prototype.hasCustomScheduler=function(){return this._customScheduler},a.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},a.prototype.disableTrampolineIfNecessary=function(){n.hasDevTools&&(this._trampolineEnabled=!1)},a.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},a.prototype.fatalError=function(l,u){u?(process.stderr.write("Fatal "+(l instanceof Error?l.stack:l)+`
`),process.exit(2)):this.throwLater(l)},a.prototype.throwLater=function(l,u){if(arguments.length===1&&(u=l,l=function(){throw u}),typeof setTimeout<"u")setTimeout(function(){l(u)},0);else try{this._schedule(function(){l(u)})}catch{throw new Error(`No async scheduler available

    See http://goo.gl/MqrFmX
`)}};function i(l,u,d){this._lateQueue.push(l,u,d),this._queueTick()}function o(l,u,d){this._normalQueue.push(l,u,d),this._queueTick()}function c(l){this._normalQueue._pushOne(l),this._queueTick()}return n.hasDevTools?(a.prototype.invokeLater=function(l,u,d){this._trampolineEnabled?i.call(this,l,u,d):this._schedule(function(){setTimeout(function(){l.call(u,d)},100)})},a.prototype.invoke=function(l,u,d){this._trampolineEnabled?o.call(this,l,u,d):this._schedule(function(){l.call(u,d)})},a.prototype.settlePromises=function(l){this._trampolineEnabled?c.call(this,l):this._schedule(function(){l._settlePromises()})}):(a.prototype.invokeLater=i,a.prototype.invoke=o,a.prototype.settlePromises=c),a.prototype._drainQueue=function(l){for(;l.length()>0;){var u=l.shift();if(typeof u!="function"){u._settlePromises();continue}var d=l.shift(),f=l.shift();u.call(d,f)}},a.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},a.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},a.prototype._reset=function(){this._isTickUsed=!1},Em.exports=a,Em.exports.firstLineError=e,Em.exports}var _y,t3;function go(){if(t3)return _y;t3=1;var e=Ru(),t=e.freeze,r=nr(),n=r.inherits,a=r.notEnumerableProp;function i(v,y){function b(_){if(!(this instanceof b))return new b(_);a(this,"message",typeof _=="string"?_:y),a(this,"name",v),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return n(b,Error),b}var o,c,l=i("Warning","warning"),u=i("CancellationError","cancellation error"),d=i("TimeoutError","timeout error"),f=i("AggregateError","aggregate error");try{o=TypeError,c=RangeError}catch{o=i("TypeError","type error"),c=i("RangeError","range error")}for(var h="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),m=0;m<h.length;++m)typeof Array.prototype[h[m]]=="function"&&(f.prototype[h[m]]=Array.prototype[h[m]]);e.defineProperty(f.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),f.prototype.isOperational=!0;var x=0;f.prototype.toString=function(){var v=Array(x*4+1).join(" "),y=`
`+v+`AggregateError of:
`;x++,v=Array(x*4+1).join(" ");for(var b=0;b<this.length;++b){for(var _=this[b]===this?"[Circular AggregateError]":this[b]+"",w=_.split(`
`),j=0;j<w.length;++j)w[j]=v+w[j];_=w.join(`
`),y+=_+`
`}return x--,y};function p(v){if(!(this instanceof p))return new p(v);a(this,"name","OperationalError"),a(this,"message",v),this.cause=v,this.isOperational=!0,v instanceof Error?(a(this,"message",v.message),a(this,"stack",v.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}n(p,Error);var g=Error.__BluebirdErrorTypes__;return g||(g=t({CancellationError:u,TimeoutError:d,OperationalError:p,RejectionError:p,AggregateError:f}),e.defineProperty(Error,"__BluebirdErrorTypes__",{value:g,writable:!1,enumerable:!1,configurable:!1})),_y={Error,TypeError:o,RangeError:c,CancellationError:g.CancellationError,OperationalError:g.OperationalError,TimeoutError:g.TimeoutError,AggregateError:g.AggregateError,Warning:l},_y}var jy,r3;function y5e(){return r3||(r3=1,jy=function(e,t){var r=nr(),n=r.errorObj,a=r.isObject;function i(f,h){if(a(f)){if(f instanceof e)return f;var m=c(f);if(m===n){h&&h._pushContext();var x=e.reject(m.e);return h&&h._popContext(),x}else if(typeof m=="function"){if(u(f)){var x=new e(t);return f._then(x._fulfill,x._reject,void 0,x,null),x}return d(f,m,h)}}return f}function o(f){return f.then}function c(f){try{return o(f)}catch(h){return n.e=h,n}}var l={}.hasOwnProperty;function u(f){try{return l.call(f,"_promise0")}catch{return!1}}function d(f,h,m){var x=new e(t),p=x;m&&m._pushContext(),x._captureStackTrace(),m&&m._popContext();var g=!0,v=r.tryCatch(h).call(f,y,b);g=!1,x&&v===n&&(x._rejectCallback(v.e,!0,!0),x=null);function y(_){x&&(x._resolveCallback(_),x=null)}function b(_){x&&(x._rejectCallback(_,g,!0),x=null)}return p}return i}),jy}var Ny,n3;function b5e(){return n3||(n3=1,Ny=function(e,t,r,n,a){var i=nr();i.isArray;function o(l){switch(l){case-2:return[];case-3:return{}}}function c(l){var u=this._promise=new e(t);l instanceof e&&u._propagateFrom(l,3),u._setOnCancel(this),this._values=l,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return i.inherits(c,a),c.prototype.length=function(){return this._length},c.prototype.promise=function(){return this._promise},c.prototype._init=function l(u,d){var f=r(this._values,this._promise);if(f instanceof e){f=f._target();var h=f._bitField;if(this._values=f,h&50397184)if(h&33554432)f=f._value();else return h&16777216?this._reject(f._reason()):this._cancel();else return this._promise._setAsyncGuaranteed(),f._then(l,this._reject,void 0,this,d)}if(f=i.asArray(f),f===null){var m=n("expecting an array or an iterable object but got "+i.classString(f)).reason();this._promise._rejectCallback(m,!1);return}if(f.length===0){d===-5?this._resolveEmptyArray():this._resolve(o(d));return}this._iterate(f)},c.prototype._iterate=function(l){var u=this.getActualLength(l.length);this._length=u,this._values=this.shouldCopyValues()?new Array(u):this._values;for(var d=this._promise,f=!1,h=null,m=0;m<u;++m){var x=r(l[m],d);x instanceof e?(x=x._target(),h=x._bitField):h=null,f?h!==null&&x.suppressUnhandledRejections():h!==null?h&50397184?h&33554432?f=this._promiseFulfilled(x._value(),m):h&16777216?f=this._promiseRejected(x._reason(),m):f=this._promiseCancelled(m):(x._proxy(this,m),this._values[m]=x):f=this._promiseFulfilled(x,m)}f||d._setAsyncGuaranteed()},c.prototype._isResolved=function(){return this._values===null},c.prototype._resolve=function(l){this._values=null,this._promise._fulfill(l)},c.prototype._cancel=function(){this._isResolved()||!this._promise._isCancellable()||(this._values=null,this._promise._cancel())},c.prototype._reject=function(l){this._values=null,this._promise._rejectCallback(l,!1)},c.prototype._promiseFulfilled=function(l,u){this._values[u]=l;var d=++this._totalResolved;return d>=this._length?(this._resolve(this._values),!0):!1},c.prototype._promiseCancelled=function(){return this._cancel(),!0},c.prototype._promiseRejected=function(l){return this._totalResolved++,this._reject(l),!0},c.prototype._resultCancelled=function(){if(!this._isResolved()){var l=this._values;if(this._cancel(),l instanceof e)l.cancel();else for(var u=0;u<l.length;++u)l[u]instanceof e&&l[u].cancel()}},c.prototype.shouldCopyValues=function(){return!0},c.prototype.getActualLength=function(l){return l},c}),Ny}var Dy,a3;function w5e(){return a3||(a3=1,Dy=function(e){var t=!1,r=[];e.prototype._promiseCreated=function(){},e.prototype._pushContext=function(){},e.prototype._popContext=function(){return null},e._peekContext=e.prototype._peekContext=function(){};function n(){this._trace=new n.CapturedTrace(i())}n.prototype._pushContext=function(){this._trace!==void 0&&(this._trace._promiseCreated=null,r.push(this._trace))},n.prototype._popContext=function(){if(this._trace!==void 0){var o=r.pop(),c=o._promiseCreated;return o._promiseCreated=null,c}return null};function a(){if(t)return new n}function i(){var o=r.length-1;if(o>=0)return r[o]}return n.CapturedTrace=null,n.create=a,n.deactivateLongStackTraces=function(){},n.activateLongStackTraces=function(){var o=e.prototype._pushContext,c=e.prototype._popContext,l=e._peekContext,u=e.prototype._peekContext,d=e.prototype._promiseCreated;n.deactivateLongStackTraces=function(){e.prototype._pushContext=o,e.prototype._popContext=c,e._peekContext=l,e.prototype._peekContext=u,e.prototype._promiseCreated=d,t=!1},t=!0,e.prototype._pushContext=n.prototype._pushContext,e.prototype._popContext=n.prototype._popContext,e._peekContext=e.prototype._peekContext=i,e.prototype._promiseCreated=function(){var f=this._peekContext();f&&f._promiseCreated==null&&(f._promiseCreated=this)}},n}),Dy}var Sy,i3;function _5e(){return i3||(i3=1,Sy=function(e,t){var r=e._getDomain,n=e._async,a=go().Warning,i=nr(),o=i.canAttachTrace,c,l,u=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,d=/\((?:timers\.js):\d+:\d+\)/,f=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,h=null,m=null,x=!1,p,g=!!(i.env("BLUEBIRD_DEBUG")!=0&&(i.env("BLUEBIRD_DEBUG")||i.env("NODE_ENV")==="development")),v=!!(i.env("BLUEBIRD_WARNINGS")!=0&&(g||i.env("BLUEBIRD_WARNINGS"))),y=!!(i.env("BLUEBIRD_LONG_STACK_TRACES")!=0&&(g||i.env("BLUEBIRD_LONG_STACK_TRACES"))),b=i.env("BLUEBIRD_W_FORGOTTEN_RETURN")!=0&&(v||!!i.env("BLUEBIRD_W_FORGOTTEN_RETURN"));e.prototype.suppressUnhandledRejections=function(){var ee=this._target();ee._bitField=ee._bitField&-1048577|524288},e.prototype._ensurePossibleRejectionHandled=function(){this._bitField&524288||(this._setRejectionIsUnhandled(),n.invokeLater(this._notifyUnhandledRejection,this,void 0))},e.prototype._notifyUnhandledRejectionIsHandled=function(){W("rejectionHandled",c,void 0,this)},e.prototype._setReturnedNonUndefined=function(){this._bitField=this._bitField|268435456},e.prototype._returnedNonUndefined=function(){return(this._bitField&268435456)!==0},e.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var ee=this._settledValue();this._setUnhandledRejectionIsNotified(),W("unhandledRejection",l,ee,this)}},e.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=this._bitField|262144},e.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=this._bitField&-262145},e.prototype._isUnhandledRejectionNotified=function(){return(this._bitField&262144)>0},e.prototype._setRejectionIsUnhandled=function(){this._bitField=this._bitField|1048576},e.prototype._unsetRejectionIsUnhandled=function(){this._bitField=this._bitField&-1048577,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},e.prototype._isRejectionUnhandled=function(){return(this._bitField&1048576)>0},e.prototype._warn=function(ee,ae,xe){return z(ee,ae,xe||this)},e.onPossiblyUnhandledRejection=function(ee){var ae=r();l=typeof ee=="function"?ae===null?ee:i.domainBind(ae,ee):void 0},e.onUnhandledRejectionHandled=function(ee){var ae=r();c=typeof ee=="function"?ae===null?ee:i.domainBind(ae,ee):void 0};var _=function(){};e.longStackTraces=function(){if(n.haveItemsQueued()&&!he.longStackTraces)throw new Error(`cannot enable long stack traces after promises have been created

    See http://goo.gl/MqrFmX
`);if(!he.longStackTraces&&se()){var ee=e.prototype._captureStackTrace,ae=e.prototype._attachExtraTrace;he.longStackTraces=!0,_=function(){if(n.haveItemsQueued()&&!he.longStackTraces)throw new Error(`cannot enable long stack traces after promises have been created

    See http://goo.gl/MqrFmX
`);e.prototype._captureStackTrace=ee,e.prototype._attachExtraTrace=ae,t.deactivateLongStackTraces(),n.enableTrampoline(),he.longStackTraces=!1},e.prototype._captureStackTrace=I,e.prototype._attachExtraTrace=L,t.activateLongStackTraces(),n.disableTrampolineIfNecessary()}},e.hasLongStackTraces=function(){return he.longStackTraces&&se()};var w=function(){try{if(typeof CustomEvent=="function"){var ee=new CustomEvent("CustomEvent");return i.global.dispatchEvent(ee),function(ae,xe){var ye=new CustomEvent(ae.toLowerCase(),{detail:xe,cancelable:!0});return!i.global.dispatchEvent(ye)}}else if(typeof Event=="function"){var ee=new Event("CustomEvent");return i.global.dispatchEvent(ee),function(xe,ye){var Ce=new Event(xe.toLowerCase(),{cancelable:!0});return Ce.detail=ye,!i.global.dispatchEvent(Ce)}}else{var ee=document.createEvent("CustomEvent");return ee.initCustomEvent("testingtheevent",!1,!0,{}),i.global.dispatchEvent(ee),function(xe,ye){var Ce=document.createEvent("CustomEvent");return Ce.initCustomEvent(xe.toLowerCase(),!1,!0,ye),!i.global.dispatchEvent(Ce)}}}catch{}return function(){return!1}}(),j=function(){return i.isNode?function(){return process.emit.apply(process,arguments)}:i.global?function(ee){var ae="on"+ee.toLowerCase(),xe=i.global[ae];return xe?(xe.apply(i.global,[].slice.call(arguments,1)),!0):!1}:function(){return!1}}();function N(ee,ae){return{promise:ae}}var D={promiseCreated:N,promiseFulfilled:N,promiseRejected:N,promiseResolved:N,promiseCancelled:N,promiseChained:function(ee,ae,xe){return{promise:ae,child:xe}},warning:function(ee,ae){return{warning:ae}},unhandledRejection:function(ee,ae,xe){return{reason:ae,promise:xe}},rejectionHandled:N},S=function(ee){var ae=!1;try{ae=j.apply(null,arguments)}catch(ye){n.throwLater(ye),ae=!0}var xe=!1;try{xe=w(ee,D[ee].apply(null,arguments))}catch(ye){n.throwLater(ye),xe=!0}return xe||ae};e.config=function(ee){if(ee=Object(ee),"longStackTraces"in ee&&(ee.longStackTraces?e.longStackTraces():!ee.longStackTraces&&e.hasLongStackTraces()&&_()),"warnings"in ee){var ae=ee.warnings;he.warnings=!!ae,b=he.warnings,i.isObject(ae)&&"wForgottenReturn"in ae&&(b=!!ae.wForgottenReturn)}if("cancellation"in ee&&ee.cancellation&&!he.cancellation){if(n.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");e.prototype._clearCancellationData=X,e.prototype._propagateFrom=q,e.prototype._onCancel=M,e.prototype._setOnCancel=P,e.prototype._attachCancellationCallback=E,e.prototype._execute=A,O=q,he.cancellation=!0}return"monitoring"in ee&&(ee.monitoring&&!he.monitoring?(he.monitoring=!0,e.prototype._fireEvent=S):!ee.monitoring&&he.monitoring&&(he.monitoring=!1,e.prototype._fireEvent=T)),e};function T(){return!1}e.prototype._fireEvent=T,e.prototype._execute=function(ee,ae,xe){try{ee(ae,xe)}catch(ye){return ye}},e.prototype._onCancel=function(){},e.prototype._setOnCancel=function(ee){},e.prototype._attachCancellationCallback=function(ee){},e.prototype._captureStackTrace=function(){},e.prototype._attachExtraTrace=function(){},e.prototype._clearCancellationData=function(){},e.prototype._propagateFrom=function(ee,ae){};function A(ee,ae,xe){var ye=this;try{ee(ae,xe,function(Ce){if(typeof Ce!="function")throw new TypeError("onCancel must be a function, got: "+i.toString(Ce));ye._attachCancellationCallback(Ce)})}catch(Ce){return Ce}}function E(ee){if(!this._isCancellable())return this;var ae=this._onCancel();ae!==void 0?i.isArray(ae)?ae.push(ee):this._setOnCancel([ae,ee]):this._setOnCancel(ee)}function M(){return this._onCancelField}function P(ee){this._onCancelField=ee}function X(){this._cancellationParent=void 0,this._onCancelField=void 0}function q(ee,ae){if(ae&1){this._cancellationParent=ee;var xe=ee._branchesRemainingToCancel;xe===void 0&&(xe=0),ee._branchesRemainingToCancel=xe+1}ae&2&&ee._isBound()&&this._setBoundTo(ee._boundTo)}function B(ee,ae){ae&2&&ee._isBound()&&this._setBoundTo(ee._boundTo)}var O=B;function F(){var ee=this._boundTo;return ee!==void 0&&ee instanceof e?ee.isFulfilled()?ee.value():void 0:ee}function I(){this._trace=new J(this._peekContext())}function L(ee,ae){if(o(ee)){var xe=this._trace;if(xe!==void 0&&ae&&(xe=xe._parent),xe!==void 0)xe.attachExtraTrace(ee);else if(!ee.__stackCleaned__){var ye=ne(ee);i.notEnumerableProp(ee,"stack",ye.message+`
`+ye.stack.join(`
`)),i.notEnumerableProp(ee,"__stackCleaned__",!0)}}}function C(ee,ae,xe,ye,Ce){if(ee===void 0&&ae!==null&&b){if(Ce!==void 0&&Ce._returnedNonUndefined()||!(ye._bitField&65535))return;xe&&(xe=xe+" ");var Ie="",Ze="";if(ae._trace){for(var Fe=ae._trace.stack.split(`
`),He=ie(Fe),rt=He.length-1;rt>=0;--rt){var Je=He[rt];if(!d.test(Je)){var Gt=Je.match(f);Gt&&(Ie="at "+Gt[1]+":"+Gt[2]+":"+Gt[3]+" ");break}}if(He.length>0){for(var ma=He[0],rt=0;rt<Fe.length;++rt)if(Fe[rt]===ma){rt>0&&(Ze=`
`+Fe[rt-1]);break}}}var yn="a promise was created in a "+xe+"handler "+Ie+"but was not returned from it, see http://goo.gl/rRqMUw"+Ze;ye._warn(yn,!0,ae)}}function k(ee,ae){var xe=ee+" is deprecated and will be removed in a future version.";return ae&&(xe+=" Use "+ae+" instead."),z(xe)}function z(ee,ae,xe){if(he.warnings){var ye=new a(ee),Ce;if(ae)xe._attachExtraTrace(ye);else if(he.longStackTraces&&(Ce=e._peekContext()))Ce.attachExtraTrace(ye);else{var Ie=ne(ye);ye.stack=Ie.message+`
`+Ie.stack.join(`
`)}S("warning",ye)||pe(ye,"",!0)}}function V(ee,ae){for(var xe=0;xe<ae.length-1;++xe)ae[xe].push("From previous event:"),ae[xe]=ae[xe].join(`
`);return xe<ae.length&&(ae[xe]=ae[xe].join(`
`)),ee+`
`+ae.join(`
`)}function Z(ee){for(var ae=0;ae<ee.length;++ae)(ee[ae].length===0||ae+1<ee.length&&ee[ae][0]===ee[ae+1][0])&&(ee.splice(ae,1),ae--)}function ce(ee){for(var ae=ee[0],xe=1;xe<ee.length;++xe){for(var ye=ee[xe],Ce=ae.length-1,Ie=ae[Ce],Ze=-1,Fe=ye.length-1;Fe>=0;--Fe)if(ye[Fe]===Ie){Ze=Fe;break}for(var Fe=Ze;Fe>=0;--Fe){var He=ye[Fe];if(ae[Ce]===He)ae.pop(),Ce--;else break}ae=ye}}function ie(ee){for(var ae=[],xe=0;xe<ee.length;++xe){var ye=ee[xe],Ce=ye==="    (No stack trace)"||h.test(ye),Ie=Ce&&te(ye);Ce&&!Ie&&(x&&ye.charAt(0)!==" "&&(ye="    "+ye),ae.push(ye))}return ae}function Q(ee){for(var ae=ee.stack.replace(/\s+$/g,"").split(`
`),xe=0;xe<ae.length;++xe){var ye=ae[xe];if(ye==="    (No stack trace)"||h.test(ye))break}return xe>0&&ee.name!="SyntaxError"&&(ae=ae.slice(xe)),ae}function ne(ee){var ae=ee.stack,xe=ee.toString();return ae=typeof ae=="string"&&ae.length>0?Q(ee):["    (No stack trace)"],{message:xe,stack:ee.name=="SyntaxError"?ae:ie(ae)}}function pe(ee,ae,xe){if(typeof console<"u"){var ye;if(i.isObject(ee)){var Ce=ee.stack;ye=ae+m(Ce,ee)}else ye=ae+String(ee);typeof p=="function"?p(ye,xe):(typeof console.log=="function"||typeof console.log=="object")&&console.log(ye)}}function W(ee,ae,xe,ye){var Ce=!1;try{typeof ae=="function"&&(Ce=!0,ee==="rejectionHandled"?ae(ye):ae(xe,ye))}catch(Ie){n.throwLater(Ie)}ee==="unhandledRejection"?!S(ee,xe,ye)&&!Ce&&pe(xe,"Unhandled rejection "):S(ee,ye)}function re(ee){var ae;if(typeof ee=="function")ae="[function "+(ee.name||"anonymous")+"]";else{ae=ee&&typeof ee.toString=="function"?ee.toString():i.toString(ee);var xe=/\[object [a-zA-Z0-9$_]+\]/;if(xe.test(ae))try{var ye=JSON.stringify(ee);ae=ye}catch{}ae.length===0&&(ae="(empty array)")}return"(<"+U(ae)+">, no stack trace)"}function U(ee){var ae=41;return ee.length<ae?ee:ee.substr(0,ae-3)+"..."}function se(){return typeof le=="function"}var te=function(){return!1},K=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function H(ee){var ae=ee.match(K);if(ae)return{fileName:ae[1],line:parseInt(ae[2],10)}}function oe(ee,ae){if(se()){for(var xe=ee.stack.split(`
`),ye=ae.stack.split(`
`),Ce=-1,Ie=-1,Ze,Fe,He=0;He<xe.length;++He){var rt=H(xe[He]);if(rt){Ze=rt.fileName,Ce=rt.line;break}}for(var He=0;He<ye.length;++He){var rt=H(ye[He]);if(rt){Fe=rt.fileName,Ie=rt.line;break}}Ce<0||Ie<0||!Ze||!Fe||Ze!==Fe||Ce>=Ie||(te=function(Je){if(u.test(Je))return!0;var Gt=H(Je);return!!(Gt&&Gt.fileName===Ze&&Ce<=Gt.line&&Gt.line<=Ie)})}}function J(ee){this._parent=ee,this._promisesCreated=0;var ae=this._length=1+(ee===void 0?0:ee._length);le(this,J),ae>32&&this.uncycle()}i.inherits(J,Error),t.CapturedTrace=J,J.prototype.uncycle=function(){var ee=this._length;if(!(ee<2)){for(var ae=[],xe={},ye=0,Ce=this;Ce!==void 0;++ye)ae.push(Ce),Ce=Ce._parent;ee=this._length=ye;for(var ye=ee-1;ye>=0;--ye){var Ie=ae[ye].stack;xe[Ie]===void 0&&(xe[Ie]=ye)}for(var ye=0;ye<ee;++ye){var Ze=ae[ye].stack,Fe=xe[Ze];if(Fe!==void 0&&Fe!==ye){Fe>0&&(ae[Fe-1]._parent=void 0,ae[Fe-1]._length=1),ae[ye]._parent=void 0,ae[ye]._length=1;var He=ye>0?ae[ye-1]:this;Fe<ee-1?(He._parent=ae[Fe+1],He._parent.uncycle(),He._length=He._parent._length+1):(He._parent=void 0,He._length=1);for(var rt=He._length+1,Je=ye-2;Je>=0;--Je)ae[Je]._length=rt,rt++;return}}}},J.prototype.attachExtraTrace=function(ee){if(!ee.__stackCleaned__){this.uncycle();for(var ae=ne(ee),xe=ae.message,ye=[ae.stack],Ce=this;Ce!==void 0;)ye.push(ie(Ce.stack.split(`
`))),Ce=Ce._parent;ce(ye),Z(ye),i.notEnumerableProp(ee,"stack",V(xe,ye)),i.notEnumerableProp(ee,"__stackCleaned__",!0)}};var le=function(){var ae=/^\s*at\s*/,xe=function(Ze,Fe){return typeof Ze=="string"?Ze:Fe.name!==void 0&&Fe.message!==void 0?Fe.toString():re(Fe)};if(typeof Error.stackTraceLimit=="number"&&typeof Error.captureStackTrace=="function"){Error.stackTraceLimit+=6,h=ae,m=xe;var ye=Error.captureStackTrace;return te=function(Ze){return u.test(Ze)},function(Ze,Fe){Error.stackTraceLimit+=6,ye(Ze,Fe),Error.stackTraceLimit-=6}}var Ce=new Error;if(typeof Ce.stack=="string"&&Ce.stack.split(`
`)[0].indexOf("stackDetection@")>=0)return h=/@/,m=xe,x=!0,function(Fe){Fe.stack=new Error().stack};var Ie;try{throw new Error}catch(Ze){Ie="stack"in Ze}return!("stack"in Ce)&&Ie&&typeof Error.stackTraceLimit=="number"?(h=ae,m=xe,function(Fe){Error.stackTraceLimit+=6;try{throw new Error}catch(He){Fe.stack=He.stack}Error.stackTraceLimit-=6}):(m=function(Ze,Fe){return typeof Ze=="string"?Ze:(typeof Fe=="object"||typeof Fe=="function")&&Fe.name!==void 0&&Fe.message!==void 0?Fe.toString():re(Fe)},null)}();typeof console<"u"&&typeof console.warn<"u"&&(p=function(ee){console.warn(ee)},i.isNode&&process.stderr.isTTY?p=function(ee,ae){var xe=ae?"\x1B[33m":"\x1B[31m";console.warn(xe+ee+`\x1B[0m
`)}:!i.isNode&&typeof new Error().stack=="string"&&(p=function(ee,ae){console.warn("%c"+ee,ae?"color: darkorange":"color: red")}));var he={warnings:v,longStackTraces:!1,cancellation:!1,monitoring:!1};return y&&e.longStackTraces(),{longStackTraces:function(){return he.longStackTraces},warnings:function(){return he.warnings},cancellation:function(){return he.cancellation},monitoring:function(){return he.monitoring},propagateFromFunction:function(){return O},boundValueFunction:function(){return F},checkForgottenReturns:C,setBounds:oe,warn:z,deprecated:k,CapturedTrace:J,fireDomEvent:w,fireGlobalEvent:j}}),Sy}var Ey,s3;function j5e(){return s3||(s3=1,Ey=function(e,t){var r=nr(),n=e.CancellationError,a=r.errorObj;function i(f,h,m){this.promise=f,this.type=h,this.handler=m,this.called=!1,this.cancelPromise=null}i.prototype.isFinallyHandler=function(){return this.type===0};function o(f){this.finallyHandler=f}o.prototype._resultCancelled=function(){c(this.finallyHandler)};function c(f,h){return f.cancelPromise!=null?(arguments.length>1?f.cancelPromise._reject(h):f.cancelPromise._cancel(),f.cancelPromise=null,!0):!1}function l(){return d.call(this,this.promise._target()._settledValue())}function u(f){if(!c(this,f))return a.e=f,a}function d(f){var h=this.promise,m=this.handler;if(!this.called){this.called=!0;var x=this.isFinallyHandler()?m.call(h._boundValue()):m.call(h._boundValue(),f);if(x!==void 0){h._setReturnedNonUndefined();var p=t(x,h);if(p instanceof e){if(this.cancelPromise!=null)if(p._isCancelled()){var g=new n("late cancellation observer");return h._attachExtraTrace(g),a.e=g,a}else p.isPending()&&p._attachCancellationCallback(new o(this));return p._then(l,u,void 0,this,void 0)}}}return h.isRejected()?(c(this),a.e=f,a):(c(this),f)}return e.prototype._passThrough=function(f,h,m,x){return typeof f!="function"?this.then():this._then(m,x,void 0,new i(this,h,f),void 0)},e.prototype.lastly=e.prototype.finally=function(f){return this._passThrough(f,0,d,d)},e.prototype.tap=function(f){return this._passThrough(f,1,d)},i}),Ey}var Ty,o3;function N5e(){return o3||(o3=1,Ty=function(e){var t=nr(),r=Ru().keys,n=t.tryCatch,a=t.errorObj;function i(o,c,l){return function(u){var d=l._boundValue();e:for(var f=0;f<o.length;++f){var h=o[f];if(h===Error||h!=null&&h.prototype instanceof Error){if(u instanceof h)return n(c).call(d,u)}else if(typeof h=="function"){var m=n(h).call(d,u);if(m===a)return m;if(m)return n(c).call(d,u)}else if(t.isObject(u)){for(var x=r(h),p=0;p<x.length;++p){var g=x[p];if(h[g]!=u[g])continue e}return n(c).call(d,u)}}return e}}return i}),Ty}var Cy,c3;function eB(){if(c3)return Cy;c3=1;var e=nr(),t=e.maybeWrapAsError,r=go(),n=r.OperationalError,a=Ru();function i(u){return u instanceof Error&&a.getPrototypeOf(u)===Error.prototype}var o=/^(?:name|message|stack|cause)$/;function c(u){var d;if(i(u)){d=new n(u),d.name=u.name,d.message=u.message,d.stack=u.stack;for(var f=a.keys(u),h=0;h<f.length;++h){var m=f[h];o.test(m)||(d[m]=u[m])}return d}return e.markAsOriginatingFromRejection(u),u}function l(u,d){return function(f,h){if(u!==null){if(f){var m=c(t(f));u._attachExtraTrace(m),u._reject(m)}else if(!d)u._fulfill(h);else{for(var x=arguments.length,p=new Array(Math.max(x-1,0)),g=1;g<x;++g)p[g-1]=arguments[g];u._fulfill(p)}u=null}}}return Cy=l,Cy}var Ay,l3;function D5e(){return l3||(l3=1,Ay=function(e,t,r,n,a){var i=nr(),o=i.tryCatch;e.method=function(c){if(typeof c!="function")throw new e.TypeError("expecting a function but got "+i.classString(c));return function(){var l=new e(t);l._captureStackTrace(),l._pushContext();var u=o(c).apply(this,arguments),d=l._popContext();return a.checkForgottenReturns(u,d,"Promise.method",l),l._resolveFromSyncValue(u),l}},e.attempt=e.try=function(c){if(typeof c!="function")return n("expecting a function but got "+i.classString(c));var l=new e(t);l._captureStackTrace(),l._pushContext();var u;if(arguments.length>1){a.deprecated("calling Promise.try with more than 1 argument");var d=arguments[1],f=arguments[2];u=i.isArray(d)?o(c).apply(f,d):o(c).call(f,d)}else u=o(c)();var h=l._popContext();return a.checkForgottenReturns(u,h,"Promise.try",l),l._resolveFromSyncValue(u),l},e.prototype._resolveFromSyncValue=function(c){c===i.errorObj?this._rejectCallback(c.e,!1):this._resolveCallback(c,!0)}}),Ay}var ky,u3;function S5e(){return u3||(u3=1,ky=function(e,t,r,n){var a=!1,i=function(u,d){this._reject(d)},o=function(u,d){d.promiseRejectionQueued=!0,d.bindingPromise._then(i,i,null,this,u)},c=function(u,d){this._bitField&50397184||this._resolveCallback(d.target)},l=function(u,d){d.promiseRejectionQueued||this._reject(u)};e.prototype.bind=function(u){a||(a=!0,e.prototype._propagateFrom=n.propagateFromFunction(),e.prototype._boundValue=n.boundValueFunction());var d=r(u),f=new e(t);f._propagateFrom(this,1);var h=this._target();if(f._setBoundTo(d),d instanceof e){var m={promiseRejectionQueued:!1,promise:f,target:h,bindingPromise:d};h._then(t,o,void 0,f,m),d._then(c,l,void 0,f,m),f._setOnCancel(d)}else f._resolveCallback(h);return f},e.prototype._setBoundTo=function(u){u!==void 0?(this._bitField=this._bitField|2097152,this._boundTo=u):this._bitField=this._bitField&-2097153},e.prototype._isBound=function(){return(this._bitField&2097152)===2097152},e.bind=function(u,d){return e.resolve(d).bind(u)}}),ky}var Fy,d3;function E5e(){return d3||(d3=1,Fy=function(e,t,r,n){var a=nr(),i=a.tryCatch,o=a.errorObj,c=e._async;e.prototype.break=e.prototype.cancel=function(){if(!n.cancellation())return this._warn("cancellation is disabled");for(var l=this,u=l;l._isCancellable();){if(!l._cancelBy(u)){u._isFollowing()?u._followee().cancel():u._cancelBranched();break}var d=l._cancellationParent;if(d==null||!d._isCancellable()){l._isFollowing()?l._followee().cancel():l._cancelBranched();break}else l._isFollowing()&&l._followee().cancel(),l._setWillBeCancelled(),u=l,l=d}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return this._branchesRemainingToCancel===void 0||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(l){return l===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),this._enoughBranchesHaveCancelled()?(this._invokeOnCancel(),!0):!1)},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),c.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(l,u){if(a.isArray(l))for(var d=0;d<l.length;++d)this._doInvokeOnCancel(l[d],u);else if(l!==void 0)if(typeof l=="function"){if(!u){var f=i(l).call(this._boundValue());f===o&&(this._attachExtraTrace(f.e),c.throwLater(f.e))}}else l._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var l=this._onCancel();this._unsetOnCancel(),c.invoke(this._doInvokeOnCancel,this,l)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}),Fy}var Oy,f3;function T5e(){return f3||(f3=1,Oy=function(e){function t(){return this.value}function r(){throw this.reason}e.prototype.return=e.prototype.thenReturn=function(n){return n instanceof e&&n.suppressUnhandledRejections(),this._then(t,void 0,void 0,{value:n},void 0)},e.prototype.throw=e.prototype.thenThrow=function(n){return this._then(r,void 0,void 0,{reason:n},void 0)},e.prototype.catchThrow=function(n){if(arguments.length<=1)return this._then(void 0,r,void 0,{reason:n},void 0);var a=arguments[1],i=function(){throw a};return this.caught(n,i)},e.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof e&&n.suppressUnhandledRejections(),this._then(void 0,t,void 0,{value:n},void 0);var a=arguments[1];a instanceof e&&a.suppressUnhandledRejections();var i=function(){return a};return this.caught(n,i)}}),Oy}var Py,h3;function C5e(){return h3||(h3=1,Py=function(e){function t(l){l!==void 0?(l=l._target(),this._bitField=l._bitField,this._settledValueField=l._isFateSealed()?l._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}t.prototype._settledValue=function(){return this._settledValueField};var r=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError(`cannot get fulfillment value of a non-fulfilled promise

    See http://goo.gl/MqrFmX
`);return this._settledValue()},n=t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError(`cannot get rejection reason of a non-rejected promise

    See http://goo.gl/MqrFmX
`);return this._settledValue()},a=t.prototype.isFulfilled=function(){return(this._bitField&33554432)!==0},i=t.prototype.isRejected=function(){return(this._bitField&16777216)!==0},o=t.prototype.isPending=function(){return(this._bitField&50397184)===0},c=t.prototype.isResolved=function(){return(this._bitField&50331648)!==0};t.prototype.isCancelled=function(){return(this._bitField&8454144)!==0},e.prototype.__isCancelled=function(){return(this._bitField&65536)===65536},e.prototype._isCancelled=function(){return this._target().__isCancelled()},e.prototype.isCancelled=function(){return(this._target()._bitField&8454144)!==0},e.prototype.isPending=function(){return o.call(this._target())},e.prototype.isRejected=function(){return i.call(this._target())},e.prototype.isFulfilled=function(){return a.call(this._target())},e.prototype.isResolved=function(){return c.call(this._target())},e.prototype.value=function(){return r.call(this._target())},e.prototype.reason=function(){var l=this._target();return l._unsetRejectionIsUnhandled(),n.call(l)},e.prototype._value=function(){return this._settledValue()},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},e.PromiseInspection=t}),Py}var Iy,m3;function A5e(){return m3||(m3=1,Iy=function(e,t,r,n,a,i){var o=nr(),c=o.canEvaluate,l=o.tryCatch,u=o.errorObj,d;if(c){for(var f=function(y){return new Function("value","holder",`                             
	            'use strict';                                                    
	            holder.pIndex = value;                                           
	            holder.checkFulfillment(this);                                   
	            `.replace(/Index/g,y))},h=function(y){return new Function("promise","holder",`                           
	            'use strict';                                                    
	            holder.pIndex = promise;                                         
	            `.replace(/Index/g,y))},m=function(y){for(var b=new Array(y),_=0;_<b.length;++_)b[_]="this.p"+(_+1);var w=b.join(" = ")+" = null;",j=`var promise;
`+b.map(function(T){return`                                                         
	                promise = `+T+`;                                      
	                if (promise instanceof Promise) {                            
	                    promise.cancel();                                        
	                }                                                            
	            `}).join(`
`),N=b.join(", "),D="Holder$"+y,S=`return function(tryCatch, errorObj, Promise, async) {    
	            'use strict';                                                    
	            function [TheName](fn) {                                         
	                [TheProperties]                                              
	                this.fn = fn;                                                
	                this.asyncNeeded = true;                                     
	                this.now = 0;                                                
	            }                                                                
	                                                                             
	            [TheName].prototype._callFunction = function(promise) {          
	                promise._pushContext();                                      
	                var ret = tryCatch(this.fn)([ThePassedArguments]);           
	                promise._popContext();                                       
	                if (ret === errorObj) {                                      
	                    promise._rejectCallback(ret.e, false);                   
	                } else {                                                     
	                    promise._resolveCallback(ret);                           
	                }                                                            
	            };                                                               
	                                                                             
	            [TheName].prototype.checkFulfillment = function(promise) {       
	                var now = ++this.now;                                        
	                if (now === [TheTotal]) {                                    
	                    if (this.asyncNeeded) {                                  
	                        async.invoke(this._callFunction, this, promise);     
	                    } else {                                                 
	                        this._callFunction(promise);                         
	                    }                                                        
	                                                                             
	                }                                                            
	            };                                                               
	                                                                             
	            [TheName].prototype._resultCancelled = function() {              
	                [CancellationCode]                                           
	            };                                                               
	                                                                             
	            return [TheName];                                                
	        }(tryCatch, errorObj, Promise, async);                               
	        `;return S=S.replace(/\[TheName\]/g,D).replace(/\[TheTotal\]/g,y).replace(/\[ThePassedArguments\]/g,N).replace(/\[TheProperties\]/g,w).replace(/\[CancellationCode\]/g,j),new Function("tryCatch","errorObj","Promise","async",S)(l,u,e,a)},x=[],p=[],g=[],v=0;v<8;++v)x.push(m(v+1)),p.push(f(v+1)),g.push(h(v+1));d=function(y){this._reject(y)}}e.join=function(){var y=arguments.length-1,b;if(y>0&&typeof arguments[y]=="function"&&(b=arguments[y],y<=8&&c)){var P=new e(n);P._captureStackTrace();for(var _=x[y-1],w=new _(b),j=p,N=0;N<y;++N){var D=r(arguments[N],P);if(D instanceof e){D=D._target();var S=D._bitField;S&50397184?S&33554432?j[N].call(P,D._value(),w):S&16777216?P._reject(D._reason()):P._cancel():(D._then(j[N],d,void 0,P,w),g[N](D,w),w.asyncNeeded=!1)}else j[N].call(P,D,w)}if(!P._isFateSealed()){if(w.asyncNeeded){var T=i();T!==null&&(w.fn=o.domainBind(T,w.fn))}P._setAsyncGuaranteed(),P._setOnCancel(w)}return P}for(var A=arguments.length,E=new Array(A),M=0;M<A;++M)E[M]=arguments[M];b&&E.pop();var P=new t(E).promise();return b!==void 0?P.spread(b):P}}),Iy}var Uy,p3;function k5e(){return p3||(p3=1,Uy=function(e,t,r,n,a,i){var o=e._getDomain,c=nr(),l=c.tryCatch,u=c.errorObj,d=e._async;function f(m,x,p,g){this.constructor$(m),this._promise._captureStackTrace();var v=o();this._callback=v===null?x:c.domainBind(v,x),this._preservedValues=g===a?new Array(this.length()):null,this._limit=p,this._inFlight=0,this._queue=[],d.invoke(this._asyncInit,this,void 0)}c.inherits(f,t),f.prototype._asyncInit=function(){this._init$(void 0,-2)},f.prototype._init=function(){},f.prototype._promiseFulfilled=function(m,x){var p=this._values,g=this.length(),v=this._preservedValues,y=this._limit;if(x<0){if(x=x*-1-1,p[x]=m,y>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(y>=1&&this._inFlight>=y)return p[x]=m,this._queue.push(x),!1;v!==null&&(v[x]=m);var b=this._promise,_=this._callback,w=b._boundValue();b._pushContext();var j=l(_).call(w,m,x,g),N=b._popContext();if(i.checkForgottenReturns(j,N,v!==null?"Promise.filter":"Promise.map",b),j===u)return this._reject(j.e),!0;var D=n(j,this._promise);if(D instanceof e){D=D._target();var S=D._bitField;if(S&50397184)if(S&33554432)j=D._value();else return S&16777216?(this._reject(D._reason()),!0):(this._cancel(),!0);else return y>=1&&this._inFlight++,p[x]=D,D._proxy(this,(x+1)*-1),!1}p[x]=j}var T=++this._totalResolved;return T>=g?(v!==null?this._filter(p,v):this._resolve(p),!0):!1},f.prototype._drainQueue=function(){for(var m=this._queue,x=this._limit,p=this._values;m.length>0&&this._inFlight<x;){if(this._isResolved())return;var g=m.pop();this._promiseFulfilled(p[g],g)}},f.prototype._filter=function(m,x){for(var p=x.length,g=new Array(p),v=0,y=0;y<p;++y)m[y]&&(g[v++]=x[y]);g.length=v,this._resolve(g)},f.prototype.preservedValues=function(){return this._preservedValues};function h(m,x,p,g){if(typeof x!="function")return r("expecting a function but got "+c.classString(x));var v=0;if(p!==void 0)if(typeof p=="object"&&p!==null){if(typeof p.concurrency!="number")return e.reject(new TypeError("'concurrency' must be a number but it is "+c.classString(p.concurrency)));v=p.concurrency}else return e.reject(new TypeError("options argument must be an object but it is "+c.classString(p)));return v=typeof v=="number"&&isFinite(v)&&v>=1?v:0,new f(m,x,v,g).promise()}e.prototype.map=function(m,x){return h(this,m,x,null)},e.map=function(m,x,p,g){return h(m,x,p,g)}}),Uy}var Ry,x3;function F5e(){if(x3)return Ry;x3=1;var e=Object.create;if(e){var t=e(null),r=e(null);t[" size"]=r[" size"]=0}return Ry=function(n){var a=nr(),i=a.canEvaluate,o=a.isIdentifier,c,l;{var u=function(g){return new Function("ensureMethod",`                                    
	        return function(obj) {                                               
	            'use strict'                                                     
	            var len = this.length;                                           
	            ensureMethod(obj, 'methodName');                                 
	            switch(len) {                                                    
	                case 1: return obj.methodName(this[0]);                      
	                case 2: return obj.methodName(this[0], this[1]);             
	                case 3: return obj.methodName(this[0], this[1], this[2]);    
	                case 0: return obj.methodName();                             
	                default:                                                     
	                    return obj.methodName.apply(obj, this);                  
	            }                                                                
	        };                                                                   
	        `.replace(/methodName/g,g))(h)},d=function(g){return new Function("obj",`                                             
	        'use strict';                                                        
	        return obj.propertyName;                                             
	        `.replace("propertyName",g))},f=function(g,v,y){var b=y[g];if(typeof b!="function"){if(!o(g))return null;if(b=v(g),y[g]=b,y[" size"]++,y[" size"]>512){for(var _=Object.keys(y),w=0;w<256;++w)delete y[_[w]];y[" size"]=_.length-256}}return b};c=function(g){return f(g,u,t)},l=function(g){return f(g,d,r)}}function h(g,v){var y;if(g!=null&&(y=g[v]),typeof y!="function"){var b="Object "+a.classString(g)+" has no method '"+a.toString(v)+"'";throw new n.TypeError(b)}return y}function m(g){var v=this.pop(),y=h(g,v);return y.apply(g,this)}n.prototype.call=function(g){for(var v=arguments.length,y=new Array(Math.max(v-1,0)),b=1;b<v;++b)y[b-1]=arguments[b];if(i){var _=c(g);if(_!==null)return this._then(_,void 0,void 0,y,void 0)}return y.push(g),this._then(m,void 0,void 0,y,void 0)};function x(g){return g[this]}function p(g){var v=+this;return v<0&&(v=Math.max(0,v+g.length)),g[v]}n.prototype.get=function(g){var v=typeof g=="number",y;if(v)y=p;else if(i){var b=l(g);y=b!==null?b:x}else y=x;return this._then(y,void 0,void 0,g,void 0)}},Ry}var My,g3;function O5e(){return g3||(g3=1,My=function(e,t,r,n,a,i){var o=nr(),c=go().TypeError,l=nr().inherits,u=o.errorObj,d=o.tryCatch,f={};function h(b){setTimeout(function(){throw b},0)}function m(b){var _=r(b);return _!==b&&typeof b._isDisposable=="function"&&typeof b._getDisposer=="function"&&b._isDisposable()&&_._setDisposable(b._getDisposer()),_}function x(b,_){var w=0,j=b.length,N=new e(a);function D(){if(w>=j)return N._fulfill();var S=m(b[w++]);if(S instanceof e&&S._isDisposable()){try{S=r(S._getDisposer().tryDispose(_),b.promise)}catch(T){return h(T)}if(S instanceof e)return S._then(D,h,null,null,null)}D()}return D(),N}function p(b,_,w){this._data=b,this._promise=_,this._context=w}p.prototype.data=function(){return this._data},p.prototype.promise=function(){return this._promise},p.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():f},p.prototype.tryDispose=function(b){var _=this.resource(),w=this._context;w!==void 0&&w._pushContext();var j=_!==f?this.doDispose(_,b):null;return w!==void 0&&w._popContext(),this._promise._unsetDisposable(),this._data=null,j},p.isDisposer=function(b){return b!=null&&typeof b.resource=="function"&&typeof b.tryDispose=="function"};function g(b,_,w){this.constructor$(b,_,w)}l(g,p),g.prototype.doDispose=function(b,_){var w=this.data();return w.call(b,b,_)};function v(b){return p.isDisposer(b)?(this.resources[this.index]._setDisposable(b),b.promise()):b}function y(b){this.length=b,this.promise=null,this[b-1]=null}y.prototype._resultCancelled=function(){for(var b=this.length,_=0;_<b;++_){var w=this[_];w instanceof e&&w.cancel()}},e.using=function(){var b=arguments.length;if(b<2)return t("you must pass at least 2 arguments to Promise.using");var _=arguments[b-1];if(typeof _!="function")return t("expecting a function but got "+o.classString(_));var w,j=!0;b===2&&Array.isArray(arguments[0])?(w=arguments[0],b=w.length,j=!1):(w=arguments,b--);for(var N=new y(b),D=0;D<b;++D){var S=w[D];if(p.isDisposer(S)){var T=S;S=S.promise(),S._setDisposable(T)}else{var A=r(S);A instanceof e&&(S=A._then(v,null,null,{resources:N,index:D},void 0))}N[D]=S}for(var E=new Array(N.length),D=0;D<E.length;++D)E[D]=e.resolve(N[D]).reflect();var M=e.all(E).then(function(X){for(var q=0;q<X.length;++q){var B=X[q];if(B.isRejected())return u.e=B.error(),u;if(!B.isFulfilled()){M.cancel();return}X[q]=B.value()}P._pushContext(),_=d(_);var O=j?_.apply(void 0,X):_(X),F=P._popContext();return i.checkForgottenReturns(O,F,"Promise.using",P),O}),P=M.lastly(function(){var X=new e.PromiseInspection(M);return x(N,X)});return N.promise=P,P._setOnCancel(N),P},e.prototype._setDisposable=function(b){this._bitField=this._bitField|131072,this._disposer=b},e.prototype._isDisposable=function(){return(this._bitField&131072)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=this._bitField&-131073,this._disposer=void 0},e.prototype.disposer=function(b){if(typeof b=="function")return new g(b,this,n());throw new c}}),My}var By,v3;function P5e(){return v3||(v3=1,By=function(e,t,r){var n=nr(),a=e.TimeoutError;function i(f){this.handle=f}i.prototype._resultCancelled=function(){clearTimeout(this.handle)};var o=function(f){return c(+this).thenReturn(f)},c=e.delay=function(f,h){var m,x;return h!==void 0?(m=e.resolve(h)._then(o,null,null,f,void 0),r.cancellation()&&h instanceof e&&m._setOnCancel(h)):(m=new e(t),x=setTimeout(function(){m._fulfill()},+f),r.cancellation()&&m._setOnCancel(new i(x)),m._captureStackTrace()),m._setAsyncGuaranteed(),m};e.prototype.delay=function(f){return c(f,this)};var l=function(f,h,m){var x;typeof h!="string"?h instanceof Error?x=h:x=new a("operation timed out"):x=new a(h),n.markAsOriginatingFromRejection(x),f._attachExtraTrace(x),f._reject(x),m!=null&&m.cancel()};function u(f){return clearTimeout(this.handle),f}function d(f){throw clearTimeout(this.handle),f}e.prototype.timeout=function(f,h){f=+f;var m,x,p=new i(setTimeout(function(){m.isPending()&&l(m,h,x)},f));return r.cancellation()?(x=this.then(),m=x._then(u,d,void 0,p,void 0),m._setOnCancel(p)):m=this._then(u,d,void 0,p,void 0),m}}),By}var Ly,y3;function I5e(){return y3||(y3=1,Ly=function(e,t,r,n,a,i){var o=go(),c=o.TypeError,l=nr(),u=l.errorObj,d=l.tryCatch,f=[];function h(x,p,g){for(var v=0;v<p.length;++v){g._pushContext();var y=d(p[v])(x);if(g._popContext(),y===u){g._pushContext();var b=e.reject(u.e);return g._popContext(),b}var _=n(y,g);if(_ instanceof e)return _}return null}function m(x,p,g,v){if(i.cancellation()){var y=new e(r),b=this._finallyPromise=new e(r);this._promise=y.lastly(function(){return b}),y._captureStackTrace(),y._setOnCancel(this)}else{var _=this._promise=new e(r);_._captureStackTrace()}this._stack=v,this._generatorFunction=x,this._receiver=p,this._generator=void 0,this._yieldHandlers=typeof g=="function"?[g].concat(f):f,this._yieldedPromise=null,this._cancellationPhase=!1}l.inherits(m,a),m.prototype._isResolved=function(){return this._promise===null},m.prototype._cleanup=function(){this._promise=this._generator=null,i.cancellation()&&this._finallyPromise!==null&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},m.prototype._promiseCancelled=function(){if(!this._isResolved()){var x=typeof this._generator.return<"u",p;if(x)this._promise._pushContext(),p=d(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var g=new e.CancellationError("generator .return() sentinel");e.coroutine.returnSentinel=g,this._promise._attachExtraTrace(g),this._promise._pushContext(),p=d(this._generator.throw).call(this._generator,g),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(p)}},m.prototype._promiseFulfilled=function(x){this._yieldedPromise=null,this._promise._pushContext();var p=d(this._generator.next).call(this._generator,x);this._promise._popContext(),this._continue(p)},m.prototype._promiseRejected=function(x){this._yieldedPromise=null,this._promise._attachExtraTrace(x),this._promise._pushContext();var p=d(this._generator.throw).call(this._generator,x);this._promise._popContext(),this._continue(p)},m.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var x=this._yieldedPromise;this._yieldedPromise=null,x.cancel()}},m.prototype.promise=function(){return this._promise},m.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},m.prototype._continue=function(x){var p=this._promise;if(x===u)return this._cleanup(),this._cancellationPhase?p.cancel():p._rejectCallback(x.e,!1);var g=x.value;if(x.done===!0)return this._cleanup(),this._cancellationPhase?p.cancel():p._resolveCallback(g);var v=n(g,this._promise);if(!(v instanceof e)&&(v=h(v,this._yieldHandlers,this._promise),v===null)){this._promiseRejected(new c(`A value %s was yielded that could not be treated as a promise

    See http://goo.gl/MqrFmX

`.replace("%s",g)+`From coroutine:
`+this._stack.split(`
`).slice(1,-7).join(`
`)));return}v=v._target();var y=v._bitField;y&50397184?y&33554432?e._async.invoke(this._promiseFulfilled,this,v._value()):y&16777216?e._async.invoke(this._promiseRejected,this,v._reason()):this._promiseCancelled():(this._yieldedPromise=v,v._proxy(this,null))},e.coroutine=function(x,p){if(typeof x!="function")throw new c(`generatorFunction must be a function

    See http://goo.gl/MqrFmX
`);var g=Object(p).yieldHandler,v=m,y=new Error().stack;return function(){var b=x.apply(this,arguments),_=new v(void 0,void 0,g,y),w=_.promise();return _._generator=b,_._promiseFulfilled(void 0),w}},e.coroutine.addYieldHandler=function(x){if(typeof x!="function")throw new c("expecting a function but got "+l.classString(x));f.push(x)},e.spawn=function(x){if(i.deprecated("Promise.spawn()","Promise.coroutine()"),typeof x!="function")return t(`generatorFunction must be a function

    See http://goo.gl/MqrFmX
`);var p=new m(x,this),g=p.promise();return p._run(e.spawn),g}}),Ly}var $y,b3;function U5e(){return b3||(b3=1,$y=function(e){var t=nr(),r=e._async,n=t.tryCatch,a=t.errorObj;function i(l,u){var d=this;if(!t.isArray(l))return o.call(d,l,u);var f=n(u).apply(d._boundValue(),[null].concat(l));f===a&&r.throwLater(f.e)}function o(l,u){var d=this,f=d._boundValue(),h=l===void 0?n(u).call(f,null):n(u).call(f,null,l);h===a&&r.throwLater(h.e)}function c(l,u){var d=this;if(!l){var f=new Error(l+"");f.cause=l,l=f}var h=n(u).call(d._boundValue(),l);h===a&&r.throwLater(h.e)}e.prototype.asCallback=e.prototype.nodeify=function(l,u){if(typeof l=="function"){var d=o;u!==void 0&&Object(u).spread&&(d=i),this._then(d,c,void 0,this,l)}return this}}),$y}var Wy,w3;function R5e(){return w3||(w3=1,Wy=function(e,t){var r={},n=nr(),a=eB(),i=n.withAppended,o=n.maybeWrapAsError,c=n.canEvaluate,l=go().TypeError,u="Async",d={__isPromisified__:!0},f=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],h=new RegExp("^(?:"+f.join("|")+")$"),m=function(M){return n.isIdentifier(M)&&M.charAt(0)!=="_"&&M!=="constructor"};function x(M){return!h.test(M)}function p(M){try{return M.__isPromisified__===!0}catch{return!1}}function g(M,P,X){var q=n.getDataPropertyOrDefault(M,P+X,d);return q?p(q):!1}function v(M,P,X){for(var q=0;q<M.length;q+=2){var B=M[q];if(X.test(B)){for(var O=B.replace(X,""),F=0;F<M.length;F+=2)if(M[F]===O)throw new l(`Cannot promisify an API that has normal methods with '%s'-suffix

    See http://goo.gl/MqrFmX
`.replace("%s",P))}}}function y(M,P,X,q){for(var B=n.inheritedDataKeys(M),O=[],F=0;F<B.length;++F){var I=B[F],L=M[I],C=q===m?!0:m(I);typeof L=="function"&&!p(L)&&!g(M,I,P)&&q(I,L,M,C)&&O.push(I,L)}return v(O,P,X),O}var b=function(M){return M.replace(/([$])/,"\\$")},_;{var w=function(M){for(var P=[M],X=Math.max(0,M-1-3),q=M-1;q>=X;--q)P.push(q);for(var q=M+1;q<=3;++q)P.push(q);return P},j=function(M){return n.filledRange(M,"_arg","")},N=function(M){return n.filledRange(Math.max(M,3),"_arg","")},D=function(M){return typeof M.length=="number"?Math.max(Math.min(M.length,1024),0):0};_=function(M,P,X,q,B,O){var F=Math.max(0,D(q)-1),I=w(F),L=typeof M=="string"||P===r;function C(Z){var ce=j(Z).join(", "),ie=Z>0?", ":"",Q;return L?Q=`ret = callback.call(this, {{args}}, nodeback); break;
`:Q=P===void 0?`ret = callback({{args}}, nodeback); break;
`:`ret = callback.call(receiver, {{args}}, nodeback); break;
`,Q.replace("{{args}}",ce).replace(", ",ie)}function k(){for(var Z="",ce=0;ce<I.length;++ce)Z+="case "+I[ce]+":"+C(I[ce]);return Z+=`                                                             
	        default:                                                             
	            var args = new Array(len + 1);                                   
	            var i = 0;                                                       
	            for (var i = 0; i < len; ++i) {                                  
	               args[i] = arguments[i];                                       
	            }                                                                
	            args[i] = nodeback;                                              
	            [CodeForCall]                                                    
	            break;                                                           
	        `.replace("[CodeForCall]",L?`ret = callback.apply(this, args);
`:`ret = callback.apply(receiver, args);
`),Z}var z=typeof M=="string"?"this != null ? this['"+M+"'] : fn":"fn",V=`'use strict';                                                
	        var ret = function (Parameters) {                                    
	            'use strict';                                                    
	            var len = arguments.length;                                      
	            var promise = new Promise(INTERNAL);                             
	            promise._captureStackTrace();                                    
	            var nodeback = nodebackForPromise(promise, `+O+`);   
	            var ret;                                                         
	            var callback = tryCatch([GetFunctionCode]);                      
	            switch(len) {                                                    
	                [CodeForSwitchCase]                                          
	            }                                                                
	            if (ret === errorObj) {                                          
	                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);
	            }                                                                
	            if (!promise._isFateSealed()) promise._setAsyncGuaranteed();     
	            return promise;                                                  
	        };                                                                   
	        notEnumerableProp(ret, '__isPromisified__', true);                   
	        return ret;                                                          
	    `.replace("[CodeForSwitchCase]",k()).replace("[GetFunctionCode]",z);return V=V.replace("Parameters",N(F)),new Function("Promise","fn","receiver","withAppended","maybeWrapAsError","nodebackForPromise","tryCatch","errorObj","notEnumerableProp","INTERNAL",V)(e,q,P,i,o,a,n.tryCatch,n.errorObj,n.notEnumerableProp,t)}}function S(M,P,X,q,B,O){var F=function(){return this}(),I=M;typeof I=="string"&&(M=q);function L(){var C=P;P===r&&(C=this);var k=new e(t);k._captureStackTrace();var z=typeof I=="string"&&this!==F?this[I]:M,V=a(k,O);try{z.apply(C,i(arguments,V))}catch(Z){k._rejectCallback(o(Z),!0,!0)}return k._isFateSealed()||k._setAsyncGuaranteed(),k}return n.notEnumerableProp(L,"__isPromisified__",!0),L}var T=c?_:S;function A(M,P,X,q,B){for(var O=new RegExp(b(P)+"$"),F=y(M,P,O,X),I=0,L=F.length;I<L;I+=2){var C=F[I],k=F[I+1],z=C+P;if(q===T)M[z]=T(C,r,C,k,P,B);else{var V=q(k,function(){return T(C,r,C,k,P,B)});n.notEnumerableProp(V,"__isPromisified__",!0),M[z]=V}}return n.toFastProperties(M),M}function E(M,P,X){return T(M,P,void 0,M,null,X)}e.promisify=function(M,P){if(typeof M!="function")throw new l("expecting a function but got "+n.classString(M));if(p(M))return M;P=Object(P);var X=P.context===void 0?r:P.context,q=!!P.multiArgs,B=E(M,X,q);return n.copyDescriptors(M,B,x),B},e.promisifyAll=function(M,P){if(typeof M!="function"&&typeof M!="object")throw new l(`the target of promisifyAll must be an object or a function

    See http://goo.gl/MqrFmX
`);P=Object(P);var X=!!P.multiArgs,q=P.suffix;typeof q!="string"&&(q=u);var B=P.filter;typeof B!="function"&&(B=m);var O=P.promisifier;if(typeof O!="function"&&(O=T),!n.isIdentifier(q))throw new RangeError(`suffix must be a valid identifier

    See http://goo.gl/MqrFmX
`);for(var F=n.inheritedDataKeys(M),I=0;I<F.length;++I){var L=M[F[I]];F[I]!=="constructor"&&n.isClass(L)&&(A(L.prototype,q,B,O,X),A(L,q,B,O,X))}return A(M,q,B,O,X)}}),Wy}var zy,_3;function M5e(){return _3||(_3=1,zy=function(e,t,r,n){var a=nr(),i=a.isObject,o=Ru(),c;typeof Map=="function"&&(c=Map);var l=function(){var h=0,m=0;function x(p,g){this[h]=p,this[h+m]=g,h++}return function(g){m=g.size,h=0;var v=new Array(g.size*2);return g.forEach(x,v),v}}(),u=function(h){for(var m=new c,x=h.length/2|0,p=0;p<x;++p){var g=h[x+p],v=h[p];m.set(g,v)}return m};function d(h){var m=!1,x;if(c!==void 0&&h instanceof c)x=l(h),m=!0;else{var p=o.keys(h),g=p.length;x=new Array(g*2);for(var v=0;v<g;++v){var y=p[v];x[v]=h[y],x[v+g]=y}}this.constructor$(x),this._isMap=m,this._init$(void 0,-3)}a.inherits(d,t),d.prototype._init=function(){},d.prototype._promiseFulfilled=function(h,m){this._values[m]=h;var x=++this._totalResolved;if(x>=this._length){var p;if(this._isMap)p=u(this._values);else{p={};for(var g=this.length(),v=0,y=this.length();v<y;++v)p[this._values[v+g]]=this._values[v]}return this._resolve(p),!0}return!1},d.prototype.shouldCopyValues=function(){return!1},d.prototype.getActualLength=function(h){return h>>1};function f(h){var m,x=r(h);if(i(x))x instanceof e?m=x._then(e.props,void 0,void 0,void 0,void 0):m=new d(x).promise();else return n(`cannot await properties of a non-object

    See http://goo.gl/MqrFmX
`);return x instanceof e&&m._propagateFrom(x,2),m}e.prototype.props=function(){return f(this)},e.props=function(h){return f(h)}}),zy}var qy,j3;function B5e(){return j3||(j3=1,qy=function(e,t,r,n){var a=nr(),i=function(c){return c.then(function(l){return o(l,c)})};function o(c,l){var u=r(c);if(u instanceof e)return i(u);if(c=a.asArray(c),c===null)return n("expecting an array or an iterable object but got "+a.classString(c));var d=new e(t);l!==void 0&&d._propagateFrom(l,3);for(var f=d._fulfill,h=d._reject,m=0,x=c.length;m<x;++m){var p=c[m];p===void 0&&!(m in c)||e.cast(p)._then(f,h,void 0,d,null)}return d}e.race=function(c){return o(c,void 0)},e.prototype.race=function(){return o(this,void 0)}}),qy}var Hy,N3;function L5e(){return N3||(N3=1,Hy=function(e,t,r,n,a,i){var o=e._getDomain,c=nr(),l=c.tryCatch;function u(x,p,g,v){this.constructor$(x);var y=o();this._fn=y===null?p:c.domainBind(y,p),g!==void 0&&(g=e.resolve(g),g._attachCancellationCallback(this)),this._initialValue=g,this._currentCancellable=null,v===a?this._eachValues=Array(this._length):v===0?this._eachValues=null:this._eachValues=void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}c.inherits(u,t),u.prototype._gotAccum=function(x){this._eachValues!==void 0&&this._eachValues!==null&&x!==a&&this._eachValues.push(x)},u.prototype._eachComplete=function(x){return this._eachValues!==null&&this._eachValues.push(x),this._eachValues},u.prototype._init=function(){},u.prototype._resolveEmptyArray=function(){this._resolve(this._eachValues!==void 0?this._eachValues:this._initialValue)},u.prototype.shouldCopyValues=function(){return!1},u.prototype._resolve=function(x){this._promise._resolveCallback(x),this._values=null},u.prototype._resultCancelled=function(x){if(x===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof e&&this._currentCancellable.cancel(),this._initialValue instanceof e&&this._initialValue.cancel())},u.prototype._iterate=function(x){this._values=x;var p,g,v=x.length;if(this._initialValue!==void 0?(p=this._initialValue,g=0):(p=e.resolve(x[0]),g=1),this._currentCancellable=p,!p.isRejected())for(;g<v;++g){var y={accum:null,value:x[g],index:g,length:v,array:this};p=p._then(h,void 0,void 0,y,void 0)}this._eachValues!==void 0&&(p=p._then(this._eachComplete,void 0,void 0,this,void 0)),p._then(d,d,void 0,p,this)},e.prototype.reduce=function(x,p){return f(this,x,p,null)},e.reduce=function(x,p,g,v){return f(x,p,g,v)};function d(x,p){this.isFulfilled()?p._resolve(x):p._reject(x)}function f(x,p,g,v){if(typeof p!="function")return r("expecting a function but got "+c.classString(p));var y=new u(x,p,g,v);return y.promise()}function h(x){this.accum=x,this.array._gotAccum(x);var p=n(this.value,this.array._promise);return p instanceof e?(this.array._currentCancellable=p,p._then(m,void 0,void 0,this,void 0)):m.call(this,p)}function m(x){var p=this.array,g=p._promise,v=l(p._fn);g._pushContext();var y;p._eachValues!==void 0?y=v.call(g._boundValue(),x,this.index,this.length):y=v.call(g._boundValue(),this.accum,x,this.index,this.length),y instanceof e&&(p._currentCancellable=y);var b=g._popContext();return i.checkForgottenReturns(y,b,p._eachValues!==void 0?"Promise.each":"Promise.reduce",g),y}}),Hy}var Vy,D3;function $5e(){return D3||(D3=1,Vy=function(e,t,r){var n=e.PromiseInspection,a=nr();function i(o){this.constructor$(o)}a.inherits(i,t),i.prototype._promiseResolved=function(o,c){this._values[o]=c;var l=++this._totalResolved;return l>=this._length?(this._resolve(this._values),!0):!1},i.prototype._promiseFulfilled=function(o,c){var l=new n;return l._bitField=33554432,l._settledValueField=o,this._promiseResolved(c,l)},i.prototype._promiseRejected=function(o,c){var l=new n;return l._bitField=16777216,l._settledValueField=o,this._promiseResolved(c,l)},e.settle=function(o){return r.deprecated(".settle()",".reflect()"),new i(o).promise()},e.prototype.settle=function(){return e.settle(this)}}),Vy}var Gy,S3;function W5e(){return S3||(S3=1,Gy=function(e,t,r){var n=nr(),a=go().RangeError,i=go().AggregateError,o=n.isArray,c={};function l(d){this.constructor$(d),this._howMany=0,this._unwrap=!1,this._initialized=!1}n.inherits(l,t),l.prototype._init=function(){if(this._initialized){if(this._howMany===0){this._resolve([]);return}this._init$(void 0,-5);var d=o(this._values);!this._isResolved()&&d&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},l.prototype.init=function(){this._initialized=!0,this._init()},l.prototype.setUnwrap=function(){this._unwrap=!0},l.prototype.howMany=function(){return this._howMany},l.prototype.setHowMany=function(d){this._howMany=d},l.prototype._promiseFulfilled=function(d){return this._addFulfilled(d),this._fulfilled()===this.howMany()?(this._values.length=this.howMany(),this.howMany()===1&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0):!1},l.prototype._promiseRejected=function(d){return this._addRejected(d),this._checkOutcome()},l.prototype._promiseCancelled=function(){return this._values instanceof e||this._values==null?this._cancel():(this._addRejected(c),this._checkOutcome())},l.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var d=new i,f=this.length();f<this._values.length;++f)this._values[f]!==c&&d.push(this._values[f]);return d.length>0?this._reject(d):this._cancel(),!0}return!1},l.prototype._fulfilled=function(){return this._totalResolved},l.prototype._rejected=function(){return this._values.length-this.length()},l.prototype._addRejected=function(d){this._values.push(d)},l.prototype._addFulfilled=function(d){this._values[this._totalResolved++]=d},l.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},l.prototype._getRangeError=function(d){var f="Input array must contain at least "+this._howMany+" items but contains only "+d+" items";return new a(f)},l.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))};function u(d,f){if((f|0)!==f||f<0)return r(`expecting a positive integer

    See http://goo.gl/MqrFmX
`);var h=new l(d),m=h.promise();return h.setHowMany(f),h.init(),m}e.some=function(d,f){return u(d,f)},e.prototype.some=function(d){return u(this,d)},e._SomePromiseArray=l}),Gy}var Xy,E3;function z5e(){return E3||(E3=1,Xy=function(e,t){var r=e.map;e.prototype.filter=function(n,a){return r(this,n,a,t)},e.filter=function(n,a,i){return r(n,a,i,t)}}),Xy}var Ky,T3;function q5e(){return T3||(T3=1,Ky=function(e,t){var r=e.reduce,n=e.all;function a(){return n(this)}function i(o,c){return r(o,c,t,t)}e.prototype.each=function(o){return r(this,o,t,0)._then(a,void 0,void 0,this,void 0)},e.prototype.mapSeries=function(o){return r(this,o,t,t)},e.each=function(o,c){return r(o,c,t,0)._then(a,void 0,void 0,o,void 0)},e.mapSeries=i}),Ky}var Yy,C3;function H5e(){return C3||(C3=1,Yy=function(e){var t=e._SomePromiseArray;function r(n){var a=new t(n),i=a.promise();return a.setHowMany(1),a.setUnwrap(),a.init(),i}e.any=function(n){return r(n)},e.prototype.any=function(){return r(this)}}),Yy}(function(e){e.exports=function(){var t=function(){return new h(`circular promise resolution chain

    See http://goo.gl/MqrFmX
`)},r=function(){return new E.PromiseInspection(this._target())},n=function(q){return E.reject(new h(q))};function a(){}var i={},o=nr(),c;o.isNode?c=function(){var q=process.domain;return q===void 0&&(q=null),q}:c=function(){return null},o.notEnumerableProp(E,"_getDomain",c);var l=Ru(),u=v5e(),d=new u;l.defineProperty(E,"_async",{value:d});var f=go(),h=E.TypeError=f.TypeError;E.RangeError=f.RangeError;var m=E.CancellationError=f.CancellationError;E.TimeoutError=f.TimeoutError,E.OperationalError=f.OperationalError,E.RejectionError=f.OperationalError,E.AggregateError=f.AggregateError;var x=function(){},p={},g={},v=y5e()(E,x),y=b5e()(E,x,v,n,a),b=w5e()(E),_=b.create,w=_5e()(E,b);w.CapturedTrace;var j=j5e()(E,v),N=N5e()(g),D=eB(),S=o.errorObj,T=o.tryCatch;function A(q,B){if(typeof B!="function")throw new h("expecting a function but got "+o.classString(B));if(q.constructor!==E)throw new h(`the promise constructor cannot be invoked directly

    See http://goo.gl/MqrFmX
`)}function E(q){this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,q!==x&&(A(this,q),this._resolveFromExecutor(q)),this._promiseCreated(),this._fireEvent("promiseCreated",this)}E.prototype.toString=function(){return"[object Promise]"},E.prototype.caught=E.prototype.catch=function(q){var B=arguments.length;if(B>1){var O=new Array(B-1),F=0,I;for(I=0;I<B-1;++I){var L=arguments[I];if(o.isObject(L))O[F++]=L;else return n("expecting an object but got A catch statement predicate "+o.classString(L))}return O.length=F,q=arguments[I],this.then(void 0,N(O,q,this))}return this.then(void 0,q)},E.prototype.reflect=function(){return this._then(r,r,void 0,this,void 0)},E.prototype.then=function(q,B){if(w.warnings()&&arguments.length>0&&typeof q!="function"&&typeof B!="function"){var O=".then() only accepts functions but was passed: "+o.classString(q);arguments.length>1&&(O+=", "+o.classString(B)),this._warn(O)}return this._then(q,B,void 0,void 0,void 0)},E.prototype.done=function(q,B){var O=this._then(q,B,void 0,void 0,void 0);O._setIsFinal()},E.prototype.spread=function(q){return typeof q!="function"?n("expecting a function but got "+o.classString(q)):this.all()._then(q,void 0,void 0,p,void 0)},E.prototype.toJSON=function(){var q={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(q.fulfillmentValue=this.value(),q.isFulfilled=!0):this.isRejected()&&(q.rejectionReason=this.reason(),q.isRejected=!0),q},E.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new y(this).promise()},E.prototype.error=function(q){return this.caught(o.originatesFromRejection,q)},E.getNewLibraryCopy=e.exports,E.is=function(q){return q instanceof E},E.fromNode=E.fromCallback=function(q){var B=new E(x);B._captureStackTrace();var O=arguments.length>1?!!Object(arguments[1]).multiArgs:!1,F=T(q)(D(B,O));return F===S&&B._rejectCallback(F.e,!0),B._isFateSealed()||B._setAsyncGuaranteed(),B},E.all=function(q){return new y(q).promise()},E.cast=function(q){var B=v(q);return B instanceof E||(B=new E(x),B._captureStackTrace(),B._setFulfilled(),B._rejectionHandler0=q),B},E.resolve=E.fulfilled=E.cast,E.reject=E.rejected=function(q){var B=new E(x);return B._captureStackTrace(),B._rejectCallback(q,!0),B},E.setScheduler=function(q){if(typeof q!="function")throw new h("expecting a function but got "+o.classString(q));return d.setScheduler(q)},E.prototype._then=function(q,B,O,F,I){var L=I!==void 0,C=L?I:new E(x),k=this._target(),z=k._bitField;L||(C._propagateFrom(this,3),C._captureStackTrace(),F===void 0&&this._bitField&2097152&&(z&50397184?F=this._boundValue():F=k===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,C));var V=c();if(z&50397184){var Z,ce,ie=k._settlePromiseCtx;z&33554432?(ce=k._rejectionHandler0,Z=q):z&16777216?(ce=k._fulfillmentHandler0,Z=B,k._unsetRejectionIsUnhandled()):(ie=k._settlePromiseLateCancellationObserver,ce=new m("late cancellation observer"),k._attachExtraTrace(ce),Z=B),d.invoke(ie,k,{handler:V===null?Z:typeof Z=="function"&&o.domainBind(V,Z),promise:C,receiver:F,value:ce})}else k._addCallbacks(q,B,C,F,V);return C},E.prototype._length=function(){return this._bitField&65535},E.prototype._isFateSealed=function(){return(this._bitField&117506048)!==0},E.prototype._isFollowing=function(){return(this._bitField&67108864)===67108864},E.prototype._setLength=function(q){this._bitField=this._bitField&-65536|q&65535},E.prototype._setFulfilled=function(){this._bitField=this._bitField|33554432,this._fireEvent("promiseFulfilled",this)},E.prototype._setRejected=function(){this._bitField=this._bitField|16777216,this._fireEvent("promiseRejected",this)},E.prototype._setFollowing=function(){this._bitField=this._bitField|67108864,this._fireEvent("promiseResolved",this)},E.prototype._setIsFinal=function(){this._bitField=this._bitField|4194304},E.prototype._isFinal=function(){return(this._bitField&4194304)>0},E.prototype._unsetCancelled=function(){this._bitField=this._bitField&-65537},E.prototype._setCancelled=function(){this._bitField=this._bitField|65536,this._fireEvent("promiseCancelled",this)},E.prototype._setWillBeCancelled=function(){this._bitField=this._bitField|8388608},E.prototype._setAsyncGuaranteed=function(){d.hasCustomScheduler()||(this._bitField=this._bitField|134217728)},E.prototype._receiverAt=function(q){var B=q===0?this._receiver0:this[q*4-4+3];if(B!==i)return B===void 0&&this._isBound()?this._boundValue():B},E.prototype._promiseAt=function(q){return this[q*4-4+2]},E.prototype._fulfillmentHandlerAt=function(q){return this[q*4-4+0]},E.prototype._rejectionHandlerAt=function(q){return this[q*4-4+1]},E.prototype._boundValue=function(){},E.prototype._migrateCallback0=function(q){q._bitField;var B=q._fulfillmentHandler0,O=q._rejectionHandler0,F=q._promise0,I=q._receiverAt(0);I===void 0&&(I=i),this._addCallbacks(B,O,F,I,null)},E.prototype._migrateCallbackAt=function(q,B){var O=q._fulfillmentHandlerAt(B),F=q._rejectionHandlerAt(B),I=q._promiseAt(B),L=q._receiverAt(B);L===void 0&&(L=i),this._addCallbacks(O,F,I,L,null)},E.prototype._addCallbacks=function(q,B,O,F,I){var L=this._length();if(L>=65531&&(L=0,this._setLength(0)),L===0)this._promise0=O,this._receiver0=F,typeof q=="function"&&(this._fulfillmentHandler0=I===null?q:o.domainBind(I,q)),typeof B=="function"&&(this._rejectionHandler0=I===null?B:o.domainBind(I,B));else{var C=L*4-4;this[C+2]=O,this[C+3]=F,typeof q=="function"&&(this[C+0]=I===null?q:o.domainBind(I,q)),typeof B=="function"&&(this[C+1]=I===null?B:o.domainBind(I,B))}return this._setLength(L+1),L},E.prototype._proxy=function(q,B){this._addCallbacks(void 0,void 0,B,q,null)},E.prototype._resolveCallback=function(q,B){if(!(this._bitField&117506048)){if(q===this)return this._rejectCallback(t(),!1);var O=v(q,this);if(!(O instanceof E))return this._fulfill(q);B&&this._propagateFrom(O,2);var F=O._target();if(F===this){this._reject(t());return}var I=F._bitField;if(I&50397184)if(I&33554432)this._fulfill(F._value());else if(I&16777216)this._reject(F._reason());else{var k=new m("late cancellation observer");F._attachExtraTrace(k),this._reject(k)}else{var L=this._length();L>0&&F._migrateCallback0(this);for(var C=1;C<L;++C)F._migrateCallbackAt(this,C);this._setFollowing(),this._setLength(0),this._setFollowee(F)}}},E.prototype._rejectCallback=function(q,B,O){var F=o.ensureErrorObject(q),I=F===q;if(!I&&!O&&w.warnings()){var L="a promise was rejected with a non-error: "+o.classString(q);this._warn(L,!0)}this._attachExtraTrace(F,B?I:!1),this._reject(q)},E.prototype._resolveFromExecutor=function(q){var B=this;this._captureStackTrace(),this._pushContext();var O=!0,F=this._execute(q,function(I){B._resolveCallback(I)},function(I){B._rejectCallback(I,O)});O=!1,this._popContext(),F!==void 0&&B._rejectCallback(F,!0)},E.prototype._settlePromiseFromHandler=function(q,B,O,F){var I=F._bitField;if(!(I&65536)){F._pushContext();var L;B===p?!O||typeof O.length!="number"?(L=S,L.e=new h("cannot .spread() a non-array: "+o.classString(O))):L=T(q).apply(this._boundValue(),O):L=T(q).call(B,O);var C=F._popContext();I=F._bitField,!(I&65536)&&(L===g?F._reject(O):L===S?F._rejectCallback(L.e,!1):(w.checkForgottenReturns(L,C,"",F,this),F._resolveCallback(L)))}},E.prototype._target=function(){for(var q=this;q._isFollowing();)q=q._followee();return q},E.prototype._followee=function(){return this._rejectionHandler0},E.prototype._setFollowee=function(q){this._rejectionHandler0=q},E.prototype._settlePromise=function(q,B,O,F){var I=q instanceof E,L=this._bitField,C=(L&134217728)!==0;L&65536?(I&&q._invokeInternalOnCancel(),O instanceof j&&O.isFinallyHandler()?(O.cancelPromise=q,T(B).call(O,F)===S&&q._reject(S.e)):B===r?q._fulfill(r.call(O)):O instanceof a?O._promiseCancelled(q):I||q instanceof y?q._cancel():O.cancel()):typeof B=="function"?I?(C&&q._setAsyncGuaranteed(),this._settlePromiseFromHandler(B,O,F,q)):B.call(O,F,q):O instanceof a?O._isResolved()||(L&33554432?O._promiseFulfilled(F,q):O._promiseRejected(F,q)):I&&(C&&q._setAsyncGuaranteed(),L&33554432?q._fulfill(F):q._reject(F))},E.prototype._settlePromiseLateCancellationObserver=function(q){var B=q.handler,O=q.promise,F=q.receiver,I=q.value;typeof B=="function"?O instanceof E?this._settlePromiseFromHandler(B,F,I,O):B.call(F,I,O):O instanceof E&&O._reject(I)},E.prototype._settlePromiseCtx=function(q){this._settlePromise(q.promise,q.handler,q.receiver,q.value)},E.prototype._settlePromise0=function(q,B,O){var F=this._promise0,I=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(F,q,I,B)},E.prototype._clearCallbackDataAtIndex=function(q){var B=q*4-4;this[B+2]=this[B+3]=this[B+0]=this[B+1]=void 0},E.prototype._fulfill=function(q){var B=this._bitField;if(!((B&117506048)>>>16)){if(q===this){var O=t();return this._attachExtraTrace(O),this._reject(O)}this._setFulfilled(),this._rejectionHandler0=q,(B&65535)>0&&(B&134217728?this._settlePromises():d.settlePromises(this))}},E.prototype._reject=function(q){var B=this._bitField;if(!((B&117506048)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=q,this._isFinal())return d.fatalError(q,o.isNode);(B&65535)>0?d.settlePromises(this):this._ensurePossibleRejectionHandled()}},E.prototype._fulfillPromises=function(q,B){for(var O=1;O<q;O++){var F=this._fulfillmentHandlerAt(O),I=this._promiseAt(O),L=this._receiverAt(O);this._clearCallbackDataAtIndex(O),this._settlePromise(I,F,L,B)}},E.prototype._rejectPromises=function(q,B){for(var O=1;O<q;O++){var F=this._rejectionHandlerAt(O),I=this._promiseAt(O),L=this._receiverAt(O);this._clearCallbackDataAtIndex(O),this._settlePromise(I,F,L,B)}},E.prototype._settlePromises=function(){var q=this._bitField,B=q&65535;if(B>0){if(q&16842752){var O=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,O,q),this._rejectPromises(B,O)}else{var F=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,F,q),this._fulfillPromises(B,F)}this._setLength(0)}this._clearCancellationData()},E.prototype._settledValue=function(){var q=this._bitField;if(q&33554432)return this._rejectionHandler0;if(q&16777216)return this._fulfillmentHandler0};function M(q){this.promise._resolveCallback(q)}function P(q){this.promise._rejectCallback(q,!1)}E.defer=E.pending=function(){w.deprecated("Promise.defer","new Promise");var q=new E(x);return{promise:q,resolve:M,reject:P}},o.notEnumerableProp(E,"_makeSelfResolutionError",t),D5e()(E,x,v,n,w),S5e()(E,x,v,w),E5e()(E,y,n,w),T5e()(E),C5e()(E),A5e()(E,y,v,x,d,c),E.Promise=E,E.version="3.4.7",k5e()(E,y,n,v,x,w),F5e()(E),O5e()(E,n,v,_,x,w),P5e()(E,x,w),I5e()(E,n,x,v,a,w),U5e()(E),R5e()(E,x),M5e()(E,y,v,n),B5e()(E,x,v,n),L5e()(E,y,n,v,x,w),$5e()(E,y,w),W5e()(E,y,n),z5e()(E,x),q5e()(E,x),H5e()(E),o.toFastProperties(E),o.toFastProperties(E.prototype);function X(q){var B=new E(x);B._fulfillmentHandler0=q,B._rejectionHandler0=q,B._promise0=q,B._receiver0=q}return X({a:1}),X({b:2}),X({c:3}),X(1),X(function(){}),X(void 0),X(!1),X(new E(x)),w.setBounds(u.firstLineError,o.lastLineError),E}})(QM);var V5e=QM.exports,G5e=Or,la=V5e();cn.defer=X5e;cn.when=la.resolve;cn.resolve=la.resolve;cn.all=la.all;cn.props=la.props;cn.reject=la.reject;cn.promisify=la.promisify;cn.mapSeries=la.mapSeries;cn.attempt=la.attempt;cn.nfcall=function(e){var t=Array.prototype.slice.call(arguments,1),r=la.promisify(e);return r.apply(null,t)};la.prototype.fail=la.prototype.caught;la.prototype.also=function(e){return this.then(function(t){var r=G5e.extend({},t,e(t));return la.props(r)})};function X5e(){var e,t,r=new la.Promise(function(n,a){e=n,t=a});return{resolve:e,reject:t,promise:r}}var St={},K5e=Or,gn=St.types={document:"document",paragraph:"paragraph",run:"run",text:"text",tab:"tab",checkbox:"checkbox",hyperlink:"hyperlink",noteReference:"noteReference",image:"image",note:"note",commentReference:"commentReference",comment:"comment",table:"table",tableRow:"tableRow",tableCell:"tableCell",break:"break",bookmarkStart:"bookmarkStart"};function Y5e(e,t){return t=t||{},{type:gn.document,children:e,notes:t.notes||new Og({}),comments:t.comments||[]}}function Z5e(e,t){t=t||{};var r=t.indent||{};return{type:gn.paragraph,children:e,styleId:t.styleId||null,styleName:t.styleName||null,numbering:t.numbering||null,alignment:t.alignment||null,indent:{start:r.start||null,end:r.end||null,firstLine:r.firstLine||null,hanging:r.hanging||null}}}function J5e(e,t){return t=t||{},{type:gn.run,children:e,styleId:t.styleId||null,styleName:t.styleName||null,isBold:!!t.isBold,isUnderline:!!t.isUnderline,isItalic:!!t.isItalic,isStrikethrough:!!t.isStrikethrough,isAllCaps:!!t.isAllCaps,isSmallCaps:!!t.isSmallCaps,verticalAlignment:t.verticalAlignment||tB.baseline,font:t.font||null,fontSize:t.fontSize||null,highlight:t.highlight||null}}var tB={baseline:"baseline",superscript:"superscript",subscript:"subscript"};function Q5e(e){return{type:gn.text,value:e}}function ePe(){return{type:gn.tab}}function tPe(e){return{type:gn.checkbox,checked:e.checked}}function rPe(e,t){return{type:gn.hyperlink,children:e,href:t.href,anchor:t.anchor,targetFrame:t.targetFrame}}function nPe(e){return{type:gn.noteReference,noteType:e.noteType,noteId:e.noteId}}function Og(e){this._notes=K5e.indexBy(e,function(t){return rB(t.noteType,t.noteId)})}Og.prototype.resolve=function(e){return this.findNoteByKey(rB(e.noteType,e.noteId))};Og.prototype.findNoteByKey=function(e){return this._notes[e]||null};function aPe(e){return{type:gn.note,noteType:e.noteType,noteId:e.noteId,body:e.body}}function iPe(e){return{type:gn.commentReference,commentId:e.commentId}}function sPe(e){return{type:gn.comment,commentId:e.commentId,body:e.body,authorName:e.authorName,authorInitials:e.authorInitials}}function rB(e,t){return e+"-"+t}function oPe(e){return{type:gn.image,read:function(t){return t?e.readImage(t):e.readImage().then(function(r){return Buffer.from(r)})},readAsArrayBuffer:function(){return e.readImage()},readAsBase64String:function(){return e.readImage("base64")},readAsBuffer:function(){return e.readImage().then(function(t){return Buffer.from(t)})},altText:e.altText,contentType:e.contentType}}function cPe(e,t){return t=t||{},{type:gn.table,children:e,styleId:t.styleId||null,styleName:t.styleName||null}}function lPe(e,t){return t=t||{},{type:gn.tableRow,children:e,isHeader:t.isHeader||!1}}function uPe(e,t){return t=t||{},{type:gn.tableCell,children:e,colSpan:t.colSpan==null?1:t.colSpan,rowSpan:t.rowSpan==null?1:t.rowSpan}}function bN(e){return{type:gn.break,breakType:e}}function dPe(e){return{type:gn.bookmarkStart,name:e.name}}St.document=St.Document=Y5e;St.paragraph=St.Paragraph=Z5e;St.run=St.Run=J5e;St.text=St.Text=Q5e;St.tab=St.Tab=ePe;St.checkbox=St.Checkbox=tPe;St.Hyperlink=rPe;St.noteReference=St.NoteReference=nPe;St.Notes=Og;St.Note=aPe;St.commentReference=iPe;St.comment=sPe;St.Image=oPe;St.Table=cPe;St.TableRow=lPe;St.TableCell=uPe;St.lineBreak=bN("line");St.pageBreak=bN("page");St.columnBreak=bN("column");St.BookmarkStart=dPe;St.verticalAlignment=tB;var Pa={},Yf=Or;Pa.Result=Zi;Pa.success=fPe;Pa.warning=hPe;Pa.error=mPe;function Zi(e,t){this.value=e,this.messages=t||[]}Zi.prototype.map=function(e){return new Zi(e(this.value),this.messages)};Zi.prototype.flatMap=function(e){var t=e(this.value);return new Zi(t.value,wN([this,t]))};Zi.prototype.flatMapThen=function(e){var t=this;return e(this.value).then(function(r){return new Zi(r.value,wN([t,r]))})};Zi.combine=function(e){var t=Yf.flatten(Yf.pluck(e,"value")),r=wN(e);return new Zi(t,r)};function fPe(e){return new Zi(e,[])}function hPe(e){return{type:"warning",message:e}}function mPe(e){return{type:"error",message:e.message,error:e}}function wN(e){var t=[];return Yf.flatten(Yf.pluck(e,"messages"),!0).forEach(function(r){pPe(t,r)||t.push(r)}),t}function pPe(e,t){return Yf.find(e,xPe.bind(null,t))!==void 0}function xPe(e,t){return e.type===t.type&&e.message===t.message}var $h={},Pg={};Pg.byteLength=yPe;Pg.toByteArray=wPe;Pg.fromByteArray=NPe;var Bi=[],Ha=[],gPe=typeof Uint8Array<"u"?Uint8Array:Array,Zy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Kc=0,vPe=Zy.length;Kc<vPe;++Kc)Bi[Kc]=Zy[Kc],Ha[Zy.charCodeAt(Kc)]=Kc;Ha[45]=62;Ha[95]=63;function nB(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");r===-1&&(r=t);var n=r===t?0:4-r%4;return[r,n]}function yPe(e){var t=nB(e),r=t[0],n=t[1];return(r+n)*3/4-n}function bPe(e,t,r){return(t+r)*3/4-r}function wPe(e){var t,r=nB(e),n=r[0],a=r[1],i=new gPe(bPe(e,n,a)),o=0,c=a>0?n-4:n,l;for(l=0;l<c;l+=4)t=Ha[e.charCodeAt(l)]<<18|Ha[e.charCodeAt(l+1)]<<12|Ha[e.charCodeAt(l+2)]<<6|Ha[e.charCodeAt(l+3)],i[o++]=t>>16&255,i[o++]=t>>8&255,i[o++]=t&255;return a===2&&(t=Ha[e.charCodeAt(l)]<<2|Ha[e.charCodeAt(l+1)]>>4,i[o++]=t&255),a===1&&(t=Ha[e.charCodeAt(l)]<<10|Ha[e.charCodeAt(l+1)]<<4|Ha[e.charCodeAt(l+2)]>>2,i[o++]=t>>8&255,i[o++]=t&255),i}function _Pe(e){return Bi[e>>18&63]+Bi[e>>12&63]+Bi[e>>6&63]+Bi[e&63]}function jPe(e,t,r){for(var n,a=[],i=t;i<r;i+=3)n=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(e[i+2]&255),a.push(_Pe(n));return a.join("")}function NPe(e){for(var t,r=e.length,n=r%3,a=[],i=16383,o=0,c=r-n;o<c;o+=i)a.push(jPe(e,o,o+i>c?c:o+i));return n===1?(t=e[r-1],a.push(Bi[t>>2]+Bi[t<<4&63]+"==")):n===2&&(t=(e[r-2]<<8)+e[r-1],a.push(Bi[t>>10]+Bi[t>>4&63]+Bi[t<<2&63]+"=")),a.join("")}function Tm(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var aB={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,a,i){function o(u,d){if(!a[u]){if(!n[u]){var f=typeof Tm=="function"&&Tm;if(!d&&f)return f(u,!0);if(c)return c(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var m=a[u]={exports:{}};n[u][0].call(m.exports,function(x){var p=n[u][1][x];return o(p||x)},m,m.exports,r,n,a,i)}return a[u].exports}for(var c=typeof Tm=="function"&&Tm,l=0;l<i.length;l++)o(i[l]);return o}({1:[function(r,n,a){var i=r("./utils"),o=r("./support"),c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(l){for(var u,d,f,h,m,x,p,g=[],v=0,y=l.length,b=y,_=i.getTypeOf(l)!=="string";v<l.length;)b=y-v,f=_?(u=l[v++],d=v<y?l[v++]:0,v<y?l[v++]:0):(u=l.charCodeAt(v++),d=v<y?l.charCodeAt(v++):0,v<y?l.charCodeAt(v++):0),h=u>>2,m=(3&u)<<4|d>>4,x=1<b?(15&d)<<2|f>>6:64,p=2<b?63&f:64,g.push(c.charAt(h)+c.charAt(m)+c.charAt(x)+c.charAt(p));return g.join("")},a.decode=function(l){var u,d,f,h,m,x,p=0,g=0,v="data:";if(l.substr(0,v.length)===v)throw new Error("Invalid base64 input, it looks like a data url.");var y,b=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===c.charAt(64)&&b--,l.charAt(l.length-2)===c.charAt(64)&&b--,b%1!=0)throw new Error("Invalid base64 input, bad content length.");for(y=o.uint8array?new Uint8Array(0|b):new Array(0|b);p<l.length;)u=c.indexOf(l.charAt(p++))<<2|(h=c.indexOf(l.charAt(p++)))>>4,d=(15&h)<<4|(m=c.indexOf(l.charAt(p++)))>>2,f=(3&m)<<6|(x=c.indexOf(l.charAt(p++))),y[g++]=u,m!==64&&(y[g++]=d),x!==64&&(y[g++]=f);return y}},{"./support":30,"./utils":32}],2:[function(r,n,a){var i=r("./external"),o=r("./stream/DataWorker"),c=r("./stream/Crc32Probe"),l=r("./stream/DataLengthProbe");function u(d,f,h,m,x){this.compressedSize=d,this.uncompressedSize=f,this.crc32=h,this.compression=m,this.compressedContent=x}u.prototype={getContentWorker:function(){var d=new o(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),f=this;return d.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),d},getCompressedWorker:function(){return new o(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(d,f,h){return d.pipe(new c).pipe(new l("uncompressedSize")).pipe(f.compressWorker(h)).pipe(new l("compressedSize")).withStreamInfo("compression",f)},n.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,n,a){var i=r("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},a.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,n,a){var i=r("./utils"),o=function(){for(var c,l=[],u=0;u<256;u++){c=u;for(var d=0;d<8;d++)c=1&c?3988292384^c>>>1:c>>>1;l[u]=c}return l}();n.exports=function(c,l){return c!==void 0&&c.length?i.getTypeOf(c)!=="string"?function(u,d,f,h){var m=o,x=h+f;u^=-1;for(var p=h;p<x;p++)u=u>>>8^m[255&(u^d[p])];return-1^u}(0|l,c,c.length,0):function(u,d,f,h){var m=o,x=h+f;u^=-1;for(var p=h;p<x;p++)u=u>>>8^m[255&(u^d.charCodeAt(p))];return-1^u}(0|l,c,c.length,0):0}},{"./utils":32}],5:[function(r,n,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(r,n,a){var i=null;i=typeof Promise<"u"?Promise:r("lie"),n.exports={Promise:i}},{lie:37}],7:[function(r,n,a){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=r("pako"),c=r("./utils"),l=r("./stream/GenericWorker"),u=i?"uint8array":"array";function d(f,h){l.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=h,this.meta={}}a.magic="\b\0",c.inherits(d,l),d.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(c.transformTo(u,f.data),!1)},d.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},d.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},d.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(h){f.push({data:h,meta:f.meta})}},a.compressWorker=function(f){return new d("Deflate",f)},a.uncompressWorker=function(){return new d("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,n,a){function i(m,x){var p,g="";for(p=0;p<x;p++)g+=String.fromCharCode(255&m),m>>>=8;return g}function o(m,x,p,g,v,y){var b,_,w=m.file,j=m.compression,N=y!==u.utf8encode,D=c.transformTo("string",y(w.name)),S=c.transformTo("string",u.utf8encode(w.name)),T=w.comment,A=c.transformTo("string",y(T)),E=c.transformTo("string",u.utf8encode(T)),M=S.length!==w.name.length,P=E.length!==T.length,X="",q="",B="",O=w.dir,F=w.date,I={crc32:0,compressedSize:0,uncompressedSize:0};x&&!p||(I.crc32=m.crc32,I.compressedSize=m.compressedSize,I.uncompressedSize=m.uncompressedSize);var L=0;x&&(L|=8),N||!M&&!P||(L|=2048);var C=0,k=0;O&&(C|=16),v==="UNIX"?(k=798,C|=function(V,Z){var ce=V;return V||(ce=Z?16893:33204),(65535&ce)<<16}(w.unixPermissions,O)):(k=20,C|=function(V){return 63&(V||0)}(w.dosPermissions)),b=F.getUTCHours(),b<<=6,b|=F.getUTCMinutes(),b<<=5,b|=F.getUTCSeconds()/2,_=F.getUTCFullYear()-1980,_<<=4,_|=F.getUTCMonth()+1,_<<=5,_|=F.getUTCDate(),M&&(q=i(1,1)+i(d(D),4)+S,X+="up"+i(q.length,2)+q),P&&(B=i(1,1)+i(d(A),4)+E,X+="uc"+i(B.length,2)+B);var z="";return z+=`
\0`,z+=i(L,2),z+=j.magic,z+=i(b,2),z+=i(_,2),z+=i(I.crc32,4),z+=i(I.compressedSize,4),z+=i(I.uncompressedSize,4),z+=i(D.length,2),z+=i(X.length,2),{fileRecord:f.LOCAL_FILE_HEADER+z+D+X,dirRecord:f.CENTRAL_FILE_HEADER+i(k,2)+z+i(A.length,2)+"\0\0\0\0"+i(C,4)+i(g,4)+D+X+A}}var c=r("../utils"),l=r("../stream/GenericWorker"),u=r("../utf8"),d=r("../crc32"),f=r("../signature");function h(m,x,p,g){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=x,this.zipPlatform=p,this.encodeFileName=g,this.streamFiles=m,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}c.inherits(h,l),h.prototype.push=function(m){var x=m.meta.percent||0,p=this.entriesCount,g=this._sources.length;this.accumulate?this.contentBuffer.push(m):(this.bytesWritten+=m.data.length,l.prototype.push.call(this,{data:m.data,meta:{currentFile:this.currentFile,percent:p?(x+100*(p-g-1))/p:100}}))},h.prototype.openedSource=function(m){this.currentSourceOffset=this.bytesWritten,this.currentFile=m.file.name;var x=this.streamFiles&&!m.file.dir;if(x){var p=o(m,x,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:p.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(m){this.accumulate=!1;var x=this.streamFiles&&!m.file.dir,p=o(m,x,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(p.dirRecord),x)this.push({data:function(g){return f.DATA_DESCRIPTOR+i(g.crc32,4)+i(g.compressedSize,4)+i(g.uncompressedSize,4)}(m),meta:{percent:100}});else for(this.push({data:p.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var m=this.bytesWritten,x=0;x<this.dirRecords.length;x++)this.push({data:this.dirRecords[x],meta:{percent:100}});var p=this.bytesWritten-m,g=function(v,y,b,_,w){var j=c.transformTo("string",w(_));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(v,2)+i(v,2)+i(y,4)+i(b,4)+i(j.length,2)+j}(this.dirRecords.length,p,m,this.zipComment,this.encodeFileName);this.push({data:g,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(m){this._sources.push(m);var x=this;return m.on("data",function(p){x.processChunk(p)}),m.on("end",function(){x.closedSource(x.previous.streamInfo),x._sources.length?x.prepareNextSource():x.end()}),m.on("error",function(p){x.error(p)}),this},h.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(m){var x=this._sources;if(!l.prototype.error.call(this,m))return!1;for(var p=0;p<x.length;p++)try{x[p].error(m)}catch{}return!0},h.prototype.lock=function(){l.prototype.lock.call(this);for(var m=this._sources,x=0;x<m.length;x++)m[x].lock()},n.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,n,a){var i=r("../compressions"),o=r("./ZipFileWorker");a.generateWorker=function(c,l,u){var d=new o(l.streamFiles,u,l.platform,l.encodeFileName),f=0;try{c.forEach(function(h,m){f++;var x=function(y,b){var _=y||b,w=i[_];if(!w)throw new Error(_+" is not a valid compression method !");return w}(m.options.compression,l.compression),p=m.options.compressionOptions||l.compressionOptions||{},g=m.dir,v=m.date;m._compressWorker(x,p).withStreamInfo("file",{name:h,dir:g,date:v,comment:m.comment||"",unixPermissions:m.unixPermissions,dosPermissions:m.dosPermissions}).pipe(d)}),d.entriesCount=f}catch(h){d.error(h)}return d}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,n,a){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new i;for(var c in this)typeof this[c]!="function"&&(o[c]=this[c]);return o}}(i.prototype=r("./object")).loadAsync=r("./load"),i.support=r("./support"),i.defaults=r("./defaults"),i.version="3.10.1",i.loadAsync=function(o,c){return new i().loadAsync(o,c)},i.external=r("./external"),n.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,n,a){var i=r("./utils"),o=r("./external"),c=r("./utf8"),l=r("./zipEntries"),u=r("./stream/Crc32Probe"),d=r("./nodejsUtils");function f(h){return new o.Promise(function(m,x){var p=h.decompressed.getContentWorker().pipe(new u);p.on("error",function(g){x(g)}).on("end",function(){p.streamInfo.crc32!==h.decompressed.crc32?x(new Error("Corrupted zip : CRC32 mismatch")):m()}).resume()})}n.exports=function(h,m){var x=this;return m=i.extend(m||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:c.utf8decode}),d.isNode&&d.isStream(h)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",h,!0,m.optimizedBinaryString,m.base64).then(function(p){var g=new l(m);return g.load(p),g}).then(function(p){var g=[o.Promise.resolve(p)],v=p.files;if(m.checkCRC32)for(var y=0;y<v.length;y++)g.push(f(v[y]));return o.Promise.all(g)}).then(function(p){for(var g=p.shift(),v=g.files,y=0;y<v.length;y++){var b=v[y],_=b.fileNameStr,w=i.resolve(b.fileNameStr);x.file(w,b.decompressed,{binary:!0,optimizedBinaryString:!0,date:b.date,dir:b.dir,comment:b.fileCommentStr.length?b.fileCommentStr:null,unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions,createFolders:m.createFolders}),b.dir||(x.file(w).unsafeOriginalName=_)}return g.zipComment.length&&(x.comment=g.zipComment),x})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,n,a){var i=r("../utils"),o=r("../stream/GenericWorker");function c(l,u){o.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(u)}i.inherits(c,o),c.prototype._bindStream=function(l){var u=this;(this._stream=l).pause(),l.on("data",function(d){u.push({data:d,meta:{percent:0}})}).on("error",function(d){u.isPaused?this.generatedError=d:u.error(d)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},c.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},c.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=c},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,n,a){var i=r("readable-stream").Readable;function o(c,l,u){i.call(this,l),this._helper=c;var d=this;c.on("data",function(f,h){d.push(f)||d._helper.pause(),u&&u(h)}).on("error",function(f){d.emit("error",f)}).on("end",function(){d.push(null)})}r("../utils").inherits(o,i),o.prototype._read=function(){this._helper.resume()},n.exports=o},{"../utils":32,"readable-stream":16}],14:[function(r,n,a){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,o);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,o)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var o=new Buffer(i);return o.fill(0),o},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(r,n,a){function i(w,j,N){var D,S=c.getTypeOf(j),T=c.extend(N||{},d);T.date=T.date||new Date,T.compression!==null&&(T.compression=T.compression.toUpperCase()),typeof T.unixPermissions=="string"&&(T.unixPermissions=parseInt(T.unixPermissions,8)),T.unixPermissions&&16384&T.unixPermissions&&(T.dir=!0),T.dosPermissions&&16&T.dosPermissions&&(T.dir=!0),T.dir&&(w=v(w)),T.createFolders&&(D=g(w))&&y.call(this,D,!0);var A=S==="string"&&T.binary===!1&&T.base64===!1;N&&N.binary!==void 0||(T.binary=!A),(j instanceof f&&j.uncompressedSize===0||T.dir||!j||j.length===0)&&(T.base64=!1,T.binary=!0,j="",T.compression="STORE",S="string");var E=null;E=j instanceof f||j instanceof l?j:x.isNode&&x.isStream(j)?new p(w,j):c.prepareContent(w,j,T.binary,T.optimizedBinaryString,T.base64);var M=new h(w,E,T);this.files[w]=M}var o=r("./utf8"),c=r("./utils"),l=r("./stream/GenericWorker"),u=r("./stream/StreamHelper"),d=r("./defaults"),f=r("./compressedObject"),h=r("./zipObject"),m=r("./generate"),x=r("./nodejsUtils"),p=r("./nodejs/NodejsStreamInputAdapter"),g=function(w){w.slice(-1)==="/"&&(w=w.substring(0,w.length-1));var j=w.lastIndexOf("/");return 0<j?w.substring(0,j):""},v=function(w){return w.slice(-1)!=="/"&&(w+="/"),w},y=function(w,j){return j=j!==void 0?j:d.createFolders,w=v(w),this.files[w]||i.call(this,w,null,{dir:!0,createFolders:j}),this.files[w]};function b(w){return Object.prototype.toString.call(w)==="[object RegExp]"}var _={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(w){var j,N,D;for(j in this.files)D=this.files[j],(N=j.slice(this.root.length,j.length))&&j.slice(0,this.root.length)===this.root&&w(N,D)},filter:function(w){var j=[];return this.forEach(function(N,D){w(N,D)&&j.push(D)}),j},file:function(w,j,N){if(arguments.length!==1)return w=this.root+w,i.call(this,w,j,N),this;if(b(w)){var D=w;return this.filter(function(T,A){return!A.dir&&D.test(T)})}var S=this.files[this.root+w];return S&&!S.dir?S:null},folder:function(w){if(!w)return this;if(b(w))return this.filter(function(S,T){return T.dir&&w.test(S)});var j=this.root+w,N=y.call(this,j),D=this.clone();return D.root=N.name,D},remove:function(w){w=this.root+w;var j=this.files[w];if(j||(w.slice(-1)!=="/"&&(w+="/"),j=this.files[w]),j&&!j.dir)delete this.files[w];else for(var N=this.filter(function(S,T){return T.name.slice(0,w.length)===w}),D=0;D<N.length;D++)delete this.files[N[D].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(w){var j,N={};try{if((N=c.extend(w||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=N.type.toLowerCase(),N.compression=N.compression.toUpperCase(),N.type==="binarystring"&&(N.type="string"),!N.type)throw new Error("No output type specified.");c.checkSupport(N.type),N.platform!=="darwin"&&N.platform!=="freebsd"&&N.platform!=="linux"&&N.platform!=="sunos"||(N.platform="UNIX"),N.platform==="win32"&&(N.platform="DOS");var D=N.comment||this.comment||"";j=m.generateWorker(this,N,D)}catch(S){(j=new l("error")).error(S)}return new u(j,N.type||"string",N.mimeType)},generateAsync:function(w,j){return this.generateInternalStream(w).accumulate(j)},generateNodeStream:function(w,j){return(w=w||{}).type||(w.type="nodebuffer"),this.generateInternalStream(w).toNodejsStream(j)}};n.exports=_},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,n,a){n.exports=r("stream")},{stream:void 0}],17:[function(r,n,a){var i=r("./DataReader");function o(c){i.call(this,c);for(var l=0;l<this.data.length;l++)c[l]=255&c[l]}r("../utils").inherits(o,i),o.prototype.byteAt=function(c){return this.data[this.zero+c]},o.prototype.lastIndexOfSignature=function(c){for(var l=c.charCodeAt(0),u=c.charCodeAt(1),d=c.charCodeAt(2),f=c.charCodeAt(3),h=this.length-4;0<=h;--h)if(this.data[h]===l&&this.data[h+1]===u&&this.data[h+2]===d&&this.data[h+3]===f)return h-this.zero;return-1},o.prototype.readAndCheckSignature=function(c){var l=c.charCodeAt(0),u=c.charCodeAt(1),d=c.charCodeAt(2),f=c.charCodeAt(3),h=this.readData(4);return l===h[0]&&u===h[1]&&d===h[2]&&f===h[3]},o.prototype.readData=function(c){if(this.checkOffset(c),c===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,l},n.exports=o},{"../utils":32,"./DataReader":18}],18:[function(r,n,a){var i=r("../utils");function o(c){this.data=c,this.length=c.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(c){this.checkIndex(this.index+c)},checkIndex:function(c){if(this.length<this.zero+c||c<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+c+"). Corrupted zip ?")},setIndex:function(c){this.checkIndex(c),this.index=c},skip:function(c){this.setIndex(this.index+c)},byteAt:function(){},readInt:function(c){var l,u=0;for(this.checkOffset(c),l=this.index+c-1;l>=this.index;l--)u=(u<<8)+this.byteAt(l);return this.index+=c,u},readString:function(c){return i.transformTo("string",this.readData(c))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var c=this.readInt(4);return new Date(Date.UTC(1980+(c>>25&127),(c>>21&15)-1,c>>16&31,c>>11&31,c>>5&63,(31&c)<<1))}},n.exports=o},{"../utils":32}],19:[function(r,n,a){var i=r("./Uint8ArrayReader");function o(c){i.call(this,c)}r("../utils").inherits(o,i),o.prototype.readData=function(c){this.checkOffset(c);var l=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,l},n.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,n,a){var i=r("./DataReader");function o(c){i.call(this,c)}r("../utils").inherits(o,i),o.prototype.byteAt=function(c){return this.data.charCodeAt(this.zero+c)},o.prototype.lastIndexOfSignature=function(c){return this.data.lastIndexOf(c)-this.zero},o.prototype.readAndCheckSignature=function(c){return c===this.readData(4)},o.prototype.readData=function(c){this.checkOffset(c);var l=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,l},n.exports=o},{"../utils":32,"./DataReader":18}],21:[function(r,n,a){var i=r("./ArrayReader");function o(c){i.call(this,c)}r("../utils").inherits(o,i),o.prototype.readData=function(c){if(this.checkOffset(c),c===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+c);return this.index+=c,l},n.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(r,n,a){var i=r("../utils"),o=r("../support"),c=r("./ArrayReader"),l=r("./StringReader"),u=r("./NodeBufferReader"),d=r("./Uint8ArrayReader");n.exports=function(f){var h=i.getTypeOf(f);return i.checkSupport(h),h!=="string"||o.uint8array?h==="nodebuffer"?new u(f):o.uint8array?new d(i.transformTo("uint8array",f)):new c(i.transformTo("array",f)):new l(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,n,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,n,a){var i=r("./GenericWorker"),o=r("../utils");function c(l){i.call(this,"ConvertWorker to "+l),this.destType=l}o.inherits(c,i),c.prototype.processChunk=function(l){this.push({data:o.transformTo(this.destType,l.data),meta:l.meta})},n.exports=c},{"../utils":32,"./GenericWorker":28}],25:[function(r,n,a){var i=r("./GenericWorker"),o=r("../crc32");function c(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(c,i),c.prototype.processChunk=function(l){this.streamInfo.crc32=o(l.data,this.streamInfo.crc32||0),this.push(l)},n.exports=c},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,n,a){var i=r("../utils"),o=r("./GenericWorker");function c(l){o.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}i.inherits(c,o),c.prototype.processChunk=function(l){if(l){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+l.data.length}o.prototype.processChunk.call(this,l)},n.exports=c},{"../utils":32,"./GenericWorker":28}],27:[function(r,n,a){var i=r("../utils"),o=r("./GenericWorker");function c(l){o.call(this,"DataWorker");var u=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(d){u.dataIsReady=!0,u.data=d,u.max=d&&d.length||0,u.type=i.getTypeOf(d),u.isPaused||u._tickAndRepeat()},function(d){u.error(d)})}i.inherits(c,o),c.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},c.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},c.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},c.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,u=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,u);break;case"uint8array":l=this.data.subarray(this.index,u);break;case"array":case"nodebuffer":l=this.data.slice(this.index,u)}return this.index=u,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=c},{"../utils":32,"./GenericWorker":28}],28:[function(r,n,a){function i(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,c){return this._listeners[o].push(c),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,c){if(this._listeners[o])for(var l=0;l<this._listeners[o].length;l++)this._listeners[o][l].call(this,c)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var c=this;return o.on("data",function(l){c.processChunk(l)}),o.on("end",function(){c.end()}),o.on("error",function(l){c.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,c){return this.extraStreamInfo[o]=c,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},n.exports=i},{}],29:[function(r,n,a){var i=r("../utils"),o=r("./ConvertWorker"),c=r("./GenericWorker"),l=r("../base64"),u=r("../support"),d=r("../external"),f=null;if(u.nodestream)try{f=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(x,p){return new d.Promise(function(g,v){var y=[],b=x._internalType,_=x._outputType,w=x._mimeType;x.on("data",function(j,N){y.push(j),p&&p(N)}).on("error",function(j){y=[],v(j)}).on("end",function(){try{var j=function(N,D,S){switch(N){case"blob":return i.newBlob(i.transformTo("arraybuffer",D),S);case"base64":return l.encode(D);default:return i.transformTo(N,D)}}(_,function(N,D){var S,T=0,A=null,E=0;for(S=0;S<D.length;S++)E+=D[S].length;switch(N){case"string":return D.join("");case"array":return Array.prototype.concat.apply([],D);case"uint8array":for(A=new Uint8Array(E),S=0;S<D.length;S++)A.set(D[S],T),T+=D[S].length;return A;case"nodebuffer":return Buffer.concat(D);default:throw new Error("concat : unsupported type '"+N+"'")}}(b,y),w);g(j)}catch(N){v(N)}y=[]}).resume()})}function m(x,p,g){var v=p;switch(p){case"blob":case"arraybuffer":v="uint8array";break;case"base64":v="string"}try{this._internalType=v,this._outputType=p,this._mimeType=g,i.checkSupport(v),this._worker=x.pipe(new o(v)),x.lock()}catch(y){this._worker=new c("error"),this._worker.error(y)}}m.prototype={accumulate:function(x){return h(this,x)},on:function(x,p){var g=this;return x==="data"?this._worker.on(x,function(v){p.call(g,v.data,v.meta)}):this._worker.on(x,function(){i.delay(p,arguments,g)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(x){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},x)}},n.exports=m},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,n,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",a.nodebuffer=typeof Buffer<"u",a.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")a.blob=!1;else{var i=new ArrayBuffer(0);try{a.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(i),a.blob=o.getBlob("application/zip").size===0}catch{a.blob=!1}}}try{a.nodestream=!!r("readable-stream").Readable}catch{a.nodestream=!1}},{"readable-stream":16}],31:[function(r,n,a){for(var i=r("./utils"),o=r("./support"),c=r("./nodejsUtils"),l=r("./stream/GenericWorker"),u=new Array(256),d=0;d<256;d++)u[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;u[254]=u[254]=1;function f(){l.call(this,"utf-8 decode"),this.leftOver=null}function h(){l.call(this,"utf-8 encode")}a.utf8encode=function(m){return o.nodebuffer?c.newBufferFrom(m,"utf-8"):function(x){var p,g,v,y,b,_=x.length,w=0;for(y=0;y<_;y++)(64512&(g=x.charCodeAt(y)))==55296&&y+1<_&&(64512&(v=x.charCodeAt(y+1)))==56320&&(g=65536+(g-55296<<10)+(v-56320),y++),w+=g<128?1:g<2048?2:g<65536?3:4;for(p=o.uint8array?new Uint8Array(w):new Array(w),y=b=0;b<w;y++)(64512&(g=x.charCodeAt(y)))==55296&&y+1<_&&(64512&(v=x.charCodeAt(y+1)))==56320&&(g=65536+(g-55296<<10)+(v-56320),y++),g<128?p[b++]=g:(g<2048?p[b++]=192|g>>>6:(g<65536?p[b++]=224|g>>>12:(p[b++]=240|g>>>18,p[b++]=128|g>>>12&63),p[b++]=128|g>>>6&63),p[b++]=128|63&g);return p}(m)},a.utf8decode=function(m){return o.nodebuffer?i.transformTo("nodebuffer",m).toString("utf-8"):function(x){var p,g,v,y,b=x.length,_=new Array(2*b);for(p=g=0;p<b;)if((v=x[p++])<128)_[g++]=v;else if(4<(y=u[v]))_[g++]=65533,p+=y-1;else{for(v&=y===2?31:y===3?15:7;1<y&&p<b;)v=v<<6|63&x[p++],y--;1<y?_[g++]=65533:v<65536?_[g++]=v:(v-=65536,_[g++]=55296|v>>10&1023,_[g++]=56320|1023&v)}return _.length!==g&&(_.subarray?_=_.subarray(0,g):_.length=g),i.applyFromCharCode(_)}(m=i.transformTo(o.uint8array?"uint8array":"array",m))},i.inherits(f,l),f.prototype.processChunk=function(m){var x=i.transformTo(o.uint8array?"uint8array":"array",m.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var p=x;(x=new Uint8Array(p.length+this.leftOver.length)).set(this.leftOver,0),x.set(p,this.leftOver.length)}else x=this.leftOver.concat(x);this.leftOver=null}var g=function(y,b){var _;for((b=b||y.length)>y.length&&(b=y.length),_=b-1;0<=_&&(192&y[_])==128;)_--;return _<0||_===0?b:_+u[y[_]]>b?_:b}(x),v=x;g!==x.length&&(o.uint8array?(v=x.subarray(0,g),this.leftOver=x.subarray(g,x.length)):(v=x.slice(0,g),this.leftOver=x.slice(g,x.length))),this.push({data:a.utf8decode(v),meta:m.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=f,i.inherits(h,l),h.prototype.processChunk=function(m){this.push({data:a.utf8encode(m.data),meta:m.meta})},a.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,n,a){var i=r("./support"),o=r("./base64"),c=r("./nodejsUtils"),l=r("./external");function u(p){return p}function d(p,g){for(var v=0;v<p.length;++v)g[v]=255&p.charCodeAt(v);return g}r("setimmediate"),a.newBlob=function(p,g){a.checkSupport("blob");try{return new Blob([p],{type:g})}catch{try{var v=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return v.append(p),v.getBlob(g)}catch{throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(p,g,v){var y=[],b=0,_=p.length;if(_<=v)return String.fromCharCode.apply(null,p);for(;b<_;)g==="array"||g==="nodebuffer"?y.push(String.fromCharCode.apply(null,p.slice(b,Math.min(b+v,_)))):y.push(String.fromCharCode.apply(null,p.subarray(b,Math.min(b+v,_)))),b+=v;return y.join("")},stringifyByChar:function(p){for(var g="",v=0;v<p.length;v++)g+=String.fromCharCode(p[v]);return g},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,c.allocBuffer(1)).length===1}catch{return!1}}()}};function h(p){var g=65536,v=a.getTypeOf(p),y=!0;if(v==="uint8array"?y=f.applyCanBeUsed.uint8array:v==="nodebuffer"&&(y=f.applyCanBeUsed.nodebuffer),y)for(;1<g;)try{return f.stringifyByChunk(p,v,g)}catch{g=Math.floor(g/2)}return f.stringifyByChar(p)}function m(p,g){for(var v=0;v<p.length;v++)g[v]=p[v];return g}a.applyFromCharCode=h;var x={};x.string={string:u,array:function(p){return d(p,new Array(p.length))},arraybuffer:function(p){return x.string.uint8array(p).buffer},uint8array:function(p){return d(p,new Uint8Array(p.length))},nodebuffer:function(p){return d(p,c.allocBuffer(p.length))}},x.array={string:h,array:u,arraybuffer:function(p){return new Uint8Array(p).buffer},uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return c.newBufferFrom(p)}},x.arraybuffer={string:function(p){return h(new Uint8Array(p))},array:function(p){return m(new Uint8Array(p),new Array(p.byteLength))},arraybuffer:u,uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return c.newBufferFrom(new Uint8Array(p))}},x.uint8array={string:h,array:function(p){return m(p,new Array(p.length))},arraybuffer:function(p){return p.buffer},uint8array:u,nodebuffer:function(p){return c.newBufferFrom(p)}},x.nodebuffer={string:h,array:function(p){return m(p,new Array(p.length))},arraybuffer:function(p){return x.nodebuffer.uint8array(p).buffer},uint8array:function(p){return m(p,new Uint8Array(p.length))},nodebuffer:u},a.transformTo=function(p,g){if(g=g||"",!p)return g;a.checkSupport(p);var v=a.getTypeOf(g);return x[v][p](g)},a.resolve=function(p){for(var g=p.split("/"),v=[],y=0;y<g.length;y++){var b=g[y];b==="."||b===""&&y!==0&&y!==g.length-1||(b===".."?v.pop():v.push(b))}return v.join("/")},a.getTypeOf=function(p){return typeof p=="string"?"string":Object.prototype.toString.call(p)==="[object Array]"?"array":i.nodebuffer&&c.isBuffer(p)?"nodebuffer":i.uint8array&&p instanceof Uint8Array?"uint8array":i.arraybuffer&&p instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(p){if(!i[p.toLowerCase()])throw new Error(p+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(p){var g,v,y="";for(v=0;v<(p||"").length;v++)y+="\\x"+((g=p.charCodeAt(v))<16?"0":"")+g.toString(16).toUpperCase();return y},a.delay=function(p,g,v){setImmediate(function(){p.apply(v||null,g||[])})},a.inherits=function(p,g){function v(){}v.prototype=g.prototype,p.prototype=new v},a.extend=function(){var p,g,v={};for(p=0;p<arguments.length;p++)for(g in arguments[p])Object.prototype.hasOwnProperty.call(arguments[p],g)&&v[g]===void 0&&(v[g]=arguments[p][g]);return v},a.prepareContent=function(p,g,v,y,b){return l.Promise.resolve(g).then(function(_){return i.blob&&(_ instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(_))!==-1)&&typeof FileReader<"u"?new l.Promise(function(w,j){var N=new FileReader;N.onload=function(D){w(D.target.result)},N.onerror=function(D){j(D.target.error)},N.readAsArrayBuffer(_)}):_}).then(function(_){var w=a.getTypeOf(_);return w?(w==="arraybuffer"?_=a.transformTo("uint8array",_):w==="string"&&(b?_=o.decode(_):v&&y!==!0&&(_=function(j){return d(j,i.uint8array?new Uint8Array(j.length):new Array(j.length))}(_))),_):l.Promise.reject(new Error("Can't read the data of '"+p+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,n,a){var i=r("./reader/readerFor"),o=r("./utils"),c=r("./signature"),l=r("./zipEntry"),u=r("./support");function d(f){this.files=[],this.loadOptions=f}d.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(h)+", expected "+o.pretty(f)+")")}},isSignature:function(f,h){var m=this.reader.index;this.reader.setIndex(f);var x=this.reader.readString(4)===h;return this.reader.setIndex(m),x},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),h=u.uint8array?"uint8array":"array",m=o.transformTo(h,f);this.zipComment=this.loadOptions.decodeFileName(m)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,h,m,x=this.zip64EndOfCentralSize-44;0<x;)f=this.reader.readInt(2),h=this.reader.readInt(4),m=this.reader.readData(h),this.zip64ExtensibleData[f]={id:f,length:h,value:m}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,h;for(f=0;f<this.files.length;f++)h=this.files[f],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(c.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(c.CENTRAL_FILE_HEADER);)(f=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(c.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,c.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var h=f;if(this.checkSignature(c.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(c.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(c.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,c.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(c.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(c.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var m=this.centralDirOffset+this.centralDirSize;this.zip64&&(m+=20,m+=12+this.zip64EndOfCentralSize);var x=h-m;if(0<x)this.isSignature(h,c.CENTRAL_FILE_HEADER)||(this.reader.zero=x);else if(x<0)throw new Error("Corrupted zip: missing "+Math.abs(x)+" bytes.")},prepareReader:function(f){this.reader=i(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=d},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,n,a){var i=r("./reader/readerFor"),o=r("./utils"),c=r("./compressedObject"),l=r("./crc32"),u=r("./utf8"),d=r("./compressions"),f=r("./support");function h(m,x){this.options=m,this.loadOptions=x}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(m){var x,p;if(m.skip(22),this.fileNameLength=m.readInt(2),p=m.readInt(2),this.fileName=m.readData(this.fileNameLength),m.skip(p),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((x=function(g){for(var v in d)if(Object.prototype.hasOwnProperty.call(d,v)&&d[v].magic===g)return d[v];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new c(this.compressedSize,this.uncompressedSize,this.crc32,x,m.readData(this.compressedSize))},readCentralPart:function(m){this.versionMadeBy=m.readInt(2),m.skip(2),this.bitFlag=m.readInt(2),this.compressionMethod=m.readString(2),this.date=m.readDate(),this.crc32=m.readInt(4),this.compressedSize=m.readInt(4),this.uncompressedSize=m.readInt(4);var x=m.readInt(2);if(this.extraFieldsLength=m.readInt(2),this.fileCommentLength=m.readInt(2),this.diskNumberStart=m.readInt(2),this.internalFileAttributes=m.readInt(2),this.externalFileAttributes=m.readInt(4),this.localHeaderOffset=m.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");m.skip(x),this.readExtraFields(m),this.parseZIP64ExtraField(m),this.fileComment=m.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var m=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),m==0&&(this.dosPermissions=63&this.externalFileAttributes),m==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var m=i(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=m.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=m.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=m.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=m.readInt(4))}},readExtraFields:function(m){var x,p,g,v=m.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});m.index+4<v;)x=m.readInt(2),p=m.readInt(2),g=m.readData(p),this.extraFields[x]={id:x,length:p,value:g};m.setIndex(v)},handleUTF8:function(){var m=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var x=this.findExtraFieldUnicodePath();if(x!==null)this.fileNameStr=x;else{var p=o.transformTo(m,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(p)}var g=this.findExtraFieldUnicodeComment();if(g!==null)this.fileCommentStr=g;else{var v=o.transformTo(m,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(v)}}},findExtraFieldUnicodePath:function(){var m=this.extraFields[28789];if(m){var x=i(m.value);return x.readInt(1)!==1||l(this.fileName)!==x.readInt(4)?null:u.utf8decode(x.readData(m.length-5))}return null},findExtraFieldUnicodeComment:function(){var m=this.extraFields[25461];if(m){var x=i(m.value);return x.readInt(1)!==1||l(this.fileComment)!==x.readInt(4)?null:u.utf8decode(x.readData(m.length-5))}return null}},n.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,n,a){function i(x,p,g){this.name=x,this.dir=g.dir,this.date=g.date,this.comment=g.comment,this.unixPermissions=g.unixPermissions,this.dosPermissions=g.dosPermissions,this._data=p,this._dataBinary=g.binary,this.options={compression:g.compression,compressionOptions:g.compressionOptions}}var o=r("./stream/StreamHelper"),c=r("./stream/DataWorker"),l=r("./utf8"),u=r("./compressedObject"),d=r("./stream/GenericWorker");i.prototype={internalStream:function(x){var p=null,g="string";try{if(!x)throw new Error("No output type specified.");var v=(g=x.toLowerCase())==="string"||g==="text";g!=="binarystring"&&g!=="text"||(g="string"),p=this._decompressWorker();var y=!this._dataBinary;y&&!v&&(p=p.pipe(new l.Utf8EncodeWorker)),!y&&v&&(p=p.pipe(new l.Utf8DecodeWorker))}catch(b){(p=new d("error")).error(b)}return new o(p,g,"")},async:function(x,p){return this.internalStream(x).accumulate(p)},nodeStream:function(x,p){return this.internalStream(x||"nodebuffer").toNodejsStream(p)},_compressWorker:function(x,p){if(this._data instanceof u&&this._data.compression.magic===x.magic)return this._data.getCompressedWorker();var g=this._decompressWorker();return this._dataBinary||(g=g.pipe(new l.Utf8EncodeWorker)),u.createWorkerFrom(g,x,p)},_decompressWorker:function(){return this._data instanceof u?this._data.getContentWorker():this._data instanceof d?this._data:new c(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},m=0;m<f.length;m++)i.prototype[f[m]]=h;n.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,n,a){(function(i){var o,c,l=i.MutationObserver||i.WebKitMutationObserver;if(l){var u=0,d=new l(x),f=i.document.createTextNode("");d.observe(f,{characterData:!0}),o=function(){f.data=u=++u%2}}else if(i.setImmediate||i.MessageChannel===void 0)o="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var p=i.document.createElement("script");p.onreadystatechange=function(){x(),p.onreadystatechange=null,p.parentNode.removeChild(p),p=null},i.document.documentElement.appendChild(p)}:function(){setTimeout(x,0)};else{var h=new i.MessageChannel;h.port1.onmessage=x,o=function(){h.port2.postMessage(0)}}var m=[];function x(){var p,g;c=!0;for(var v=m.length;v;){for(g=m,m=[],p=-1;++p<v;)g[p]();v=m.length}c=!1}n.exports=function(p){m.push(p)!==1||c||o()}}).call(this,typeof gt<"u"?gt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,n,a){var i=r("immediate");function o(){}var c={},l=["REJECTED"],u=["FULFILLED"],d=["PENDING"];function f(v){if(typeof v!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,v!==o&&p(this,v)}function h(v,y,b){this.promise=v,typeof y=="function"&&(this.onFulfilled=y,this.callFulfilled=this.otherCallFulfilled),typeof b=="function"&&(this.onRejected=b,this.callRejected=this.otherCallRejected)}function m(v,y,b){i(function(){var _;try{_=y(b)}catch(w){return c.reject(v,w)}_===v?c.reject(v,new TypeError("Cannot resolve promise with itself")):c.resolve(v,_)})}function x(v){var y=v&&v.then;if(v&&(typeof v=="object"||typeof v=="function")&&typeof y=="function")return function(){y.apply(v,arguments)}}function p(v,y){var b=!1;function _(N){b||(b=!0,c.reject(v,N))}function w(N){b||(b=!0,c.resolve(v,N))}var j=g(function(){y(w,_)});j.status==="error"&&_(j.value)}function g(v,y){var b={};try{b.value=v(y),b.status="success"}catch(_){b.status="error",b.value=_}return b}(n.exports=f).prototype.finally=function(v){if(typeof v!="function")return this;var y=this.constructor;return this.then(function(b){return y.resolve(v()).then(function(){return b})},function(b){return y.resolve(v()).then(function(){throw b})})},f.prototype.catch=function(v){return this.then(null,v)},f.prototype.then=function(v,y){if(typeof v!="function"&&this.state===u||typeof y!="function"&&this.state===l)return this;var b=new this.constructor(o);return this.state!==d?m(b,this.state===u?v:y,this.outcome):this.queue.push(new h(b,v,y)),b},h.prototype.callFulfilled=function(v){c.resolve(this.promise,v)},h.prototype.otherCallFulfilled=function(v){m(this.promise,this.onFulfilled,v)},h.prototype.callRejected=function(v){c.reject(this.promise,v)},h.prototype.otherCallRejected=function(v){m(this.promise,this.onRejected,v)},c.resolve=function(v,y){var b=g(x,y);if(b.status==="error")return c.reject(v,b.value);var _=b.value;if(_)p(v,_);else{v.state=u,v.outcome=y;for(var w=-1,j=v.queue.length;++w<j;)v.queue[w].callFulfilled(y)}return v},c.reject=function(v,y){v.state=l,v.outcome=y;for(var b=-1,_=v.queue.length;++b<_;)v.queue[b].callRejected(y);return v},f.resolve=function(v){return v instanceof this?v:c.resolve(new this(o),v)},f.reject=function(v){var y=new this(o);return c.reject(y,v)},f.all=function(v){var y=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=v.length,_=!1;if(!b)return this.resolve([]);for(var w=new Array(b),j=0,N=-1,D=new this(o);++N<b;)S(v[N],N);return D;function S(T,A){y.resolve(T).then(function(E){w[A]=E,++j!==b||_||(_=!0,c.resolve(D,w))},function(E){_||(_=!0,c.reject(D,E))})}},f.race=function(v){var y=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=v.length,_=!1;if(!b)return this.resolve([]);for(var w=-1,j=new this(o);++w<b;)N=v[w],y.resolve(N).then(function(D){_||(_=!0,c.resolve(j,D))},function(D){_||(_=!0,c.reject(j,D))});var N;return j}},{immediate:36}],38:[function(r,n,a){var i={};(0,r("./lib/utils/common").assign)(i,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),n.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,n,a){var i=r("./zlib/deflate"),o=r("./utils/common"),c=r("./utils/strings"),l=r("./zlib/messages"),u=r("./zlib/zstream"),d=Object.prototype.toString,f=0,h=-1,m=0,x=8;function p(v){if(!(this instanceof p))return new p(v);this.options=o.assign({level:h,method:x,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},v||{});var y=this.options;y.raw&&0<y.windowBits?y.windowBits=-y.windowBits:y.gzip&&0<y.windowBits&&y.windowBits<16&&(y.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var b=i.deflateInit2(this.strm,y.level,y.method,y.windowBits,y.memLevel,y.strategy);if(b!==f)throw new Error(l[b]);if(y.header&&i.deflateSetHeader(this.strm,y.header),y.dictionary){var _;if(_=typeof y.dictionary=="string"?c.string2buf(y.dictionary):d.call(y.dictionary)==="[object ArrayBuffer]"?new Uint8Array(y.dictionary):y.dictionary,(b=i.deflateSetDictionary(this.strm,_))!==f)throw new Error(l[b]);this._dict_set=!0}}function g(v,y){var b=new p(y);if(b.push(v,!0),b.err)throw b.msg||l[b.err];return b.result}p.prototype.push=function(v,y){var b,_,w=this.strm,j=this.options.chunkSize;if(this.ended)return!1;_=y===~~y?y:y===!0?4:0,typeof v=="string"?w.input=c.string2buf(v):d.call(v)==="[object ArrayBuffer]"?w.input=new Uint8Array(v):w.input=v,w.next_in=0,w.avail_in=w.input.length;do{if(w.avail_out===0&&(w.output=new o.Buf8(j),w.next_out=0,w.avail_out=j),(b=i.deflate(w,_))!==1&&b!==f)return this.onEnd(b),!(this.ended=!0);w.avail_out!==0&&(w.avail_in!==0||_!==4&&_!==2)||(this.options.to==="string"?this.onData(c.buf2binstring(o.shrinkBuf(w.output,w.next_out))):this.onData(o.shrinkBuf(w.output,w.next_out)))}while((0<w.avail_in||w.avail_out===0)&&b!==1);return _===4?(b=i.deflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===f):_!==2||(this.onEnd(f),!(w.avail_out=0))},p.prototype.onData=function(v){this.chunks.push(v)},p.prototype.onEnd=function(v){v===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},a.Deflate=p,a.deflate=g,a.deflateRaw=function(v,y){return(y=y||{}).raw=!0,g(v,y)},a.gzip=function(v,y){return(y=y||{}).gzip=!0,g(v,y)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,n,a){var i=r("./zlib/inflate"),o=r("./utils/common"),c=r("./utils/strings"),l=r("./zlib/constants"),u=r("./zlib/messages"),d=r("./zlib/zstream"),f=r("./zlib/gzheader"),h=Object.prototype.toString;function m(p){if(!(this instanceof m))return new m(p);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},p||{});var g=this.options;g.raw&&0<=g.windowBits&&g.windowBits<16&&(g.windowBits=-g.windowBits,g.windowBits===0&&(g.windowBits=-15)),!(0<=g.windowBits&&g.windowBits<16)||p&&p.windowBits||(g.windowBits+=32),15<g.windowBits&&g.windowBits<48&&!(15&g.windowBits)&&(g.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var v=i.inflateInit2(this.strm,g.windowBits);if(v!==l.Z_OK)throw new Error(u[v]);this.header=new f,i.inflateGetHeader(this.strm,this.header)}function x(p,g){var v=new m(g);if(v.push(p,!0),v.err)throw v.msg||u[v.err];return v.result}m.prototype.push=function(p,g){var v,y,b,_,w,j,N=this.strm,D=this.options.chunkSize,S=this.options.dictionary,T=!1;if(this.ended)return!1;y=g===~~g?g:g===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof p=="string"?N.input=c.binstring2buf(p):h.call(p)==="[object ArrayBuffer]"?N.input=new Uint8Array(p):N.input=p,N.next_in=0,N.avail_in=N.input.length;do{if(N.avail_out===0&&(N.output=new o.Buf8(D),N.next_out=0,N.avail_out=D),(v=i.inflate(N,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&S&&(j=typeof S=="string"?c.string2buf(S):h.call(S)==="[object ArrayBuffer]"?new Uint8Array(S):S,v=i.inflateSetDictionary(this.strm,j)),v===l.Z_BUF_ERROR&&T===!0&&(v=l.Z_OK,T=!1),v!==l.Z_STREAM_END&&v!==l.Z_OK)return this.onEnd(v),!(this.ended=!0);N.next_out&&(N.avail_out!==0&&v!==l.Z_STREAM_END&&(N.avail_in!==0||y!==l.Z_FINISH&&y!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(b=c.utf8border(N.output,N.next_out),_=N.next_out-b,w=c.buf2string(N.output,b),N.next_out=_,N.avail_out=D-_,_&&o.arraySet(N.output,N.output,b,_,0),this.onData(w)):this.onData(o.shrinkBuf(N.output,N.next_out)))),N.avail_in===0&&N.avail_out===0&&(T=!0)}while((0<N.avail_in||N.avail_out===0)&&v!==l.Z_STREAM_END);return v===l.Z_STREAM_END&&(y=l.Z_FINISH),y===l.Z_FINISH?(v=i.inflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===l.Z_OK):y!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(N.avail_out=0))},m.prototype.onData=function(p){this.chunks.push(p)},m.prototype.onEnd=function(p){p===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg},a.Inflate=m,a.inflate=x,a.inflateRaw=function(p,g){return(g=g||{}).raw=!0,x(p,g)},a.ungzip=x},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,n,a){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";a.assign=function(l){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var d=u.shift();if(d){if(typeof d!="object")throw new TypeError(d+"must be non-object");for(var f in d)d.hasOwnProperty(f)&&(l[f]=d[f])}}return l},a.shrinkBuf=function(l,u){return l.length===u?l:l.subarray?l.subarray(0,u):(l.length=u,l)};var o={arraySet:function(l,u,d,f,h){if(u.subarray&&l.subarray)l.set(u.subarray(d,d+f),h);else for(var m=0;m<f;m++)l[h+m]=u[d+m]},flattenChunks:function(l){var u,d,f,h,m,x;for(u=f=0,d=l.length;u<d;u++)f+=l[u].length;for(x=new Uint8Array(f),u=h=0,d=l.length;u<d;u++)m=l[u],x.set(m,h),h+=m.length;return x}},c={arraySet:function(l,u,d,f,h){for(var m=0;m<f;m++)l[h+m]=u[d+m]},flattenChunks:function(l){return[].concat.apply([],l)}};a.setTyped=function(l){l?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,o)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,c))},a.setTyped(i)},{}],42:[function(r,n,a){var i=r("./common"),o=!0,c=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{c=!1}for(var l=new i.Buf8(256),u=0;u<256;u++)l[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;function d(f,h){if(h<65537&&(f.subarray&&c||!f.subarray&&o))return String.fromCharCode.apply(null,i.shrinkBuf(f,h));for(var m="",x=0;x<h;x++)m+=String.fromCharCode(f[x]);return m}l[254]=l[254]=1,a.string2buf=function(f){var h,m,x,p,g,v=f.length,y=0;for(p=0;p<v;p++)(64512&(m=f.charCodeAt(p)))==55296&&p+1<v&&(64512&(x=f.charCodeAt(p+1)))==56320&&(m=65536+(m-55296<<10)+(x-56320),p++),y+=m<128?1:m<2048?2:m<65536?3:4;for(h=new i.Buf8(y),p=g=0;g<y;p++)(64512&(m=f.charCodeAt(p)))==55296&&p+1<v&&(64512&(x=f.charCodeAt(p+1)))==56320&&(m=65536+(m-55296<<10)+(x-56320),p++),m<128?h[g++]=m:(m<2048?h[g++]=192|m>>>6:(m<65536?h[g++]=224|m>>>12:(h[g++]=240|m>>>18,h[g++]=128|m>>>12&63),h[g++]=128|m>>>6&63),h[g++]=128|63&m);return h},a.buf2binstring=function(f){return d(f,f.length)},a.binstring2buf=function(f){for(var h=new i.Buf8(f.length),m=0,x=h.length;m<x;m++)h[m]=f.charCodeAt(m);return h},a.buf2string=function(f,h){var m,x,p,g,v=h||f.length,y=new Array(2*v);for(m=x=0;m<v;)if((p=f[m++])<128)y[x++]=p;else if(4<(g=l[p]))y[x++]=65533,m+=g-1;else{for(p&=g===2?31:g===3?15:7;1<g&&m<v;)p=p<<6|63&f[m++],g--;1<g?y[x++]=65533:p<65536?y[x++]=p:(p-=65536,y[x++]=55296|p>>10&1023,y[x++]=56320|1023&p)}return d(y,x)},a.utf8border=function(f,h){var m;for((h=h||f.length)>f.length&&(h=f.length),m=h-1;0<=m&&(192&f[m])==128;)m--;return m<0||m===0?h:m+l[f[m]]>h?m:h}},{"./common":41}],43:[function(r,n,a){n.exports=function(i,o,c,l){for(var u=65535&i|0,d=i>>>16&65535|0,f=0;c!==0;){for(c-=f=2e3<c?2e3:c;d=d+(u=u+o[l++]|0)|0,--f;);u%=65521,d%=65521}return u|d<<16|0}},{}],44:[function(r,n,a){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,n,a){var i=function(){for(var o,c=[],l=0;l<256;l++){o=l;for(var u=0;u<8;u++)o=1&o?3988292384^o>>>1:o>>>1;c[l]=o}return c}();n.exports=function(o,c,l,u){var d=i,f=u+l;o^=-1;for(var h=u;h<f;h++)o=o>>>8^d[255&(o^c[h])];return-1^o}},{}],46:[function(r,n,a){var i,o=r("../utils/common"),c=r("./trees"),l=r("./adler32"),u=r("./crc32"),d=r("./messages"),f=0,h=4,m=0,x=-2,p=-1,g=4,v=2,y=8,b=9,_=286,w=30,j=19,N=2*_+1,D=15,S=3,T=258,A=T+S+1,E=42,M=113,P=1,X=2,q=3,B=4;function O(U,se){return U.msg=d[se],se}function F(U){return(U<<1)-(4<U?9:0)}function I(U){for(var se=U.length;0<=--se;)U[se]=0}function L(U){var se=U.state,te=se.pending;te>U.avail_out&&(te=U.avail_out),te!==0&&(o.arraySet(U.output,se.pending_buf,se.pending_out,te,U.next_out),U.next_out+=te,se.pending_out+=te,U.total_out+=te,U.avail_out-=te,se.pending-=te,se.pending===0&&(se.pending_out=0))}function C(U,se){c._tr_flush_block(U,0<=U.block_start?U.block_start:-1,U.strstart-U.block_start,se),U.block_start=U.strstart,L(U.strm)}function k(U,se){U.pending_buf[U.pending++]=se}function z(U,se){U.pending_buf[U.pending++]=se>>>8&255,U.pending_buf[U.pending++]=255&se}function V(U,se){var te,K,H=U.max_chain_length,oe=U.strstart,J=U.prev_length,le=U.nice_match,he=U.strstart>U.w_size-A?U.strstart-(U.w_size-A):0,ee=U.window,ae=U.w_mask,xe=U.prev,ye=U.strstart+T,Ce=ee[oe+J-1],Ie=ee[oe+J];U.prev_length>=U.good_match&&(H>>=2),le>U.lookahead&&(le=U.lookahead);do if(ee[(te=se)+J]===Ie&&ee[te+J-1]===Ce&&ee[te]===ee[oe]&&ee[++te]===ee[oe+1]){oe+=2,te++;do;while(ee[++oe]===ee[++te]&&ee[++oe]===ee[++te]&&ee[++oe]===ee[++te]&&ee[++oe]===ee[++te]&&ee[++oe]===ee[++te]&&ee[++oe]===ee[++te]&&ee[++oe]===ee[++te]&&ee[++oe]===ee[++te]&&oe<ye);if(K=T-(ye-oe),oe=ye-T,J<K){if(U.match_start=se,le<=(J=K))break;Ce=ee[oe+J-1],Ie=ee[oe+J]}}while((se=xe[se&ae])>he&&--H!=0);return J<=U.lookahead?J:U.lookahead}function Z(U){var se,te,K,H,oe,J,le,he,ee,ae,xe=U.w_size;do{if(H=U.window_size-U.lookahead-U.strstart,U.strstart>=xe+(xe-A)){for(o.arraySet(U.window,U.window,xe,xe,0),U.match_start-=xe,U.strstart-=xe,U.block_start-=xe,se=te=U.hash_size;K=U.head[--se],U.head[se]=xe<=K?K-xe:0,--te;);for(se=te=xe;K=U.prev[--se],U.prev[se]=xe<=K?K-xe:0,--te;);H+=xe}if(U.strm.avail_in===0)break;if(J=U.strm,le=U.window,he=U.strstart+U.lookahead,ee=H,ae=void 0,ae=J.avail_in,ee<ae&&(ae=ee),te=ae===0?0:(J.avail_in-=ae,o.arraySet(le,J.input,J.next_in,ae,he),J.state.wrap===1?J.adler=l(J.adler,le,ae,he):J.state.wrap===2&&(J.adler=u(J.adler,le,ae,he)),J.next_in+=ae,J.total_in+=ae,ae),U.lookahead+=te,U.lookahead+U.insert>=S)for(oe=U.strstart-U.insert,U.ins_h=U.window[oe],U.ins_h=(U.ins_h<<U.hash_shift^U.window[oe+1])&U.hash_mask;U.insert&&(U.ins_h=(U.ins_h<<U.hash_shift^U.window[oe+S-1])&U.hash_mask,U.prev[oe&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=oe,oe++,U.insert--,!(U.lookahead+U.insert<S)););}while(U.lookahead<A&&U.strm.avail_in!==0)}function ce(U,se){for(var te,K;;){if(U.lookahead<A){if(Z(U),U.lookahead<A&&se===f)return P;if(U.lookahead===0)break}if(te=0,U.lookahead>=S&&(U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+S-1])&U.hash_mask,te=U.prev[U.strstart&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=U.strstart),te!==0&&U.strstart-te<=U.w_size-A&&(U.match_length=V(U,te)),U.match_length>=S)if(K=c._tr_tally(U,U.strstart-U.match_start,U.match_length-S),U.lookahead-=U.match_length,U.match_length<=U.max_lazy_match&&U.lookahead>=S){for(U.match_length--;U.strstart++,U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+S-1])&U.hash_mask,te=U.prev[U.strstart&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=U.strstart,--U.match_length!=0;);U.strstart++}else U.strstart+=U.match_length,U.match_length=0,U.ins_h=U.window[U.strstart],U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+1])&U.hash_mask;else K=c._tr_tally(U,0,U.window[U.strstart]),U.lookahead--,U.strstart++;if(K&&(C(U,!1),U.strm.avail_out===0))return P}return U.insert=U.strstart<S-1?U.strstart:S-1,se===h?(C(U,!0),U.strm.avail_out===0?q:B):U.last_lit&&(C(U,!1),U.strm.avail_out===0)?P:X}function ie(U,se){for(var te,K,H;;){if(U.lookahead<A){if(Z(U),U.lookahead<A&&se===f)return P;if(U.lookahead===0)break}if(te=0,U.lookahead>=S&&(U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+S-1])&U.hash_mask,te=U.prev[U.strstart&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=U.strstart),U.prev_length=U.match_length,U.prev_match=U.match_start,U.match_length=S-1,te!==0&&U.prev_length<U.max_lazy_match&&U.strstart-te<=U.w_size-A&&(U.match_length=V(U,te),U.match_length<=5&&(U.strategy===1||U.match_length===S&&4096<U.strstart-U.match_start)&&(U.match_length=S-1)),U.prev_length>=S&&U.match_length<=U.prev_length){for(H=U.strstart+U.lookahead-S,K=c._tr_tally(U,U.strstart-1-U.prev_match,U.prev_length-S),U.lookahead-=U.prev_length-1,U.prev_length-=2;++U.strstart<=H&&(U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+S-1])&U.hash_mask,te=U.prev[U.strstart&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=U.strstart),--U.prev_length!=0;);if(U.match_available=0,U.match_length=S-1,U.strstart++,K&&(C(U,!1),U.strm.avail_out===0))return P}else if(U.match_available){if((K=c._tr_tally(U,0,U.window[U.strstart-1]))&&C(U,!1),U.strstart++,U.lookahead--,U.strm.avail_out===0)return P}else U.match_available=1,U.strstart++,U.lookahead--}return U.match_available&&(K=c._tr_tally(U,0,U.window[U.strstart-1]),U.match_available=0),U.insert=U.strstart<S-1?U.strstart:S-1,se===h?(C(U,!0),U.strm.avail_out===0?q:B):U.last_lit&&(C(U,!1),U.strm.avail_out===0)?P:X}function Q(U,se,te,K,H){this.good_length=U,this.max_lazy=se,this.nice_length=te,this.max_chain=K,this.func=H}function ne(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*N),this.dyn_dtree=new o.Buf16(2*(2*w+1)),this.bl_tree=new o.Buf16(2*(2*j+1)),I(this.dyn_ltree),I(this.dyn_dtree),I(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(D+1),this.heap=new o.Buf16(2*_+1),I(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*_+1),I(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function pe(U){var se;return U&&U.state?(U.total_in=U.total_out=0,U.data_type=v,(se=U.state).pending=0,se.pending_out=0,se.wrap<0&&(se.wrap=-se.wrap),se.status=se.wrap?E:M,U.adler=se.wrap===2?0:1,se.last_flush=f,c._tr_init(se),m):O(U,x)}function W(U){var se=pe(U);return se===m&&function(te){te.window_size=2*te.w_size,I(te.head),te.max_lazy_match=i[te.level].max_lazy,te.good_match=i[te.level].good_length,te.nice_match=i[te.level].nice_length,te.max_chain_length=i[te.level].max_chain,te.strstart=0,te.block_start=0,te.lookahead=0,te.insert=0,te.match_length=te.prev_length=S-1,te.match_available=0,te.ins_h=0}(U.state),se}function re(U,se,te,K,H,oe){if(!U)return x;var J=1;if(se===p&&(se=6),K<0?(J=0,K=-K):15<K&&(J=2,K-=16),H<1||b<H||te!==y||K<8||15<K||se<0||9<se||oe<0||g<oe)return O(U,x);K===8&&(K=9);var le=new ne;return(U.state=le).strm=U,le.wrap=J,le.gzhead=null,le.w_bits=K,le.w_size=1<<le.w_bits,le.w_mask=le.w_size-1,le.hash_bits=H+7,le.hash_size=1<<le.hash_bits,le.hash_mask=le.hash_size-1,le.hash_shift=~~((le.hash_bits+S-1)/S),le.window=new o.Buf8(2*le.w_size),le.head=new o.Buf16(le.hash_size),le.prev=new o.Buf16(le.w_size),le.lit_bufsize=1<<H+6,le.pending_buf_size=4*le.lit_bufsize,le.pending_buf=new o.Buf8(le.pending_buf_size),le.d_buf=1*le.lit_bufsize,le.l_buf=3*le.lit_bufsize,le.level=se,le.strategy=oe,le.method=te,W(U)}i=[new Q(0,0,0,0,function(U,se){var te=65535;for(te>U.pending_buf_size-5&&(te=U.pending_buf_size-5);;){if(U.lookahead<=1){if(Z(U),U.lookahead===0&&se===f)return P;if(U.lookahead===0)break}U.strstart+=U.lookahead,U.lookahead=0;var K=U.block_start+te;if((U.strstart===0||U.strstart>=K)&&(U.lookahead=U.strstart-K,U.strstart=K,C(U,!1),U.strm.avail_out===0)||U.strstart-U.block_start>=U.w_size-A&&(C(U,!1),U.strm.avail_out===0))return P}return U.insert=0,se===h?(C(U,!0),U.strm.avail_out===0?q:B):(U.strstart>U.block_start&&(C(U,!1),U.strm.avail_out),P)}),new Q(4,4,8,4,ce),new Q(4,5,16,8,ce),new Q(4,6,32,32,ce),new Q(4,4,16,16,ie),new Q(8,16,32,32,ie),new Q(8,16,128,128,ie),new Q(8,32,128,256,ie),new Q(32,128,258,1024,ie),new Q(32,258,258,4096,ie)],a.deflateInit=function(U,se){return re(U,se,y,15,8,0)},a.deflateInit2=re,a.deflateReset=W,a.deflateResetKeep=pe,a.deflateSetHeader=function(U,se){return U&&U.state?U.state.wrap!==2?x:(U.state.gzhead=se,m):x},a.deflate=function(U,se){var te,K,H,oe;if(!U||!U.state||5<se||se<0)return U?O(U,x):x;if(K=U.state,!U.output||!U.input&&U.avail_in!==0||K.status===666&&se!==h)return O(U,U.avail_out===0?-5:x);if(K.strm=U,te=K.last_flush,K.last_flush=se,K.status===E)if(K.wrap===2)U.adler=0,k(K,31),k(K,139),k(K,8),K.gzhead?(k(K,(K.gzhead.text?1:0)+(K.gzhead.hcrc?2:0)+(K.gzhead.extra?4:0)+(K.gzhead.name?8:0)+(K.gzhead.comment?16:0)),k(K,255&K.gzhead.time),k(K,K.gzhead.time>>8&255),k(K,K.gzhead.time>>16&255),k(K,K.gzhead.time>>24&255),k(K,K.level===9?2:2<=K.strategy||K.level<2?4:0),k(K,255&K.gzhead.os),K.gzhead.extra&&K.gzhead.extra.length&&(k(K,255&K.gzhead.extra.length),k(K,K.gzhead.extra.length>>8&255)),K.gzhead.hcrc&&(U.adler=u(U.adler,K.pending_buf,K.pending,0)),K.gzindex=0,K.status=69):(k(K,0),k(K,0),k(K,0),k(K,0),k(K,0),k(K,K.level===9?2:2<=K.strategy||K.level<2?4:0),k(K,3),K.status=M);else{var J=y+(K.w_bits-8<<4)<<8;J|=(2<=K.strategy||K.level<2?0:K.level<6?1:K.level===6?2:3)<<6,K.strstart!==0&&(J|=32),J+=31-J%31,K.status=M,z(K,J),K.strstart!==0&&(z(K,U.adler>>>16),z(K,65535&U.adler)),U.adler=1}if(K.status===69)if(K.gzhead.extra){for(H=K.pending;K.gzindex<(65535&K.gzhead.extra.length)&&(K.pending!==K.pending_buf_size||(K.gzhead.hcrc&&K.pending>H&&(U.adler=u(U.adler,K.pending_buf,K.pending-H,H)),L(U),H=K.pending,K.pending!==K.pending_buf_size));)k(K,255&K.gzhead.extra[K.gzindex]),K.gzindex++;K.gzhead.hcrc&&K.pending>H&&(U.adler=u(U.adler,K.pending_buf,K.pending-H,H)),K.gzindex===K.gzhead.extra.length&&(K.gzindex=0,K.status=73)}else K.status=73;if(K.status===73)if(K.gzhead.name){H=K.pending;do{if(K.pending===K.pending_buf_size&&(K.gzhead.hcrc&&K.pending>H&&(U.adler=u(U.adler,K.pending_buf,K.pending-H,H)),L(U),H=K.pending,K.pending===K.pending_buf_size)){oe=1;break}oe=K.gzindex<K.gzhead.name.length?255&K.gzhead.name.charCodeAt(K.gzindex++):0,k(K,oe)}while(oe!==0);K.gzhead.hcrc&&K.pending>H&&(U.adler=u(U.adler,K.pending_buf,K.pending-H,H)),oe===0&&(K.gzindex=0,K.status=91)}else K.status=91;if(K.status===91)if(K.gzhead.comment){H=K.pending;do{if(K.pending===K.pending_buf_size&&(K.gzhead.hcrc&&K.pending>H&&(U.adler=u(U.adler,K.pending_buf,K.pending-H,H)),L(U),H=K.pending,K.pending===K.pending_buf_size)){oe=1;break}oe=K.gzindex<K.gzhead.comment.length?255&K.gzhead.comment.charCodeAt(K.gzindex++):0,k(K,oe)}while(oe!==0);K.gzhead.hcrc&&K.pending>H&&(U.adler=u(U.adler,K.pending_buf,K.pending-H,H)),oe===0&&(K.status=103)}else K.status=103;if(K.status===103&&(K.gzhead.hcrc?(K.pending+2>K.pending_buf_size&&L(U),K.pending+2<=K.pending_buf_size&&(k(K,255&U.adler),k(K,U.adler>>8&255),U.adler=0,K.status=M)):K.status=M),K.pending!==0){if(L(U),U.avail_out===0)return K.last_flush=-1,m}else if(U.avail_in===0&&F(se)<=F(te)&&se!==h)return O(U,-5);if(K.status===666&&U.avail_in!==0)return O(U,-5);if(U.avail_in!==0||K.lookahead!==0||se!==f&&K.status!==666){var le=K.strategy===2?function(he,ee){for(var ae;;){if(he.lookahead===0&&(Z(he),he.lookahead===0)){if(ee===f)return P;break}if(he.match_length=0,ae=c._tr_tally(he,0,he.window[he.strstart]),he.lookahead--,he.strstart++,ae&&(C(he,!1),he.strm.avail_out===0))return P}return he.insert=0,ee===h?(C(he,!0),he.strm.avail_out===0?q:B):he.last_lit&&(C(he,!1),he.strm.avail_out===0)?P:X}(K,se):K.strategy===3?function(he,ee){for(var ae,xe,ye,Ce,Ie=he.window;;){if(he.lookahead<=T){if(Z(he),he.lookahead<=T&&ee===f)return P;if(he.lookahead===0)break}if(he.match_length=0,he.lookahead>=S&&0<he.strstart&&(xe=Ie[ye=he.strstart-1])===Ie[++ye]&&xe===Ie[++ye]&&xe===Ie[++ye]){Ce=he.strstart+T;do;while(xe===Ie[++ye]&&xe===Ie[++ye]&&xe===Ie[++ye]&&xe===Ie[++ye]&&xe===Ie[++ye]&&xe===Ie[++ye]&&xe===Ie[++ye]&&xe===Ie[++ye]&&ye<Ce);he.match_length=T-(Ce-ye),he.match_length>he.lookahead&&(he.match_length=he.lookahead)}if(he.match_length>=S?(ae=c._tr_tally(he,1,he.match_length-S),he.lookahead-=he.match_length,he.strstart+=he.match_length,he.match_length=0):(ae=c._tr_tally(he,0,he.window[he.strstart]),he.lookahead--,he.strstart++),ae&&(C(he,!1),he.strm.avail_out===0))return P}return he.insert=0,ee===h?(C(he,!0),he.strm.avail_out===0?q:B):he.last_lit&&(C(he,!1),he.strm.avail_out===0)?P:X}(K,se):i[K.level].func(K,se);if(le!==q&&le!==B||(K.status=666),le===P||le===q)return U.avail_out===0&&(K.last_flush=-1),m;if(le===X&&(se===1?c._tr_align(K):se!==5&&(c._tr_stored_block(K,0,0,!1),se===3&&(I(K.head),K.lookahead===0&&(K.strstart=0,K.block_start=0,K.insert=0))),L(U),U.avail_out===0))return K.last_flush=-1,m}return se!==h?m:K.wrap<=0?1:(K.wrap===2?(k(K,255&U.adler),k(K,U.adler>>8&255),k(K,U.adler>>16&255),k(K,U.adler>>24&255),k(K,255&U.total_in),k(K,U.total_in>>8&255),k(K,U.total_in>>16&255),k(K,U.total_in>>24&255)):(z(K,U.adler>>>16),z(K,65535&U.adler)),L(U),0<K.wrap&&(K.wrap=-K.wrap),K.pending!==0?m:1)},a.deflateEnd=function(U){var se;return U&&U.state?(se=U.state.status)!==E&&se!==69&&se!==73&&se!==91&&se!==103&&se!==M&&se!==666?O(U,x):(U.state=null,se===M?O(U,-3):m):x},a.deflateSetDictionary=function(U,se){var te,K,H,oe,J,le,he,ee,ae=se.length;if(!U||!U.state||(oe=(te=U.state).wrap)===2||oe===1&&te.status!==E||te.lookahead)return x;for(oe===1&&(U.adler=l(U.adler,se,ae,0)),te.wrap=0,ae>=te.w_size&&(oe===0&&(I(te.head),te.strstart=0,te.block_start=0,te.insert=0),ee=new o.Buf8(te.w_size),o.arraySet(ee,se,ae-te.w_size,te.w_size,0),se=ee,ae=te.w_size),J=U.avail_in,le=U.next_in,he=U.input,U.avail_in=ae,U.next_in=0,U.input=se,Z(te);te.lookahead>=S;){for(K=te.strstart,H=te.lookahead-(S-1);te.ins_h=(te.ins_h<<te.hash_shift^te.window[K+S-1])&te.hash_mask,te.prev[K&te.w_mask]=te.head[te.ins_h],te.head[te.ins_h]=K,K++,--H;);te.strstart=K,te.lookahead=S-1,Z(te)}return te.strstart+=te.lookahead,te.block_start=te.strstart,te.insert=te.lookahead,te.lookahead=0,te.match_length=te.prev_length=S-1,te.match_available=0,U.next_in=le,U.input=he,U.avail_in=J,te.wrap=oe,m},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,n,a){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,n,a){n.exports=function(i,o){var c,l,u,d,f,h,m,x,p,g,v,y,b,_,w,j,N,D,S,T,A,E,M,P,X;c=i.state,l=i.next_in,P=i.input,u=l+(i.avail_in-5),d=i.next_out,X=i.output,f=d-(o-i.avail_out),h=d+(i.avail_out-257),m=c.dmax,x=c.wsize,p=c.whave,g=c.wnext,v=c.window,y=c.hold,b=c.bits,_=c.lencode,w=c.distcode,j=(1<<c.lenbits)-1,N=(1<<c.distbits)-1;e:do{b<15&&(y+=P[l++]<<b,b+=8,y+=P[l++]<<b,b+=8),D=_[y&j];t:for(;;){if(y>>>=S=D>>>24,b-=S,(S=D>>>16&255)===0)X[d++]=65535&D;else{if(!(16&S)){if(!(64&S)){D=_[(65535&D)+(y&(1<<S)-1)];continue t}if(32&S){c.mode=12;break e}i.msg="invalid literal/length code",c.mode=30;break e}T=65535&D,(S&=15)&&(b<S&&(y+=P[l++]<<b,b+=8),T+=y&(1<<S)-1,y>>>=S,b-=S),b<15&&(y+=P[l++]<<b,b+=8,y+=P[l++]<<b,b+=8),D=w[y&N];r:for(;;){if(y>>>=S=D>>>24,b-=S,!(16&(S=D>>>16&255))){if(!(64&S)){D=w[(65535&D)+(y&(1<<S)-1)];continue r}i.msg="invalid distance code",c.mode=30;break e}if(A=65535&D,b<(S&=15)&&(y+=P[l++]<<b,(b+=8)<S&&(y+=P[l++]<<b,b+=8)),m<(A+=y&(1<<S)-1)){i.msg="invalid distance too far back",c.mode=30;break e}if(y>>>=S,b-=S,(S=d-f)<A){if(p<(S=A-S)&&c.sane){i.msg="invalid distance too far back",c.mode=30;break e}if(M=v,(E=0)===g){if(E+=x-S,S<T){for(T-=S;X[d++]=v[E++],--S;);E=d-A,M=X}}else if(g<S){if(E+=x+g-S,(S-=g)<T){for(T-=S;X[d++]=v[E++],--S;);if(E=0,g<T){for(T-=S=g;X[d++]=v[E++],--S;);E=d-A,M=X}}}else if(E+=g-S,S<T){for(T-=S;X[d++]=v[E++],--S;);E=d-A,M=X}for(;2<T;)X[d++]=M[E++],X[d++]=M[E++],X[d++]=M[E++],T-=3;T&&(X[d++]=M[E++],1<T&&(X[d++]=M[E++]))}else{for(E=d-A;X[d++]=X[E++],X[d++]=X[E++],X[d++]=X[E++],2<(T-=3););T&&(X[d++]=X[E++],1<T&&(X[d++]=X[E++]))}break}}break}}while(l<u&&d<h);l-=T=b>>3,y&=(1<<(b-=T<<3))-1,i.next_in=l,i.next_out=d,i.avail_in=l<u?u-l+5:5-(l-u),i.avail_out=d<h?h-d+257:257-(d-h),c.hold=y,c.bits=b}},{}],49:[function(r,n,a){var i=r("../utils/common"),o=r("./adler32"),c=r("./crc32"),l=r("./inffast"),u=r("./inftrees"),d=1,f=2,h=0,m=-2,x=1,p=852,g=592;function v(E){return(E>>>24&255)+(E>>>8&65280)+((65280&E)<<8)+((255&E)<<24)}function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function b(E){var M;return E&&E.state?(M=E.state,E.total_in=E.total_out=M.total=0,E.msg="",M.wrap&&(E.adler=1&M.wrap),M.mode=x,M.last=0,M.havedict=0,M.dmax=32768,M.head=null,M.hold=0,M.bits=0,M.lencode=M.lendyn=new i.Buf32(p),M.distcode=M.distdyn=new i.Buf32(g),M.sane=1,M.back=-1,h):m}function _(E){var M;return E&&E.state?((M=E.state).wsize=0,M.whave=0,M.wnext=0,b(E)):m}function w(E,M){var P,X;return E&&E.state?(X=E.state,M<0?(P=0,M=-M):(P=1+(M>>4),M<48&&(M&=15)),M&&(M<8||15<M)?m:(X.window!==null&&X.wbits!==M&&(X.window=null),X.wrap=P,X.wbits=M,_(E))):m}function j(E,M){var P,X;return E?(X=new y,(E.state=X).window=null,(P=w(E,M))!==h&&(E.state=null),P):m}var N,D,S=!0;function T(E){if(S){var M;for(N=new i.Buf32(512),D=new i.Buf32(32),M=0;M<144;)E.lens[M++]=8;for(;M<256;)E.lens[M++]=9;for(;M<280;)E.lens[M++]=7;for(;M<288;)E.lens[M++]=8;for(u(d,E.lens,0,288,N,0,E.work,{bits:9}),M=0;M<32;)E.lens[M++]=5;u(f,E.lens,0,32,D,0,E.work,{bits:5}),S=!1}E.lencode=N,E.lenbits=9,E.distcode=D,E.distbits=5}function A(E,M,P,X){var q,B=E.state;return B.window===null&&(B.wsize=1<<B.wbits,B.wnext=0,B.whave=0,B.window=new i.Buf8(B.wsize)),X>=B.wsize?(i.arraySet(B.window,M,P-B.wsize,B.wsize,0),B.wnext=0,B.whave=B.wsize):(X<(q=B.wsize-B.wnext)&&(q=X),i.arraySet(B.window,M,P-X,q,B.wnext),(X-=q)?(i.arraySet(B.window,M,P-X,X,0),B.wnext=X,B.whave=B.wsize):(B.wnext+=q,B.wnext===B.wsize&&(B.wnext=0),B.whave<B.wsize&&(B.whave+=q))),0}a.inflateReset=_,a.inflateReset2=w,a.inflateResetKeep=b,a.inflateInit=function(E){return j(E,15)},a.inflateInit2=j,a.inflate=function(E,M){var P,X,q,B,O,F,I,L,C,k,z,V,Z,ce,ie,Q,ne,pe,W,re,U,se,te,K,H=0,oe=new i.Buf8(4),J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!E||!E.state||!E.output||!E.input&&E.avail_in!==0)return m;(P=E.state).mode===12&&(P.mode=13),O=E.next_out,q=E.output,I=E.avail_out,B=E.next_in,X=E.input,F=E.avail_in,L=P.hold,C=P.bits,k=F,z=I,se=h;e:for(;;)switch(P.mode){case x:if(P.wrap===0){P.mode=13;break}for(;C<16;){if(F===0)break e;F--,L+=X[B++]<<C,C+=8}if(2&P.wrap&&L===35615){oe[P.check=0]=255&L,oe[1]=L>>>8&255,P.check=c(P.check,oe,2,0),C=L=0,P.mode=2;break}if(P.flags=0,P.head&&(P.head.done=!1),!(1&P.wrap)||(((255&L)<<8)+(L>>8))%31){E.msg="incorrect header check",P.mode=30;break}if((15&L)!=8){E.msg="unknown compression method",P.mode=30;break}if(C-=4,U=8+(15&(L>>>=4)),P.wbits===0)P.wbits=U;else if(U>P.wbits){E.msg="invalid window size",P.mode=30;break}P.dmax=1<<U,E.adler=P.check=1,P.mode=512&L?10:12,C=L=0;break;case 2:for(;C<16;){if(F===0)break e;F--,L+=X[B++]<<C,C+=8}if(P.flags=L,(255&P.flags)!=8){E.msg="unknown compression method",P.mode=30;break}if(57344&P.flags){E.msg="unknown header flags set",P.mode=30;break}P.head&&(P.head.text=L>>8&1),512&P.flags&&(oe[0]=255&L,oe[1]=L>>>8&255,P.check=c(P.check,oe,2,0)),C=L=0,P.mode=3;case 3:for(;C<32;){if(F===0)break e;F--,L+=X[B++]<<C,C+=8}P.head&&(P.head.time=L),512&P.flags&&(oe[0]=255&L,oe[1]=L>>>8&255,oe[2]=L>>>16&255,oe[3]=L>>>24&255,P.check=c(P.check,oe,4,0)),C=L=0,P.mode=4;case 4:for(;C<16;){if(F===0)break e;F--,L+=X[B++]<<C,C+=8}P.head&&(P.head.xflags=255&L,P.head.os=L>>8),512&P.flags&&(oe[0]=255&L,oe[1]=L>>>8&255,P.check=c(P.check,oe,2,0)),C=L=0,P.mode=5;case 5:if(1024&P.flags){for(;C<16;){if(F===0)break e;F--,L+=X[B++]<<C,C+=8}P.length=L,P.head&&(P.head.extra_len=L),512&P.flags&&(oe[0]=255&L,oe[1]=L>>>8&255,P.check=c(P.check,oe,2,0)),C=L=0}else P.head&&(P.head.extra=null);P.mode=6;case 6:if(1024&P.flags&&(F<(V=P.length)&&(V=F),V&&(P.head&&(U=P.head.extra_len-P.length,P.head.extra||(P.head.extra=new Array(P.head.extra_len)),i.arraySet(P.head.extra,X,B,V,U)),512&P.flags&&(P.check=c(P.check,X,V,B)),F-=V,B+=V,P.length-=V),P.length))break e;P.length=0,P.mode=7;case 7:if(2048&P.flags){if(F===0)break e;for(V=0;U=X[B+V++],P.head&&U&&P.length<65536&&(P.head.name+=String.fromCharCode(U)),U&&V<F;);if(512&P.flags&&(P.check=c(P.check,X,V,B)),F-=V,B+=V,U)break e}else P.head&&(P.head.name=null);P.length=0,P.mode=8;case 8:if(4096&P.flags){if(F===0)break e;for(V=0;U=X[B+V++],P.head&&U&&P.length<65536&&(P.head.comment+=String.fromCharCode(U)),U&&V<F;);if(512&P.flags&&(P.check=c(P.check,X,V,B)),F-=V,B+=V,U)break e}else P.head&&(P.head.comment=null);P.mode=9;case 9:if(512&P.flags){for(;C<16;){if(F===0)break e;F--,L+=X[B++]<<C,C+=8}if(L!==(65535&P.check)){E.msg="header crc mismatch",P.mode=30;break}C=L=0}P.head&&(P.head.hcrc=P.flags>>9&1,P.head.done=!0),E.adler=P.check=0,P.mode=12;break;case 10:for(;C<32;){if(F===0)break e;F--,L+=X[B++]<<C,C+=8}E.adler=P.check=v(L),C=L=0,P.mode=11;case 11:if(P.havedict===0)return E.next_out=O,E.avail_out=I,E.next_in=B,E.avail_in=F,P.hold=L,P.bits=C,2;E.adler=P.check=1,P.mode=12;case 12:if(M===5||M===6)break e;case 13:if(P.last){L>>>=7&C,C-=7&C,P.mode=27;break}for(;C<3;){if(F===0)break e;F--,L+=X[B++]<<C,C+=8}switch(P.last=1&L,C-=1,3&(L>>>=1)){case 0:P.mode=14;break;case 1:if(T(P),P.mode=20,M!==6)break;L>>>=2,C-=2;break e;case 2:P.mode=17;break;case 3:E.msg="invalid block type",P.mode=30}L>>>=2,C-=2;break;case 14:for(L>>>=7&C,C-=7&C;C<32;){if(F===0)break e;F--,L+=X[B++]<<C,C+=8}if((65535&L)!=(L>>>16^65535)){E.msg="invalid stored block lengths",P.mode=30;break}if(P.length=65535&L,C=L=0,P.mode=15,M===6)break e;case 15:P.mode=16;case 16:if(V=P.length){if(F<V&&(V=F),I<V&&(V=I),V===0)break e;i.arraySet(q,X,B,V,O),F-=V,B+=V,I-=V,O+=V,P.length-=V;break}P.mode=12;break;case 17:for(;C<14;){if(F===0)break e;F--,L+=X[B++]<<C,C+=8}if(P.nlen=257+(31&L),L>>>=5,C-=5,P.ndist=1+(31&L),L>>>=5,C-=5,P.ncode=4+(15&L),L>>>=4,C-=4,286<P.nlen||30<P.ndist){E.msg="too many length or distance symbols",P.mode=30;break}P.have=0,P.mode=18;case 18:for(;P.have<P.ncode;){for(;C<3;){if(F===0)break e;F--,L+=X[B++]<<C,C+=8}P.lens[J[P.have++]]=7&L,L>>>=3,C-=3}for(;P.have<19;)P.lens[J[P.have++]]=0;if(P.lencode=P.lendyn,P.lenbits=7,te={bits:P.lenbits},se=u(0,P.lens,0,19,P.lencode,0,P.work,te),P.lenbits=te.bits,se){E.msg="invalid code lengths set",P.mode=30;break}P.have=0,P.mode=19;case 19:for(;P.have<P.nlen+P.ndist;){for(;Q=(H=P.lencode[L&(1<<P.lenbits)-1])>>>16&255,ne=65535&H,!((ie=H>>>24)<=C);){if(F===0)break e;F--,L+=X[B++]<<C,C+=8}if(ne<16)L>>>=ie,C-=ie,P.lens[P.have++]=ne;else{if(ne===16){for(K=ie+2;C<K;){if(F===0)break e;F--,L+=X[B++]<<C,C+=8}if(L>>>=ie,C-=ie,P.have===0){E.msg="invalid bit length repeat",P.mode=30;break}U=P.lens[P.have-1],V=3+(3&L),L>>>=2,C-=2}else if(ne===17){for(K=ie+3;C<K;){if(F===0)break e;F--,L+=X[B++]<<C,C+=8}C-=ie,U=0,V=3+(7&(L>>>=ie)),L>>>=3,C-=3}else{for(K=ie+7;C<K;){if(F===0)break e;F--,L+=X[B++]<<C,C+=8}C-=ie,U=0,V=11+(127&(L>>>=ie)),L>>>=7,C-=7}if(P.have+V>P.nlen+P.ndist){E.msg="invalid bit length repeat",P.mode=30;break}for(;V--;)P.lens[P.have++]=U}}if(P.mode===30)break;if(P.lens[256]===0){E.msg="invalid code -- missing end-of-block",P.mode=30;break}if(P.lenbits=9,te={bits:P.lenbits},se=u(d,P.lens,0,P.nlen,P.lencode,0,P.work,te),P.lenbits=te.bits,se){E.msg="invalid literal/lengths set",P.mode=30;break}if(P.distbits=6,P.distcode=P.distdyn,te={bits:P.distbits},se=u(f,P.lens,P.nlen,P.ndist,P.distcode,0,P.work,te),P.distbits=te.bits,se){E.msg="invalid distances set",P.mode=30;break}if(P.mode=20,M===6)break e;case 20:P.mode=21;case 21:if(6<=F&&258<=I){E.next_out=O,E.avail_out=I,E.next_in=B,E.avail_in=F,P.hold=L,P.bits=C,l(E,z),O=E.next_out,q=E.output,I=E.avail_out,B=E.next_in,X=E.input,F=E.avail_in,L=P.hold,C=P.bits,P.mode===12&&(P.back=-1);break}for(P.back=0;Q=(H=P.lencode[L&(1<<P.lenbits)-1])>>>16&255,ne=65535&H,!((ie=H>>>24)<=C);){if(F===0)break e;F--,L+=X[B++]<<C,C+=8}if(Q&&!(240&Q)){for(pe=ie,W=Q,re=ne;Q=(H=P.lencode[re+((L&(1<<pe+W)-1)>>pe)])>>>16&255,ne=65535&H,!(pe+(ie=H>>>24)<=C);){if(F===0)break e;F--,L+=X[B++]<<C,C+=8}L>>>=pe,C-=pe,P.back+=pe}if(L>>>=ie,C-=ie,P.back+=ie,P.length=ne,Q===0){P.mode=26;break}if(32&Q){P.back=-1,P.mode=12;break}if(64&Q){E.msg="invalid literal/length code",P.mode=30;break}P.extra=15&Q,P.mode=22;case 22:if(P.extra){for(K=P.extra;C<K;){if(F===0)break e;F--,L+=X[B++]<<C,C+=8}P.length+=L&(1<<P.extra)-1,L>>>=P.extra,C-=P.extra,P.back+=P.extra}P.was=P.length,P.mode=23;case 23:for(;Q=(H=P.distcode[L&(1<<P.distbits)-1])>>>16&255,ne=65535&H,!((ie=H>>>24)<=C);){if(F===0)break e;F--,L+=X[B++]<<C,C+=8}if(!(240&Q)){for(pe=ie,W=Q,re=ne;Q=(H=P.distcode[re+((L&(1<<pe+W)-1)>>pe)])>>>16&255,ne=65535&H,!(pe+(ie=H>>>24)<=C);){if(F===0)break e;F--,L+=X[B++]<<C,C+=8}L>>>=pe,C-=pe,P.back+=pe}if(L>>>=ie,C-=ie,P.back+=ie,64&Q){E.msg="invalid distance code",P.mode=30;break}P.offset=ne,P.extra=15&Q,P.mode=24;case 24:if(P.extra){for(K=P.extra;C<K;){if(F===0)break e;F--,L+=X[B++]<<C,C+=8}P.offset+=L&(1<<P.extra)-1,L>>>=P.extra,C-=P.extra,P.back+=P.extra}if(P.offset>P.dmax){E.msg="invalid distance too far back",P.mode=30;break}P.mode=25;case 25:if(I===0)break e;if(V=z-I,P.offset>V){if((V=P.offset-V)>P.whave&&P.sane){E.msg="invalid distance too far back",P.mode=30;break}Z=V>P.wnext?(V-=P.wnext,P.wsize-V):P.wnext-V,V>P.length&&(V=P.length),ce=P.window}else ce=q,Z=O-P.offset,V=P.length;for(I<V&&(V=I),I-=V,P.length-=V;q[O++]=ce[Z++],--V;);P.length===0&&(P.mode=21);break;case 26:if(I===0)break e;q[O++]=P.length,I--,P.mode=21;break;case 27:if(P.wrap){for(;C<32;){if(F===0)break e;F--,L|=X[B++]<<C,C+=8}if(z-=I,E.total_out+=z,P.total+=z,z&&(E.adler=P.check=P.flags?c(P.check,q,z,O-z):o(P.check,q,z,O-z)),z=I,(P.flags?L:v(L))!==P.check){E.msg="incorrect data check",P.mode=30;break}C=L=0}P.mode=28;case 28:if(P.wrap&&P.flags){for(;C<32;){if(F===0)break e;F--,L+=X[B++]<<C,C+=8}if(L!==(4294967295&P.total)){E.msg="incorrect length check",P.mode=30;break}C=L=0}P.mode=29;case 29:se=1;break e;case 30:se=-3;break e;case 31:return-4;case 32:default:return m}return E.next_out=O,E.avail_out=I,E.next_in=B,E.avail_in=F,P.hold=L,P.bits=C,(P.wsize||z!==E.avail_out&&P.mode<30&&(P.mode<27||M!==4))&&A(E,E.output,E.next_out,z-E.avail_out)?(P.mode=31,-4):(k-=E.avail_in,z-=E.avail_out,E.total_in+=k,E.total_out+=z,P.total+=z,P.wrap&&z&&(E.adler=P.check=P.flags?c(P.check,q,z,E.next_out-z):o(P.check,q,z,E.next_out-z)),E.data_type=P.bits+(P.last?64:0)+(P.mode===12?128:0)+(P.mode===20||P.mode===15?256:0),(k==0&&z===0||M===4)&&se===h&&(se=-5),se)},a.inflateEnd=function(E){if(!E||!E.state)return m;var M=E.state;return M.window&&(M.window=null),E.state=null,h},a.inflateGetHeader=function(E,M){var P;return E&&E.state&&2&(P=E.state).wrap?((P.head=M).done=!1,h):m},a.inflateSetDictionary=function(E,M){var P,X=M.length;return E&&E.state?(P=E.state).wrap!==0&&P.mode!==11?m:P.mode===11&&o(1,M,X,0)!==P.check?-3:A(E,M,X,X)?(P.mode=31,-4):(P.havedict=1,h):m},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,n,a){var i=r("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],c=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(d,f,h,m,x,p,g,v){var y,b,_,w,j,N,D,S,T,A=v.bits,E=0,M=0,P=0,X=0,q=0,B=0,O=0,F=0,I=0,L=0,C=null,k=0,z=new i.Buf16(16),V=new i.Buf16(16),Z=null,ce=0;for(E=0;E<=15;E++)z[E]=0;for(M=0;M<m;M++)z[f[h+M]]++;for(q=A,X=15;1<=X&&z[X]===0;X--);if(X<q&&(q=X),X===0)return x[p++]=20971520,x[p++]=20971520,v.bits=1,0;for(P=1;P<X&&z[P]===0;P++);for(q<P&&(q=P),E=F=1;E<=15;E++)if(F<<=1,(F-=z[E])<0)return-1;if(0<F&&(d===0||X!==1))return-1;for(V[1]=0,E=1;E<15;E++)V[E+1]=V[E]+z[E];for(M=0;M<m;M++)f[h+M]!==0&&(g[V[f[h+M]]++]=M);if(N=d===0?(C=Z=g,19):d===1?(C=o,k-=257,Z=c,ce-=257,256):(C=l,Z=u,-1),E=P,j=p,O=M=L=0,_=-1,w=(I=1<<(B=q))-1,d===1&&852<I||d===2&&592<I)return 1;for(;;){for(D=E-O,T=g[M]<N?(S=0,g[M]):g[M]>N?(S=Z[ce+g[M]],C[k+g[M]]):(S=96,0),y=1<<E-O,P=b=1<<B;x[j+(L>>O)+(b-=y)]=D<<24|S<<16|T|0,b!==0;);for(y=1<<E-1;L&y;)y>>=1;if(y!==0?(L&=y-1,L+=y):L=0,M++,--z[E]==0){if(E===X)break;E=f[h+g[M]]}if(q<E&&(L&w)!==_){for(O===0&&(O=q),j+=P,F=1<<(B=E-O);B+O<X&&!((F-=z[B+O])<=0);)B++,F<<=1;if(I+=1<<B,d===1&&852<I||d===2&&592<I)return 1;x[_=L&w]=q<<24|B<<16|j-p|0}}return L!==0&&(x[j+L]=E-O<<24|64<<16|0),v.bits=q,0}},{"../utils/common":41}],51:[function(r,n,a){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,n,a){var i=r("../utils/common"),o=0,c=1;function l(H){for(var oe=H.length;0<=--oe;)H[oe]=0}var u=0,d=29,f=256,h=f+1+d,m=30,x=19,p=2*h+1,g=15,v=16,y=7,b=256,_=16,w=17,j=18,N=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],D=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],T=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],A=new Array(2*(h+2));l(A);var E=new Array(2*m);l(E);var M=new Array(512);l(M);var P=new Array(256);l(P);var X=new Array(d);l(X);var q,B,O,F=new Array(m);function I(H,oe,J,le,he){this.static_tree=H,this.extra_bits=oe,this.extra_base=J,this.elems=le,this.max_length=he,this.has_stree=H&&H.length}function L(H,oe){this.dyn_tree=H,this.max_code=0,this.stat_desc=oe}function C(H){return H<256?M[H]:M[256+(H>>>7)]}function k(H,oe){H.pending_buf[H.pending++]=255&oe,H.pending_buf[H.pending++]=oe>>>8&255}function z(H,oe,J){H.bi_valid>v-J?(H.bi_buf|=oe<<H.bi_valid&65535,k(H,H.bi_buf),H.bi_buf=oe>>v-H.bi_valid,H.bi_valid+=J-v):(H.bi_buf|=oe<<H.bi_valid&65535,H.bi_valid+=J)}function V(H,oe,J){z(H,J[2*oe],J[2*oe+1])}function Z(H,oe){for(var J=0;J|=1&H,H>>>=1,J<<=1,0<--oe;);return J>>>1}function ce(H,oe,J){var le,he,ee=new Array(g+1),ae=0;for(le=1;le<=g;le++)ee[le]=ae=ae+J[le-1]<<1;for(he=0;he<=oe;he++){var xe=H[2*he+1];xe!==0&&(H[2*he]=Z(ee[xe]++,xe))}}function ie(H){var oe;for(oe=0;oe<h;oe++)H.dyn_ltree[2*oe]=0;for(oe=0;oe<m;oe++)H.dyn_dtree[2*oe]=0;for(oe=0;oe<x;oe++)H.bl_tree[2*oe]=0;H.dyn_ltree[2*b]=1,H.opt_len=H.static_len=0,H.last_lit=H.matches=0}function Q(H){8<H.bi_valid?k(H,H.bi_buf):0<H.bi_valid&&(H.pending_buf[H.pending++]=H.bi_buf),H.bi_buf=0,H.bi_valid=0}function ne(H,oe,J,le){var he=2*oe,ee=2*J;return H[he]<H[ee]||H[he]===H[ee]&&le[oe]<=le[J]}function pe(H,oe,J){for(var le=H.heap[J],he=J<<1;he<=H.heap_len&&(he<H.heap_len&&ne(oe,H.heap[he+1],H.heap[he],H.depth)&&he++,!ne(oe,le,H.heap[he],H.depth));)H.heap[J]=H.heap[he],J=he,he<<=1;H.heap[J]=le}function W(H,oe,J){var le,he,ee,ae,xe=0;if(H.last_lit!==0)for(;le=H.pending_buf[H.d_buf+2*xe]<<8|H.pending_buf[H.d_buf+2*xe+1],he=H.pending_buf[H.l_buf+xe],xe++,le===0?V(H,he,oe):(V(H,(ee=P[he])+f+1,oe),(ae=N[ee])!==0&&z(H,he-=X[ee],ae),V(H,ee=C(--le),J),(ae=D[ee])!==0&&z(H,le-=F[ee],ae)),xe<H.last_lit;);V(H,b,oe)}function re(H,oe){var J,le,he,ee=oe.dyn_tree,ae=oe.stat_desc.static_tree,xe=oe.stat_desc.has_stree,ye=oe.stat_desc.elems,Ce=-1;for(H.heap_len=0,H.heap_max=p,J=0;J<ye;J++)ee[2*J]!==0?(H.heap[++H.heap_len]=Ce=J,H.depth[J]=0):ee[2*J+1]=0;for(;H.heap_len<2;)ee[2*(he=H.heap[++H.heap_len]=Ce<2?++Ce:0)]=1,H.depth[he]=0,H.opt_len--,xe&&(H.static_len-=ae[2*he+1]);for(oe.max_code=Ce,J=H.heap_len>>1;1<=J;J--)pe(H,ee,J);for(he=ye;J=H.heap[1],H.heap[1]=H.heap[H.heap_len--],pe(H,ee,1),le=H.heap[1],H.heap[--H.heap_max]=J,H.heap[--H.heap_max]=le,ee[2*he]=ee[2*J]+ee[2*le],H.depth[he]=(H.depth[J]>=H.depth[le]?H.depth[J]:H.depth[le])+1,ee[2*J+1]=ee[2*le+1]=he,H.heap[1]=he++,pe(H,ee,1),2<=H.heap_len;);H.heap[--H.heap_max]=H.heap[1],function(Ie,Ze){var Fe,He,rt,Je,Gt,ma,yn=Ze.dyn_tree,Qe=Ze.max_code,vt=Ze.stat_desc.static_tree,At=Ze.stat_desc.has_stree,bt=Ze.stat_desc.extra_bits,Yn=Ze.stat_desc.extra_base,ln=Ze.stat_desc.max_length,bn=0;for(Je=0;Je<=g;Je++)Ie.bl_count[Je]=0;for(yn[2*Ie.heap[Ie.heap_max]+1]=0,Fe=Ie.heap_max+1;Fe<p;Fe++)ln<(Je=yn[2*yn[2*(He=Ie.heap[Fe])+1]+1]+1)&&(Je=ln,bn++),yn[2*He+1]=Je,Qe<He||(Ie.bl_count[Je]++,Gt=0,Yn<=He&&(Gt=bt[He-Yn]),ma=yn[2*He],Ie.opt_len+=ma*(Je+Gt),At&&(Ie.static_len+=ma*(vt[2*He+1]+Gt)));if(bn!==0){do{for(Je=ln-1;Ie.bl_count[Je]===0;)Je--;Ie.bl_count[Je]--,Ie.bl_count[Je+1]+=2,Ie.bl_count[ln]--,bn-=2}while(0<bn);for(Je=ln;Je!==0;Je--)for(He=Ie.bl_count[Je];He!==0;)Qe<(rt=Ie.heap[--Fe])||(yn[2*rt+1]!==Je&&(Ie.opt_len+=(Je-yn[2*rt+1])*yn[2*rt],yn[2*rt+1]=Je),He--)}}(H,oe),ce(ee,Ce,H.bl_count)}function U(H,oe,J){var le,he,ee=-1,ae=oe[1],xe=0,ye=7,Ce=4;for(ae===0&&(ye=138,Ce=3),oe[2*(J+1)+1]=65535,le=0;le<=J;le++)he=ae,ae=oe[2*(le+1)+1],++xe<ye&&he===ae||(xe<Ce?H.bl_tree[2*he]+=xe:he!==0?(he!==ee&&H.bl_tree[2*he]++,H.bl_tree[2*_]++):xe<=10?H.bl_tree[2*w]++:H.bl_tree[2*j]++,ee=he,Ce=(xe=0)===ae?(ye=138,3):he===ae?(ye=6,3):(ye=7,4))}function se(H,oe,J){var le,he,ee=-1,ae=oe[1],xe=0,ye=7,Ce=4;for(ae===0&&(ye=138,Ce=3),le=0;le<=J;le++)if(he=ae,ae=oe[2*(le+1)+1],!(++xe<ye&&he===ae)){if(xe<Ce)for(;V(H,he,H.bl_tree),--xe!=0;);else he!==0?(he!==ee&&(V(H,he,H.bl_tree),xe--),V(H,_,H.bl_tree),z(H,xe-3,2)):xe<=10?(V(H,w,H.bl_tree),z(H,xe-3,3)):(V(H,j,H.bl_tree),z(H,xe-11,7));ee=he,Ce=(xe=0)===ae?(ye=138,3):he===ae?(ye=6,3):(ye=7,4)}}l(F);var te=!1;function K(H,oe,J,le){z(H,(u<<1)+(le?1:0),3),function(he,ee,ae,xe){Q(he),k(he,ae),k(he,~ae),i.arraySet(he.pending_buf,he.window,ee,ae,he.pending),he.pending+=ae}(H,oe,J)}a._tr_init=function(H){te||(function(){var oe,J,le,he,ee,ae=new Array(g+1);for(he=le=0;he<d-1;he++)for(X[he]=le,oe=0;oe<1<<N[he];oe++)P[le++]=he;for(P[le-1]=he,he=ee=0;he<16;he++)for(F[he]=ee,oe=0;oe<1<<D[he];oe++)M[ee++]=he;for(ee>>=7;he<m;he++)for(F[he]=ee<<7,oe=0;oe<1<<D[he]-7;oe++)M[256+ee++]=he;for(J=0;J<=g;J++)ae[J]=0;for(oe=0;oe<=143;)A[2*oe+1]=8,oe++,ae[8]++;for(;oe<=255;)A[2*oe+1]=9,oe++,ae[9]++;for(;oe<=279;)A[2*oe+1]=7,oe++,ae[7]++;for(;oe<=287;)A[2*oe+1]=8,oe++,ae[8]++;for(ce(A,h+1,ae),oe=0;oe<m;oe++)E[2*oe+1]=5,E[2*oe]=Z(oe,5);q=new I(A,N,f+1,h,g),B=new I(E,D,0,m,g),O=new I(new Array(0),S,0,x,y)}(),te=!0),H.l_desc=new L(H.dyn_ltree,q),H.d_desc=new L(H.dyn_dtree,B),H.bl_desc=new L(H.bl_tree,O),H.bi_buf=0,H.bi_valid=0,ie(H)},a._tr_stored_block=K,a._tr_flush_block=function(H,oe,J,le){var he,ee,ae=0;0<H.level?(H.strm.data_type===2&&(H.strm.data_type=function(xe){var ye,Ce=4093624447;for(ye=0;ye<=31;ye++,Ce>>>=1)if(1&Ce&&xe.dyn_ltree[2*ye]!==0)return o;if(xe.dyn_ltree[18]!==0||xe.dyn_ltree[20]!==0||xe.dyn_ltree[26]!==0)return c;for(ye=32;ye<f;ye++)if(xe.dyn_ltree[2*ye]!==0)return c;return o}(H)),re(H,H.l_desc),re(H,H.d_desc),ae=function(xe){var ye;for(U(xe,xe.dyn_ltree,xe.l_desc.max_code),U(xe,xe.dyn_dtree,xe.d_desc.max_code),re(xe,xe.bl_desc),ye=x-1;3<=ye&&xe.bl_tree[2*T[ye]+1]===0;ye--);return xe.opt_len+=3*(ye+1)+5+5+4,ye}(H),he=H.opt_len+3+7>>>3,(ee=H.static_len+3+7>>>3)<=he&&(he=ee)):he=ee=J+5,J+4<=he&&oe!==-1?K(H,oe,J,le):H.strategy===4||ee===he?(z(H,2+(le?1:0),3),W(H,A,E)):(z(H,4+(le?1:0),3),function(xe,ye,Ce,Ie){var Ze;for(z(xe,ye-257,5),z(xe,Ce-1,5),z(xe,Ie-4,4),Ze=0;Ze<Ie;Ze++)z(xe,xe.bl_tree[2*T[Ze]+1],3);se(xe,xe.dyn_ltree,ye-1),se(xe,xe.dyn_dtree,Ce-1)}(H,H.l_desc.max_code+1,H.d_desc.max_code+1,ae+1),W(H,H.dyn_ltree,H.dyn_dtree)),ie(H),le&&Q(H)},a._tr_tally=function(H,oe,J){return H.pending_buf[H.d_buf+2*H.last_lit]=oe>>>8&255,H.pending_buf[H.d_buf+2*H.last_lit+1]=255&oe,H.pending_buf[H.l_buf+H.last_lit]=255&J,H.last_lit++,oe===0?H.dyn_ltree[2*J]++:(H.matches++,oe--,H.dyn_ltree[2*(P[J]+f+1)]++,H.dyn_dtree[2*C(oe)]++),H.last_lit===H.lit_bufsize-1},a._tr_align=function(H){z(H,2,3),V(H,b,A),function(oe){oe.bi_valid===16?(k(oe,oe.bi_buf),oe.bi_buf=0,oe.bi_valid=0):8<=oe.bi_valid&&(oe.pending_buf[oe.pending++]=255&oe.bi_buf,oe.bi_buf>>=8,oe.bi_valid-=8)}(H)}},{"../utils/common":41}],53:[function(r,n,a){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,n,a){(function(i){(function(o,c){if(!o.setImmediate){var l,u,d,f,h=1,m={},x=!1,p=o.document,g=Object.getPrototypeOf&&Object.getPrototypeOf(o);g=g&&g.setTimeout?g:o,l={}.toString.call(o.process)==="[object process]"?function(_){process.nextTick(function(){y(_)})}:function(){if(o.postMessage&&!o.importScripts){var _=!0,w=o.onmessage;return o.onmessage=function(){_=!1},o.postMessage("","*"),o.onmessage=w,_}}()?(f="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",b,!1):o.attachEvent("onmessage",b),function(_){o.postMessage(f+_,"*")}):o.MessageChannel?((d=new MessageChannel).port1.onmessage=function(_){y(_.data)},function(_){d.port2.postMessage(_)}):p&&"onreadystatechange"in p.createElement("script")?(u=p.documentElement,function(_){var w=p.createElement("script");w.onreadystatechange=function(){y(_),w.onreadystatechange=null,u.removeChild(w),w=null},u.appendChild(w)}):function(_){setTimeout(y,0,_)},g.setImmediate=function(_){typeof _!="function"&&(_=new Function(""+_));for(var w=new Array(arguments.length-1),j=0;j<w.length;j++)w[j]=arguments[j+1];var N={callback:_,args:w};return m[h]=N,l(h),h++},g.clearImmediate=v}function v(_){delete m[_]}function y(_){if(x)setTimeout(y,0,_);else{var w=m[_];if(w){x=!0;try{(function(j){var N=j.callback,D=j.args;switch(D.length){case 0:N();break;case 1:N(D[0]);break;case 2:N(D[0],D[1]);break;case 3:N(D[0],D[1],D[2]);break;default:N.apply(c,D)}})(w)}finally{v(_),x=!1}}}}function b(_){_.source===o&&typeof _.data=="string"&&_.data.indexOf(f)===0&&y(+_.data.slice(f.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof gt<"u"?gt:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(aB);var DPe=aB.exports,SPe=Pg,EPe=DPe;$h.openArrayBuffer=TPe;$h.splitPath=CPe;$h.joinPath=APe;function TPe(e){return EPe.loadAsync(e).then(function(t){function r(o){return t.file(o)!==null}function n(o,c){return t.file(o).async("uint8array").then(function(l){if(c==="base64")return SPe.fromByteArray(l);if(c){var u=new TextDecoder(c);return u.decode(l)}else return l})}function a(o,c){t.file(o,c)}function i(){return t.generateAsync({type:"arraybuffer"})}return{exists:r,read:n,write:a,toArrayBuffer:i}})}function CPe(e){var t=e.lastIndexOf("/");return t===-1?{dirname:"",basename:e}:{dirname:e.substring(0,t),basename:e.substring(t+1)}}function APe(){var e=Array.prototype.filter.call(arguments,function(r){return r}),t=[];return e.forEach(function(r){/^\//.test(r)?t=[r]:t.push(r)}),t.join("/")}var _N={},Bs={},Mu={},Ig=Or;Mu.Element=Bu;Mu.element=function(e,t,r){return new Bu(e,t,r)};Mu.text=function(e){return{type:"text",value:e}};var iB=Mu.emptyElement={first:function(){return null},firstOrEmpty:function(){return iB},attributes:{},children:[]};function Bu(e,t,r){this.type="element",this.name=e,this.attributes=t||{},this.children=r||[]}Bu.prototype.first=function(e){return Ig.find(this.children,function(t){return t.name===e})};Bu.prototype.firstOrEmpty=function(e){return this.first(e)||iB};Bu.prototype.getElementsByTagName=function(e){var t=Ig.filter(this.children,function(r){return r.name===e});return sB(t)};Bu.prototype.text=function(){if(this.children.length===0)return"";if(this.children.length!==1||this.children[0].type!=="text")throw new Error("Not implemented");return this.children[0].value};var kPe={getElementsByTagName:function(e){return sB(Ig.flatten(this.map(function(t){return t.getElementsByTagName(e)},!0)))}};function sB(e){return Ig.extend(e,kPe)}var oB={},jN={},Ug={},ts={},Ls={};function FPe(e,t,r){if(r===void 0&&(r=Array.prototype),e&&typeof r.find=="function")return r.find.call(e,t);for(var n=0;n<e.length;n++)if(Object.prototype.hasOwnProperty.call(e,n)){var a=e[n];if(t.call(void 0,a,n,e))return a}}function NN(e,t){return t===void 0&&(t=Object),t&&typeof t.freeze=="function"?t.freeze(e):e}function OPe(e,t){if(e===null||typeof e!="object")throw new TypeError("target is not an object");for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}var cB=NN({HTML:"text/html",isHTML:function(e){return e===cB.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),lB=NN({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(e){return e===lB.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});Ls.assign=OPe;Ls.find=FPe;Ls.freeze=NN;Ls.MIME_TYPE=cB;Ls.NAMESPACE=lB;var uB=Ls,Vi=uB.find,Zf=uB.NAMESPACE;function PPe(e){return e!==""}function IPe(e){return e?e.split(/[\t\n\f\r ]+/).filter(PPe):[]}function UPe(e,t){return e.hasOwnProperty(t)||(e[t]=!0),e}function A3(e){if(!e)return[];var t=IPe(e);return Object.keys(t.reduce(UPe,{}))}function RPe(e){return function(t){return e&&e.indexOf(t)!==-1}}function Wh(e,t){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}function da(e,t){var r=e.prototype;if(!(r instanceof t)){let n=function(){};n.prototype=t.prototype,n=new n,Wh(r,n),e.prototype=r=n}r.constructor!=e&&(typeof e!="function"&&console.error("unknown Class:"+e),r.constructor=e)}var fa={},ai=fa.ELEMENT_NODE=1,nu=fa.ATTRIBUTE_NODE=2,Ax=fa.TEXT_NODE=3,dB=fa.CDATA_SECTION_NODE=4,fB=fa.ENTITY_REFERENCE_NODE=5,MPe=fa.ENTITY_NODE=6,hB=fa.PROCESSING_INSTRUCTION_NODE=7,mB=fa.COMMENT_NODE=8,pB=fa.DOCUMENT_NODE=9,xB=fa.DOCUMENT_TYPE_NODE=10,As=fa.DOCUMENT_FRAGMENT_NODE=11,BPe=fa.NOTATION_NODE=12,Bn={},nn={};Bn.INDEX_SIZE_ERR=(nn[1]="Index size error",1);Bn.DOMSTRING_SIZE_ERR=(nn[2]="DOMString size error",2);var ea=Bn.HIERARCHY_REQUEST_ERR=(nn[3]="Hierarchy request error",3);Bn.WRONG_DOCUMENT_ERR=(nn[4]="Wrong document",4);Bn.INVALID_CHARACTER_ERR=(nn[5]="Invalid character",5);Bn.NO_DATA_ALLOWED_ERR=(nn[6]="No data allowed",6);Bn.NO_MODIFICATION_ALLOWED_ERR=(nn[7]="No modification allowed",7);var gB=Bn.NOT_FOUND_ERR=(nn[8]="Not found",8);Bn.NOT_SUPPORTED_ERR=(nn[9]="Not supported",9);var k3=Bn.INUSE_ATTRIBUTE_ERR=(nn[10]="Attribute in use",10);Bn.INVALID_STATE_ERR=(nn[11]="Invalid state",11);Bn.SYNTAX_ERR=(nn[12]="Syntax error",12);Bn.INVALID_MODIFICATION_ERR=(nn[13]="Invalid modification",13);Bn.NAMESPACE_ERR=(nn[14]="Invalid namespace",14);Bn.INVALID_ACCESS_ERR=(nn[15]="Invalid access",15);function Ar(e,t){if(t instanceof Error)var r=t;else r=this,Error.call(this,nn[e]),this.message=nn[e],Error.captureStackTrace&&Error.captureStackTrace(this,Ar);return r.code=e,t&&(this.message=this.message+": "+t),r}Ar.prototype=Error.prototype;Wh(Bn,Ar);function _s(){}_s.prototype={length:0,item:function(e){return e>=0&&e<this.length?this[e]:null},toString:function(e,t){for(var r=[],n=0;n<this.length;n++)ul(this[n],r,e,t);return r.join("")},filter:function(e){return Array.prototype.filter.call(this,e)},indexOf:function(e){return Array.prototype.indexOf.call(this,e)}};function au(e,t){this._node=e,this._refresh=t,DN(this)}function DN(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!==t){var r=e._refresh(e._node);if(CB(e,"length",r.length),!e.$$length||r.length<e.$$length)for(var n=r.length;n in e;n++)Object.prototype.hasOwnProperty.call(e,n)&&delete e[n];Wh(r,e),e._inc=t}}au.prototype.item=function(e){return DN(this),this[e]||null};da(au,_s);function kx(){}function vB(e,t){for(var r=e.length;r--;)if(e[r]===t)return r}function F3(e,t,r,n){if(n?t[vB(t,n)]=r:t[t.length++]=r,e){r.ownerElement=e;var a=e.ownerDocument;a&&(n&&wB(a,e,n),LPe(a,e,r))}}function O3(e,t,r){var n=vB(t,r);if(n>=0){for(var a=t.length-1;n<a;)t[n]=t[++n];if(t.length=a,e){var i=e.ownerDocument;i&&(wB(i,e,r),r.ownerElement=null)}}else throw new Ar(gB,new Error(e.tagName+"@"+r))}kx.prototype={length:0,item:_s.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var r=this[t];if(r.nodeName==e)return r}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new Ar(k3);var r=this.getNamedItem(e.nodeName);return F3(this._ownerElement,this,e,r),r},setNamedItemNS:function(e){var t=e.ownerElement,r;if(t&&t!=this._ownerElement)throw new Ar(k3);return r=this.getNamedItemNS(e.namespaceURI,e.localName),F3(this._ownerElement,this,e,r),r},removeNamedItem:function(e){var t=this.getNamedItem(e);return O3(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var r=this.getNamedItemNS(e,t);return O3(this._ownerElement,this,r),r},getNamedItemNS:function(e,t){for(var r=this.length;r--;){var n=this[r];if(n.localName==t&&n.namespaceURI==e)return n}return null}};function yB(){}yB.prototype={hasFeature:function(e,t){return!0},createDocument:function(e,t,r){var n=new zh;if(n.implementation=this,n.childNodes=new _s,n.doctype=r||null,r&&n.appendChild(r),t){var a=n.createElementNS(e,t);n.appendChild(a)}return n},createDocumentType:function(e,t,r){var n=new Rg;return n.name=e,n.nodeName=e,n.publicId=t||"",n.systemId=r||"",n}};function qt(){}qt.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return Fx(this,e,t)},replaceChild:function(e,t){Fx(this,e,t,jB),t&&this.removeChild(t)},removeChild:function(e){return _B(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(e){return W2(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==Ax&&e.nodeType==Ax?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var r=t._nsMap;if(r){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)&&r[n]===e)return n}t=t.nodeType==nu?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var r=t._nsMap;if(r&&Object.prototype.hasOwnProperty.call(r,e))return r[e];t=t.nodeType==nu?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){var t=this.lookupPrefix(e);return t==null}};function bB(e){return e=="<"&&"&lt;"||e==">"&&"&gt;"||e=="&"&&"&amp;"||e=='"'&&"&quot;"||"&#"+e.charCodeAt()+";"}Wh(fa,qt);Wh(fa,qt.prototype);function Jf(e,t){if(t(e))return!0;if(e=e.firstChild)do if(Jf(e,t))return!0;while(e=e.nextSibling)}function zh(){this.ownerDocument=this}function LPe(e,t,r){e&&e._inc++;var n=r.namespaceURI;n===Zf.XMLNS&&(t._nsMap[r.prefix?r.localName:""]=r.value)}function wB(e,t,r,n){e&&e._inc++;var a=r.namespaceURI;a===Zf.XMLNS&&delete t._nsMap[r.prefix?r.localName:""]}function SN(e,t,r){if(e&&e._inc){e._inc++;var n=t.childNodes;if(r)n[n.length++]=r;else{for(var a=t.firstChild,i=0;a;)n[i++]=a,a=a.nextSibling;n.length=i,delete n[n.length]}}}function _B(e,t){var r=t.previousSibling,n=t.nextSibling;return r?r.nextSibling=n:e.firstChild=n,n?n.previousSibling=r:e.lastChild=r,t.parentNode=null,t.previousSibling=null,t.nextSibling=null,SN(e.ownerDocument,e),t}function $Pe(e){return e&&(e.nodeType===qt.DOCUMENT_NODE||e.nodeType===qt.DOCUMENT_FRAGMENT_NODE||e.nodeType===qt.ELEMENT_NODE)}function WPe(e){return e&&(Gi(e)||EN(e)||ks(e)||e.nodeType===qt.DOCUMENT_FRAGMENT_NODE||e.nodeType===qt.COMMENT_NODE||e.nodeType===qt.PROCESSING_INSTRUCTION_NODE)}function ks(e){return e&&e.nodeType===qt.DOCUMENT_TYPE_NODE}function Gi(e){return e&&e.nodeType===qt.ELEMENT_NODE}function EN(e){return e&&e.nodeType===qt.TEXT_NODE}function P3(e,t){var r=e.childNodes||[];if(Vi(r,Gi)||ks(t))return!1;var n=Vi(r,ks);return!(t&&n&&r.indexOf(n)>r.indexOf(t))}function I3(e,t){var r=e.childNodes||[];function n(i){return Gi(i)&&i!==t}if(Vi(r,n))return!1;var a=Vi(r,ks);return!(t&&a&&r.indexOf(a)>r.indexOf(t))}function zPe(e,t,r){if(!$Pe(e))throw new Ar(ea,"Unexpected parent node type "+e.nodeType);if(r&&r.parentNode!==e)throw new Ar(gB,"child not in parent");if(!WPe(t)||ks(t)&&e.nodeType!==qt.DOCUMENT_NODE)throw new Ar(ea,"Unexpected node type "+t.nodeType+" for parent node type "+e.nodeType)}function qPe(e,t,r){var n=e.childNodes||[],a=t.childNodes||[];if(t.nodeType===qt.DOCUMENT_FRAGMENT_NODE){var i=a.filter(Gi);if(i.length>1||Vi(a,EN))throw new Ar(ea,"More than one element or text in fragment");if(i.length===1&&!P3(e,r))throw new Ar(ea,"Element in fragment can not be inserted before doctype")}if(Gi(t)&&!P3(e,r))throw new Ar(ea,"Only one element can be added and only after doctype");if(ks(t)){if(Vi(n,ks))throw new Ar(ea,"Only one doctype is allowed");var o=Vi(n,Gi);if(r&&n.indexOf(o)<n.indexOf(r))throw new Ar(ea,"Doctype can only be inserted before an element");if(!r&&o)throw new Ar(ea,"Doctype can not be appended since element is present")}}function jB(e,t,r){var n=e.childNodes||[],a=t.childNodes||[];if(t.nodeType===qt.DOCUMENT_FRAGMENT_NODE){var i=a.filter(Gi);if(i.length>1||Vi(a,EN))throw new Ar(ea,"More than one element or text in fragment");if(i.length===1&&!I3(e,r))throw new Ar(ea,"Element in fragment can not be inserted before doctype")}if(Gi(t)&&!I3(e,r))throw new Ar(ea,"Only one element can be added and only after doctype");if(ks(t)){if(Vi(n,function(l){return ks(l)&&l!==r}))throw new Ar(ea,"Only one doctype is allowed");var o=Vi(n,Gi);if(r&&n.indexOf(o)<n.indexOf(r))throw new Ar(ea,"Doctype can only be inserted before an element")}}function Fx(e,t,r,n){zPe(e,t,r),e.nodeType===qt.DOCUMENT_NODE&&(n||qPe)(e,t,r);var a=t.parentNode;if(a&&a.removeChild(t),t.nodeType===As){var i=t.firstChild;if(i==null)return t;var o=t.lastChild}else i=o=t;var c=r?r.previousSibling:e.lastChild;i.previousSibling=c,o.nextSibling=r,c?c.nextSibling=i:e.firstChild=i,r==null?e.lastChild=o:r.previousSibling=o;do{i.parentNode=e;var l=e.ownerDocument||e;Qf(i,l)}while(i!==o&&(i=i.nextSibling));return SN(e.ownerDocument||e,e),t.nodeType==As&&(t.firstChild=t.lastChild=null),t}function Qf(e,t){if(e.ownerDocument!==t){if(e.ownerDocument=t,e.nodeType===ai&&e.attributes)for(var r=0;r<e.attributes.length;r++){var n=e.attributes.item(r);n&&(n.ownerDocument=t)}for(var a=e.firstChild;a;)Qf(a,t),a=a.nextSibling}}function HPe(e,t){t.parentNode&&t.parentNode.removeChild(t),t.parentNode=e,t.previousSibling=e.lastChild,t.nextSibling=null,t.previousSibling?t.previousSibling.nextSibling=t:e.firstChild=t,e.lastChild=t,SN(e.ownerDocument,e,t);var r=e.ownerDocument||e;return Qf(t,r),t}zh.prototype={nodeName:"#document",nodeType:pB,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==As){for(var r=e.firstChild;r;){var n=r.nextSibling;this.insertBefore(r,t),r=n}return e}return Fx(this,e,t),Qf(e,this),this.documentElement===null&&e.nodeType===ai&&(this.documentElement=e),e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),_B(this,e)},replaceChild:function(e,t){Fx(this,e,t,jB),Qf(e,this),t&&this.removeChild(t),Gi(e)&&(this.documentElement=e)},importNode:function(e,t){return TB(this,e,t)},getElementById:function(e){var t=null;return Jf(this.documentElement,function(r){if(r.nodeType==ai&&r.getAttribute("id")==e)return t=r,!0}),t},getElementsByClassName:function(e){var t=A3(e);return new au(this,function(r){var n=[];return t.length>0&&Jf(r.documentElement,function(a){if(a!==r&&a.nodeType===ai){var i=a.getAttribute("class");if(i){var o=e===i;if(!o){var c=A3(i);o=t.every(RPe(c))}o&&n.push(a)}}}),n})},createElement:function(e){var t=new jc;t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.localName=e,t.childNodes=new _s;var r=t.attributes=new kx;return r._ownerElement=t,t},createDocumentFragment:function(){var e=new Mg;return e.ownerDocument=this,e.childNodes=new _s,e},createTextNode:function(e){var t=new TN;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new CN;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new AN;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var r=new FN;return r.ownerDocument=this,r.tagName=r.nodeName=r.target=e,r.nodeValue=r.data=t,r},createAttribute:function(e){var t=new Ox;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new kN;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var r=new jc,n=t.split(":"),a=r.attributes=new kx;return r.childNodes=new _s,r.ownerDocument=this,r.nodeName=t,r.tagName=t,r.namespaceURI=e,n.length==2?(r.prefix=n[0],r.localName=n[1]):r.localName=t,a._ownerElement=r,r},createAttributeNS:function(e,t){var r=new Ox,n=t.split(":");return r.ownerDocument=this,r.nodeName=t,r.name=t,r.namespaceURI=e,r.specified=!0,n.length==2?(r.prefix=n[0],r.localName=n[1]):r.localName=t,r}};da(zh,qt);function jc(){this._nsMap={}}jc.prototype={nodeType:ai,hasAttribute:function(e){return this.getAttributeNode(e)!=null},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var r=this.ownerDocument.createAttribute(e);r.value=r.nodeValue=""+t,this.setAttributeNode(r)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===As?this.insertBefore(e,null):HPe(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var r=this.getAttributeNodeNS(e,t);r&&this.removeAttributeNode(r)},hasAttributeNS:function(e,t){return this.getAttributeNodeNS(e,t)!=null},getAttributeNS:function(e,t){var r=this.getAttributeNodeNS(e,t);return r&&r.value||""},setAttributeNS:function(e,t,r){var n=this.ownerDocument.createAttributeNS(e,t);n.value=n.nodeValue=""+r,this.setAttributeNode(n)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new au(this,function(t){var r=[];return Jf(t,function(n){n!==t&&n.nodeType==ai&&(e==="*"||n.tagName==e)&&r.push(n)}),r})},getElementsByTagNameNS:function(e,t){return new au(this,function(r){var n=[];return Jf(r,function(a){a!==r&&a.nodeType===ai&&(e==="*"||a.namespaceURI===e)&&(t==="*"||a.localName==t)&&n.push(a)}),n})}};zh.prototype.getElementsByTagName=jc.prototype.getElementsByTagName;zh.prototype.getElementsByTagNameNS=jc.prototype.getElementsByTagNameNS;da(jc,qt);function Ox(){}Ox.prototype.nodeType=nu;da(Ox,qt);function qh(){}qh.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(nn[ea])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,r){var n=this.data.substring(0,e),a=this.data.substring(e+t);r=n+r+a,this.nodeValue=this.data=r,this.length=r.length}};da(qh,qt);function TN(){}TN.prototype={nodeName:"#text",nodeType:Ax,splitText:function(e){var t=this.data,r=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var n=this.ownerDocument.createTextNode(r);return this.parentNode&&this.parentNode.insertBefore(n,this.nextSibling),n}};da(TN,qh);function CN(){}CN.prototype={nodeName:"#comment",nodeType:mB};da(CN,qh);function AN(){}AN.prototype={nodeName:"#cdata-section",nodeType:dB};da(AN,qh);function Rg(){}Rg.prototype.nodeType=xB;da(Rg,qt);function NB(){}NB.prototype.nodeType=BPe;da(NB,qt);function DB(){}DB.prototype.nodeType=MPe;da(DB,qt);function kN(){}kN.prototype.nodeType=fB;da(kN,qt);function Mg(){}Mg.prototype.nodeName="#document-fragment";Mg.prototype.nodeType=As;da(Mg,qt);function FN(){}FN.prototype.nodeType=hB;da(FN,qt);function SB(){}SB.prototype.serializeToString=function(e,t,r){return EB.call(e,t,r)};qt.prototype.toString=EB;function EB(e,t){var r=[],n=this.nodeType==9&&this.documentElement||this,a=n.prefix,i=n.namespaceURI;if(i&&a==null){var a=n.lookupPrefix(i);if(a==null)var o=[{namespace:i,prefix:null}]}return ul(this,r,e,t,o),r.join("")}function U3(e,t,r){var n=e.prefix||"",a=e.namespaceURI;if(!a||n==="xml"&&a===Zf.XML||a===Zf.XMLNS)return!1;for(var i=r.length;i--;){var o=r[i];if(o.prefix===n)return o.namespace!==a}return!0}function Jy(e,t,r){e.push(" ",t,'="',r.replace(/[<>&"\t\n\r]/g,bB),'"')}function ul(e,t,r,n,a){if(a||(a=[]),n)if(e=n(e),e){if(typeof e=="string"){t.push(e);return}}else return;switch(e.nodeType){case ai:var i=e.attributes,o=i.length,v=e.firstChild,c=e.tagName;r=Zf.isHTML(e.namespaceURI)||r;var l=c;if(!r&&!e.prefix&&e.namespaceURI){for(var u,d=0;d<i.length;d++)if(i.item(d).name==="xmlns"){u=i.item(d).value;break}if(!u)for(var f=a.length-1;f>=0;f--){var h=a[f];if(h.prefix===""&&h.namespace===e.namespaceURI){u=h.namespace;break}}if(u!==e.namespaceURI)for(var f=a.length-1;f>=0;f--){var h=a[f];if(h.namespace===e.namespaceURI){h.prefix&&(l=h.prefix+":"+c);break}}}t.push("<",l);for(var m=0;m<o;m++){var x=i.item(m);x.prefix=="xmlns"?a.push({prefix:x.localName,namespace:x.value}):x.nodeName=="xmlns"&&a.push({prefix:"",namespace:x.value})}for(var m=0;m<o;m++){var x=i.item(m);if(U3(x,r,a)){var p=x.prefix||"",g=x.namespaceURI;Jy(t,p?"xmlns:"+p:"xmlns",g),a.push({prefix:p,namespace:g})}ul(x,t,r,n,a)}if(c===l&&U3(e,r,a)){var p=e.prefix||"",g=e.namespaceURI;Jy(t,p?"xmlns:"+p:"xmlns",g),a.push({prefix:p,namespace:g})}if(v||r&&!/^(?:meta|link|img|br|hr|input)$/i.test(c)){if(t.push(">"),r&&/^script$/i.test(c))for(;v;)v.data?t.push(v.data):ul(v,t,r,n,a.slice()),v=v.nextSibling;else for(;v;)ul(v,t,r,n,a.slice()),v=v.nextSibling;t.push("</",l,">")}else t.push("/>");return;case pB:case As:for(var v=e.firstChild;v;)ul(v,t,r,n,a.slice()),v=v.nextSibling;return;case nu:return Jy(t,e.name,e.value);case Ax:return t.push(e.data.replace(/[<&>]/g,bB));case dB:return t.push("<![CDATA[",e.data,"]]>");case mB:return t.push("<!--",e.data,"-->");case xB:var y=e.publicId,b=e.systemId;if(t.push("<!DOCTYPE ",e.name),y)t.push(" PUBLIC ",y),b&&b!="."&&t.push(" ",b),t.push(">");else if(b&&b!=".")t.push(" SYSTEM ",b,">");else{var _=e.internalSubset;_&&t.push(" [",_,"]"),t.push(">")}return;case hB:return t.push("<?",e.target," ",e.data,"?>");case fB:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function TB(e,t,r){var n;switch(t.nodeType){case ai:n=t.cloneNode(!1),n.ownerDocument=e;case As:break;case nu:r=!0;break}if(n||(n=t.cloneNode(!1)),n.ownerDocument=e,n.parentNode=null,r)for(var a=t.firstChild;a;)n.appendChild(TB(e,a,r)),a=a.nextSibling;return n}function W2(e,t,r){var n=new t.constructor;for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var i=t[a];typeof i!="object"&&i!=n[a]&&(n[a]=i)}switch(t.childNodes&&(n.childNodes=new _s),n.ownerDocument=e,n.nodeType){case ai:var o=t.attributes,c=n.attributes=new kx,l=o.length;c._ownerElement=n;for(var u=0;u<l;u++)n.setAttributeNode(W2(e,o.item(u),!0));break;case nu:r=!0}if(r)for(var d=t.firstChild;d;)n.appendChild(W2(e,d,r)),d=d.nextSibling;return n}function CB(e,t,r){e[t]=r}try{if(Object.defineProperty){let e=function(t){switch(t.nodeType){case ai:case As:var r=[];for(t=t.firstChild;t;)t.nodeType!==7&&t.nodeType!==8&&r.push(e(t)),t=t.nextSibling;return r.join("");default:return t.nodeValue}};Object.defineProperty(au.prototype,"length",{get:function(){return DN(this),this.$$length}}),Object.defineProperty(qt.prototype,"textContent",{get:function(){return e(this)},set:function(t){switch(this.nodeType){case ai:case As:for(;this.firstChild;)this.removeChild(this.firstChild);(t||String(t))&&this.appendChild(this.ownerDocument.createTextNode(t));break;default:this.data=t,this.value=t,this.nodeValue=t}}}),CB=function(t,r,n){t["$$"+r]=n}}}catch{}ts.DocumentType=Rg;ts.DOMException=Ar;ts.DOMImplementation=yB;ts.Element=jc;ts.Node=qt;ts.NodeList=_s;ts.XMLSerializer=SB;var Bg={},AB={};(function(e){var t=Ls.freeze;e.XML_ENTITIES=t({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),e.HTML_ENTITIES=t({Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:"",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",AMP:"&",amp:"&",And:"",and:"",andand:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsd:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",ap:"",apacir:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",Barwed:"",barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",Because:"",because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxDL:"",boxDl:"",boxdL:"",boxdl:"",boxDR:"",boxDr:"",boxdR:"",boxdr:"",boxH:"",boxh:"",boxHD:"",boxHd:"",boxhD:"",boxhd:"",boxHU:"",boxHu:"",boxhU:"",boxhu:"",boxminus:"",boxplus:"",boxtimes:"",boxUL:"",boxUl:"",boxuL:"",boxul:"",boxUR:"",boxUr:"",boxuR:"",boxur:"",boxV:"",boxv:"",boxVH:"",boxVh:"",boxvH:"",boxvh:"",boxVL:"",boxVl:"",boxvL:"",boxvl:"",boxVR:"",boxVr:"",boxvR:"",boxvr:"",bprime:"",Breve:"",breve:"",brvbar:"",Bscr:"",bscr:"",bsemi:"",bsim:"",bsime:"",bsol:"\\",bsolb:"",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",Cap:"",cap:"",capand:"",capbrcup:"",capcap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",CenterDot:"",centerdot:"",Cfr:"",cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",cir:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",Colon:"",colon:":",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",Conint:"",conint:"",ContourIntegral:"",Copf:"",copf:"",coprod:"",Coproduct:"",COPY:"",copy:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",Cross:"",cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",Cup:"",cup:"",cupbrcap:"",CupCap:"",cupcap:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",Dagger:"",dagger:"",daleth:"",Darr:"",dArr:"",darr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",DD:"",dd:"",ddagger:"",ddarr:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",Diamond:"",diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrow:"",Downarrow:"",downarrow:"",DownArrowBar:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVector:"",DownLeftVectorBar:"",DownRightTeeVector:"",DownRightVector:"",DownRightVectorBar:"",DownTee:"",DownTeeArrow:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",ecir:"",Ecirc:"",ecirc:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",eDot:"",edot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp:"",emsp13:"",emsp14:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",Escr:"",escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",ExponentialE:"",exponentiale:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",ForAll:"",forall:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",Fscr:"",fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:"",gdot:"",gE:"",ge:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",ges:"",gescc:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",Gg:"",gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gl:"",gla:"",glE:"",glj:"",gnap:"",gnapprox:"",gnE:"",gne:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",Gt:"",GT:">",gt:">",gtcc:"",gtcir:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",hArr:"",harr:"",harrcir:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",Hfr:"",hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",Hopf:"",hopf:"",horbar:"",HorizontalLine:"",Hscr:"",hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",Ifr:"",ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Im:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",imof:"",imped:"",Implies:"",in:"",incare:"",infin:"",infintie:"",inodot:"",Int:"",int:"",intcal:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",Iscr:"",iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",Lang:"",lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",Larr:"",lArr:"",larr:"",larrb:"",larrbfs:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",lat:"",lAtail:"",latail:"",late:"",lates:"",lBarr:"",lbarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",lE:"",le:"",LeftAngleBracket:"",LeftArrow:"",Leftarrow:"",leftarrow:"",LeftArrowBar:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVector:"",LeftDownVectorBar:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTee:"",LeftTeeArrow:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangle:"",LeftTriangleBar:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVector:"",LeftUpVectorBar:"",LeftVector:"",LeftVectorBar:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",les:"",lescc:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",Ll:"",ll:"",llarr:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoust:"",lmoustache:"",lnap:"",lnapprox:"",lnE:"",lne:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",LongLeftArrow:"",Longleftarrow:"",longleftarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longleftrightarrow:"",longmapsto:"",LongRightArrow:"",Longrightarrow:"",longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",Lscr:"",lscr:"",Lsh:"",lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",Lt:"",LT:"<",lt:"<",ltcc:"",ltcir:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",mid:"",midast:"*",midcir:"",middot:"",minus:"",minusb:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",Mscr:"",mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natur:"",natural:"",naturals:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",ne:"",nearhk:"",neArr:"",nearr:"",nearrow:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:`
`,nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nhArr:"",nharr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlArr:"",nlarr:"",nldr:"",nlE:"",nle:"",nLeftarrow:"",nleftarrow:"",nLeftrightarrow:"",nleftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",Nopf:"",nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangle:"",NotLeftTriangleBar:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangle:"",NotRightTriangleBar:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",npar:"",nparallel:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",npre:"",nprec:"",npreceq:"",nrArr:"",nrarr:"",nrarrc:"",nrarrw:"",nRightarrow:"",nrightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nVDash:"",nVdash:"",nvDash:"",nvdash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwArr:"",nwarr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",ocir:"",Ocirc:"",ocirc:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",Or:"",or:"",orarr:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",Otimes:"",otimes:"",otimesas:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",par:"",para:"",parallel:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:"",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plus:"+",plusacir:"",plusb:"",pluscir:"",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",Popf:"",popf:"",pound:"",Pr:"",pr:"",prap:"",prcue:"",prE:"",pre:"",prec:"",precapprox:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",precsim:"",Prime:"",prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportion:"",Proportional:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",Qopf:"",qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",QUOT:'"',quot:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",Rang:"",rang:"",rangd:"",range:"",rangle:"",raquo:"",Rarr:"",rArr:"",rarr:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",rAtail:"",ratail:"",ratio:"",rationals:"",RBarr:"",rBarr:"",rbarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:"",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",Re:"",real:"",realine:"",realpart:"",reals:"",rect:"",REG:"",reg:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",Rfr:"",rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrow:"",Rightarrow:"",rightarrow:"",RightArrowBar:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVector:"",RightDownVectorBar:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTee:"",RightTeeArrow:"",RightTeeVector:"",rightthreetimes:"",RightTriangle:"",RightTriangleBar:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVector:"",RightUpVectorBar:"",RightVector:"",RightVectorBar:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoust:"",rmoustache:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",Ropf:"",ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",Rscr:"",rscr:"",Rsh:"",rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",Sc:"",sc:"",scap:"",Scaron:"",scaron:"",sccue:"",scE:"",sce:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdot:"",sdotb:"",sdote:"",searhk:"",seArr:"",searr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",sol:"/",solb:"",solbar:"",Sopf:"",sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",squ:"",Square:"",square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",Sub:"",sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",Subset:"",subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succ:"",succapprox:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",Sum:"",sum:"",sung:"",Sup:"",sup:"",sup1:"",sup2:"",sup3:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",Supset:"",supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swArr:"",swarr:"",swarrow:"",swnwar:"",szlig:"",Tab:"	",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",Therefore:"",therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",thinsp:"",ThinSpace:"",thkap:"",thksim:"",THORN:"",thorn:"",Tilde:"",tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",times:"",timesb:"",timesbar:"",timesd:"",tint:"",toea:"",top:"",topbot:"",topcir:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",TRADE:"",trade:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",Uacute:"",uacute:"",Uarr:"",uArr:"",uarr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrow:"",Uparrow:"",uparrow:"",UpArrowBar:"",UpArrowDownArrow:"",UpDownArrow:"",Updownarrow:"",updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",Upsi:"",upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTee:"",UpTeeArrow:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",vArr:"",varr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",Vbar:"",vBar:"",vBarv:"",Vcy:"",vcy:"",VDash:"",Vdash:"",vDash:"",vdash:"",Vdashl:"",Vee:"",vee:"",veebar:"",veeeq:"",vellip:"",Verbar:"",verbar:"|",Vert:"",vert:"|",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",Wedge:"",wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xhArr:"",xharr:"",Xi:"",xi:"",xlArr:"",xlarr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrArr:"",xrarr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",Yuml:"",yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",Zfr:"",zfr:"",ZHcy:"",zhcy:"",zigrarr:"",Zopf:"",zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""}),e.entityMap=e.HTML_ENTITIES})(AB);var ON={},eh=Ls.NAMESPACE,z2=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,R3=new RegExp("[\\-\\.0-9"+z2.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),M3=new RegExp("^"+z2.source+R3.source+"*(?::"+z2.source+R3.source+"*)?$"),od=0,zs=1,Yc=2,cd=3,Zc=4,Jc=5,ld=6,Cm=7;function iu(e,t){this.message=e,this.locator=t,Error.captureStackTrace&&Error.captureStackTrace(this,iu)}iu.prototype=new Error;iu.prototype.name=iu.name;function kB(){}kB.prototype={parse:function(e,t,r){var n=this.domBuilder;n.startDocument(),FB(t,t={}),VPe(e,t,r,n,this.errorHandler),n.endDocument()}};function VPe(e,t,r,n,a){function i(q){if(q>65535){q-=65536;var B=55296+(q>>10),O=56320+(q&1023);return String.fromCharCode(B,O)}else return String.fromCharCode(q)}function o(q){var B=q.slice(1,-1);return Object.hasOwnProperty.call(r,B)?r[B]:B.charAt(0)==="#"?i(parseInt(B.substr(1).replace("x","0x"))):(a.error("entity not found:"+q),q)}function c(q){if(q>p){var B=e.substring(p,q).replace(/&#?\w+;/g,o);h&&l(p),n.characters(B,0,q-p),p=q}}function l(q,B){for(;q>=d&&(B=f.exec(e));)u=B.index,d=u+B[0].length,h.lineNumber++;h.columnNumber=q-u+1}for(var u=0,d=0,f=/.*(?:\r\n?|\n)|.*$/g,h=n.locator,m=[{currentNSMap:t}],x={},p=0;;){try{var g=e.indexOf("<",p);if(g<0){if(!e.substr(p).match(/^\s*$/)){var v=n.doc,y=v.createTextNode(e.substr(p));v.appendChild(y),n.currentElement=y}return}switch(g>p&&c(g),e.charAt(g+1)){case"/":var A=e.indexOf(">",g+3),b=e.substring(g+2,A).replace(/[ \t\n\r]+$/g,""),_=m.pop();A<0?(b=e.substring(g+2).replace(/[\s<].*/,""),a.error("end tag name: "+b+" is not complete:"+_.tagName),A=g+1+b.length):b.match(/\s</)&&(b=b.replace(/[\s<].*/,""),a.error("end tag name: "+b+" maybe not complete"),A=g+1+b.length);var w=_.localNSMap,j=_.tagName==b,N=j||_.tagName&&_.tagName.toLowerCase()==b.toLowerCase();if(N){if(n.endElement(_.uri,_.localName,b),w)for(var D in w)Object.prototype.hasOwnProperty.call(w,D)&&n.endPrefixMapping(D);j||a.fatalError("end tag name: "+b+" is not match the current start tagName:"+_.tagName)}else m.push(_);A++;break;case"?":h&&l(g),A=ZPe(e,g,n);break;case"!":h&&l(g),A=YPe(e,g,n,a);break;default:h&&l(g);var S=new OB,T=m[m.length-1].currentNSMap,A=GPe(e,g,S,T,o,a),E=S.length;if(!S.closed&&KPe(e,A,S.tagName,x)&&(S.closed=!0,r.nbsp||a.warning("unclosed xml attribute")),h&&E){for(var M=B3(h,{}),P=0;P<E;P++){var X=S[P];l(X.offset),X.locator=B3(h,{})}n.locator=M,L3(S,n,T)&&m.push(S),n.locator=h}else L3(S,n,T)&&m.push(S);eh.isHTML(S.uri)&&!S.closed?A=XPe(e,A,S.tagName,o,n):A++}}catch(q){if(q instanceof iu)throw q;a.error("element parse error: "+q),A=-1}A>p?p=A:c(Math.max(g,p)+1)}}function B3(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function GPe(e,t,r,n,a,i){function o(h,m,x){r.attributeNames.hasOwnProperty(h)&&i.fatalError("Attribute "+h+" redefined"),r.addValue(h,m.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,a),x)}for(var c,l,u=++t,d=od;;){var f=e.charAt(u);switch(f){case"=":if(d===zs)c=e.slice(t,u),d=cd;else if(d===Yc)d=cd;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(d===cd||d===zs)if(d===zs&&(i.warning('attribute value must after "="'),c=e.slice(t,u)),t=u+1,u=e.indexOf(f,t),u>0)l=e.slice(t,u),o(c,l,t-1),d=Jc;else throw new Error("attribute value no end '"+f+"' match");else if(d==Zc)l=e.slice(t,u),o(c,l,t),i.warning('attribute "'+c+'" missed start quot('+f+")!!"),t=u+1,d=Jc;else throw new Error('attribute value must after "="');break;case"/":switch(d){case od:r.setTagName(e.slice(t,u));case Jc:case ld:case Cm:d=Cm,r.closed=!0;case Zc:case zs:break;case Yc:r.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return i.error("unexpected end of input"),d==od&&r.setTagName(e.slice(t,u)),u;case">":switch(d){case od:r.setTagName(e.slice(t,u));case Jc:case ld:case Cm:break;case Zc:case zs:l=e.slice(t,u),l.slice(-1)==="/"&&(r.closed=!0,l=l.slice(0,-1));case Yc:d===Yc&&(l=c),d==Zc?(i.warning('attribute "'+l+'" missed quot(")!'),o(c,l,t)):((!eh.isHTML(n[""])||!l.match(/^(?:disabled|checked|selected)$/i))&&i.warning('attribute "'+l+'" missed value!! "'+l+'" instead!!'),o(l,l,t));break;case cd:throw new Error("attribute value missed!!")}return u;case"":f=" ";default:if(f<=" ")switch(d){case od:r.setTagName(e.slice(t,u)),d=ld;break;case zs:c=e.slice(t,u),d=Yc;break;case Zc:var l=e.slice(t,u);i.warning('attribute "'+l+'" missed quot(")!!'),o(c,l,t);case Jc:d=ld;break}else switch(d){case Yc:r.tagName,(!eh.isHTML(n[""])||!c.match(/^(?:disabled|checked|selected)$/i))&&i.warning('attribute "'+c+'" missed value!! "'+c+'" instead2!!'),o(c,c,t),t=u,d=zs;break;case Jc:i.warning('attribute space is required"'+c+'"!!');case ld:d=zs,t=u;break;case cd:d=Zc,t=u;break;case Cm:throw new Error("elements closed character '/' and '>' must be connected to")}}u++}}function L3(e,t,r){for(var n=e.tagName,a=null,f=e.length;f--;){var i=e[f],o=i.qName,c=i.value,h=o.indexOf(":");if(h>0)var l=i.prefix=o.slice(0,h),u=o.slice(h+1),d=l==="xmlns"&&u;else u=o,l=null,d=o==="xmlns"&&"";i.localName=u,d!==!1&&(a==null&&(a={},FB(r,r={})),r[d]=a[d]=c,i.uri=eh.XMLNS,t.startPrefixMapping(d,c))}for(var f=e.length;f--;){i=e[f];var l=i.prefix;l&&(l==="xml"&&(i.uri=eh.XML),l!=="xmlns"&&(i.uri=r[l||""]))}var h=n.indexOf(":");h>0?(l=e.prefix=n.slice(0,h),u=e.localName=n.slice(h+1)):(l=null,u=e.localName=n);var m=e.uri=r[l||""];if(t.startElement(m,u,n,e),e.closed){if(t.endElement(m,u,n),a)for(l in a)Object.prototype.hasOwnProperty.call(a,l)&&t.endPrefixMapping(l)}else return e.currentNSMap=r,e.localNSMap=a,!0}function XPe(e,t,r,n,a){if(/^(?:script|textarea)$/i.test(r)){var i=e.indexOf("</"+r+">",t),o=e.substring(t+1,i);if(/[&<]/.test(o))return/^script$/i.test(r)?(a.characters(o,0,o.length),i):(o=o.replace(/&#?\w+;/g,n),a.characters(o,0,o.length),i)}return t+1}function KPe(e,t,r,n){var a=n[r];return a==null&&(a=e.lastIndexOf("</"+r+">"),a<t&&(a=e.lastIndexOf("</"+r)),n[r]=a),a<t}function FB(e,t){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}function YPe(e,t,r,n){var a=e.charAt(t+2);switch(a){case"-":if(e.charAt(t+3)==="-"){var i=e.indexOf("-->",t+4);return i>t?(r.comment(e,t+4,i-t-4),i+3):(n.error("Unclosed comment"),-1)}else return-1;default:if(e.substr(t+3,6)=="CDATA["){var i=e.indexOf("]]>",t+9);return r.startCDATA(),r.characters(e,t+9,i-t-9),r.endCDATA(),i+3}var o=JPe(e,t),c=o.length;if(c>1&&/!doctype/i.test(o[0][0])){var l=o[1][0],u=!1,d=!1;c>3&&(/^public$/i.test(o[2][0])?(u=o[3][0],d=c>4&&o[4][0]):/^system$/i.test(o[2][0])&&(d=o[3][0]));var f=o[c-1];return r.startDTD(l,u,d),r.endDTD(),f.index+f[0].length}}return-1}function ZPe(e,t,r){var n=e.indexOf("?>",t);if(n){var a=e.substring(t,n).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return a?(a[0].length,r.processingInstruction(a[1],a[2]),n+2):-1}return-1}function OB(){this.attributeNames={}}OB.prototype={setTagName:function(e){if(!M3.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},addValue:function(e,t,r){if(!M3.test(e))throw new Error("invalid attribute:"+e);this.attributeNames[e]=this.length,this[this.length++]={qName:e,value:t,offset:r}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}};function JPe(e,t){var r,n=[],a=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(a.lastIndex=t,a.exec(e);r=a.exec(e);)if(n.push(r),r[1])return n}ON.XMLReader=kB;ON.ParseError=iu;var QPe=Ls,e6e=ts,$3=AB,PB=ON,t6e=e6e.DOMImplementation,W3=QPe.NAMESPACE,r6e=PB.ParseError,n6e=PB.XMLReader;function IB(e){return e.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028]/g,`
`)}function UB(e){this.options=e||{locator:{}}}UB.prototype.parseFromString=function(e,t){var r=this.options,n=new n6e,a=r.domBuilder||new Hh,i=r.errorHandler,o=r.locator,c=r.xmlns||{},l=/\/x?html?$/.test(t),u=l?$3.HTML_ENTITIES:$3.XML_ENTITIES;o&&a.setDocumentLocator(o),n.errorHandler=a6e(i,a,o),n.domBuilder=r.domBuilder||a,l&&(c[""]=W3.HTML),c.xml=c.xml||W3.XML;var d=r.normalizeLineEndings||IB;return e&&typeof e=="string"?n.parse(d(e),c,u):n.errorHandler.error("invalid doc source"),a.doc};function a6e(e,t,r){if(!e){if(t instanceof Hh)return t;e=t}var n={},a=e instanceof Function;r=r||{};function i(o){var c=e[o];!c&&a&&(c=e.length==2?function(l){e(o,l)}:e),n[o]=c&&function(l){c("[xmldom "+o+"]	"+l+q2(r))}||function(){}}return i("warning"),i("error"),i("fatalError"),n}function Hh(){this.cdata=!1}function Qc(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}Hh.prototype={startDocument:function(){this.doc=new t6e().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,r,n){var a=this.doc,i=a.createElementNS(e,r||t),o=n.length;Am(this,i),this.currentElement=i,this.locator&&Qc(this.locator,i);for(var c=0;c<o;c++){var e=n.getURI(c),l=n.getValue(c),r=n.getQName(c),u=a.createAttributeNS(e,r);this.locator&&Qc(n.getLocator(c),u),u.value=u.nodeValue=l,i.setAttributeNode(u)}},endElement:function(e,t,r){var n=this.currentElement;n.tagName,this.currentElement=n.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var r=this.doc.createProcessingInstruction(e,t);this.locator&&Qc(this.locator,r),Am(this,r)},ignorableWhitespace:function(e,t,r){},characters:function(e,t,r){if(e=z3.apply(this,arguments),e){if(this.cdata)var n=this.doc.createCDATASection(e);else var n=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(n):/^\s*$/.test(e)&&this.doc.appendChild(n),this.locator&&Qc(this.locator,n)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,r){e=z3.apply(this,arguments);var n=this.doc.createComment(e);this.locator&&Qc(this.locator,n),Am(this,n)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,r){var n=this.doc.implementation;if(n&&n.createDocumentType){var a=n.createDocumentType(e,t,r);this.locator&&Qc(this.locator,a),Am(this,a),this.doc.doctype=a}},warning:function(e){console.warn("[xmldom warning]	"+e,q2(this.locator))},error:function(e){console.error("[xmldom error]	"+e,q2(this.locator))},fatalError:function(e){throw new r6e(e,this.locator)}};function q2(e){if(e)return`
@`+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function z3(e,t,r){return typeof e=="string"?e.substr(t,r):e.length>=t+r||t?new java.lang.String(e,t,r)+"":e}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){Hh.prototype[e]=function(){return null}});function Am(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}Bg.__DOMHandler=Hh;Bg.normalizeLineEndings=IB;Bg.DOMParser=UB;var RB=ts;Ug.DOMImplementation=RB.DOMImplementation;Ug.XMLSerializer=RB.XMLSerializer;Ug.DOMParser=Bg.DOMParser;var i6e=Ug,s6e=ts;function o6e(e){var t=null,r=new i6e.DOMParser({errorHandler:function(a,i){t={level:a,message:i}}}),n=r.parseFromString(e);if(t===null)return n;throw new Error(t.level+": "+t.message)}jN.parseFromString=o6e;jN.Node=s6e.Node;var Qy=cn,q3=Or,MB=jN,BB=Mu,c6e=BB.Element;oB.readString=l6e;var H3=MB.Node;function l6e(e,t){t=t||{};try{var r=MB.parseFromString(e,"text/xml")}catch(o){return Qy.reject(o)}if(r.documentElement.tagName==="parsererror")return Qy.resolve(new Error(r.documentElement.textContent));function n(o){switch(o.nodeType){case H3.ELEMENT_NODE:return a(o);case H3.TEXT_NODE:return BB.text(o.nodeValue)}}function a(o){var c=i(o),l=[];q3.forEach(o.childNodes,function(d){var f=n(d);f&&l.push(f)});var u={};return q3.forEach(o.attributes,function(d){u[i(d)]=d.value}),new c6e(c,u,l)}function i(o){if(o.namespaceURI){var c=t[o.namespaceURI],l;return c?l=c+":":l="{"+o.namespaceURI+"}",l+o.localName}else return o.localName}return Qy.resolve(n(r.documentElement))}var LB={},bd={},os={},V3;function ko(){return V3||(V3=1,(function(){var e,t,r,n,a,i,o,c=[].slice,l={}.hasOwnProperty;e=function(){var u,d,f,h,m,x;if(x=arguments[0],m=2<=arguments.length?c.call(arguments,1):[],a(Object.assign))Object.assign.apply(null,arguments);else for(u=0,f=m.length;u<f;u++)if(h=m[u],h!=null)for(d in h)l.call(h,d)&&(x[d]=h[d]);return x},a=function(u){return!!u&&Object.prototype.toString.call(u)==="[object Function]"},i=function(u){var d;return!!u&&((d=typeof u)=="function"||d==="object")},r=function(u){return a(Array.isArray)?Array.isArray(u):Object.prototype.toString.call(u)==="[object Array]"},n=function(u){var d;if(r(u))return!u.length;for(d in u)if(l.call(u,d))return!1;return!0},o=function(u){var d,f;return i(u)&&(f=Object.getPrototypeOf(u))&&(d=f.constructor)&&typeof d=="function"&&d instanceof d&&Function.prototype.toString.call(d)===Function.prototype.toString.call(Object)},t=function(u){return a(u.valueOf)?u.valueOf():u},os.assign=e,os.isFunction=a,os.isObject=i,os.isArray=r,os.isEmpty=n,os.isPlainObject=o,os.getValue=t}).call(gt)),os}var eb={exports:{}},tb={exports:{}},rb={exports:{}},nb={exports:{}},G3;function $B(){return G3||(G3=1,(function(){nb.exports=function(){function e(t,r,n){if(this.options=t.options,this.stringify=t.stringify,this.parent=t,r==null)throw new Error("Missing attribute name. "+this.debugInfo(r));if(n==null)throw new Error("Missing attribute value. "+this.debugInfo(r));this.name=this.stringify.attName(r),this.value=this.stringify.attValue(n)}return e.prototype.clone=function(){return Object.create(this)},e.prototype.toString=function(t){return this.options.writer.set(t).attribute(this)},e.prototype.debugInfo=function(t){return t=t||this.name,t==null?"parent: <"+this.parent.name+">":"attribute: {"+t+"}, parent: <"+this.parent.name+">"},e}()}).call(gt)),nb.exports}var X3;function Lg(){return X3||(X3=1,(function(){var e,t,r,n,a,i,o=function(l,u){for(var d in u)c.call(u,d)&&(l[d]=u[d]);function f(){this.constructor=l}return f.prototype=u.prototype,l.prototype=new f,l.__super__=u.prototype,l},c={}.hasOwnProperty;i=ko(),a=i.isObject,n=i.isFunction,r=i.getValue,t=ha(),e=$B(),rb.exports=function(l){o(u,l);function u(d,f,h){if(u.__super__.constructor.call(this,d),f==null)throw new Error("Missing element name. "+this.debugInfo());this.name=this.stringify.eleName(f),this.attributes={},h!=null&&this.attribute(h),d.isDocument&&(this.isRoot=!0,this.documentObject=d,d.rootObject=this)}return u.prototype.clone=function(){var d,f,h,m;h=Object.create(this),h.isRoot&&(h.documentObject=null),h.attributes={},m=this.attributes;for(f in m)c.call(m,f)&&(d=m[f],h.attributes[f]=d.clone());return h.children=[],this.children.forEach(function(x){var p;return p=x.clone(),p.parent=h,h.children.push(p)}),h},u.prototype.attribute=function(d,f){var h,m;if(d!=null&&(d=r(d)),a(d))for(h in d)c.call(d,h)&&(m=d[h],this.attribute(h,m));else n(f)&&(f=f.apply()),(!this.options.skipNullAttributes||f!=null)&&(this.attributes[d]=new e(this,d,f));return this},u.prototype.removeAttribute=function(d){var f,h,m;if(d==null)throw new Error("Missing attribute name. "+this.debugInfo());if(d=r(d),Array.isArray(d))for(h=0,m=d.length;h<m;h++)f=d[h],delete this.attributes[f];else delete this.attributes[d];return this},u.prototype.toString=function(d){return this.options.writer.set(d).element(this)},u.prototype.att=function(d,f){return this.attribute(d,f)},u.prototype.a=function(d,f){return this.attribute(d,f)},u}(t)}).call(gt)),rb.exports}var ab={exports:{}},K3;function $g(){return K3||(K3=1,(function(){var e,t=function(n,a){for(var i in a)r.call(a,i)&&(n[i]=a[i]);function o(){this.constructor=n}return o.prototype=a.prototype,n.prototype=new o,n.__super__=a.prototype,n},r={}.hasOwnProperty;e=ha(),ab.exports=function(n){t(a,n);function a(i,o){if(a.__super__.constructor.call(this,i),o==null)throw new Error("Missing CDATA text. "+this.debugInfo());this.text=this.stringify.cdata(o)}return a.prototype.clone=function(){return Object.create(this)},a.prototype.toString=function(i){return this.options.writer.set(i).cdata(this)},a}(e)}).call(gt)),ab.exports}var ib={exports:{}},Y3;function Wg(){return Y3||(Y3=1,(function(){var e,t=function(n,a){for(var i in a)r.call(a,i)&&(n[i]=a[i]);function o(){this.constructor=n}return o.prototype=a.prototype,n.prototype=new o,n.__super__=a.prototype,n},r={}.hasOwnProperty;e=ha(),ib.exports=function(n){t(a,n);function a(i,o){if(a.__super__.constructor.call(this,i),o==null)throw new Error("Missing comment text. "+this.debugInfo());this.text=this.stringify.comment(o)}return a.prototype.clone=function(){return Object.create(this)},a.prototype.toString=function(i){return this.options.writer.set(i).comment(this)},a}(e)}).call(gt)),ib.exports}var sb={exports:{}},Z3;function zg(){return Z3||(Z3=1,(function(){var e,t,r=function(a,i){for(var o in i)n.call(i,o)&&(a[o]=i[o]);function c(){this.constructor=a}return c.prototype=i.prototype,a.prototype=new c,a.__super__=i.prototype,a},n={}.hasOwnProperty;t=ko().isObject,e=ha(),sb.exports=function(a){r(i,a);function i(o,c,l,u){var d;i.__super__.constructor.call(this,o),t(c)&&(d=c,c=d.version,l=d.encoding,u=d.standalone),c||(c="1.0"),this.version=this.stringify.xmlVersion(c),l!=null&&(this.encoding=this.stringify.xmlEncoding(l)),u!=null&&(this.standalone=this.stringify.xmlStandalone(u))}return i.prototype.toString=function(o){return this.options.writer.set(o).declaration(this)},i}(e)}).call(gt)),sb.exports}var ob={exports:{}},cb={exports:{}},J3;function qg(){return J3||(J3=1,(function(){var e,t=function(n,a){for(var i in a)r.call(a,i)&&(n[i]=a[i]);function o(){this.constructor=n}return o.prototype=a.prototype,n.prototype=new o,n.__super__=a.prototype,n},r={}.hasOwnProperty;e=ha(),cb.exports=function(n){t(a,n);function a(i,o,c,l,u,d){if(a.__super__.constructor.call(this,i),o==null)throw new Error("Missing DTD element name. "+this.debugInfo());if(c==null)throw new Error("Missing DTD attribute name. "+this.debugInfo(o));if(!l)throw new Error("Missing DTD attribute type. "+this.debugInfo(o));if(!u)throw new Error("Missing DTD attribute default. "+this.debugInfo(o));if(u.indexOf("#")!==0&&(u="#"+u),!u.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(o));if(d&&!u.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(o));this.elementName=this.stringify.eleName(o),this.attributeName=this.stringify.attName(c),this.attributeType=this.stringify.dtdAttType(l),this.defaultValue=this.stringify.dtdAttDefault(d),this.defaultValueType=u}return a.prototype.toString=function(i){return this.options.writer.set(i).dtdAttList(this)},a}(e)}).call(gt)),cb.exports}var lb={exports:{}},Q3;function Hg(){return Q3||(Q3=1,(function(){var e,t,r=function(a,i){for(var o in i)n.call(i,o)&&(a[o]=i[o]);function c(){this.constructor=a}return c.prototype=i.prototype,a.prototype=new c,a.__super__=i.prototype,a},n={}.hasOwnProperty;t=ko().isObject,e=ha(),lb.exports=function(a){r(i,a);function i(o,c,l,u){if(i.__super__.constructor.call(this,o),l==null)throw new Error("Missing DTD entity name. "+this.debugInfo(l));if(u==null)throw new Error("Missing DTD entity value. "+this.debugInfo(l));if(this.pe=!!c,this.name=this.stringify.eleName(l),!t(u))this.value=this.stringify.dtdEntityValue(u);else{if(!u.pubID&&!u.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(l));if(u.pubID&&!u.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(l));if(u.pubID!=null&&(this.pubID=this.stringify.dtdPubID(u.pubID)),u.sysID!=null&&(this.sysID=this.stringify.dtdSysID(u.sysID)),u.nData!=null&&(this.nData=this.stringify.dtdNData(u.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(l))}}return i.prototype.toString=function(o){return this.options.writer.set(o).dtdEntity(this)},i}(e)}).call(gt)),lb.exports}var ub={exports:{}},e4;function Vg(){return e4||(e4=1,(function(){var e,t=function(n,a){for(var i in a)r.call(a,i)&&(n[i]=a[i]);function o(){this.constructor=n}return o.prototype=a.prototype,n.prototype=new o,n.__super__=a.prototype,n},r={}.hasOwnProperty;e=ha(),ub.exports=function(n){t(a,n);function a(i,o,c){if(a.__super__.constructor.call(this,i),o==null)throw new Error("Missing DTD element name. "+this.debugInfo());c||(c="(#PCDATA)"),Array.isArray(c)&&(c="("+c.join(",")+")"),this.name=this.stringify.eleName(o),this.value=this.stringify.dtdElementValue(c)}return a.prototype.toString=function(i){return this.options.writer.set(i).dtdElement(this)},a}(e)}).call(gt)),ub.exports}var db={exports:{}},t4;function Gg(){return t4||(t4=1,(function(){var e,t=function(n,a){for(var i in a)r.call(a,i)&&(n[i]=a[i]);function o(){this.constructor=n}return o.prototype=a.prototype,n.prototype=new o,n.__super__=a.prototype,n},r={}.hasOwnProperty;e=ha(),db.exports=function(n){t(a,n);function a(i,o,c){if(a.__super__.constructor.call(this,i),o==null)throw new Error("Missing DTD notation name. "+this.debugInfo(o));if(!c.pubID&&!c.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(o));this.name=this.stringify.eleName(o),c.pubID!=null&&(this.pubID=this.stringify.dtdPubID(c.pubID)),c.sysID!=null&&(this.sysID=this.stringify.dtdSysID(c.sysID))}return a.prototype.toString=function(i){return this.options.writer.set(i).dtdNotation(this)},a}(e)}).call(gt)),db.exports}var r4;function Xg(){return r4||(r4=1,(function(){var e,t,r,n,a,i,o=function(l,u){for(var d in u)c.call(u,d)&&(l[d]=u[d]);function f(){this.constructor=l}return f.prototype=u.prototype,l.prototype=new f,l.__super__=u.prototype,l},c={}.hasOwnProperty;i=ko().isObject,a=ha(),e=qg(),r=Hg(),t=Vg(),n=Gg(),ob.exports=function(l){o(u,l);function u(d,f,h){var m,x;u.__super__.constructor.call(this,d),this.name="!DOCTYPE",this.documentObject=d,i(f)&&(m=f,f=m.pubID,h=m.sysID),h==null&&(x=[f,h],h=x[0],f=x[1]),f!=null&&(this.pubID=this.stringify.dtdPubID(f)),h!=null&&(this.sysID=this.stringify.dtdSysID(h))}return u.prototype.element=function(d,f){var h;return h=new t(this,d,f),this.children.push(h),this},u.prototype.attList=function(d,f,h,m,x){var p;return p=new e(this,d,f,h,m,x),this.children.push(p),this},u.prototype.entity=function(d,f){var h;return h=new r(this,!1,d,f),this.children.push(h),this},u.prototype.pEntity=function(d,f){var h;return h=new r(this,!0,d,f),this.children.push(h),this},u.prototype.notation=function(d,f){var h;return h=new n(this,d,f),this.children.push(h),this},u.prototype.toString=function(d){return this.options.writer.set(d).docType(this)},u.prototype.ele=function(d,f){return this.element(d,f)},u.prototype.att=function(d,f,h,m,x){return this.attList(d,f,h,m,x)},u.prototype.ent=function(d,f){return this.entity(d,f)},u.prototype.pent=function(d,f){return this.pEntity(d,f)},u.prototype.not=function(d,f){return this.notation(d,f)},u.prototype.up=function(){return this.root()||this.documentObject},u}(a)}).call(gt)),ob.exports}var fb={exports:{}},n4;function Kg(){return n4||(n4=1,(function(){var e,t=function(n,a){for(var i in a)r.call(a,i)&&(n[i]=a[i]);function o(){this.constructor=n}return o.prototype=a.prototype,n.prototype=new o,n.__super__=a.prototype,n},r={}.hasOwnProperty;e=ha(),fb.exports=function(n){t(a,n);function a(i,o){if(a.__super__.constructor.call(this,i),o==null)throw new Error("Missing raw text. "+this.debugInfo());this.value=this.stringify.raw(o)}return a.prototype.clone=function(){return Object.create(this)},a.prototype.toString=function(i){return this.options.writer.set(i).raw(this)},a}(e)}).call(gt)),fb.exports}var hb={exports:{}},a4;function Yg(){return a4||(a4=1,(function(){var e,t=function(n,a){for(var i in a)r.call(a,i)&&(n[i]=a[i]);function o(){this.constructor=n}return o.prototype=a.prototype,n.prototype=new o,n.__super__=a.prototype,n},r={}.hasOwnProperty;e=ha(),hb.exports=function(n){t(a,n);function a(i,o){if(a.__super__.constructor.call(this,i),o==null)throw new Error("Missing element text. "+this.debugInfo());this.value=this.stringify.eleText(o)}return a.prototype.clone=function(){return Object.create(this)},a.prototype.toString=function(i){return this.options.writer.set(i).text(this)},a}(e)}).call(gt)),hb.exports}var mb={exports:{}},i4;function Zg(){return i4||(i4=1,(function(){var e,t=function(n,a){for(var i in a)r.call(a,i)&&(n[i]=a[i]);function o(){this.constructor=n}return o.prototype=a.prototype,n.prototype=new o,n.__super__=a.prototype,n},r={}.hasOwnProperty;e=ha(),mb.exports=function(n){t(a,n);function a(i,o,c){if(a.__super__.constructor.call(this,i),o==null)throw new Error("Missing instruction target. "+this.debugInfo());this.target=this.stringify.insTarget(o),c&&(this.value=this.stringify.insValue(c))}return a.prototype.clone=function(){return Object.create(this)},a.prototype.toString=function(i){return this.options.writer.set(i).processingInstruction(this)},a}(e)}).call(gt)),mb.exports}var pb={exports:{}},s4;function PN(){return s4||(s4=1,(function(){var e,t=function(n,a){for(var i in a)r.call(a,i)&&(n[i]=a[i]);function o(){this.constructor=n}return o.prototype=a.prototype,n.prototype=new o,n.__super__=a.prototype,n},r={}.hasOwnProperty;e=ha(),pb.exports=function(n){t(a,n);function a(i){a.__super__.constructor.call(this,i),this.isDummy=!0}return a.prototype.clone=function(){return Object.create(this)},a.prototype.toString=function(i){return""},a}(e)}).call(gt)),pb.exports}var o4;function ha(){return o4||(o4=1,(function(){var e,t,r,n,a,i,o,c,l,u,d,f,h,m,x={}.hasOwnProperty;m=ko(),h=m.isObject,f=m.isFunction,d=m.isEmpty,u=m.getValue,i=null,e=null,t=null,r=null,n=null,c=null,l=null,o=null,a=null,tb.exports=function(){function p(g){this.parent=g,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.children=[],i||(i=Lg(),e=$g(),t=Wg(),r=zg(),n=Xg(),c=Kg(),l=Yg(),o=Zg(),a=PN())}return p.prototype.element=function(g,v,y){var b,_,w,j,N,D,S,T,A,E,M;if(D=null,v===null&&y==null&&(A=[{},null],v=A[0],y=A[1]),v==null&&(v={}),v=u(v),h(v)||(E=[v,y],y=E[0],v=E[1]),g!=null&&(g=u(g)),Array.isArray(g))for(w=0,S=g.length;w<S;w++)_=g[w],D=this.element(_);else if(f(g))D=this.element(g.apply());else if(h(g)){for(N in g)if(x.call(g,N))if(M=g[N],f(M)&&(M=M.apply()),h(M)&&d(M)&&(M=null),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&N.indexOf(this.stringify.convertAttKey)===0)D=this.attribute(N.substr(this.stringify.convertAttKey.length),M);else if(!this.options.separateArrayItems&&Array.isArray(M))for(j=0,T=M.length;j<T;j++)_=M[j],b={},b[N]=_,D=this.element(b);else h(M)?(D=this.element(N),D.element(M)):D=this.element(N,M)}else this.options.skipNullNodes&&y===null?D=this.dummy():!this.options.ignoreDecorators&&this.stringify.convertTextKey&&g.indexOf(this.stringify.convertTextKey)===0?D=this.text(y):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&g.indexOf(this.stringify.convertCDataKey)===0?D=this.cdata(y):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&g.indexOf(this.stringify.convertCommentKey)===0?D=this.comment(y):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&g.indexOf(this.stringify.convertRawKey)===0?D=this.raw(y):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&g.indexOf(this.stringify.convertPIKey)===0?D=this.instruction(g.substr(this.stringify.convertPIKey.length),y):D=this.node(g,v,y);if(D==null)throw new Error("Could not create any elements with: "+g+". "+this.debugInfo());return D},p.prototype.insertBefore=function(g,v,y){var b,_,w;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(g));return _=this.parent.children.indexOf(this),w=this.parent.children.splice(_),b=this.parent.element(g,v,y),Array.prototype.push.apply(this.parent.children,w),b},p.prototype.insertAfter=function(g,v,y){var b,_,w;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(g));return _=this.parent.children.indexOf(this),w=this.parent.children.splice(_+1),b=this.parent.element(g,v,y),Array.prototype.push.apply(this.parent.children,w),b},p.prototype.remove=function(){var g;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return g=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[g,g-g+1].concat([])),this.parent},p.prototype.node=function(g,v,y){var b,_;return g!=null&&(g=u(g)),v||(v={}),v=u(v),h(v)||(_=[v,y],y=_[0],v=_[1]),b=new i(this,g,v),y!=null&&b.text(y),this.children.push(b),b},p.prototype.text=function(g){var v;return v=new l(this,g),this.children.push(v),this},p.prototype.cdata=function(g){var v;return v=new e(this,g),this.children.push(v),this},p.prototype.comment=function(g){var v;return v=new t(this,g),this.children.push(v),this},p.prototype.commentBefore=function(g){var v,y;return v=this.parent.children.indexOf(this),y=this.parent.children.splice(v),this.parent.comment(g),Array.prototype.push.apply(this.parent.children,y),this},p.prototype.commentAfter=function(g){var v,y;return v=this.parent.children.indexOf(this),y=this.parent.children.splice(v+1),this.parent.comment(g),Array.prototype.push.apply(this.parent.children,y),this},p.prototype.raw=function(g){var v;return v=new c(this,g),this.children.push(v),this},p.prototype.dummy=function(){var g;return g=new a(this),this.children.push(g),g},p.prototype.instruction=function(g,v){var y,b,_,w,j;if(g!=null&&(g=u(g)),v!=null&&(v=u(v)),Array.isArray(g))for(w=0,j=g.length;w<j;w++)y=g[w],this.instruction(y);else if(h(g))for(y in g)x.call(g,y)&&(b=g[y],this.instruction(y,b));else f(v)&&(v=v.apply()),_=new o(this,g,v),this.children.push(_);return this},p.prototype.instructionBefore=function(g,v){var y,b;return y=this.parent.children.indexOf(this),b=this.parent.children.splice(y),this.parent.instruction(g,v),Array.prototype.push.apply(this.parent.children,b),this},p.prototype.instructionAfter=function(g,v){var y,b;return y=this.parent.children.indexOf(this),b=this.parent.children.splice(y+1),this.parent.instruction(g,v),Array.prototype.push.apply(this.parent.children,b),this},p.prototype.declaration=function(g,v,y){var b,_;return b=this.document(),_=new r(b,g,v,y),b.children[0]instanceof r?b.children[0]=_:b.children.unshift(_),b.root()||b},p.prototype.doctype=function(g,v){var y,b,_,w,j,N,D,S,T,A;for(b=this.document(),_=new n(b,g,v),T=b.children,w=j=0,D=T.length;j<D;w=++j)if(y=T[w],y instanceof n)return b.children[w]=_,_;for(A=b.children,w=N=0,S=A.length;N<S;w=++N)if(y=A[w],y.isRoot)return b.children.splice(w,0,_),_;return b.children.push(_),_},p.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},p.prototype.root=function(){var g;for(g=this;g;){if(g.isDocument)return g.rootObject;if(g.isRoot)return g;g=g.parent}},p.prototype.document=function(){var g;for(g=this;g;){if(g.isDocument)return g;g=g.parent}},p.prototype.end=function(g){return this.document().end(g)},p.prototype.prev=function(){var g;for(g=this.parent.children.indexOf(this);g>0&&this.parent.children[g-1].isDummy;)g=g-1;if(g<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[g-1]},p.prototype.next=function(){var g;for(g=this.parent.children.indexOf(this);g<this.parent.children.length-1&&this.parent.children[g+1].isDummy;)g=g+1;if(g===-1||g===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[g+1]},p.prototype.importDocument=function(g){var v;return v=g.root().clone(),v.parent=this,v.isRoot=!1,this.children.push(v),this},p.prototype.debugInfo=function(g){var v,y;return g=g||this.name,g==null&&!((v=this.parent)!=null&&v.name)?"":g==null?"parent: <"+this.parent.name+">":(y=this.parent)!=null&&y.name?"node: <"+g+">, parent: <"+this.parent.name+">":"node: <"+g+">"},p.prototype.ele=function(g,v,y){return this.element(g,v,y)},p.prototype.nod=function(g,v,y){return this.node(g,v,y)},p.prototype.txt=function(g){return this.text(g)},p.prototype.dat=function(g){return this.cdata(g)},p.prototype.com=function(g){return this.comment(g)},p.prototype.ins=function(g,v){return this.instruction(g,v)},p.prototype.doc=function(){return this.document()},p.prototype.dec=function(g,v,y){return this.declaration(g,v,y)},p.prototype.dtd=function(g,v){return this.doctype(g,v)},p.prototype.e=function(g,v,y){return this.element(g,v,y)},p.prototype.n=function(g,v,y){return this.node(g,v,y)},p.prototype.t=function(g){return this.text(g)},p.prototype.d=function(g){return this.cdata(g)},p.prototype.c=function(g){return this.comment(g)},p.prototype.r=function(g){return this.raw(g)},p.prototype.i=function(g,v){return this.instruction(g,v)},p.prototype.u=function(){return this.up()},p.prototype.importXMLBuilder=function(g){return this.importDocument(g)},p}()}).call(gt)),tb.exports}var xb={exports:{}},c4;function WB(){return c4||(c4=1,(function(){var e=function(r,n){return function(){return r.apply(n,arguments)}},t={}.hasOwnProperty;xb.exports=function(){function r(n){this.assertLegalChar=e(this.assertLegalChar,this);var a,i,o;n||(n={}),this.noDoubleEncoding=n.noDoubleEncoding,i=n.stringify||{};for(a in i)t.call(i,a)&&(o=i[a],this[a]=o)}return r.prototype.eleName=function(n){return n=""+n||"",this.assertLegalChar(n)},r.prototype.eleText=function(n){return n=""+n||"",this.assertLegalChar(this.elEscape(n))},r.prototype.cdata=function(n){return n=""+n||"",n=n.replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(n)},r.prototype.comment=function(n){if(n=""+n||"",n.match(/--/))throw new Error("Comment text cannot contain double-hypen: "+n);return this.assertLegalChar(n)},r.prototype.raw=function(n){return""+n||""},r.prototype.attName=function(n){return n=""+n||""},r.prototype.attValue=function(n){return n=""+n||"",this.attEscape(n)},r.prototype.insTarget=function(n){return""+n||""},r.prototype.insValue=function(n){if(n=""+n||"",n.match(/\?>/))throw new Error("Invalid processing instruction value: "+n);return n},r.prototype.xmlVersion=function(n){if(n=""+n||"",!n.match(/1\.[0-9]+/))throw new Error("Invalid version number: "+n);return n},r.prototype.xmlEncoding=function(n){if(n=""+n||"",!n.match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+n);return n},r.prototype.xmlStandalone=function(n){return n?"yes":"no"},r.prototype.dtdPubID=function(n){return""+n||""},r.prototype.dtdSysID=function(n){return""+n||""},r.prototype.dtdElementValue=function(n){return""+n||""},r.prototype.dtdAttType=function(n){return""+n||""},r.prototype.dtdAttDefault=function(n){return n!=null?""+n||"":n},r.prototype.dtdEntityValue=function(n){return""+n||""},r.prototype.dtdNData=function(n){return""+n||""},r.prototype.convertAttKey="@",r.prototype.convertPIKey="?",r.prototype.convertTextKey="#text",r.prototype.convertCDataKey="#cdata",r.prototype.convertCommentKey="#comment",r.prototype.convertRawKey="#raw",r.prototype.assertLegalChar=function(n){var a;if(a=n.match(/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/),a)throw new Error("Invalid character in string: "+n+" at index "+a.index);return n},r.prototype.elEscape=function(n){var a;return a=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,n.replace(a,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;")},r.prototype.attEscape=function(n){var a;return a=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,n.replace(a,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")},r}()}).call(gt)),xb.exports}var gb={exports:{}},vb={exports:{}},l4;function zB(){return l4||(l4=1,(function(){var e={}.hasOwnProperty;vb.exports=function(){function t(r){var n,a,i,o,c,l,u,d,f;r||(r={}),this.pretty=r.pretty||!1,this.allowEmpty=(a=r.allowEmpty)!=null?a:!1,this.pretty?(this.indent=(i=r.indent)!=null?i:"  ",this.newline=(o=r.newline)!=null?o:`
`,this.offset=(c=r.offset)!=null?c:0,this.dontprettytextnodes=(l=r.dontprettytextnodes)!=null?l:0):(this.indent="",this.newline="",this.offset=0,this.dontprettytextnodes=0),this.spacebeforeslash=(u=r.spacebeforeslash)!=null?u:"",this.spacebeforeslash===!0&&(this.spacebeforeslash=" "),this.newlinedefault=this.newline,this.prettydefault=this.pretty,d=r.writer||{};for(n in d)e.call(d,n)&&(f=d[n],this[n]=f)}return t.prototype.set=function(r){var n,a,i;r||(r={}),"pretty"in r&&(this.pretty=r.pretty),"allowEmpty"in r&&(this.allowEmpty=r.allowEmpty),this.pretty?(this.indent="indent"in r?r.indent:"  ",this.newline="newline"in r?r.newline:`
`,this.offset="offset"in r?r.offset:0,this.dontprettytextnodes="dontprettytextnodes"in r?r.dontprettytextnodes:0):(this.indent="",this.newline="",this.offset=0,this.dontprettytextnodes=0),this.spacebeforeslash="spacebeforeslash"in r?r.spacebeforeslash:"",this.spacebeforeslash===!0&&(this.spacebeforeslash=" "),this.newlinedefault=this.newline,this.prettydefault=this.pretty,a=r.writer||{};for(n in a)e.call(a,n)&&(i=a[n],this[n]=i);return this},t.prototype.space=function(r){var n;return this.pretty?(n=(r||0)+this.offset+1,n>0?new Array(n).join(this.indent):""):""},t}()}).call(gt)),vb.exports}var u4;function IN(){return u4||(u4=1,(function(){var e,t,r,n,a,i,o,c,l,u,d,f,h,m,x=function(g,v){for(var y in v)p.call(v,y)&&(g[y]=v[y]);function b(){this.constructor=g}return b.prototype=v.prototype,g.prototype=new b,g.__super__=v.prototype,g},p={}.hasOwnProperty;o=zg(),c=Xg(),e=$g(),t=Wg(),u=Lg(),f=Kg(),h=Yg(),d=Zg(),l=PN(),r=qg(),n=Vg(),a=Hg(),i=Gg(),m=zB(),gb.exports=function(g){x(v,g);function v(y){v.__super__.constructor.call(this,y)}return v.prototype.document=function(y){var b,_,w,j,N;for(this.textispresent=!1,j="",N=y.children,_=0,w=N.length;_<w;_++)b=N[_],!(b instanceof l)&&(j+=(function(){switch(!1){case!(b instanceof o):return this.declaration(b);case!(b instanceof c):return this.docType(b);case!(b instanceof t):return this.comment(b);case!(b instanceof d):return this.processingInstruction(b);default:return this.element(b,0)}}).call(this));return this.pretty&&j.slice(-this.newline.length)===this.newline&&(j=j.slice(0,-this.newline.length)),j},v.prototype.attribute=function(y){return" "+y.name+'="'+y.value+'"'},v.prototype.cdata=function(y,b){return this.space(b)+"<![CDATA["+y.text+"]]>"+this.newline},v.prototype.comment=function(y,b){return this.space(b)+"<!-- "+y.text+" -->"+this.newline},v.prototype.declaration=function(y,b){var _;return _=this.space(b),_+='<?xml version="'+y.version+'"',y.encoding!=null&&(_+=' encoding="'+y.encoding+'"'),y.standalone!=null&&(_+=' standalone="'+y.standalone+'"'),_+=this.spacebeforeslash+"?>",_+=this.newline,_},v.prototype.docType=function(y,b){var _,w,j,N,D;if(b||(b=0),N=this.space(b),N+="<!DOCTYPE "+y.root().name,y.pubID&&y.sysID?N+=' PUBLIC "'+y.pubID+'" "'+y.sysID+'"':y.sysID&&(N+=' SYSTEM "'+y.sysID+'"'),y.children.length>0){for(N+=" [",N+=this.newline,D=y.children,w=0,j=D.length;w<j;w++)_=D[w],N+=(function(){switch(!1){case!(_ instanceof r):return this.dtdAttList(_,b+1);case!(_ instanceof n):return this.dtdElement(_,b+1);case!(_ instanceof a):return this.dtdEntity(_,b+1);case!(_ instanceof i):return this.dtdNotation(_,b+1);case!(_ instanceof e):return this.cdata(_,b+1);case!(_ instanceof t):return this.comment(_,b+1);case!(_ instanceof d):return this.processingInstruction(_,b+1);default:throw new Error("Unknown DTD node type: "+_.constructor.name)}}).call(this);N+="]"}return N+=this.spacebeforeslash+">",N+=this.newline,N},v.prototype.element=function(y,b){var _,w,j,N,D,S,T,A,E,M,P,X,q;b||(b=0),q=!1,this.textispresent?(this.newline="",this.pretty=!1):(this.newline=this.newlinedefault,this.pretty=this.prettydefault),X=this.space(b),A="",A+=X+"<"+y.name,E=y.attributes;for(T in E)p.call(E,T)&&(_=E[T],A+=this.attribute(_));if(y.children.length===0||y.children.every(function(B){return B.value===""}))this.allowEmpty?A+="></"+y.name+">"+this.newline:A+=this.spacebeforeslash+"/>"+this.newline;else if(this.pretty&&y.children.length===1&&y.children[0].value!=null)A+=">",A+=y.children[0].value,A+="</"+y.name+">"+this.newline;else{if(this.dontprettytextnodes){for(M=y.children,j=0,D=M.length;j<D;j++)if(w=M[j],w.value!=null){this.textispresent++,q=!0;break}}for(this.textispresent&&(this.newline="",this.pretty=!1,X=this.space(b)),A+=">"+this.newline,P=y.children,N=0,S=P.length;N<S;N++)w=P[N],A+=(function(){switch(!1){case!(w instanceof e):return this.cdata(w,b+1);case!(w instanceof t):return this.comment(w,b+1);case!(w instanceof u):return this.element(w,b+1);case!(w instanceof f):return this.raw(w,b+1);case!(w instanceof h):return this.text(w,b+1);case!(w instanceof d):return this.processingInstruction(w,b+1);case!(w instanceof l):return"";default:throw new Error("Unknown XML node type: "+w.constructor.name)}}).call(this);q&&this.textispresent--,this.textispresent||(this.newline=this.newlinedefault,this.pretty=this.prettydefault),A+=X+"</"+y.name+">"+this.newline}return A},v.prototype.processingInstruction=function(y,b){var _;return _=this.space(b)+"<?"+y.target,y.value&&(_+=" "+y.value),_+=this.spacebeforeslash+"?>"+this.newline,_},v.prototype.raw=function(y,b){return this.space(b)+y.value+this.newline},v.prototype.text=function(y,b){return this.space(b)+y.value+this.newline},v.prototype.dtdAttList=function(y,b){var _;return _=this.space(b)+"<!ATTLIST "+y.elementName+" "+y.attributeName+" "+y.attributeType,y.defaultValueType!=="#DEFAULT"&&(_+=" "+y.defaultValueType),y.defaultValue&&(_+=' "'+y.defaultValue+'"'),_+=this.spacebeforeslash+">"+this.newline,_},v.prototype.dtdElement=function(y,b){return this.space(b)+"<!ELEMENT "+y.name+" "+y.value+this.spacebeforeslash+">"+this.newline},v.prototype.dtdEntity=function(y,b){var _;return _=this.space(b)+"<!ENTITY",y.pe&&(_+=" %"),_+=" "+y.name,y.value?_+=' "'+y.value+'"':(y.pubID&&y.sysID?_+=' PUBLIC "'+y.pubID+'" "'+y.sysID+'"':y.sysID&&(_+=' SYSTEM "'+y.sysID+'"'),y.nData&&(_+=" NDATA "+y.nData)),_+=this.spacebeforeslash+">"+this.newline,_},v.prototype.dtdNotation=function(y,b){var _;return _=this.space(b)+"<!NOTATION "+y.name,y.pubID&&y.sysID?_+=' PUBLIC "'+y.pubID+'" "'+y.sysID+'"':y.pubID?_+=' PUBLIC "'+y.pubID+'"':y.sysID&&(_+=' SYSTEM "'+y.sysID+'"'),_+=this.spacebeforeslash+">"+this.newline,_},v.prototype.openNode=function(y,b){var _,w,j,N;if(b||(b=0),y instanceof u){j=this.space(b)+"<"+y.name,N=y.attributes;for(w in N)p.call(N,w)&&(_=N[w],j+=this.attribute(_));return j+=(y.children?">":"/>")+this.newline,j}else return j=this.space(b)+"<!DOCTYPE "+y.rootNodeName,y.pubID&&y.sysID?j+=' PUBLIC "'+y.pubID+'" "'+y.sysID+'"':y.sysID&&(j+=' SYSTEM "'+y.sysID+'"'),j+=(y.children?" [":">")+this.newline,j},v.prototype.closeNode=function(y,b){switch(b||(b=0),!1){case!(y instanceof u):return this.space(b)+"</"+y.name+">"+this.newline;case!(y instanceof c):return this.space(b)+"]>"+this.newline}},v}(m)}).call(gt)),gb.exports}var d4;function u6e(){return d4||(d4=1,(function(){var e,t,r,n,a=function(o,c){for(var l in c)i.call(c,l)&&(o[l]=c[l]);function u(){this.constructor=o}return u.prototype=c.prototype,o.prototype=new u,o.__super__=c.prototype,o},i={}.hasOwnProperty;n=ko().isPlainObject,e=ha(),r=WB(),t=IN(),eb.exports=function(o){a(c,o);function c(l){c.__super__.constructor.call(this,null),this.name="?xml",l||(l={}),l.writer||(l.writer=new t),this.options=l,this.stringify=new r(l),this.isDocument=!0}return c.prototype.end=function(l){var u;return l?n(l)&&(u=l,l=this.options.writer.set(u)):l=this.options.writer,l.document(this)},c.prototype.toString=function(l){return this.options.writer.set(l).document(this)},c}(e)}).call(gt)),eb.exports}var yb={exports:{}},f4;function d6e(){return f4||(f4=1,(function(){var e,t,r,n,a,i,o,c,l,u,d,f,h,m,x,p,g,v,y,b,_={}.hasOwnProperty;b=ko(),v=b.isObject,g=b.isFunction,y=b.isPlainObject,p=b.getValue,u=Lg(),t=$g(),r=Wg(),f=Kg(),x=Yg(),d=Zg(),c=zg(),l=Xg(),n=qg(),i=Hg(),a=Vg(),o=Gg(),e=$B(),m=WB(),h=IN(),yb.exports=function(){function w(j,N,D){var S;this.name="?xml",j||(j={}),j.writer?y(j.writer)&&(S=j.writer,j.writer=new h(S)):j.writer=new h(j),this.options=j,this.writer=j.writer,this.stringify=new m(j),this.onDataCallback=N||function(){},this.onEndCallback=D||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return w.prototype.node=function(j,N,D){var S,T;if(j==null)throw new Error("Missing node name.");if(this.root&&this.currentLevel===-1)throw new Error("Document can only have one root node. "+this.debugInfo(j));return this.openCurrent(),j=p(j),N===null&&D==null&&(S=[{},null],N=S[0],D=S[1]),N==null&&(N={}),N=p(N),v(N)||(T=[N,D],D=T[0],N=T[1]),this.currentNode=new u(this,j,N),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,D!=null&&this.text(D),this},w.prototype.element=function(j,N,D){return this.currentNode&&this.currentNode instanceof l?this.dtdElement.apply(this,arguments):this.node(j,N,D)},w.prototype.attribute=function(j,N){var D,S;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(j));if(j!=null&&(j=p(j)),v(j))for(D in j)_.call(j,D)&&(S=j[D],this.attribute(D,S));else g(N)&&(N=N.apply()),(!this.options.skipNullAttributes||N!=null)&&(this.currentNode.attributes[j]=new e(this,j,N));return this},w.prototype.text=function(j){var N;return this.openCurrent(),N=new x(this,j),this.onData(this.writer.text(N,this.currentLevel+1),this.currentLevel+1),this},w.prototype.cdata=function(j){var N;return this.openCurrent(),N=new t(this,j),this.onData(this.writer.cdata(N,this.currentLevel+1),this.currentLevel+1),this},w.prototype.comment=function(j){var N;return this.openCurrent(),N=new r(this,j),this.onData(this.writer.comment(N,this.currentLevel+1),this.currentLevel+1),this},w.prototype.raw=function(j){var N;return this.openCurrent(),N=new f(this,j),this.onData(this.writer.raw(N,this.currentLevel+1),this.currentLevel+1),this},w.prototype.instruction=function(j,N){var D,S,T,A,E;if(this.openCurrent(),j!=null&&(j=p(j)),N!=null&&(N=p(N)),Array.isArray(j))for(D=0,A=j.length;D<A;D++)S=j[D],this.instruction(S);else if(v(j))for(S in j)_.call(j,S)&&(T=j[S],this.instruction(S,T));else g(N)&&(N=N.apply()),E=new d(this,j,N),this.onData(this.writer.processingInstruction(E,this.currentLevel+1),this.currentLevel+1);return this},w.prototype.declaration=function(j,N,D){var S;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return S=new c(this,j,N,D),this.onData(this.writer.declaration(S,this.currentLevel+1),this.currentLevel+1),this},w.prototype.doctype=function(j,N,D){if(this.openCurrent(),j==null)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new l(this,N,D),this.currentNode.rootNodeName=j,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},w.prototype.dtdElement=function(j,N){var D;return this.openCurrent(),D=new a(this,j,N),this.onData(this.writer.dtdElement(D,this.currentLevel+1),this.currentLevel+1),this},w.prototype.attList=function(j,N,D,S,T){var A;return this.openCurrent(),A=new n(this,j,N,D,S,T),this.onData(this.writer.dtdAttList(A,this.currentLevel+1),this.currentLevel+1),this},w.prototype.entity=function(j,N){var D;return this.openCurrent(),D=new i(this,!1,j,N),this.onData(this.writer.dtdEntity(D,this.currentLevel+1),this.currentLevel+1),this},w.prototype.pEntity=function(j,N){var D;return this.openCurrent(),D=new i(this,!0,j,N),this.onData(this.writer.dtdEntity(D,this.currentLevel+1),this.currentLevel+1),this},w.prototype.notation=function(j,N){var D;return this.openCurrent(),D=new o(this,j,N),this.onData(this.writer.dtdNotation(D,this.currentLevel+1),this.currentLevel+1),this},w.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},w.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},w.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},w.prototype.openNode=function(j){if(!j.isOpen)return!this.root&&this.currentLevel===0&&j instanceof u&&(this.root=j),this.onData(this.writer.openNode(j,this.currentLevel),this.currentLevel),j.isOpen=!0},w.prototype.closeNode=function(j){if(!j.isClosed)return this.onData(this.writer.closeNode(j,this.currentLevel),this.currentLevel),j.isClosed=!0},w.prototype.onData=function(j,N){return this.documentStarted=!0,this.onDataCallback(j,N+1)},w.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},w.prototype.debugInfo=function(j){return j==null?"":"node: <"+j+">"},w.prototype.ele=function(){return this.element.apply(this,arguments)},w.prototype.nod=function(j,N,D){return this.node(j,N,D)},w.prototype.txt=function(j){return this.text(j)},w.prototype.dat=function(j){return this.cdata(j)},w.prototype.com=function(j){return this.comment(j)},w.prototype.ins=function(j,N){return this.instruction(j,N)},w.prototype.dec=function(j,N,D){return this.declaration(j,N,D)},w.prototype.dtd=function(j,N,D){return this.doctype(j,N,D)},w.prototype.e=function(j,N,D){return this.element(j,N,D)},w.prototype.n=function(j,N,D){return this.node(j,N,D)},w.prototype.t=function(j){return this.text(j)},w.prototype.d=function(j){return this.cdata(j)},w.prototype.c=function(j){return this.comment(j)},w.prototype.r=function(j){return this.raw(j)},w.prototype.i=function(j,N){return this.instruction(j,N)},w.prototype.att=function(){return this.currentNode&&this.currentNode instanceof l?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},w.prototype.a=function(){return this.currentNode&&this.currentNode instanceof l?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},w.prototype.ent=function(j,N){return this.entity(j,N)},w.prototype.pent=function(j,N){return this.pEntity(j,N)},w.prototype.not=function(j,N){return this.notation(j,N)},w}()}).call(gt)),yb.exports}var bb={exports:{}},h4;function f6e(){return h4||(h4=1,(function(){var e,t,r,n,a,i,o,c,l,u,d,f,h,m,x=function(g,v){for(var y in v)p.call(v,y)&&(g[y]=v[y]);function b(){this.constructor=g}return b.prototype=v.prototype,g.prototype=new b,g.__super__=v.prototype,g},p={}.hasOwnProperty;o=zg(),c=Xg(),e=$g(),t=Wg(),u=Lg(),f=Kg(),h=Yg(),d=Zg(),l=PN(),r=qg(),n=Vg(),a=Hg(),i=Gg(),m=zB(),bb.exports=function(g){x(v,g);function v(y,b){v.__super__.constructor.call(this,b),this.stream=y}return v.prototype.document=function(y){var b,_,w,j,N,D,S,T;for(D=y.children,_=0,j=D.length;_<j;_++)b=D[_],b.isLastRootNode=!1;for(y.children[y.children.length-1].isLastRootNode=!0,S=y.children,T=[],w=0,N=S.length;w<N;w++)if(b=S[w],!(b instanceof l))switch(!1){case!(b instanceof o):T.push(this.declaration(b));break;case!(b instanceof c):T.push(this.docType(b));break;case!(b instanceof t):T.push(this.comment(b));break;case!(b instanceof d):T.push(this.processingInstruction(b));break;default:T.push(this.element(b))}return T},v.prototype.attribute=function(y){return this.stream.write(" "+y.name+'="'+y.value+'"')},v.prototype.cdata=function(y,b){return this.stream.write(this.space(b)+"<![CDATA["+y.text+"]]>"+this.endline(y))},v.prototype.comment=function(y,b){return this.stream.write(this.space(b)+"<!-- "+y.text+" -->"+this.endline(y))},v.prototype.declaration=function(y,b){return this.stream.write(this.space(b)),this.stream.write('<?xml version="'+y.version+'"'),y.encoding!=null&&this.stream.write(' encoding="'+y.encoding+'"'),y.standalone!=null&&this.stream.write(' standalone="'+y.standalone+'"'),this.stream.write(this.spacebeforeslash+"?>"),this.stream.write(this.endline(y))},v.prototype.docType=function(y,b){var _,w,j,N;if(b||(b=0),this.stream.write(this.space(b)),this.stream.write("<!DOCTYPE "+y.root().name),y.pubID&&y.sysID?this.stream.write(' PUBLIC "'+y.pubID+'" "'+y.sysID+'"'):y.sysID&&this.stream.write(' SYSTEM "'+y.sysID+'"'),y.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(y)),N=y.children,w=0,j=N.length;w<j;w++)switch(_=N[w],!1){case!(_ instanceof r):this.dtdAttList(_,b+1);break;case!(_ instanceof n):this.dtdElement(_,b+1);break;case!(_ instanceof a):this.dtdEntity(_,b+1);break;case!(_ instanceof i):this.dtdNotation(_,b+1);break;case!(_ instanceof e):this.cdata(_,b+1);break;case!(_ instanceof t):this.comment(_,b+1);break;case!(_ instanceof d):this.processingInstruction(_,b+1);break;default:throw new Error("Unknown DTD node type: "+_.constructor.name)}this.stream.write("]")}return this.stream.write(this.spacebeforeslash+">"),this.stream.write(this.endline(y))},v.prototype.element=function(y,b){var _,w,j,N,D,S,T,A;b||(b=0),A=this.space(b),this.stream.write(A+"<"+y.name),S=y.attributes;for(D in S)p.call(S,D)&&(_=S[D],this.attribute(_));if(y.children.length===0||y.children.every(function(E){return E.value===""}))this.allowEmpty?this.stream.write("></"+y.name+">"):this.stream.write(this.spacebeforeslash+"/>");else if(this.pretty&&y.children.length===1&&y.children[0].value!=null)this.stream.write(">"),this.stream.write(y.children[0].value),this.stream.write("</"+y.name+">");else{for(this.stream.write(">"+this.newline),T=y.children,j=0,N=T.length;j<N;j++)switch(w=T[j],!1){case!(w instanceof e):this.cdata(w,b+1);break;case!(w instanceof t):this.comment(w,b+1);break;case!(w instanceof u):this.element(w,b+1);break;case!(w instanceof f):this.raw(w,b+1);break;case!(w instanceof h):this.text(w,b+1);break;case!(w instanceof d):this.processingInstruction(w,b+1);break;case!(w instanceof l):break;default:throw new Error("Unknown XML node type: "+w.constructor.name)}this.stream.write(A+"</"+y.name+">")}return this.stream.write(this.endline(y))},v.prototype.processingInstruction=function(y,b){return this.stream.write(this.space(b)+"<?"+y.target),y.value&&this.stream.write(" "+y.value),this.stream.write(this.spacebeforeslash+"?>"+this.endline(y))},v.prototype.raw=function(y,b){return this.stream.write(this.space(b)+y.value+this.endline(y))},v.prototype.text=function(y,b){return this.stream.write(this.space(b)+y.value+this.endline(y))},v.prototype.dtdAttList=function(y,b){return this.stream.write(this.space(b)+"<!ATTLIST "+y.elementName+" "+y.attributeName+" "+y.attributeType),y.defaultValueType!=="#DEFAULT"&&this.stream.write(" "+y.defaultValueType),y.defaultValue&&this.stream.write(' "'+y.defaultValue+'"'),this.stream.write(this.spacebeforeslash+">"+this.endline(y))},v.prototype.dtdElement=function(y,b){return this.stream.write(this.space(b)+"<!ELEMENT "+y.name+" "+y.value),this.stream.write(this.spacebeforeslash+">"+this.endline(y))},v.prototype.dtdEntity=function(y,b){return this.stream.write(this.space(b)+"<!ENTITY"),y.pe&&this.stream.write(" %"),this.stream.write(" "+y.name),y.value?this.stream.write(' "'+y.value+'"'):(y.pubID&&y.sysID?this.stream.write(' PUBLIC "'+y.pubID+'" "'+y.sysID+'"'):y.sysID&&this.stream.write(' SYSTEM "'+y.sysID+'"'),y.nData&&this.stream.write(" NDATA "+y.nData)),this.stream.write(this.spacebeforeslash+">"+this.endline(y))},v.prototype.dtdNotation=function(y,b){return this.stream.write(this.space(b)+"<!NOTATION "+y.name),y.pubID&&y.sysID?this.stream.write(' PUBLIC "'+y.pubID+'" "'+y.sysID+'"'):y.pubID?this.stream.write(' PUBLIC "'+y.pubID+'"'):y.sysID&&this.stream.write(' SYSTEM "'+y.sysID+'"'),this.stream.write(this.spacebeforeslash+">"+this.endline(y))},v.prototype.endline=function(y){return y.isLastRootNode?"":this.newline},v}(m)}).call(gt)),bb.exports}(function(){var e,t,r,n,a,i,o;o=ko(),a=o.assign,i=o.isFunction,e=u6e(),t=d6e(),n=IN(),r=f6e(),bd.create=function(c,l,u,d){var f,h;if(c==null)throw new Error("Root element needs a name.");return d=a({},l,u,d),f=new e(d),h=f.element(c),d.headless||(f.declaration(d),(d.pubID!=null||d.sysID!=null)&&f.doctype(d)),h},bd.begin=function(c,l,u){var d;return i(c)&&(d=[c,l],l=d[0],u=d[1],c={}),l?new t(c,l,u):new e(c)},bd.stringWriter=function(c){return new n(c)},bd.streamWriter=function(c,l){return new r(c,l)}}).call(gt);var m4=Or,h6e=bd;LB.writeString=m6e;function m6e(e,t){var r=m4.invert(t),n={element:i,text:p6e};function a(l,u){return n[u.type](l,u)}function i(l,u){var d=l.element(o(u.name),u.attributes);u.children.forEach(function(f){a(d,f)})}function o(l){var u=/^\{(.*)\}(.*)$/.exec(l);if(u){var d=r[u[1]];return d+(d===""?"":":")+u[2]}else return l}function c(l){var u=h6e.create(o(l.name),{version:"1.0",encoding:"UTF-8",standalone:!0});return m4.forEach(t,function(d,f){var h="xmlns"+(f===""?"":":"+f);u.attribute(h,d)}),l.children.forEach(function(d){a(u,d)}),u.end()}return c(e)}function p6e(e,t){e.text(t.value)}var Jg=Mu;Bs.Element=Jg.Element;Bs.element=Jg.element;Bs.emptyElement=Jg.emptyElement;Bs.text=Jg.text;Bs.readString=oB.readString;Bs.writeString=LB.writeString;var x6e=Or,g6e=cn,v6e=Bs;_N.read=qB;_N.readXmlFromZipFile=b6e;var y6e={"http://schemas.openxmlformats.org/wordprocessingml/2006/main":"w","http://schemas.openxmlformats.org/officeDocument/2006/relationships":"r","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing":"wp","http://schemas.openxmlformats.org/drawingml/2006/main":"a","http://schemas.openxmlformats.org/drawingml/2006/picture":"pic","http://purl.oclc.org/ooxml/wordprocessingml/main":"w","http://purl.oclc.org/ooxml/officeDocument/relationships":"r","http://purl.oclc.org/ooxml/drawingml/wordprocessingDrawing":"wp","http://purl.oclc.org/ooxml/drawingml/main":"a","http://purl.oclc.org/ooxml/drawingml/picture":"pic","http://schemas.openxmlformats.org/package/2006/content-types":"content-types","http://schemas.openxmlformats.org/package/2006/relationships":"relationships","http://schemas.openxmlformats.org/markup-compatibility/2006":"mc","urn:schemas-microsoft-com:vml":"v","urn:schemas-microsoft-com:office:word":"office-word","http://schemas.microsoft.com/office/word/2010/wordml":"wordml"};function qB(e){return v6e.readString(e,y6e).then(function(t){return HB(t)[0]})}function b6e(e,t){return e.exists(t)?e.read(t,"utf-8").then(w6e).then(qB):g6e.resolve(null)}function w6e(e){return e.replace(/^\uFEFF/g,"")}function HB(e){return e.type==="element"?e.name==="mc:AlternateContent"?e.firstOrEmpty("mc:Fallback").children:(e.children=x6e.flatten(e.children.map(HB,!0)),[e]):[e]}var UN={},so={},RN={};Object.defineProperty(RN,"__esModule",{value:!0});var _6e=[{"Typeface name":"Symbol","Dingbat dec":"32","Dingbat hex":"20","Unicode dec":"32","Unicode hex":"20"},{"Typeface name":"Symbol","Dingbat dec":"33","Dingbat hex":"21","Unicode dec":"33","Unicode hex":"21"},{"Typeface name":"Symbol","Dingbat dec":"34","Dingbat hex":"22","Unicode dec":"8704","Unicode hex":"2200"},{"Typeface name":"Symbol","Dingbat dec":"35","Dingbat hex":"23","Unicode dec":"35","Unicode hex":"23"},{"Typeface name":"Symbol","Dingbat dec":"36","Dingbat hex":"24","Unicode dec":"8707","Unicode hex":"2203"},{"Typeface name":"Symbol","Dingbat dec":"37","Dingbat hex":"25","Unicode dec":"37","Unicode hex":"25"},{"Typeface name":"Symbol","Dingbat dec":"38","Dingbat hex":"26","Unicode dec":"38","Unicode hex":"26"},{"Typeface name":"Symbol","Dingbat dec":"39","Dingbat hex":"27","Unicode dec":"8717","Unicode hex":"220D"},{"Typeface name":"Symbol","Dingbat dec":"40","Dingbat hex":"28","Unicode dec":"40","Unicode hex":"28"},{"Typeface name":"Symbol","Dingbat dec":"41","Dingbat hex":"29","Unicode dec":"41","Unicode hex":"29"},{"Typeface name":"Symbol","Dingbat dec":"42","Dingbat hex":"2A","Unicode dec":"42","Unicode hex":"2A"},{"Typeface name":"Symbol","Dingbat dec":"43","Dingbat hex":"2B","Unicode dec":"43","Unicode hex":"2B"},{"Typeface name":"Symbol","Dingbat dec":"44","Dingbat hex":"2C","Unicode dec":"44","Unicode hex":"2C"},{"Typeface name":"Symbol","Dingbat dec":"45","Dingbat hex":"2D","Unicode dec":"8722","Unicode hex":"2212"},{"Typeface name":"Symbol","Dingbat dec":"46","Dingbat hex":"2E","Unicode dec":"46","Unicode hex":"2E"},{"Typeface name":"Symbol","Dingbat dec":"47","Dingbat hex":"2F","Unicode dec":"47","Unicode hex":"2F"},{"Typeface name":"Symbol","Dingbat dec":"48","Dingbat hex":"30","Unicode dec":"48","Unicode hex":"30"},{"Typeface name":"Symbol","Dingbat dec":"49","Dingbat hex":"31","Unicode dec":"49","Unicode hex":"31"},{"Typeface name":"Symbol","Dingbat dec":"50","Dingbat hex":"32","Unicode dec":"50","Unicode hex":"32"},{"Typeface name":"Symbol","Dingbat dec":"51","Dingbat hex":"33","Unicode dec":"51","Unicode hex":"33"},{"Typeface name":"Symbol","Dingbat dec":"52","Dingbat hex":"34","Unicode dec":"52","Unicode hex":"34"},{"Typeface name":"Symbol","Dingbat dec":"53","Dingbat hex":"35","Unicode dec":"53","Unicode hex":"35"},{"Typeface name":"Symbol","Dingbat dec":"54","Dingbat hex":"36","Unicode dec":"54","Unicode hex":"36"},{"Typeface name":"Symbol","Dingbat dec":"55","Dingbat hex":"37","Unicode dec":"55","Unicode hex":"37"},{"Typeface name":"Symbol","Dingbat dec":"56","Dingbat hex":"38","Unicode dec":"56","Unicode hex":"38"},{"Typeface name":"Symbol","Dingbat dec":"57","Dingbat hex":"39","Unicode dec":"57","Unicode hex":"39"},{"Typeface name":"Symbol","Dingbat dec":"58","Dingbat hex":"3A","Unicode dec":"58","Unicode hex":"3A"},{"Typeface name":"Symbol","Dingbat dec":"59","Dingbat hex":"3B","Unicode dec":"59","Unicode hex":"3B"},{"Typeface name":"Symbol","Dingbat dec":"60","Dingbat hex":"3C","Unicode dec":"60","Unicode hex":"3C"},{"Typeface name":"Symbol","Dingbat dec":"61","Dingbat hex":"3D","Unicode dec":"61","Unicode hex":"3D"},{"Typeface name":"Symbol","Dingbat dec":"62","Dingbat hex":"3E","Unicode dec":"62","Unicode hex":"3E"},{"Typeface name":"Symbol","Dingbat dec":"63","Dingbat hex":"3F","Unicode dec":"63","Unicode hex":"3F"},{"Typeface name":"Symbol","Dingbat dec":"64","Dingbat hex":"40","Unicode dec":"8773","Unicode hex":"2245"},{"Typeface name":"Symbol","Dingbat dec":"65","Dingbat hex":"41","Unicode dec":"913","Unicode hex":"391"},{"Typeface name":"Symbol","Dingbat dec":"66","Dingbat hex":"42","Unicode dec":"914","Unicode hex":"392"},{"Typeface name":"Symbol","Dingbat dec":"67","Dingbat hex":"43","Unicode dec":"935","Unicode hex":"3A7"},{"Typeface name":"Symbol","Dingbat dec":"68","Dingbat hex":"44","Unicode dec":"916","Unicode hex":"394"},{"Typeface name":"Symbol","Dingbat dec":"69","Dingbat hex":"45","Unicode dec":"917","Unicode hex":"395"},{"Typeface name":"Symbol","Dingbat dec":"70","Dingbat hex":"46","Unicode dec":"934","Unicode hex":"3A6"},{"Typeface name":"Symbol","Dingbat dec":"71","Dingbat hex":"47","Unicode dec":"915","Unicode hex":"393"},{"Typeface name":"Symbol","Dingbat dec":"72","Dingbat hex":"48","Unicode dec":"919","Unicode hex":"397"},{"Typeface name":"Symbol","Dingbat dec":"73","Dingbat hex":"49","Unicode dec":"921","Unicode hex":"399"},{"Typeface name":"Symbol","Dingbat dec":"74","Dingbat hex":"4A","Unicode dec":"977","Unicode hex":"3D1"},{"Typeface name":"Symbol","Dingbat dec":"75","Dingbat hex":"4B","Unicode dec":"922","Unicode hex":"39A"},{"Typeface name":"Symbol","Dingbat dec":"76","Dingbat hex":"4C","Unicode dec":"923","Unicode hex":"39B"},{"Typeface name":"Symbol","Dingbat dec":"77","Dingbat hex":"4D","Unicode dec":"924","Unicode hex":"39C"},{"Typeface name":"Symbol","Dingbat dec":"78","Dingbat hex":"4E","Unicode dec":"925","Unicode hex":"39D"},{"Typeface name":"Symbol","Dingbat dec":"79","Dingbat hex":"4F","Unicode dec":"927","Unicode hex":"39F"},{"Typeface name":"Symbol","Dingbat dec":"80","Dingbat hex":"50","Unicode dec":"928","Unicode hex":"3A0"},{"Typeface name":"Symbol","Dingbat dec":"81","Dingbat hex":"51","Unicode dec":"920","Unicode hex":"398"},{"Typeface name":"Symbol","Dingbat dec":"82","Dingbat hex":"52","Unicode dec":"929","Unicode hex":"3A1"},{"Typeface name":"Symbol","Dingbat dec":"83","Dingbat hex":"53","Unicode dec":"931","Unicode hex":"3A3"},{"Typeface name":"Symbol","Dingbat dec":"84","Dingbat hex":"54","Unicode dec":"932","Unicode hex":"3A4"},{"Typeface name":"Symbol","Dingbat dec":"85","Dingbat hex":"55","Unicode dec":"933","Unicode hex":"3A5"},{"Typeface name":"Symbol","Dingbat dec":"86","Dingbat hex":"56","Unicode dec":"962","Unicode hex":"3C2"},{"Typeface name":"Symbol","Dingbat dec":"87","Dingbat hex":"57","Unicode dec":"937","Unicode hex":"3A9"},{"Typeface name":"Symbol","Dingbat dec":"88","Dingbat hex":"58","Unicode dec":"926","Unicode hex":"39E"},{"Typeface name":"Symbol","Dingbat dec":"89","Dingbat hex":"59","Unicode dec":"936","Unicode hex":"3A8"},{"Typeface name":"Symbol","Dingbat dec":"90","Dingbat hex":"5A","Unicode dec":"918","Unicode hex":"396"},{"Typeface name":"Symbol","Dingbat dec":"91","Dingbat hex":"5B","Unicode dec":"91","Unicode hex":"5B"},{"Typeface name":"Symbol","Dingbat dec":"92","Dingbat hex":"5C","Unicode dec":"8756","Unicode hex":"2234"},{"Typeface name":"Symbol","Dingbat dec":"93","Dingbat hex":"5D","Unicode dec":"93","Unicode hex":"5D"},{"Typeface name":"Symbol","Dingbat dec":"94","Dingbat hex":"5E","Unicode dec":"8869","Unicode hex":"22A5"},{"Typeface name":"Symbol","Dingbat dec":"95","Dingbat hex":"5F","Unicode dec":"95","Unicode hex":"5F"},{"Typeface name":"Symbol","Dingbat dec":"96","Dingbat hex":"60","Unicode dec":"8254","Unicode hex":"203E"},{"Typeface name":"Symbol","Dingbat dec":"97","Dingbat hex":"61","Unicode dec":"945","Unicode hex":"3B1"},{"Typeface name":"Symbol","Dingbat dec":"98","Dingbat hex":"62","Unicode dec":"946","Unicode hex":"3B2"},{"Typeface name":"Symbol","Dingbat dec":"99","Dingbat hex":"63","Unicode dec":"967","Unicode hex":"3C7"},{"Typeface name":"Symbol","Dingbat dec":"100","Dingbat hex":"64","Unicode dec":"948","Unicode hex":"3B4"},{"Typeface name":"Symbol","Dingbat dec":"101","Dingbat hex":"65","Unicode dec":"949","Unicode hex":"3B5"},{"Typeface name":"Symbol","Dingbat dec":"102","Dingbat hex":"66","Unicode dec":"966","Unicode hex":"3C6"},{"Typeface name":"Symbol","Dingbat dec":"103","Dingbat hex":"67","Unicode dec":"947","Unicode hex":"3B3"},{"Typeface name":"Symbol","Dingbat dec":"104","Dingbat hex":"68","Unicode dec":"951","Unicode hex":"3B7"},{"Typeface name":"Symbol","Dingbat dec":"105","Dingbat hex":"69","Unicode dec":"953","Unicode hex":"3B9"},{"Typeface name":"Symbol","Dingbat dec":"106","Dingbat hex":"6A","Unicode dec":"981","Unicode hex":"3D5"},{"Typeface name":"Symbol","Dingbat dec":"107","Dingbat hex":"6B","Unicode dec":"954","Unicode hex":"3BA"},{"Typeface name":"Symbol","Dingbat dec":"108","Dingbat hex":"6C","Unicode dec":"955","Unicode hex":"3BB"},{"Typeface name":"Symbol","Dingbat dec":"109","Dingbat hex":"6D","Unicode dec":"956","Unicode hex":"3BC"},{"Typeface name":"Symbol","Dingbat dec":"110","Dingbat hex":"6E","Unicode dec":"957","Unicode hex":"3BD"},{"Typeface name":"Symbol","Dingbat dec":"111","Dingbat hex":"6F","Unicode dec":"959","Unicode hex":"3BF"},{"Typeface name":"Symbol","Dingbat dec":"112","Dingbat hex":"70","Unicode dec":"960","Unicode hex":"3C0"},{"Typeface name":"Symbol","Dingbat dec":"113","Dingbat hex":"71","Unicode dec":"952","Unicode hex":"3B8"},{"Typeface name":"Symbol","Dingbat dec":"114","Dingbat hex":"72","Unicode dec":"961","Unicode hex":"3C1"},{"Typeface name":"Symbol","Dingbat dec":"115","Dingbat hex":"73","Unicode dec":"963","Unicode hex":"3C3"},{"Typeface name":"Symbol","Dingbat dec":"116","Dingbat hex":"74","Unicode dec":"964","Unicode hex":"3C4"},{"Typeface name":"Symbol","Dingbat dec":"117","Dingbat hex":"75","Unicode dec":"965","Unicode hex":"3C5"},{"Typeface name":"Symbol","Dingbat dec":"118","Dingbat hex":"76","Unicode dec":"982","Unicode hex":"3D6"},{"Typeface name":"Symbol","Dingbat dec":"119","Dingbat hex":"77","Unicode dec":"969","Unicode hex":"3C9"},{"Typeface name":"Symbol","Dingbat dec":"120","Dingbat hex":"78","Unicode dec":"958","Unicode hex":"3BE"},{"Typeface name":"Symbol","Dingbat dec":"121","Dingbat hex":"79","Unicode dec":"968","Unicode hex":"3C8"},{"Typeface name":"Symbol","Dingbat dec":"122","Dingbat hex":"7A","Unicode dec":"950","Unicode hex":"3B6"},{"Typeface name":"Symbol","Dingbat dec":"123","Dingbat hex":"7B","Unicode dec":"123","Unicode hex":"7B"},{"Typeface name":"Symbol","Dingbat dec":"124","Dingbat hex":"7C","Unicode dec":"124","Unicode hex":"7C"},{"Typeface name":"Symbol","Dingbat dec":"125","Dingbat hex":"7D","Unicode dec":"125","Unicode hex":"7D"},{"Typeface name":"Symbol","Dingbat dec":"126","Dingbat hex":"7E","Unicode dec":"126","Unicode hex":"7E"},{"Typeface name":"Symbol","Dingbat dec":"160","Dingbat hex":"A0","Unicode dec":"8364","Unicode hex":"20AC"},{"Typeface name":"Symbol","Dingbat dec":"161","Dingbat hex":"A1","Unicode dec":"978","Unicode hex":"3D2"},{"Typeface name":"Symbol","Dingbat dec":"162","Dingbat hex":"A2","Unicode dec":"8242","Unicode hex":"2032"},{"Typeface name":"Symbol","Dingbat dec":"163","Dingbat hex":"A3","Unicode dec":"8804","Unicode hex":"2264"},{"Typeface name":"Symbol","Dingbat dec":"164","Dingbat hex":"A4","Unicode dec":"8260","Unicode hex":"2044"},{"Typeface name":"Symbol","Dingbat dec":"165","Dingbat hex":"A5","Unicode dec":"8734","Unicode hex":"221E"},{"Typeface name":"Symbol","Dingbat dec":"166","Dingbat hex":"A6","Unicode dec":"402","Unicode hex":"192"},{"Typeface name":"Symbol","Dingbat dec":"167","Dingbat hex":"A7","Unicode dec":"9827","Unicode hex":"2663"},{"Typeface name":"Symbol","Dingbat dec":"168","Dingbat hex":"A8","Unicode dec":"9830","Unicode hex":"2666"},{"Typeface name":"Symbol","Dingbat dec":"169","Dingbat hex":"A9","Unicode dec":"9829","Unicode hex":"2665"},{"Typeface name":"Symbol","Dingbat dec":"170","Dingbat hex":"AA","Unicode dec":"9824","Unicode hex":"2660"},{"Typeface name":"Symbol","Dingbat dec":"171","Dingbat hex":"AB","Unicode dec":"8596","Unicode hex":"2194"},{"Typeface name":"Symbol","Dingbat dec":"172","Dingbat hex":"AC","Unicode dec":"8592","Unicode hex":"2190"},{"Typeface name":"Symbol","Dingbat dec":"173","Dingbat hex":"AD","Unicode dec":"8593","Unicode hex":"2191"},{"Typeface name":"Symbol","Dingbat dec":"174","Dingbat hex":"AE","Unicode dec":"8594","Unicode hex":"2192"},{"Typeface name":"Symbol","Dingbat dec":"175","Dingbat hex":"AF","Unicode dec":"8595","Unicode hex":"2193"},{"Typeface name":"Symbol","Dingbat dec":"176","Dingbat hex":"B0","Unicode dec":"176","Unicode hex":"B0"},{"Typeface name":"Symbol","Dingbat dec":"177","Dingbat hex":"B1","Unicode dec":"177","Unicode hex":"B1"},{"Typeface name":"Symbol","Dingbat dec":"178","Dingbat hex":"B2","Unicode dec":"8243","Unicode hex":"2033"},{"Typeface name":"Symbol","Dingbat dec":"179","Dingbat hex":"B3","Unicode dec":"8805","Unicode hex":"2265"},{"Typeface name":"Symbol","Dingbat dec":"180","Dingbat hex":"B4","Unicode dec":"215","Unicode hex":"D7"},{"Typeface name":"Symbol","Dingbat dec":"181","Dingbat hex":"B5","Unicode dec":"8733","Unicode hex":"221D"},{"Typeface name":"Symbol","Dingbat dec":"182","Dingbat hex":"B6","Unicode dec":"8706","Unicode hex":"2202"},{"Typeface name":"Symbol","Dingbat dec":"183","Dingbat hex":"B7","Unicode dec":"8226","Unicode hex":"2022"},{"Typeface name":"Symbol","Dingbat dec":"184","Dingbat hex":"B8","Unicode dec":"247","Unicode hex":"F7"},{"Typeface name":"Symbol","Dingbat dec":"185","Dingbat hex":"B9","Unicode dec":"8800","Unicode hex":"2260"},{"Typeface name":"Symbol","Dingbat dec":"186","Dingbat hex":"BA","Unicode dec":"8801","Unicode hex":"2261"},{"Typeface name":"Symbol","Dingbat dec":"187","Dingbat hex":"BB","Unicode dec":"8776","Unicode hex":"2248"},{"Typeface name":"Symbol","Dingbat dec":"188","Dingbat hex":"BC","Unicode dec":"8230","Unicode hex":"2026"},{"Typeface name":"Symbol","Dingbat dec":"189","Dingbat hex":"BD","Unicode dec":"9168","Unicode hex":"23D0"},{"Typeface name":"Symbol","Dingbat dec":"190","Dingbat hex":"BE","Unicode dec":"9135","Unicode hex":"23AF"},{"Typeface name":"Symbol","Dingbat dec":"191","Dingbat hex":"BF","Unicode dec":"8629","Unicode hex":"21B5"},{"Typeface name":"Symbol","Dingbat dec":"192","Dingbat hex":"C0","Unicode dec":"8501","Unicode hex":"2135"},{"Typeface name":"Symbol","Dingbat dec":"193","Dingbat hex":"C1","Unicode dec":"8465","Unicode hex":"2111"},{"Typeface name":"Symbol","Dingbat dec":"194","Dingbat hex":"C2","Unicode dec":"8476","Unicode hex":"211C"},{"Typeface name":"Symbol","Dingbat dec":"195","Dingbat hex":"C3","Unicode dec":"8472","Unicode hex":"2118"},{"Typeface name":"Symbol","Dingbat dec":"196","Dingbat hex":"C4","Unicode dec":"8855","Unicode hex":"2297"},{"Typeface name":"Symbol","Dingbat dec":"197","Dingbat hex":"C5","Unicode dec":"8853","Unicode hex":"2295"},{"Typeface name":"Symbol","Dingbat dec":"198","Dingbat hex":"C6","Unicode dec":"8709","Unicode hex":"2205"},{"Typeface name":"Symbol","Dingbat dec":"199","Dingbat hex":"C7","Unicode dec":"8745","Unicode hex":"2229"},{"Typeface name":"Symbol","Dingbat dec":"200","Dingbat hex":"C8","Unicode dec":"8746","Unicode hex":"222A"},{"Typeface name":"Symbol","Dingbat dec":"201","Dingbat hex":"C9","Unicode dec":"8835","Unicode hex":"2283"},{"Typeface name":"Symbol","Dingbat dec":"202","Dingbat hex":"CA","Unicode dec":"8839","Unicode hex":"2287"},{"Typeface name":"Symbol","Dingbat dec":"203","Dingbat hex":"CB","Unicode dec":"8836","Unicode hex":"2284"},{"Typeface name":"Symbol","Dingbat dec":"204","Dingbat hex":"CC","Unicode dec":"8834","Unicode hex":"2282"},{"Typeface name":"Symbol","Dingbat dec":"205","Dingbat hex":"CD","Unicode dec":"8838","Unicode hex":"2286"},{"Typeface name":"Symbol","Dingbat dec":"206","Dingbat hex":"CE","Unicode dec":"8712","Unicode hex":"2208"},{"Typeface name":"Symbol","Dingbat dec":"207","Dingbat hex":"CF","Unicode dec":"8713","Unicode hex":"2209"},{"Typeface name":"Symbol","Dingbat dec":"208","Dingbat hex":"D0","Unicode dec":"8736","Unicode hex":"2220"},{"Typeface name":"Symbol","Dingbat dec":"209","Dingbat hex":"D1","Unicode dec":"8711","Unicode hex":"2207"},{"Typeface name":"Symbol","Dingbat dec":"210","Dingbat hex":"D2","Unicode dec":"174","Unicode hex":"AE"},{"Typeface name":"Symbol","Dingbat dec":"211","Dingbat hex":"D3","Unicode dec":"169","Unicode hex":"A9"},{"Typeface name":"Symbol","Dingbat dec":"212","Dingbat hex":"D4","Unicode dec":"8482","Unicode hex":"2122"},{"Typeface name":"Symbol","Dingbat dec":"213","Dingbat hex":"D5","Unicode dec":"8719","Unicode hex":"220F"},{"Typeface name":"Symbol","Dingbat dec":"214","Dingbat hex":"D6","Unicode dec":"8730","Unicode hex":"221A"},{"Typeface name":"Symbol","Dingbat dec":"215","Dingbat hex":"D7","Unicode dec":"8901","Unicode hex":"22C5"},{"Typeface name":"Symbol","Dingbat dec":"216","Dingbat hex":"D8","Unicode dec":"172","Unicode hex":"AC"},{"Typeface name":"Symbol","Dingbat dec":"217","Dingbat hex":"D9","Unicode dec":"8743","Unicode hex":"2227"},{"Typeface name":"Symbol","Dingbat dec":"218","Dingbat hex":"DA","Unicode dec":"8744","Unicode hex":"2228"},{"Typeface name":"Symbol","Dingbat dec":"219","Dingbat hex":"DB","Unicode dec":"8660","Unicode hex":"21D4"},{"Typeface name":"Symbol","Dingbat dec":"220","Dingbat hex":"DC","Unicode dec":"8656","Unicode hex":"21D0"},{"Typeface name":"Symbol","Dingbat dec":"221","Dingbat hex":"DD","Unicode dec":"8657","Unicode hex":"21D1"},{"Typeface name":"Symbol","Dingbat dec":"222","Dingbat hex":"DE","Unicode dec":"8658","Unicode hex":"21D2"},{"Typeface name":"Symbol","Dingbat dec":"223","Dingbat hex":"DF","Unicode dec":"8659","Unicode hex":"21D3"},{"Typeface name":"Symbol","Dingbat dec":"224","Dingbat hex":"E0","Unicode dec":"9674","Unicode hex":"25CA"},{"Typeface name":"Symbol","Dingbat dec":"225","Dingbat hex":"E1","Unicode dec":"12296","Unicode hex":"3008"},{"Typeface name":"Symbol","Dingbat dec":"226","Dingbat hex":"E2","Unicode dec":"174","Unicode hex":"AE"},{"Typeface name":"Symbol","Dingbat dec":"227","Dingbat hex":"E3","Unicode dec":"169","Unicode hex":"A9"},{"Typeface name":"Symbol","Dingbat dec":"228","Dingbat hex":"E4","Unicode dec":"8482","Unicode hex":"2122"},{"Typeface name":"Symbol","Dingbat dec":"229","Dingbat hex":"E5","Unicode dec":"8721","Unicode hex":"2211"},{"Typeface name":"Symbol","Dingbat dec":"230","Dingbat hex":"E6","Unicode dec":"9115","Unicode hex":"239B"},{"Typeface name":"Symbol","Dingbat dec":"231","Dingbat hex":"E7","Unicode dec":"9116","Unicode hex":"239C"},{"Typeface name":"Symbol","Dingbat dec":"232","Dingbat hex":"E8","Unicode dec":"9117","Unicode hex":"239D"},{"Typeface name":"Symbol","Dingbat dec":"233","Dingbat hex":"E9","Unicode dec":"9121","Unicode hex":"23A1"},{"Typeface name":"Symbol","Dingbat dec":"234","Dingbat hex":"EA","Unicode dec":"9122","Unicode hex":"23A2"},{"Typeface name":"Symbol","Dingbat dec":"235","Dingbat hex":"EB","Unicode dec":"9123","Unicode hex":"23A3"},{"Typeface name":"Symbol","Dingbat dec":"236","Dingbat hex":"EC","Unicode dec":"9127","Unicode hex":"23A7"},{"Typeface name":"Symbol","Dingbat dec":"237","Dingbat hex":"ED","Unicode dec":"9128","Unicode hex":"23A8"},{"Typeface name":"Symbol","Dingbat dec":"238","Dingbat hex":"EE","Unicode dec":"9129","Unicode hex":"23A9"},{"Typeface name":"Symbol","Dingbat dec":"239","Dingbat hex":"EF","Unicode dec":"9130","Unicode hex":"23AA"},{"Typeface name":"Symbol","Dingbat dec":"240","Dingbat hex":"F0","Unicode dec":"63743","Unicode hex":"F8FF"},{"Typeface name":"Symbol","Dingbat dec":"241","Dingbat hex":"F1","Unicode dec":"12297","Unicode hex":"3009"},{"Typeface name":"Symbol","Dingbat dec":"242","Dingbat hex":"F2","Unicode dec":"8747","Unicode hex":"222B"},{"Typeface name":"Symbol","Dingbat dec":"243","Dingbat hex":"F3","Unicode dec":"8992","Unicode hex":"2320"},{"Typeface name":"Symbol","Dingbat dec":"244","Dingbat hex":"F4","Unicode dec":"9134","Unicode hex":"23AE"},{"Typeface name":"Symbol","Dingbat dec":"245","Dingbat hex":"F5","Unicode dec":"8993","Unicode hex":"2321"},{"Typeface name":"Symbol","Dingbat dec":"246","Dingbat hex":"F6","Unicode dec":"9118","Unicode hex":"239E"},{"Typeface name":"Symbol","Dingbat dec":"247","Dingbat hex":"F7","Unicode dec":"9119","Unicode hex":"239F"},{"Typeface name":"Symbol","Dingbat dec":"248","Dingbat hex":"F8","Unicode dec":"9120","Unicode hex":"23A0"},{"Typeface name":"Symbol","Dingbat dec":"249","Dingbat hex":"F9","Unicode dec":"9124","Unicode hex":"23A4"},{"Typeface name":"Symbol","Dingbat dec":"250","Dingbat hex":"FA","Unicode dec":"9125","Unicode hex":"23A5"},{"Typeface name":"Symbol","Dingbat dec":"251","Dingbat hex":"FB","Unicode dec":"9126","Unicode hex":"23A6"},{"Typeface name":"Symbol","Dingbat dec":"252","Dingbat hex":"FC","Unicode dec":"9131","Unicode hex":"23AB"},{"Typeface name":"Symbol","Dingbat dec":"253","Dingbat hex":"FD","Unicode dec":"9132","Unicode hex":"23AC"},{"Typeface name":"Symbol","Dingbat dec":"254","Dingbat hex":"FE","Unicode dec":"9133","Unicode hex":"23AD"},{"Typeface name":"Webdings","Dingbat dec":"32","Dingbat hex":"20","Unicode dec":"32","Unicode hex":"20"},{"Typeface name":"Webdings","Dingbat dec":"33","Dingbat hex":"21","Unicode dec":"128375","Unicode hex":"1F577"},{"Typeface name":"Webdings","Dingbat dec":"34","Dingbat hex":"22","Unicode dec":"128376","Unicode hex":"1F578"},{"Typeface name":"Webdings","Dingbat dec":"35","Dingbat hex":"23","Unicode dec":"128370","Unicode hex":"1F572"},{"Typeface name":"Webdings","Dingbat dec":"36","Dingbat hex":"24","Unicode dec":"128374","Unicode hex":"1F576"},{"Typeface name":"Webdings","Dingbat dec":"37","Dingbat hex":"25","Unicode dec":"127942","Unicode hex":"1F3C6"},{"Typeface name":"Webdings","Dingbat dec":"38","Dingbat hex":"26","Unicode dec":"127894","Unicode hex":"1F396"},{"Typeface name":"Webdings","Dingbat dec":"39","Dingbat hex":"27","Unicode dec":"128391","Unicode hex":"1F587"},{"Typeface name":"Webdings","Dingbat dec":"40","Dingbat hex":"28","Unicode dec":"128488","Unicode hex":"1F5E8"},{"Typeface name":"Webdings","Dingbat dec":"41","Dingbat hex":"29","Unicode dec":"128489","Unicode hex":"1F5E9"},{"Typeface name":"Webdings","Dingbat dec":"42","Dingbat hex":"2A","Unicode dec":"128496","Unicode hex":"1F5F0"},{"Typeface name":"Webdings","Dingbat dec":"43","Dingbat hex":"2B","Unicode dec":"128497","Unicode hex":"1F5F1"},{"Typeface name":"Webdings","Dingbat dec":"44","Dingbat hex":"2C","Unicode dec":"127798","Unicode hex":"1F336"},{"Typeface name":"Webdings","Dingbat dec":"45","Dingbat hex":"2D","Unicode dec":"127895","Unicode hex":"1F397"},{"Typeface name":"Webdings","Dingbat dec":"46","Dingbat hex":"2E","Unicode dec":"128638","Unicode hex":"1F67E"},{"Typeface name":"Webdings","Dingbat dec":"47","Dingbat hex":"2F","Unicode dec":"128636","Unicode hex":"1F67C"},{"Typeface name":"Webdings","Dingbat dec":"48","Dingbat hex":"30","Unicode dec":"128469","Unicode hex":"1F5D5"},{"Typeface name":"Webdings","Dingbat dec":"49","Dingbat hex":"31","Unicode dec":"128470","Unicode hex":"1F5D6"},{"Typeface name":"Webdings","Dingbat dec":"50","Dingbat hex":"32","Unicode dec":"128471","Unicode hex":"1F5D7"},{"Typeface name":"Webdings","Dingbat dec":"51","Dingbat hex":"33","Unicode dec":"9204","Unicode hex":"23F4"},{"Typeface name":"Webdings","Dingbat dec":"52","Dingbat hex":"34","Unicode dec":"9205","Unicode hex":"23F5"},{"Typeface name":"Webdings","Dingbat dec":"53","Dingbat hex":"35","Unicode dec":"9206","Unicode hex":"23F6"},{"Typeface name":"Webdings","Dingbat dec":"54","Dingbat hex":"36","Unicode dec":"9207","Unicode hex":"23F7"},{"Typeface name":"Webdings","Dingbat dec":"55","Dingbat hex":"37","Unicode dec":"9194","Unicode hex":"23EA"},{"Typeface name":"Webdings","Dingbat dec":"56","Dingbat hex":"38","Unicode dec":"9193","Unicode hex":"23E9"},{"Typeface name":"Webdings","Dingbat dec":"57","Dingbat hex":"39","Unicode dec":"9198","Unicode hex":"23EE"},{"Typeface name":"Webdings","Dingbat dec":"58","Dingbat hex":"3A","Unicode dec":"9197","Unicode hex":"23ED"},{"Typeface name":"Webdings","Dingbat dec":"59","Dingbat hex":"3B","Unicode dec":"9208","Unicode hex":"23F8"},{"Typeface name":"Webdings","Dingbat dec":"60","Dingbat hex":"3C","Unicode dec":"9209","Unicode hex":"23F9"},{"Typeface name":"Webdings","Dingbat dec":"61","Dingbat hex":"3D","Unicode dec":"9210","Unicode hex":"23FA"},{"Typeface name":"Webdings","Dingbat dec":"62","Dingbat hex":"3E","Unicode dec":"128474","Unicode hex":"1F5DA"},{"Typeface name":"Webdings","Dingbat dec":"63","Dingbat hex":"3F","Unicode dec":"128499","Unicode hex":"1F5F3"},{"Typeface name":"Webdings","Dingbat dec":"64","Dingbat hex":"40","Unicode dec":"128736","Unicode hex":"1F6E0"},{"Typeface name":"Webdings","Dingbat dec":"65","Dingbat hex":"41","Unicode dec":"127959","Unicode hex":"1F3D7"},{"Typeface name":"Webdings","Dingbat dec":"66","Dingbat hex":"42","Unicode dec":"127960","Unicode hex":"1F3D8"},{"Typeface name":"Webdings","Dingbat dec":"67","Dingbat hex":"43","Unicode dec":"127961","Unicode hex":"1F3D9"},{"Typeface name":"Webdings","Dingbat dec":"68","Dingbat hex":"44","Unicode dec":"127962","Unicode hex":"1F3DA"},{"Typeface name":"Webdings","Dingbat dec":"69","Dingbat hex":"45","Unicode dec":"127964","Unicode hex":"1F3DC"},{"Typeface name":"Webdings","Dingbat dec":"70","Dingbat hex":"46","Unicode dec":"127981","Unicode hex":"1F3ED"},{"Typeface name":"Webdings","Dingbat dec":"71","Dingbat hex":"47","Unicode dec":"127963","Unicode hex":"1F3DB"},{"Typeface name":"Webdings","Dingbat dec":"72","Dingbat hex":"48","Unicode dec":"127968","Unicode hex":"1F3E0"},{"Typeface name":"Webdings","Dingbat dec":"73","Dingbat hex":"49","Unicode dec":"127958","Unicode hex":"1F3D6"},{"Typeface name":"Webdings","Dingbat dec":"74","Dingbat hex":"4A","Unicode dec":"127965","Unicode hex":"1F3DD"},{"Typeface name":"Webdings","Dingbat dec":"75","Dingbat hex":"4B","Unicode dec":"128739","Unicode hex":"1F6E3"},{"Typeface name":"Webdings","Dingbat dec":"76","Dingbat hex":"4C","Unicode dec":"128269","Unicode hex":"1F50D"},{"Typeface name":"Webdings","Dingbat dec":"77","Dingbat hex":"4D","Unicode dec":"127956","Unicode hex":"1F3D4"},{"Typeface name":"Webdings","Dingbat dec":"78","Dingbat hex":"4E","Unicode dec":"128065","Unicode hex":"1F441"},{"Typeface name":"Webdings","Dingbat dec":"79","Dingbat hex":"4F","Unicode dec":"128066","Unicode hex":"1F442"},{"Typeface name":"Webdings","Dingbat dec":"80","Dingbat hex":"50","Unicode dec":"127966","Unicode hex":"1F3DE"},{"Typeface name":"Webdings","Dingbat dec":"81","Dingbat hex":"51","Unicode dec":"127957","Unicode hex":"1F3D5"},{"Typeface name":"Webdings","Dingbat dec":"82","Dingbat hex":"52","Unicode dec":"128740","Unicode hex":"1F6E4"},{"Typeface name":"Webdings","Dingbat dec":"83","Dingbat hex":"53","Unicode dec":"127967","Unicode hex":"1F3DF"},{"Typeface name":"Webdings","Dingbat dec":"84","Dingbat hex":"54","Unicode dec":"128755","Unicode hex":"1F6F3"},{"Typeface name":"Webdings","Dingbat dec":"85","Dingbat hex":"55","Unicode dec":"128364","Unicode hex":"1F56C"},{"Typeface name":"Webdings","Dingbat dec":"86","Dingbat hex":"56","Unicode dec":"128363","Unicode hex":"1F56B"},{"Typeface name":"Webdings","Dingbat dec":"87","Dingbat hex":"57","Unicode dec":"128360","Unicode hex":"1F568"},{"Typeface name":"Webdings","Dingbat dec":"88","Dingbat hex":"58","Unicode dec":"128264","Unicode hex":"1F508"},{"Typeface name":"Webdings","Dingbat dec":"89","Dingbat hex":"59","Unicode dec":"127892","Unicode hex":"1F394"},{"Typeface name":"Webdings","Dingbat dec":"90","Dingbat hex":"5A","Unicode dec":"127893","Unicode hex":"1F395"},{"Typeface name":"Webdings","Dingbat dec":"91","Dingbat hex":"5B","Unicode dec":"128492","Unicode hex":"1F5EC"},{"Typeface name":"Webdings","Dingbat dec":"92","Dingbat hex":"5C","Unicode dec":"128637","Unicode hex":"1F67D"},{"Typeface name":"Webdings","Dingbat dec":"93","Dingbat hex":"5D","Unicode dec":"128493","Unicode hex":"1F5ED"},{"Typeface name":"Webdings","Dingbat dec":"94","Dingbat hex":"5E","Unicode dec":"128490","Unicode hex":"1F5EA"},{"Typeface name":"Webdings","Dingbat dec":"95","Dingbat hex":"5F","Unicode dec":"128491","Unicode hex":"1F5EB"},{"Typeface name":"Webdings","Dingbat dec":"96","Dingbat hex":"60","Unicode dec":"11156","Unicode hex":"2B94"},{"Typeface name":"Webdings","Dingbat dec":"97","Dingbat hex":"61","Unicode dec":"10004","Unicode hex":"2714"},{"Typeface name":"Webdings","Dingbat dec":"98","Dingbat hex":"62","Unicode dec":"128690","Unicode hex":"1F6B2"},{"Typeface name":"Webdings","Dingbat dec":"99","Dingbat hex":"63","Unicode dec":"11036","Unicode hex":"2B1C"},{"Typeface name":"Webdings","Dingbat dec":"100","Dingbat hex":"64","Unicode dec":"128737","Unicode hex":"1F6E1"},{"Typeface name":"Webdings","Dingbat dec":"101","Dingbat hex":"65","Unicode dec":"128230","Unicode hex":"1F4E6"},{"Typeface name":"Webdings","Dingbat dec":"102","Dingbat hex":"66","Unicode dec":"128753","Unicode hex":"1F6F1"},{"Typeface name":"Webdings","Dingbat dec":"103","Dingbat hex":"67","Unicode dec":"11035","Unicode hex":"2B1B"},{"Typeface name":"Webdings","Dingbat dec":"104","Dingbat hex":"68","Unicode dec":"128657","Unicode hex":"1F691"},{"Typeface name":"Webdings","Dingbat dec":"105","Dingbat hex":"69","Unicode dec":"128712","Unicode hex":"1F6C8"},{"Typeface name":"Webdings","Dingbat dec":"106","Dingbat hex":"6A","Unicode dec":"128745","Unicode hex":"1F6E9"},{"Typeface name":"Webdings","Dingbat dec":"107","Dingbat hex":"6B","Unicode dec":"128752","Unicode hex":"1F6F0"},{"Typeface name":"Webdings","Dingbat dec":"108","Dingbat hex":"6C","Unicode dec":"128968","Unicode hex":"1F7C8"},{"Typeface name":"Webdings","Dingbat dec":"109","Dingbat hex":"6D","Unicode dec":"128372","Unicode hex":"1F574"},{"Typeface name":"Webdings","Dingbat dec":"110","Dingbat hex":"6E","Unicode dec":"11044","Unicode hex":"2B24"},{"Typeface name":"Webdings","Dingbat dec":"111","Dingbat hex":"6F","Unicode dec":"128741","Unicode hex":"1F6E5"},{"Typeface name":"Webdings","Dingbat dec":"112","Dingbat hex":"70","Unicode dec":"128660","Unicode hex":"1F694"},{"Typeface name":"Webdings","Dingbat dec":"113","Dingbat hex":"71","Unicode dec":"128472","Unicode hex":"1F5D8"},{"Typeface name":"Webdings","Dingbat dec":"114","Dingbat hex":"72","Unicode dec":"128473","Unicode hex":"1F5D9"},{"Typeface name":"Webdings","Dingbat dec":"115","Dingbat hex":"73","Unicode dec":"10067","Unicode hex":"2753"},{"Typeface name":"Webdings","Dingbat dec":"116","Dingbat hex":"74","Unicode dec":"128754","Unicode hex":"1F6F2"},{"Typeface name":"Webdings","Dingbat dec":"117","Dingbat hex":"75","Unicode dec":"128647","Unicode hex":"1F687"},{"Typeface name":"Webdings","Dingbat dec":"118","Dingbat hex":"76","Unicode dec":"128653","Unicode hex":"1F68D"},{"Typeface name":"Webdings","Dingbat dec":"119","Dingbat hex":"77","Unicode dec":"9971","Unicode hex":"26F3"},{"Typeface name":"Webdings","Dingbat dec":"120","Dingbat hex":"78","Unicode dec":"10680","Unicode hex":"29B8"},{"Typeface name":"Webdings","Dingbat dec":"121","Dingbat hex":"79","Unicode dec":"8854","Unicode hex":"2296"},{"Typeface name":"Webdings","Dingbat dec":"122","Dingbat hex":"7A","Unicode dec":"128685","Unicode hex":"1F6AD"},{"Typeface name":"Webdings","Dingbat dec":"123","Dingbat hex":"7B","Unicode dec":"128494","Unicode hex":"1F5EE"},{"Typeface name":"Webdings","Dingbat dec":"124","Dingbat hex":"7C","Unicode dec":"9168","Unicode hex":"23D0"},{"Typeface name":"Webdings","Dingbat dec":"125","Dingbat hex":"7D","Unicode dec":"128495","Unicode hex":"1F5EF"},{"Typeface name":"Webdings","Dingbat dec":"126","Dingbat hex":"7E","Unicode dec":"128498","Unicode hex":"1F5F2"},{"Typeface name":"Webdings","Dingbat dec":"128","Dingbat hex":"80","Unicode dec":"128697","Unicode hex":"1F6B9"},{"Typeface name":"Webdings","Dingbat dec":"129","Dingbat hex":"81","Unicode dec":"128698","Unicode hex":"1F6BA"},{"Typeface name":"Webdings","Dingbat dec":"130","Dingbat hex":"82","Unicode dec":"128713","Unicode hex":"1F6C9"},{"Typeface name":"Webdings","Dingbat dec":"131","Dingbat hex":"83","Unicode dec":"128714","Unicode hex":"1F6CA"},{"Typeface name":"Webdings","Dingbat dec":"132","Dingbat hex":"84","Unicode dec":"128700","Unicode hex":"1F6BC"},{"Typeface name":"Webdings","Dingbat dec":"133","Dingbat hex":"85","Unicode dec":"128125","Unicode hex":"1F47D"},{"Typeface name":"Webdings","Dingbat dec":"134","Dingbat hex":"86","Unicode dec":"127947","Unicode hex":"1F3CB"},{"Typeface name":"Webdings","Dingbat dec":"135","Dingbat hex":"87","Unicode dec":"9975","Unicode hex":"26F7"},{"Typeface name":"Webdings","Dingbat dec":"136","Dingbat hex":"88","Unicode dec":"127938","Unicode hex":"1F3C2"},{"Typeface name":"Webdings","Dingbat dec":"137","Dingbat hex":"89","Unicode dec":"127948","Unicode hex":"1F3CC"},{"Typeface name":"Webdings","Dingbat dec":"138","Dingbat hex":"8A","Unicode dec":"127946","Unicode hex":"1F3CA"},{"Typeface name":"Webdings","Dingbat dec":"139","Dingbat hex":"8B","Unicode dec":"127940","Unicode hex":"1F3C4"},{"Typeface name":"Webdings","Dingbat dec":"140","Dingbat hex":"8C","Unicode dec":"127949","Unicode hex":"1F3CD"},{"Typeface name":"Webdings","Dingbat dec":"141","Dingbat hex":"8D","Unicode dec":"127950","Unicode hex":"1F3CE"},{"Typeface name":"Webdings","Dingbat dec":"142","Dingbat hex":"8E","Unicode dec":"128664","Unicode hex":"1F698"},{"Typeface name":"Webdings","Dingbat dec":"143","Dingbat hex":"8F","Unicode dec":"128480","Unicode hex":"1F5E0"},{"Typeface name":"Webdings","Dingbat dec":"144","Dingbat hex":"90","Unicode dec":"128738","Unicode hex":"1F6E2"},{"Typeface name":"Webdings","Dingbat dec":"145","Dingbat hex":"91","Unicode dec":"128176","Unicode hex":"1F4B0"},{"Typeface name":"Webdings","Dingbat dec":"146","Dingbat hex":"92","Unicode dec":"127991","Unicode hex":"1F3F7"},{"Typeface name":"Webdings","Dingbat dec":"147","Dingbat hex":"93","Unicode dec":"128179","Unicode hex":"1F4B3"},{"Typeface name":"Webdings","Dingbat dec":"148","Dingbat hex":"94","Unicode dec":"128106","Unicode hex":"1F46A"},{"Typeface name":"Webdings","Dingbat dec":"149","Dingbat hex":"95","Unicode dec":"128481","Unicode hex":"1F5E1"},{"Typeface name":"Webdings","Dingbat dec":"150","Dingbat hex":"96","Unicode dec":"128482","Unicode hex":"1F5E2"},{"Typeface name":"Webdings","Dingbat dec":"151","Dingbat hex":"97","Unicode dec":"128483","Unicode hex":"1F5E3"},{"Typeface name":"Webdings","Dingbat dec":"152","Dingbat hex":"98","Unicode dec":"10031","Unicode hex":"272F"},{"Typeface name":"Webdings","Dingbat dec":"153","Dingbat hex":"99","Unicode dec":"128388","Unicode hex":"1F584"},{"Typeface name":"Webdings","Dingbat dec":"154","Dingbat hex":"9A","Unicode dec":"128389","Unicode hex":"1F585"},{"Typeface name":"Webdings","Dingbat dec":"155","Dingbat hex":"9B","Unicode dec":"128387","Unicode hex":"1F583"},{"Typeface name":"Webdings","Dingbat dec":"156","Dingbat hex":"9C","Unicode dec":"128390","Unicode hex":"1F586"},{"Typeface name":"Webdings","Dingbat dec":"157","Dingbat hex":"9D","Unicode dec":"128441","Unicode hex":"1F5B9"},{"Typeface name":"Webdings","Dingbat dec":"158","Dingbat hex":"9E","Unicode dec":"128442","Unicode hex":"1F5BA"},{"Typeface name":"Webdings","Dingbat dec":"159","Dingbat hex":"9F","Unicode dec":"128443","Unicode hex":"1F5BB"},{"Typeface name":"Webdings","Dingbat dec":"160","Dingbat hex":"A0","Unicode dec":"128373","Unicode hex":"1F575"},{"Typeface name":"Webdings","Dingbat dec":"161","Dingbat hex":"A1","Unicode dec":"128368","Unicode hex":"1F570"},{"Typeface name":"Webdings","Dingbat dec":"162","Dingbat hex":"A2","Unicode dec":"128445","Unicode hex":"1F5BD"},{"Typeface name":"Webdings","Dingbat dec":"163","Dingbat hex":"A3","Unicode dec":"128446","Unicode hex":"1F5BE"},{"Typeface name":"Webdings","Dingbat dec":"164","Dingbat hex":"A4","Unicode dec":"128203","Unicode hex":"1F4CB"},{"Typeface name":"Webdings","Dingbat dec":"165","Dingbat hex":"A5","Unicode dec":"128466","Unicode hex":"1F5D2"},{"Typeface name":"Webdings","Dingbat dec":"166","Dingbat hex":"A6","Unicode dec":"128467","Unicode hex":"1F5D3"},{"Typeface name":"Webdings","Dingbat dec":"167","Dingbat hex":"A7","Unicode dec":"128366","Unicode hex":"1F56E"},{"Typeface name":"Webdings","Dingbat dec":"168","Dingbat hex":"A8","Unicode dec":"128218","Unicode hex":"1F4DA"},{"Typeface name":"Webdings","Dingbat dec":"169","Dingbat hex":"A9","Unicode dec":"128478","Unicode hex":"1F5DE"},{"Typeface name":"Webdings","Dingbat dec":"170","Dingbat hex":"AA","Unicode dec":"128479","Unicode hex":"1F5DF"},{"Typeface name":"Webdings","Dingbat dec":"171","Dingbat hex":"AB","Unicode dec":"128451","Unicode hex":"1F5C3"},{"Typeface name":"Webdings","Dingbat dec":"172","Dingbat hex":"AC","Unicode dec":"128450","Unicode hex":"1F5C2"},{"Typeface name":"Webdings","Dingbat dec":"173","Dingbat hex":"AD","Unicode dec":"128444","Unicode hex":"1F5BC"},{"Typeface name":"Webdings","Dingbat dec":"174","Dingbat hex":"AE","Unicode dec":"127917","Unicode hex":"1F3AD"},{"Typeface name":"Webdings","Dingbat dec":"175","Dingbat hex":"AF","Unicode dec":"127900","Unicode hex":"1F39C"},{"Typeface name":"Webdings","Dingbat dec":"176","Dingbat hex":"B0","Unicode dec":"127896","Unicode hex":"1F398"},{"Typeface name":"Webdings","Dingbat dec":"177","Dingbat hex":"B1","Unicode dec":"127897","Unicode hex":"1F399"},{"Typeface name":"Webdings","Dingbat dec":"178","Dingbat hex":"B2","Unicode dec":"127911","Unicode hex":"1F3A7"},{"Typeface name":"Webdings","Dingbat dec":"179","Dingbat hex":"B3","Unicode dec":"128191","Unicode hex":"1F4BF"},{"Typeface name":"Webdings","Dingbat dec":"180","Dingbat hex":"B4","Unicode dec":"127902","Unicode hex":"1F39E"},{"Typeface name":"Webdings","Dingbat dec":"181","Dingbat hex":"B5","Unicode dec":"128247","Unicode hex":"1F4F7"},{"Typeface name":"Webdings","Dingbat dec":"182","Dingbat hex":"B6","Unicode dec":"127903","Unicode hex":"1F39F"},{"Typeface name":"Webdings","Dingbat dec":"183","Dingbat hex":"B7","Unicode dec":"127916","Unicode hex":"1F3AC"},{"Typeface name":"Webdings","Dingbat dec":"184","Dingbat hex":"B8","Unicode dec":"128253","Unicode hex":"1F4FD"},{"Typeface name":"Webdings","Dingbat dec":"185","Dingbat hex":"B9","Unicode dec":"128249","Unicode hex":"1F4F9"},{"Typeface name":"Webdings","Dingbat dec":"186","Dingbat hex":"BA","Unicode dec":"128254","Unicode hex":"1F4FE"},{"Typeface name":"Webdings","Dingbat dec":"187","Dingbat hex":"BB","Unicode dec":"128251","Unicode hex":"1F4FB"},{"Typeface name":"Webdings","Dingbat dec":"188","Dingbat hex":"BC","Unicode dec":"127898","Unicode hex":"1F39A"},{"Typeface name":"Webdings","Dingbat dec":"189","Dingbat hex":"BD","Unicode dec":"127899","Unicode hex":"1F39B"},{"Typeface name":"Webdings","Dingbat dec":"190","Dingbat hex":"BE","Unicode dec":"128250","Unicode hex":"1F4FA"},{"Typeface name":"Webdings","Dingbat dec":"191","Dingbat hex":"BF","Unicode dec":"128187","Unicode hex":"1F4BB"},{"Typeface name":"Webdings","Dingbat dec":"192","Dingbat hex":"C0","Unicode dec":"128421","Unicode hex":"1F5A5"},{"Typeface name":"Webdings","Dingbat dec":"193","Dingbat hex":"C1","Unicode dec":"128422","Unicode hex":"1F5A6"},{"Typeface name":"Webdings","Dingbat dec":"194","Dingbat hex":"C2","Unicode dec":"128423","Unicode hex":"1F5A7"},{"Typeface name":"Webdings","Dingbat dec":"195","Dingbat hex":"C3","Unicode dec":"128377","Unicode hex":"1F579"},{"Typeface name":"Webdings","Dingbat dec":"196","Dingbat hex":"C4","Unicode dec":"127918","Unicode hex":"1F3AE"},{"Typeface name":"Webdings","Dingbat dec":"197","Dingbat hex":"C5","Unicode dec":"128379","Unicode hex":"1F57B"},{"Typeface name":"Webdings","Dingbat dec":"198","Dingbat hex":"C6","Unicode dec":"128380","Unicode hex":"1F57C"},{"Typeface name":"Webdings","Dingbat dec":"199","Dingbat hex":"C7","Unicode dec":"128223","Unicode hex":"1F4DF"},{"Typeface name":"Webdings","Dingbat dec":"200","Dingbat hex":"C8","Unicode dec":"128385","Unicode hex":"1F581"},{"Typeface name":"Webdings","Dingbat dec":"201","Dingbat hex":"C9","Unicode dec":"128384","Unicode hex":"1F580"},{"Typeface name":"Webdings","Dingbat dec":"202","Dingbat hex":"CA","Unicode dec":"128424","Unicode hex":"1F5A8"},{"Typeface name":"Webdings","Dingbat dec":"203","Dingbat hex":"CB","Unicode dec":"128425","Unicode hex":"1F5A9"},{"Typeface name":"Webdings","Dingbat dec":"204","Dingbat hex":"CC","Unicode dec":"128447","Unicode hex":"1F5BF"},{"Typeface name":"Webdings","Dingbat dec":"205","Dingbat hex":"CD","Unicode dec":"128426","Unicode hex":"1F5AA"},{"Typeface name":"Webdings","Dingbat dec":"206","Dingbat hex":"CE","Unicode dec":"128476","Unicode hex":"1F5DC"},{"Typeface name":"Webdings","Dingbat dec":"207","Dingbat hex":"CF","Unicode dec":"128274","Unicode hex":"1F512"},{"Typeface name":"Webdings","Dingbat dec":"208","Dingbat hex":"D0","Unicode dec":"128275","Unicode hex":"1F513"},{"Typeface name":"Webdings","Dingbat dec":"209","Dingbat hex":"D1","Unicode dec":"128477","Unicode hex":"1F5DD"},{"Typeface name":"Webdings","Dingbat dec":"210","Dingbat hex":"D2","Unicode dec":"128229","Unicode hex":"1F4E5"},{"Typeface name":"Webdings","Dingbat dec":"211","Dingbat hex":"D3","Unicode dec":"128228","Unicode hex":"1F4E4"},{"Typeface name":"Webdings","Dingbat dec":"212","Dingbat hex":"D4","Unicode dec":"128371","Unicode hex":"1F573"},{"Typeface name":"Webdings","Dingbat dec":"213","Dingbat hex":"D5","Unicode dec":"127779","Unicode hex":"1F323"},{"Typeface name":"Webdings","Dingbat dec":"214","Dingbat hex":"D6","Unicode dec":"127780","Unicode hex":"1F324"},{"Typeface name":"Webdings","Dingbat dec":"215","Dingbat hex":"D7","Unicode dec":"127781","Unicode hex":"1F325"},{"Typeface name":"Webdings","Dingbat dec":"216","Dingbat hex":"D8","Unicode dec":"127782","Unicode hex":"1F326"},{"Typeface name":"Webdings","Dingbat dec":"217","Dingbat hex":"D9","Unicode dec":"9729","Unicode hex":"2601"},{"Typeface name":"Webdings","Dingbat dec":"218","Dingbat hex":"DA","Unicode dec":"127784","Unicode hex":"1F328"},{"Typeface name":"Webdings","Dingbat dec":"219","Dingbat hex":"DB","Unicode dec":"127783","Unicode hex":"1F327"},{"Typeface name":"Webdings","Dingbat dec":"220","Dingbat hex":"DC","Unicode dec":"127785","Unicode hex":"1F329"},{"Typeface name":"Webdings","Dingbat dec":"221","Dingbat hex":"DD","Unicode dec":"127786","Unicode hex":"1F32A"},{"Typeface name":"Webdings","Dingbat dec":"222","Dingbat hex":"DE","Unicode dec":"127788","Unicode hex":"1F32C"},{"Typeface name":"Webdings","Dingbat dec":"223","Dingbat hex":"DF","Unicode dec":"127787","Unicode hex":"1F32B"},{"Typeface name":"Webdings","Dingbat dec":"224","Dingbat hex":"E0","Unicode dec":"127772","Unicode hex":"1F31C"},{"Typeface name":"Webdings","Dingbat dec":"225","Dingbat hex":"E1","Unicode dec":"127777","Unicode hex":"1F321"},{"Typeface name":"Webdings","Dingbat dec":"226","Dingbat hex":"E2","Unicode dec":"128715","Unicode hex":"1F6CB"},{"Typeface name":"Webdings","Dingbat dec":"227","Dingbat hex":"E3","Unicode dec":"128719","Unicode hex":"1F6CF"},{"Typeface name":"Webdings","Dingbat dec":"228","Dingbat hex":"E4","Unicode dec":"127869","Unicode hex":"1F37D"},{"Typeface name":"Webdings","Dingbat dec":"229","Dingbat hex":"E5","Unicode dec":"127864","Unicode hex":"1F378"},{"Typeface name":"Webdings","Dingbat dec":"230","Dingbat hex":"E6","Unicode dec":"128718","Unicode hex":"1F6CE"},{"Typeface name":"Webdings","Dingbat dec":"231","Dingbat hex":"E7","Unicode dec":"128717","Unicode hex":"1F6CD"},{"Typeface name":"Webdings","Dingbat dec":"232","Dingbat hex":"E8","Unicode dec":"9413","Unicode hex":"24C5"},{"Typeface name":"Webdings","Dingbat dec":"233","Dingbat hex":"E9","Unicode dec":"9855","Unicode hex":"267F"},{"Typeface name":"Webdings","Dingbat dec":"234","Dingbat hex":"EA","Unicode dec":"128710","Unicode hex":"1F6C6"},{"Typeface name":"Webdings","Dingbat dec":"235","Dingbat hex":"EB","Unicode dec":"128392","Unicode hex":"1F588"},{"Typeface name":"Webdings","Dingbat dec":"236","Dingbat hex":"EC","Unicode dec":"127891","Unicode hex":"1F393"},{"Typeface name":"Webdings","Dingbat dec":"237","Dingbat hex":"ED","Unicode dec":"128484","Unicode hex":"1F5E4"},{"Typeface name":"Webdings","Dingbat dec":"238","Dingbat hex":"EE","Unicode dec":"128485","Unicode hex":"1F5E5"},{"Typeface name":"Webdings","Dingbat dec":"239","Dingbat hex":"EF","Unicode dec":"128486","Unicode hex":"1F5E6"},{"Typeface name":"Webdings","Dingbat dec":"240","Dingbat hex":"F0","Unicode dec":"128487","Unicode hex":"1F5E7"},{"Typeface name":"Webdings","Dingbat dec":"241","Dingbat hex":"F1","Unicode dec":"128746","Unicode hex":"1F6EA"},{"Typeface name":"Webdings","Dingbat dec":"242","Dingbat hex":"F2","Unicode dec":"128063","Unicode hex":"1F43F"},{"Typeface name":"Webdings","Dingbat dec":"243","Dingbat hex":"F3","Unicode dec":"128038","Unicode hex":"1F426"},{"Typeface name":"Webdings","Dingbat dec":"244","Dingbat hex":"F4","Unicode dec":"128031","Unicode hex":"1F41F"},{"Typeface name":"Webdings","Dingbat dec":"245","Dingbat hex":"F5","Unicode dec":"128021","Unicode hex":"1F415"},{"Typeface name":"Webdings","Dingbat dec":"246","Dingbat hex":"F6","Unicode dec":"128008","Unicode hex":"1F408"},{"Typeface name":"Webdings","Dingbat dec":"247","Dingbat hex":"F7","Unicode dec":"128620","Unicode hex":"1F66C"},{"Typeface name":"Webdings","Dingbat dec":"248","Dingbat hex":"F8","Unicode dec":"128622","Unicode hex":"1F66E"},{"Typeface name":"Webdings","Dingbat dec":"249","Dingbat hex":"F9","Unicode dec":"128621","Unicode hex":"1F66D"},{"Typeface name":"Webdings","Dingbat dec":"250","Dingbat hex":"FA","Unicode dec":"128623","Unicode hex":"1F66F"},{"Typeface name":"Webdings","Dingbat dec":"251","Dingbat hex":"FB","Unicode dec":"128506","Unicode hex":"1F5FA"},{"Typeface name":"Webdings","Dingbat dec":"252","Dingbat hex":"FC","Unicode dec":"127757","Unicode hex":"1F30D"},{"Typeface name":"Webdings","Dingbat dec":"253","Dingbat hex":"FD","Unicode dec":"127759","Unicode hex":"1F30F"},{"Typeface name":"Webdings","Dingbat dec":"254","Dingbat hex":"FE","Unicode dec":"127758","Unicode hex":"1F30E"},{"Typeface name":"Webdings","Dingbat dec":"255","Dingbat hex":"FF","Unicode dec":"128330","Unicode hex":"1F54A"},{"Typeface name":"Wingdings","Dingbat dec":"32","Dingbat hex":"20","Unicode dec":"32","Unicode hex":"20"},{"Typeface name":"Wingdings","Dingbat dec":"33","Dingbat hex":"21","Unicode dec":"128393","Unicode hex":"1F589"},{"Typeface name":"Wingdings","Dingbat dec":"34","Dingbat hex":"22","Unicode dec":"9986","Unicode hex":"2702"},{"Typeface name":"Wingdings","Dingbat dec":"35","Dingbat hex":"23","Unicode dec":"9985","Unicode hex":"2701"},{"Typeface name":"Wingdings","Dingbat dec":"36","Dingbat hex":"24","Unicode dec":"128083","Unicode hex":"1F453"},{"Typeface name":"Wingdings","Dingbat dec":"37","Dingbat hex":"25","Unicode dec":"128365","Unicode hex":"1F56D"},{"Typeface name":"Wingdings","Dingbat dec":"38","Dingbat hex":"26","Unicode dec":"128366","Unicode hex":"1F56E"},{"Typeface name":"Wingdings","Dingbat dec":"39","Dingbat hex":"27","Unicode dec":"128367","Unicode hex":"1F56F"},{"Typeface name":"Wingdings","Dingbat dec":"40","Dingbat hex":"28","Unicode dec":"128383","Unicode hex":"1F57F"},{"Typeface name":"Wingdings","Dingbat dec":"41","Dingbat hex":"29","Unicode dec":"9990","Unicode hex":"2706"},{"Typeface name":"Wingdings","Dingbat dec":"42","Dingbat hex":"2A","Unicode dec":"128386","Unicode hex":"1F582"},{"Typeface name":"Wingdings","Dingbat dec":"43","Dingbat hex":"2B","Unicode dec":"128387","Unicode hex":"1F583"},{"Typeface name":"Wingdings","Dingbat dec":"44","Dingbat hex":"2C","Unicode dec":"128234","Unicode hex":"1F4EA"},{"Typeface name":"Wingdings","Dingbat dec":"45","Dingbat hex":"2D","Unicode dec":"128235","Unicode hex":"1F4EB"},{"Typeface name":"Wingdings","Dingbat dec":"46","Dingbat hex":"2E","Unicode dec":"128236","Unicode hex":"1F4EC"},{"Typeface name":"Wingdings","Dingbat dec":"47","Dingbat hex":"2F","Unicode dec":"128237","Unicode hex":"1F4ED"},{"Typeface name":"Wingdings","Dingbat dec":"48","Dingbat hex":"30","Unicode dec":"128448","Unicode hex":"1F5C0"},{"Typeface name":"Wingdings","Dingbat dec":"49","Dingbat hex":"31","Unicode dec":"128449","Unicode hex":"1F5C1"},{"Typeface name":"Wingdings","Dingbat dec":"50","Dingbat hex":"32","Unicode dec":"128462","Unicode hex":"1F5CE"},{"Typeface name":"Wingdings","Dingbat dec":"51","Dingbat hex":"33","Unicode dec":"128463","Unicode hex":"1F5CF"},{"Typeface name":"Wingdings","Dingbat dec":"52","Dingbat hex":"34","Unicode dec":"128464","Unicode hex":"1F5D0"},{"Typeface name":"Wingdings","Dingbat dec":"53","Dingbat hex":"35","Unicode dec":"128452","Unicode hex":"1F5C4"},{"Typeface name":"Wingdings","Dingbat dec":"54","Dingbat hex":"36","Unicode dec":"8987","Unicode hex":"231B"},{"Typeface name":"Wingdings","Dingbat dec":"55","Dingbat hex":"37","Unicode dec":"128430","Unicode hex":"1F5AE"},{"Typeface name":"Wingdings","Dingbat dec":"56","Dingbat hex":"38","Unicode dec":"128432","Unicode hex":"1F5B0"},{"Typeface name":"Wingdings","Dingbat dec":"57","Dingbat hex":"39","Unicode dec":"128434","Unicode hex":"1F5B2"},{"Typeface name":"Wingdings","Dingbat dec":"58","Dingbat hex":"3A","Unicode dec":"128435","Unicode hex":"1F5B3"},{"Typeface name":"Wingdings","Dingbat dec":"59","Dingbat hex":"3B","Unicode dec":"128436","Unicode hex":"1F5B4"},{"Typeface name":"Wingdings","Dingbat dec":"60","Dingbat hex":"3C","Unicode dec":"128427","Unicode hex":"1F5AB"},{"Typeface name":"Wingdings","Dingbat dec":"61","Dingbat hex":"3D","Unicode dec":"128428","Unicode hex":"1F5AC"},{"Typeface name":"Wingdings","Dingbat dec":"62","Dingbat hex":"3E","Unicode dec":"9991","Unicode hex":"2707"},{"Typeface name":"Wingdings","Dingbat dec":"63","Dingbat hex":"3F","Unicode dec":"9997","Unicode hex":"270D"},{"Typeface name":"Wingdings","Dingbat dec":"64","Dingbat hex":"40","Unicode dec":"128398","Unicode hex":"1F58E"},{"Typeface name":"Wingdings","Dingbat dec":"65","Dingbat hex":"41","Unicode dec":"9996","Unicode hex":"270C"},{"Typeface name":"Wingdings","Dingbat dec":"66","Dingbat hex":"42","Unicode dec":"128399","Unicode hex":"1F58F"},{"Typeface name":"Wingdings","Dingbat dec":"67","Dingbat hex":"43","Unicode dec":"128077","Unicode hex":"1F44D"},{"Typeface name":"Wingdings","Dingbat dec":"68","Dingbat hex":"44","Unicode dec":"128078","Unicode hex":"1F44E"},{"Typeface name":"Wingdings","Dingbat dec":"69","Dingbat hex":"45","Unicode dec":"9756","Unicode hex":"261C"},{"Typeface name":"Wingdings","Dingbat dec":"70","Dingbat hex":"46","Unicode dec":"9758","Unicode hex":"261E"},{"Typeface name":"Wingdings","Dingbat dec":"71","Dingbat hex":"47","Unicode dec":"9757","Unicode hex":"261D"},{"Typeface name":"Wingdings","Dingbat dec":"72","Dingbat hex":"48","Unicode dec":"9759","Unicode hex":"261F"},{"Typeface name":"Wingdings","Dingbat dec":"73","Dingbat hex":"49","Unicode dec":"128400","Unicode hex":"1F590"},{"Typeface name":"Wingdings","Dingbat dec":"74","Dingbat hex":"4A","Unicode dec":"9786","Unicode hex":"263A"},{"Typeface name":"Wingdings","Dingbat dec":"75","Dingbat hex":"4B","Unicode dec":"128528","Unicode hex":"1F610"},{"Typeface name":"Wingdings","Dingbat dec":"76","Dingbat hex":"4C","Unicode dec":"9785","Unicode hex":"2639"},{"Typeface name":"Wingdings","Dingbat dec":"77","Dingbat hex":"4D","Unicode dec":"128163","Unicode hex":"1F4A3"},{"Typeface name":"Wingdings","Dingbat dec":"78","Dingbat hex":"4E","Unicode dec":"128369","Unicode hex":"1F571"},{"Typeface name":"Wingdings","Dingbat dec":"79","Dingbat hex":"4F","Unicode dec":"127987","Unicode hex":"1F3F3"},{"Typeface name":"Wingdings","Dingbat dec":"80","Dingbat hex":"50","Unicode dec":"127985","Unicode hex":"1F3F1"},{"Typeface name":"Wingdings","Dingbat dec":"81","Dingbat hex":"51","Unicode dec":"9992","Unicode hex":"2708"},{"Typeface name":"Wingdings","Dingbat dec":"82","Dingbat hex":"52","Unicode dec":"9788","Unicode hex":"263C"},{"Typeface name":"Wingdings","Dingbat dec":"83","Dingbat hex":"53","Unicode dec":"127778","Unicode hex":"1F322"},{"Typeface name":"Wingdings","Dingbat dec":"84","Dingbat hex":"54","Unicode dec":"10052","Unicode hex":"2744"},{"Typeface name":"Wingdings","Dingbat dec":"85","Dingbat hex":"55","Unicode dec":"128326","Unicode hex":"1F546"},{"Typeface name":"Wingdings","Dingbat dec":"86","Dingbat hex":"56","Unicode dec":"10014","Unicode hex":"271E"},{"Typeface name":"Wingdings","Dingbat dec":"87","Dingbat hex":"57","Unicode dec":"128328","Unicode hex":"1F548"},{"Typeface name":"Wingdings","Dingbat dec":"88","Dingbat hex":"58","Unicode dec":"10016","Unicode hex":"2720"},{"Typeface name":"Wingdings","Dingbat dec":"89","Dingbat hex":"59","Unicode dec":"10017","Unicode hex":"2721"},{"Typeface name":"Wingdings","Dingbat dec":"90","Dingbat hex":"5A","Unicode dec":"9770","Unicode hex":"262A"},{"Typeface name":"Wingdings","Dingbat dec":"91","Dingbat hex":"5B","Unicode dec":"9775","Unicode hex":"262F"},{"Typeface name":"Wingdings","Dingbat dec":"92","Dingbat hex":"5C","Unicode dec":"128329","Unicode hex":"1F549"},{"Typeface name":"Wingdings","Dingbat dec":"93","Dingbat hex":"5D","Unicode dec":"9784","Unicode hex":"2638"},{"Typeface name":"Wingdings","Dingbat dec":"94","Dingbat hex":"5E","Unicode dec":"9800","Unicode hex":"2648"},{"Typeface name":"Wingdings","Dingbat dec":"95","Dingbat hex":"5F","Unicode dec":"9801","Unicode hex":"2649"},{"Typeface name":"Wingdings","Dingbat dec":"96","Dingbat hex":"60","Unicode dec":"9802","Unicode hex":"264A"},{"Typeface name":"Wingdings","Dingbat dec":"97","Dingbat hex":"61","Unicode dec":"9803","Unicode hex":"264B"},{"Typeface name":"Wingdings","Dingbat dec":"98","Dingbat hex":"62","Unicode dec":"9804","Unicode hex":"264C"},{"Typeface name":"Wingdings","Dingbat dec":"99","Dingbat hex":"63","Unicode dec":"9805","Unicode hex":"264D"},{"Typeface name":"Wingdings","Dingbat dec":"100","Dingbat hex":"64","Unicode dec":"9806","Unicode hex":"264E"},{"Typeface name":"Wingdings","Dingbat dec":"101","Dingbat hex":"65","Unicode dec":"9807","Unicode hex":"264F"},{"Typeface name":"Wingdings","Dingbat dec":"102","Dingbat hex":"66","Unicode dec":"9808","Unicode hex":"2650"},{"Typeface name":"Wingdings","Dingbat dec":"103","Dingbat hex":"67","Unicode dec":"9809","Unicode hex":"2651"},{"Typeface name":"Wingdings","Dingbat dec":"104","Dingbat hex":"68","Unicode dec":"9810","Unicode hex":"2652"},{"Typeface name":"Wingdings","Dingbat dec":"105","Dingbat hex":"69","Unicode dec":"9811","Unicode hex":"2653"},{"Typeface name":"Wingdings","Dingbat dec":"106","Dingbat hex":"6A","Unicode dec":"128624","Unicode hex":"1F670"},{"Typeface name":"Wingdings","Dingbat dec":"107","Dingbat hex":"6B","Unicode dec":"128629","Unicode hex":"1F675"},{"Typeface name":"Wingdings","Dingbat dec":"108","Dingbat hex":"6C","Unicode dec":"9899","Unicode hex":"26AB"},{"Typeface name":"Wingdings","Dingbat dec":"109","Dingbat hex":"6D","Unicode dec":"128318","Unicode hex":"1F53E"},{"Typeface name":"Wingdings","Dingbat dec":"110","Dingbat hex":"6E","Unicode dec":"9724","Unicode hex":"25FC"},{"Typeface name":"Wingdings","Dingbat dec":"111","Dingbat hex":"6F","Unicode dec":"128911","Unicode hex":"1F78F"},{"Typeface name":"Wingdings","Dingbat dec":"112","Dingbat hex":"70","Unicode dec":"128912","Unicode hex":"1F790"},{"Typeface name":"Wingdings","Dingbat dec":"113","Dingbat hex":"71","Unicode dec":"10065","Unicode hex":"2751"},{"Typeface name":"Wingdings","Dingbat dec":"114","Dingbat hex":"72","Unicode dec":"10066","Unicode hex":"2752"},{"Typeface name":"Wingdings","Dingbat dec":"115","Dingbat hex":"73","Unicode dec":"128927","Unicode hex":"1F79F"},{"Typeface name":"Wingdings","Dingbat dec":"116","Dingbat hex":"74","Unicode dec":"10731","Unicode hex":"29EB"},{"Typeface name":"Wingdings","Dingbat dec":"117","Dingbat hex":"75","Unicode dec":"9670","Unicode hex":"25C6"},{"Typeface name":"Wingdings","Dingbat dec":"118","Dingbat hex":"76","Unicode dec":"10070","Unicode hex":"2756"},{"Typeface name":"Wingdings","Dingbat dec":"119","Dingbat hex":"77","Unicode dec":"11049","Unicode hex":"2B29"},{"Typeface name":"Wingdings","Dingbat dec":"120","Dingbat hex":"78","Unicode dec":"8999","Unicode hex":"2327"},{"Typeface name":"Wingdings","Dingbat dec":"121","Dingbat hex":"79","Unicode dec":"11193","Unicode hex":"2BB9"},{"Typeface name":"Wingdings","Dingbat dec":"122","Dingbat hex":"7A","Unicode dec":"8984","Unicode hex":"2318"},{"Typeface name":"Wingdings","Dingbat dec":"123","Dingbat hex":"7B","Unicode dec":"127989","Unicode hex":"1F3F5"},{"Typeface name":"Wingdings","Dingbat dec":"124","Dingbat hex":"7C","Unicode dec":"127990","Unicode hex":"1F3F6"},{"Typeface name":"Wingdings","Dingbat dec":"125","Dingbat hex":"7D","Unicode dec":"128630","Unicode hex":"1F676"},{"Typeface name":"Wingdings","Dingbat dec":"126","Dingbat hex":"7E","Unicode dec":"128631","Unicode hex":"1F677"},{"Typeface name":"Wingdings","Dingbat dec":"127","Dingbat hex":"7F","Unicode dec":"9647","Unicode hex":"25AF"},{"Typeface name":"Wingdings","Dingbat dec":"128","Dingbat hex":"80","Unicode dec":"127243","Unicode hex":"1F10B"},{"Typeface name":"Wingdings","Dingbat dec":"129","Dingbat hex":"81","Unicode dec":"10112","Unicode hex":"2780"},{"Typeface name":"Wingdings","Dingbat dec":"130","Dingbat hex":"82","Unicode dec":"10113","Unicode hex":"2781"},{"Typeface name":"Wingdings","Dingbat dec":"131","Dingbat hex":"83","Unicode dec":"10114","Unicode hex":"2782"},{"Typeface name":"Wingdings","Dingbat dec":"132","Dingbat hex":"84","Unicode dec":"10115","Unicode hex":"2783"},{"Typeface name":"Wingdings","Dingbat dec":"133","Dingbat hex":"85","Unicode dec":"10116","Unicode hex":"2784"},{"Typeface name":"Wingdings","Dingbat dec":"134","Dingbat hex":"86","Unicode dec":"10117","Unicode hex":"2785"},{"Typeface name":"Wingdings","Dingbat dec":"135","Dingbat hex":"87","Unicode dec":"10118","Unicode hex":"2786"},{"Typeface name":"Wingdings","Dingbat dec":"136","Dingbat hex":"88","Unicode dec":"10119","Unicode hex":"2787"},{"Typeface name":"Wingdings","Dingbat dec":"137","Dingbat hex":"89","Unicode dec":"10120","Unicode hex":"2788"},{"Typeface name":"Wingdings","Dingbat dec":"138","Dingbat hex":"8A","Unicode dec":"10121","Unicode hex":"2789"},{"Typeface name":"Wingdings","Dingbat dec":"139","Dingbat hex":"8B","Unicode dec":"127244","Unicode hex":"1F10C"},{"Typeface name":"Wingdings","Dingbat dec":"140","Dingbat hex":"8C","Unicode dec":"10122","Unicode hex":"278A"},{"Typeface name":"Wingdings","Dingbat dec":"141","Dingbat hex":"8D","Unicode dec":"10123","Unicode hex":"278B"},{"Typeface name":"Wingdings","Dingbat dec":"142","Dingbat hex":"8E","Unicode dec":"10124","Unicode hex":"278C"},{"Typeface name":"Wingdings","Dingbat dec":"143","Dingbat hex":"8F","Unicode dec":"10125","Unicode hex":"278D"},{"Typeface name":"Wingdings","Dingbat dec":"144","Dingbat hex":"90","Unicode dec":"10126","Unicode hex":"278E"},{"Typeface name":"Wingdings","Dingbat dec":"145","Dingbat hex":"91","Unicode dec":"10127","Unicode hex":"278F"},{"Typeface name":"Wingdings","Dingbat dec":"146","Dingbat hex":"92","Unicode dec":"10128","Unicode hex":"2790"},{"Typeface name":"Wingdings","Dingbat dec":"147","Dingbat hex":"93","Unicode dec":"10129","Unicode hex":"2791"},{"Typeface name":"Wingdings","Dingbat dec":"148","Dingbat hex":"94","Unicode dec":"10130","Unicode hex":"2792"},{"Typeface name":"Wingdings","Dingbat dec":"149","Dingbat hex":"95","Unicode dec":"10131","Unicode hex":"2793"},{"Typeface name":"Wingdings","Dingbat dec":"150","Dingbat hex":"96","Unicode dec":"128610","Unicode hex":"1F662"},{"Typeface name":"Wingdings","Dingbat dec":"151","Dingbat hex":"97","Unicode dec":"128608","Unicode hex":"1F660"},{"Typeface name":"Wingdings","Dingbat dec":"152","Dingbat hex":"98","Unicode dec":"128609","Unicode hex":"1F661"},{"Typeface name":"Wingdings","Dingbat dec":"153","Dingbat hex":"99","Unicode dec":"128611","Unicode hex":"1F663"},{"Typeface name":"Wingdings","Dingbat dec":"154","Dingbat hex":"9A","Unicode dec":"128606","Unicode hex":"1F65E"},{"Typeface name":"Wingdings","Dingbat dec":"155","Dingbat hex":"9B","Unicode dec":"128604","Unicode hex":"1F65C"},{"Typeface name":"Wingdings","Dingbat dec":"156","Dingbat hex":"9C","Unicode dec":"128605","Unicode hex":"1F65D"},{"Typeface name":"Wingdings","Dingbat dec":"157","Dingbat hex":"9D","Unicode dec":"128607","Unicode hex":"1F65F"},{"Typeface name":"Wingdings","Dingbat dec":"158","Dingbat hex":"9E","Unicode dec":"8729","Unicode hex":"2219"},{"Typeface name":"Wingdings","Dingbat dec":"159","Dingbat hex":"9F","Unicode dec":"8226","Unicode hex":"2022"},{"Typeface name":"Wingdings","Dingbat dec":"160","Dingbat hex":"A0","Unicode dec":"11037","Unicode hex":"2B1D"},{"Typeface name":"Wingdings","Dingbat dec":"161","Dingbat hex":"A1","Unicode dec":"11096","Unicode hex":"2B58"},{"Typeface name":"Wingdings","Dingbat dec":"162","Dingbat hex":"A2","Unicode dec":"128902","Unicode hex":"1F786"},{"Typeface name":"Wingdings","Dingbat dec":"163","Dingbat hex":"A3","Unicode dec":"128904","Unicode hex":"1F788"},{"Typeface name":"Wingdings","Dingbat dec":"164","Dingbat hex":"A4","Unicode dec":"128906","Unicode hex":"1F78A"},{"Typeface name":"Wingdings","Dingbat dec":"165","Dingbat hex":"A5","Unicode dec":"128907","Unicode hex":"1F78B"},{"Typeface name":"Wingdings","Dingbat dec":"166","Dingbat hex":"A6","Unicode dec":"128319","Unicode hex":"1F53F"},{"Typeface name":"Wingdings","Dingbat dec":"167","Dingbat hex":"A7","Unicode dec":"9642","Unicode hex":"25AA"},{"Typeface name":"Wingdings","Dingbat dec":"168","Dingbat hex":"A8","Unicode dec":"128910","Unicode hex":"1F78E"},{"Typeface name":"Wingdings","Dingbat dec":"169","Dingbat hex":"A9","Unicode dec":"128961","Unicode hex":"1F7C1"},{"Typeface name":"Wingdings","Dingbat dec":"170","Dingbat hex":"AA","Unicode dec":"128965","Unicode hex":"1F7C5"},{"Typeface name":"Wingdings","Dingbat dec":"171","Dingbat hex":"AB","Unicode dec":"9733","Unicode hex":"2605"},{"Typeface name":"Wingdings","Dingbat dec":"172","Dingbat hex":"AC","Unicode dec":"128971","Unicode hex":"1F7CB"},{"Typeface name":"Wingdings","Dingbat dec":"173","Dingbat hex":"AD","Unicode dec":"128975","Unicode hex":"1F7CF"},{"Typeface name":"Wingdings","Dingbat dec":"174","Dingbat hex":"AE","Unicode dec":"128979","Unicode hex":"1F7D3"},{"Typeface name":"Wingdings","Dingbat dec":"175","Dingbat hex":"AF","Unicode dec":"128977","Unicode hex":"1F7D1"},{"Typeface name":"Wingdings","Dingbat dec":"176","Dingbat hex":"B0","Unicode dec":"11216","Unicode hex":"2BD0"},{"Typeface name":"Wingdings","Dingbat dec":"177","Dingbat hex":"B1","Unicode dec":"8982","Unicode hex":"2316"},{"Typeface name":"Wingdings","Dingbat dec":"178","Dingbat hex":"B2","Unicode dec":"11214","Unicode hex":"2BCE"},{"Typeface name":"Wingdings","Dingbat dec":"179","Dingbat hex":"B3","Unicode dec":"11215","Unicode hex":"2BCF"},{"Typeface name":"Wingdings","Dingbat dec":"180","Dingbat hex":"B4","Unicode dec":"11217","Unicode hex":"2BD1"},{"Typeface name":"Wingdings","Dingbat dec":"181","Dingbat hex":"B5","Unicode dec":"10026","Unicode hex":"272A"},{"Typeface name":"Wingdings","Dingbat dec":"182","Dingbat hex":"B6","Unicode dec":"10032","Unicode hex":"2730"},{"Typeface name":"Wingdings","Dingbat dec":"183","Dingbat hex":"B7","Unicode dec":"128336","Unicode hex":"1F550"},{"Typeface name":"Wingdings","Dingbat dec":"184","Dingbat hex":"B8","Unicode dec":"128337","Unicode hex":"1F551"},{"Typeface name":"Wingdings","Dingbat dec":"185","Dingbat hex":"B9","Unicode dec":"128338","Unicode hex":"1F552"},{"Typeface name":"Wingdings","Dingbat dec":"186","Dingbat hex":"BA","Unicode dec":"128339","Unicode hex":"1F553"},{"Typeface name":"Wingdings","Dingbat dec":"187","Dingbat hex":"BB","Unicode dec":"128340","Unicode hex":"1F554"},{"Typeface name":"Wingdings","Dingbat dec":"188","Dingbat hex":"BC","Unicode dec":"128341","Unicode hex":"1F555"},{"Typeface name":"Wingdings","Dingbat dec":"189","Dingbat hex":"BD","Unicode dec":"128342","Unicode hex":"1F556"},{"Typeface name":"Wingdings","Dingbat dec":"190","Dingbat hex":"BE","Unicode dec":"128343","Unicode hex":"1F557"},{"Typeface name":"Wingdings","Dingbat dec":"191","Dingbat hex":"BF","Unicode dec":"128344","Unicode hex":"1F558"},{"Typeface name":"Wingdings","Dingbat dec":"192","Dingbat hex":"C0","Unicode dec":"128345","Unicode hex":"1F559"},{"Typeface name":"Wingdings","Dingbat dec":"193","Dingbat hex":"C1","Unicode dec":"128346","Unicode hex":"1F55A"},{"Typeface name":"Wingdings","Dingbat dec":"194","Dingbat hex":"C2","Unicode dec":"128347","Unicode hex":"1F55B"},{"Typeface name":"Wingdings","Dingbat dec":"195","Dingbat hex":"C3","Unicode dec":"11184","Unicode hex":"2BB0"},{"Typeface name":"Wingdings","Dingbat dec":"196","Dingbat hex":"C4","Unicode dec":"11185","Unicode hex":"2BB1"},{"Typeface name":"Wingdings","Dingbat dec":"197","Dingbat hex":"C5","Unicode dec":"11186","Unicode hex":"2BB2"},{"Typeface name":"Wingdings","Dingbat dec":"198","Dingbat hex":"C6","Unicode dec":"11187","Unicode hex":"2BB3"},{"Typeface name":"Wingdings","Dingbat dec":"199","Dingbat hex":"C7","Unicode dec":"11188","Unicode hex":"2BB4"},{"Typeface name":"Wingdings","Dingbat dec":"200","Dingbat hex":"C8","Unicode dec":"11189","Unicode hex":"2BB5"},{"Typeface name":"Wingdings","Dingbat dec":"201","Dingbat hex":"C9","Unicode dec":"11190","Unicode hex":"2BB6"},{"Typeface name":"Wingdings","Dingbat dec":"202","Dingbat hex":"CA","Unicode dec":"11191","Unicode hex":"2BB7"},{"Typeface name":"Wingdings","Dingbat dec":"203","Dingbat hex":"CB","Unicode dec":"128618","Unicode hex":"1F66A"},{"Typeface name":"Wingdings","Dingbat dec":"204","Dingbat hex":"CC","Unicode dec":"128619","Unicode hex":"1F66B"},{"Typeface name":"Wingdings","Dingbat dec":"205","Dingbat hex":"CD","Unicode dec":"128597","Unicode hex":"1F655"},{"Typeface name":"Wingdings","Dingbat dec":"206","Dingbat hex":"CE","Unicode dec":"128596","Unicode hex":"1F654"},{"Typeface name":"Wingdings","Dingbat dec":"207","Dingbat hex":"CF","Unicode dec":"128599","Unicode hex":"1F657"},{"Typeface name":"Wingdings","Dingbat dec":"208","Dingbat hex":"D0","Unicode dec":"128598","Unicode hex":"1F656"},{"Typeface name":"Wingdings","Dingbat dec":"209","Dingbat hex":"D1","Unicode dec":"128592","Unicode hex":"1F650"},{"Typeface name":"Wingdings","Dingbat dec":"210","Dingbat hex":"D2","Unicode dec":"128593","Unicode hex":"1F651"},{"Typeface name":"Wingdings","Dingbat dec":"211","Dingbat hex":"D3","Unicode dec":"128594","Unicode hex":"1F652"},{"Typeface name":"Wingdings","Dingbat dec":"212","Dingbat hex":"D4","Unicode dec":"128595","Unicode hex":"1F653"},{"Typeface name":"Wingdings","Dingbat dec":"213","Dingbat hex":"D5","Unicode dec":"9003","Unicode hex":"232B"},{"Typeface name":"Wingdings","Dingbat dec":"214","Dingbat hex":"D6","Unicode dec":"8998","Unicode hex":"2326"},{"Typeface name":"Wingdings","Dingbat dec":"215","Dingbat hex":"D7","Unicode dec":"11160","Unicode hex":"2B98"},{"Typeface name":"Wingdings","Dingbat dec":"216","Dingbat hex":"D8","Unicode dec":"11162","Unicode hex":"2B9A"},{"Typeface name":"Wingdings","Dingbat dec":"217","Dingbat hex":"D9","Unicode dec":"11161","Unicode hex":"2B99"},{"Typeface name":"Wingdings","Dingbat dec":"218","Dingbat hex":"DA","Unicode dec":"11163","Unicode hex":"2B9B"},{"Typeface name":"Wingdings","Dingbat dec":"219","Dingbat hex":"DB","Unicode dec":"11144","Unicode hex":"2B88"},{"Typeface name":"Wingdings","Dingbat dec":"220","Dingbat hex":"DC","Unicode dec":"11146","Unicode hex":"2B8A"},{"Typeface name":"Wingdings","Dingbat dec":"221","Dingbat hex":"DD","Unicode dec":"11145","Unicode hex":"2B89"},{"Typeface name":"Wingdings","Dingbat dec":"222","Dingbat hex":"DE","Unicode dec":"11147","Unicode hex":"2B8B"},{"Typeface name":"Wingdings","Dingbat dec":"223","Dingbat hex":"DF","Unicode dec":"129128","Unicode hex":"1F868"},{"Typeface name":"Wingdings","Dingbat dec":"224","Dingbat hex":"E0","Unicode dec":"129130","Unicode hex":"1F86A"},{"Typeface name":"Wingdings","Dingbat dec":"225","Dingbat hex":"E1","Unicode dec":"129129","Unicode hex":"1F869"},{"Typeface name":"Wingdings","Dingbat dec":"226","Dingbat hex":"E2","Unicode dec":"129131","Unicode hex":"1F86B"},{"Typeface name":"Wingdings","Dingbat dec":"227","Dingbat hex":"E3","Unicode dec":"129132","Unicode hex":"1F86C"},{"Typeface name":"Wingdings","Dingbat dec":"228","Dingbat hex":"E4","Unicode dec":"129133","Unicode hex":"1F86D"},{"Typeface name":"Wingdings","Dingbat dec":"229","Dingbat hex":"E5","Unicode dec":"129135","Unicode hex":"1F86F"},{"Typeface name":"Wingdings","Dingbat dec":"230","Dingbat hex":"E6","Unicode dec":"129134","Unicode hex":"1F86E"},{"Typeface name":"Wingdings","Dingbat dec":"231","Dingbat hex":"E7","Unicode dec":"129144","Unicode hex":"1F878"},{"Typeface name":"Wingdings","Dingbat dec":"232","Dingbat hex":"E8","Unicode dec":"129146","Unicode hex":"1F87A"},{"Typeface name":"Wingdings","Dingbat dec":"233","Dingbat hex":"E9","Unicode dec":"129145","Unicode hex":"1F879"},{"Typeface name":"Wingdings","Dingbat dec":"234","Dingbat hex":"EA","Unicode dec":"129147","Unicode hex":"1F87B"},{"Typeface name":"Wingdings","Dingbat dec":"235","Dingbat hex":"EB","Unicode dec":"129148","Unicode hex":"1F87C"},{"Typeface name":"Wingdings","Dingbat dec":"236","Dingbat hex":"EC","Unicode dec":"129149","Unicode hex":"1F87D"},{"Typeface name":"Wingdings","Dingbat dec":"237","Dingbat hex":"ED","Unicode dec":"129151","Unicode hex":"1F87F"},{"Typeface name":"Wingdings","Dingbat dec":"238","Dingbat hex":"EE","Unicode dec":"129150","Unicode hex":"1F87E"},{"Typeface name":"Wingdings","Dingbat dec":"239","Dingbat hex":"EF","Unicode dec":"8678","Unicode hex":"21E6"},{"Typeface name":"Wingdings","Dingbat dec":"240","Dingbat hex":"F0","Unicode dec":"8680","Unicode hex":"21E8"},{"Typeface name":"Wingdings","Dingbat dec":"241","Dingbat hex":"F1","Unicode dec":"8679","Unicode hex":"21E7"},{"Typeface name":"Wingdings","Dingbat dec":"242","Dingbat hex":"F2","Unicode dec":"8681","Unicode hex":"21E9"},{"Typeface name":"Wingdings","Dingbat dec":"243","Dingbat hex":"F3","Unicode dec":"11012","Unicode hex":"2B04"},{"Typeface name":"Wingdings","Dingbat dec":"244","Dingbat hex":"F4","Unicode dec":"8691","Unicode hex":"21F3"},{"Typeface name":"Wingdings","Dingbat dec":"245","Dingbat hex":"F5","Unicode dec":"11009","Unicode hex":"2B01"},{"Typeface name":"Wingdings","Dingbat dec":"246","Dingbat hex":"F6","Unicode dec":"11008","Unicode hex":"2B00"},{"Typeface name":"Wingdings","Dingbat dec":"247","Dingbat hex":"F7","Unicode dec":"11011","Unicode hex":"2B03"},{"Typeface name":"Wingdings","Dingbat dec":"248","Dingbat hex":"F8","Unicode dec":"11010","Unicode hex":"2B02"},{"Typeface name":"Wingdings","Dingbat dec":"249","Dingbat hex":"F9","Unicode dec":"129196","Unicode hex":"1F8AC"},{"Typeface name":"Wingdings","Dingbat dec":"250","Dingbat hex":"FA","Unicode dec":"129197","Unicode hex":"1F8AD"},{"Typeface name":"Wingdings","Dingbat dec":"251","Dingbat hex":"FB","Unicode dec":"128502","Unicode hex":"1F5F6"},{"Typeface name":"Wingdings","Dingbat dec":"252","Dingbat hex":"FC","Unicode dec":"10003","Unicode hex":"2713"},{"Typeface name":"Wingdings","Dingbat dec":"253","Dingbat hex":"FD","Unicode dec":"128503","Unicode hex":"1F5F7"},{"Typeface name":"Wingdings","Dingbat dec":"254","Dingbat hex":"FE","Unicode dec":"128505","Unicode hex":"1F5F9"},{"Typeface name":"Wingdings 2","Dingbat dec":"32","Dingbat hex":"20","Unicode dec":"32","Unicode hex":"20"},{"Typeface name":"Wingdings 2","Dingbat dec":"33","Dingbat hex":"21","Unicode dec":"128394","Unicode hex":"1F58A"},{"Typeface name":"Wingdings 2","Dingbat dec":"34","Dingbat hex":"22","Unicode dec":"128395","Unicode hex":"1F58B"},{"Typeface name":"Wingdings 2","Dingbat dec":"35","Dingbat hex":"23","Unicode dec":"128396","Unicode hex":"1F58C"},{"Typeface name":"Wingdings 2","Dingbat dec":"36","Dingbat hex":"24","Unicode dec":"128397","Unicode hex":"1F58D"},{"Typeface name":"Wingdings 2","Dingbat dec":"37","Dingbat hex":"25","Unicode dec":"9988","Unicode hex":"2704"},{"Typeface name":"Wingdings 2","Dingbat dec":"38","Dingbat hex":"26","Unicode dec":"9984","Unicode hex":"2700"},{"Typeface name":"Wingdings 2","Dingbat dec":"39","Dingbat hex":"27","Unicode dec":"128382","Unicode hex":"1F57E"},{"Typeface name":"Wingdings 2","Dingbat dec":"40","Dingbat hex":"28","Unicode dec":"128381","Unicode hex":"1F57D"},{"Typeface name":"Wingdings 2","Dingbat dec":"41","Dingbat hex":"29","Unicode dec":"128453","Unicode hex":"1F5C5"},{"Typeface name":"Wingdings 2","Dingbat dec":"42","Dingbat hex":"2A","Unicode dec":"128454","Unicode hex":"1F5C6"},{"Typeface name":"Wingdings 2","Dingbat dec":"43","Dingbat hex":"2B","Unicode dec":"128455","Unicode hex":"1F5C7"},{"Typeface name":"Wingdings 2","Dingbat dec":"44","Dingbat hex":"2C","Unicode dec":"128456","Unicode hex":"1F5C8"},{"Typeface name":"Wingdings 2","Dingbat dec":"45","Dingbat hex":"2D","Unicode dec":"128457","Unicode hex":"1F5C9"},{"Typeface name":"Wingdings 2","Dingbat dec":"46","Dingbat hex":"2E","Unicode dec":"128458","Unicode hex":"1F5CA"},{"Typeface name":"Wingdings 2","Dingbat dec":"47","Dingbat hex":"2F","Unicode dec":"128459","Unicode hex":"1F5CB"},{"Typeface name":"Wingdings 2","Dingbat dec":"48","Dingbat hex":"30","Unicode dec":"128460","Unicode hex":"1F5CC"},{"Typeface name":"Wingdings 2","Dingbat dec":"49","Dingbat hex":"31","Unicode dec":"128461","Unicode hex":"1F5CD"},{"Typeface name":"Wingdings 2","Dingbat dec":"50","Dingbat hex":"32","Unicode dec":"128203","Unicode hex":"1F4CB"},{"Typeface name":"Wingdings 2","Dingbat dec":"51","Dingbat hex":"33","Unicode dec":"128465","Unicode hex":"1F5D1"},{"Typeface name":"Wingdings 2","Dingbat dec":"52","Dingbat hex":"34","Unicode dec":"128468","Unicode hex":"1F5D4"},{"Typeface name":"Wingdings 2","Dingbat dec":"53","Dingbat hex":"35","Unicode dec":"128437","Unicode hex":"1F5B5"},{"Typeface name":"Wingdings 2","Dingbat dec":"54","Dingbat hex":"36","Unicode dec":"128438","Unicode hex":"1F5B6"},{"Typeface name":"Wingdings 2","Dingbat dec":"55","Dingbat hex":"37","Unicode dec":"128439","Unicode hex":"1F5B7"},{"Typeface name":"Wingdings 2","Dingbat dec":"56","Dingbat hex":"38","Unicode dec":"128440","Unicode hex":"1F5B8"},{"Typeface name":"Wingdings 2","Dingbat dec":"57","Dingbat hex":"39","Unicode dec":"128429","Unicode hex":"1F5AD"},{"Typeface name":"Wingdings 2","Dingbat dec":"58","Dingbat hex":"3A","Unicode dec":"128431","Unicode hex":"1F5AF"},{"Typeface name":"Wingdings 2","Dingbat dec":"59","Dingbat hex":"3B","Unicode dec":"128433","Unicode hex":"1F5B1"},{"Typeface name":"Wingdings 2","Dingbat dec":"60","Dingbat hex":"3C","Unicode dec":"128402","Unicode hex":"1F592"},{"Typeface name":"Wingdings 2","Dingbat dec":"61","Dingbat hex":"3D","Unicode dec":"128403","Unicode hex":"1F593"},{"Typeface name":"Wingdings 2","Dingbat dec":"62","Dingbat hex":"3E","Unicode dec":"128408","Unicode hex":"1F598"},{"Typeface name":"Wingdings 2","Dingbat dec":"63","Dingbat hex":"3F","Unicode dec":"128409","Unicode hex":"1F599"},{"Typeface name":"Wingdings 2","Dingbat dec":"64","Dingbat hex":"40","Unicode dec":"128410","Unicode hex":"1F59A"},{"Typeface name":"Wingdings 2","Dingbat dec":"65","Dingbat hex":"41","Unicode dec":"128411","Unicode hex":"1F59B"},{"Typeface name":"Wingdings 2","Dingbat dec":"66","Dingbat hex":"42","Unicode dec":"128072","Unicode hex":"1F448"},{"Typeface name":"Wingdings 2","Dingbat dec":"67","Dingbat hex":"43","Unicode dec":"128073","Unicode hex":"1F449"},{"Typeface name":"Wingdings 2","Dingbat dec":"68","Dingbat hex":"44","Unicode dec":"128412","Unicode hex":"1F59C"},{"Typeface name":"Wingdings 2","Dingbat dec":"69","Dingbat hex":"45","Unicode dec":"128413","Unicode hex":"1F59D"},{"Typeface name":"Wingdings 2","Dingbat dec":"70","Dingbat hex":"46","Unicode dec":"128414","Unicode hex":"1F59E"},{"Typeface name":"Wingdings 2","Dingbat dec":"71","Dingbat hex":"47","Unicode dec":"128415","Unicode hex":"1F59F"},{"Typeface name":"Wingdings 2","Dingbat dec":"72","Dingbat hex":"48","Unicode dec":"128416","Unicode hex":"1F5A0"},{"Typeface name":"Wingdings 2","Dingbat dec":"73","Dingbat hex":"49","Unicode dec":"128417","Unicode hex":"1F5A1"},{"Typeface name":"Wingdings 2","Dingbat dec":"74","Dingbat hex":"4A","Unicode dec":"128070","Unicode hex":"1F446"},{"Typeface name":"Wingdings 2","Dingbat dec":"75","Dingbat hex":"4B","Unicode dec":"128071","Unicode hex":"1F447"},{"Typeface name":"Wingdings 2","Dingbat dec":"76","Dingbat hex":"4C","Unicode dec":"128418","Unicode hex":"1F5A2"},{"Typeface name":"Wingdings 2","Dingbat dec":"77","Dingbat hex":"4D","Unicode dec":"128419","Unicode hex":"1F5A3"},{"Typeface name":"Wingdings 2","Dingbat dec":"78","Dingbat hex":"4E","Unicode dec":"128401","Unicode hex":"1F591"},{"Typeface name":"Wingdings 2","Dingbat dec":"79","Dingbat hex":"4F","Unicode dec":"128500","Unicode hex":"1F5F4"},{"Typeface name":"Wingdings 2","Dingbat dec":"80","Dingbat hex":"50","Unicode dec":"128504","Unicode hex":"1F5F8"},{"Typeface name":"Wingdings 2","Dingbat dec":"81","Dingbat hex":"51","Unicode dec":"128501","Unicode hex":"1F5F5"},{"Typeface name":"Wingdings 2","Dingbat dec":"82","Dingbat hex":"52","Unicode dec":"9745","Unicode hex":"2611"},{"Typeface name":"Wingdings 2","Dingbat dec":"83","Dingbat hex":"53","Unicode dec":"11197","Unicode hex":"2BBD"},{"Typeface name":"Wingdings 2","Dingbat dec":"84","Dingbat hex":"54","Unicode dec":"9746","Unicode hex":"2612"},{"Typeface name":"Wingdings 2","Dingbat dec":"85","Dingbat hex":"55","Unicode dec":"11198","Unicode hex":"2BBE"},{"Typeface name":"Wingdings 2","Dingbat dec":"86","Dingbat hex":"56","Unicode dec":"11199","Unicode hex":"2BBF"},{"Typeface name":"Wingdings 2","Dingbat dec":"87","Dingbat hex":"57","Unicode dec":"128711","Unicode hex":"1F6C7"},{"Typeface name":"Wingdings 2","Dingbat dec":"88","Dingbat hex":"58","Unicode dec":"10680","Unicode hex":"29B8"},{"Typeface name":"Wingdings 2","Dingbat dec":"89","Dingbat hex":"59","Unicode dec":"128625","Unicode hex":"1F671"},{"Typeface name":"Wingdings 2","Dingbat dec":"90","Dingbat hex":"5A","Unicode dec":"128628","Unicode hex":"1F674"},{"Typeface name":"Wingdings 2","Dingbat dec":"91","Dingbat hex":"5B","Unicode dec":"128626","Unicode hex":"1F672"},{"Typeface name":"Wingdings 2","Dingbat dec":"92","Dingbat hex":"5C","Unicode dec":"128627","Unicode hex":"1F673"},{"Typeface name":"Wingdings 2","Dingbat dec":"93","Dingbat hex":"5D","Unicode dec":"8253","Unicode hex":"203D"},{"Typeface name":"Wingdings 2","Dingbat dec":"94","Dingbat hex":"5E","Unicode dec":"128633","Unicode hex":"1F679"},{"Typeface name":"Wingdings 2","Dingbat dec":"95","Dingbat hex":"5F","Unicode dec":"128634","Unicode hex":"1F67A"},{"Typeface name":"Wingdings 2","Dingbat dec":"96","Dingbat hex":"60","Unicode dec":"128635","Unicode hex":"1F67B"},{"Typeface name":"Wingdings 2","Dingbat dec":"97","Dingbat hex":"61","Unicode dec":"128614","Unicode hex":"1F666"},{"Typeface name":"Wingdings 2","Dingbat dec":"98","Dingbat hex":"62","Unicode dec":"128612","Unicode hex":"1F664"},{"Typeface name":"Wingdings 2","Dingbat dec":"99","Dingbat hex":"63","Unicode dec":"128613","Unicode hex":"1F665"},{"Typeface name":"Wingdings 2","Dingbat dec":"100","Dingbat hex":"64","Unicode dec":"128615","Unicode hex":"1F667"},{"Typeface name":"Wingdings 2","Dingbat dec":"101","Dingbat hex":"65","Unicode dec":"128602","Unicode hex":"1F65A"},{"Typeface name":"Wingdings 2","Dingbat dec":"102","Dingbat hex":"66","Unicode dec":"128600","Unicode hex":"1F658"},{"Typeface name":"Wingdings 2","Dingbat dec":"103","Dingbat hex":"67","Unicode dec":"128601","Unicode hex":"1F659"},{"Typeface name":"Wingdings 2","Dingbat dec":"104","Dingbat hex":"68","Unicode dec":"128603","Unicode hex":"1F65B"},{"Typeface name":"Wingdings 2","Dingbat dec":"105","Dingbat hex":"69","Unicode dec":"9450","Unicode hex":"24EA"},{"Typeface name":"Wingdings 2","Dingbat dec":"106","Dingbat hex":"6A","Unicode dec":"9312","Unicode hex":"2460"},{"Typeface name":"Wingdings 2","Dingbat dec":"107","Dingbat hex":"6B","Unicode dec":"9313","Unicode hex":"2461"},{"Typeface name":"Wingdings 2","Dingbat dec":"108","Dingbat hex":"6C","Unicode dec":"9314","Unicode hex":"2462"},{"Typeface name":"Wingdings 2","Dingbat dec":"109","Dingbat hex":"6D","Unicode dec":"9315","Unicode hex":"2463"},{"Typeface name":"Wingdings 2","Dingbat dec":"110","Dingbat hex":"6E","Unicode dec":"9316","Unicode hex":"2464"},{"Typeface name":"Wingdings 2","Dingbat dec":"111","Dingbat hex":"6F","Unicode dec":"9317","Unicode hex":"2465"},{"Typeface name":"Wingdings 2","Dingbat dec":"112","Dingbat hex":"70","Unicode dec":"9318","Unicode hex":"2466"},{"Typeface name":"Wingdings 2","Dingbat dec":"113","Dingbat hex":"71","Unicode dec":"9319","Unicode hex":"2467"},{"Typeface name":"Wingdings 2","Dingbat dec":"114","Dingbat hex":"72","Unicode dec":"9320","Unicode hex":"2468"},{"Typeface name":"Wingdings 2","Dingbat dec":"115","Dingbat hex":"73","Unicode dec":"9321","Unicode hex":"2469"},{"Typeface name":"Wingdings 2","Dingbat dec":"116","Dingbat hex":"74","Unicode dec":"9471","Unicode hex":"24FF"},{"Typeface name":"Wingdings 2","Dingbat dec":"117","Dingbat hex":"75","Unicode dec":"10102","Unicode hex":"2776"},{"Typeface name":"Wingdings 2","Dingbat dec":"118","Dingbat hex":"76","Unicode dec":"10103","Unicode hex":"2777"},{"Typeface name":"Wingdings 2","Dingbat dec":"119","Dingbat hex":"77","Unicode dec":"10104","Unicode hex":"2778"},{"Typeface name":"Wingdings 2","Dingbat dec":"120","Dingbat hex":"78","Unicode dec":"10105","Unicode hex":"2779"},{"Typeface name":"Wingdings 2","Dingbat dec":"121","Dingbat hex":"79","Unicode dec":"10106","Unicode hex":"277A"},{"Typeface name":"Wingdings 2","Dingbat dec":"122","Dingbat hex":"7A","Unicode dec":"10107","Unicode hex":"277B"},{"Typeface name":"Wingdings 2","Dingbat dec":"123","Dingbat hex":"7B","Unicode dec":"10108","Unicode hex":"277C"},{"Typeface name":"Wingdings 2","Dingbat dec":"124","Dingbat hex":"7C","Unicode dec":"10109","Unicode hex":"277D"},{"Typeface name":"Wingdings 2","Dingbat dec":"125","Dingbat hex":"7D","Unicode dec":"10110","Unicode hex":"277E"},{"Typeface name":"Wingdings 2","Dingbat dec":"126","Dingbat hex":"7E","Unicode dec":"10111","Unicode hex":"277F"},{"Typeface name":"Wingdings 2","Dingbat dec":"128","Dingbat hex":"80","Unicode dec":"9737","Unicode hex":"2609"},{"Typeface name":"Wingdings 2","Dingbat dec":"129","Dingbat hex":"81","Unicode dec":"127765","Unicode hex":"1F315"},{"Typeface name":"Wingdings 2","Dingbat dec":"130","Dingbat hex":"82","Unicode dec":"9789","Unicode hex":"263D"},{"Typeface name":"Wingdings 2","Dingbat dec":"131","Dingbat hex":"83","Unicode dec":"9790","Unicode hex":"263E"},{"Typeface name":"Wingdings 2","Dingbat dec":"132","Dingbat hex":"84","Unicode dec":"11839","Unicode hex":"2E3F"},{"Typeface name":"Wingdings 2","Dingbat dec":"133","Dingbat hex":"85","Unicode dec":"10013","Unicode hex":"271D"},{"Typeface name":"Wingdings 2","Dingbat dec":"134","Dingbat hex":"86","Unicode dec":"128327","Unicode hex":"1F547"},{"Typeface name":"Wingdings 2","Dingbat dec":"135","Dingbat hex":"87","Unicode dec":"128348","Unicode hex":"1F55C"},{"Typeface name":"Wingdings 2","Dingbat dec":"136","Dingbat hex":"88","Unicode dec":"128349","Unicode hex":"1F55D"},{"Typeface name":"Wingdings 2","Dingbat dec":"137","Dingbat hex":"89","Unicode dec":"128350","Unicode hex":"1F55E"},{"Typeface name":"Wingdings 2","Dingbat dec":"138","Dingbat hex":"8A","Unicode dec":"128351","Unicode hex":"1F55F"},{"Typeface name":"Wingdings 2","Dingbat dec":"139","Dingbat hex":"8B","Unicode dec":"128352","Unicode hex":"1F560"},{"Typeface name":"Wingdings 2","Dingbat dec":"140","Dingbat hex":"8C","Unicode dec":"128353","Unicode hex":"1F561"},{"Typeface name":"Wingdings 2","Dingbat dec":"141","Dingbat hex":"8D","Unicode dec":"128354","Unicode hex":"1F562"},{"Typeface name":"Wingdings 2","Dingbat dec":"142","Dingbat hex":"8E","Unicode dec":"128355","Unicode hex":"1F563"},{"Typeface name":"Wingdings 2","Dingbat dec":"143","Dingbat hex":"8F","Unicode dec":"128356","Unicode hex":"1F564"},{"Typeface name":"Wingdings 2","Dingbat dec":"144","Dingbat hex":"90","Unicode dec":"128357","Unicode hex":"1F565"},{"Typeface name":"Wingdings 2","Dingbat dec":"145","Dingbat hex":"91","Unicode dec":"128358","Unicode hex":"1F566"},{"Typeface name":"Wingdings 2","Dingbat dec":"146","Dingbat hex":"92","Unicode dec":"128359","Unicode hex":"1F567"},{"Typeface name":"Wingdings 2","Dingbat dec":"147","Dingbat hex":"93","Unicode dec":"128616","Unicode hex":"1F668"},{"Typeface name":"Wingdings 2","Dingbat dec":"148","Dingbat hex":"94","Unicode dec":"128617","Unicode hex":"1F669"},{"Typeface name":"Wingdings 2","Dingbat dec":"149","Dingbat hex":"95","Unicode dec":"8901","Unicode hex":"22C5"},{"Typeface name":"Wingdings 2","Dingbat dec":"150","Dingbat hex":"96","Unicode dec":"128900","Unicode hex":"1F784"},{"Typeface name":"Wingdings 2","Dingbat dec":"151","Dingbat hex":"97","Unicode dec":"10625","Unicode hex":"2981"},{"Typeface name":"Wingdings 2","Dingbat dec":"152","Dingbat hex":"98","Unicode dec":"9679","Unicode hex":"25CF"},{"Typeface name":"Wingdings 2","Dingbat dec":"153","Dingbat hex":"99","Unicode dec":"9675","Unicode hex":"25CB"},{"Typeface name":"Wingdings 2","Dingbat dec":"154","Dingbat hex":"9A","Unicode dec":"128901","Unicode hex":"1F785"},{"Typeface name":"Wingdings 2","Dingbat dec":"155","Dingbat hex":"9B","Unicode dec":"128903","Unicode hex":"1F787"},{"Typeface name":"Wingdings 2","Dingbat dec":"156","Dingbat hex":"9C","Unicode dec":"128905","Unicode hex":"1F789"},{"Typeface name":"Wingdings 2","Dingbat dec":"157","Dingbat hex":"9D","Unicode dec":"8857","Unicode hex":"2299"},{"Typeface name":"Wingdings 2","Dingbat dec":"158","Dingbat hex":"9E","Unicode dec":"10687","Unicode hex":"29BF"},{"Typeface name":"Wingdings 2","Dingbat dec":"159","Dingbat hex":"9F","Unicode dec":"128908","Unicode hex":"1F78C"},{"Typeface name":"Wingdings 2","Dingbat dec":"160","Dingbat hex":"A0","Unicode dec":"128909","Unicode hex":"1F78D"},{"Typeface name":"Wingdings 2","Dingbat dec":"161","Dingbat hex":"A1","Unicode dec":"9726","Unicode hex":"25FE"},{"Typeface name":"Wingdings 2","Dingbat dec":"162","Dingbat hex":"A2","Unicode dec":"9632","Unicode hex":"25A0"},{"Typeface name":"Wingdings 2","Dingbat dec":"163","Dingbat hex":"A3","Unicode dec":"9633","Unicode hex":"25A1"},{"Typeface name":"Wingdings 2","Dingbat dec":"164","Dingbat hex":"A4","Unicode dec":"128913","Unicode hex":"1F791"},{"Typeface name":"Wingdings 2","Dingbat dec":"165","Dingbat hex":"A5","Unicode dec":"128914","Unicode hex":"1F792"},{"Typeface name":"Wingdings 2","Dingbat dec":"166","Dingbat hex":"A6","Unicode dec":"128915","Unicode hex":"1F793"},{"Typeface name":"Wingdings 2","Dingbat dec":"167","Dingbat hex":"A7","Unicode dec":"128916","Unicode hex":"1F794"},{"Typeface name":"Wingdings 2","Dingbat dec":"168","Dingbat hex":"A8","Unicode dec":"9635","Unicode hex":"25A3"},{"Typeface name":"Wingdings 2","Dingbat dec":"169","Dingbat hex":"A9","Unicode dec":"128917","Unicode hex":"1F795"},{"Typeface name":"Wingdings 2","Dingbat dec":"170","Dingbat hex":"AA","Unicode dec":"128918","Unicode hex":"1F796"},{"Typeface name":"Wingdings 2","Dingbat dec":"171","Dingbat hex":"AB","Unicode dec":"128919","Unicode hex":"1F797"},{"Typeface name":"Wingdings 2","Dingbat dec":"172","Dingbat hex":"AC","Unicode dec":"128920","Unicode hex":"1F798"},{"Typeface name":"Wingdings 2","Dingbat dec":"173","Dingbat hex":"AD","Unicode dec":"11049","Unicode hex":"2B29"},{"Typeface name":"Wingdings 2","Dingbat dec":"174","Dingbat hex":"AE","Unicode dec":"11045","Unicode hex":"2B25"},{"Typeface name":"Wingdings 2","Dingbat dec":"175","Dingbat hex":"AF","Unicode dec":"9671","Unicode hex":"25C7"},{"Typeface name":"Wingdings 2","Dingbat dec":"176","Dingbat hex":"B0","Unicode dec":"128922","Unicode hex":"1F79A"},{"Typeface name":"Wingdings 2","Dingbat dec":"177","Dingbat hex":"B1","Unicode dec":"9672","Unicode hex":"25C8"},{"Typeface name":"Wingdings 2","Dingbat dec":"178","Dingbat hex":"B2","Unicode dec":"128923","Unicode hex":"1F79B"},{"Typeface name":"Wingdings 2","Dingbat dec":"179","Dingbat hex":"B3","Unicode dec":"128924","Unicode hex":"1F79C"},{"Typeface name":"Wingdings 2","Dingbat dec":"180","Dingbat hex":"B4","Unicode dec":"128925","Unicode hex":"1F79D"},{"Typeface name":"Wingdings 2","Dingbat dec":"181","Dingbat hex":"B5","Unicode dec":"128926","Unicode hex":"1F79E"},{"Typeface name":"Wingdings 2","Dingbat dec":"182","Dingbat hex":"B6","Unicode dec":"11050","Unicode hex":"2B2A"},{"Typeface name":"Wingdings 2","Dingbat dec":"183","Dingbat hex":"B7","Unicode dec":"11047","Unicode hex":"2B27"},{"Typeface name":"Wingdings 2","Dingbat dec":"184","Dingbat hex":"B8","Unicode dec":"9674","Unicode hex":"25CA"},{"Typeface name":"Wingdings 2","Dingbat dec":"185","Dingbat hex":"B9","Unicode dec":"128928","Unicode hex":"1F7A0"},{"Typeface name":"Wingdings 2","Dingbat dec":"186","Dingbat hex":"BA","Unicode dec":"9686","Unicode hex":"25D6"},{"Typeface name":"Wingdings 2","Dingbat dec":"187","Dingbat hex":"BB","Unicode dec":"9687","Unicode hex":"25D7"},{"Typeface name":"Wingdings 2","Dingbat dec":"188","Dingbat hex":"BC","Unicode dec":"11210","Unicode hex":"2BCA"},{"Typeface name":"Wingdings 2","Dingbat dec":"189","Dingbat hex":"BD","Unicode dec":"11211","Unicode hex":"2BCB"},{"Typeface name":"Wingdings 2","Dingbat dec":"190","Dingbat hex":"BE","Unicode dec":"11200","Unicode hex":"2BC0"},{"Typeface name":"Wingdings 2","Dingbat dec":"191","Dingbat hex":"BF","Unicode dec":"11201","Unicode hex":"2BC1"},{"Typeface name":"Wingdings 2","Dingbat dec":"192","Dingbat hex":"C0","Unicode dec":"11039","Unicode hex":"2B1F"},{"Typeface name":"Wingdings 2","Dingbat dec":"193","Dingbat hex":"C1","Unicode dec":"11202","Unicode hex":"2BC2"},{"Typeface name":"Wingdings 2","Dingbat dec":"194","Dingbat hex":"C2","Unicode dec":"11043","Unicode hex":"2B23"},{"Typeface name":"Wingdings 2","Dingbat dec":"195","Dingbat hex":"C3","Unicode dec":"11042","Unicode hex":"2B22"},{"Typeface name":"Wingdings 2","Dingbat dec":"196","Dingbat hex":"C4","Unicode dec":"11203","Unicode hex":"2BC3"},{"Typeface name":"Wingdings 2","Dingbat dec":"197","Dingbat hex":"C5","Unicode dec":"11204","Unicode hex":"2BC4"},{"Typeface name":"Wingdings 2","Dingbat dec":"198","Dingbat hex":"C6","Unicode dec":"128929","Unicode hex":"1F7A1"},{"Typeface name":"Wingdings 2","Dingbat dec":"199","Dingbat hex":"C7","Unicode dec":"128930","Unicode hex":"1F7A2"},{"Typeface name":"Wingdings 2","Dingbat dec":"200","Dingbat hex":"C8","Unicode dec":"128931","Unicode hex":"1F7A3"},{"Typeface name":"Wingdings 2","Dingbat dec":"201","Dingbat hex":"C9","Unicode dec":"128932","Unicode hex":"1F7A4"},{"Typeface name":"Wingdings 2","Dingbat dec":"202","Dingbat hex":"CA","Unicode dec":"128933","Unicode hex":"1F7A5"},{"Typeface name":"Wingdings 2","Dingbat dec":"203","Dingbat hex":"CB","Unicode dec":"128934","Unicode hex":"1F7A6"},{"Typeface name":"Wingdings 2","Dingbat dec":"204","Dingbat hex":"CC","Unicode dec":"128935","Unicode hex":"1F7A7"},{"Typeface name":"Wingdings 2","Dingbat dec":"205","Dingbat hex":"CD","Unicode dec":"128936","Unicode hex":"1F7A8"},{"Typeface name":"Wingdings 2","Dingbat dec":"206","Dingbat hex":"CE","Unicode dec":"128937","Unicode hex":"1F7A9"},{"Typeface name":"Wingdings 2","Dingbat dec":"207","Dingbat hex":"CF","Unicode dec":"128938","Unicode hex":"1F7AA"},{"Typeface name":"Wingdings 2","Dingbat dec":"208","Dingbat hex":"D0","Unicode dec":"128939","Unicode hex":"1F7AB"},{"Typeface name":"Wingdings 2","Dingbat dec":"209","Dingbat hex":"D1","Unicode dec":"128940","Unicode hex":"1F7AC"},{"Typeface name":"Wingdings 2","Dingbat dec":"210","Dingbat hex":"D2","Unicode dec":"128941","Unicode hex":"1F7AD"},{"Typeface name":"Wingdings 2","Dingbat dec":"211","Dingbat hex":"D3","Unicode dec":"128942","Unicode hex":"1F7AE"},{"Typeface name":"Wingdings 2","Dingbat dec":"212","Dingbat hex":"D4","Unicode dec":"128943","Unicode hex":"1F7AF"},{"Typeface name":"Wingdings 2","Dingbat dec":"213","Dingbat hex":"D5","Unicode dec":"128944","Unicode hex":"1F7B0"},{"Typeface name":"Wingdings 2","Dingbat dec":"214","Dingbat hex":"D6","Unicode dec":"128945","Unicode hex":"1F7B1"},{"Typeface name":"Wingdings 2","Dingbat dec":"215","Dingbat hex":"D7","Unicode dec":"128946","Unicode hex":"1F7B2"},{"Typeface name":"Wingdings 2","Dingbat dec":"216","Dingbat hex":"D8","Unicode dec":"128947","Unicode hex":"1F7B3"},{"Typeface name":"Wingdings 2","Dingbat dec":"217","Dingbat hex":"D9","Unicode dec":"128948","Unicode hex":"1F7B4"},{"Typeface name":"Wingdings 2","Dingbat dec":"218","Dingbat hex":"DA","Unicode dec":"128949","Unicode hex":"1F7B5"},{"Typeface name":"Wingdings 2","Dingbat dec":"219","Dingbat hex":"DB","Unicode dec":"128950","Unicode hex":"1F7B6"},{"Typeface name":"Wingdings 2","Dingbat dec":"220","Dingbat hex":"DC","Unicode dec":"128951","Unicode hex":"1F7B7"},{"Typeface name":"Wingdings 2","Dingbat dec":"221","Dingbat hex":"DD","Unicode dec":"128952","Unicode hex":"1F7B8"},{"Typeface name":"Wingdings 2","Dingbat dec":"222","Dingbat hex":"DE","Unicode dec":"128953","Unicode hex":"1F7B9"},{"Typeface name":"Wingdings 2","Dingbat dec":"223","Dingbat hex":"DF","Unicode dec":"128954","Unicode hex":"1F7BA"},{"Typeface name":"Wingdings 2","Dingbat dec":"224","Dingbat hex":"E0","Unicode dec":"128955","Unicode hex":"1F7BB"},{"Typeface name":"Wingdings 2","Dingbat dec":"225","Dingbat hex":"E1","Unicode dec":"128956","Unicode hex":"1F7BC"},{"Typeface name":"Wingdings 2","Dingbat dec":"226","Dingbat hex":"E2","Unicode dec":"128957","Unicode hex":"1F7BD"},{"Typeface name":"Wingdings 2","Dingbat dec":"227","Dingbat hex":"E3","Unicode dec":"128958","Unicode hex":"1F7BE"},{"Typeface name":"Wingdings 2","Dingbat dec":"228","Dingbat hex":"E4","Unicode dec":"128959","Unicode hex":"1F7BF"},{"Typeface name":"Wingdings 2","Dingbat dec":"229","Dingbat hex":"E5","Unicode dec":"128960","Unicode hex":"1F7C0"},{"Typeface name":"Wingdings 2","Dingbat dec":"230","Dingbat hex":"E6","Unicode dec":"128962","Unicode hex":"1F7C2"},{"Typeface name":"Wingdings 2","Dingbat dec":"231","Dingbat hex":"E7","Unicode dec":"128964","Unicode hex":"1F7C4"},{"Typeface name":"Wingdings 2","Dingbat dec":"232","Dingbat hex":"E8","Unicode dec":"128966","Unicode hex":"1F7C6"},{"Typeface name":"Wingdings 2","Dingbat dec":"233","Dingbat hex":"E9","Unicode dec":"128969","Unicode hex":"1F7C9"},{"Typeface name":"Wingdings 2","Dingbat dec":"234","Dingbat hex":"EA","Unicode dec":"128970","Unicode hex":"1F7CA"},{"Typeface name":"Wingdings 2","Dingbat dec":"235","Dingbat hex":"EB","Unicode dec":"10038","Unicode hex":"2736"},{"Typeface name":"Wingdings 2","Dingbat dec":"236","Dingbat hex":"EC","Unicode dec":"128972","Unicode hex":"1F7CC"},{"Typeface name":"Wingdings 2","Dingbat dec":"237","Dingbat hex":"ED","Unicode dec":"128974","Unicode hex":"1F7CE"},{"Typeface name":"Wingdings 2","Dingbat dec":"238","Dingbat hex":"EE","Unicode dec":"128976","Unicode hex":"1F7D0"},{"Typeface name":"Wingdings 2","Dingbat dec":"239","Dingbat hex":"EF","Unicode dec":"128978","Unicode hex":"1F7D2"},{"Typeface name":"Wingdings 2","Dingbat dec":"240","Dingbat hex":"F0","Unicode dec":"10041","Unicode hex":"2739"},{"Typeface name":"Wingdings 2","Dingbat dec":"241","Dingbat hex":"F1","Unicode dec":"128963","Unicode hex":"1F7C3"},{"Typeface name":"Wingdings 2","Dingbat dec":"242","Dingbat hex":"F2","Unicode dec":"128967","Unicode hex":"1F7C7"},{"Typeface name":"Wingdings 2","Dingbat dec":"243","Dingbat hex":"F3","Unicode dec":"10031","Unicode hex":"272F"},{"Typeface name":"Wingdings 2","Dingbat dec":"244","Dingbat hex":"F4","Unicode dec":"128973","Unicode hex":"1F7CD"},{"Typeface name":"Wingdings 2","Dingbat dec":"245","Dingbat hex":"F5","Unicode dec":"128980","Unicode hex":"1F7D4"},{"Typeface name":"Wingdings 2","Dingbat dec":"246","Dingbat hex":"F6","Unicode dec":"11212","Unicode hex":"2BCC"},{"Typeface name":"Wingdings 2","Dingbat dec":"247","Dingbat hex":"F7","Unicode dec":"11213","Unicode hex":"2BCD"},{"Typeface name":"Wingdings 2","Dingbat dec":"248","Dingbat hex":"F8","Unicode dec":"8251","Unicode hex":"203B"},{"Typeface name":"Wingdings 2","Dingbat dec":"249","Dingbat hex":"F9","Unicode dec":"8258","Unicode hex":"2042"},{"Typeface name":"Wingdings 3","Dingbat dec":"32","Dingbat hex":"20","Unicode dec":"32","Unicode hex":"20"},{"Typeface name":"Wingdings 3","Dingbat dec":"33","Dingbat hex":"21","Unicode dec":"11104","Unicode hex":"2B60"},{"Typeface name":"Wingdings 3","Dingbat dec":"34","Dingbat hex":"22","Unicode dec":"11106","Unicode hex":"2B62"},{"Typeface name":"Wingdings 3","Dingbat dec":"35","Dingbat hex":"23","Unicode dec":"11105","Unicode hex":"2B61"},{"Typeface name":"Wingdings 3","Dingbat dec":"36","Dingbat hex":"24","Unicode dec":"11107","Unicode hex":"2B63"},{"Typeface name":"Wingdings 3","Dingbat dec":"37","Dingbat hex":"25","Unicode dec":"11110","Unicode hex":"2B66"},{"Typeface name":"Wingdings 3","Dingbat dec":"38","Dingbat hex":"26","Unicode dec":"11111","Unicode hex":"2B67"},{"Typeface name":"Wingdings 3","Dingbat dec":"39","Dingbat hex":"27","Unicode dec":"11113","Unicode hex":"2B69"},{"Typeface name":"Wingdings 3","Dingbat dec":"40","Dingbat hex":"28","Unicode dec":"11112","Unicode hex":"2B68"},{"Typeface name":"Wingdings 3","Dingbat dec":"41","Dingbat hex":"29","Unicode dec":"11120","Unicode hex":"2B70"},{"Typeface name":"Wingdings 3","Dingbat dec":"42","Dingbat hex":"2A","Unicode dec":"11122","Unicode hex":"2B72"},{"Typeface name":"Wingdings 3","Dingbat dec":"43","Dingbat hex":"2B","Unicode dec":"11121","Unicode hex":"2B71"},{"Typeface name":"Wingdings 3","Dingbat dec":"44","Dingbat hex":"2C","Unicode dec":"11123","Unicode hex":"2B73"},{"Typeface name":"Wingdings 3","Dingbat dec":"45","Dingbat hex":"2D","Unicode dec":"11126","Unicode hex":"2B76"},{"Typeface name":"Wingdings 3","Dingbat dec":"46","Dingbat hex":"2E","Unicode dec":"11128","Unicode hex":"2B78"},{"Typeface name":"Wingdings 3","Dingbat dec":"47","Dingbat hex":"2F","Unicode dec":"11131","Unicode hex":"2B7B"},{"Typeface name":"Wingdings 3","Dingbat dec":"48","Dingbat hex":"30","Unicode dec":"11133","Unicode hex":"2B7D"},{"Typeface name":"Wingdings 3","Dingbat dec":"49","Dingbat hex":"31","Unicode dec":"11108","Unicode hex":"2B64"},{"Typeface name":"Wingdings 3","Dingbat dec":"50","Dingbat hex":"32","Unicode dec":"11109","Unicode hex":"2B65"},{"Typeface name":"Wingdings 3","Dingbat dec":"51","Dingbat hex":"33","Unicode dec":"11114","Unicode hex":"2B6A"},{"Typeface name":"Wingdings 3","Dingbat dec":"52","Dingbat hex":"34","Unicode dec":"11116","Unicode hex":"2B6C"},{"Typeface name":"Wingdings 3","Dingbat dec":"53","Dingbat hex":"35","Unicode dec":"11115","Unicode hex":"2B6B"},{"Typeface name":"Wingdings 3","Dingbat dec":"54","Dingbat hex":"36","Unicode dec":"11117","Unicode hex":"2B6D"},{"Typeface name":"Wingdings 3","Dingbat dec":"55","Dingbat hex":"37","Unicode dec":"11085","Unicode hex":"2B4D"},{"Typeface name":"Wingdings 3","Dingbat dec":"56","Dingbat hex":"38","Unicode dec":"11168","Unicode hex":"2BA0"},{"Typeface name":"Wingdings 3","Dingbat dec":"57","Dingbat hex":"39","Unicode dec":"11169","Unicode hex":"2BA1"},{"Typeface name":"Wingdings 3","Dingbat dec":"58","Dingbat hex":"3A","Unicode dec":"11170","Unicode hex":"2BA2"},{"Typeface name":"Wingdings 3","Dingbat dec":"59","Dingbat hex":"3B","Unicode dec":"11171","Unicode hex":"2BA3"},{"Typeface name":"Wingdings 3","Dingbat dec":"60","Dingbat hex":"3C","Unicode dec":"11172","Unicode hex":"2BA4"},{"Typeface name":"Wingdings 3","Dingbat dec":"61","Dingbat hex":"3D","Unicode dec":"11173","Unicode hex":"2BA5"},{"Typeface name":"Wingdings 3","Dingbat dec":"62","Dingbat hex":"3E","Unicode dec":"11174","Unicode hex":"2BA6"},{"Typeface name":"Wingdings 3","Dingbat dec":"63","Dingbat hex":"3F","Unicode dec":"11175","Unicode hex":"2BA7"},{"Typeface name":"Wingdings 3","Dingbat dec":"64","Dingbat hex":"40","Unicode dec":"11152","Unicode hex":"2B90"},{"Typeface name":"Wingdings 3","Dingbat dec":"65","Dingbat hex":"41","Unicode dec":"11153","Unicode hex":"2B91"},{"Typeface name":"Wingdings 3","Dingbat dec":"66","Dingbat hex":"42","Unicode dec":"11154","Unicode hex":"2B92"},{"Typeface name":"Wingdings 3","Dingbat dec":"67","Dingbat hex":"43","Unicode dec":"11155","Unicode hex":"2B93"},{"Typeface name":"Wingdings 3","Dingbat dec":"68","Dingbat hex":"44","Unicode dec":"11136","Unicode hex":"2B80"},{"Typeface name":"Wingdings 3","Dingbat dec":"69","Dingbat hex":"45","Unicode dec":"11139","Unicode hex":"2B83"},{"Typeface name":"Wingdings 3","Dingbat dec":"70","Dingbat hex":"46","Unicode dec":"11134","Unicode hex":"2B7E"},{"Typeface name":"Wingdings 3","Dingbat dec":"71","Dingbat hex":"47","Unicode dec":"11135","Unicode hex":"2B7F"},{"Typeface name":"Wingdings 3","Dingbat dec":"72","Dingbat hex":"48","Unicode dec":"11140","Unicode hex":"2B84"},{"Typeface name":"Wingdings 3","Dingbat dec":"73","Dingbat hex":"49","Unicode dec":"11142","Unicode hex":"2B86"},{"Typeface name":"Wingdings 3","Dingbat dec":"74","Dingbat hex":"4A","Unicode dec":"11141","Unicode hex":"2B85"},{"Typeface name":"Wingdings 3","Dingbat dec":"75","Dingbat hex":"4B","Unicode dec":"11143","Unicode hex":"2B87"},{"Typeface name":"Wingdings 3","Dingbat dec":"76","Dingbat hex":"4C","Unicode dec":"11151","Unicode hex":"2B8F"},{"Typeface name":"Wingdings 3","Dingbat dec":"77","Dingbat hex":"4D","Unicode dec":"11149","Unicode hex":"2B8D"},{"Typeface name":"Wingdings 3","Dingbat dec":"78","Dingbat hex":"4E","Unicode dec":"11150","Unicode hex":"2B8E"},{"Typeface name":"Wingdings 3","Dingbat dec":"79","Dingbat hex":"4F","Unicode dec":"11148","Unicode hex":"2B8C"},{"Typeface name":"Wingdings 3","Dingbat dec":"80","Dingbat hex":"50","Unicode dec":"11118","Unicode hex":"2B6E"},{"Typeface name":"Wingdings 3","Dingbat dec":"81","Dingbat hex":"51","Unicode dec":"11119","Unicode hex":"2B6F"},{"Typeface name":"Wingdings 3","Dingbat dec":"82","Dingbat hex":"52","Unicode dec":"9099","Unicode hex":"238B"},{"Typeface name":"Wingdings 3","Dingbat dec":"83","Dingbat hex":"53","Unicode dec":"8996","Unicode hex":"2324"},{"Typeface name":"Wingdings 3","Dingbat dec":"84","Dingbat hex":"54","Unicode dec":"8963","Unicode hex":"2303"},{"Typeface name":"Wingdings 3","Dingbat dec":"85","Dingbat hex":"55","Unicode dec":"8997","Unicode hex":"2325"},{"Typeface name":"Wingdings 3","Dingbat dec":"86","Dingbat hex":"56","Unicode dec":"9251","Unicode hex":"2423"},{"Typeface name":"Wingdings 3","Dingbat dec":"87","Dingbat hex":"57","Unicode dec":"9085","Unicode hex":"237D"},{"Typeface name":"Wingdings 3","Dingbat dec":"88","Dingbat hex":"58","Unicode dec":"8682","Unicode hex":"21EA"},{"Typeface name":"Wingdings 3","Dingbat dec":"89","Dingbat hex":"59","Unicode dec":"11192","Unicode hex":"2BB8"},{"Typeface name":"Wingdings 3","Dingbat dec":"90","Dingbat hex":"5A","Unicode dec":"129184","Unicode hex":"1F8A0"},{"Typeface name":"Wingdings 3","Dingbat dec":"91","Dingbat hex":"5B","Unicode dec":"129185","Unicode hex":"1F8A1"},{"Typeface name":"Wingdings 3","Dingbat dec":"92","Dingbat hex":"5C","Unicode dec":"129186","Unicode hex":"1F8A2"},{"Typeface name":"Wingdings 3","Dingbat dec":"93","Dingbat hex":"5D","Unicode dec":"129187","Unicode hex":"1F8A3"},{"Typeface name":"Wingdings 3","Dingbat dec":"94","Dingbat hex":"5E","Unicode dec":"129188","Unicode hex":"1F8A4"},{"Typeface name":"Wingdings 3","Dingbat dec":"95","Dingbat hex":"5F","Unicode dec":"129189","Unicode hex":"1F8A5"},{"Typeface name":"Wingdings 3","Dingbat dec":"96","Dingbat hex":"60","Unicode dec":"129190","Unicode hex":"1F8A6"},{"Typeface name":"Wingdings 3","Dingbat dec":"97","Dingbat hex":"61","Unicode dec":"129191","Unicode hex":"1F8A7"},{"Typeface name":"Wingdings 3","Dingbat dec":"98","Dingbat hex":"62","Unicode dec":"129192","Unicode hex":"1F8A8"},{"Typeface name":"Wingdings 3","Dingbat dec":"99","Dingbat hex":"63","Unicode dec":"129193","Unicode hex":"1F8A9"},{"Typeface name":"Wingdings 3","Dingbat dec":"100","Dingbat hex":"64","Unicode dec":"129194","Unicode hex":"1F8AA"},{"Typeface name":"Wingdings 3","Dingbat dec":"101","Dingbat hex":"65","Unicode dec":"129195","Unicode hex":"1F8AB"},{"Typeface name":"Wingdings 3","Dingbat dec":"102","Dingbat hex":"66","Unicode dec":"129104","Unicode hex":"1F850"},{"Typeface name":"Wingdings 3","Dingbat dec":"103","Dingbat hex":"67","Unicode dec":"129106","Unicode hex":"1F852"},{"Typeface name":"Wingdings 3","Dingbat dec":"104","Dingbat hex":"68","Unicode dec":"129105","Unicode hex":"1F851"},{"Typeface name":"Wingdings 3","Dingbat dec":"105","Dingbat hex":"69","Unicode dec":"129107","Unicode hex":"1F853"},{"Typeface name":"Wingdings 3","Dingbat dec":"106","Dingbat hex":"6A","Unicode dec":"129108","Unicode hex":"1F854"},{"Typeface name":"Wingdings 3","Dingbat dec":"107","Dingbat hex":"6B","Unicode dec":"129109","Unicode hex":"1F855"},{"Typeface name":"Wingdings 3","Dingbat dec":"108","Dingbat hex":"6C","Unicode dec":"129111","Unicode hex":"1F857"},{"Typeface name":"Wingdings 3","Dingbat dec":"109","Dingbat hex":"6D","Unicode dec":"129110","Unicode hex":"1F856"},{"Typeface name":"Wingdings 3","Dingbat dec":"110","Dingbat hex":"6E","Unicode dec":"129112","Unicode hex":"1F858"},{"Typeface name":"Wingdings 3","Dingbat dec":"111","Dingbat hex":"6F","Unicode dec":"129113","Unicode hex":"1F859"},{"Typeface name":"Wingdings 3","Dingbat dec":"112","Dingbat hex":"70","Unicode dec":"9650","Unicode hex":"25B2"},{"Typeface name":"Wingdings 3","Dingbat dec":"113","Dingbat hex":"71","Unicode dec":"9660","Unicode hex":"25BC"},{"Typeface name":"Wingdings 3","Dingbat dec":"114","Dingbat hex":"72","Unicode dec":"9651","Unicode hex":"25B3"},{"Typeface name":"Wingdings 3","Dingbat dec":"115","Dingbat hex":"73","Unicode dec":"9661","Unicode hex":"25BD"},{"Typeface name":"Wingdings 3","Dingbat dec":"116","Dingbat hex":"74","Unicode dec":"9664","Unicode hex":"25C0"},{"Typeface name":"Wingdings 3","Dingbat dec":"117","Dingbat hex":"75","Unicode dec":"9654","Unicode hex":"25B6"},{"Typeface name":"Wingdings 3","Dingbat dec":"118","Dingbat hex":"76","Unicode dec":"9665","Unicode hex":"25C1"},{"Typeface name":"Wingdings 3","Dingbat dec":"119","Dingbat hex":"77","Unicode dec":"9655","Unicode hex":"25B7"},{"Typeface name":"Wingdings 3","Dingbat dec":"120","Dingbat hex":"78","Unicode dec":"9699","Unicode hex":"25E3"},{"Typeface name":"Wingdings 3","Dingbat dec":"121","Dingbat hex":"79","Unicode dec":"9698","Unicode hex":"25E2"},{"Typeface name":"Wingdings 3","Dingbat dec":"122","Dingbat hex":"7A","Unicode dec":"9700","Unicode hex":"25E4"},{"Typeface name":"Wingdings 3","Dingbat dec":"123","Dingbat hex":"7B","Unicode dec":"9701","Unicode hex":"25E5"},{"Typeface name":"Wingdings 3","Dingbat dec":"124","Dingbat hex":"7C","Unicode dec":"128896","Unicode hex":"1F780"},{"Typeface name":"Wingdings 3","Dingbat dec":"125","Dingbat hex":"7D","Unicode dec":"128898","Unicode hex":"1F782"},{"Typeface name":"Wingdings 3","Dingbat dec":"126","Dingbat hex":"7E","Unicode dec":"128897","Unicode hex":"1F781"},{"Typeface name":"Wingdings 3","Dingbat dec":"128","Dingbat hex":"80","Unicode dec":"128899","Unicode hex":"1F783"},{"Typeface name":"Wingdings 3","Dingbat dec":"129","Dingbat hex":"81","Unicode dec":"11205","Unicode hex":"2BC5"},{"Typeface name":"Wingdings 3","Dingbat dec":"130","Dingbat hex":"82","Unicode dec":"11206","Unicode hex":"2BC6"},{"Typeface name":"Wingdings 3","Dingbat dec":"131","Dingbat hex":"83","Unicode dec":"11207","Unicode hex":"2BC7"},{"Typeface name":"Wingdings 3","Dingbat dec":"132","Dingbat hex":"84","Unicode dec":"11208","Unicode hex":"2BC8"},{"Typeface name":"Wingdings 3","Dingbat dec":"133","Dingbat hex":"85","Unicode dec":"11164","Unicode hex":"2B9C"},{"Typeface name":"Wingdings 3","Dingbat dec":"134","Dingbat hex":"86","Unicode dec":"11166","Unicode hex":"2B9E"},{"Typeface name":"Wingdings 3","Dingbat dec":"135","Dingbat hex":"87","Unicode dec":"11165","Unicode hex":"2B9D"},{"Typeface name":"Wingdings 3","Dingbat dec":"136","Dingbat hex":"88","Unicode dec":"11167","Unicode hex":"2B9F"},{"Typeface name":"Wingdings 3","Dingbat dec":"137","Dingbat hex":"89","Unicode dec":"129040","Unicode hex":"1F810"},{"Typeface name":"Wingdings 3","Dingbat dec":"138","Dingbat hex":"8A","Unicode dec":"129042","Unicode hex":"1F812"},{"Typeface name":"Wingdings 3","Dingbat dec":"139","Dingbat hex":"8B","Unicode dec":"129041","Unicode hex":"1F811"},{"Typeface name":"Wingdings 3","Dingbat dec":"140","Dingbat hex":"8C","Unicode dec":"129043","Unicode hex":"1F813"},{"Typeface name":"Wingdings 3","Dingbat dec":"141","Dingbat hex":"8D","Unicode dec":"129044","Unicode hex":"1F814"},{"Typeface name":"Wingdings 3","Dingbat dec":"142","Dingbat hex":"8E","Unicode dec":"129046","Unicode hex":"1F816"},{"Typeface name":"Wingdings 3","Dingbat dec":"143","Dingbat hex":"8F","Unicode dec":"129045","Unicode hex":"1F815"},{"Typeface name":"Wingdings 3","Dingbat dec":"144","Dingbat hex":"90","Unicode dec":"129047","Unicode hex":"1F817"},{"Typeface name":"Wingdings 3","Dingbat dec":"145","Dingbat hex":"91","Unicode dec":"129048","Unicode hex":"1F818"},{"Typeface name":"Wingdings 3","Dingbat dec":"146","Dingbat hex":"92","Unicode dec":"129050","Unicode hex":"1F81A"},{"Typeface name":"Wingdings 3","Dingbat dec":"147","Dingbat hex":"93","Unicode dec":"129049","Unicode hex":"1F819"},{"Typeface name":"Wingdings 3","Dingbat dec":"148","Dingbat hex":"94","Unicode dec":"129051","Unicode hex":"1F81B"},{"Typeface name":"Wingdings 3","Dingbat dec":"149","Dingbat hex":"95","Unicode dec":"129052","Unicode hex":"1F81C"},{"Typeface name":"Wingdings 3","Dingbat dec":"150","Dingbat hex":"96","Unicode dec":"129054","Unicode hex":"1F81E"},{"Typeface name":"Wingdings 3","Dingbat dec":"151","Dingbat hex":"97","Unicode dec":"129053","Unicode hex":"1F81D"},{"Typeface name":"Wingdings 3","Dingbat dec":"152","Dingbat hex":"98","Unicode dec":"129055","Unicode hex":"1F81F"},{"Typeface name":"Wingdings 3","Dingbat dec":"153","Dingbat hex":"99","Unicode dec":"129024","Unicode hex":"1F800"},{"Typeface name":"Wingdings 3","Dingbat dec":"154","Dingbat hex":"9A","Unicode dec":"129026","Unicode hex":"1F802"},{"Typeface name":"Wingdings 3","Dingbat dec":"155","Dingbat hex":"9B","Unicode dec":"129025","Unicode hex":"1F801"},{"Typeface name":"Wingdings 3","Dingbat dec":"156","Dingbat hex":"9C","Unicode dec":"129027","Unicode hex":"1F803"},{"Typeface name":"Wingdings 3","Dingbat dec":"157","Dingbat hex":"9D","Unicode dec":"129028","Unicode hex":"1F804"},{"Typeface name":"Wingdings 3","Dingbat dec":"158","Dingbat hex":"9E","Unicode dec":"129030","Unicode hex":"1F806"},{"Typeface name":"Wingdings 3","Dingbat dec":"159","Dingbat hex":"9F","Unicode dec":"129029","Unicode hex":"1F805"},{"Typeface name":"Wingdings 3","Dingbat dec":"160","Dingbat hex":"A0","Unicode dec":"129031","Unicode hex":"1F807"},{"Typeface name":"Wingdings 3","Dingbat dec":"161","Dingbat hex":"A1","Unicode dec":"129032","Unicode hex":"1F808"},{"Typeface name":"Wingdings 3","Dingbat dec":"162","Dingbat hex":"A2","Unicode dec":"129034","Unicode hex":"1F80A"},{"Typeface name":"Wingdings 3","Dingbat dec":"163","Dingbat hex":"A3","Unicode dec":"129033","Unicode hex":"1F809"},{"Typeface name":"Wingdings 3","Dingbat dec":"164","Dingbat hex":"A4","Unicode dec":"129035","Unicode hex":"1F80B"},{"Typeface name":"Wingdings 3","Dingbat dec":"165","Dingbat hex":"A5","Unicode dec":"129056","Unicode hex":"1F820"},{"Typeface name":"Wingdings 3","Dingbat dec":"166","Dingbat hex":"A6","Unicode dec":"129058","Unicode hex":"1F822"},{"Typeface name":"Wingdings 3","Dingbat dec":"167","Dingbat hex":"A7","Unicode dec":"129060","Unicode hex":"1F824"},{"Typeface name":"Wingdings 3","Dingbat dec":"168","Dingbat hex":"A8","Unicode dec":"129062","Unicode hex":"1F826"},{"Typeface name":"Wingdings 3","Dingbat dec":"169","Dingbat hex":"A9","Unicode dec":"129064","Unicode hex":"1F828"},{"Typeface name":"Wingdings 3","Dingbat dec":"170","Dingbat hex":"AA","Unicode dec":"129066","Unicode hex":"1F82A"},{"Typeface name":"Wingdings 3","Dingbat dec":"171","Dingbat hex":"AB","Unicode dec":"129068","Unicode hex":"1F82C"},{"Typeface name":"Wingdings 3","Dingbat dec":"172","Dingbat hex":"AC","Unicode dec":"129180","Unicode hex":"1F89C"},{"Typeface name":"Wingdings 3","Dingbat dec":"173","Dingbat hex":"AD","Unicode dec":"129181","Unicode hex":"1F89D"},{"Typeface name":"Wingdings 3","Dingbat dec":"174","Dingbat hex":"AE","Unicode dec":"129182","Unicode hex":"1F89E"},{"Typeface name":"Wingdings 3","Dingbat dec":"175","Dingbat hex":"AF","Unicode dec":"129183","Unicode hex":"1F89F"},{"Typeface name":"Wingdings 3","Dingbat dec":"176","Dingbat hex":"B0","Unicode dec":"129070","Unicode hex":"1F82E"},{"Typeface name":"Wingdings 3","Dingbat dec":"177","Dingbat hex":"B1","Unicode dec":"129072","Unicode hex":"1F830"},{"Typeface name":"Wingdings 3","Dingbat dec":"178","Dingbat hex":"B2","Unicode dec":"129074","Unicode hex":"1F832"},{"Typeface name":"Wingdings 3","Dingbat dec":"179","Dingbat hex":"B3","Unicode dec":"129076","Unicode hex":"1F834"},{"Typeface name":"Wingdings 3","Dingbat dec":"180","Dingbat hex":"B4","Unicode dec":"129078","Unicode hex":"1F836"},{"Typeface name":"Wingdings 3","Dingbat dec":"181","Dingbat hex":"B5","Unicode dec":"129080","Unicode hex":"1F838"},{"Typeface name":"Wingdings 3","Dingbat dec":"182","Dingbat hex":"B6","Unicode dec":"129082","Unicode hex":"1F83A"},{"Typeface name":"Wingdings 3","Dingbat dec":"183","Dingbat hex":"B7","Unicode dec":"129081","Unicode hex":"1F839"},{"Typeface name":"Wingdings 3","Dingbat dec":"184","Dingbat hex":"B8","Unicode dec":"129083","Unicode hex":"1F83B"},{"Typeface name":"Wingdings 3","Dingbat dec":"185","Dingbat hex":"B9","Unicode dec":"129176","Unicode hex":"1F898"},{"Typeface name":"Wingdings 3","Dingbat dec":"186","Dingbat hex":"BA","Unicode dec":"129178","Unicode hex":"1F89A"},{"Typeface name":"Wingdings 3","Dingbat dec":"187","Dingbat hex":"BB","Unicode dec":"129177","Unicode hex":"1F899"},{"Typeface name":"Wingdings 3","Dingbat dec":"188","Dingbat hex":"BC","Unicode dec":"129179","Unicode hex":"1F89B"},{"Typeface name":"Wingdings 3","Dingbat dec":"189","Dingbat hex":"BD","Unicode dec":"129084","Unicode hex":"1F83C"},{"Typeface name":"Wingdings 3","Dingbat dec":"190","Dingbat hex":"BE","Unicode dec":"129086","Unicode hex":"1F83E"},{"Typeface name":"Wingdings 3","Dingbat dec":"191","Dingbat hex":"BF","Unicode dec":"129085","Unicode hex":"1F83D"},{"Typeface name":"Wingdings 3","Dingbat dec":"192","Dingbat hex":"C0","Unicode dec":"129087","Unicode hex":"1F83F"},{"Typeface name":"Wingdings 3","Dingbat dec":"193","Dingbat hex":"C1","Unicode dec":"129088","Unicode hex":"1F840"},{"Typeface name":"Wingdings 3","Dingbat dec":"194","Dingbat hex":"C2","Unicode dec":"129090","Unicode hex":"1F842"},{"Typeface name":"Wingdings 3","Dingbat dec":"195","Dingbat hex":"C3","Unicode dec":"129089","Unicode hex":"1F841"},{"Typeface name":"Wingdings 3","Dingbat dec":"196","Dingbat hex":"C4","Unicode dec":"129091","Unicode hex":"1F843"},{"Typeface name":"Wingdings 3","Dingbat dec":"197","Dingbat hex":"C5","Unicode dec":"129092","Unicode hex":"1F844"},{"Typeface name":"Wingdings 3","Dingbat dec":"198","Dingbat hex":"C6","Unicode dec":"129094","Unicode hex":"1F846"},{"Typeface name":"Wingdings 3","Dingbat dec":"199","Dingbat hex":"C7","Unicode dec":"129093","Unicode hex":"1F845"},{"Typeface name":"Wingdings 3","Dingbat dec":"200","Dingbat hex":"C8","Unicode dec":"129095","Unicode hex":"1F847"},{"Typeface name":"Wingdings 3","Dingbat dec":"201","Dingbat hex":"C9","Unicode dec":"11176","Unicode hex":"2BA8"},{"Typeface name":"Wingdings 3","Dingbat dec":"202","Dingbat hex":"CA","Unicode dec":"11177","Unicode hex":"2BA9"},{"Typeface name":"Wingdings 3","Dingbat dec":"203","Dingbat hex":"CB","Unicode dec":"11178","Unicode hex":"2BAA"},{"Typeface name":"Wingdings 3","Dingbat dec":"204","Dingbat hex":"CC","Unicode dec":"11179","Unicode hex":"2BAB"},{"Typeface name":"Wingdings 3","Dingbat dec":"205","Dingbat hex":"CD","Unicode dec":"11180","Unicode hex":"2BAC"},{"Typeface name":"Wingdings 3","Dingbat dec":"206","Dingbat hex":"CE","Unicode dec":"11181","Unicode hex":"2BAD"},{"Typeface name":"Wingdings 3","Dingbat dec":"207","Dingbat hex":"CF","Unicode dec":"11182","Unicode hex":"2BAE"},{"Typeface name":"Wingdings 3","Dingbat dec":"208","Dingbat hex":"D0","Unicode dec":"11183","Unicode hex":"2BAF"},{"Typeface name":"Wingdings 3","Dingbat dec":"209","Dingbat hex":"D1","Unicode dec":"129120","Unicode hex":"1F860"},{"Typeface name":"Wingdings 3","Dingbat dec":"210","Dingbat hex":"D2","Unicode dec":"129122","Unicode hex":"1F862"},{"Typeface name":"Wingdings 3","Dingbat dec":"211","Dingbat hex":"D3","Unicode dec":"129121","Unicode hex":"1F861"},{"Typeface name":"Wingdings 3","Dingbat dec":"212","Dingbat hex":"D4","Unicode dec":"129123","Unicode hex":"1F863"},{"Typeface name":"Wingdings 3","Dingbat dec":"213","Dingbat hex":"D5","Unicode dec":"129124","Unicode hex":"1F864"},{"Typeface name":"Wingdings 3","Dingbat dec":"214","Dingbat hex":"D6","Unicode dec":"129125","Unicode hex":"1F865"},{"Typeface name":"Wingdings 3","Dingbat dec":"215","Dingbat hex":"D7","Unicode dec":"129127","Unicode hex":"1F867"},{"Typeface name":"Wingdings 3","Dingbat dec":"216","Dingbat hex":"D8","Unicode dec":"129126","Unicode hex":"1F866"},{"Typeface name":"Wingdings 3","Dingbat dec":"217","Dingbat hex":"D9","Unicode dec":"129136","Unicode hex":"1F870"},{"Typeface name":"Wingdings 3","Dingbat dec":"218","Dingbat hex":"DA","Unicode dec":"129138","Unicode hex":"1F872"},{"Typeface name":"Wingdings 3","Dingbat dec":"219","Dingbat hex":"DB","Unicode dec":"129137","Unicode hex":"1F871"},{"Typeface name":"Wingdings 3","Dingbat dec":"220","Dingbat hex":"DC","Unicode dec":"129139","Unicode hex":"1F873"},{"Typeface name":"Wingdings 3","Dingbat dec":"221","Dingbat hex":"DD","Unicode dec":"129140","Unicode hex":"1F874"},{"Typeface name":"Wingdings 3","Dingbat dec":"222","Dingbat hex":"DE","Unicode dec":"129141","Unicode hex":"1F875"},{"Typeface name":"Wingdings 3","Dingbat dec":"223","Dingbat hex":"DF","Unicode dec":"129143","Unicode hex":"1F877"},{"Typeface name":"Wingdings 3","Dingbat dec":"224","Dingbat hex":"E0","Unicode dec":"129142","Unicode hex":"1F876"},{"Typeface name":"Wingdings 3","Dingbat dec":"225","Dingbat hex":"E1","Unicode dec":"129152","Unicode hex":"1F880"},{"Typeface name":"Wingdings 3","Dingbat dec":"226","Dingbat hex":"E2","Unicode dec":"129154","Unicode hex":"1F882"},{"Typeface name":"Wingdings 3","Dingbat dec":"227","Dingbat hex":"E3","Unicode dec":"129153","Unicode hex":"1F881"},{"Typeface name":"Wingdings 3","Dingbat dec":"228","Dingbat hex":"E4","Unicode dec":"129155","Unicode hex":"1F883"},{"Typeface name":"Wingdings 3","Dingbat dec":"229","Dingbat hex":"E5","Unicode dec":"129156","Unicode hex":"1F884"},{"Typeface name":"Wingdings 3","Dingbat dec":"230","Dingbat hex":"E6","Unicode dec":"129157","Unicode hex":"1F885"},{"Typeface name":"Wingdings 3","Dingbat dec":"231","Dingbat hex":"E7","Unicode dec":"129159","Unicode hex":"1F887"},{"Typeface name":"Wingdings 3","Dingbat dec":"232","Dingbat hex":"E8","Unicode dec":"129158","Unicode hex":"1F886"},{"Typeface name":"Wingdings 3","Dingbat dec":"233","Dingbat hex":"E9","Unicode dec":"129168","Unicode hex":"1F890"},{"Typeface name":"Wingdings 3","Dingbat dec":"234","Dingbat hex":"EA","Unicode dec":"129170","Unicode hex":"1F892"},{"Typeface name":"Wingdings 3","Dingbat dec":"235","Dingbat hex":"EB","Unicode dec":"129169","Unicode hex":"1F891"},{"Typeface name":"Wingdings 3","Dingbat dec":"236","Dingbat hex":"EC","Unicode dec":"129171","Unicode hex":"1F893"},{"Typeface name":"Wingdings 3","Dingbat dec":"237","Dingbat hex":"ED","Unicode dec":"129172","Unicode hex":"1F894"},{"Typeface name":"Wingdings 3","Dingbat dec":"238","Dingbat hex":"EE","Unicode dec":"129174","Unicode hex":"1F896"},{"Typeface name":"Wingdings 3","Dingbat dec":"239","Dingbat hex":"EF","Unicode dec":"129173","Unicode hex":"1F895"},{"Typeface name":"Wingdings 3","Dingbat dec":"240","Dingbat hex":"F0","Unicode dec":"129175","Unicode hex":"1F897"}];RN.default=_6e;var j6e=gt&&gt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(so,"__esModule",{value:!0});so.hex=so.dec=so.codePoint=void 0;var N6e=j6e(RN),VB={},D6e=String.fromCodePoint?String.fromCodePoint:C6e;for(var wb=0,p4=N6e.default;wb<p4.length;wb++){var _b=p4[wb],x4=parseInt(_b["Unicode dec"],10),S6e={codePoint:x4,string:D6e(x4)};VB[_b["Typeface name"].toUpperCase()+"_"+_b["Dingbat dec"]]=S6e}function MN(e,t){return VB[e.toUpperCase()+"_"+t]}so.codePoint=MN;function E6e(e,t){return MN(e,parseInt(t,10))}so.dec=E6e;function T6e(e,t){return MN(e,parseInt(t,16))}so.hex=T6e;function C6e(e){if(e<=65535)return String.fromCharCode(e);var t=Math.floor((e-65536)/1024)+55296,r=(e-65536)%1024+56320;return String.fromCharCode(t,r)}var Fo={},g4=Or;Fo.paragraph=A6e;Fo.run=k6e;Fo._elements=GB;Fo._elementsOfType=BN;Fo.getDescendantsOfType=F6e;Fo.getDescendants=XB;function A6e(e){return BN("paragraph",e)}function k6e(e){return BN("run",e)}function BN(e,t){return GB(function(r){return r.type===e?t(r):r})}function GB(e){return function t(r){if(r.children){var n=g4.map(r.children,t);r=g4.extend(r,{children:n})}return e(r)}}function F6e(e,t){return XB(e).filter(function(r){return r.type===t})}function XB(e){var t=[];return KB(e,function(r){t.push(r)}),t}function KB(e,t){e.children&&e.children.forEach(function(r){KB(r,t),t(r)})}var LN={};LN.uriToZipEntryName=O6e;LN.replaceFragment=P6e;function O6e(e,t){return t.charAt(0)==="/"?t.substr(1):e+"/"+t}function P6e(e,t){var r=e.indexOf("#");return r!==-1&&(e=e.substring(0,r)),e+"#"+t}UN.createBodyReader=U6e;UN._readNumberingProperties=ZB;var v4=so,Ka=Or,ir=St,YB=Pa.Result,cs=Pa.warning,I6e=Bs,y4=Fo,b4=LN;function U6e(e){return{readXmlElement:function(t){return new w4(e).readXmlElement(t)},readXmlElements:function(t){return new w4(e).readXmlElements(t)}}}function w4(e){var t=[],r=[],n=[],a=e.relationships,i=e.contentTypes,o=e.docxFile,c=e.files,l=e.numbering,u=e.styles;function d(W){var re=W.map(f);return _4(re)}function f(W){if(W.type==="element"){var re=q[W.name];if(re)return re(W);if(!Object.prototype.hasOwnProperty.call(M6e,W.name)){var U=cs("An unrecognised element was ignored: "+W.name);return ud([U])}}return el()}function h(W){return b(W).map(function(re){return{type:"paragraphProperties",styleId:re.styleId,styleName:re.name,alignment:W.firstOrEmpty("w:jc").attributes["w:val"],numbering:ZB(re.styleId,W.firstOrEmpty("w:numPr"),l),indent:m(W.firstOrEmpty("w:ind"))}})}function m(W){return{start:W.attributes["w:start"]||W.attributes["w:left"],end:W.attributes["w:end"]||W.attributes["w:right"],firstLine:W.attributes["w:firstLine"],hanging:W.attributes["w:hanging"]}}function x(W){return _(W).map(function(re){var U=W.firstOrEmpty("w:sz").attributes["w:val"],se=/^[0-9]+$/.test(U)?parseInt(U,10)/2:null;return{type:"runProperties",styleId:re.styleId,styleName:re.name,verticalAlignment:W.firstOrEmpty("w:vertAlign").attributes["w:val"],font:W.firstOrEmpty("w:rFonts").attributes["w:ascii"],fontSize:se,isBold:g(W.first("w:b")),isUnderline:p(W.first("w:u")),isItalic:g(W.first("w:i")),isStrikethrough:g(W.first("w:strike")),isAllCaps:g(W.first("w:caps")),isSmallCaps:g(W.first("w:smallCaps")),highlight:y(W.firstOrEmpty("w:highlight").attributes["w:val"])}})}function p(W){if(W){var re=W.attributes["w:val"];return re!==void 0&&re!=="false"&&re!=="0"&&re!=="none"}else return!1}function g(W){if(W){var re=W.attributes["w:val"];return re!=="false"&&re!=="0"}else return!1}function v(W){return W!=="false"&&W!=="0"}function y(W){return!W||W==="none"?null:W}function b(W){return j(W,"w:pStyle","Paragraph",u.findParagraphStyleById)}function _(W){return j(W,"w:rStyle","Run",u.findCharacterStyleById)}function w(W){return j(W,"w:tblStyle","Table",u.findTableStyleById)}function j(W,re,U,se){var te=[],K=W.first(re),H=null,oe=null;if(K&&(H=K.attributes["w:val"],H)){var J=se(H);J?oe=J.name:te.push(pe(U,H))}return km({styleId:H,name:oe},te)}function N(W){var re=W.attributes["w:fldCharType"];if(re==="begin")t.push({type:"begin",fldChar:W}),r=[];else if(re==="end"){var U=t.pop();if(U.type==="begin"&&(U=S(U)),U.type==="checkbox")return pa(ir.checkbox({checked:U.checked}))}else if(re==="separate"){var se=t.pop(),te=S(se);t.push(te)}return el()}function D(){var W=Ka.last(t.filter(function(re){return re.type==="hyperlink"}));return W?W.options:null}function S(W){return T(r.join(""),W.type==="begin"?W.fldChar:I6e.emptyElement)}function T(W,re){var U=/\s*HYPERLINK "(.*)"/.exec(W);if(U)return{type:"hyperlink",options:{href:U[1]}};var se=/\s*HYPERLINK\s+\\l\s+"(.*)"/.exec(W);if(se)return{type:"hyperlink",options:{anchor:se[1]}};var te=/\s*FORMCHECKBOX\s*/.exec(W);if(te){var K=re.firstOrEmpty("w:ffData").firstOrEmpty("w:checkBox"),H=K.first("w:checked"),oe=H==null?g(K.first("w:default")):g(H);return{type:"checkbox",checked:oe}}return{type:"unknown"}}function A(W){return r.push(W.text()),el()}function E(W){var re=W.attributes["w:font"],U=W.attributes["w:char"],se=v4.hex(re,U);return se==null&&/^F0..$/.test(U)&&(se=v4.hex(re,U.substring(2))),se==null?ud([cs("A w:sym element with an unsupported character was ignored: char "+U+" in font "+re)]):pa(new ir.Text(se.string))}function M(W){return function(re){var U=re.attributes["w:id"];return pa(new ir.NoteReference({noteType:W,noteId:U}))}}function P(W){return pa(ir.commentReference({commentId:W.attributes["w:id"]}))}function X(W){return d(W.children)}var q={"w:p":function(W){var re=W.firstOrEmpty("w:pPr"),U=!!re.firstOrEmpty("w:rPr").first("w:del");if(U)return W.children.forEach(function(te){n.push(te)}),el();var se=W.children;return n.length>0&&(se=n.concat(se),n=[]),xn.map(h(re),d(se),function(te,K){return new ir.Paragraph(K,te)}).insertExtra()},"w:r":function(W){return xn.map(x(W.firstOrEmpty("w:rPr")),d(W.children),function(re,U){var se=D();return se!==null&&(U=[new ir.Hyperlink(U,se)]),new ir.Run(U,re)})},"w:fldChar":N,"w:instrText":A,"w:t":function(W){return pa(new ir.Text(W.text()))},"w:tab":function(W){return pa(new ir.Tab)},"w:noBreakHyphen":function(){return pa(new ir.Text(""))},"w:softHyphen":function(W){return pa(new ir.Text(""))},"w:sym":E,"w:hyperlink":function(W){var re=W.attributes["r:id"],U=W.attributes["w:anchor"];return d(W.children).map(function(se){function te(H){var oe=W.attributes["w:tgtFrame"]||null;return new ir.Hyperlink(se,Ka.extend({targetFrame:oe},H))}if(re){var K=a.findTargetByRelationshipId(re);return U&&(K=b4.replaceFragment(K,U)),te({href:K})}else return U?te({anchor:U}):se})},"w:tbl":B,"w:tr":F,"w:tc":I,"w:footnoteReference":M("footnote"),"w:endnoteReference":M("endnote"),"w:commentReference":P,"w:br":function(W){var re=W.attributes["w:type"];return re==null||re==="textWrapping"?pa(ir.lineBreak):re==="page"?pa(ir.pageBreak):re==="column"?pa(ir.columnBreak):ud([cs("Unsupported break type: "+re)])},"w:bookmarkStart":function(W){var re=W.attributes["w:name"];return re==="_GoBack"?el():pa(new ir.BookmarkStart({name:re}))},"mc:AlternateContent":function(W){return X(W.firstOrEmpty("mc:Fallback"))},"w:sdt":function(W){var re=d(W.firstOrEmpty("w:sdtContent").children);return re.map(function(U){var se=W.firstOrEmpty("w:sdtPr").first("wordml:checkbox");if(se){var te=se.first("wordml:checked"),K=!!te&&v(te.attributes["wordml:val"]),H=ir.checkbox({checked:K}),oe=!1,J=U.map(y4._elementsOfType(ir.types.text,function(le){return le.value.length>0&&!oe?(oe=!0,H):le}));return oe?J:H}else return U})},"w:ins":X,"w:object":X,"w:smartTag":X,"w:drawing":X,"w:pict":function(W){return X(W).toExtra()},"v:roundrect":X,"v:shape":X,"v:textbox":X,"w:txbxContent":X,"wp:inline":z,"wp:anchor":z,"v:imagedata":ie,"v:group":X,"v:rect":X};return{readXmlElement:f,readXmlElements:d};function B(W){var re=O(W.firstOrEmpty("w:tblPr"));return d(W.children).flatMap(C).flatMap(function(U){return re.map(function(se){return ir.Table(U,se)})})}function O(W){return w(W).map(function(re){return{styleId:re.styleId,styleName:re.name}})}function F(W){var re=W.firstOrEmpty("w:trPr"),U=!!re.first("w:del");if(U)return el();var se=!!re.first("w:tblHeader");return d(W.children).map(function(te){return ir.TableRow(te,{isHeader:se})})}function I(W){return d(W.children).map(function(re){var U=W.firstOrEmpty("w:tcPr"),se=U.firstOrEmpty("w:gridSpan").attributes["w:val"],te=se?parseInt(se,10):1,K=ir.TableCell(re,{colSpan:te});return K._vMerge=L(U),K})}function L(W){var re=W.first("w:vMerge");if(re){var U=re.attributes["w:val"];return U==="continue"||!U}else return null}function C(W){var re=Ka.any(W,function(te){return te.type!==ir.types.tableRow});if(re)return k(W),km(W,[cs("unexpected non-row element in table, cell merging may be incorrect")]);var U=Ka.any(W,function(te){return Ka.any(te.children,function(K){return K.type!==ir.types.tableCell})});if(U)return k(W),km(W,[cs("unexpected non-cell element in table row, cell merging may be incorrect")]);var se={};return W.forEach(function(te){var K=0;te.children.forEach(function(H){H._vMerge&&se[K]?se[K].rowSpan++:(se[K]=H,H._vMerge=!1),K+=H.colSpan})}),W.forEach(function(te){te.children=te.children.filter(function(K){return!K._vMerge}),te.children.forEach(function(K){delete K._vMerge})}),pa(W)}function k(W){W.forEach(function(re){var U=y4.getDescendantsOfType(re,ir.types.tableCell);U.forEach(function(se){delete se._vMerge})})}function z(W){var re=W.getElementsByTagName("a:graphic").getElementsByTagName("a:graphicData").getElementsByTagName("pic:pic").getElementsByTagName("pic:blipFill").getElementsByTagName("a:blip");return _4(re.map(V.bind(null,W)))}function V(W,re){var U=W.first("wp:docPr").attributes,se=Z(U.descr)?U.title:U.descr,te=ce(re);return te===null?ud([cs("Could not find image file for a:blip element")]):ne(te,se)}function Z(W){return W==null||/^\s*$/.test(W)}function ce(W){var re=W.attributes["r:embed"],U=W.attributes["r:link"];if(re)return Q(re);if(U){var se=a.findTargetByRelationshipId(U);return{path:se,read:c.read.bind(c,se)}}else return null}function ie(W){var re=W.attributes["r:id"];return re?ne(Q(re),W.attributes["o:title"]):ud([cs("A v:imagedata element without a relationship ID was ignored")])}function Q(W){var re=b4.uriToZipEntryName("word",a.findTargetByRelationshipId(W));return{path:re,read:o.read.bind(o,re)}}function ne(W,re){var U=i.findContentType(W.path),se=ir.Image({readImage:W.read,altText:re,contentType:U}),te=R6e[U]?[]:cs("Image of type "+U+" is unlikely to display in web browsers");return km(se,te)}function pe(W,re){return cs(W+" style with ID "+re+" was referenced but not defined in the document")}}function ZB(e,t,r){var n=t.firstOrEmpty("w:ilvl").attributes["w:val"],a=t.firstOrEmpty("w:numId").attributes["w:val"];if(n!==void 0&&a!==void 0)return r.findLevel(a,n);if(e!=null){var i=r.findLevelByParagraphStyleId(e);if(i!=null)return i}return a!==void 0?r.findLevel(a,"0"):null}var R6e={"image/png":!0,"image/gif":!0,"image/jpeg":!0,"image/svg+xml":!0,"image/tiff":!0},M6e={"office-word:wrap":!0,"v:shadow":!0,"v:shapetype":!0,"w:annotationRef":!0,"w:bookmarkEnd":!0,"w:sectPr":!0,"w:proofErr":!0,"w:lastRenderedPageBreak":!0,"w:commentRangeStart":!0,"w:commentRangeEnd":!0,"w:del":!0,"w:footnoteRef":!0,"w:endnoteRef":!0,"w:pPr":!0,"w:rPr":!0,"w:tblPr":!0,"w:tblGrid":!0,"w:trPr":!0,"w:tcPr":!0};function ud(e){return new xn(null,null,e)}function el(){return new xn(null)}function pa(e){return new xn(e)}function km(e,t){return new xn(e,null,t)}function xn(e,t,r){this.value=e||[],this.extra=t||[],this._result=new YB({element:this.value,extra:t},r),this.messages=this._result.messages}xn.prototype.toExtra=function(){return new xn(null,Qg(this.extra,this.value),this.messages)};xn.prototype.insertExtra=function(){var e=this.extra;return e&&e.length?new xn(Qg(this.value,e),null,this.messages):this};xn.prototype.map=function(e){var t=this._result.map(function(r){return e(r.element)});return new xn(t.value,this.extra,t.messages)};xn.prototype.flatMap=function(e){var t=this._result.flatMap(function(r){return e(r.element)._result});return new xn(t.value.element,Qg(this.extra,t.value.extra),t.messages)};xn.map=function(e,t,r){return new xn(r(e.value,t.value),Qg(e.extra,t.extra),e.messages.concat(t.messages))};function _4(e){var t=YB.combine(Ka.pluck(e,"_result"));return new xn(Ka.flatten(Ka.pluck(t.value,"element")),Ka.filter(Ka.flatten(Ka.pluck(t.value,"extra")),B6e),t.messages)}function Qg(e,t){return Ka.flatten([e,t])}function B6e(e){return e}var JB={};JB.DocumentXmlReader=W6e;var L6e=St,$6e=Pa.Result;function W6e(e){var t=e.bodyReader;function r(n){var a=n.first("w:body");if(a==null)throw new Error("Could not find the body element: are you sure this is a docx file?");var i=t.readXmlElements(a.children).map(function(o){return new L6e.Document(o,{notes:e.notes,comments:e.comments})});return new $6e(i.value,i.messages)}return{convertXmlToDocument:r}}var ev={};ev.readRelationships=z6e;ev.defaultValue=new $N([]);ev.Relationships=$N;function z6e(e){var t=[];return e.children.forEach(function(r){if(r.name==="relationships:Relationship"){var n={relationshipId:r.attributes.Id,target:r.attributes.Target,type:r.attributes.Type};t.push(n)}}),new $N(t)}function $N(e){var t={};e.forEach(function(n){t[n.relationshipId]=n.target});var r={};return e.forEach(function(n){r[n.type]||(r[n.type]=[]),r[n.type].push(n.target)}),{findTargetByRelationshipId:function(n){return t[n]},findTargetsByType:function(n){return r[n]||[]}}}var WN={};WN.readContentTypesFromXml=H6e;var q6e={png:"png",gif:"gif",jpeg:"jpeg",jpg:"jpeg",tif:"tiff",tiff:"tiff",bmp:"bmp"};WN.defaultContentTypes=QB({},{});function H6e(e){var t={},r={};return e.children.forEach(function(n){if(n.name==="content-types:Default"&&(t[n.attributes.Extension]=n.attributes.ContentType),n.name==="content-types:Override"){var a=n.attributes.PartName;a.charAt(0)==="/"&&(a=a.substring(1)),r[a]=n.attributes.ContentType}}),QB(r,t)}function QB(e,t){return{findContentType:function(r){var n=e[r];if(n)return n;var a=r.split("."),i=a[a.length-1];if(t.hasOwnProperty(i))return t[i];var o=q6e[i.toLowerCase()];return o?"image/"+o:null}}}var tv={},Fm=Or;tv.readNumberingXml=V6e;tv.Numbering=zN;tv.defaultNumbering=new zN({},{});function zN(e,t,r){var n=Fm.flatten(Fm.values(t).map(function(c){return Fm.values(c.levels)})),a=Fm.indexBy(n.filter(function(c){return c.paragraphStyleId!=null}),"paragraphStyleId");function i(c,l){var u=e[c];if(u){var d=t[u.abstractNumId];if(d){if(d.numStyleLink==null)return t[u.abstractNumId].levels[l];var f=r.findNumberingStyleById(d.numStyleLink);return i(f.numId,l)}else return null}else return null}function o(c){return a[c]||null}return{findLevel:i,findLevelByParagraphStyleId:o}}function V6e(e,t){if(!t||!t.styles)throw new Error("styles is missing");var r=G6e(e),n=K6e(e);return new zN(n,r,t.styles)}function G6e(e){var t={};return e.getElementsByTagName("w:abstractNum").forEach(function(r){var n=r.attributes["w:abstractNumId"];t[n]=X6e(r)}),t}function X6e(e){var t={},r=null;e.getElementsByTagName("w:lvl").forEach(function(a){var i=a.attributes["w:ilvl"],o=a.firstOrEmpty("w:numFmt").attributes["w:val"],c=o!=="bullet",l=a.firstOrEmpty("w:pStyle").attributes["w:val"];i===void 0?r={isOrdered:c,level:"0",paragraphStyleId:l}:t[i]={isOrdered:c,level:i,paragraphStyleId:l}}),r!==null&&t[r.level]===void 0&&(t[r.level]=r);var n=e.firstOrEmpty("w:numStyleLink").attributes["w:val"];return{levels:t,numStyleLink:n}}function K6e(e){var t={};return e.getElementsByTagName("w:num").forEach(function(r){var n=r.attributes["w:numId"],a=r.first("w:abstractNumId").attributes["w:val"];t[n]={abstractNumId:a}}),t}var rv={};rv.readStylesXml=Y6e;rv.Styles=th;rv.defaultStyles=new th({},{});function th(e,t,r,n){return{findParagraphStyleById:function(a){return e[a]},findCharacterStyleById:function(a){return t[a]},findTableStyleById:function(a){return r[a]},findNumberingStyleById:function(a){return n[a]}}}th.EMPTY=new th({},{},{},{});function Y6e(e){var t={},r={},n={},a={},i={paragraph:t,character:r,table:n,numbering:a};return e.getElementsByTagName("w:style").forEach(function(o){var c=Z6e(o),l=i[c.type];l&&l[c.styleId]===void 0&&(l[c.styleId]=c)}),new th(t,r,n,a)}function Z6e(e){var t=e.attributes["w:type"];if(t==="numbering")return Q6e(t,e);var r=eL(e),n=J6e(e);return{type:t,styleId:r,name:n}}function J6e(e){var t=e.first("w:name");return t?t.attributes["w:val"]:null}function Q6e(e,t){var r=eL(t),n=t.firstOrEmpty("w:pPr").firstOrEmpty("w:numPr").firstOrEmpty("w:numId").attributes["w:val"];return{type:e,numId:n,styleId:r}}function eL(e){return e.attributes["w:styleId"]}var qN={},e8e=St,t8e=Pa.Result;qN.createFootnotesReader=tL.bind(gt,"footnote");qN.createEndnotesReader=tL.bind(gt,"endnote");function tL(e,t){function r(i){return t8e.combine(i.getElementsByTagName("w:"+e).filter(n).map(a))}function n(i){var o=i.attributes["w:type"];return o!=="continuationSeparator"&&o!=="separator"}function a(i){var o=i.attributes["w:id"];return t.readXmlElements(i.children).map(function(c){return e8e.Note({noteType:e,noteId:o,body:c})})}return r}var rL={},r8e=St,n8e=Pa.Result;function a8e(e){function t(n){return n8e.combine(n.getElementsByTagName("w:comment").map(r))}function r(n){var a=n.attributes["w:id"];function i(o){return(n.attributes[o]||"").trim()||null}return e.readXmlElements(n.children).map(function(o){return r8e.comment({commentId:a,body:o,authorName:i("w:author"),authorInitials:i("w:initials")})})}return t}rL.createCommentsReader=a8e;var nL={},i8e=cn;nL.Files=s8e;function s8e(){function e(t){return i8e.reject(new Error("could not open external image: '"+t+`'
cannot open linked files from a web browser`))}return{read:e}}yN.read=h8e;yN._findPartPaths=iL;var o8e=cn,c8e=St,jb=Pa.Result,Px=$h,aL=_N.readXmlFromZipFile,l8e=UN.createBodyReader,u8e=JB.DocumentXmlReader,su=ev,j4=WN,N4=tv,D4=rv,S4=qN,d8e=rL,f8e=nL.Files;function h8e(e,t,r){t=t||{},r=r||{};var n=new f8e({externalFileAccess:r.externalFileAccess,relativeToFile:t.path});return o8e.props({contentTypes:p8e(e),partPaths:iL(e),docxFile:e,files:n}).also(function(a){return{styles:g8e(e,a.partPaths.styles)}}).also(function(a){return{numbering:x8e(e,a.partPaths.numbering,a.styles)}}).also(function(a){return{footnotes:Om(a.partPaths.footnotes,a,function(i,o){return o?S4.createFootnotesReader(i)(o):new jb([])}),endnotes:Om(a.partPaths.endnotes,a,function(i,o){return o?S4.createEndnotesReader(i)(o):new jb([])}),comments:Om(a.partPaths.comments,a,function(i,o){return o?d8e.createCommentsReader(i)(o):new jb([])})}}).also(function(a){return{notes:a.footnotes.flatMap(function(i){return a.endnotes.map(function(o){return new c8e.Notes(i.concat(o))})})}}).then(function(a){return Om(a.partPaths.mainDocument,a,function(i,o){return a.notes.flatMap(function(c){return a.comments.flatMap(function(l){var u=new u8e({bodyReader:i,notes:c,comments:l});return u.convertXmlToDocument(o)})})})})}function iL(e){return v8e(e).then(function(t){var r=E4({docxFile:e,relationships:t,relationshipType:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",basePath:"",fallbackPath:"word/document.xml"});if(!e.exists(r))throw new Error("Could not find main document part. Are you sure this is a valid .docx file?");return Lu({filename:sL(r),readElement:su.readRelationships,defaultValue:su.defaultValue})(e).then(function(n){function a(i){return E4({docxFile:e,relationships:n,relationshipType:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/"+i,basePath:Px.splitPath(r).dirname,fallbackPath:"word/"+i+".xml"})}return{mainDocument:r,comments:a("comments"),endnotes:a("endnotes"),footnotes:a("footnotes"),numbering:a("numbering"),styles:a("styles")}})})}function E4(e){var t=e.docxFile,r=e.relationships,n=e.relationshipType,a=e.basePath,i=e.fallbackPath,o=r.findTargetsByType(n),c=o.map(function(u){return m8e(Px.joinPath(a,u),"/")}),l=c.filter(function(u){return t.exists(u)});return l.length===0?i:l[0]}function m8e(e,t){return e.substring(0,t.length)===t?e.substring(t.length):e}function Lu(e){return function(t){return aL(t,e.filename).then(function(r){return r?e.readElement(r):e.defaultValue})}}function Om(e,t,r){var n=Lu({filename:sL(e),readElement:su.readRelationships,defaultValue:su.defaultValue});return n(t.docxFile).then(function(a){var i=new l8e({relationships:a,contentTypes:t.contentTypes,docxFile:t.docxFile,numbering:t.numbering,styles:t.styles,files:t.files});return aL(t.docxFile,e).then(function(o){return r(i,o)})})}function sL(e){var t=Px.splitPath(e);return Px.joinPath(t.dirname,"_rels",t.basename+".rels")}var p8e=Lu({filename:"[Content_Types].xml",readElement:j4.readContentTypesFromXml,defaultValue:j4.defaultContentTypes});function x8e(e,t,r){return Lu({filename:t,readElement:function(n){return N4.readNumberingXml(n,{styles:r})},defaultValue:N4.defaultNumbering})(e)}function g8e(e,t){return Lu({filename:t,readElement:D4.readStylesXml,defaultValue:D4.defaultStyles})(e)}var v8e=Lu({filename:"_rels/.rels",readElement:su.readRelationships,defaultValue:su.defaultValue}),HN={},y8e=Or,b8e=cn,rh=Bs;HN.writeStyleMap=_8e;HN.readStyleMap=D8e;var w8e="http://schemas.zwobble.org/mammoth/style-map",Ix="mammoth/style-map",oL="/"+Ix;function _8e(e,t){return e.write(Ix,t),j8e(e).then(function(){return N8e(e)})}function j8e(e){var t="word/_rels/document.xml.rels",r="http://schemas.openxmlformats.org/package/2006/relationships",n="{"+r+"}Relationship";return e.read(t,"utf8").then(rh.readString).then(function(a){var i=a.children;cL(i,n,"Id",{Id:"rMammothStyleMap",Type:w8e,Target:oL});var o={"":r};return e.write(t,rh.writeString(a,o))})}function N8e(e){var t="[Content_Types].xml",r="http://schemas.openxmlformats.org/package/2006/content-types",n="{"+r+"}Override";return e.read(t,"utf8").then(rh.readString).then(function(a){var i=a.children;cL(i,n,"PartName",{PartName:oL,ContentType:"text/prs.mammoth.style-map"});var o={"":r};return e.write(t,rh.writeString(a,o))})}function cL(e,t,r,n){var a=y8e.find(e,function(i){return i.name===t&&i.attributes[r]===n[r]});a?a.attributes=n:e.push(rh.element(t,n))}function D8e(e){return e.exists(Ix)?e.read(Ix,"utf8"):b8e.resolve(null)}var VN={},Wo={},ls={},qs={},T4;function lL(){if(T4)return qs;T4=1;var e=av();function t(l,u,d){return n(e.element(l,u,{fresh:!1}),d)}function r(l,u,d){var f=e.element(l,u,{fresh:!0});return n(f,d)}function n(l,u){return{type:"element",tag:l,children:u||[]}}function a(l){return{type:"text",value:l}}var i={type:"forceWrite"};qs.freshElement=r,qs.nonFreshElement=t,qs.elementWithTag=n,qs.text=a,qs.forceWrite=i;var o={br:!0,hr:!0,img:!0,input:!0};function c(l){return l.children.length===0&&o[l.tag.tagName]}return qs.isVoidElement=c,qs}var Nb,C4;function S8e(){if(C4)return Nb;C4=1;var e=Or,t=lL();function r(p){return n(u(p))}function n(p){var g=[];return p.map(a).forEach(function(v){l(g,v)}),g}function a(p){return i[p.type](p)}var i={element:o,text:c,forceWrite:c};function o(p){return t.elementWithTag(p.tag,n(p.children))}function c(p){return p}function l(p,g){var v=p[p.length-1];g.type==="element"&&!g.tag.fresh&&v&&v.type==="element"&&g.tag.matchesElement(v.tag)?(g.tag.separator&&l(v.children,t.text(g.tag.separator)),g.children.forEach(function(y){l(v.children,y)})):p.push(g)}function u(p){return d(p,function(g){return f[g.type](g)})}function d(p,g){return e.flatten(e.map(p,g),!0)}var f={element:m,text:x,forceWrite:h};function h(p){return[p]}function m(p){var g=u(p.children);return g.length===0&&!t.isVoidElement(p)?[]:[t.elementWithTag(p.tag,g)]}function x(p){return p.value.length===0?[]:[p]}return Nb=r,Nb}var A4;function nv(){if(A4)return ls;A4=1;var e=lL();ls.freshElement=e.freshElement,ls.nonFreshElement=e.nonFreshElement,ls.elementWithTag=e.elementWithTag,ls.text=e.text,ls.forceWrite=e.forceWrite,ls.simplify=S8e();function t(o,c){c.forEach(function(l){r(o,l)})}function r(o,c){n[c.type](o,c)}var n={element:a,text:i,forceWrite:function(){}};function a(o,c){e.isVoidElement(c)?o.selfClosing(c.tag.tagName,c.tag.attributes):(o.open(c.tag.tagName,c.tag.attributes),t(o,c.children),o.close(c.tag.tagName))}function i(o,c){o.text(c.value)}return ls.write=t,ls}var k4;function av(){if(k4)return Wo;k4=1;var e=Or,t=nv();Wo.topLevelElement=r,Wo.elements=n,Wo.element=i;function r(c,l){return n([i(c,l,{fresh:!0})])}function n(c){return new a(c.map(function(l){return e.isString(l)?i(l):l}))}function a(c){this._elements=c}a.prototype.wrap=function(l){for(var u=l(),d=this._elements.length-1;d>=0;d--)u=this._elements[d].wrapNodes(u);return u};function i(c,l,u){return u=u||{},new o(c,l,u)}function o(c,l,u){var d={};e.isArray(c)?(c.forEach(function(f){d[f]=!0}),c=c[0]):d[c]=!0,this.tagName=c,this.tagNames=d,this.attributes=l||{},this.fresh=u.fresh,this.separator=u.separator}return o.prototype.matchesElement=function(c){return this.tagNames[c.tagName]&&e.isEqual(this.attributes||{},c.attributes||{})},o.prototype.wrap=function(l){return this.wrapNodes(l())},o.prototype.wrapNodes=function(l){return[t.elementWithTag(this,l)]},Wo.empty=n([]),Wo.ignore={wrap:function(){return[]}},Wo}var GN={};(function(e){var t=Or,r=cn,n=nv();e.imgElement=a;function a(i){return function(o,c){return r.when(i(o)).then(function(l){var u={};return o.altText&&(u.alt=o.altText),t.extend(u,l),[n.freshElement("img",u)]})}}e.inline=e.imgElement,e.dataUri=a(function(i){return i.readAsBase64String().then(function(o){return{src:"data:"+i.contentType+";base64,"+o}})})})(GN);var uL={},dL={},fL=Or;dL.writer=E8e;function E8e(e){return e=e||{},e.prettyPrint?T8e():hL()}var Pm={div:!0,p:!0,ul:!0,li:!0};function T8e(){var e=0,t="  ",r=[],n=!0,a=!1,i=hL();function o(x,p){Pm[x]&&h(),r.push(x),i.open(x,p),Pm[x]&&e++,n=!1}function c(x){Pm[x]&&(e--,h()),r.pop(),i.close(x)}function l(x){f();var p=m()?x:x.replace(`
`,`
`+t);i.text(p)}function u(x,p){h(),i.selfClosing(x,p)}function d(){return r.length===0||Pm[r[r.length-1]]}function f(){a||(h(),a=!0)}function h(){if(a=!1,!n&&d()&&!m()){i._append(`
`);for(var x=0;x<e;x++)i._append(t)}}function m(){return fL.some(r,function(x){return x==="pre"})}return{asString:i.asString,open:o,close:c,text:l,selfClosing:u}}function hL(){var e=[];function t(l,u){var d=a(u);e.push("<"+l+d+">")}function r(l){e.push("</"+l+">")}function n(l,u){var d=a(u);e.push("<"+l+d+" />")}function a(l){return fL.map(l,function(u,d){return" "+d+'="'+A8e(u)+'"'}).join("")}function i(l){e.push(C8e(l))}function o(l){e.push(l)}function c(){return e.join("")}return{asString:c,open:t,close:r,text:i,selfClosing:n,_append:o}}function C8e(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function A8e(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var mL={},k8e=Or;function F4(e){return Ux(e,e)}function Ux(e,t){return function(){return{start:e,end:t}}}function F8e(e){var t=e.href||"";return t?{start:"[",end:"]("+t+")",anchorPosition:"before"}:{}}function O8e(e){var t=e.src||"",r=e.alt||"";return t||r?{start:"!["+r+"]("+t+")"}:{}}function O4(e){return function(t,r){return{start:r?`
`:"",end:r?"":`
`,list:{isOrdered:e.isOrdered,indent:r?r.indent+1:0,count:0}}}}function P8e(e,t,r){t=t||{indent:0,isOrdered:!1,count:0},t.count++,r.hasClosed=!1;var n=t.isOrdered?t.count+".":"-",a=xL("	",t.indent)+n+" ";return{start:a,end:function(){if(!r.hasClosed)return r.hasClosed=!0,`
`}}}var pL={p:Ux("",`

`),br:Ux("",`  
`),ul:O4({isOrdered:!1}),ol:O4({isOrdered:!0}),li:P8e,strong:F4("__"),em:F4("*"),a:F8e,img:O8e};(function(){for(var e=1;e<=6;e++)pL["h"+e]=Ux(xL("#",e)+" ",`

`)})();function xL(e,t){return new Array(t+1).join(e)}function I8e(){var e=[],t=[],r=null,n={};function a(d,f){f=f||{};var h=pL[d]||function(){return{}},m=h(f,r,n);t.push({end:m.end,list:r}),m.list&&(r=m.list);var x=m.anchorPosition==="before";x&&i(f),e.push(m.start||""),x||i(f)}function i(d){d.id&&e.push('<a id="'+d.id+'"></a>')}function o(d){var f=t.pop();r=f.list;var h=k8e.isFunction(f.end)?f.end():f.end;e.push(h||"")}function c(d,f){a(d,f),o()}function l(d){e.push(U8e(d))}function u(){return e.join("")}return{asString:u,open:a,close:o,text:l,selfClosing:c}}mL.writer=I8e;function U8e(e){return e.replace(/\\/g,"\\\\").replace(/([\`\*_\{\}\[\]\(\)\#\+\-\.\!])/g,"\\$1")}var R8e=dL,M8e=mL;uL.writer=B8e;function B8e(e){return e=e||{},e.outputFormat==="markdown"?M8e.writer():R8e.writer(e)}var Gs=Or,P4=cn,qm=St,La=av(),H2=Pa,L8e=GN,Et=nv(),$8e=uL;VN.DocumentConverter=W8e;function W8e(e){return{convertToHtml:function(t){var r=Gs.indexBy(t.type===qm.types.document?t.comments:[],"commentId"),n=new z8e(e,r);return n.convertToHtml(t)}}}function z8e(e,t){var r=1,n=[],a=[];e=Gs.extend({ignoreEmptyParagraphs:!0},e);var i=e.idPrefix===void 0?"":e.idPrefix,o=e.ignoreEmptyParagraphs,c=La.topLevelElement("p"),l=e.styleMap||[];function u(O){var F=[],I=f(O,F,{}),L=[];gL(I,function(k){k.type==="deferred"&&L.push(k)});var C={};return P4.mapSeries(L,function(k){return k.value().then(function(z){C[k.id]=z})}).then(function(){function k(V){return Db(V,function(Z){return Z.type==="deferred"?C[Z.id]:Z.children?[Gs.extend({},Z,{children:k(Z.children)})]:[Z]})}var z=$8e.writer({prettyPrint:e.prettyPrint,outputFormat:e.outputFormat});return Et.write(z,Et.simplify(k(I))),new H2.Result(z.asString(),F)})}function d(O,F,I){return Db(O,function(L){return f(L,F,I)})}function f(O,F,I){if(!I)throw new Error("options not set");var L=B[O.type];return L?L(O,F,I):[]}function h(O,F,I){return m(O,F).wrap(function(){var L=d(O.children,F,I);return o?L:[Et.forceWrite].concat(L)})}function m(O,F){var I=v(O);return I?I.to:(O.styleId&&F.push(I4("paragraph",O)),c)}function x(O,F,I){var L=function(){return d(O.children,F,I)},C=[];if(O.highlight!==null){var k=g({type:"highlight",color:O.highlight});k&&C.push(k)}O.isSmallCaps&&C.push(p("smallCaps")),O.isAllCaps&&C.push(p("allCaps")),O.isStrikethrough&&C.push(p("strikethrough","s")),O.isUnderline&&C.push(p("underline")),O.verticalAlignment===qm.verticalAlignment.subscript&&C.push(La.element("sub",{},{fresh:!1})),O.verticalAlignment===qm.verticalAlignment.superscript&&C.push(La.element("sup",{},{fresh:!1})),O.isItalic&&C.push(p("italic","em")),O.isBold&&C.push(p("bold","strong"));var z=La.empty,V=v(O);return V?z=V.to:O.styleId&&F.push(I4("run",O)),C.push(z),C.forEach(function(Z){L=Z.wrap.bind(Z,L)}),L()}function p(O,F){var I=g({type:O});return I||(F?La.element(F,{},{fresh:!1}):La.empty)}function g(O,F){var I=v(O);return I?I.to:F}function v(O){for(var F=0;F<l.length;F++)if(l[F].from.matches(O))return l[F]}function y(O){return function(F,I){return P4.attempt(function(){return O(F,I)}).caught(function(L){return I.push(H2.error(L)),[]})}}function b(O){return w(O.noteType,O.noteId)}function _(O){return j(O.noteType,O.noteId)}function w(O,F){return N(O+"-"+F)}function j(O,F){return N(O+"-ref-"+F)}function N(O){return i+O}var D=La.elements([La.element("table",{},{fresh:!0})]);function S(O,F,I){return g(O,D).wrap(function(){return T(O,F,I)})}function T(O,F,I){var L=Gs.findIndex(O.children,function(V){return!V.type===qm.types.tableRow||!V.isHeader});L===-1&&(L=O.children.length);var C;if(L===0)C=d(O.children,F,Gs.extend({},I,{isTableHeader:!1}));else{var k=d(O.children.slice(0,L),F,Gs.extend({},I,{isTableHeader:!0})),z=d(O.children.slice(L),F,Gs.extend({},I,{isTableHeader:!1}));C=[Et.freshElement("thead",{},k),Et.freshElement("tbody",{},z)]}return[Et.forceWrite].concat(C)}function A(O,F,I){var L=d(O.children,F,I);return[Et.freshElement("tr",{},[Et.forceWrite].concat(L))]}function E(O,F,I){var L=I.isTableHeader?"th":"td",C=d(O.children,F,I),k={};return O.colSpan!==1&&(k.colspan=O.colSpan.toString()),O.rowSpan!==1&&(k.rowspan=O.rowSpan.toString()),[Et.freshElement(L,k,[Et.forceWrite].concat(C))]}function M(O,F,I){return g(O,La.ignore).wrap(function(){var L=t[O.commentId],C=a.length+1,k="["+V8e(L)+C+"]";return a.push({label:k,comment:L}),[Et.freshElement("a",{href:"#"+w("comment",O.commentId),id:j("comment",O.commentId)},[Et.text(k)])]})}function P(O,F,I){var L=O.label,C=O.comment,k=d(C.body,F,I).concat([Et.nonFreshElement("p",{},[Et.text(" "),Et.freshElement("a",{href:"#"+j("comment",C.commentId)},[Et.text("")])])]);return[Et.freshElement("dt",{id:w("comment",C.commentId)},[Et.text("Comment "+L)]),Et.freshElement("dd",{},k)]}function X(O,F,I){return q(O).wrap(function(){return[]})}function q(O){var F=v(O);return F?F.to:O.breakType==="line"?La.topLevelElement("br"):La.empty}var B={document:function(O,F,I){var L=d(O.children,F,I),C=n.map(function(z){return O.notes.resolve(z)}),k=d(C,F,I);return L.concat([Et.freshElement("ol",{},k),Et.freshElement("dl",{},Db(a,function(z){return P(z,F,I)}))])},paragraph:h,run:x,text:function(O,F,I){return[Et.text(O.value)]},tab:function(O,F,I){return[Et.text("	")]},hyperlink:function(O,F,I){var L=O.anchor?"#"+N(O.anchor):O.href,C={href:L};O.targetFrame!=null&&(C.target=O.targetFrame);var k=d(O.children,F,I);return[Et.nonFreshElement("a",C,k)]},checkbox:function(O){var F={type:"checkbox"};return O.checked&&(F.checked="checked"),[Et.freshElement("input",F)]},bookmarkStart:function(O,F,I){var L=Et.freshElement("a",{id:N(O.name)},[Et.forceWrite]);return[L]},noteReference:function(O,F,I){n.push(O);var L=Et.freshElement("a",{href:"#"+b(O),id:_(O)},[Et.text("["+r+++"]")]);return[Et.freshElement("sup",{},[L])]},note:function(O,F,I){var L=d(O.body,F,I),C=Et.elementWithTag(La.element("p",{},{fresh:!1}),[Et.text(" "),Et.freshElement("a",{href:"#"+_(O)},[Et.text("")])]),k=L.concat([C]);return Et.freshElement("li",{id:b(O)},k)},commentReference:M,comment:P,image:H8e(y(e.convertImage||L8e.dataUri)),table:S,tableRow:A,tableCell:E,break:X};return{convertToHtml:u}}var q8e=1;function H8e(e){return function(t,r,n){return[{type:"deferred",id:q8e++,value:function(){return e(t,r,n)}}]}}function I4(e,t){return H2.warning("Unrecognised "+e+" style: '"+t.styleName+"' (Style ID: "+t.styleId+")")}function Db(e,t){return Gs.flatten(e.map(t),!0)}function gL(e,t){e.forEach(function(r){t(r),r.children&&gL(r.children,t)})}var V8e=VN.commentAuthorLabel=function(t){return t.authorInitials||""},vL={},G8e=St;function yL(e){if(e.type==="text")return e.value;if(e.type===G8e.types.tab)return"	";var t=e.type==="paragraph"?`

`:"";return(e.children||[]).map(yL).join("")+t}vL.convertElementToRawText=yL;var iv={},Oi={},bL={},wL={exports:{}},ou=wL.exports=function(e,t){this._tokens=e,this._startIndex=t||0};ou.prototype.head=function(){return this._tokens[this._startIndex]};ou.prototype.tail=function(e){return new ou(this._tokens,this._startIndex+1)};ou.prototype.toArray=function(){return this._tokens.slice(this._startIndex)};ou.prototype.end=function(){return this._tokens[this._tokens.length-1]};ou.prototype.to=function(e){var t=this.head().source,r=e.head()||e.end();return t.to(r.source)};var X8e=wL.exports,K8e=X8e;bL.Parser=function(e){var t=function(r,n){return r(new K8e(n))};return{parseTokens:t}};var XN={},_L={};(function(e){e.none=Object.create({value:function(){throw new Error("Called value on none")},isNone:function(){return!0},isSome:function(){return!1},map:function(){return e.none},flatMap:function(){return e.none},filter:function(){return e.none},toArray:function(){return[]},orElse:t,valueOrElse:t});function t(n){return typeof n=="function"?n():n}e.some=function(n){return new r(n)};var r=function(n){this._value=n};r.prototype.value=function(){return this._value},r.prototype.isNone=function(){return!1},r.prototype.isSome=function(){return!0},r.prototype.map=function(n){return new r(n(this._value))},r.prototype.flatMap=function(n){return n(this._value)},r.prototype.filter=function(n){return n(this._value)?this:e.none},r.prototype.toArray=function(){return[this._value]},r.prototype.orElse=function(n){return this},r.prototype.valueOrElse=function(n){return this._value},e.isOption=function(n){return n===e.none||n instanceof r},e.fromNullable=function(n){return n==null?e.none:new r(n)}})(_L);var KN={failure:function(e,t){if(e.length<1)throw new Error("Failure must have errors");return new Fn({status:"failure",remaining:t,errors:e})},error:function(e,t){if(e.length<1)throw new Error("Failure must have errors");return new Fn({status:"error",remaining:t,errors:e})},success:function(e,t,r){return new Fn({status:"success",value:e,source:r,remaining:t,errors:[]})},cut:function(e){return new Fn({status:"cut",remaining:e,errors:[]})}},Fn=function(e){this._value=e.value,this._status=e.status,this._hasValue=e.value!==void 0,this._remaining=e.remaining,this._source=e.source,this._errors=e.errors};Fn.prototype.map=function(e){return this._hasValue?new Fn({value:e(this._value,this._source),status:this._status,remaining:this._remaining,source:this._source,errors:this._errors}):this};Fn.prototype.changeRemaining=function(e){return new Fn({value:this._value,status:this._status,remaining:e,source:this._source,errors:this._errors})};Fn.prototype.isSuccess=function(){return this._status==="success"||this._status==="cut"};Fn.prototype.isFailure=function(){return this._status==="failure"};Fn.prototype.isError=function(){return this._status==="error"};Fn.prototype.isCut=function(){return this._status==="cut"};Fn.prototype.value=function(){return this._value};Fn.prototype.remaining=function(){return this._remaining};Fn.prototype.source=function(){return this._source};Fn.prototype.errors=function(){return this._errors};var YN={};YN.error=function(e){return new sv(e)};var sv=function(e){this.expected=e.expected,this.actual=e.actual,this._location=e.location};sv.prototype.describe=function(){var e=this._location?this._location.describe()+`:
`:"";return e+"Expected "+this.expected+`
but got `+this.actual};sv.prototype.lineNumber=function(){return this._location.lineNumber()};sv.prototype.characterNumber=function(){return this._location.characterNumber()};var jL={};jL.fromArray=function(e){var t=0,r=function(){return t<e.length};return new Nc({hasNext:r,next:function(){if(r())return e[t++];throw new Error("No more elements")}})};var Nc=function(e){this._iterator=e};Nc.prototype.map=function(e){var t=this._iterator;return new Nc({hasNext:function(){return t.hasNext()},next:function(){return e(t.next())}})};Nc.prototype.filter=function(e){var t=this._iterator,r=!1,n=!1,a,i=function(){if(!r)for(r=!0,n=!1;t.hasNext()&&!n;)a=t.next(),n=e(a)};return new Nc({hasNext:function(){return i(),n},next:function(){i();var o=a;return r=!1,o}})};Nc.prototype.first=function(){var e=this._iterator;return this._iterator.hasNext()?e.next():null};Nc.prototype.toArray=function(){for(var e=[];this._iterator.hasNext();)e.push(this._iterator.next());return e};(function(e){var t=Or,r=_L,n=KN,a=YN,i=jL;e.token=function(h,m){var x=m!==void 0;return function(p){var g=p.head();if(g&&g.name===h&&(!x||g.value===m))return n.success(g.value,p.tail(),g.source);var v=d({name:h,value:m});return f(p,v)}},e.tokenOfType=function(h){return e.token(h)},e.firstOf=function(h,m){return t.isArray(m)||(m=Array.prototype.slice.call(arguments,1)),function(x){return i.fromArray(m).map(function(p){return p(x)}).filter(function(p){return p.isSuccess()||p.isError()}).first()||f(x,h)}},e.then=function(h,m){return function(x){var p=h(x);return p.map||console.log(p),p.map(m)}},e.sequence=function(){var h=Array.prototype.slice.call(arguments,0),m=function(p){var g=t.foldl(h,function(y,b){var _=y.result,w=y.hasCut;if(!_.isSuccess())return{result:_,hasCut:w};var j=b(_.remaining());if(j.isCut())return{result:_,hasCut:!0};if(j.isSuccess()){var N;b.isCaptured?N=_.value().withValue(b,j.value()):N=_.value();var D=j.remaining(),S=p.to(D);return{result:n.success(N,D,S),hasCut:w}}else return w?{result:n.error(j.errors(),j.remaining()),hasCut:w}:{result:j,hasCut:w}},{result:n.success(new o,p),hasCut:!1}).result,v=p.to(g.remaining());return g.map(function(y){return y.withValue(e.sequence.source,v)})};m.head=function(){var p=t.find(h,x);return e.then(m,e.sequence.extract(p))},m.map=function(p){return e.then(m,function(g){return p.apply(this,g.toArray())})};function x(p){return p.isCaptured}return m};var o=function(h,m){this._values=h||{},this._valuesArray=m||[]};o.prototype.withValue=function(h,m){if(h.captureName&&h.captureName in this._values)throw new Error('Cannot add second value for capture "'+h.captureName+'"');var x=t.clone(this._values);x[h.captureName]=m;var p=this._valuesArray.concat([m]);return new o(x,p)},o.prototype.get=function(h){if(h.captureName in this._values)return this._values[h.captureName];throw new Error('No value for capture "'+h.captureName+'"')},o.prototype.toArray=function(){return this._valuesArray},e.sequence.capture=function(h,m){var x=function(){return h.apply(this,arguments)};return x.captureName=m,x.isCaptured=!0,x},e.sequence.extract=function(h){return function(m){return m.get(h)}},e.sequence.applyValues=function(h){var m=Array.prototype.slice.call(arguments,1);return function(x){var p=m.map(function(g){return x.get(g)});return h.apply(this,p)}},e.sequence.source={captureName:"source"},e.sequence.cut=function(){return function(h){return n.cut(h)}},e.optional=function(h){return function(m){var x=h(m);return x.isSuccess()?x.map(r.some):x.isFailure()?n.success(r.none,m):x}},e.zeroOrMoreWithSeparator=function(h,m){return u(h,m,!1)},e.oneOrMoreWithSeparator=function(h,m){return u(h,m,!0)};var c=e.zeroOrMore=function(h){return function(m){for(var x=[],p;(p=h(m))&&p.isSuccess();)m=p.remaining(),x.push(p.value());return p.isError()?p:n.success(x,m)}};e.oneOrMore=function(h){return e.oneOrMoreWithSeparator(h,l)};function l(h){return n.success(null,h)}var u=function(h,m,x){return function(p){var g=h(p);if(g.isSuccess()){var v=e.sequence.capture(h,"main"),y=c(e.then(e.sequence(m,v),e.sequence.extract(v))),b=y(g.remaining());return n.success([g.value()].concat(b.value()),b.remaining())}else return x||g.isError()?g:n.success([],p)}};e.leftAssociative=function(h,m,x){var p;x?p=[{func:x,rule:m}]:p=m,p=p.map(function(v){return e.then(v.rule,function(y){return function(b,_){return v.func(b,y,_)}})});var g=e.firstOf.apply(null,["rules"].concat(p));return function(v){var y=v,b=h(v);if(!b.isSuccess())return b;for(var _=g(b.remaining());_.isSuccess();){var w=_.remaining(),j=y.to(_.remaining()),N=_.value();b=n.success(N(b.value(),j),w,j),_=g(b.remaining())}return _.isError()?_:b}},e.leftAssociative.firstOf=function(){return Array.prototype.slice.call(arguments,0)},e.nonConsuming=function(h){return function(m){return h(m).changeRemaining(m)}};var d=function(h){return h.value?h.name+' "'+h.value+'"':h.name};function f(h,m){var x,p=h.head();return p?x=a.error({expected:m,actual:d(p),location:p.source}):x=a.error({expected:m,actual:"end of tokens"}),n.failure([x],h)}})(XN);var NL={exports:{}};NL.exports=function(e,t){var r={asString:function(){return e},range:function(n,a){return new Dc(e,t,n,a)}};return r};var Dc=function(e,t,r,n){this._string=e,this._description=t,this._startIndex=r,this._endIndex=n};Dc.prototype.to=function(e){return new Dc(this._string,this._description,this._startIndex,e._endIndex)};Dc.prototype.describe=function(){var e=this._position(),t=this._description?this._description+`
`:"";return t+"Line number: "+e.lineNumber+`
Character number: `+e.characterNumber};Dc.prototype.lineNumber=function(){return this._position().lineNumber};Dc.prototype.characterNumber=function(){return this._position().characterNumber};Dc.prototype._position=function(){for(var e=this,t=0,r=function(){return e._string.indexOf(`
`,t)},n=1;r()!==-1&&r()<this._startIndex;)t=r()+1,n+=1;var a=this._startIndex-t+1;return{lineNumber:n,characterNumber:a}};var DL=NL.exports,SL=function(e,t,r){this.name=e,this.value=t,r&&(this.source=r)},EL={};(function(e){var t=XN,r=KN;e.parser=function(i,o,c){var l={rule:h,leftAssociative:m,rightAssociative:x},u=new n(c.map(f)),d=t.firstOf(i,o);function f(v){return{name:v.name,rule:a(v.ruleBuilder.bind(null,l))}}function h(){return p(u)}function m(v){return p(u.untilExclusive(v))}function x(v){return p(u.untilInclusive(v))}function p(v){return g.bind(null,v)}function g(v,y){var b=d(y);return b.isSuccess()?v.apply(b):b}return l};function n(i){function o(f){return new n(i.slice(0,l().indexOf(f)))}function c(f){return new n(i.slice(0,l().indexOf(f)+1))}function l(){return i.map(function(f){return f.name})}function u(f){for(var h,m;;)if(h=d(f.remaining()),h.isSuccess())m=f.source().to(h.source()),f=r.success(h.value()(f.value(),m),h.remaining(),m);else return h.isFailure()?f:h}function d(f){return t.firstOf("infix",i.map(function(h){return h.rule}))(f)}return{apply:u,untilExclusive:o,untilInclusive:c}}e.infix=function(i,o){function c(l){return e.infix(i,function(u){var d=o(u);return function(f){var h=d(f);return h.map(function(m){return function(x,p){return l(x,m,p)}})}})}return{name:i,ruleBuilder:o,map:c}};var a=function(i){var o;return function(c){return o||(o=i()),o(c)}}})(EL);var TL={},Sb=SL,Y8e=DL;TL.RegexTokeniser=Z8e;function Z8e(e){e=e.map(function(a){return{name:a.name,regex:new RegExp(a.regex.source,"g")}});function t(a,i){for(var o=new Y8e(a,i),c=0,l=[];c<a.length;){var u=r(a,c,o);c=u.endIndex,l.push(u.token)}return l.push(n(a,o)),l}function r(a,i,o){for(var c=0;c<e.length;c++){var l=e[c].regex;l.lastIndex=i;var u=l.exec(a);if(u){var f=i+u[0].length;if(u.index===i&&f>i){var d=u[1],h=new Sb(e[c].name,d,o.range(i,f));return{token:h,endIndex:f}}}}var f=i+1,h=new Sb("unrecognisedCharacter",a.substring(i,f),o.range(i,f));return{token:h,endIndex:f}}function n(a,i){return new Sb("end",null,i.range(a.length,a.length))}return{tokenise:t}}Oi.Parser=bL.Parser;Oi.rules=XN;Oi.errors=YN;Oi.results=KN;Oi.StringSource=DL;Oi.Token=SL;Oi.bottomUp=EL;Oi.RegexTokeniser=TL.RegexTokeniser;Oi.rule=function(e){var t;return function(r){return t||(t=e()),t(r)}};var vn={};vn.paragraph=J8e;vn.run=Q8e;vn.table=eIe;vn.bold=new Pi("bold");vn.italic=new Pi("italic");vn.underline=new Pi("underline");vn.strikethrough=new Pi("strikethrough");vn.allCaps=new Pi("allCaps");vn.smallCaps=new Pi("smallCaps");vn.highlight=tIe;vn.commentReference=new Pi("commentReference");vn.lineBreak=new ov({breakType:"line"});vn.pageBreak=new ov({breakType:"page"});vn.columnBreak=new ov({breakType:"column"});vn.equalTo=nIe;vn.startsWith=aIe;function J8e(e){return new Pi("paragraph",e)}function Q8e(e){return new Pi("run",e)}function eIe(e){return new Pi("table",e)}function tIe(e){return new CL(e)}function Pi(e,t){t=t||{},this._elementType=e,this._styleId=t.styleId,this._styleName=t.styleName,t.list&&(this._listIndex=t.list.levelIndex,this._listIsOrdered=t.list.isOrdered)}Pi.prototype.matches=function(e){return e.type===this._elementType&&(this._styleId===void 0||e.styleId===this._styleId)&&(this._styleName===void 0||e.styleName&&this._styleName.operator(this._styleName.operand,e.styleName))&&(this._listIndex===void 0||rIe(e,this._listIndex,this._listIsOrdered))&&(this._breakType===void 0||this._breakType===e.breakType)};function CL(e){e=e||{},this._color=e.color}CL.prototype.matches=function(e){return e.type==="highlight"&&(this._color===void 0||e.color===this._color)};function ov(e){e=e||{},this._breakType=e.breakType}ov.prototype.matches=function(e){return e.type==="break"&&(this._breakType===void 0||e.breakType===this._breakType)};function rIe(e,t,r){return e.numbering&&e.numbering.level==t&&e.numbering.isOrdered==r}function nIe(e){return{operator:iIe,operand:e}}function aIe(e){return{operator:sIe,operand:e}}function iIe(e,t){return e.toUpperCase()===t.toUpperCase()}function sIe(e,t){return t.toUpperCase().indexOf(e.toUpperCase())===0}var AL={},oIe=Oi,cIe=oIe.RegexTokeniser;AL.tokenise=lIe;var U4="'((?:\\\\.|[^'])*)";function lIe(e){var t="(?:[a-zA-Z\\-_]|\\\\.)",r=new cIe([{name:"identifier",regex:new RegExp("("+t+"(?:"+t+"|[0-9])*)")},{name:"dot",regex:/\./},{name:"colon",regex:/:/},{name:"gt",regex:/>/},{name:"whitespace",regex:/\s+/},{name:"arrow",regex:/=>/},{name:"equals",regex:/=/},{name:"startsWith",regex:/\^=/},{name:"open-paren",regex:/\(/},{name:"close-paren",regex:/\)/},{name:"open-square-bracket",regex:/\[/},{name:"close-square-bracket",regex:/\]/},{name:"string",regex:new RegExp(U4+"'")},{name:"unterminated-string",regex:new RegExp(U4)},{name:"integer",regex:/([0-9]+)/},{name:"choice",regex:/\|/},{name:"bang",regex:/(!)/}]);return r.tokenise(e)}var uIe=Or,ke=Oi,jn=vn,Hm=av(),dIe=AL.tokenise,Eb=Pa;iv.readHtmlPath=pIe;iv.readDocumentMatcher=mIe;iv.readStyle=fIe;function fIe(e){return ZN(jIe,e)}function hIe(){return ke.rules.sequence(ke.rules.sequence.capture(kL()),ke.rules.tokenOfType("whitespace"),ke.rules.tokenOfType("arrow"),ke.rules.sequence.capture(ke.rules.optional(ke.rules.sequence(ke.rules.tokenOfType("whitespace"),ke.rules.sequence.capture(FL())).head())),ke.rules.tokenOfType("end")).map(function(e,t){return{from:e,to:t.valueOrElse(Hm.empty)}})}function mIe(e){return ZN(kL(),e)}function kL(){var e=ke.rules.sequence,t=function(j,N){return ke.rules.then(ke.rules.token("identifier",j),function(){return N})},r=t("p",jn.paragraph),n=t("r",jn.run),a=ke.rules.firstOf("p or r or table",r,n),i=ke.rules.sequence(ke.rules.tokenOfType("dot"),ke.rules.sequence.cut(),ke.rules.sequence.capture(cv)).map(function(j){return{styleId:j}}),o=ke.rules.firstOf("style name matcher",ke.rules.then(ke.rules.sequence(ke.rules.tokenOfType("equals"),ke.rules.sequence.cut(),ke.rules.sequence.capture(dl)).head(),function(j){return{styleName:jn.equalTo(j)}}),ke.rules.then(ke.rules.sequence(ke.rules.tokenOfType("startsWith"),ke.rules.sequence.cut(),ke.rules.sequence.capture(dl)).head(),function(j){return{styleName:jn.startsWith(j)}})),c=ke.rules.sequence(ke.rules.tokenOfType("open-square-bracket"),ke.rules.sequence.cut(),ke.rules.token("identifier","style-name"),ke.rules.sequence.capture(o),ke.rules.tokenOfType("close-square-bracket")).head(),l=ke.rules.firstOf("list type",t("ordered-list",{isOrdered:!0}),t("unordered-list",{isOrdered:!1})),u=e(ke.rules.tokenOfType("colon"),e.capture(l),e.cut(),ke.rules.tokenOfType("open-paren"),e.capture(xIe),ke.rules.tokenOfType("close-paren")).map(function(j,N){return{list:{isOrdered:j.isOrdered,levelIndex:N-1}}});function d(j){var N=ke.rules.firstOf.apply(ke.rules.firstOf,["matcher suffix"].concat(j)),D=ke.rules.zeroOrMore(N);return ke.rules.then(D,function(S){var T={};return S.forEach(function(A){uIe.extend(T,A)}),T})}var f=e(e.capture(a),e.capture(d([i,c,u]))).map(function(j,N){return j(N)}),h=e(ke.rules.token("identifier","table"),e.capture(d([i,c]))).map(function(j){return jn.table(j)}),m=t("b",jn.bold),x=t("i",jn.italic),p=t("u",jn.underline),g=t("strike",jn.strikethrough),v=t("all-caps",jn.allCaps),y=t("small-caps",jn.smallCaps),b=e(ke.rules.token("identifier","highlight"),ke.rules.sequence.capture(ke.rules.optional(ke.rules.sequence(ke.rules.tokenOfType("open-square-bracket"),ke.rules.sequence.cut(),ke.rules.token("identifier","color"),ke.rules.tokenOfType("equals"),ke.rules.sequence.capture(dl),ke.rules.tokenOfType("close-square-bracket")).head()))).map(function(j){return jn.highlight({color:j.valueOrElse(void 0)})}),_=t("comment-reference",jn.commentReference),w=e(ke.rules.token("identifier","br"),e.cut(),ke.rules.tokenOfType("open-square-bracket"),ke.rules.token("identifier","type"),ke.rules.tokenOfType("equals"),e.capture(dl),ke.rules.tokenOfType("close-square-bracket")).map(function(j){switch(j){case"line":return jn.lineBreak;case"page":return jn.pageBreak;case"column":return jn.columnBreak}});return ke.rules.firstOf("element type",f,h,m,x,p,g,v,y,b,_,w)}function pIe(e){return ZN(FL(),e)}function FL(){var e=ke.rules.sequence.capture,t=ke.rules.tokenOfType("whitespace"),r=ke.rules.then(ke.rules.optional(ke.rules.sequence(ke.rules.tokenOfType("colon"),ke.rules.token("identifier","fresh"))),function(o){return o.map(function(){return!0}).valueOrElse(!1)}),n=ke.rules.then(ke.rules.optional(ke.rules.sequence(ke.rules.tokenOfType("colon"),ke.rules.token("identifier","separator"),ke.rules.tokenOfType("open-paren"),e(dl),ke.rules.tokenOfType("close-paren")).head()),function(o){return o.valueOrElse("")}),a=ke.rules.oneOrMoreWithSeparator(cv,ke.rules.tokenOfType("choice")),i=ke.rules.sequence(e(a),e(ke.rules.zeroOrMore(bIe)),e(r),e(n)).map(function(o,c,l,u){var d={},f={};return c.forEach(function(h){h.append&&d[h.name]?d[h.name]+=" "+h.value:d[h.name]=h.value}),l&&(f.fresh=!0),u&&(f.separator=u),Hm.element(o,d,f)});return ke.rules.firstOf("html path",ke.rules.then(ke.rules.tokenOfType("bang"),function(){return Hm.ignore}),ke.rules.then(ke.rules.zeroOrMoreWithSeparator(i,ke.rules.sequence(t,ke.rules.tokenOfType("gt"),t)),Hm.elements))}var cv=ke.rules.then(ke.rules.tokenOfType("identifier"),OL),xIe=ke.rules.tokenOfType("integer"),dl=ke.rules.then(ke.rules.tokenOfType("string"),OL),gIe={n:`
`,r:"\r",t:"	"};function OL(e){return e.replace(/\\(.)/g,function(t,r){return gIe[r]||r})}var vIe=ke.rules.sequence(ke.rules.tokenOfType("open-square-bracket"),ke.rules.sequence.cut(),ke.rules.sequence.capture(cv),ke.rules.tokenOfType("equals"),ke.rules.sequence.capture(dl),ke.rules.tokenOfType("close-square-bracket")).map(function(e,t){return{name:e,value:t,append:!1}}),yIe=ke.rules.sequence(ke.rules.tokenOfType("dot"),ke.rules.sequence.cut(),ke.rules.sequence.capture(cv)).map(function(e){return{name:"class",value:e,append:!0}}),bIe=ke.rules.firstOf("attribute or class",vIe,yIe);function ZN(e,t){var r=dIe(t),n=ke.Parser(),a=n.parseTokens(e,r);return a.isSuccess()?Eb.success(a.value()):new Eb.Result(null,[Eb.warning(wIe(t,a))])}function wIe(e,t){return"Did not understand this style mapping, so ignored it: "+e+`
`+t.errors().map(_Ie).join(`
`)}function _Ie(e){return"Error was at character number "+e.characterNumber()+": Expected "+e.expected+" but got "+e.actual}var jIe=hIe(),lv={};lv.readOptions=SIe;var PL=Or,NIe=lv._defaultStyleMap=["p.Heading1 => h1:fresh","p.Heading2 => h2:fresh","p.Heading3 => h3:fresh","p.Heading4 => h4:fresh","p.Heading5 => h5:fresh","p.Heading6 => h6:fresh","p[style-name='Heading 1'] => h1:fresh","p[style-name='Heading 2'] => h2:fresh","p[style-name='Heading 3'] => h3:fresh","p[style-name='Heading 4'] => h4:fresh","p[style-name='Heading 5'] => h5:fresh","p[style-name='Heading 6'] => h6:fresh","p[style-name='heading 1'] => h1:fresh","p[style-name='heading 2'] => h2:fresh","p[style-name='heading 3'] => h3:fresh","p[style-name='heading 4'] => h4:fresh","p[style-name='heading 5'] => h5:fresh","p[style-name='heading 6'] => h6:fresh","p.Heading => h1:fresh","p[style-name='Heading'] => h1:fresh","r[style-name='Strong'] => strong","p[style-name='footnote text'] => p:fresh","r[style-name='footnote reference'] =>","p[style-name='endnote text'] => p:fresh","r[style-name='endnote reference'] =>","p[style-name='annotation text'] => p:fresh","r[style-name='annotation reference'] =>","p[style-name='Footnote'] => p:fresh","r[style-name='Footnote anchor'] =>","p[style-name='Endnote'] => p:fresh","r[style-name='Endnote anchor'] =>","p:unordered-list(1) => ul > li:fresh","p:unordered-list(2) => ul|ol > li > ul > li:fresh","p:unordered-list(3) => ul|ol > li > ul|ol > li > ul > li:fresh","p:unordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh","p:unordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh","p:ordered-list(1) => ol > li:fresh","p:ordered-list(2) => ul|ol > li > ol > li:fresh","p:ordered-list(3) => ul|ol > li > ul|ol > li > ol > li:fresh","p:ordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh","p:ordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh","r[style-name='Hyperlink'] =>","p[style-name='Normal'] => p:fresh","p.Body => p:fresh","p[style-name='Body'] => p:fresh"],DIe=lv._standardOptions={externalFileAccess:!1,transformDocument:EIe,includeDefaultStyleMap:!0,includeEmbeddedStyleMap:!0};function SIe(e){return e=e||{},PL.extend({},DIe,e,{customStyleMap:R4(e.styleMap),readStyleMap:function(){var t=this.customStyleMap;return this.includeEmbeddedStyleMap&&(t=t.concat(R4(this.embeddedStyleMap))),this.includeDefaultStyleMap&&(t=t.concat(NIe)),t}})}function R4(e){return e?PL.isString(e)?e.split(`
`).map(function(t){return t.trim()}).filter(function(t){return t!==""&&t.charAt(0)!=="#"}):e:[]}function EIe(e){return e}var IL={},M4=cn,TIe=$h;IL.openZip=CIe;function CIe(e){return e.arrayBuffer?M4.resolve(TIe.openArrayBuffer(e.arrayBuffer)):M4.reject(new Error("Could not find file in options"))}var UL={},AIe=av(),kIe=nv();UL.element=FIe;function FIe(e){return function(t){return kIe.elementWithTag(AIe.element(e),[t])}}var OIe=Or,RL=yN,JN=HN,PIe=VN.DocumentConverter,IIe=vL.convertElementToRawText,UIe=iv.readStyle,RIe=lv.readOptions,uv=IL,MIe=Pa.Result;Fi.convertToHtml=BIe;Fi.convertToMarkdown=LIe;Fi.convert=QN;Fi.extractRawText=qIe;Fi.images=GN;Fi.transforms=Fo;Fi.underline=UL;Fi.embedStyleMap=HIe;Fi.readEmbeddedStyleMap=$Ie;function BIe(e,t){return QN(e,t)}function LIe(e,t){var r=Object.create(t||{});return r.outputFormat="markdown",QN(e,r)}function QN(e,t){return t=RIe(t),uv.openZip(e).tap(function(r){return JN.readStyleMap(r).then(function(n){t.embeddedStyleMap=n})}).then(function(r){return RL.read(r,e,t).then(function(n){return n.map(t.transformDocument)}).then(function(n){return WIe(n,t)})})}function $Ie(e){return uv.openZip(e).then(JN.readStyleMap)}function WIe(e,t){var r=zIe(t.readStyleMap()),n=OIe.extend({},t,{styleMap:r.value}),a=new PIe(n);return e.flatMapThen(function(i){return r.flatMapThen(function(o){return a.convertToHtml(i)})})}function zIe(e){return MIe.combine((e||[]).map(UIe)).map(function(t){return t.filter(function(r){return!!r})})}function qIe(e){return uv.openZip(e).then(RL.read).then(function(t){return t.map(IIe)})}function HIe(e,t){return uv.openZip(e).tap(function(r){return JN.writeStyleMap(r,t)}).then(function(r){return r.toArrayBuffer()}).then(function(r){return{toArrayBuffer:function(){return r},toBuffer:function(){return Buffer.from(r)}}})}Fi.styleMapping=function(){throw new Error(`Use a raw string instead of mammoth.styleMapping e.g. "p[style-name='Title'] => h1" instead of mammoth.styleMapping("p[style-name='Title'] => h1")`)};const VIe=({fileUrl:e,fileName:t})=>{const[r,n]=R.useState(""),[a,i]=R.useState(!0),[o,c]=R.useState(null);return R.useEffect(()=>{e&&(async()=>{try{i(!0),c(null);const u=await fetch(e);if(!u.ok)throw new Error("Failed to load file");const d=await u.arrayBuffer(),f=await Fi.convertToHtml({arrayBuffer:d},{styleMap:["p[style-name='Heading 1'] => h1:fresh","p[style-name='Heading 2'] => h2:fresh","p[style-name='Heading 3'] => h3:fresh","p[style-name='Title'] => h1.title:fresh","r[style-name='Strong'] => strong","r[style-name='Emphasis'] => em"]});f.messages&&f.messages.length>0&&console.warn("Mammoth conversion warnings:",f.messages),n(f.value||"<p>Document is empty</p>"),i(!1)}catch(u){console.error("Word preview error:",u),c(u.message),i(!1)}})()},[e]),a?s.jsx("div",{className:"flex items-center justify-center h-full min-h-[400px]",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2"}),s.jsx("p",{className:"text-text-secondary",children:"Loading Word document..."})]})}):o?s.jsxs("div",{className:"flex flex-col items-center justify-center h-full min-h-[400px] text-center",children:[s.jsx(G,{name:"AlertCircle",size:48,className:"text-error mb-4"}),s.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-2",children:"Failed to load Word document"}),s.jsx("p",{className:"text-text-secondary",children:o})]}):s.jsx("div",{className:"h-full",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-8 max-h-[600px] overflow-auto",children:[s.jsx("style",{children:`
          .word-preview-content {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
          }
          .word-preview-content h1 {
            font-size: 2em;
            font-weight: bold;
            margin: 1em 0 0.5em 0;
            color: var(--text-primary);
          }
          .word-preview-content h2 {
            font-size: 1.5em;
            font-weight: bold;
            margin: 0.83em 0 0.5em 0;
            color: var(--text-primary);
          }
          .word-preview-content h3 {
            font-size: 1.17em;
            font-weight: bold;
            margin: 1em 0 0.5em 0;
            color: var(--text-primary);
          }
          .word-preview-content p {
            margin: 0.5em 0;
          }
          .word-preview-content ul, .word-preview-content ol {
            margin: 0.5em 0;
            padding-left: 2em;
          }
          .word-preview-content li {
            margin: 0.25em 0;
          }
          .word-preview-content table {
            border-collapse: collapse;
            margin: 1em 0;
            width: 100%;
          }
          .word-preview-content table td, .word-preview-content table th {
            border: 1px solid var(--border);
            padding: 0.5em;
          }
          .word-preview-content table th {
            background-color: var(--background);
            font-weight: bold;
          }
          .word-preview-content strong {
            font-weight: bold;
          }
          .word-preview-content em {
            font-style: italic;
          }
          .word-preview-content a {
            color: var(--primary);
            text-decoration: underline;
          }
          .word-preview-content img {
            max-width: 100%;
            height: auto;
            margin: 1em 0;
          }
        `}),s.jsx("div",{className:"word-preview-content",dangerouslySetInnerHTML:{__html:r}})]})})},Tb="http://localhost:8000/",GIe=({documents:e=[],loading:t=!1,dealId:r,onUploadDocument:n,onDeleteDocument:a,readOnly:i=!1})=>{const[o,c]=R.useState(!1),[l,u]=R.useState(!1),[d,f]=R.useState(!1),[h,m]=R.useState(null),[x,p]=R.useState(null),g=R.useRef(null),v=[{value:"proposal",label:"Proposal",icon:"FileText",color:"text-blue-600"},{value:"contract",label:"Contract",icon:"FileCheck",color:"text-green-600"},{value:"presentation",label:"Presentation",icon:"Presentation",color:"text-purple-600"},{value:"other",label:"Other",icon:"File",color:"text-gray-600"}],y=I=>(fr==null||fr.getFileExtension(I),fr==null?void 0:fr.getFileIcon(I)),b=I=>{var L;!I||(I==null?void 0:I.length)===0||(L=Array.from(I))==null||L.forEach(C=>{_(C)})},_=async(I,L="other")=>{if(!r||!I)return;const C=10*1024*1024;if((I==null?void 0:I.size)>C){alert("File size must be less than 10MB");return}c(!0);try{await(n==null?void 0:n(I,L))}catch(k){alert("Failed to upload document: "+((k==null?void 0:k.message)||"Unknown error"))}finally{c(!1)}},w=async I=>{if(window.confirm(`Are you sure you want to delete "${I==null?void 0:I.name}"?`))try{const L=localStorage.getItem("access_token"),C=await fetch(`${Tb}/api/v1/deals/documents/${I==null?void 0:I.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${L}`,"Content-Type":"application/json"}});if(!C.ok){const k=await C.json();throw new Error(k.detail||"Delete failed")}await(a==null?void 0:a(I==null?void 0:I.id))}catch(L){alert("Failed to delete document: "+((L==null?void 0:L.message)||"Unknown error"))}},j=async I=>{var L,C;try{const k=localStorage.getItem("access_token"),z=await fetch(`${Tb}/api/v1/deals/documents/${I==null?void 0:I.id}/download`,{headers:{Authorization:`Bearer ${k}`}});if(!z.ok)throw new Error("Download failed");const V=await z.blob(),Z=window.URL.createObjectURL(V),ce=document.createElement("a");ce.href=Z,ce.download=(I==null?void 0:I.name)||"download",(L=document.body)==null||L.appendChild(ce),ce==null||ce.click(),(C=document.body)==null||C.removeChild(ce),window.URL.revokeObjectURL(Z)}catch(k){alert("Failed to download document: "+((k==null?void 0:k.message)||"Unknown error"))}},N=async I=>{try{m(I);const L=localStorage.getItem("access_token"),C=await fetch(`${Tb}/api/v1/deals/documents/${I==null?void 0:I.id}/download`,{headers:{Authorization:`Bearer ${L}`}});if(!C.ok)throw new Error("Preview failed");const k=await C.blob(),z=window.URL.createObjectURL(k);p(z),f(!0)}catch(L){alert("Failed to preview document: "+((L==null?void 0:L.message)||"Unknown error"))}},D=()=>{f(!1),x&&(window.URL.revokeObjectURL(x),p(null)),m(null)},S=I=>{const L=I.split(".").pop().toLowerCase();return["jpg","jpeg","png","gif","svg","webp"].includes(L)},T=I=>I.split(".").pop().toLowerCase()==="pdf",A=I=>{const L=I.split(".").pop().toLowerCase();return["txt","log","md","json","xml","yml","yaml"].includes(L)},E=I=>I.split(".").pop().toLowerCase()==="csv",M=I=>{const L=I.split(".").pop().toLowerCase();return["xlsx","xls"].includes(L)},P=I=>{const L=I.split(".").pop().toLowerCase();return["docx","doc"].includes(L)},X=I=>{var C;I==null||I.preventDefault(),u(!1);const L=(C=I==null?void 0:I.dataTransfer)==null?void 0:C.files;b(L)},q=I=>{I==null||I.preventDefault(),u(!0)},B=I=>{I==null||I.preventDefault(),u(!1)},O=I=>{var C;if(!I)return"Unknown date";const L=new Date(I);return L==null?void 0:L.toLocaleDateString("en-US",{month:"short",day:"numeric",year:(L==null?void 0:L.getFullYear())!==((C=new Date)==null?void 0:C.getFullYear())?"numeric":void 0})},F=I=>{if(!I)return"Unknown size";const L=parseInt(I);if(isNaN(L))return I;if(L===0)return"0 Bytes";const C=1024,k=["Bytes","KB","MB","GB"],z=Math.floor(Math.log(L)/Math.log(C));return parseFloat((L/Math.pow(C,z)).toFixed(2))+" "+k[z]};return s.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[s.jsx("div",{className:"p-6 border-b border-border",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Documents"}),r&&!i&&s.jsxs("button",{onClick:()=>{var I;return(I=g==null?void 0:g.current)==null?void 0:I.click()},disabled:o,className:"flex items-center space-x-2 px-3 py-1 bg-primary text-white rounded-lg hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150 text-sm",children:[s.jsx(G,{name:"Upload",size:16}),s.jsx("span",{children:"Upload"})]})]})}),r?s.jsxs(s.Fragment,{children:[!i&&s.jsxs("div",{className:"p-6 border-b border-border",children:[s.jsxs("div",{onDrop:X,onDragOver:q,onDragLeave:B,onClick:()=>{var I;return(I=g==null?void 0:g.current)==null?void 0:I.click()},className:`border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors duration-150 ${l?"border-primary bg-primary-50":"border-border hover:border-border-hover hover:bg-background"}`,children:[s.jsx(G,{name:"Upload",size:24,className:`mx-auto mb-2 ${l?"text-primary":"text-text-tertiary"}`}),s.jsx("p",{className:"text-sm text-text-secondary",children:"Drop files here or click to browse"}),s.jsx("p",{className:"text-xs text-text-tertiary mt-1",children:"Maximum file size: 10MB"})]}),s.jsx("input",{ref:g,type:"file",multiple:!0,onChange:I=>{var L;return b((L=I==null?void 0:I.target)==null?void 0:L.files)},className:"hidden",accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.jpg,.jpeg,.png,.gif,.txt,.csv,.log,.md,.json,.xml,.yml,.yaml,.zip,.rar"})]}),s.jsxs("div",{className:"p-6",children:[o&&s.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-blue-50 border border-blue-200 rounded-lg mb-4",children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),s.jsx("span",{className:"text-sm text-blue-800",children:"Uploading document..."})]}),t?s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"}),s.jsx("span",{className:"ml-2 text-text-secondary",children:"Loading documents..."})]}):(e==null?void 0:e.length)===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(G,{name:"FileText",size:32,className:"text-text-tertiary mx-auto mb-2"}),s.jsx("p",{className:"text-text-secondary",children:"No documents uploaded"}),s.jsx("p",{className:"text-sm text-text-tertiary mt-1",children:"Upload your first document to get started"})]}):s.jsx("div",{className:"space-y-3",children:e==null?void 0:e.map(I=>{var C;const L=y(I==null?void 0:I.name);return s.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-background rounded-lg border border-border hover:border-border-hover transition-colors duration-150",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:s.jsx(G,{name:L,size:20,className:"text-blue-600"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("h4",{className:"text-sm font-medium text-text-primary truncate",children:I==null?void 0:I.name}),(I==null?void 0:I.documentType)&&(I==null?void 0:I.documentType)!=="other"&&s.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-800 text-xs rounded-full",children:((C=v==null?void 0:v.find(k=>(k==null?void 0:k.value)===(I==null?void 0:I.documentType)))==null?void 0:C.label)||(I==null?void 0:I.documentType)})]}),s.jsxs("div",{className:"flex items-center space-x-2 text-xs text-text-tertiary",children:[s.jsx("span",{children:F(I==null?void 0:I.file_size)}),s.jsx("span",{children:""}),s.jsx("span",{children:O(I==null?void 0:I.created_at)})]})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("button",{onClick:()=>N(I),className:"p-2 text-text-tertiary hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-150",title:"Preview",children:s.jsx(G,{name:"Eye",size:16})}),s.jsx("button",{onClick:()=>j(I),className:"p-2 text-text-tertiary hover:text-primary hover:bg-primary-50 rounded-lg transition-colors duration-150",title:"Download",children:s.jsx(G,{name:"Download",size:16})}),!i&&s.jsx("button",{onClick:()=>w(I),className:"p-2 text-text-tertiary hover:text-error hover:bg-error-50 rounded-lg transition-colors duration-150",title:"Delete",children:s.jsx(G,{name:"Trash2",size:16})})]})]},I==null?void 0:I.id)})})]})]}):s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"text-center py-8",children:[s.jsx(G,{name:"FileText",size:32,className:"text-text-tertiary mx-auto mb-2"}),s.jsx("p",{className:"text-text-secondary",children:"Save the deal first to upload documents"}),s.jsx("p",{className:"text-sm text-text-tertiary mt-1",children:"Documents can be added after creating the deal"})]})}),d&&h&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[9999] p-4",children:s.jsxs("div",{className:"bg-white dark:bg-surface rounded-lg shadow-xl w-full max-w-6xl max-h-[90vh] flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(G,{name:y(h==null?void 0:h.name),size:24,className:"text-primary"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:h==null?void 0:h.name}),s.jsxs("p",{className:"text-sm text-text-secondary",children:[F(h==null?void 0:h.file_size),"  ",O(h==null?void 0:h.created_at)]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>j(h),className:"p-2 text-text-secondary hover:text-primary hover:bg-primary-50 rounded-lg transition-colors duration-150",title:"Download",children:s.jsx(G,{name:"Download",size:20})}),s.jsx("button",{onClick:D,className:"p-2 text-text-secondary hover:text-text-primary hover:bg-surface-hover rounded-lg transition-colors duration-150",title:"Close",children:s.jsx(G,{name:"X",size:20})})]})]}),s.jsx("div",{className:"flex-1 overflow-auto p-4 bg-gray-50 dark:bg-gray-900",children:S(h==null?void 0:h.name)?s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsx("img",{src:x,alt:h==null?void 0:h.name,className:"max-w-full max-h-full object-contain rounded-lg shadow-lg"})}):T(h==null?void 0:h.name)?s.jsx("iframe",{src:x,className:"w-full h-full min-h-[600px] rounded-lg shadow-lg",title:h==null?void 0:h.name}):A(h==null?void 0:h.name)?s.jsx(Mje,{fileUrl:x,fileName:h==null?void 0:h.name}):E(h==null?void 0:h.name)?s.jsx(Lje,{fileUrl:x,fileName:h==null?void 0:h.name}):M(h==null?void 0:h.name)?s.jsx(WOe,{fileUrl:x,fileName:h==null?void 0:h.name}):P(h==null?void 0:h.name)?s.jsx(VIe,{fileUrl:x,fileName:h==null?void 0:h.name}):s.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[s.jsx(G,{name:"FileText",size:64,className:"text-text-tertiary mb-4"}),s.jsx("h4",{className:"text-xl font-semibold text-text-primary mb-2",children:"Preview not available"}),s.jsx("p",{className:"text-text-secondary mb-4",children:"Preview is not available for this file type."}),s.jsxs("button",{onClick:()=>j(h),className:"btn-primary flex items-center space-x-2",children:[s.jsx(G,{name:"Download",size:16}),s.jsx("span",{children:"Download File"})]})]})})]})})]})},XIe=({deals:e,stages:t,onViewDeal:r,onEditDeal:n,onCloneDeal:a,onDeleteDeal:i})=>{const{hasAnyPermission:o}=Pt();R.useEffect(()=>{kr.loadConfiguration()},[]);const c=l=>kr.formatCurrency(l);return e.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(G,{name:"Package",size:48,className:"text-text-tertiary mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"No deals found"}),s.jsx("p",{className:"text-text-secondary",children:"Try adjusting your filters or create a new deal"})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:e.map(l=>{const u=t.find(d=>d.value===l.stage);return s.jsxs("div",{className:"bg-surface rounded-lg border border-border p-6 hover:shadow-md transition-shadow duration-200 cursor-pointer",onClick:()=>r(l),children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2 line-clamp-2",children:l.name||"Untitled Deal"}),s.jsx("p",{className:"text-sm text-text-secondary line-clamp-2 min-h-[2.5rem]",children:l.description||"No description"})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("div",{className:"text-2xl font-bold text-text-primary",children:c(l.value||0)}),s.jsxs("div",{className:"text-sm text-text-secondary",children:[l.probability||0,"% probability"]})]}),s.jsx("div",{className:"mb-4",children:s.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full ${(u==null?void 0:u.color)||"bg-gray-100 text-gray-800"}`,children:(u==null?void 0:u.label)||l.stage})}),s.jsxs("div",{className:"space-y-2 text-xs text-text-secondary",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{children:"Created:"}),s.jsx("span",{children:new Date(l.created_at).toLocaleDateString()})]}),l.updated_at&&s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{children:"Updated:"}),s.jsx("span",{children:new Date(l.updated_at).toLocaleDateString()})]}),l.contact_name&&s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{children:"Contact:"}),s.jsx("span",{className:"truncate ml-2",children:l.contact_name})]}),l.company_name&&s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{children:"Company:"}),s.jsx("span",{className:"truncate ml-2",children:l.company_name})]})]}),s.jsx("div",{className:"mt-4 pt-4 border-t border-border",children:s.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[o(["deals.edit_all","deals.edit_own"])&&s.jsxs("button",{onClick:d=>{d.stopPropagation(),n(l)},className:"flex items-center space-x-1 px-3 py-2 text-primary hover:bg-primary-50 rounded-lg transition-colors duration-150",title:"Edit deal",children:[s.jsx(G,{name:"Edit",size:16}),s.jsx("span",{className:"text-sm font-medium",children:"Edit"})]}),s.jsxs("button",{onClick:d=>{d.stopPropagation(),a(l)},className:"flex items-center space-x-1 px-3 py-2 text-text-secondary hover:bg-surface-hover rounded-lg transition-colors duration-150",title:"Clone deal",children:[s.jsx(G,{name:"Copy",size:16}),s.jsx("span",{className:"text-sm font-medium",children:"Clone"})]}),o(["deals.delete_all","deals.delete_own"])&&s.jsxs("button",{onClick:d=>{d.stopPropagation(),i(l)},className:"flex items-center space-x-1 px-3 py-2 text-error hover:bg-error-50 rounded-lg transition-colors duration-150",title:"Delete deal",children:[s.jsx(G,{name:"Trash2",size:16}),s.jsx("span",{className:"text-sm font-medium",children:"Delete"})]})]})})]},l.id)})})},ML=({deals:e,onClose:t,filters:r})=>{const[n,a]=R.useState("csv"),[i,o]=R.useState(!1),c=async()=>{o(!0);try{const h=await ut.exportDeals(r||{}),m=l(h);n==="csv"?u(m):n==="json"&&d(m),setTimeout(()=>{o(!1),t()},500)}catch(h){console.error("Export failed:",h),o(!1),alert("Export failed. Please try again.")}},l=h=>h.map(m=>{var p;const x=g=>{if(!g)return"";const v=g.first_name||"",y=g.last_name||"";return`${v} ${y}`.trim()};return{name:m.name||"",stage:m.stage||"",value:m.value||0,probability:m.probability||0,expected_close_date:m.expected_close_date||"",company:((p=m.company)==null?void 0:p.name)||"",contact:x(m.contact),owner:x(m.owner),description:m.description||"",source:m.source||"",next_action:m.next_action||"",created_at:m.created_at||"",updated_at:m.updated_at||"",...m.custom_fields||{}}}),u=h=>{const p=[["Name","Stage","Value","Probability (%)","Expected Close Date","Company","Contact","Owner","Description","Source","Next Action","Created At","Updated At"].join(","),...h.map(b=>[f(b.name),f(b.stage),b.value,b.probability,f(b.expected_close_date),f(b.company),f(b.contact),f(b.owner),f(b.description),f(b.source),f(b.next_action),f(b.created_at),f(b.updated_at)].join(","))].join(`
`),g=new Blob([p],{type:"text/csv;charset=utf-8;"}),v=document.createElement("a"),y=URL.createObjectURL(g);v.setAttribute("href",y),v.setAttribute("download",`deals_export_${new Date().toISOString().split("T")[0]}.csv`),v.style.visibility="hidden",document.body.appendChild(v),v.click(),document.body.removeChild(v)},d=h=>{const m=JSON.stringify(h,null,2),x=new Blob([m],{type:"application/json;charset=utf-8;"}),p=document.createElement("a"),g=URL.createObjectURL(x);p.setAttribute("href",g),p.setAttribute("download",`deals_export_${new Date().toISOString().split("T")[0]}.json`),p.style.visibility="hidden",document.body.appendChild(p),p.click(),document.body.removeChild(p)},f=h=>{if(h==null)return"";const m=String(h);return m.includes(",")||m.includes('"')||m.includes(`
`)?`"${m.replace(/"/g,'""')}"`:m};return s.jsx("div",{className:"fixed inset-0 z-1100 overflow-y-auto",children:s.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[s.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50"})}),s.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:""}),s.jsxs("div",{className:"inline-block align-bottom bg-surface rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-border flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Export Deals"}),s.jsx("button",{onClick:t,className:"text-text-secondary hover:text-text-primary transition-colors duration-150",children:s.jsx(G,{name:"X",size:20})})]}),s.jsx("div",{className:"px-6 py-5",children:s.jsxs("div",{className:"mb-6",children:[s.jsxs("p",{className:"text-text-secondary mb-4",children:["Exporting ",e==null?void 0:e.length," ",(e==null?void 0:e.length)===1?"deal":"deals",r&&Object.keys(r).length>0&&" with applied filters"]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("div",{className:"block text-sm font-medium text-text-primary mb-2",children:"Export Format"}),s.jsxs("div",{className:"flex space-x-4",children:[s.jsxs("label",{className:"inline-flex items-center",children:[s.jsx("input",{type:"radio",value:"csv",checked:n==="csv",onChange:()=>a("csv"),className:"h-4 w-4 text-primary border-border focus:ring-primary"}),s.jsx("span",{className:"ml-2 text-text-secondary",children:"CSV"})]}),s.jsxs("label",{className:"inline-flex items-center",children:[s.jsx("input",{type:"radio",value:"json",checked:n==="json",onChange:()=>a("json"),className:"h-4 w-4 text-primary border-border focus:ring-primary"}),s.jsx("span",{className:"ml-2 text-text-secondary",children:"JSON"})]})]})]}),s.jsxs("div",{className:"bg-surface-hover border border-border rounded-lg p-4",children:[s.jsx("h4",{className:"text-sm font-medium text-text-primary mb-2",children:"Export includes:"}),s.jsxs("ul",{className:"text-sm text-text-secondary space-y-1",children:[s.jsxs("li",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"Check",size:14,className:"text-success"}),s.jsx("span",{children:"Deal information (name, stage, value, probability)"})]}),s.jsxs("li",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"Check",size:14,className:"text-success"}),s.jsx("span",{children:"Associated company and contact details"})]}),s.jsxs("li",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"Check",size:14,className:"text-success"}),s.jsx("span",{children:"Owner and timeline information"})]}),s.jsxs("li",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"Check",size:14,className:"text-success"}),s.jsx("span",{children:"Descriptions and next actions"})]})]})]})]})}),s.jsxs("div",{className:"px-6 py-4 bg-surface-hover border-t border-border flex justify-end space-x-3",children:[s.jsx("button",{onClick:t,disabled:i,className:"px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-out disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),s.jsx("button",{onClick:c,disabled:i,className:"btn-primary inline-flex items-center disabled:opacity-50 disabled:cursor-not-allowed",children:i?s.jsxs(s.Fragment,{children:[s.jsx(G,{name:"Loader",size:16,className:"animate-spin mr-2"}),"Exporting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(G,{name:"Download",size:16,className:"mr-2"}),"Export ",n.toUpperCase()]})})]})]})]})})};ML.propTypes={deals:kt.array.isRequired,onClose:kt.func.isRequired,filters:kt.object};const us={async getDealActivities(e){try{const{data:t,error:r}=await be.get(`/api/v1/deals/${e}/activities`);if(r)throw r;return t||[]}catch(t){throw console.error("Error fetching deal activities:",t),t}},async createDealActivity(e,t){try{const r={type:t.type,subject:t.subject,description:t.description||null,duration_minutes:t.duration_minutes||null,outcome:t.outcome||null,contact_id:t.contact_id||null,deal_id:e,custom_fields:t.custom_fields||void 0},{data:n,error:a}=await be.post("/api/v1/activities",r);if(a)throw a;return n}catch(r){throw console.error("Error creating deal activity:",r),r}},async deleteDealActivity(e){try{const{data:t,error:r}=await be.delete(`/api/v1/activities/${e}`);if(r)throw r;return!0}catch(t){throw console.error("Error deleting deal activity:",t),t}},subscribeToDealActivities(e,t){return{unsubscribe:()=>{}}},async createActivity(e){return this.createDealActivity(e.dealId,e)},async deleteActivity(e){return this.deleteDealActivity(e)},subscribeToActivityChanges(e,t){return this.subscribeToDealActivities(e,t)},unsubscribeFromActivityChanges(e){e&&e.unsubscribe&&e.unsubscribe()}},Cb=()=>{var Io,Gh,Xh;const{dealId:e}=G2(),t=Os(),{user:r,hasPermission:n,hasAnyPermission:a}=Pt(),[i,o]=R.useState(null),[c,l]=R.useState([]),[u,d]=R.useState([]),[f,h]=R.useState([]),[m,x]=R.useState([]),[p,g]=R.useState([]),[v,y]=R.useState(!1),[b,_]=R.useState(!0),[w,j]=R.useState(!1),[N,D]=R.useState(!1),[S,T]=R.useState(!0),[A,E]=R.useState(!1),[M,P]=R.useState(!1),[X,q]=R.useState(!1),[B,O]=R.useState(null),[F,I]=R.useState(!1),[L,C]=R.useState(!1),[k,z]=R.useState("all"),[V,Z]=R.useState(""),[ce,ie]=R.useState("created_at"),[Q,ne]=R.useState("desc");R.useEffect(()=>{kr.loadConfiguration()},[]);const pe=Oe=>kr.formatCurrency(Oe),[W,re]=R.useState(1),[U,se]=R.useState(10),[te,K]=R.useState(null),[H,oe]=R.useState(null),J=[{value:"lead",label:"Lead",color:"bg-gray-100 text-gray-800"},{value:"qualified",label:"Qualified",color:"bg-blue-100 text-blue-800"},{value:"proposal",label:"Proposal",color:"bg-yellow-100 text-yellow-800"},{value:"negotiation",label:"Negotiation",color:"bg-orange-100 text-orange-800"},{value:"closed_won",label:"Closed Won",color:"bg-green-100 text-green-800"},{value:"closed_lost",label:"Closed Lost",color:"bg-red-100 text-red-800"}],le=c.filter(Oe=>{const Ge=k==="all"||Oe.stage===k,Me=!V||(Oe.name||"").toLowerCase().includes(V.toLowerCase())||(Oe.description||"").toLowerCase().includes(V.toLowerCase())||(Oe.company_name||"").toLowerCase().includes(V.toLowerCase())||(Oe.contact_name||"").toLowerCase().includes(V.toLowerCase());return Ge&&Me}),he=[...le].sort((Oe,Ge)=>{let Me,ht;switch(ce){case"name":Me=(Oe.name||"").toLowerCase(),ht=(Ge.name||"").toLowerCase();break;case"value":Me=Oe.value||0,ht=Ge.value||0;break;case"probability":Me=Oe.probability||0,ht=Ge.probability||0;break;case"created_at":Me=new Date(Oe.created_at||0).getTime(),ht=new Date(Ge.created_at||0).getTime();break;case"stage":const ar={lead:1,qualified:2,proposal:3,negotiation:4,closed_won:5,closed_lost:6};Me=ar[Oe.stage]||0,ht=ar[Ge.stage]||0;break;default:return 0}return Q==="asc"?Me>ht?1:Me<ht?-1:0:Me<ht?1:Me>ht?-1:0}),ee=he.length,ae=Math.ceil(ee/U),xe=(W-1)*U,ye=xe+U,Ce=he.slice(xe,ye);R.useEffect(()=>{re(1)},[k,V]);const Ie=Oe=>{re(Oe)},Ze=Oe=>{se(Oe),re(1)},Fe=Oe=>{ce===Oe?ne(Q==="asc"?"desc":"asc"):(ie(Oe),ne("asc")),re(1)};R.useEffect(()=>{if(!r)return;(async()=>{T(!0),O(null);try{const[Ge,Me,ht]=await Promise.all([ut==null?void 0:ut.getUserDeals(),Nt==null?void 0:Nt.getUserContacts(),Wt==null?void 0:Wt.getAllCompanies()]);l(Ge||[]),d(Me||[]),h(ht||[]),e&&e!=="new"?(_(!1),D(!0),y(!1),await He(e)):e==="new"?(_(!1),D(!1),y(!0),o(null)):(_(!0),D(!1),y(!1))}catch(Ge){console.error("Error loading initial data:",Ge),O("Failed to load data. Please refresh the page.")}finally{T(!1)}})()},[e,r]);const He=async Oe=>{var Ge,Me,ht,ar,rs;try{const Y=await(ut==null?void 0:ut.getDealById(Oe));if(!Y){O("Deal not found"),T(!1);return}o(Y),await Promise.all([rt(Oe),Je(Oe)]),Gt(Oe)}catch(Y){console.error("Error loading deal:",Y),(Y==null?void 0:Y.code)==="PGRST116"||(Ge=Y==null?void 0:Y.message)!=null&&Ge.includes("not found")?O("Deal not found. It may have been deleted or you may not have permission to view it."):(Me=Y==null?void 0:Y.message)!=null&&Me.toLowerCase().includes("permission")||(ht=Y==null?void 0:Y.message)!=null&&ht.toLowerCase().includes("policy")?O("Permission denied. You may not have access to view this deal."):((ar=Y==null?void 0:Y.message)!=null&&ar.includes("company")||(rs=Y==null?void 0:Y.message)!=null&&rs.includes("schema cache"))&&O("Could not load deal information. Please check your database connection and try refreshing the page.")}finally{T(!1)}},rt=async Oe=>{P(!0);try{const Ge=await(us==null?void 0:us.getDealActivities(Oe));x(Ge||[])}catch(Ge){console.error("Error loading activities:",Ge)}finally{P(!1)}},Je=async Oe=>{q(!0);try{const Ge=await(fr==null?void 0:fr.getDealDocuments(Oe));g(Ge||[])}catch(Ge){console.error("Error loading documents:",Ge)}finally{q(!1)}},Gt=Oe=>{const Ge=us==null?void 0:us.subscribeToActivityChanges(Oe,ht=>{ma(ht)});K(Ge);const Me=fr==null?void 0:fr.subscribeToDocumentChanges(Oe,ht=>{yn(ht)});oe(Me)},ma=R.useCallback(Oe=>{const{eventType:Ge,new:Me,old:ht}=Oe;x(ar=>{switch(Ge){case"INSERT":return[{id:Me==null?void 0:Me.id,type:Me==null?void 0:Me.type,title:Me==null?void 0:Me.subject,description:Me==null?void 0:Me.description,timestamp:Me==null?void 0:Me.created_at,user:"Unknown User",dealId:Me==null?void 0:Me.deal_id},...ar];case"DELETE":return ar==null?void 0:ar.filter(Y=>(Y==null?void 0:Y.id)!==(ht==null?void 0:ht.id));case"UPDATE":return ar==null?void 0:ar.map(Y=>(Y==null?void 0:Y.id)===(Me==null?void 0:Me.id)?{...Y,...Me}:Y);default:return ar}})},[]),yn=R.useCallback(Oe=>{const{eventType:Ge,new:Me,old:ht}=Oe;g(ar=>{switch(Ge){case"INSERT":return[{id:Me==null?void 0:Me.id,name:Me==null?void 0:Me.name,size:fr==null?void 0:fr.formatFileSize(Me==null?void 0:Me.file_size),type:fr==null?void 0:fr.getFileExtension(Me==null?void 0:Me.name),uploadedAt:Me==null?void 0:Me.created_at,uploadedBy:"Unknown User",dealId:Me==null?void 0:Me.deal_id,fileUrl:Me==null?void 0:Me.file_url},...ar];case"DELETE":return ar==null?void 0:ar.filter(Y=>(Y==null?void 0:Y.id)!==(ht==null?void 0:ht.id));default:return ar}})},[]);R.useEffect(()=>()=>{te&&(us==null||us.unsubscribeFromActivityChanges(te)),H&&(fr==null||fr.unsubscribeFromDocumentChanges(H))},[te,H]);const Qe=()=>{o(null),y(!0),_(!1),t("/deal-management/new")},vt=async Oe=>{D(!0),y(!1),_(!1),t(`/deal-management/${Oe.id}`);try{const Ge=await(ut==null?void 0:ut.getDealById(Oe.id));o(Ge)}catch(Ge){console.error("Error loading full deal data:",Ge),o(Oe)}},At=()=>{D(!1),y(!0)},bt=()=>{y(!1),D(!1),_(!0),o(null),O(null),t("/deal-management")},Yn=async Oe=>{var Ge,Me,ht,ar,rs;if(!(r!=null&&r.id)){O("You must be logged in to save deals");return}E(!0),O(null);try{let Y;if(i!=null&&i.id)Y=await(ut==null?void 0:ut.updateDeal(i==null?void 0:i.id,{...Oe,owner_id:r==null?void 0:r.id})),Y&&(o(Y),l(fe=>fe.map(ue=>ue.id===Y.id?Y:ue)),Be.success(`Deal "${Y.name||"Untitled Deal"}" updated successfully!`));else if(Y=await(ut==null?void 0:ut.createDeal({...Oe,owner_id:r==null?void 0:r.id})),Y!=null&&Y.id)Be.success(`Deal "${Oe.name||"Untitled Deal"}" created successfully!`),l(fe=>[Y,...fe]);else throw new Error("Deal created but no ID returned");E(!1),bt()}catch(Y){if(console.error("Error saving deal:",Y),(Y==null?void 0:Y.code)==="23503"){const fe="The selected company or contact is no longer available. Please refresh the page and select valid options.";O(fe),Be.error(fe)}else if((Y==null?void 0:Y.code)==="PGRST116"||(Ge=Y==null?void 0:Y.message)!=null&&Ge.includes("not found")){const fe="Deal not found. It may have been deleted by another user.";O(fe),Be.error(fe),t("/deal-management");return}else if((Me=Y==null?void 0:Y.message)!=null&&Me.toLowerCase().includes("permission")||(ht=Y==null?void 0:Y.message)!=null&&ht.toLowerCase().includes("policy")){const fe="Permission denied. You may not have access to modify this deal.";O(fe),Be.error(fe)}else if((ar=Y==null?void 0:Y.message)!=null&&ar.includes("company")||(rs=Y==null?void 0:Y.message)!=null&&rs.includes("schema cache")){const fe="There was an issue accessing company information. Please refresh the page and try again.";O(fe),Be.error(fe)}else{const fe=(Y==null?void 0:Y.message)||"Failed to save deal. Please try again.";O(fe),Be.error(fe)}}finally{E(!1)}},ln=async()=>{if(!(!(i!=null&&i.id)||!(r!=null&&r.id))){try{await(ut==null?void 0:ut.deleteDeal(i==null?void 0:i.id)),Be.success(`Deal "${i.name||"Untitled Deal"}" deleted successfully!`),l(Oe=>Oe.filter(Ge=>Ge.id!==i.id)),t("/deal-management")}catch(Oe){console.error("Error deleting deal:",Oe);const Ge="Failed to delete deal. Please try again.";O(Ge),Be.error(Ge)}I(!1)}},bn=async()=>{if(!(!i||!(r!=null&&r.id)))try{const Oe={name:`${i==null?void 0:i.name} (Copy)`,description:i==null?void 0:i.description,value:i==null?void 0:i.value,stage:"lead",probability:10,contact_id:i==null?void 0:i.contact_id,company_id:i==null?void 0:i.company_id,lead_source:i==null?void 0:i.lead_source,owner_id:r==null?void 0:r.id};let Ge=await(ut==null?void 0:ut.createDeal(Oe));Ge!=null&&Ge.id&&(Be.success(`Deal "${Oe.name}" cloned successfully!`),l(Me=>[Ge,...Me]),t(`/deal-management/${Ge==null?void 0:Ge.id}`))}catch(Oe){console.error("Error cloning deal:",Oe);const Ge="Failed to clone deal. Please try again.";O(Ge),Be.error(Ge)}},Oo=()=>{if(le.length===0){O("No deals to export"),setTimeout(()=>O(null),3e3);return}C(!0)},$u=async(Oe,Ge="other")=>{if(i!=null&&i.id)try{const Me=await(fr==null?void 0:fr.uploadDocument(Oe,i==null?void 0:i.id,Ge));g(ht=>[Me,...ht])}catch(Me){throw console.error("Error uploading document:",Me),O("Failed to upload document. Please try again."),Me}},Po=async Oe=>{try{g(Ge=>Ge==null?void 0:Ge.filter(Me=>(Me==null?void 0:Me.id)!==Oe))}catch(Ge){console.error("Error deleting document:",Ge),O("Failed to delete document. Please try again.")}};return S?s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(Ta,{}),s.jsx("main",{className:"pt-16",children:s.jsx("div",{className:"px-6 py-8",children:s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsx("div",{className:"flex items-center justify-center h-96",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),s.jsx("span",{className:"text-text-secondary",children:"Loading deal..."})]})})})})})]}):B&&!i&&!b?s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(Ta,{}),s.jsx("main",{className:"pt-16",children:s.jsx("div",{className:"px-6 py-8",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx(Ki,{}),s.jsxs("div",{className:"text-center py-12",children:[s.jsx(G,{name:"AlertCircle",size:48,className:"text-text-tertiary mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:i===null&&e!=="new"?"Deal Not Found":"Error"}),s.jsx("p",{className:"text-text-secondary mb-6",children:B}),s.jsx("button",{onClick:()=>t("/sales-dashboard"),className:"btn-primary",children:"Back to Dashboard"})]})]})})})]}):s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(Ta,{}),s.jsx("main",{className:"pt-16",children:s.jsx("div",{className:"px-6 py-8",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx(Ki,{}),B&&s.jsxs("div",{className:"bg-error-50 border border-error-200 text-error p-4 rounded-lg flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"AlertCircle",size:20}),s.jsx("span",{children:B})]}),s.jsx("button",{onClick:()=>O(null),className:"text-error hover:text-error-600",children:s.jsx(G,{name:"X",size:16})})]}),s.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-8",children:[s.jsxs("div",{className:"mb-4 lg:mb-0",children:[s.jsx("h1",{className:"text-3xl font-bold text-text-primary mb-2",children:b?"Deal Management":(i==null?void 0:i.name)||"New Deal"}),s.jsx("div",{className:"flex items-center space-x-4 text-sm text-text-secondary",children:b?s.jsx("span",{children:"Manage all your deals"}):s.jsxs(s.Fragment,{children:[(i==null?void 0:i.id)&&s.jsxs(s.Fragment,{children:[s.jsxs("span",{children:["Deal ID: #",i==null?void 0:i.id]}),s.jsx("span",{children:""})]}),(i==null?void 0:i.created_at)&&s.jsxs(s.Fragment,{children:[s.jsxs("span",{children:["Created: ",(Io=new Date(i.created_at))==null?void 0:Io.toLocaleDateString()]}),s.jsx("span",{children:""})]}),(i==null?void 0:i.updated_at)&&s.jsxs("span",{children:["Last updated: ",(Gh=new Date(i.updated_at))==null?void 0:Gh.toLocaleDateString()]})]})})]}),s.jsx("div",{className:"flex items-center space-x-3",children:b?s.jsxs(s.Fragment,{children:[n("deals.export")&&s.jsxs("button",{onClick:Oo,disabled:le.length===0,className:"flex items-center space-x-2 px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-out disabled:opacity-50 disabled:cursor-not-allowed",title:"Export deals",children:[s.jsx(G,{name:"Download",size:16}),s.jsx("span",{children:"Export"})]}),n("deals.create")&&s.jsxs("button",{onClick:Qe,className:"btn-primary flex items-center space-x-2",children:[s.jsx(G,{name:"Plus",size:16}),s.jsx("span",{children:"Create Deal"})]})]}):s.jsxs("button",{onClick:bt,className:"btn-secondary flex items-center space-x-2",children:[s.jsx(G,{name:"ArrowLeft",size:16}),s.jsx("span",{children:"Back to List"})]})})]}),b?s.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[s.jsx("div",{className:"p-6 border-b border-border",children:s.jsxs("div",{className:"relative",children:[s.jsx(G,{name:"Search",size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary"}),s.jsx("input",{type:"text",placeholder:"Search deals by name, company, or description...",value:V,onChange:Oe=>Z(Oe.target.value),className:"w-full pl-10 pr-4 py-3 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary text-text-primary placeholder-text-tertiary"}),V&&s.jsx("button",{onClick:()=>Z(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-text-tertiary hover:text-text-primary",children:s.jsx(G,{name:"X",size:16})})]})}),s.jsxs("div",{className:"p-6 border-b border-border",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"All Deals"}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-sm text-text-secondary",children:"Show:"}),s.jsxs("select",{value:U,onChange:Oe=>Ze(Number(Oe.target.value)),className:"text-sm border border-border rounded-md px-2 py-1 bg-surface",children:[s.jsx("option",{value:10,children:"10"}),s.jsx("option",{value:25,children:"25"}),s.jsx("option",{value:50,children:"50"}),s.jsx("option",{value:100,children:"100"})]})]}),s.jsxs("div",{className:"flex items-center bg-gray-100 rounded-lg p-1",children:[s.jsxs("button",{onClick:()=>j(!1),className:`flex items-center space-x-1 px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${w?"text-text-secondary hover:text-text-primary":"bg-white text-primary shadow-sm"}`,children:[s.jsx(G,{name:"List",size:16}),s.jsx("span",{children:"List"})]}),s.jsxs("button",{onClick:()=>j(!0),className:`flex items-center space-x-1 px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${w?"bg-white text-primary shadow-sm":"text-text-secondary hover:text-text-primary"}`,children:[s.jsx(G,{name:"Grid",size:16}),s.jsx("span",{children:"Grid"})]})]}),s.jsxs("div",{className:"text-sm text-text-secondary",children:[le.length," deal",le.length!==1?"s":"",(k!=="all"||V)&&` (${c.length} total)`]})]})]}),s.jsx("div",{className:"mt-4",children:s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs("button",{onClick:()=>z("all"),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${k==="all"?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["All Stages (",c.length,")"]}),J.map(Oe=>{const Ge=c.filter(Me=>Me.stage===Oe.value).length;return s.jsxs("button",{onClick:()=>z(Oe.value),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${k===Oe.value?"bg-primary text-white":`${Oe.color} hover:opacity-80`}`,children:[Oe.label," (",Ge,")"]},Oe.value)})]})})]}),S?s.jsxs("div",{className:"p-8 text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),s.jsx("p",{className:"text-text-secondary",children:"Loading deals..."})]}):le.length===0?s.jsxs("div",{className:"p-8 text-center",children:[s.jsx(G,{name:"Package",size:48,className:"text-text-tertiary mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:k==="all"?"No deals yet":`No deals in ${(Xh=J.find(Oe=>Oe.value===k))==null?void 0:Xh.label} stage`}),s.jsx("p",{className:"text-text-secondary mb-4",children:k==="all"?"Create your first deal to get started":"Try selecting a different stage or create a new deal"}),k==="all"&&s.jsx("button",{onClick:Qe,className:"btn-primary",children:"Create Deal"})]}):w?s.jsxs("div",{className:"p-6",children:[s.jsx(XIe,{deals:Ce,stages:J,onViewDeal:vt,onEditDeal:Oe=>{vt(Oe),setTimeout(()=>At(),100)},onCloneDeal:Oe=>{o(Oe),bn()},onDeleteDeal:Oe=>{o(Oe),I(!0)}}),le.length>0&&s.jsx("div",{className:"mt-6 pt-6 border-t border-border",children:s.jsx(dx,{currentPage:W,totalPages:ae,totalItems:ee,itemsPerPage:U,onPageChange:Ie})})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider cursor-pointer hover:bg-surface-hover transition-colors",onClick:()=>Fe("name"),children:s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("span",{children:"Deal"}),ce==="name"&&s.jsx(G,{name:Q==="asc"?"ArrowUp":"ArrowDown",size:14,className:"text-primary"})]})}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider cursor-pointer hover:bg-surface-hover transition-colors",onClick:()=>Fe("stage"),children:s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("span",{children:"Stage"}),ce==="stage"&&s.jsx(G,{name:Q==="asc"?"ArrowUp":"ArrowDown",size:14,className:"text-primary"})]})}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider cursor-pointer hover:bg-surface-hover transition-colors",onClick:()=>Fe("value"),children:s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("span",{children:"Value"}),ce==="value"&&s.jsx(G,{name:Q==="asc"?"ArrowUp":"ArrowDown",size:14,className:"text-primary"})]})}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider cursor-pointer hover:bg-surface-hover transition-colors",onClick:()=>Fe("probability"),children:s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("span",{children:"Probability"}),ce==="probability"&&s.jsx(G,{name:Q==="asc"?"ArrowUp":"ArrowDown",size:14,className:"text-primary"})]})}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider cursor-pointer hover:bg-surface-hover transition-colors",onClick:()=>Fe("created_at"),children:s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("span",{children:"Created"}),ce==="created_at"&&s.jsx(G,{name:Q==="asc"?"ArrowUp":"ArrowDown",size:14,className:"text-primary"})]})}),s.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-border",children:Ce.map(Oe=>{var Ge,Me;return s.jsxs("tr",{className:"hover:bg-surface-hover transition-colors duration-150 cursor-pointer",onClick:()=>vt(Oe),children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-text-primary",children:Oe.name||"Untitled Deal"}),s.jsx("div",{className:"text-sm text-text-secondary truncate max-w-xs",children:Oe.description||"No description"})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${((Ge=J.find(ht=>ht.value===Oe.stage))==null?void 0:Ge.color)||"bg-gray-100 text-gray-800"}`,children:((Me=J.find(ht=>ht.value===Oe.stage))==null?void 0:Me.label)||Oe.stage})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-primary",children:pe(Oe.value||0)}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-primary",children:[Oe.probability||0,"%"]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-secondary",children:new Date(Oe.created_at).toLocaleDateString()}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:s.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[a(["deals.edit_all","deals.edit_own"])&&s.jsx("button",{onClick:ht=>{ht.stopPropagation(),vt(Oe),setTimeout(()=>At(),100)},className:"p-2 text-primary hover:bg-primary-50 rounded-lg transition-colors duration-150",title:"Edit deal",children:s.jsx(G,{name:"Edit",size:16})}),s.jsx("button",{onClick:ht=>{ht.stopPropagation(),o(Oe),bn()},className:"p-2 text-text-secondary hover:bg-surface-hover rounded-lg transition-colors duration-150",title:"Clone deal",children:s.jsx(G,{name:"Copy",size:16})}),a(["deals.delete_all","deals.delete_own"])&&s.jsx("button",{onClick:ht=>{ht.stopPropagation(),o(Oe),I(!0)},className:"p-2 text-error hover:bg-error-50 rounded-lg transition-colors duration-150",title:"Delete deal",children:s.jsx(G,{name:"Trash2",size:16})})]})})]},Oe.id)})})]})}),le.length>0&&s.jsx("div",{className:"px-6 py-4 border-t border-border",children:s.jsx(dx,{currentPage:W,totalPages:ae,totalItems:ee,itemsPerPage:U,onPageChange:Ie})})]})]}):s.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-12 gap-8",children:[s.jsx("div",{className:"xl:col-span-8",children:S?s.jsx("div",{className:"bg-surface rounded-lg border border-border p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),s.jsx("p",{className:"text-text-secondary",children:"Loading deal..."})]})}):N?s.jsx(Uje,{deal:i,contacts:u,companies:f,stages:J,onEdit:a(["deals.edit_all","deals.edit_own"])?At:null}):s.jsx(Ije,{deal:i,contacts:u,companies:f,stages:J,onSubmit:Yn,onCancel:bt,isSaving:A})}),!S&&s.jsx("div",{className:"xl:col-span-4 space-y-6",children:s.jsx(GIe,{documents:p,loading:X,dealId:i==null?void 0:i.id,onUploadDocument:N?null:$u,onDeleteDocument:N?null:Po,readOnly:N})})]})]})})}),F&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-surface rounded-lg p-6 max-w-md w-full mx-4",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[s.jsx("div",{className:"w-10 h-10 bg-error-50 rounded-full flex items-center justify-center",children:s.jsx(G,{name:"AlertTriangle",size:20,className:"text-error"})}),s.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Delete Deal"})]}),s.jsxs("p",{className:"text-text-secondary mb-6",children:['Are you sure you want to delete "',i==null?void 0:i.name,'"? This action cannot be undone.']}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:()=>I(!1),className:"flex-1 px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-colors duration-150",children:"Cancel"}),s.jsx("button",{onClick:ln,className:"flex-1 px-4 py-2 bg-error text-white rounded-lg hover:bg-error-600 transition-colors duration-150",children:"Delete Deal"})]})]})}),L&&s.jsx(ML,{deals:le,onClose:()=>C(!1),filters:{stage:k!=="all"?k:null}})]})},BL=6048e5,KIe=864e5,Im=43200,B4=1440,L4=Symbol.for("constructDateFrom");function Fs(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&L4 in e?e[L4](t):e instanceof Date?new e.constructor(t):new Date(t)}function an(e,t){return Fs(t||e,e)}let YIe={};function Vh(){return YIe}function nh(e,t){var c,l,u,d;const r=Vh(),n=(t==null?void 0:t.weekStartsOn)??((l=(c=t==null?void 0:t.locale)==null?void 0:c.options)==null?void 0:l.weekStartsOn)??r.weekStartsOn??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,a=an(e,t==null?void 0:t.in),i=a.getDay(),o=(i<n?7:0)+i-n;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function Rx(e,t){return nh(e,{...t,weekStartsOn:1})}function LL(e,t){const r=an(e,t==null?void 0:t.in),n=r.getFullYear(),a=Fs(r,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const i=Rx(a),o=Fs(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const c=Rx(o);return r.getTime()>=i.getTime()?n+1:r.getTime()>=c.getTime()?n:n-1}function Mx(e){const t=an(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function dv(e,...t){const r=Fs.bind(null,e||t.find(n=>typeof n=="object"));return t.map(r)}function $4(e,t){const r=an(e,t==null?void 0:t.in);return r.setHours(0,0,0,0),r}function ZIe(e,t,r){const[n,a]=dv(r==null?void 0:r.in,e,t),i=$4(n),o=$4(a),c=+i-Mx(i),l=+o-Mx(o);return Math.round((c-l)/KIe)}function JIe(e,t){const r=LL(e,t),n=Fs(e,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),Rx(n)}function Vm(e,t){const r=+an(e)-+an(t);return r<0?-1:r>0?1:r}function QIe(e){return Fs(e,Date.now())}function eUe(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function tUe(e){return!(!eUe(e)&&typeof e!="number"||isNaN(+an(e)))}function rUe(e,t,r){const[n,a]=dv(r==null?void 0:r.in,e,t),i=n.getFullYear()-a.getFullYear(),o=n.getMonth()-a.getMonth();return i*12+o}function nUe(e){return t=>{const n=(e?Math[e]:Math.trunc)(t);return n===0?0:n}}function aUe(e,t){return+an(e)-+an(t)}function iUe(e,t){const r=an(e,t==null?void 0:t.in);return r.setHours(23,59,59,999),r}function sUe(e,t){const r=an(e,t==null?void 0:t.in),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function oUe(e,t){const r=an(e,t==null?void 0:t.in);return+iUe(r,t)==+sUe(r,t)}function cUe(e,t,r){const[n,a,i]=dv(r==null?void 0:r.in,e,e,t),o=Vm(a,i),c=Math.abs(rUe(a,i));if(c<1)return 0;a.getMonth()===1&&a.getDate()>27&&a.setDate(30),a.setMonth(a.getMonth()-o*c);let l=Vm(a,i)===-o;oUe(n)&&c===1&&Vm(n,i)===1&&(l=!1);const u=o*(c-+l);return u===0?0:u}function lUe(e,t,r){const n=aUe(e,t)/1e3;return nUe(r==null?void 0:r.roundingMethod)(n)}function uUe(e,t){const r=an(e,t==null?void 0:t.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const dUe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},fUe=(e,t,r)=>{let n;const a=dUe[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function Ab(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const hUe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},mUe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},pUe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},xUe={date:Ab({formats:hUe,defaultWidth:"full"}),time:Ab({formats:mUe,defaultWidth:"full"}),dateTime:Ab({formats:pUe,defaultWidth:"full"})},gUe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},vUe=(e,t,r,n)=>gUe[e];function dd(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,c=r!=null&&r.width?String(r.width):o;a=e.formattingValues[c]||e.formattingValues[o]}else{const o=e.defaultWidth,c=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[c]||e.values[o]}const i=e.argumentCallback?e.argumentCallback(t):t;return a[i]}}const yUe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},bUe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},wUe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},_Ue={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},jUe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},NUe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},DUe=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},SUe={ordinalNumber:DUe,era:dd({values:yUe,defaultWidth:"wide"}),quarter:dd({values:bUe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:dd({values:wUe,defaultWidth:"wide"}),day:dd({values:_Ue,defaultWidth:"wide"}),dayPeriod:dd({values:jUe,defaultWidth:"wide",formattingValues:NUe,defaultFormattingWidth:"wide"})};function fd(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;const o=i[0],c=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(c)?TUe(c,f=>f.test(o)):EUe(c,f=>f.test(o));let u;u=e.valueCallback?e.valueCallback(l):l,u=r.valueCallback?r.valueCallback(u):u;const d=t.slice(o.length);return{value:u,rest:d}}}function EUe(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function TUe(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function CUe(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],i=t.match(e.parsePattern);if(!i)return null;let o=e.valueCallback?e.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const c=t.slice(a.length);return{value:o,rest:c}}}const AUe=/^(\d+)(th|st|nd|rd)?/i,kUe=/\d+/i,FUe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},OUe={any:[/^b/i,/^(a|c)/i]},PUe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},IUe={any:[/1/i,/2/i,/3/i,/4/i]},UUe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},RUe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},MUe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},BUe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},LUe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},$Ue={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},WUe={ordinalNumber:CUe({matchPattern:AUe,parsePattern:kUe,valueCallback:e=>parseInt(e,10)}),era:fd({matchPatterns:FUe,defaultMatchWidth:"wide",parsePatterns:OUe,defaultParseWidth:"any"}),quarter:fd({matchPatterns:PUe,defaultMatchWidth:"wide",parsePatterns:IUe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:fd({matchPatterns:UUe,defaultMatchWidth:"wide",parsePatterns:RUe,defaultParseWidth:"any"}),day:fd({matchPatterns:MUe,defaultMatchWidth:"wide",parsePatterns:BUe,defaultParseWidth:"any"}),dayPeriod:fd({matchPatterns:LUe,defaultMatchWidth:"any",parsePatterns:$Ue,defaultParseWidth:"any"})},$L={code:"en-US",formatDistance:fUe,formatLong:xUe,formatRelative:vUe,localize:SUe,match:WUe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function zUe(e,t){const r=an(e,t==null?void 0:t.in);return ZIe(r,uUe(r))+1}function qUe(e,t){const r=an(e,t==null?void 0:t.in),n=+Rx(r)-+JIe(r);return Math.round(n/BL)+1}function WL(e,t){var d,f,h,m;const r=an(e,t==null?void 0:t.in),n=r.getFullYear(),a=Vh(),i=(t==null?void 0:t.firstWeekContainsDate)??((f=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??a.firstWeekContainsDate??((m=(h=a.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??1,o=Fs((t==null?void 0:t.in)||e,0);o.setFullYear(n+1,0,i),o.setHours(0,0,0,0);const c=nh(o,t),l=Fs((t==null?void 0:t.in)||e,0);l.setFullYear(n,0,i),l.setHours(0,0,0,0);const u=nh(l,t);return+r>=+c?n+1:+r>=+u?n:n-1}function HUe(e,t){var c,l,u,d;const r=Vh(),n=(t==null?void 0:t.firstWeekContainsDate)??((l=(c=t==null?void 0:t.locale)==null?void 0:c.options)==null?void 0:l.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,a=WL(e,t),i=Fs((t==null?void 0:t.in)||e,0);return i.setFullYear(a,0,n),i.setHours(0,0,0,0),nh(i,t)}function VUe(e,t){const r=an(e,t==null?void 0:t.in),n=+nh(r,t)-+HUe(r,t);return Math.round(n/BL)+1}function Lt(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const Hs={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Lt(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Lt(r+1,2)},d(e,t){return Lt(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Lt(e.getHours()%12||12,t.length)},H(e,t){return Lt(e.getHours(),t.length)},m(e,t){return Lt(e.getMinutes(),t.length)},s(e,t){return Lt(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return Lt(a,t.length)}},tl={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},W4={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return Hs.y(e,t)},Y:function(e,t,r,n){const a=WL(e,n),i=a>0?a:1-a;if(t==="YY"){const o=i%100;return Lt(o,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):Lt(i,t.length)},R:function(e,t){const r=LL(e);return Lt(r,t.length)},u:function(e,t){const r=e.getFullYear();return Lt(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Lt(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Lt(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return Hs.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Lt(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const a=VUe(e,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):Lt(a,t.length)},I:function(e,t,r){const n=qUe(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Lt(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Hs.d(e,t)},D:function(e,t,r){const n=zUe(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Lt(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return Lt(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return Lt(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return Lt(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let a;switch(n===12?a=tl.noon:n===0?a=tl.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let a;switch(n>=17?a=tl.evening:n>=12?a=tl.afternoon:n>=4?a=tl.morning:a=tl.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Hs.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Hs.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Lt(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Lt(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Hs.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Hs.s(e,t)},S:function(e,t){return Hs.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return q4(n);case"XXXX":case"XX":return Go(n);case"XXXXX":case"XXX":default:return Go(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return q4(n);case"xxxx":case"xx":return Go(n);case"xxxxx":case"xxx":default:return Go(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+z4(n,":");case"OOOO":default:return"GMT"+Go(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+z4(n,":");case"zzzz":default:return"GMT"+Go(n,":")}},t:function(e,t,r){const n=Math.trunc(+e/1e3);return Lt(n,t.length)},T:function(e,t,r){return Lt(+e,t.length)}};function z4(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),i=n%60;return i===0?r+String(a):r+String(a)+t+Lt(i,2)}function q4(e,t){return e%60===0?(e>0?"-":"+")+Lt(Math.abs(e)/60,2):Go(e,t)}function Go(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Lt(Math.trunc(n/60),2),i=Lt(n%60,2);return r+a+t+i}const H4=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},zL=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},GUe=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return H4(e,t);let i;switch(n){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",H4(n,t)).replace("{{time}}",zL(a,t))},XUe={p:zL,P:GUe},KUe=/^D+$/,YUe=/^Y+$/,ZUe=["D","DD","YY","YYYY"];function JUe(e){return KUe.test(e)}function QUe(e){return YUe.test(e)}function eRe(e,t,r){const n=tRe(e,t,r);if(console.warn(n),ZUe.includes(e))throw new RangeError(n)}function tRe(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const rRe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,nRe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,aRe=/^'([^]*?)'?$/,iRe=/''/g,sRe=/[a-zA-Z]/;function Ga(e,t,r){var d,f,h,m;const n=Vh(),a=n.locale??$L,i=n.firstWeekContainsDate??((f=(d=n.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??1,o=n.weekStartsOn??((m=(h=n.locale)==null?void 0:h.options)==null?void 0:m.weekStartsOn)??0,c=an(e,r==null?void 0:r.in);if(!tUe(c))throw new RangeError("Invalid time value");let l=t.match(nRe).map(x=>{const p=x[0];if(p==="p"||p==="P"){const g=XUe[p];return g(x,a.formatLong)}return x}).join("").match(rRe).map(x=>{if(x==="''")return{isToken:!1,value:"'"};const p=x[0];if(p==="'")return{isToken:!1,value:oRe(x)};if(W4[p])return{isToken:!0,value:x};if(p.match(sRe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:x}});a.localize.preprocessor&&(l=a.localize.preprocessor(c,l));const u={firstWeekContainsDate:i,weekStartsOn:o,locale:a};return l.map(x=>{if(!x.isToken)return x.value;const p=x.value;(QUe(p)||JUe(p))&&eRe(p,t,String(e));const g=W4[p[0]];return g(c,p,a.localize,u)}).join("")}function oRe(e){const t=e.match(aRe);return t?t[1].replace(iRe,"'"):e}function cRe(e,t,r){const n=Vh(),a=(r==null?void 0:r.locale)??n.locale??$L,i=2520,o=Vm(e,t);if(isNaN(o))throw new RangeError("Invalid time value");const c=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:o}),[l,u]=dv(r==null?void 0:r.in,...o>0?[t,e]:[e,t]),d=lUe(u,l),f=(Mx(u)-Mx(l))/1e3,h=Math.round((d-f)/60);let m;if(h<2)return r!=null&&r.includeSeconds?d<5?a.formatDistance("lessThanXSeconds",5,c):d<10?a.formatDistance("lessThanXSeconds",10,c):d<20?a.formatDistance("lessThanXSeconds",20,c):d<40?a.formatDistance("halfAMinute",0,c):d<60?a.formatDistance("lessThanXMinutes",1,c):a.formatDistance("xMinutes",1,c):h===0?a.formatDistance("lessThanXMinutes",1,c):a.formatDistance("xMinutes",h,c);if(h<45)return a.formatDistance("xMinutes",h,c);if(h<90)return a.formatDistance("aboutXHours",1,c);if(h<B4){const x=Math.round(h/60);return a.formatDistance("aboutXHours",x,c)}else{if(h<i)return a.formatDistance("xDays",1,c);if(h<Im){const x=Math.round(h/B4);return a.formatDistance("xDays",x,c)}else if(h<Im*2)return m=Math.round(h/Im),a.formatDistance("aboutXMonths",m,c)}if(m=cUe(u,l),m<12){const x=Math.round(h/Im);return a.formatDistance("xMonths",x,c)}else{const x=m%12,p=Math.trunc(m/12);return x<3?a.formatDistance("aboutXYears",p,c):x<9?a.formatDistance("overXYears",p,c):a.formatDistance("almostXYears",p+1,c)}}function eD(e,t){return cRe(e,QIe(e),t)}const lRe=({contacts:e,selectedContact:t,selectedContacts:r,onContactSelect:n,onContactMultiSelect:a,onDeleteContact:i})=>{const o=c=>{if(!c)return"Never contacted";try{const l=new Date(c);return eD(l,{addSuffix:!0})}catch{return"Invalid date"}};return(e==null?void 0:e.length)===0?s.jsx("div",{className:"p-6 text-center",children:s.jsx("p",{className:"text-text-secondary",children:"No contacts found"})}):s.jsx("div",{className:"overflow-y-auto max-h-[calc(100vh-220px)]",children:e==null?void 0:e.map(c=>{var l,u,d;return s.jsx("div",{className:`border-b border-border last:border-b-0 p-4 cursor-pointer transition-colors duration-150 ease-out ${t&&(t==null?void 0:t.id)===(c==null?void 0:c.id)?"bg-primary-50":"hover:bg-surface-hover"}`,onClick:()=>{console.log("Contact clicked:",c),n==null||n(c)},children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0 mr-3",children:s.jsx("input",{type:"checkbox",checked:(r==null?void 0:r.includes(c==null?void 0:c.id))||!1,onChange:f=>{var h;console.log("Checkbox clicked for contact:",c==null?void 0:c.id,"checked:",(h=f==null?void 0:f.target)==null?void 0:h.checked),f==null||f.stopPropagation(),a==null||a(c==null?void 0:c.id)},onClick:f=>{f==null||f.stopPropagation()},className:"h-4 w-4 text-primary border-border rounded focus:ring-primary cursor-pointer"})}),s.jsx("div",{className:"flex-shrink-0 mr-3",children:s.jsxs("div",{className:"relative",children:[s.jsx(Ts,{src:(c==null?void 0:c.avatar_url)||"/assets/images/no_image.png",alt:`${(c==null?void 0:c.first_name)||""} ${(c==null?void 0:c.last_name)||""}`,className:"w-10 h-10 rounded-full object-cover"}),s.jsx("span",{className:`absolute bottom-0 right-0 w-3 h-3 rounded-full border-2 border-surface ${(c==null?void 0:c.status)==="active"?"bg-success":"bg-text-tertiary"}`})]})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsx("h3",{className:"text-sm font-medium text-text-primary truncate",children:(c==null?void 0:c.full_name)||((l=`${(c==null?void 0:c.first_name)||""} ${(c==null?void 0:c.last_name)||""}`)==null?void 0:l.trim())||"Unnamed Contact"}),s.jsxs("div",{className:"flex items-center ml-2",children:[((u=c==null?void 0:c.deals)==null?void 0:u.some(f=>(f==null?void 0:f.stage)==="negotiation"||(f==null?void 0:f.stage)==="proposal"))&&s.jsx("span",{className:"w-2 h-2 bg-warning rounded-full mr-1",title:"Has active deals"}),s.jsx("button",{onClick:f=>{f==null||f.stopPropagation(),window.confirm("Are you sure you want to delete this contact?")&&(i==null||i(c==null?void 0:c.id))},className:"text-text-tertiary hover:text-error transition-colors duration-150 ease-out",title:"Delete contact",children:s.jsx(G,{name:"Trash2",size:14})})]})]}),s.jsx("p",{className:"text-xs text-text-secondary truncate",children:((d=c==null?void 0:c.company)==null?void 0:d.name)||"No Company"}),s.jsxs("div",{className:"flex items-center mt-1",children:[s.jsx(G,{name:"Clock",size:12,className:"text-text-tertiary mr-1"}),s.jsx("span",{className:"text-xs text-text-tertiary",children:o(c==null?void 0:c.last_contact_date)})]})]})]})},c==null?void 0:c.id)})})},uRe=({contacts:e,onContactSelect:t,onDeleteContact:r})=>{const n=a=>{if(!a)return"Never contacted";try{const i=new Date(a);return eD(i,{addSuffix:!0})}catch{return"Invalid date"}};return(e==null?void 0:e.length)===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"w-16 h-16 bg-primary-50 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(G,{name:"Users",size:24,className:"text-primary"})}),s.jsx("h3",{className:"text-xl font-semibold text-text-primary mb-2",children:"No Contacts Found"}),s.jsx("p",{className:"text-text-secondary",children:"Try adjusting your search or filters, or add a new contact."})]}):s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:e==null?void 0:e.map(a=>{var i,o,c;return s.jsxs("div",{className:"bg-surface rounded-lg border border-border shadow-sm hover:shadow-md transition-all duration-200 cursor-pointer group overflow-hidden",onClick:()=>t==null?void 0:t(a),children:[s.jsxs("div",{className:"relative p-6 pb-4 bg-gradient-to-br from-primary-50 to-primary-100 dark:from-primary-900/20 dark:to-primary-800/20",children:[s.jsx("button",{onClick:l=>{l==null||l.stopPropagation(),window.confirm("Are you sure you want to delete this contact?")&&(r==null||r(a==null?void 0:a.id))},className:"absolute top-3 right-3 p-1.5 rounded-lg bg-surface/80 backdrop-blur-sm text-text-tertiary hover:text-error hover:bg-error-50 transition-all duration-150 opacity-0 group-hover:opacity-100",title:"Delete contact",children:s.jsx(G,{name:"Trash2",size:16})}),s.jsx("div",{className:"flex justify-center mb-3",children:s.jsxs("div",{className:"relative",children:[s.jsx(Ts,{src:(a==null?void 0:a.avatar_url)||"/assets/images/no_image.png",alt:`${(a==null?void 0:a.first_name)||""} ${(a==null?void 0:a.last_name)||""}`,className:"w-20 h-20 rounded-full object-cover border-4 border-surface shadow-md"}),s.jsx("span",{className:`absolute bottom-0 right-0 w-4 h-4 rounded-full border-2 border-surface ${(a==null?void 0:a.status)==="active"?"bg-success":"bg-text-tertiary"}`})]})}),s.jsx("h3",{className:"text-center text-lg font-semibold text-text-primary truncate",children:(a==null?void 0:a.full_name)||((i=`${(a==null?void 0:a.first_name)||""} ${(a==null?void 0:a.last_name)||""}`)==null?void 0:i.trim())||"Unnamed Contact"})]}),s.jsxs("div",{className:"p-4 space-y-3",children:[((o=a==null?void 0:a.company)==null?void 0:o.name)&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"Briefcase",size:14,className:"text-text-tertiary flex-shrink-0"}),a!=null&&a.company_id?s.jsx(hr,{to:`/company-management/${a.company_id}`,className:"text-sm text-primary hover:underline truncate",onClick:l=>l.stopPropagation(),children:a.company.name}):s.jsx("span",{className:"text-sm text-text-secondary truncate",children:a.company.name})]}),(a==null?void 0:a.email)&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"Mail",size:14,className:"text-text-tertiary flex-shrink-0"}),s.jsx("span",{className:"text-sm text-text-secondary truncate",children:a==null?void 0:a.email})]}),(a==null?void 0:a.phone)&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"Phone",size:14,className:"text-text-tertiary flex-shrink-0"}),s.jsx("span",{className:"text-sm text-text-secondary truncate",children:a==null?void 0:a.phone})]}),s.jsxs("div",{className:"flex items-center space-x-2 pt-2 border-t border-border",children:[s.jsx(G,{name:"Clock",size:14,className:"text-text-tertiary flex-shrink-0"}),s.jsx("span",{className:"text-xs text-text-tertiary truncate",children:n(a==null?void 0:a.last_contact_date)})]}),((c=a==null?void 0:a.deals)==null?void 0:c.some(l=>(l==null?void 0:l.stage)==="negotiation"||(l==null?void 0:l.stage)==="proposal"))&&s.jsxs("div",{className:"flex items-center space-x-2 pt-1",children:[s.jsx("div",{className:"w-2 h-2 bg-warning rounded-full"}),s.jsx("span",{className:"text-xs text-warning font-medium",children:"Has active deals"})]})]})]},a==null?void 0:a.id)})})},qL=({isOpen:e,onClose:t,onActivityAdded:r,onActivityUpdated:n,prefilledData:a={},templateData:i=null,editingActivity:o=null})=>{const{user:c}=Pt(),[l,u]=R.useState(!1),[d,f]=R.useState([]),[h,m]=R.useState([]),[x,p]=R.useState([]),[g,v]=R.useState({}),[y,b]=R.useState(!1),[_,w]=R.useState({}),[j,N]=R.useState({});R.useEffect(()=>{kr.loadConfiguration()},[]);const D=B=>kr.formatCurrency(B),S=R.useCallback(()=>({type:"note",subject:"",description:"",contact_id:"",deal_id:"",duration_minutes:"",scheduled_at:"",user_id:(c==null?void 0:c.id)||""}),[c]),T=R.useCallback((B,O,F)=>{var k;if(!B)return B;let I=B;I=I.replace(/{user_name}/g,c!=null&&c.first_name&&(c!=null&&c.last_name)?`${c.first_name} ${c.last_name}`:(c==null?void 0:c.email)||"User"),O?(I=I.replace(/{contact_name}/g,`${O.first_name} ${O.last_name}`),I=I.replace(/{company_name}/g,((k=O.company)==null?void 0:k.name)||"Company")):(I=I.replace(/{contact_name}/g,"[Contact Name]"),I=I.replace(/{company_name}/g,"[Company Name]")),F&&(I=I.replace(/{deal_title}/g,F.title||"[Deal Title]"),I=I.replace(/{deal_value}/g,F.value?D(F.value):"[Deal Value]"));const L=new Date,C=new Date(L.getTime()+7*24*60*60*1e3);return I=I.replace(/{today}/g,L.toLocaleDateString()),I=I.replace(/{follow_up_date}/g,C.toLocaleDateString()),I=I.replace(/{topic}/g,"[Discussion Topic]"),I=I.replace(/{next_action}/g,"[Next Action]"),I},[c]),A=async()=>{b(!0);try{const O=(await vi.getAllFields({entity_type:"activity",is_active:!0})||[]).filter(F=>F.placement==="form"||F.placement==="both");p(O)}catch(B){console.error("Error loading custom fields:",B),p([])}finally{b(!1)}},E=(B,O)=>{v(F=>({...F,[B]:O}))};R.useEffect(()=>{if(e)if((async()=>{try{const[O,F]=await Promise.all([Nt.getUserContacts(),ut.getUserDeals()]);f(O||[]),m(F||[]),await A()}catch(O){console.error("Error loading modal data:",O),N({submit:"Failed to load contacts and deals."})}})(),o){const O={type:o.type||"note",subject:o.title||o.subject||"",description:o.description||"",contact_id:o.contact_id||"",deal_id:o.deal_id||"",duration_minutes:o.duration?parseInt(o.duration):"",scheduled_at:o.scheduled_at||"",user_id:o.user_id||(c==null?void 0:c.id)||""};if(w(O),o.custom_fields){const F={};Object.entries(o.custom_fields).forEach(([I,L])=>{(L==null?void 0:L.value)!==null&&(L==null?void 0:L.value)!==void 0&&(F[I]=L.value)}),v(F)}else v({})}else{const O={...S(),...a};if(i){const F=d.find(L=>L.id===O.contact_id),I=h.find(L=>L.id===O.deal_id);O.type=i.type,O.subject=T(i.template.subject,F,I),O.description=T(i.template.description,F,I),O.duration_minutes=i.template.duration_minutes,O.priority=i.template.priority}w(O),v({})}else w({}),v({}),N({})},[e,o]);const M=(B,O)=>{const F={..._,[B]:O};if(i&&(B==="contact_id"||B==="deal_id")){const I=d.find(C=>C.id===(B==="contact_id"?O:_.contact_id)),L=h.find(C=>C.id===(B==="deal_id"?O:_.deal_id));F.subject=T(i.template.subject,I,L),F.description=T(i.template.description,I,L)}w(F)},P=async B=>{B.preventDefault(),u(!0),N({});try{const O=["type","subject"],F={};if(O.forEach(L=>{var C;(C=_[L])!=null&&C.trim()||(F[L]=`${L.replace("_"," ")} is required`)}),["call","meeting"].includes(_.type)&&_.duration_minutes&&(isNaN(_.duration_minutes)||parseInt(_.duration_minutes)<=0)&&(F.duration_minutes="Please enter a valid duration"),Object.keys(F).length>0){N(F),u(!1);return}const I={..._,duration_minutes:_.duration_minutes?parseInt(_.duration_minutes):null,scheduled_at:_.scheduled_at||null,user_id:c==null?void 0:c.id,contact_id:_.contact_id&&_.contact_id!==""?_.contact_id:null,deal_id:_.deal_id&&_.deal_id!==""?_.deal_id:null,custom_fields:Object.keys(g).length>0?g:void 0};if(console.log("Form data before submit:",_),console.log("Submit data to API:",I),o){const L=await Qa.updateActivity(o.id,I);console.log("Activity updated:",L),n&&n(L)}else{const L=await Qa.createActivity(I);console.log("New activity created:",L),r(L)}t()}catch(O){console.error(`Error ${o?"updating":"creating"} activity:`,O),N({submit:O.message||`Failed to ${o?"update":"create"} activity. Please try again.`})}finally{u(!1)}},X=(B,O)=>{j[B]&&N(F=>{const I={...F};return delete I[B],I}),M(B,O)},q=[{value:"note",label:"Note",icon:"FileText"},{value:"call",label:"Call",icon:"Phone"},{value:"email",label:"Email",icon:"Mail"},{value:"meeting",label:"Meeting",icon:"Calendar"},{value:"task",label:"Task",icon:"CheckSquare"}];return e?s.jsxs("div",{className:"fixed inset-0 z-[9999] overflow-hidden","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:[s.jsx("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-75 transition-opacity",onClick:t,"aria-hidden":"true"}),s.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:s.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:s.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl w-full max-w-3xl my-8 transform transition-all",children:[s.jsx("div",{className:"bg-primary px-6 py-5 rounded-t-xl text-white font-semibold text-lg",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 bg-white bg-opacity-20 rounded-lg flex items-center justify-center",children:s.jsx(G,{name:"Activity",size:20,className:"text-white"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-white",id:"modal-title",children:o?"Edit Activity":"Add New Activity"}),i&&!o&&s.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[s.jsx(G,{name:"FileTemplate",size:14,className:"text-white text-opacity-80"}),s.jsxs("span",{className:"text-sm text-white text-opacity-80",children:["Using template: ",i.name]})]})]})]}),s.jsx("button",{onClick:t,className:"text-white hover:bg-white hover:bg-opacity-20 rounded-lg p-2 transition-colors duration-150","aria-label":"Close",children:s.jsx(G,{name:"X",size:20})})]})}),s.jsxs("div",{className:"bg-white px-6 py-6 max-h-[calc(100vh-200px)] overflow-y-auto",children:[j.submit&&s.jsxs("div",{className:"mb-6 bg-error-50 border-l-4 border-error text-error p-4 rounded-r-lg flex items-start space-x-3",children:[s.jsx(G,{name:"AlertCircle",size:20,className:"flex-shrink-0 mt-0.5"}),s.jsx("span",{children:j.submit})]}),s.jsxs("form",{onSubmit:P,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:["Activity Type ",s.jsx("span",{className:"text-error",children:"*"})]}),s.jsx("div",{className:"grid grid-cols-5 gap-3",children:q.map(B=>s.jsx("button",{type:"button",onClick:()=>X("type",B.value),className:`group relative p-4 border-2 rounded-xl transition-all duration-200 ${_.type===B.value?"border-primary bg-primary-50 shadow-md scale-105":"border-gray-200 hover:border-primary-300 hover:bg-gray-50"}`,children:s.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[s.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center transition-colors ${_.type===B.value?"bg-primary text-white":"bg-gray-100 text-gray-600 group-hover:bg-primary-100 group-hover:text-primary"}`,children:s.jsx(G,{name:B.icon,size:20})}),s.jsx("span",{className:`text-sm font-medium ${_.type===B.value?"text-primary":"text-gray-700"}`,children:B.label})]})},B.value))})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Subject ",s.jsx("span",{className:"text-error",children:"*"})]}),s.jsx("input",{type:"text",value:_.subject||"",onChange:B=>X("subject",B.target.value),className:`w-full px-4 py-2.5 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all ${j.subject?"border-error":"border-gray-200"}`,placeholder:"Enter activity subject...",required:!0}),j.subject&&s.jsxs("p",{className:"text-sm text-error mt-1 flex items-center space-x-1",children:[s.jsx(G,{name:"AlertCircle",size:14}),s.jsx("span",{children:j.subject})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Description"}),s.jsx("textarea",{value:_.description||"",onChange:B=>X("description",B.target.value),rows:4,className:"w-full px-4 py-2.5 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all resize-none",placeholder:"Add details about this activity..."})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Related Contact"}),s.jsxs("div",{className:"relative",children:[s.jsx(G,{name:"User",size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),s.jsxs("select",{value:_.contact_id||"",onChange:B=>X("contact_id",B.target.value),className:"w-full pl-10 pr-4 py-2.5 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all appearance-none bg-white",children:[s.jsx("option",{value:"",children:"Select Contact"}),d.map(B=>s.jsxs("option",{value:B.id,children:[B.first_name," ",B.last_name]},B.id))]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Related Deal"}),s.jsxs("div",{className:"relative",children:[s.jsx(G,{name:"TrendingUp",size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),s.jsxs("select",{value:_.deal_id||"",onChange:B=>X("deal_id",B.target.value),className:"w-full pl-10 pr-4 py-2.5 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all appearance-none bg-white",children:[s.jsx("option",{value:"",children:"Select Deal"}),h.map(B=>s.jsx("option",{value:B.id,children:B.name},B.id))]})]})]})]}),["call","meeting"].includes(_.type)&&s.jsx("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-xl p-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[s.jsx(G,{name:"Clock",size:14,className:"inline mr-1"}),"Duration (minutes)"]}),s.jsx("input",{type:"number",min:"1",value:_.duration_minutes||"",onChange:B=>X("duration_minutes",B.target.value),className:`w-full px-4 py-2.5 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all ${j.duration_minutes?"border-error":"border-gray-200"}`,placeholder:"30"}),j.duration_minutes&&s.jsx("p",{className:"text-sm text-error mt-1",children:j.duration_minutes})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[s.jsx(G,{name:"Calendar",size:14,className:"inline mr-1"}),"Date & Time"]}),s.jsx("input",{type:"datetime-local",value:_.scheduled_at||"",onChange:B=>X("scheduled_at",B.target.value),className:"w-full px-4 py-2.5 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all"})]})]})}),x.length>0&&s.jsxs("div",{className:"border-t-2 border-gray-100 pt-6",children:[s.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-4 flex items-center space-x-2",children:[s.jsx(G,{name:"Settings",size:16}),s.jsx("span",{children:"Custom Fields"})]}),s.jsx(ug,{fields:x,values:g,onChange:E,loading:y})]})]})]}),s.jsx("div",{className:"bg-gray-50 px-6 py-4 rounded-b-xl border-t-2 border-gray-100",children:s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx("button",{type:"button",onClick:t,className:"px-6 py-2.5 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 font-medium transition-colors duration-150",disabled:l,children:"Cancel"}),s.jsx("button",{type:"submit",onClick:P,className:"px-6 py-2.5 bg-primary text-white rounded-lg hover:bg-primary-600 font-medium shadow-md hover:shadow-lg transition-all duration-150 flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:l,children:l?s.jsxs(s.Fragment,{children:[s.jsx(G,{name:"Loader2",size:16,className:"animate-spin"}),s.jsx("span",{children:o?"Updating...":"Creating..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(G,{name:o?"Check":"Plus",size:16}),s.jsx("span",{children:o?"Update Activity":"Create Activity"})]})})]})})]})})})]}):null},dRe=({activities:e,contact:t,onActivityAdded:r,onActivityUpdated:n,loading:a=!1})=>{const[i,o]=R.useState("all"),[c,l]=R.useState(!1),[u,d]=R.useState(null),f=w=>{switch(w){case"email":return"Mail";case"call":return"Phone";case"meeting":return"Calendar";case"note":return"FileText";case"task":return"CheckSquare";default:return"Activity"}},h=w=>{switch(w){case"email":return"bg-primary-50 text-primary";case"call":return"bg-success-50 text-success";case"meeting":return"bg-secondary-50 text-secondary";case"note":return"bg-warning-50 text-warning";case"task":return"bg-accent-50 text-accent";default:return"bg-gray-100 text-gray-600"}},m=w=>Ga(new Date(w),"MMM d, yyyy h:mm a"),x=async w=>{try{return r&&r(w),w}catch(j){throw console.error("Error handling activity:",j),j}},p=async w=>{try{return n&&n(w),w}catch(j){throw console.error("Error handling activity update:",j),j}},g=async w=>{try{const j=await Qa.getActivityById(w.id);d(j),l(!0)}catch(j){console.error("Error fetching activity for editing:",j),d(w),l(!0)}},v=()=>{d(null),l(!0)},y=()=>{l(!1),d(null)},_=[...i==="all"?e:e==null?void 0:e.filter(w=>(w==null?void 0:w.type)===i)].sort((w,j)=>new Date(j.scheduled_at||j.created_at)-new Date(w.scheduled_at||w.created_at));return s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Activity Timeline"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("select",{value:i,onChange:w=>{var j;return o((j=w==null?void 0:w.target)==null?void 0:j.value)},className:"text-sm border border-border rounded-md py-1 px-2 text-text-primary bg-surface focus:outline-none focus:ring-1 focus:ring-primary focus:border-primary",children:[s.jsx("option",{value:"all",children:"All Activities"}),s.jsx("option",{value:"email",children:"Emails"}),s.jsx("option",{value:"call",children:"Calls"}),s.jsx("option",{value:"meeting",children:"Meetings"}),s.jsx("option",{value:"note",children:"Notes"}),s.jsx("option",{value:"task",children:"Tasks"})]}),s.jsxs("button",{className:"inline-flex items-center space-x-2 px-3 py-1 border border-border rounded-md text-text-secondary hover:text-primary hover:border-primary transition-all duration-150 ease-out text-sm",onClick:v,children:[s.jsx(G,{name:"Plus",size:14}),s.jsx("span",{children:"Log Activity"})]})]})]}),a?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),s.jsx("p",{className:"text-text-secondary",children:"Loading activities..."})]}):(_==null?void 0:_.length)>0?s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute left-6 top-0 bottom-0 w-px bg-border"}),s.jsx("div",{className:"space-y-6",children:_==null?void 0:_.map(w=>s.jsxs("div",{className:"relative pl-14",children:[s.jsx("div",{className:`absolute left-0 w-12 h-12 rounded-full flex items-center justify-center ${h(w==null?void 0:w.type)}`,children:s.jsx(G,{name:f(w==null?void 0:w.type),size:20})}),s.jsxs("div",{className:"card p-4",children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("h4",{className:"font-medium text-text-primary",children:[(w==null?void 0:w.type)==="email"&&"Email: ",(w==null?void 0:w.type)==="call"&&"Call: ",(w==null?void 0:w.type)==="meeting"&&"Meeting: ",(w==null?void 0:w.subject)||(w==null?void 0:w.summary)]}),s.jsxs("div",{className:"flex items-center space-x-2 text-sm text-text-tertiary mt-1",children:[s.jsx("span",{children:m((w==null?void 0:w.scheduled_at)||(w==null?void 0:w.created_at))}),(w==null?void 0:w.duration_minutes)&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsxs("span",{children:[w==null?void 0:w.duration_minutes," minutes"]})]}),(w==null?void 0:w.user)&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsxs("span",{className:"flex items-center space-x-1",children:[s.jsx(G,{name:"User",size:12}),s.jsx("span",{children:typeof w.user=="string"?w.user:`${w.user.first_name} ${w.user.last_name}`})]})]})]})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>g(w),className:"text-text-tertiary hover:text-text-primary",title:"Edit activity",children:s.jsx(G,{name:"Edit",size:14})}),s.jsx("button",{className:"text-text-tertiary hover:text-error",title:"Delete activity",children:s.jsx(G,{name:"Trash2",size:14})})]})]}),(w==null?void 0:w.description)&&s.jsx("div",{className:"text-text-primary text-sm mt-2",children:w==null?void 0:w.description}),(w==null?void 0:w.summary)&&!(w!=null&&w.subject)&&s.jsx("div",{className:"text-text-primary text-sm mt-2",children:w==null?void 0:w.summary})]})]},w==null?void 0:w.id))})]}):s.jsxs("div",{className:"text-center py-12 border border-dashed border-border rounded-lg",children:[s.jsx(G,{name:"Calendar",size:32,className:"text-text-tertiary mx-auto mb-3"}),s.jsx("h4",{className:"text-lg font-medium text-text-primary mb-1",children:"No activities found"}),s.jsx("p",{className:"text-text-secondary mb-4",children:i==="all"?"There are no activities recorded for this contact yet.":`There are no ${i} activities recorded for this contact.`}),s.jsxs("button",{className:"btn-primary inline-flex items-center space-x-2",onClick:v,children:[s.jsx(G,{name:"Plus",size:16}),s.jsx("span",{children:"Log an Activity"})]})]}),c&&s.jsx(qL,{isOpen:c,onClose:y,onActivityAdded:x,onActivityUpdated:p,editingActivity:u,prefilledData:t?{contact_id:t.id}:{}})]})},fRe=({deals:e,contactName:t,loading:r=!1})=>{const n=o=>{var c;return(c=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}))==null?void 0:c.format(o)},a=o=>{var c;switch(o){case"discovery":return"Discovery";case"proposal":return"Proposal";case"negotiation":return"Negotiation";case"closed-won":return"Closed Won";case"closed-lost":return"Closed Lost";default:return((c=o==null?void 0:o.charAt(0))==null?void 0:c.toUpperCase())+(o==null?void 0:o.slice(1))}},i=o=>{switch(o){case"discovery":return"bg-primary-50 text-primary";case"proposal":return"bg-secondary-50 text-secondary";case"negotiation":return"bg-warning-50 text-warning";case"closed-won":return"bg-success-50 text-success";case"closed-lost":return"bg-error-50 text-error";default:return"bg-gray-100 text-gray-600"}};return s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Deals"}),s.jsxs(hr,{to:"/deal-management",className:"inline-flex items-center space-x-2 px-3 py-1 border border-border rounded-md text-text-secondary hover:text-primary hover:border-primary transition-all duration-150 ease-out text-sm",children:[s.jsx(G,{name:"Plus",size:14}),s.jsx("span",{children:"Add Deal"})]})]}),r?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),s.jsx("p",{className:"text-text-secondary",children:"Loading deals..."})]}):(e==null?void 0:e.length)>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-border",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 bg-surface-hover text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Deal Name"}),s.jsx("th",{className:"px-4 py-3 bg-surface-hover text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Stage"}),s.jsx("th",{className:"px-4 py-3 bg-surface-hover text-right text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Value"}),s.jsx("th",{className:"px-4 py-3 bg-surface-hover text-right text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-surface divide-y divide-border",children:e==null?void 0:e.map(o=>s.jsxs("tr",{className:"hover:bg-surface-hover",children:[s.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:s.jsx("div",{className:"text-sm font-medium text-text-primary",children:o==null?void 0:o.name})}),s.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${i(o==null?void 0:o.stage)}`,children:a(o==null?void 0:o.stage)})}),s.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-right text-sm text-text-primary font-medium",children:n(o==null?void 0:o.value)}),s.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-right text-sm",children:s.jsx(hr,{to:`/deal-management?deal=${o==null?void 0:o.id}`,className:"text-primary hover:text-primary-700",children:"View Details"})})]},o==null?void 0:o.id))})]})}):s.jsxs("div",{className:"text-center py-12 border border-dashed border-border rounded-lg",children:[s.jsx(G,{name:"Target",size:32,className:"text-text-tertiary mx-auto mb-3"}),s.jsx("h4",{className:"text-lg font-medium text-text-primary mb-1",children:"No deals found"}),s.jsxs("p",{className:"text-text-secondary mb-4",children:[t," doesn't have any deals associated yet."]}),s.jsxs(hr,{to:"/deal-management",className:"btn-primary inline-flex items-center space-x-2",children:[s.jsx(G,{name:"Plus",size:16}),s.jsx("span",{children:"Create a Deal"})]})]})]})},Um={async getContactNotes(e){try{const{data:t,error:r}=await be.get(`/api/v1/notes/contact/${e}`);if(r)throw r;return t||[]}catch(t){throw console.error("Error fetching contact notes:",t),t}},async createNote(e){try{const{data:t,error:r}=await be.post("/api/v1/notes",e);if(r)throw r;return t}catch(t){throw console.error("Error creating note:",t),t}},async updateNote(e,t){try{const{data:r,error:n}=await be.put(`/api/v1/notes/${e}`,t);if(n)throw n;return r}catch(r){throw console.error("Error updating note:",r),r}},async deleteNote(e){try{const{data:t,error:r}=await be.delete(`/api/v1/notes/${e}`);if(r)throw r;return t}catch(t){throw console.error("Error deleting note:",t),t}}},hRe=({contact:e,onNotesCountChange:t})=>{const{user:r}=Pt(),[n,a]=R.useState([]),[i,o]=R.useState(!0),[c,l]=R.useState(""),[u,d]=R.useState(!1),[f,h]=R.useState(null),[m,x]=R.useState({title:"",content:""});R.useEffect(()=>{t&&t(n.length)},[n.length,t]),R.useEffect(()=>{(async()=>{if(e!=null&&e.id)try{o(!0),l("");const w=await Um.getContactNotes(e.id);a(w)}catch(w){console.error("Error loading notes:",w),l("Failed to load notes. Please try again.")}finally{o(!1)}})()},[e==null?void 0:e.id]);const p=async()=>{if(!m.content.trim()){l("Note content is required");return}try{l("");const _={title:m.title.trim()||null,content:m.content.trim(),contact_id:e.id},w=await Um.createNote(_);a([w,...n]),x({title:"",content:""}),d(!1)}catch(_){console.error("Error creating note:",_),l("Failed to create note. Please try again.")}},g=async()=>{if(!f.content.trim()){l("Note content is required");return}try{l("");const _={title:f.title.trim()||null,content:f.content.trim()},w=await Um.updateNote(f.id,_);a(n.map(j=>j.id===f.id?w:j)),h(null)}catch(_){console.error("Error updating note:",_),l("Failed to update note. Please try again.")}},v=async _=>{if(window.confirm("Are you sure you want to delete this note?"))try{l(""),await Um.deleteNote(_),a(n.filter(w=>w.id!==_))}catch(w){console.error("Error deleting note:",w),l("Failed to delete note. Please try again.")}},y=_=>{try{return Ga(new Date(_),"MMM d, yyyy  h:mm a")}catch{return"Invalid date"}},b=_=>(r==null?void 0:r.id)===_.created_by;return i?s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),s.jsx("span",{className:"ml-3 text-text-secondary",children:"Loading notes..."})]}):s.jsxs("div",{className:"space-y-6",children:[c&&s.jsxs("div",{className:"bg-error-50 border border-error-200 text-error p-4 rounded-lg flex items-center space-x-2",children:[s.jsx(G,{name:"AlertCircle",size:20}),s.jsx("span",{children:c}),s.jsx("button",{onClick:()=>l(""),className:"ml-auto text-error hover:text-error-600",children:s.jsx(G,{name:"X",size:16})})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("h3",{className:"text-lg font-semibold text-text-primary",children:["Notes (",n.length,")"]}),s.jsxs("button",{onClick:()=>d(!0),className:"btn-primary inline-flex items-center space-x-2",children:[s.jsx(G,{name:"Plus",size:16}),s.jsx("span",{children:"Add Note"})]})]}),u&&s.jsx("div",{className:"card p-4 border-2 border-primary-200",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("input",{type:"text",placeholder:"Note title (optional)",value:m.title,onChange:_=>x({...m,title:_.target.value}),className:"input-field"}),s.jsx("textarea",{placeholder:"Write your note here...",value:m.content,onChange:_=>x({...m,content:_.target.value}),className:"input-field h-32 resize-none",autoFocus:!0}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx("button",{onClick:()=>{d(!1),x({title:"",content:""}),l("")},className:"px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary transition-colors",children:"Cancel"}),s.jsx("button",{onClick:p,className:"btn-primary",children:"Save Note"})]})]})}),n.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(G,{name:"FileText",size:32,className:"text-text-tertiary mx-auto mb-3"}),s.jsx("p",{className:"text-text-secondary",children:"No notes available"}),s.jsx("p",{className:"text-text-tertiary text-sm mt-1",children:"Add a note to keep track of important information about this contact"})]}):s.jsx("div",{className:"space-y-4",children:n.map(_=>s.jsx("div",{className:"card p-4",children:(f==null?void 0:f.id)===_.id?s.jsxs("div",{className:"space-y-4",children:[s.jsx("input",{type:"text",placeholder:"Note title (optional)",value:f.title||"",onChange:w=>h({...f,title:w.target.value}),className:"input-field"}),s.jsx("textarea",{placeholder:"Write your note here...",value:f.content,onChange:w=>h({...f,content:w.target.value}),className:"input-field h-32 resize-none"}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx("button",{onClick:()=>{h(null),l("")},className:"px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary transition-colors",children:"Cancel"}),s.jsx("button",{onClick:g,className:"btn-primary",children:"Save Changes"})]})]}):s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-start mb-3",children:[s.jsxs("div",{className:"flex-1",children:[_.title&&s.jsx("h4",{className:"font-medium text-text-primary mb-1",children:_.title}),s.jsxs("div",{className:"flex items-center text-sm text-text-secondary",children:[s.jsx("span",{children:_.author?`${_.author.first_name} ${_.author.last_name}`:"Unknown User"}),s.jsx("span",{className:"mx-2",children:""}),s.jsx("span",{children:y(_.created_at)}),_.updated_at!==_.created_at&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"mx-2",children:""}),s.jsx("span",{className:"text-text-tertiary",children:"edited"})]})]})]}),b(_)&&s.jsxs("div",{className:"flex space-x-2 ml-4",children:[s.jsx("button",{onClick:()=>h({..._}),className:"text-text-tertiary hover:text-primary transition-colors",title:"Edit note",children:s.jsx(G,{name:"Edit",size:16})}),s.jsx("button",{onClick:()=>v(_.id),className:"text-text-tertiary hover:text-error transition-colors",title:"Delete note",children:s.jsx(G,{name:"Trash2",size:16})})]})]}),s.jsx("p",{className:"text-text-primary whitespace-pre-wrap",children:_.content})]})},_.id))})]})},mi={getTemplates:async(e={})=>{try{const t=new URLSearchParams;e.search&&t.append("search",e.search),e.category&&t.append("category",e.category),e.status&&t.append("status",e.status),e.limit&&t.append("limit",e.limit),e.offset&&t.append("offset",e.offset);const r=`/api/v1/email-templates${t.toString()?"?"+t.toString():""}`,{data:n,error:a}=await be.get(r);if(a)throw a;return n}catch(t){throw console.error("Error fetching email templates:",t),t}},getTemplate:async e=>{try{const{data:t,error:r}=await be.get(`/api/v1/email-templates/${e}`);if(r)throw r;return t}catch(t){throw console.error("Error fetching email template:",t),t}},createTemplate:async e=>{try{const{data:t,error:r}=await be.post("/api/v1/email-templates",e);if(r)throw r;return t}catch(t){throw console.error("Error creating email template:",t),t}},updateTemplate:async(e,t)=>{try{const{data:r,error:n}=await be.put(`/api/v1/email-templates/${e}`,t);if(n)throw n;return r}catch(r){throw console.error("Error updating email template:",r),r}},deleteTemplate:async e=>{try{const{data:t,error:r}=await be.delete(`/api/v1/email-templates/${e}`);if(r)throw r;return t}catch(t){throw console.error("Error deleting email template:",t),t}},previewTemplate:async(e,t,r=null,n=null,a=null,i=null)=>{try{const{data:o,error:c}=await be.post("/api/v1/email-templates/preview",{template_id:e,merge_data:t,contact_id:r,deal_id:n,activity_id:a,task_id:i});if(c)throw c;return o}catch(o){throw console.error("Error previewing email template:",o),o}},sendEmail:async e=>{try{if(e instanceof FormData){const{data:r,error:n}=await be.post("/api/v1/email-templates/send-with-attachments",e,{headers:{"Content-Type":"multipart/form-data"}});if(n)throw n;return r}else{const{data:r,error:n}=await be.post("/api/v1/email-templates/send",e);if(n)throw n;return r}}catch(t){throw console.error("Error sending email:",t),t}},getMergeFields:async()=>{try{const{data:e,error:t}=await be.get("/api/v1/email-templates/merge-fields");if(t)throw t;return e}catch(e){throw console.error("Error fetching merge fields:",e),e}},getEmailLogs:async(e={})=>{try{const t=new URLSearchParams;e.templateId&&t.append("template_id",e.templateId),e.status&&t.append("status",e.status),e.limit&&t.append("limit",e.limit),e.offset&&t.append("offset",e.offset);const r=`/api/v1/email-templates/logs${t.toString()?"?"+t.toString():""}`,{data:n,error:a}=await be.get(r);if(a)throw a;return n}catch(t){throw console.error("Error fetching email logs:",t),t}},processMergeFields:(e,t)=>{if(!e||!t)return e;let r=e;return Object.entries(t).forEach(([n,a])=>{const i=new RegExp(`{{${n}}}`,"g");r=r.replace(i,a||"")}),r},validateTemplate:(e,t)=>{const r=/{{([^}]+)}}/g,n=`${e} ${t}`,a=[];let i;for(;(i=r.exec(n))!==null;)a.includes(i[1])||a.push(i[1]);return a},getCategories:()=>[{value:"general",label:"General"},{value:"onboarding",label:"Onboarding"},{value:"followup",label:"Follow-up"},{value:"closing",label:"Deal Closing"},{value:"nurturing",label:"Lead Nurturing"},{value:"reminder",label:"Reminders"}],getStatuses:()=>[{value:"draft",label:"Draft"},{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}]},V4="AIzaSyAqVlX6UAVc9AqppYlv4ZuS52TX0jU1SgM",mRe="https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent";class pRe{async generateEmailContent(t,r="",n=""){var a,i,o,c,l,u,d;try{const f=r.trim()||n.trim();console.log("Gemini Generation Mode:",f?"Enhancement":"Template"),console.log("API Key present:",!!V4),console.log("Contact info:",t);let h;f?h=this.createEnhancementPrompt(t,r,n):h=this.createTemplatePrompt(t),console.log("Sending request to Gemini API...");const m=await Sr.post(`${mRe}?key=${V4}`,{contents:[{parts:[{text:h}]}],generationConfig:{temperature:.7,topK:40,topP:.95,maxOutputTokens:1024}},{headers:{"Content-Type":"application/json"}});if(console.log("Gemini API Response received:",m.status),!m.data||!m.data.candidates||!m.data.candidates[0])throw console.error("Invalid response structure:",m.data),new Error("Invalid response from Gemini API");const x=m.data.candidates[0];if(!x.content||!x.content.parts||!x.content.parts[0])throw console.error("Invalid content structure:",x),new Error("Invalid content structure from Gemini API");const p=x.content.parts[0].text;console.log("Generated text:",p);const g=this.parseEmailContent(p);return console.log("Email content generated successfully:",g),g}catch(f){if(console.error("Gemini API Error:",f),console.error("Error response:",(a=f.response)==null?void 0:a.data),((i=f.response)==null?void 0:i.status)===400){const h=((c=(o=f.response.data)==null?void 0:o.error)==null?void 0:c.message)||"Invalid request";throw new Error(`Invalid request to Gemini API: ${h}`)}else throw((l=f.response)==null?void 0:l.status)===403?new Error("Gemini API key is invalid or has no quota remaining."):((u=f.response)==null?void 0:u.status)===429?new Error("Too many requests to Gemini API. Please try again later."):((d=f.response)==null?void 0:d.status)===404?new Error("Gemini API endpoint not found. The model may have been updated."):new Error(`Failed to generate email content: ${f.message}`)}}createEnhancementPrompt(t,r,n){return`You are a professional email assistant. Please enhance and improve the following email content while maintaining the original intent and message.

Contact Information:
- Name: ${(t==null?void 0:t.first_name)||""} ${(t==null?void 0:t.last_name)||""}
- Company: ${(t==null?void 0:t.company_name)||"their company"}
- Email: ${(t==null?void 0:t.email)||""}

Current Email Content:
Subject: "${r}"
Body: "${n}"

Please enhance this email by:
1. Making the subject line more compelling and professional
2. Improving the body content for clarity, professionalism, and engagement
3. Adding appropriate greetings and closing if missing
4. Ensuring proper business email etiquette
5. Maintaining the original intent and key messages

Respond in this exact JSON format:
{
  "subject": "Enhanced subject line here",
  "body": "Enhanced email body here with proper formatting and professional tone"
}`}createTemplatePrompt(t){return`You are a professional email assistant. Create a professional business email template for a CRM system.

Contact Information:
- Name: ${(t==null?void 0:t.first_name)||"the contact"} ${(t==null?void 0:t.last_name)||""}
- Company: ${(t==null?void 0:t.company_name)||"their company"}
- Email: ${(t==null?void 0:t.email)||""}

Please create a professional business email that:
1. Has a compelling and relevant subject line
2. Includes a proper greeting using the contact's name
3. Has a professional introduction or opening
4. Includes a clear purpose/call to action
5. Has an appropriate professional closing
6. Is suitable for business relationship building or follow-up

The tone should be:
- Professional but friendly
- Clear and concise
- Appropriate for business communication
- Personalized using the contact information

Respond in this exact JSON format:
{
  "subject": "Professional subject line here",
  "body": "Complete professional email body here with proper greeting, content, and closing"
}`}parseEmailContent(t){try{const r=t.match(/\{[\s\S]*\}/);if(r){const i=JSON.parse(r[0]);return{subject:i.subject||"Professional Follow-up",body:i.body||"Thank you for your time. I look forward to hearing from you soon."}}const n=t.match(/["'']?subject["'']?\s*:\s*["'']([^"'']+)["'']/i),a=t.match(/["'']?body["'']?\s*:\s*["'']([^"'']+)["'']/i);return{subject:n?n[1]:"Professional Follow-up",body:a?a[1]:"Thank you for your time. I look forward to hearing from you soon."}}catch(r){return console.error("Error parsing Gemini response:",r),{subject:"Professional Follow-up",body:"Thank you for your time. I look forward to hearing from you soon."}}}}const xRe=new pRe,gRe=({contact:e,onClose:t,onSend:r})=>{const[n,a]=R.useState({to:e==null?void 0:e.email,subject:"",body:"",cc:"",bcc:""}),[i,o]=R.useState([]),[c,l]=R.useState(""),[u,d]=R.useState(!1),[f,h]=R.useState(!1),[m,x]=R.useState(!1),[p,g]=R.useState(null),[v,y]=R.useState(!1),[b,_]=R.useState(""),[w,j]=R.useState([]),[N,D]=R.useState([]),[S,T]=R.useState(null),[A,E]=R.useState([]),[M,P]=R.useState(null),[X,q]=R.useState([]),[B,O]=R.useState(null),[F,I]=R.useState({hasContactFields:!1,hasDealFields:!1,hasActivityFields:!1,hasTaskFields:!1});R.useEffect(()=>{C(),k(),L()},[e]);const L=async()=>{try{const H=await fs.getCompanyEmail();_(H)}catch(H){console.error("Failed to load company email:",H),_("noreply@company.com")}},C=async()=>{try{const H=await mi.getTemplates();o(H.templates||[])}catch(H){console.error("Failed to load templates:",H)}},k=async()=>{if(e!=null&&e.id)try{const oe=(await ut.getUserDeals()).filter(ae=>{var xe;return ae.contact_id===e.id||((xe=ae.contact)==null?void 0:xe.id)===e.id});if(oe&&oe.length>0){const ae=oe.sort((xe,ye)=>new Date(ye.created_at)-new Date(xe.created_at));D(ae),T(ae[0])}const le=(await Qa.getUserActivities(100)).filter(ae=>{var xe;return ae.contact_id===e.id||((xe=ae.contact)==null?void 0:xe.id)===e.id});if(le&&le.length>0){const ae=le.sort((xe,ye)=>new Date(ye.created_at)-new Date(xe.created_at));E(ae),P(ae[0])}const ee=(await L_e.getUserTasks()).filter(ae=>{var xe;return ae.contact_id===e.id||((xe=ae.contact)==null?void 0:xe.id)===e.id});if(ee&&ee.length>0){const ae=ee.sort((xe,ye)=>new Date(ye.created_at)-new Date(xe.created_at));q(ae),O(ae[0])}}catch(H){console.error("Failed to load related entities:",H)}},z=H=>{if(!H)return;const oe=(H.subject||"")+" "+(H.content||""),J=/\{\{deal_name\}\}/i.test(oe)||/\{\{deal_value\}\}/i.test(oe)||/\{\{deal_stage\}\}/i.test(oe)||/\{\{custom_budget_range\}\}/i.test(oe)||/\{\{custom_deal_priority[_0-9]*\}\}/i.test(oe)||/\{\{custom_deal_or_no_deal\}\}/i.test(oe),le=/\{\{custom_detailed_desc\}\}/i.test(oe)||/\{\{custom_football\}\}/i.test(oe),he=/\{\{custom_followup_date\}\}/i.test(oe);I({hasContactFields:!0,hasDealFields:J,hasActivityFields:le,hasTaskFields:he})},V=H=>{const{name:oe,value:J}=H==null?void 0:H.target;a({...n,[oe]:J})},Z=async H=>{var oe;if(l(H),!H){I({hasContactFields:!1,hasDealFields:!1,hasActivityFields:!1,hasTaskFields:!1});return}try{const J=i.find(ee=>ee.id===H);J&&z(J);const le={first_name:(e==null?void 0:e.first_name)||"",last_name:(e==null?void 0:e.last_name)||"",full_name:`${(e==null?void 0:e.first_name)||""} ${(e==null?void 0:e.last_name)||""}`.trim(),email:(e==null?void 0:e.email)||"",phone:(e==null?void 0:e.phone)||"",company_name:((oe=e==null?void 0:e.company)==null?void 0:oe.name)||"",position:(e==null?void 0:e.position)||""},he=await mi.previewTemplate(H,le,(e==null?void 0:e.id)||null,(S==null?void 0:S.id)||null,(M==null?void 0:M.id)||null,(B==null?void 0:B.id)||null);a(ee=>({...ee,subject:he.subject,body:he.content}))}catch(J){console.error("Failed to load template:",J),alert("Failed to load template")}},ce=async H=>{const oe=N.find(J=>J.id===H);T(oe||null),c&&await Z(c)},ie=async H=>{const oe=A.find(J=>J.id===H);P(oe||null),c&&await Z(c)},Q=async H=>{const oe=X.find(J=>J.id===H);O(oe||null),c&&await Z(c)},ne=async H=>{var oe,J,le,he;H==null||H.preventDefault(),h(!0);try{console.log("Submitting email with data:",{to:n==null?void 0:n.to,subject:n==null?void 0:n.subject,body:n==null?void 0:n.body,cc:n!=null&&n.cc?n.cc.split(",").map(xe=>xe.trim()):void 0,bcc:n!=null&&n.bcc?n.bcc.split(",").map(xe=>xe.trim()):void 0,template_id:c||void 0,contactId:e==null?void 0:e.id,attachments:w.length});let ee;if(w.length>0){const xe=new FormData;xe.append("to",n.to),xe.append("subject",n.subject),xe.append("content",n.body),n.cc&&n.cc.split(",").map(Ce=>Ce.trim()).forEach(Ce=>{xe.append("cc",Ce)}),n.bcc&&n.bcc.split(",").map(Ce=>Ce.trim()).forEach(Ce=>{xe.append("bcc",Ce)}),w.forEach(ye=>{xe.append("attachments",ye.file)}),ee=xe}else ee={to:n.to,subject:n.subject,content:n.body,cc:n.cc?n.cc.split(",").map(xe=>xe.trim()):void 0,bcc:n.bcc?n.bcc.split(",").map(xe=>xe.trim()):void 0,template_id:c||void 0,merge_data:{first_name:(e==null?void 0:e.first_name)||"",last_name:(e==null?void 0:e.last_name)||"",full_name:`${(e==null?void 0:e.first_name)||""} ${(e==null?void 0:e.last_name)||""}`.trim(),email:(e==null?void 0:e.email)||"",phone:(e==null?void 0:e.phone)||"",company_name:((oe=e==null?void 0:e.company)==null?void 0:oe.name)||"",position:(e==null?void 0:e.position)||""}};const ae=await mi.sendEmail(ee);console.log("Email response:",ae),ae!=null&&ae.success&&(ae!=null&&ae.sender_email)&&console.log(`Email sent from ${ae.sender_email} to ${n.to}`),r({...n,timestamp:(J=new Date)==null?void 0:J.toISOString(),contactId:e==null?void 0:e.id,status:ae!=null&&ae.success?"sent":"failed",sender_email:ae==null?void 0:ae.sender_email,attachments:w.map(xe=>({name:xe.name,size:xe.size,type:xe.type}))}),t()}catch(ee){console.error("Email sending failed:",ee);let ae="Failed to send email. Please try again.";(he=(le=ee.response)==null?void 0:le.data)!=null&&he.detail?ae=`Failed to send email: ${ee.response.data.detail}`:ee.message&&(ae=`Failed to send email: ${ee.message}`),alert(ae)}finally{h(!1)}},pe=async()=>{var H,oe;try{x(!0),console.log(" Starting email generation..."),console.log("Contact:",e),console.log("Current subject:",n.subject),console.log("Current body:",n.body);const J=await xRe.generateEmailContent(e,n.subject,n.body);console.log(" Email generated successfully:",J),g(J),y(!0)}catch(J){console.error(" Failed to generate email content:",J),console.error("Error details:",{message:J.message,response:(H=J.response)==null?void 0:H.data,status:(oe=J.response)==null?void 0:oe.status});let le="Failed to generate email content.";J.message.includes("not configured")?le=" Gemini API key is not configured. Please restart the dev server.":J.message.includes("invalid")?le=" Gemini API key is invalid. Please check your configuration.":J.message.includes("quota")?le=" Gemini API quota exceeded. Please try again later.":le=`Failed to generate email: ${J.message}`,alert(le)}finally{x(!1)}},W=()=>{p&&(a({...n,subject:p.subject,body:p.body}),y(!1),g(null))},re=()=>{y(!1),g(null)},U=H=>{const oe=Array.from(H.target.files);if(oe.length===0)return;const J=10*1024*1024,le=oe.filter(ee=>ee.size>J?(alert(`File "${ee.name}" is too large. Maximum size is 10MB.`),!1):!0);if(le.length===0)return;const he=le.map(ee=>({file:ee,name:ee.name,size:ee.size,type:ee.type,id:Math.random().toString(36).substr(2,9)}));j(ee=>[...ee,...he]),H.target.value=""},se=H=>{j(oe=>oe.filter(J=>J.id!==H))},te=H=>{if(H===0)return"0 Bytes";const oe=1024,J=["Bytes","KB","MB","GB"],le=Math.floor(Math.log(H)/Math.log(oe));return Math.round(H/Math.pow(oe,le)*100)/100+" "+J[le]},K=H=>H.startsWith("image/")?"Image":H.includes("pdf")||H.includes("word")||H.includes("document")?"FileText":H.includes("sheet")||H.includes("excel")?"Table":H.includes("presentation")||H.includes("powerpoint")?"Presentation":H.includes("zip")||H.includes("rar")||H.includes("7z")?"Archive":"File";return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-1100 overflow-y-auto",children:s.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[s.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50"})}),s.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:""}),s.jsx("div",{className:"inline-block align-bottom bg-surface rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full md:max-w-2xl",children:s.jsxs("form",{onSubmit:ne,children:[s.jsxs("div",{className:"px-6 py-4 border-b border-border flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Compose Email"}),s.jsx("button",{type:"button",onClick:t,className:"text-text-secondary hover:text-text-primary",children:s.jsx(G,{name:"X",size:20})})]}),s.jsx("div",{className:"px-6 py-5",children:s.jsxs("div",{className:"space-y-4",children:[b&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"From"}),s.jsxs("div",{className:"flex items-center px-3 py-2 bg-surface-secondary rounded-lg border border-border",children:[s.jsx(G,{name:"Mail",size:16,className:"text-text-tertiary mr-2"}),s.jsx("span",{className:"text-sm text-text-primary",children:b}),s.jsx("span",{className:"ml-2 text-xs text-text-tertiary",children:"(Company Email)"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"To"}),s.jsx("div",{className:"flex items-center",children:s.jsx("input",{type:"email",name:"to",value:n==null?void 0:n.to,onChange:V,className:"input-field",readOnly:!0})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Email Template (Optional)"}),s.jsxs("select",{value:c,onChange:H=>Z(H.target.value),className:"input-field",children:[s.jsx("option",{value:"",children:"Select a template..."}),i.map(H=>s.jsxs("option",{value:H.id,children:[H.name," ",H.status==="draft"?"(Draft)":H.status==="inactive"?"(Inactive)":""]},H.id))]}),c&&s.jsxs("p",{className:"text-xs text-text-tertiary mt-1",children:["Template content will be merged with contact information",S&&` and deal "${S.name}"`]})]}),c&&F.hasDealFields&&N.length>0&&s.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[s.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2 flex items-center gap-2",children:[s.jsx(G,{name:"Briefcase",size:16}),"Select Deal for Merge Fields"]}),s.jsxs("select",{value:(S==null?void 0:S.id)||"",onChange:H=>ce(H.target.value),className:"input-field",children:[s.jsx("option",{value:"",children:"No deal selected"}),N.map(H=>{var oe;return s.jsxs("option",{value:H.id,children:[H.name," - $",((oe=H.value)==null?void 0:oe.toLocaleString())||"0"," (",H.stage,")"]},H.id)})]}),s.jsx("p",{className:"text-xs text-text-tertiary mt-2",children:"This template contains deal merge fields. Select which deal to use."})]}),c&&F.hasActivityFields&&A.length>0&&s.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4",children:[s.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2 flex items-center gap-2",children:[s.jsx(G,{name:"Calendar",size:16}),"Select Activity for Merge Fields"]}),s.jsxs("select",{value:(M==null?void 0:M.id)||"",onChange:H=>ie(H.target.value),className:"input-field",children:[s.jsx("option",{value:"",children:"No activity selected"}),A.map(H=>s.jsxs("option",{value:H.id,children:[H.subject," - ",H.type," (",new Date(H.created_at).toLocaleDateString(),")"]},H.id))]}),s.jsx("p",{className:"text-xs text-text-tertiary mt-2",children:"This template contains activity merge fields. Select which activity to use."})]}),c&&F.hasTaskFields&&X.length>0&&s.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-lg p-4",children:[s.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2 flex items-center gap-2",children:[s.jsx(G,{name:"CheckSquare",size:16}),"Select Task for Merge Fields"]}),s.jsxs("select",{value:(B==null?void 0:B.id)||"",onChange:H=>Q(H.target.value),className:"input-field",children:[s.jsx("option",{value:"",children:"No task selected"}),X.map(H=>s.jsxs("option",{value:H.id,children:[H.title," - ",H.status," (",H.due_date?new Date(H.due_date).toLocaleDateString():"No due date",")"]},H.id))]}),s.jsx("p",{className:"text-xs text-text-tertiary mt-2",children:"This template contains task merge fields. Select which task to use."})]}),u&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Cc"}),s.jsx("input",{type:"text",name:"cc",value:n==null?void 0:n.cc,onChange:V,placeholder:"email@example.com, another@example.com",className:"input-field"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Bcc"}),s.jsx("input",{type:"text",name:"bcc",value:n==null?void 0:n.bcc,onChange:V,placeholder:"email@example.com, another@example.com",className:"input-field"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Subject"}),s.jsx("input",{type:"text",name:"subject",value:n==null?void 0:n.subject,onChange:V,placeholder:"Enter email subject",className:"input-field",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Message"}),s.jsx("textarea",{name:"body",value:n==null?void 0:n.body,onChange:V,rows:8,placeholder:"Write your message here...",className:"input-field",required:!0})]}),w.length>0&&s.jsxs("div",{className:"border border-border rounded-lg p-4 bg-surface-hover",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("label",{className:"block text-sm font-medium text-text-primary",children:["Attachments (",w.length,")"]}),s.jsxs("span",{className:"text-xs text-text-tertiary",children:["Total: ",te(w.reduce((H,oe)=>H+oe.size,0))]})]}),s.jsx("div",{className:"space-y-2",children:w.map(H=>s.jsxs("div",{className:"flex items-center justify-between p-2 bg-surface border border-border rounded-lg hover:border-primary transition-colors",children:[s.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(G,{name:K(H.type),size:20,className:"text-primary"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-medium text-text-primary truncate",children:H.name}),s.jsx("p",{className:"text-xs text-text-tertiary",children:te(H.size)})]})]}),s.jsx("button",{type:"button",onClick:()=>se(H.id),className:"ml-2 p-1 text-error hover:bg-error-light rounded transition-colors",title:"Remove attachment",children:s.jsx(G,{name:"X",size:16})})]},H.id))})]})]})}),s.jsxs("div",{className:"px-6 py-4 border-t border-border flex justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("button",{type:"button",onClick:()=>d(!u),className:"text-text-secondary hover:text-text-primary text-sm",children:[u?"Hide":"Show"," Cc/Bcc"]}),s.jsx("button",{type:"button",onClick:pe,disabled:m,className:"inline-flex items-center px-3 py-1.5 bg-gradient-to-r from-purple-500 to-indigo-500 text-white rounded-md hover:from-purple-600 hover:to-indigo-600 transition-all duration-150 ease-out text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:m?s.jsxs(s.Fragment,{children:[s.jsx(G,{name:"Loader",size:14,className:"animate-spin mr-1.5"}),"Generating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(G,{name:"Sparkles",size:14,className:"mr-1.5"}),"Generate Email"]})}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"file",id:"file-attachment",multiple:!0,onChange:U,className:"hidden",accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.csv,.zip,.rar,.7z"}),s.jsxs("label",{htmlFor:"file-attachment",className:"inline-flex items-center px-3 py-1.5 text-text-secondary hover:text-text-primary hover:bg-surface-hover rounded-md cursor-pointer transition-all duration-150 ease-out",title:"Attach files (PDF, DOC, XLS, etc.)",children:[s.jsx(G,{name:"Paperclip",size:16}),w.length>0&&s.jsx("span",{className:"ml-1 text-xs bg-primary text-white rounded-full px-1.5 py-0.5",children:w.length})]})]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"file",id:"image-attachment",multiple:!0,onChange:U,className:"hidden",accept:"image/*"}),s.jsx("label",{htmlFor:"image-attachment",className:"inline-flex items-center px-3 py-1.5 text-text-secondary hover:text-text-primary hover:bg-surface-hover rounded-md cursor-pointer transition-all duration-150 ease-out",title:"Attach images",children:s.jsx(G,{name:"Image",size:16})})]})]}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-out",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:f||!(n!=null&&n.subject)||!(n!=null&&n.body),className:`btn-primary inline-flex items-center ${f||!(n!=null&&n.subject)||!(n!=null&&n.body)?"opacity-50 cursor-not-allowed":""}`,children:f?s.jsxs(s.Fragment,{children:[s.jsx(G,{name:"Loader",size:16,className:"animate-spin mr-2"}),"Sending..."]}):s.jsxs(s.Fragment,{children:[s.jsx(G,{name:"Send",size:16,className:"mr-2"}),"Send Email"]})})]})]})]})})]})}),v&&p&&s.jsx("div",{className:"fixed inset-0 z-1200 overflow-y-auto",children:s.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[s.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50"})}),s.jsxs("div",{className:"inline-block align-bottom bg-surface rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[s.jsx("div",{className:"bg-surface px-6 py-4 border-b border-border",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(G,{name:"Sparkles",size:20,className:"text-purple-500 mr-2"}),s.jsx("h3",{className:"text-lg font-medium text-text-primary",children:"Generated Email Content"})]}),s.jsx("button",{onClick:re,className:"text-text-secondary hover:text-text-primary",children:s.jsx(G,{name:"X",size:20})})]})}),s.jsx("div",{className:"bg-surface px-6 py-4 max-h-96 overflow-y-auto",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Generated Subject:"}),s.jsx("div",{className:"p-3 bg-surface-secondary border border-border rounded-lg",children:s.jsx("p",{className:"text-text-primary",children:p.subject})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Generated Body:"}),s.jsx("div",{className:"p-3 bg-surface-secondary border border-border rounded-lg",children:s.jsx("div",{className:"text-text-primary whitespace-pre-wrap",children:p.body})})]})]})}),s.jsx("div",{className:"bg-surface px-6 py-4 border-t border-border",children:s.jsxs("div",{className:"flex space-x-3 justify-end",children:[s.jsx("button",{onClick:re,className:"px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-out",children:"Discard"}),s.jsxs("button",{onClick:W,className:"btn-primary inline-flex items-center",children:[s.jsx(G,{name:"Check",size:16,className:"mr-2"}),"Use This Content"]})]})})]})]})})]})},vRe=({contact:e,onEdit:t,onDelete:r,onContactUpdate:n})=>{var S,T,A,E,M,P,X,q,B;const[a,i]=R.useState("overview"),[o,c]=R.useState(!1),[l,u]=R.useState([]),[d,f]=R.useState(!1),[h,m]=R.useState([]),[x,p]=R.useState(!1),[g,v]=R.useState(0),{hasAnyPermission:y}=Pt();if(!e)return null;R.useEffect(()=>{(async()=>{if(e!=null&&e.id)try{f(!0),console.log(`Fetching activities for contact: ${e.id}`);const I=(await Qa.getUserActivities()).filter(L=>L.contact_id===e.id);console.log(`Found ${I.length} activities for contact ${e.first_name} ${e.last_name}`),u(I)}catch(F){console.error("Error fetching contact activities:",F),u([])}finally{f(!1)}})()},[e==null?void 0:e.id]),R.useEffect(()=>{(async()=>{if(e!=null&&e.id)try{p(!0),console.log(`Fetching deals for contact: ${e.id}`);const I=(await ut.getUserDeals()).filter(L=>L.contact_id===e.id);console.log(`Found ${I.length} deals for contact ${e.first_name} ${e.last_name}`),m(I)}catch(F){console.error("Error fetching contact deals:",F),m([])}finally{p(!1)}})()},[e==null?void 0:e.id]);const b=O=>{if(u(F=>[O,...F]),n){const F={...e,activities:[O,...e.activities||[]]};n(F)}},_=O=>{var F;if(u(I=>I.map(L=>L.id===O.id?O:L)),n){const I={...e,activities:(F=e.activities)==null?void 0:F.map(L=>L.id===O.id?O:L)};n(I)}},w=O=>{if(!O)return"Never contacted";try{return Ga(new Date(O),"MMM d, yyyy")}catch{return"Invalid date"}},j=O=>{switch(O){case"linkedin":return"Linkedin";case"twitter":return"Twitter";case"facebook":return"Facebook";default:return"Link"}},D=(()=>{const O={};return e!=null&&e.social_linkedin&&(O.linkedin=e==null?void 0:e.social_linkedin),e!=null&&e.social_twitter&&(O.twitter=e==null?void 0:e.social_twitter),O})();return s.jsxs("div",{className:"bg-surface rounded-lg border border-border shadow-sm",children:[s.jsx("div",{className:"p-6 border-b border-border",children:s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsxs("div",{className:"relative mr-4",children:[s.jsx(Ts,{src:(e==null?void 0:e.avatar_url)||"/assets/images/no_image.png",alt:`${(e==null?void 0:e.first_name)||""} ${(e==null?void 0:e.last_name)||""}`,className:"w-16 h-16 rounded-full object-cover"}),s.jsx("span",{className:`absolute bottom-0 right-0 w-4 h-4 rounded-full border-2 border-surface ${(e==null?void 0:e.status)==="active"?"bg-success":"bg-text-tertiary"}`})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-text-primary",children:(e==null?void 0:e.full_name)||((S=`${(e==null?void 0:e.first_name)||""} ${(e==null?void 0:e.last_name)||""}`)==null?void 0:S.trim())||"Unnamed Contact"}),s.jsxs("div",{className:"flex items-center text-text-secondary",children:[s.jsx("span",{children:(e==null?void 0:e.position)||"No position"}),(e==null?void 0:e.company)&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"mx-2",children:""}),e!=null&&e.company_id?s.jsxs(hr,{to:`/company-management/${e.company_id}`,className:"text-primary hover:underline flex items-center space-x-1",onClick:O=>O.stopPropagation(),children:[s.jsx(G,{name:"Building2",size:14}),s.jsx("span",{children:e.company.name})]}):s.jsx("span",{children:e.company.name})]})]}),s.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:((T=e==null?void 0:e.tags)==null?void 0:T.map((O,F)=>s.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-50 text-primary",children:O},`${O}-${F}`)))||null})]})]}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs("button",{onClick:()=>c(!0),className:"inline-flex items-center space-x-2 px-3 py-2 border border-border rounded-lg text-text-secondary hover:text-primary hover:border-primary transition-all duration-150 ease-out",children:[s.jsx(G,{name:"Mail",size:16}),s.jsx("span",{children:"Email"})]}),y(["contacts.edit_all","contacts.edit_own"])&&s.jsxs("button",{onClick:t,className:"inline-flex items-center space-x-2 px-3 py-2 border border-border rounded-lg text-text-secondary hover:text-primary hover:border-primary transition-all duration-150 ease-out",children:[s.jsx(G,{name:"Edit",size:16}),s.jsx("span",{children:"Edit"})]}),y(["contacts.delete_all","contacts.delete_own"])&&s.jsx("div",{className:"relative group",children:s.jsx("div",{className:"py-1",children:s.jsxs("button",{onClick:r,className:"flex w-full items-center px-4 py-2 text-sm text-error hover:bg-surface-hover",children:[s.jsx(G,{name:"Trash2",size:16,className:"mr-2"}),"Delete"]})})})]})]})}),s.jsx("div",{className:"border-b border-border",children:s.jsxs("nav",{className:"flex overflow-x-auto",children:[s.jsx("button",{onClick:()=>i("overview"),className:`px-4 py-3 text-sm font-medium whitespace-nowrap ${a==="overview"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:"Overview"}),s.jsxs("button",{onClick:()=>i("activity"),className:`px-4 py-3 text-sm font-medium whitespace-nowrap ${a==="activity"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:["Activity (",l.length,")"]}),s.jsxs("button",{onClick:()=>i("deals"),className:`px-4 py-3 text-sm font-medium whitespace-nowrap ${a==="deals"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:["Deals (",h.length,")"]}),s.jsxs("button",{onClick:()=>i("notes"),className:`px-4 py-3 text-sm font-medium whitespace-nowrap ${a==="notes"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:["Notes (",g,")"]})]})}),s.jsxs("div",{className:"p-6",children:[a==="overview"&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"card p-5",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Contact Information"}),s.jsxs("div",{className:"space-y-4",children:[(e==null?void 0:e.email)&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center mb-1",children:[s.jsx(G,{name:"Mail",size:16,className:"text-text-tertiary mr-2"}),s.jsx("span",{className:"text-sm text-text-secondary",children:"Email"})]}),s.jsx("a",{href:`mailto:${e==null?void 0:e.email}`,className:"text-primary hover:underline",children:e==null?void 0:e.email})]}),(e==null?void 0:e.phone)&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center mb-1",children:[s.jsx(G,{name:"Phone",size:16,className:"text-text-tertiary mr-2"}),s.jsx("span",{className:"text-sm text-text-secondary",children:"Phone"})]}),s.jsx("a",{href:`tel:${e==null?void 0:e.phone}`,className:"text-text-primary",children:e==null?void 0:e.phone})]}),(e==null?void 0:e.mobile)&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center mb-1",children:[s.jsx(G,{name:"Smartphone",size:16,className:"text-text-tertiary mr-2"}),s.jsx("span",{className:"text-sm text-text-secondary",children:"Mobile"})]}),s.jsx("a",{href:`tel:${e==null?void 0:e.mobile}`,className:"text-text-primary",children:e==null?void 0:e.mobile})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center mb-1",children:[s.jsx(G,{name:"Building",size:16,className:"text-text-tertiary mr-2"}),s.jsx("span",{className:"text-sm text-text-secondary",children:"Company"})]}),s.jsx("span",{className:"text-text-primary",children:((A=e==null?void 0:e.company)==null?void 0:A.name)||"No Company"})]}),(e==null?void 0:e.position)&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center mb-1",children:[s.jsx(G,{name:"Briefcase",size:16,className:"text-text-tertiary mr-2"}),s.jsx("span",{className:"text-sm text-text-secondary",children:"Position"})]}),s.jsx("span",{className:"text-text-primary",children:e==null?void 0:e.position})]}),(e==null?void 0:e.department)&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center mb-1",children:[s.jsx(G,{name:"Users",size:16,className:"text-text-tertiary mr-2"}),s.jsx("span",{className:"text-sm text-text-secondary",children:"Department"})]}),s.jsx("span",{className:"text-text-primary",children:e==null?void 0:e.department})]}),(e==null?void 0:e.lead_source)&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center mb-1",children:[s.jsx(G,{name:"Target",size:16,className:"text-text-tertiary mr-2"}),s.jsx("span",{className:"text-sm text-text-secondary",children:"Lead Source"})]}),s.jsx("span",{className:"text-text-primary capitalize",children:(E=e==null?void 0:e.lead_source)==null?void 0:E.replace("_"," ")})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center mb-1",children:[s.jsx(G,{name:"Calendar",size:16,className:"text-text-tertiary mr-2"}),s.jsx("span",{className:"text-sm text-text-secondary",children:"Last Contacted"})]}),s.jsx("span",{className:"text-text-primary",children:w(e==null?void 0:e.last_contact_date)})]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"card p-5",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Social Profiles"}),((M=Object.keys(D))==null?void 0:M.length)>0?s.jsx("div",{className:"space-y-3",children:(P=Object.entries(D))==null?void 0:P.map(([O,F])=>{var I;return s.jsxs("a",{href:F!=null&&F.startsWith("http")?F:`https://${F}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-text-primary hover:text-primary transition-colors duration-150 ease-out",children:[s.jsx(G,{name:j(O),size:16,className:"mr-2"}),s.jsx("span",{children:((I=O==null?void 0:O.charAt(0))==null?void 0:I.toUpperCase())+(O==null?void 0:O.slice(1))}),s.jsx(G,{name:"ExternalLink",size:14,className:"ml-2"})]},O)})}):s.jsx("p",{className:"text-text-secondary text-sm",children:"No social profiles added"})]}),s.jsxs("div",{className:"card p-5",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Additional Information"}),e!=null&&e.custom_fields&&((X=Object.keys(e==null?void 0:e.custom_fields))==null?void 0:X.length)>0?s.jsx("div",{className:"space-y-3",children:(q=Object.entries(e==null?void 0:e.custom_fields))==null?void 0:q.map(([O,F])=>{var C,k,z,V,Z;const I=typeof F=="object"&&F!==null&&"value"in F?F.value:F,L=(Z=(V=(z=(k=(C=O==null?void 0:O.replace(/_/g," "))==null?void 0:C.replace(/([A-Z])/g," $1"))==null?void 0:k.trim())==null?void 0:z.split(" "))==null?void 0:V.map(ce=>ce.charAt(0).toUpperCase()+ce.slice(1).toLowerCase()))==null?void 0:Z.join(" ");return I==null||I===""?null:s.jsxs("div",{className:"pb-3 border-b border-border last:border-0",children:[s.jsx("div",{className:"text-sm font-medium text-text-secondary mb-1",children:L}),s.jsx("div",{className:"text-text-primary",children:typeof I=="boolean"?I?"Yes":"No":Array.isArray(I)?I.join(", "):String(I)})]},O)})}):s.jsx("p",{className:"text-text-secondary text-sm",children:"No additional information"})]})]})]}),a==="activity"&&s.jsx(dRe,{activities:l,contact:e,onActivityAdded:b,onActivityUpdated:_,loading:d}),a==="deals"&&s.jsx(fRe,{deals:h,contactName:(e==null?void 0:e.full_name)||((B=`${(e==null?void 0:e.first_name)||""} ${(e==null?void 0:e.last_name)||""}`)==null?void 0:B.trim())||"Unnamed Contact",loading:x}),a==="notes"&&s.jsx(hRe,{contact:e,onNotesCountChange:v})]}),o&&s.jsx(gRe,{contact:e,onClose:()=>c(!1),onSend:O=>{console.log("Email sent:",O),c(!1)}})]})},yRe=({contact:e=null,onSubmit:t,onCancel:r})=>{const{user:n}=Pt(),[a,i]=R.useState(!1),[o,c]=R.useState([]),[l,u]=R.useState([]),[d,f]=R.useState({}),[h,m]=R.useState(!1),[x,p]=R.useState({first_name:"",last_name:"",email:"",phone:"",mobile:"",position:"",department:"",company_id:"",companyName:"",status:"active",lead_source:"website",social_linkedin:"",social_twitter:"",owner_id:(n==null?void 0:n.id)||""}),[g,v]=R.useState({});R.useEffect(()=>{if(y(),b(),e)if(p({first_name:(e==null?void 0:e.first_name)||"",last_name:(e==null?void 0:e.last_name)||"",email:(e==null?void 0:e.email)||"",phone:(e==null?void 0:e.phone)||"",mobile:(e==null?void 0:e.mobile)||"",position:(e==null?void 0:e.position)||"",department:(e==null?void 0:e.department)||"",company_id:(e==null?void 0:e.company_id)||"",companyName:"",status:(e==null?void 0:e.status)||"active",lead_source:(e==null?void 0:e.lead_source)||"website",social_linkedin:(e==null?void 0:e.social_linkedin)||"",social_twitter:(e==null?void 0:e.social_twitter)||"",owner_id:(e==null?void 0:e.owner_id)||(n==null?void 0:n.id)||""}),e!=null&&e.custom_fields){console.log("Using custom fields from contact object:",e.custom_fields);const T={};Object.entries(e.custom_fields).forEach(([A,E])=>{(E==null?void 0:E.value)!==null&&(E==null?void 0:E.value)!==void 0&&(T[A]=E.value)}),console.log("Custom field values extracted:",T),f(T)}else e!=null&&e.id&&_(e.id)},[e,n]);const y=async()=>{try{const T=await(Wt==null?void 0:Wt.getAllCompanies());c(T||[])}catch(T){console.error("Error loading companies:",T),v({submit:"Failed to load companies. Please try refreshing the page."})}},b=async()=>{m(!0);try{console.log("Loading custom fields for contacts...");const A=(await vi.getAllFields({entity_type:"contact",is_active:!0})||[]).filter(E=>E.placement==="form"||E.placement==="both");console.log("Custom fields loaded:",A),u(A)}catch(T){console.error("Error loading custom fields:",T),u([])}finally{m(!1)}},_=async T=>{try{console.log("Loading custom field values for contact:",T);const A=await vi.getEntityCustomFields("contact",T),E={};A.forEach(M=>{M.current_value!==null&&M.current_value!==void 0&&(E[M.field_key]=M.current_value)}),console.log("Custom field values loaded:",E),f(E)}catch(A){console.error("Error loading custom field values:",A),f({})}},w=async T=>{var A;T==null||T.preventDefault(),i(!0),v({});try{const E=["first_name","last_name","email"],M={};if(E==null||E.forEach(X=>{var q;(q=x==null?void 0:x[X])!=null&&q.trim()||(M[X]=`${X==null?void 0:X.replace("_"," ")} is required`)}),x!=null&&x.email&&!/\S+@\S+\.\S+/.test(x==null?void 0:x.email)&&(M.email="Please enter a valid email address"),((A=Object.keys(M))==null?void 0:A.length)>0){v(M),i(!1);return}const P={...x,custom_fields:Object.keys(d).length>0?d:void 0};console.log("Submitting contact form data to parent component:",P),await(t==null?void 0:t(P))}catch(E){console.error("Error saving contact:",E),v({submit:(E==null?void 0:E.message)||"Failed to save contact. Please try again."})}finally{i(!1)}},j=(T,A)=>{p(E=>({...E,[T]:A})),g!=null&&g[T]&&v(E=>{const M={...E};return M==null||delete M[T],M})},N=(T,A)=>{T&&(f(E=>({...E,[T]:A})),g!=null&&g[T]&&v(E=>{const M={...E};return delete M[T],M}))},D=[{value:"website",label:"Website"},{value:"referral",label:"Referral"},{value:"cold_call",label:"Cold Call"},{value:"email_campaign",label:"Email Campaign"},{value:"social_media",label:"Social Media"},{value:"event",label:"Event"},{value:"partner",label:"Partner"},{value:"other",label:"Other"}],S=[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}];return s.jsxs("form",{onSubmit:w,className:"space-y-6",children:[(g==null?void 0:g.submit)&&s.jsxs("div",{className:"bg-error-50 border border-error-200 text-error p-4 rounded-lg flex items-center space-x-2",children:[s.jsx(G,{name:"AlertCircle",size:20}),s.jsx("span",{children:g==null?void 0:g.submit})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"First Name *"}),s.jsx("input",{type:"text",value:x==null?void 0:x.first_name,onChange:T=>{var A;return j("first_name",(A=T==null?void 0:T.target)==null?void 0:A.value)},className:`w-full px-3 py-2 border rounded-lg bg-surface text-text-primary placeholder-text-tertiary focus:ring-primary focus:border-primary ${g!=null&&g.first_name?"border-error":"border-border"}`,placeholder:"John",required:!0}),(g==null?void 0:g.first_name)&&s.jsx("p",{className:"text-sm text-error mt-1",children:g==null?void 0:g.first_name})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Last Name *"}),s.jsx("input",{type:"text",value:x==null?void 0:x.last_name,onChange:T=>{var A;return j("last_name",(A=T==null?void 0:T.target)==null?void 0:A.value)},className:`w-full px-3 py-2 border rounded-lg bg-surface text-text-primary placeholder-text-tertiary focus:ring-primary focus:border-primary ${g!=null&&g.last_name?"border-error":"border-border"}`,placeholder:"Doe",required:!0}),(g==null?void 0:g.last_name)&&s.jsx("p",{className:"text-sm text-error mt-1",children:g==null?void 0:g.last_name})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Email Address *"}),s.jsx("input",{type:"email",value:x==null?void 0:x.email,onChange:T=>{var A;return j("email",(A=T==null?void 0:T.target)==null?void 0:A.value)},className:`w-full px-3 py-2 border rounded-lg bg-surface text-text-primary placeholder-text-tertiary focus:ring-primary focus:border-primary ${g!=null&&g.email?"border-error":"border-border"}`,placeholder:"john.doe@company.com",required:!0}),(g==null?void 0:g.email)&&s.jsx("p",{className:"text-sm text-error mt-1",children:g==null?void 0:g.email})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Phone Number"}),s.jsx("input",{type:"tel",value:x==null?void 0:x.phone,onChange:T=>{var A;return j("phone",(A=T==null?void 0:T.target)==null?void 0:A.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary placeholder-text-tertiary focus:ring-primary focus:border-primary",placeholder:"+1 (555) 123-4567"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Position"}),s.jsx("input",{type:"text",value:x==null?void 0:x.position,onChange:T=>{var A;return j("position",(A=T==null?void 0:T.target)==null?void 0:A.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary placeholder-text-tertiary focus:ring-primary focus:border-primary",placeholder:"Sales Manager"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Department"}),s.jsx("input",{type:"text",value:x==null?void 0:x.department,onChange:T=>{var A;return j("department",(A=T==null?void 0:T.target)==null?void 0:A.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary placeholder-text-tertiary focus:ring-primary focus:border-primary",placeholder:"Sales"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Company"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("select",{value:x==null?void 0:x.company_id,onChange:T=>{var A;return j("company_id",(A=T==null?void 0:T.target)==null?void 0:A.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary focus:ring-primary focus:border-primary",children:[s.jsx("option",{value:"",children:"Select Existing Company"}),o==null?void 0:o.map(T=>s.jsx("option",{value:T==null?void 0:T.id,children:T==null?void 0:T.name},T==null?void 0:T.id))]}),s.jsx("input",{type:"text",value:x==null?void 0:x.companyName,onChange:T=>{var A;return j("companyName",(A=T==null?void 0:T.target)==null?void 0:A.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary placeholder-text-tertiary focus:ring-primary focus:border-primary",placeholder:"Or enter new company name"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Status"}),s.jsx("select",{value:x==null?void 0:x.status,onChange:T=>{var A;return j("status",(A=T==null?void 0:T.target)==null?void 0:A.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary focus:ring-primary focus:border-primary",children:S==null?void 0:S.map(T=>s.jsx("option",{value:T==null?void 0:T.value,children:T==null?void 0:T.label},T==null?void 0:T.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Lead Source"}),s.jsx("select",{value:x==null?void 0:x.lead_source,onChange:T=>{var A;return j("lead_source",(A=T==null?void 0:T.target)==null?void 0:A.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary focus:ring-primary focus:border-primary",children:D==null?void 0:D.map(T=>s.jsx("option",{value:T==null?void 0:T.value,children:T==null?void 0:T.label},T==null?void 0:T.value))})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"LinkedIn URL"}),s.jsx("input",{type:"url",value:x==null?void 0:x.social_linkedin,onChange:T=>{var A;return j("social_linkedin",(A=T==null?void 0:T.target)==null?void 0:A.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary placeholder-text-tertiary focus:ring-primary focus:border-primary",placeholder:"https://linkedin.com/in/johndoe"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Twitter URL"}),s.jsx("input",{type:"url",value:x==null?void 0:x.social_twitter,onChange:T=>{var A;return j("social_twitter",(A=T==null?void 0:T.target)==null?void 0:A.value)},className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-text-primary placeholder-text-tertiary focus:ring-primary focus:border-primary",placeholder:"https://twitter.com/johndoe"})]})]}),h&&s.jsx("div",{className:"pt-6 border-t border-border",children:s.jsxs("div",{className:"text-center py-4 text-gray-500",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),s.jsx("p",{className:"mt-2",children:"Loading custom fields..."})]})}),!h&&Array.isArray(l)&&l.length>0&&s.jsx("div",{className:"pt-6 border-t border-border",children:s.jsx(ug,{fields:l,values:d||{},onChange:N,errors:g||{}})}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-border",children:[s.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-text-secondary hover:text-text-primary dark:hover:text-text-primary transition-colors duration-150",disabled:a,children:"Cancel"}),s.jsxs("button",{type:"submit",disabled:a,className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors duration-150 ease-smooth flex items-center space-x-2",children:[a&&s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx("span",{children:e?"Update Contact":"Create Contact"})]})]})]})},bRe=({onImport:e,onClose:t})=>{var b;const[r,n]=R.useState(1),[a,i]=R.useState(null),[o,c]=R.useState({firstName:"",lastName:"",email:"",phone:"",company:"",position:""}),[l,u]=R.useState([]),[d,f]=R.useState(!1),[h,m]=R.useState([]),[x,p]=R.useState(null),g=_=>{var j,N;const w=(N=(j=_==null?void 0:_.target)==null?void 0:j.files)==null?void 0:N[0];w&&(i(w),p(null),f(!0),Tf.parse(w,{header:!0,skipEmptyLines:!0,complete:D=>{try{if(D.errors&&D.errors.length>0){console.error("CSV parsing errors:",D.errors),p("Error parsing file. Please check the format."),f(!1);return}if(!D.data||D.data.length===0){p("The file is empty or has no valid data."),f(!1);return}const S=Object.keys(D.data[0]||{});m(S),u(D.data);const T={firstName:"",lastName:"",email:"",phone:"",company:"",position:""};S.forEach(A=>{const E=A.toLowerCase().trim();E.includes("first")&&E.includes("name")?T.firstName=A:E.includes("last")&&E.includes("name")?T.lastName=A:E.includes("email")?T.email=A:E.includes("phone")||E.includes("mobile")?T.phone=A:E.includes("company")||E.includes("organization")?T.company=A:(E.includes("position")||E.includes("title")||E.includes("job"))&&(T.position=A)}),c(T),n(2),f(!1)}catch(S){console.error("Error processing file:",S),p("Failed to process the file. Please try again."),f(!1)}},error:D=>{console.error("Papa Parse error:",D),p("Failed to parse the file. Please ensure it's a valid CSV file."),f(!1)}}))},v=(_,w)=>{c({...o,[_]:w})},y=async()=>{f(!0),p(null);try{const _=l.filter(w=>{const j=w==null?void 0:w[o==null?void 0:o.firstName],N=w==null?void 0:w[o==null?void 0:o.lastName];return j&&N&&j.trim()&&N.trim()}).map(w=>{const j={first_name:((w==null?void 0:w[o==null?void 0:o.firstName])||"").trim(),last_name:((w==null?void 0:w[o==null?void 0:o.lastName])||"").trim(),status:"active"},N=((w==null?void 0:w[o==null?void 0:o.email])||"").trim();N&&(j.email=N);const D=((w==null?void 0:w[o==null?void 0:o.phone])||"").trim();D&&(j.phone=D);const S=((w==null?void 0:w[o==null?void 0:o.company])||"").trim();S&&(j.company_name=S);const T=((w==null?void 0:w[o==null?void 0:o.position])||"").trim();return T&&(j.position=T),j});if(console.log("Importing contacts:",_),_.length===0){p("No valid contacts found. Please ensure firstName and lastName are provided for all contacts."),f(!1);return}await e(_),f(!1),t()}catch(_){console.error("Error preparing import data:",_),p("Failed to prepare import data. Please try again."),f(!1)}};return s.jsx("div",{className:"fixed inset-0 z-1100 overflow-y-auto",children:s.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[s.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50"})}),s.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:""}),s.jsxs("div",{className:"inline-block align-bottom bg-surface rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full md:max-w-2xl",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-border flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Import Contacts"}),s.jsx("button",{onClick:t,className:"text-text-secondary hover:text-text-primary",children:s.jsx(G,{name:"X",size:20})})]}),s.jsxs("div",{className:"px-6 py-5",children:[r===1&&s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("div",{className:"w-16 h-16 bg-primary-50 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(G,{name:"Upload",size:24,className:"text-primary"})}),s.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Upload Contact File"}),s.jsx("p",{className:"text-text-secondary mb-4",children:"Upload a CSV file with your contacts data."})]}),x&&s.jsx("div",{className:"mb-4 p-3 bg-error-50 border border-error-200 rounded-lg text-error text-sm",children:x}),d&&s.jsxs("div",{className:"mb-4 p-3 bg-primary-50 border border-primary-200 rounded-lg text-primary text-sm flex items-center justify-center",children:[s.jsx(G,{name:"Loader",size:16,className:"animate-spin mr-2"}),"Parsing file..."]}),s.jsxs("div",{className:"border-2 border-dashed border-border rounded-lg p-8 mb-6",children:[s.jsx("input",{type:"file",id:"contactFile",accept:".csv",onChange:g,className:"hidden",disabled:d}),s.jsxs("label",{htmlFor:"contactFile",className:`cursor-pointer flex flex-col items-center justify-center ${d?"opacity-50 cursor-not-allowed":""}`,children:[s.jsx(G,{name:"FileText",size:36,className:"text-text-tertiary mb-3"}),s.jsx("span",{className:"text-text-primary font-medium mb-1",children:"Drag and drop your file here or click to browse"}),s.jsx("span",{className:"text-sm text-text-tertiary",children:"Supports CSV files"}),a&&!d&&s.jsxs("span",{className:"text-sm text-primary mt-2",children:["Selected: ",a.name]})]})]}),s.jsxs("div",{className:"text-sm text-text-secondary",children:[s.jsx("p",{className:"mb-2",children:"Your file should include the following columns:"}),s.jsxs("ul",{className:"list-disc list-inside space-y-1 text-left",children:[s.jsx("li",{children:"First Name"}),s.jsx("li",{children:"Last Name"}),s.jsx("li",{children:"Email Address"}),s.jsx("li",{children:"Phone Number (optional)"}),s.jsx("li",{children:"Company Name"}),s.jsx("li",{children:"Position/Title (optional)"})]})]})]}),r===2&&s.jsxs("div",{children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Map Fields"}),s.jsx("p",{className:"text-text-secondary",children:"Match your file columns to the appropriate contact fields."})]}),x&&s.jsx("div",{className:"mb-4 p-3 bg-error-50 border border-error-200 rounded-lg text-error text-sm",children:x}),s.jsx("div",{className:"space-y-4 mb-6",children:s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"First Name* (Required)"}),s.jsxs("select",{value:o==null?void 0:o.firstName,onChange:_=>{var w;return v("firstName",(w=_==null?void 0:_.target)==null?void 0:w.value)},className:"input-field",children:[s.jsx("option",{value:"",children:"Select column"}),h.map(_=>s.jsx("option",{value:_,children:_},_))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Last Name* (Required)"}),s.jsxs("select",{value:o==null?void 0:o.lastName,onChange:_=>{var w;return v("lastName",(w=_==null?void 0:_.target)==null?void 0:w.value)},className:"input-field",children:[s.jsx("option",{value:"",children:"Select column"}),h.map(_=>s.jsx("option",{value:_,children:_},_))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Email (Optional)"}),s.jsxs("select",{value:o==null?void 0:o.email,onChange:_=>{var w;return v("email",(w=_==null?void 0:_.target)==null?void 0:w.value)},className:"input-field",children:[s.jsx("option",{value:"",children:"Select column"}),h.map(_=>s.jsx("option",{value:_,children:_},_))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Phone (Optional)"}),s.jsxs("select",{value:o==null?void 0:o.phone,onChange:_=>{var w;return v("phone",(w=_==null?void 0:_.target)==null?void 0:w.value)},className:"input-field",children:[s.jsx("option",{value:"",children:"Select column"}),h.map(_=>s.jsx("option",{value:_,children:_},_))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Company (Optional)"}),s.jsxs("select",{value:o==null?void 0:o.company,onChange:_=>{var w;return v("company",(w=_==null?void 0:_.target)==null?void 0:w.value)},className:"input-field",children:[s.jsx("option",{value:"",children:"Select column"}),h.map(_=>s.jsx("option",{value:_,children:_},_))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Position (Optional)"}),s.jsxs("select",{value:o==null?void 0:o.position,onChange:_=>{var w;return v("position",(w=_==null?void 0:_.target)==null?void 0:w.value)},className:"input-field",children:[s.jsx("option",{value:"",children:"Select column"}),h.map(_=>s.jsx("option",{value:_,children:_},_))]})]})]})}),s.jsxs("div",{className:"border border-border rounded-lg overflow-hidden mb-6",children:[s.jsxs("div",{className:"px-4 py-3 bg-surface-hover text-sm font-medium text-text-primary",children:["Preview (",l==null?void 0:l.length," records)"]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-border",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 bg-surface-hover text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"First Name"}),s.jsx("th",{className:"px-4 py-3 bg-surface-hover text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Last Name"}),s.jsx("th",{className:"px-4 py-3 bg-surface-hover text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Email"}),s.jsx("th",{className:"px-4 py-3 bg-surface-hover text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Company"})]})}),s.jsx("tbody",{className:"bg-surface divide-y divide-border",children:(b=l==null?void 0:l.slice(0,3))==null?void 0:b.map((_,w)=>s.jsxs("tr",{children:[s.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-text-primary",children:(_==null?void 0:_[o==null?void 0:o.firstName])||"-"}),s.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-text-primary",children:(_==null?void 0:_[o==null?void 0:o.lastName])||"-"}),s.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-text-primary",children:(_==null?void 0:_[o==null?void 0:o.email])||"-"}),s.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-text-primary",children:(_==null?void 0:_[o==null?void 0:o.company])||"-"})]},w))})]})})]})]})]}),s.jsxs("div",{className:"px-6 py-4 border-t border-border flex justify-between",children:[r===1?s.jsx("button",{onClick:t,className:"px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-out",children:"Cancel"}):s.jsxs("button",{onClick:()=>n(1),className:"inline-flex items-center px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-out",children:[s.jsx(G,{name:"ArrowLeft",size:16,className:"mr-2"}),"Back"]}),r===1?s.jsx("button",{disabled:!a,className:`btn-primary ${a?"":"opacity-50 cursor-not-allowed"}`,children:"Next"}):s.jsx("button",{onClick:y,disabled:d||!(o!=null&&o.firstName)||!(o!=null&&o.lastName),className:`btn-primary inline-flex items-center ${d||!(o!=null&&o.firstName)||!(o!=null&&o.lastName)?"opacity-50 cursor-not-allowed":""}`,children:d?s.jsxs(s.Fragment,{children:[s.jsx(G,{name:"Loader",size:16,className:"animate-spin mr-2"}),"Importing..."]}):s.jsx(s.Fragment,{children:"Import Contacts"})})]})]})]})})},wRe=({contacts:e,onClose:t})=>{const[r,n]=R.useState("csv"),[a,i]=R.useState({basicInfo:!0,contactDetails:!0,companyInfo:!0,deals:!0,activities:!1,notes:!1,customFields:!1}),[o,c]=R.useState(!1),l=d=>{i({...a,[d]:!(a!=null&&a[d])})},u=()=>{c(!0),setTimeout(()=>{console.log("Exporting contacts:",e),console.log("Export format:",r),console.log("Selected fields:",a),c(!1),t()},1e3)};return s.jsx("div",{className:"fixed inset-0 z-1100 overflow-y-auto",children:s.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[s.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50"})}),s.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:""}),s.jsxs("div",{className:"inline-block align-bottom bg-surface rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-border flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Export Contacts"}),s.jsx("button",{onClick:t,className:"text-text-secondary hover:text-text-primary",children:s.jsx(G,{name:"X",size:20})})]}),s.jsx("div",{className:"px-6 py-5",children:s.jsxs("div",{className:"mb-6",children:[s.jsxs("p",{className:"text-text-secondary mb-4",children:["Exporting ",e==null?void 0:e.length," ",(e==null?void 0:e.length)===1?"contact":"contacts"]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Export Format"}),s.jsxs("div",{className:"flex space-x-4",children:[s.jsxs("label",{className:"inline-flex items-center",children:[s.jsx("input",{type:"radio",value:"csv",checked:r==="csv",onChange:()=>n("csv"),className:"h-4 w-4 text-primary border-border focus:ring-primary"}),s.jsx("span",{className:"ml-2 text-text-secondary",children:"CSV"})]}),s.jsxs("label",{className:"inline-flex items-center",children:[s.jsx("input",{type:"radio",value:"excel",checked:r==="excel",onChange:()=>n("excel"),className:"h-4 w-4 text-primary border-border focus:ring-primary"}),s.jsx("span",{className:"ml-2 text-text-secondary",children:"Excel"})]}),s.jsxs("label",{className:"inline-flex items-center",children:[s.jsx("input",{type:"radio",value:"vcf",checked:r==="vcf",onChange:()=>n("vcf"),className:"h-4 w-4 text-primary border-border focus:ring-primary"}),s.jsx("span",{className:"ml-2 text-text-secondary",children:"vCard"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Fields to Export"}),s.jsxs("div",{className:"space-y-2 border border-border rounded-lg p-4",children:[s.jsxs("label",{className:"flex items-center justify-between py-1 border-b border-border",children:[s.jsx("span",{className:"text-text-primary",children:"Basic Information (Name, Email)"}),s.jsx("input",{type:"checkbox",checked:a==null?void 0:a.basicInfo,onChange:()=>l("basicInfo"),disabled:!0,className:"h-4 w-4 text-primary border-border rounded focus:ring-primary"})]}),s.jsxs("label",{className:"flex items-center justify-between py-1 border-b border-border",children:[s.jsx("span",{className:"text-text-secondary",children:"Contact Details (Phone)"}),s.jsx("input",{type:"checkbox",checked:a==null?void 0:a.contactDetails,onChange:()=>l("contactDetails"),className:"h-4 w-4 text-primary border-border rounded focus:ring-primary"})]}),s.jsxs("label",{className:"flex items-center justify-between py-1 border-b border-border",children:[s.jsx("span",{className:"text-text-secondary",children:"Company Information"}),s.jsx("input",{type:"checkbox",checked:a==null?void 0:a.companyInfo,onChange:()=>l("companyInfo"),className:"h-4 w-4 text-primary border-border rounded focus:ring-primary"})]}),s.jsxs("label",{className:"flex items-center justify-between py-1 border-b border-border",children:[s.jsx("span",{className:"text-text-secondary",children:"Deals"}),s.jsx("input",{type:"checkbox",checked:a==null?void 0:a.deals,onChange:()=>l("deals"),className:"h-4 w-4 text-primary border-border rounded focus:ring-primary"})]}),s.jsxs("label",{className:"flex items-center justify-between py-1 border-b border-border",children:[s.jsx("span",{className:"text-text-secondary",children:"Activities"}),s.jsx("input",{type:"checkbox",checked:a==null?void 0:a.activities,onChange:()=>l("activities"),className:"h-4 w-4 text-primary border-border rounded focus:ring-primary"})]}),s.jsxs("label",{className:"flex items-center justify-between py-1 border-b border-border",children:[s.jsx("span",{className:"text-text-secondary",children:"Notes"}),s.jsx("input",{type:"checkbox",checked:a==null?void 0:a.notes,onChange:()=>l("notes"),className:"h-4 w-4 text-primary border-border rounded focus:ring-primary"})]}),s.jsxs("label",{className:"flex items-center justify-between py-1",children:[s.jsx("span",{className:"text-text-secondary",children:"Custom Fields"}),s.jsx("input",{type:"checkbox",checked:a==null?void 0:a.customFields,onChange:()=>l("customFields"),className:"h-4 w-4 text-primary border-border rounded focus:ring-primary"})]})]})]})]})}),s.jsxs("div",{className:"px-6 py-4 border-t border-border flex justify-end space-x-3",children:[s.jsx("button",{onClick:t,className:"px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-out",children:"Cancel"}),s.jsx("button",{onClick:u,disabled:o,className:"btn-primary inline-flex items-center",children:o?s.jsxs(s.Fragment,{children:[s.jsx(G,{name:"Loader",size:16,className:"animate-spin mr-2"}),"Exporting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(G,{name:"Download",size:16,className:"mr-2"}),"Export"]})})]})]})]})})},_Re=({contact1:e,contact2:t,onMerge:r,onClose:n})=>{var l,u,d,f;const[a,i]=R.useState({id:Date.now(),firstName:e==null?void 0:e.firstName,lastName:e==null?void 0:e.lastName,email:e==null?void 0:e.email,phone:e==null?void 0:e.phone,company:e==null?void 0:e.company,position:e==null?void 0:e.position,avatar:e==null?void 0:e.avatar,lastContactDate:(l=new Date)==null?void 0:l.toISOString(),status:e==null?void 0:e.status,tags:[...new Set([...e.tags,...t.tags])],deals:[...e==null?void 0:e.deals,...t==null?void 0:t.deals],notes:e!=null&&e.notes&&(t!=null&&t.notes)?`${e==null?void 0:e.notes}

${t==null?void 0:t.notes}`:(e==null?void 0:e.notes)||(t==null?void 0:t.notes),socialProfiles:{...e==null?void 0:e.socialProfiles,...t==null?void 0:t.socialProfiles},activities:[...e==null?void 0:e.activities,...t==null?void 0:t.activities].sort((h,m)=>new Date(m.date)-new Date(h.date)),customFields:{...e==null?void 0:e.customFields}}),o=(h,m)=>{i({...a,[h]:m})},c=(h,m,x,p)=>s.jsxs("div",{className:"py-3 border-b border-border last:border-b-0",children:[s.jsx("div",{className:"text-sm font-medium text-text-secondary mb-2",children:m}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[s.jsx("div",{className:`flex-1 p-3 rounded-lg border ${(a==null?void 0:a[h])===x?"border-primary bg-primary-50":"border-border hover:border-primary-100 cursor-pointer"}`,onClick:()=>o(h,x),children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-1",children:h==="avatar"?s.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden",children:s.jsx(Ts,{src:x,alt:"Contact 1",className:"w-full h-full object-cover"})}):s.jsx("span",{className:"text-text-primary",children:x||"-"})}),(a==null?void 0:a[h])===x&&s.jsx(G,{name:"Check",size:16,className:"text-primary"})]})}),s.jsx("div",{className:`flex-1 p-3 rounded-lg border ${(a==null?void 0:a[h])===p?"border-primary bg-primary-50":"border-border hover:border-primary-100 cursor-pointer"}`,onClick:()=>o(h,p),children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-1",children:h==="avatar"?s.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden",children:s.jsx(Ts,{src:p,alt:"Contact 2",className:"w-full h-full object-cover"})}):s.jsx("span",{className:"text-text-primary",children:p||"-"})}),(a==null?void 0:a[h])===p&&s.jsx(G,{name:"Check",size:16,className:"text-primary"})]})})]})]});return s.jsx("div",{className:"fixed inset-0 z-1100 overflow-y-auto",children:s.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[s.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50"})}),s.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:""}),s.jsxs("div",{className:"inline-block align-bottom bg-surface rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full md:max-w-2xl",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-border flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Merge Duplicate Contacts"}),s.jsx("button",{onClick:n,className:"text-text-secondary hover:text-text-primary",children:s.jsx(G,{name:"X",size:20})})]}),s.jsx("div",{className:"px-6 py-5",children:s.jsxs("div",{className:"mb-6",children:[s.jsx("p",{className:"text-text-secondary mb-4",children:"Select which information to keep for the merged contact."}),s.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[s.jsx("div",{}),s.jsx("div",{className:"text-center text-sm font-medium text-text-primary",children:"Contact 1"}),s.jsx("div",{className:"text-center text-sm font-medium text-text-primary",children:"Contact 2"})]}),s.jsxs("div",{className:"border border-border rounded-lg divide-y divide-border",children:[c("avatar","Profile Picture",e==null?void 0:e.avatar,t==null?void 0:t.avatar),c("firstName","First Name",e==null?void 0:e.firstName,t==null?void 0:t.firstName),c("lastName","Last Name",e==null?void 0:e.lastName,t==null?void 0:t.lastName),c("email","Email",e==null?void 0:e.email,t==null?void 0:t.email),c("phone","Phone",e==null?void 0:e.phone,t==null?void 0:t.phone),c("company","Company",e==null?void 0:e.company,t==null?void 0:t.company),c("position","Position",e==null?void 0:e.position,t==null?void 0:t.position)]}),s.jsx("div",{className:"mt-6",children:s.jsx("div",{className:"bg-primary-50 border border-primary-100 rounded-lg p-4 text-sm text-primary",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx(G,{name:"Info",size:16,className:"mr-2 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium mb-1",children:"Additional Information"}),s.jsx("p",{children:"The following data will be combined from both contacts:"}),s.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[s.jsxs("li",{children:["Tags (",(u=a==null?void 0:a.tags)==null?void 0:u.length," total)"]}),s.jsxs("li",{children:["Deals (",(d=a==null?void 0:a.deals)==null?void 0:d.length," total)"]}),s.jsxs("li",{children:["Activities (",(f=a==null?void 0:a.activities)==null?void 0:f.length," total)"]}),s.jsx("li",{children:"Notes (will be concatenated)"}),s.jsx("li",{children:"Social profiles (will be merged)"})]})]})]})})})]})}),s.jsxs("div",{className:"px-6 py-4 border-t border-border flex justify-end space-x-3",children:[s.jsx("button",{onClick:n,className:"px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-out",children:"Cancel"}),s.jsxs("button",{onClick:()=>r(a),className:"btn-primary inline-flex items-center",children:[s.jsx(G,{name:"GitMerge",size:16,className:"mr-2"}),"Merge Contacts"]})]})]})]})})},jRe=()=>{const{user:e}=Pt(),[t,r]=R.useState([]),[n,a]=R.useState(!0),[i,o]=R.useState(null),[c,l]=R.useState([]),[u,d]=R.useState(""),[f,h]=R.useState(!1),[m,x]=R.useState(!1),[p,g]=R.useState(!1),[v,y]=R.useState(!1),[b,_]=R.useState(!1),[w,j]=R.useState("all"),[N,D]=R.useState("grid"),[S,T]=R.useState(""),[A,E]=R.useState(""),M=async()=>{var Z,ce;try{a(!0),T("");let ie=[];if(u?ie=await(Nt==null?void 0:Nt.searchContacts(u)):ie=await(Nt==null?void 0:Nt.getUserContacts()),r(ie||[]),(ie==null?void 0:ie.length)>0&&N==="split"&&!i)try{const Q=await(Nt==null?void 0:Nt.getContactById(ie[0].id));o(Q)}catch(Q){console.error("Error loading full contact data:",Q),o(ie==null?void 0:ie[0])}}catch(ie){console.error("Error loading contacts:",ie),(Z=ie==null?void 0:ie.message)!=null&&Z.includes("Failed to fetch")||(ce=ie==null?void 0:ie.message)!=null&&ce.includes("NetworkError")?T("Cannot connect to database. Your Supabase project may be paused or inactive. Please check your Supabase dashboard and resume your project if needed."):T("Failed to load contacts. Please try again.")}finally{a(!1)}};R.useEffect(()=>{e&&M()},[e,u,w]),R.useEffect(()=>{if(S||A){const Z=setTimeout(()=>{T(""),E("")},5e3);return()=>clearTimeout(Z)}},[S,A]);const P=t==null?void 0:t.filter(Z=>w==="active"?(Z==null?void 0:Z.status)==="active":w==="inactive"?(Z==null?void 0:Z.status)==="inactive":w==="my"?(Z==null?void 0:Z.owner_id)===(e==null?void 0:e.id):!0),X=async Z=>{console.log("handleContactSelect called with:",Z);try{if(Z!=null&&Z.id){const ce=await(Nt==null?void 0:Nt.getContactById(Z.id));o(ce)}else o(Z);D("split"),h(!1),x(!1)}catch(ce){console.error("Error in handleContactSelect:",ce),o(Z),D("split"),h(!1),x(!1),T("Could not load full contact details. Showing basic information.")}},q=Z=>{console.log("handleContactMultiSelect called with:",Z);try{l(ce=>{const ie=ce!=null&&ce.includes(Z)?ce==null?void 0:ce.filter(Q=>Q!==Z):[...ce||[],Z];return console.log("Updated selectedContacts:",ie),ie})}catch(ce){console.error("Error in handleContactMultiSelect:",ce),T("Something went wrong while selecting contacts. Please try again.")}},B=()=>{D("grid"),o(null),h(!1),x(!1)},O=()=>{o(null),h(!0),x(!1),D("split")},F=async()=>{if(h(!1),x(!0),i!=null&&i.id)try{const Z=await(Nt==null?void 0:Nt.getContactById(i.id));o(Z)}catch(Z){console.error("Error loading full contact data:",Z)}},I=async Z=>{var ce,ie,Q,ne,pe,W;try{T("");let re;if(console.log("handleSaveContact called with:",{isAddingContact:f,isEditingContact:m,selectedContactId:i==null?void 0:i.id,contactData:Z}),f){console.log("Creating new contact...");let U=Z.company_id;if((ce=Z.companyName)!=null&&ce.trim()&&!U){console.log("Creating new company:",Z.companyName);try{const K=await(Wt==null?void 0:Wt.searchCompanies((ie=Z.companyName)==null?void 0:ie.trim())),H=K==null?void 0:K.find(oe=>{var J,le,he;return((J=oe.name)==null?void 0:J.toLowerCase())===((he=(le=Z.companyName)==null?void 0:le.trim())==null?void 0:he.toLowerCase())});if(H)console.log("Found existing company:",H),U=H.id;else{const oe=await(Wt==null?void 0:Wt.createCompany({name:(Q=Z.companyName)==null?void 0:Q.trim()}));console.log("Created new company:",oe),U=oe.id}}catch(K){throw console.error("Error handling company:",K),new Error(`Failed to create company "${Z.companyName}": ${K.message}`)}}const{companyName:se,...te}={...Z,company_id:U||null,owner_id:e==null?void 0:e.id};Object.keys(te).forEach(K=>{te[K]===""&&["company_id"].includes(K)&&(te[K]=null)}),re=await(Nt==null?void 0:Nt.createContact(te)),E(`Contact "${re==null?void 0:re.first_name} ${re==null?void 0:re.last_name}" created successfully!`)}else if(m&&i){console.log("Updating existing contact:",i==null?void 0:i.id);let U=Z.company_id;if((ne=Z.companyName)!=null&&ne.trim()&&!U){console.log("Creating new company for update:",Z.companyName);try{const K=await(Wt==null?void 0:Wt.searchCompanies((pe=Z.companyName)==null?void 0:pe.trim())),H=K==null?void 0:K.find(oe=>{var J,le,he;return((J=oe.name)==null?void 0:J.toLowerCase())===((he=(le=Z.companyName)==null?void 0:le.trim())==null?void 0:he.toLowerCase())});if(H)console.log("Found existing company:",H),U=H.id;else{const oe=await(Wt==null?void 0:Wt.createCompany({name:(W=Z.companyName)==null?void 0:W.trim()}));console.log("Created new company:",oe),U=oe.id}}catch(K){throw console.error("Error handling company:",K),new Error(`Failed to create company "${Z.companyName}": ${K.message}`)}}const{companyName:se,...te}={...Z,company_id:U||null,owner_id:Z.owner_id||(e==null?void 0:e.id)};Object.keys(te).forEach(K=>{te[K]===""&&["company_id"].includes(K)&&(te[K]=null)}),console.log("Cleaned data for update:",te),re=await(Nt==null?void 0:Nt.updateContact(i==null?void 0:i.id,te)),console.log("Update result:",re),E(`Contact "${re==null?void 0:re.first_name} ${re==null?void 0:re.last_name}" updated successfully!`)}else console.log("No valid action - missing conditions:",{isAddingContact:f,isEditingContact:m,hasSelectedContact:!!i});o(re),h(!1),x(!1),M()}catch(re){console.error("Error saving contact:",re);let U="Failed to save contact. Please try again.";re!=null&&re.message&&(Array.isArray(re.message)?U=re.message.map(se=>se.msg||se.message||se).join(", "):typeof re.message=="string"&&(U=re.message)),console.log("Setting error message:",U),T(U)}},L=()=>{h(!1),x(!1),i===null&&(t==null?void 0:t.length)>0&&o(t==null?void 0:t[0])},C=async Z=>{const ce=t==null?void 0:t.find(ne=>(ne==null?void 0:ne.id)===Z),ie=ce?`${ce.first_name} ${ce.last_name}`:"this contact";if(window.confirm(`Are you sure you want to delete ${ie}?

This action cannot be undone`))try{T(""),await(Nt==null?void 0:Nt.deleteContact(Z)),E("Contact deleted successfully!");const ne=t==null?void 0:t.filter(pe=>(pe==null?void 0:pe.id)!==Z);r(ne),i&&(i==null?void 0:i.id)===Z&&o((ne==null?void 0:ne.length)>0?ne==null?void 0:ne[0]:null),l(pe=>pe==null?void 0:pe.filter(W=>W!==Z))}catch(ne){console.error("Error deleting contact:",ne),T("Failed to delete contact. Please try again.")}},k=async()=>{if(window.confirm(`Are you sure you want to delete ${c==null?void 0:c.length} contact(s)?

This action cannot be undone and will permanently remove:
 All contact information
 All associated activities
 All associated deals
 All notes and tasks`))try{T(""),await(Nt==null?void 0:Nt.deleteContacts(c)),E(`${c==null?void 0:c.length} contact(s) deleted successfully!`);const ce=t==null?void 0:t.filter(ie=>!(c!=null&&c.includes(ie==null?void 0:ie.id)));r(ce),i&&(c!=null&&c.includes(i==null?void 0:i.id))&&o((ce==null?void 0:ce.length)>0?ce==null?void 0:ce[0]:null),l([])}catch(ce){console.error("Error deleting contacts:",ce),T("Failed to delete contacts. Please try again.")}},z=Z=>{const ce=t.map(ie=>ie.id===Z.id?Z:ie);r(ce),i&&i.id===Z.id&&o(Z)},V=async Z=>{var ce;try{T(""),a(!0),console.log("Calling import API with contacts:",Z);const ie=await(Nt==null?void 0:Nt.importContacts(Z));if(console.log("Import result:",ie),(ie==null?void 0:ie.error_count)>0&&((ce=ie==null?void 0:ie.errors)==null?void 0:ce.length)>0){console.error("Import errors:",ie.errors),T(`Import failed with ${ie.error_count} errors: ${ie.errors.join(", ")}`),a(!1);return}g(!1),await M(),E(`${(ie==null?void 0:ie.imported_count)||(Z==null?void 0:Z.length)} contact(s) imported successfully!`),a(!1)}catch(ie){console.error("Error importing contacts:",ie),T((ie==null?void 0:ie.message)||"Failed to import contacts. Please try again."),a(!1)}};return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(Ta,{}),s.jsx("main",{className:"pt-16",children:s.jsx("div",{className:"px-6 py-8",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx(Ki,{}),s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-text-primary",children:"Contact Management"}),s.jsx("p",{className:"text-text-secondary mt-1",children:"Manage your customer relationships and communication history"})]}),s.jsxs("div",{className:"flex flex-wrap gap-3 mt-4 md:mt-0",children:[s.jsxs("div",{className:"inline-flex items-center border border-border rounded-lg bg-surface",children:[s.jsx("button",{onClick:()=>D("grid"),className:`inline-flex items-center space-x-2 px-3 py-2 rounded-l-lg transition-all duration-150 ${N==="grid"?"bg-primary text-white":"text-text-secondary hover:text-text-primary hover:bg-surface-hover"}`,title:"Grid View",children:s.jsx(G,{name:"Grid",size:18})}),s.jsx("button",{onClick:()=>D("split"),className:`inline-flex items-center space-x-2 px-3 py-2 rounded-r-lg transition-all duration-150 ${N==="split"?"bg-primary text-white":"text-text-secondary hover:text-text-primary hover:bg-surface-hover"}`,title:"List View",children:s.jsx(G,{name:"List",size:18})})]}),Xo.hasPermission(e==null?void 0:e.role,"contacts","create")&&s.jsxs("button",{onClick:O,className:"btn-primary inline-flex items-center space-x-2",children:[s.jsx(G,{name:"UserPlus",size:18}),s.jsx("span",{children:"Add Contact"})]}),Xo.hasPermission(e==null?void 0:e.role,"contacts","import_export")&&s.jsxs("button",{onClick:()=>g(!0),className:"inline-flex items-center space-x-2 px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-out",children:[s.jsx(G,{name:"Upload",size:18}),s.jsx("span",{children:"Import"})]})]})]}),A&&s.jsxs("div",{className:"bg-success-50 border border-success-200 text-success p-4 rounded-lg flex items-center space-x-2 mb-6",children:[s.jsx(G,{name:"CheckCircle",size:20}),s.jsx("span",{children:A}),s.jsx("button",{onClick:()=>E(""),className:"ml-auto text-success hover:text-success-600",children:s.jsx(G,{name:"X",size:16})})]}),S&&s.jsxs("div",{className:"bg-error-50 border border-error-200 text-error p-4 rounded-lg flex items-center space-x-2 mb-6",children:[s.jsx(G,{name:"AlertCircle",size:20}),s.jsx("span",{children:S}),s.jsx("button",{onClick:()=>T(""),className:"ml-auto text-error hover:text-error-600",children:s.jsx(G,{name:"X",size:16})})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"relative mb-4",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(G,{name:"Search",size:18,className:"text-text-tertiary"})}),s.jsx("input",{type:"text",placeholder:"Search contacts by name, email, or company...",value:u,onChange:Z=>{var ce;return d((ce=Z==null?void 0:Z.target)==null?void 0:ce.value)},className:"input-field pl-10"})]}),s.jsxs("div",{className:"flex border-b border-border",children:[s.jsx("button",{onClick:()=>j("all"),className:`px-4 py-2 text-sm font-medium ${w==="all"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:"All Contacts"}),s.jsx("button",{onClick:()=>j("active"),className:`px-4 py-2 text-sm font-medium ${w==="active"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:"Active"}),s.jsx("button",{onClick:()=>j("inactive"),className:`px-4 py-2 text-sm font-medium ${w==="inactive"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:"Inactive"}),s.jsx("button",{onClick:()=>j("my"),className:`px-4 py-2 text-sm font-medium ${w==="my"?"text-primary border-b-2 border-primary":"text-text-secondary hover:text-text-primary"}`,children:"My Contacts"})]})]}),n?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),s.jsx("span",{className:"text-text-secondary",children:"Loading contacts..."})]})}):N==="grid"?s.jsx("div",{className:"bg-surface rounded-lg border border-border shadow-sm p-6",children:s.jsx(uRe,{contacts:P,onContactSelect:X,onDeleteContact:C})}):s.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[s.jsx("div",{className:"w-full lg:w-1/3 xl:w-1/4",children:s.jsxs("div",{className:"bg-surface rounded-lg border border-border shadow-sm",children:[s.jsxs("div",{className:"p-4 border-b border-border flex items-center justify-between",children:[s.jsxs("button",{onClick:B,className:"flex items-center space-x-2 text-text-secondary hover:text-text-primary transition-colors",title:"Back to grid view",children:[s.jsx(G,{name:"ArrowLeft",size:16}),s.jsx("span",{className:"text-sm",children:"Back to Grid"})]}),(c==null?void 0:c.length)>0&&s.jsxs("div",{className:"flex space-x-2",children:[Xo.hasPermission(e==null?void 0:e.role,"contacts","import_export")&&s.jsx("button",{onClick:()=>y(!0),className:"text-text-secondary hover:text-text-primary",title:"Export Selected",children:s.jsx(G,{name:"Download",size:16})}),Xo.hasPermission(e==null?void 0:e.role,"contacts","delete_own")&&s.jsx("button",{onClick:k,className:"text-error hover:text-error-600",title:"Delete Selected",children:s.jsx(G,{name:"Trash2",size:16})}),(c==null?void 0:c.length)===2&&Xo.hasPermission(e==null?void 0:e.role,"contacts","merge_duplicates")&&s.jsx("button",{onClick:()=>_(!0),className:"text-text-secondary hover:text-text-primary",title:"Merge Contacts",children:s.jsx(G,{name:"GitMerge",size:16})})]})]}),s.jsx(lRe,{contacts:P,selectedContact:i,selectedContacts:c,onContactSelect:X,onContactMultiSelect:q,onDeleteContact:C})]})}),s.jsx("div",{className:"w-full lg:w-2/3 xl:w-3/4",children:f||m?s.jsx(yRe,{contact:m?i:null,onSubmit:I,onCancel:L,isEditing:m}):i?s.jsx(vRe,{contact:i,onEdit:F,onDelete:()=>C(i==null?void 0:i.id),onContactUpdate:z}):s.jsxs("div",{className:"bg-surface rounded-lg border border-border shadow-sm p-8 text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-primary-50 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(G,{name:"Users",size:24,className:"text-primary"})}),s.jsx("h3",{className:"text-xl font-semibold text-text-primary mb-2",children:"No Contact Selected"}),s.jsx("p",{className:"text-text-secondary mb-6",children:"Select a contact from the list or add a new one to get started."}),s.jsxs("button",{onClick:O,className:"btn-primary inline-flex items-center space-x-2",children:[s.jsx(G,{name:"UserPlus",size:18}),s.jsx("span",{children:"Add New Contact"})]})]})})]})]})})}),p&&s.jsx(bRe,{onImport:V,onClose:()=>g(!1)}),v&&s.jsx(wRe,{contacts:t==null?void 0:t.filter(Z=>c==null?void 0:c.includes(Z==null?void 0:Z.id)),onClose:()=>y(!1)}),b&&(c==null?void 0:c.length)===2&&s.jsx(_Re,{contact1:t==null?void 0:t.find(Z=>(Z==null?void 0:Z.id)===(c==null?void 0:c[0])),contact2:t==null?void 0:t.find(Z=>(Z==null?void 0:Z.id)===(c==null?void 0:c[1])),onMerge:Z=>{const ce=t==null?void 0:t.filter(ie=>!(c!=null&&c.includes(ie==null?void 0:ie.id)));r([...ce,Z]),o(Z),l([]),_(!1)},onClose:()=>_(!1)})]})},G4=({companies:e,onCompanySelect:t,onDeleteCompany:r,onEditCompany:n,selectedCompanies:a=[],onMultiSelect:i,onSelectAll:o,compact:c=!1})=>{const{hasPermission:l}=Pt(),u=h=>{if(!h)return"Never";try{const m=new Date(h);return eD(m,{addSuffix:!0})}catch{return"Invalid date"}},d=h=>({technology:"Laptop",healthcare:"Heart",finance:"DollarSign",retail:"ShoppingCart",manufacturing:"Settings",education:"GraduationCap","real estate":"Home",consulting:"Briefcase",media:"Tv",transportation:"Truck"})[h==null?void 0:h.toLowerCase()]||"Building2",f=h=>({small:"bg-blue-100 text-blue-700",medium:"bg-green-100 text-green-700",large:"bg-purple-100 text-purple-700",enterprise:"bg-orange-100 text-orange-700"})[h==null?void 0:h.toLowerCase()]||"bg-gray-100 text-gray-700";return(e==null?void 0:e.length)===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"w-16 h-16 bg-primary-50 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(G,{name:"Building2",size:24,className:"text-primary"})}),s.jsx("h3",{className:"text-xl font-semibold text-text-primary mb-2",children:"No Companies Found"}),s.jsx("p",{className:"text-text-secondary",children:"Try adjusting your search or filters, or add a new company."})]}):s.jsx("div",{className:c?"space-y-3":"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:e==null?void 0:e.map(h=>{var m,x;return s.jsx("div",{className:`bg-surface rounded-lg border border-border shadow-sm hover:shadow-md transition-all duration-200 cursor-pointer group overflow-hidden ${c?"flex items-center p-4":""}`,onClick:()=>t==null?void 0:t(h),children:c?s.jsxs(s.Fragment,{children:[i&&s.jsx("div",{className:"mr-3",onClick:p=>p.stopPropagation(),children:s.jsx("input",{type:"checkbox",checked:a==null?void 0:a.includes(h==null?void 0:h.id),onChange:()=>i(h==null?void 0:h.id),className:"w-4 h-4 text-primary border-border rounded focus:ring-primary"})}),s.jsx("div",{className:"w-10 h-10 bg-primary-50 rounded-lg flex items-center justify-center mr-3 flex-shrink-0",children:s.jsx(G,{name:d(h==null?void 0:h.industry),size:20,className:"text-primary"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"font-semibold text-text-primary truncate",children:h==null?void 0:h.name}),s.jsxs("p",{className:"text-sm text-text-secondary truncate",children:[(h==null?void 0:h.industry)||"No industry","  ",(h==null?void 0:h.size)||"Unknown size"]})]}),s.jsxs("div",{className:"flex items-center space-x-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[(l("companies.edit_all")||l("companies.edit_own"))&&s.jsx("button",{onClick:p=>{p.stopPropagation(),n==null||n(h)},className:"p-1.5 rounded-lg text-text-tertiary hover:text-primary hover:bg-primary-50 transition-colors",title:"Edit company",children:s.jsx(G,{name:"Edit2",size:16})}),(l("companies.delete_all")||l("companies.delete_own"))&&s.jsx("button",{onClick:p=>{p.stopPropagation(),window.confirm("Are you sure you want to delete this company?")&&(r==null||r(h==null?void 0:h.id))},className:"p-1.5 rounded-lg text-text-tertiary hover:text-error hover:bg-error-50 transition-colors",title:"Delete company",children:s.jsx(G,{name:"Trash2",size:16})})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"relative p-6 pb-4 bg-gradient-to-br from-primary-50 to-primary-100 dark:from-primary-900/20 dark:to-primary-800/20",children:[s.jsxs("div",{className:"absolute top-3 right-3 flex items-center space-x-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[(l("companies.edit_all")||l("companies.edit_own"))&&s.jsx("button",{onClick:p=>{p.stopPropagation(),n==null||n(h)},className:"p-1.5 rounded-lg bg-surface/80 backdrop-blur-sm text-text-tertiary hover:text-primary hover:bg-primary-50 transition-all",title:"Edit company",children:s.jsx(G,{name:"Edit2",size:16})}),(l("companies.delete_all")||l("companies.delete_own"))&&s.jsx("button",{onClick:p=>{p.stopPropagation(),window.confirm("Are you sure you want to delete this company?")&&(r==null||r(h==null?void 0:h.id))},className:"p-1.5 rounded-lg bg-surface/80 backdrop-blur-sm text-text-tertiary hover:text-error hover:bg-error-50 transition-all",title:"Delete company",children:s.jsx(G,{name:"Trash2",size:16})})]}),i&&s.jsx("div",{className:"absolute top-3 left-3",onClick:p=>p.stopPropagation(),children:s.jsx("input",{type:"checkbox",checked:a==null?void 0:a.includes(h==null?void 0:h.id),onChange:()=>i(h==null?void 0:h.id),className:"w-4 h-4 text-primary border-border rounded focus:ring-primary"})}),s.jsx("div",{className:"flex justify-center mb-3",children:s.jsx("div",{className:"relative",children:h!=null&&h.logo_url?s.jsx(Ts,{src:h.logo_url,alt:h.name,className:"w-20 h-20 rounded-full object-cover border-4 border-surface shadow-md"}):s.jsx("div",{className:"w-20 h-20 rounded-full bg-surface border-4 border-surface shadow-md flex items-center justify-center",children:s.jsx(G,{name:d(h==null?void 0:h.industry),size:32,className:"text-primary"})})})}),s.jsx("h3",{className:"text-center text-lg font-semibold text-text-primary truncate px-8",children:(h==null?void 0:h.name)||"Unnamed Company"}),(h==null?void 0:h.industry)&&s.jsx("div",{className:"flex justify-center mt-2",children:s.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-surface border border-border",children:h.industry})})]}),s.jsxs("div",{className:"p-4 space-y-3",children:[(h==null?void 0:h.size)&&s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-text-secondary",children:"Size:"}),s.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${f(h.size)}`,children:h.size})]}),((h==null?void 0:h.city)||(h==null?void 0:h.state)||(h==null?void 0:h.country))&&s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(G,{name:"MapPin",size:14,className:"text-text-tertiary flex-shrink-0 mt-0.5"}),s.jsx("span",{className:"text-sm text-text-secondary truncate",children:[h==null?void 0:h.city,h==null?void 0:h.state,h==null?void 0:h.country].filter(Boolean).join(", ")})]}),(h==null?void 0:h.website)&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"Globe",size:14,className:"text-text-tertiary flex-shrink-0"}),s.jsx("a",{href:h.website.startsWith("http")?h.website:`https://${h.website}`,target:"_blank",rel:"noopener noreferrer",onClick:p=>p.stopPropagation(),className:"text-sm text-primary hover:underline truncate",children:h.website.replace(/^https?:\/\//i,"")})]}),(h==null?void 0:h.phone)&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"Phone",size:14,className:"text-text-tertiary flex-shrink-0"}),s.jsx("span",{className:"text-sm text-text-secondary truncate",children:h.phone})]}),(h==null?void 0:h.email)&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"Mail",size:14,className:"text-text-tertiary flex-shrink-0"}),s.jsx("span",{className:"text-sm text-text-secondary truncate",children:h.email})]}),(h==null?void 0:h.revenue)&&s.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-border",children:[s.jsx("span",{className:"text-sm text-text-secondary",children:"Revenue:"}),s.jsxs("span",{className:"text-sm font-semibold text-success",children:["$",h.revenue.toLocaleString()]})]}),s.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-border text-xs",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(G,{name:"Users",size:12,className:"text-text-tertiary"}),s.jsxs("span",{className:"text-text-secondary",children:[((m=h==null?void 0:h.contacts)==null?void 0:m.length)||0," contacts"]})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(G,{name:"Target",size:12,className:"text-text-tertiary"}),s.jsxs("span",{className:"text-text-secondary",children:[((x=h==null?void 0:h.deals)==null?void 0:x.length)||0," deals"]})]})]}),s.jsx("div",{className:"flex items-center justify-center pt-2 border-t border-border",children:s.jsxs("span",{className:"text-xs text-text-tertiary",children:["Created ",u(h==null?void 0:h.created_at)]})})]})]})},h==null?void 0:h.id)})})},NRe=({company:e,onEdit:t,onDelete:r,onClose:n})=>{const[a,i]=R.useState("overview"),[o,c]=R.useState([]),[l,u]=R.useState(!1),[d,f]=R.useState([]),[h,m]=R.useState(!1),{hasPermission:x}=Pt();if(!e)return null;R.useEffect(()=>{(async()=>{if(e!=null&&e.id)try{u(!0);const w=(await Nt.getUserContacts()).filter(j=>j.company_id===e.id);c(w)}catch(_){console.error("Error fetching company contacts:",_),c([])}finally{u(!1)}})()},[e==null?void 0:e.id]),R.useEffect(()=>{(async()=>{if(e!=null&&e.id)try{m(!0);const w=(await ut.getUserDeals()).filter(j=>j.company_id===e.id);f(w)}catch(_){console.error("Error fetching company deals:",_),f([])}finally{m(!1)}})()},[e==null?void 0:e.id]);const p=b=>{if(!b)return"N/A";try{return Ga(new Date(b),"MMM d, yyyy")}catch{return"Invalid date"}},v=(()=>{const b=d.reduce((S,T)=>{const A=typeof T.value=="string"?parseFloat(T.value):T.value||0;return S+(isNaN(A)?0:A)},0),_=d.filter(S=>S.stage&&S.stage.toLowerCase()==="closed_won").length,w=d.filter(S=>S.stage&&S.stage.toLowerCase()==="closed_lost").length,j=d.filter(S=>!S.stage||!["closed_won","closed_lost"].includes(S.stage.toLowerCase())).length,N=_+w,D=N>0?(_/N*100).toFixed(1):0;return{totalValue:b,wonDeals:_,lostDeals:w,activeDeals:j,winRate:D}})(),y=b=>({technology:"Laptop",healthcare:"Heart",finance:"DollarSign",retail:"ShoppingCart",manufacturing:"Settings",education:"GraduationCap","real estate":"Home",consulting:"Briefcase",media:"Tv",transportation:"Truck"})[b==null?void 0:b.toLowerCase()]||"Building2";return s.jsxs("div",{className:"h-full flex flex-col",children:[s.jsxs("div",{className:"flex-shrink-0 p-6 border-b border-border bg-gradient-to-br from-primary-50 to-primary-100 dark:from-primary-900/20 dark:to-primary-800/20",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-start space-x-4 flex-1",children:[e!=null&&e.logo_url?s.jsx(Ts,{src:e.logo_url,alt:e.name,className:"w-20 h-20 rounded-lg object-cover border-4 border-surface shadow-md"}):s.jsx("div",{className:"w-20 h-20 rounded-lg bg-surface border-4 border-surface shadow-md flex items-center justify-center",children:s.jsx(G,{name:y(e==null?void 0:e.industry),size:32,className:"text-primary"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:(e==null?void 0:e.name)||"Unnamed Company"}),(e==null?void 0:e.industry)&&s.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-surface border border-border",children:e.industry})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[(x("companies.edit_all")||x("companies.edit_own"))&&s.jsx("button",{onClick:t,className:"p-2 text-text-secondary hover:text-primary hover:bg-primary-50 rounded-lg transition-colors",title:"Edit company",children:s.jsx(G,{name:"Edit2",size:20})}),(x("companies.delete_all")||x("companies.delete_own"))&&s.jsx("button",{onClick:r,className:"p-2 text-text-secondary hover:text-error hover:bg-error-50 rounded-lg transition-colors",title:"Delete company",children:s.jsx(G,{name:"Trash2",size:20})}),s.jsx("button",{onClick:n,className:"p-2 text-text-secondary hover:text-text-primary rounded-lg transition-colors",title:"Close",children:s.jsx(G,{name:"X",size:20})})]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-4 mt-4",children:[s.jsxs("div",{className:"bg-surface rounded-lg p-3 border border-border",children:[s.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Contacts"}),s.jsx("div",{className:"text-xl font-bold text-text-primary",children:o.length})]}),s.jsxs("div",{className:"bg-surface rounded-lg p-3 border border-border",children:[s.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Deals"}),s.jsx("div",{className:"text-xl font-bold text-text-primary",children:d.length})]}),s.jsxs("div",{className:"bg-surface rounded-lg p-3 border border-border",children:[s.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Deal Value"}),s.jsxs("div",{className:"text-xl font-bold text-success",children:["$",v.totalValue.toLocaleString()]})]}),s.jsxs("div",{className:"bg-surface rounded-lg p-3 border border-border",children:[s.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Win Rate"}),s.jsxs("div",{className:"text-xl font-bold text-text-primary",children:[v.winRate,"%"]})]})]})]}),s.jsx("div",{className:"flex-shrink-0 border-b border-border bg-surface",children:s.jsx("div",{className:"px-6",children:s.jsxs("div",{className:"flex space-x-6",children:[s.jsx("button",{onClick:()=>i("overview"),className:`py-3 px-1 border-b-2 transition-colors ${a==="overview"?"border-primary text-primary font-medium":"border-transparent text-text-secondary hover:text-text-primary"}`,children:"Overview"}),s.jsxs("button",{onClick:()=>i("contacts"),className:`py-3 px-1 border-b-2 transition-colors ${a==="contacts"?"border-primary text-primary font-medium":"border-transparent text-text-secondary hover:text-text-primary"}`,children:["Contacts (",o.length,")"]}),s.jsxs("button",{onClick:()=>i("deals"),className:`py-3 px-1 border-b-2 transition-colors ${a==="deals"?"border-primary text-primary font-medium":"border-transparent text-text-secondary hover:text-text-primary"}`,children:["Deals (",d.length,")"]}),s.jsx("button",{onClick:()=>i("insights"),className:`py-3 px-1 border-b-2 transition-colors ${a==="insights"?"border-primary text-primary font-medium":"border-transparent text-text-secondary hover:text-text-primary"}`,children:"Insights"})]})})}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[a==="overview"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[s.jsx(G,{name:"Building2",size:20,className:"mr-2"}),"Company Information"]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[(e==null?void 0:e.size)&&s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"Company Size"}),s.jsx("div",{className:"text-text-primary",children:e.size})]}),(e==null?void 0:e.revenue)&&s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"Annual Revenue"}),s.jsxs("div",{className:"text-text-primary",children:["$",e.revenue.toLocaleString()]})]}),(e==null?void 0:e.website)&&s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"Website"}),s.jsxs("a",{href:e.website.startsWith("http")?e.website:`https://${e.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline flex items-center space-x-1",children:[s.jsx(G,{name:"Globe",size:14}),s.jsx("span",{children:e.website.replace(/^https?:\/\//i,"")})]})]}),(e==null?void 0:e.created_at)&&s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"Added"}),s.jsx("div",{className:"text-text-primary",children:p(e.created_at)})]})]})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[s.jsx(G,{name:"Phone",size:20,className:"mr-2"}),"Contact Information"]}),s.jsxs("div",{className:"space-y-3",children:[(e==null?void 0:e.phone)&&s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(G,{name:"Phone",size:16,className:"text-text-tertiary"}),s.jsx("a",{href:`tel:${e.phone}`,className:"text-primary hover:underline",children:e.phone})]}),(e==null?void 0:e.email)&&s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(G,{name:"Mail",size:16,className:"text-text-tertiary"}),s.jsx("a",{href:`mailto:${e.email}`,className:"text-primary hover:underline",children:e.email})]}),((e==null?void 0:e.address)||(e==null?void 0:e.city)||(e==null?void 0:e.state)||(e==null?void 0:e.country))&&s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(G,{name:"MapPin",size:16,className:"text-text-tertiary mt-0.5"}),s.jsxs("div",{className:"text-text-primary",children:[(e==null?void 0:e.address)&&s.jsx("div",{children:e.address}),((e==null?void 0:e.city)||(e==null?void 0:e.state)||(e==null?void 0:e.zip_code))&&s.jsx("div",{children:[e==null?void 0:e.city,e==null?void 0:e.state,e==null?void 0:e.zip_code].filter(Boolean).join(", ")}),(e==null?void 0:e.country)&&s.jsx("div",{children:e.country})]})]})]})]}),(e==null?void 0:e.description)&&s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[s.jsx(G,{name:"FileText",size:20,className:"mr-2"}),"Description"]}),s.jsx("p",{className:"text-text-secondary whitespace-pre-wrap",children:e.description})]}),(e==null?void 0:e.custom_fields)&&Object.keys(e.custom_fields).length>0&&s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[s.jsx(G,{name:"Settings",size:20,className:"mr-2"}),"Additional Information"]}),s.jsx("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(e.custom_fields).map(([b,_])=>s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-text-secondary mb-1",children:_.name||b}),s.jsx("div",{className:"text-text-primary",children:_.value!==null&&_.value!==void 0?String(_.value):"N/A"})]},b))})]})]}),a==="contacts"&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Associated Contacts"}),x("contacts.create")&&s.jsxs(hr,{to:"/contact-management",className:"text-primary hover:underline text-sm flex items-center space-x-1",children:[s.jsx(G,{name:"Plus",size:14}),s.jsx("span",{children:"Add Contact"})]})]}),l?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):o.length>0?s.jsx("div",{className:"space-y-3",children:o.map(b=>s.jsx(hr,{to:`/contact-management?contactId=${b.id}`,className:"block p-4 bg-surface border border-border rounded-lg hover:shadow-md transition-all",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Ts,{src:(b==null?void 0:b.avatar_url)||"/assets/images/no_image.png",alt:b.full_name,className:"w-10 h-10 rounded-full object-cover"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-text-primary",children:b.full_name}),s.jsx("div",{className:"text-sm text-text-secondary",children:b.position||"No position"})]})]}),s.jsxs("div",{className:"flex items-center space-x-4 text-sm text-text-secondary",children:[b.email&&s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(G,{name:"Mail",size:14}),s.jsx("span",{children:b.email})]}),b.phone&&s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(G,{name:"Phone",size:14}),s.jsx("span",{children:b.phone})]})]})]})},b.id))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(G,{name:"Users",size:32,className:"text-text-tertiary mx-auto mb-2"}),s.jsx("p",{className:"text-text-secondary",children:"No contacts associated with this company"})]})]}),a==="deals"&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Associated Deals"}),x("deals.create")&&s.jsxs(hr,{to:"/deal-management/new",className:"text-primary hover:underline text-sm flex items-center space-x-1",children:[s.jsx(G,{name:"Plus",size:14}),s.jsx("span",{children:"Add Deal"})]})]}),h?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):d.length>0?s.jsx("div",{className:"space-y-3",children:d.map(b=>{var _,w;return s.jsxs(hr,{to:`/deal-management/${b.id}`,className:"block p-4 bg-surface border border-border rounded-lg hover:shadow-md transition-all",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("div",{className:"font-medium text-text-primary",children:b.name}),s.jsxs("div",{className:"text-success font-semibold",children:["$",((_=b.value)==null?void 0:_.toLocaleString())||0]})]}),s.jsxs("div",{className:"flex items-center justify-between text-sm text-text-secondary",children:[s.jsx("span",{className:"capitalize",children:(w=b.stage)==null?void 0:w.replace("_"," ")}),s.jsx("span",{children:p(b.expected_close_date)})]})]},b.id)})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(G,{name:"Target",size:32,className:"text-text-tertiary mx-auto mb-2"}),s.jsx("p",{className:"text-text-secondary",children:"No deals associated with this company"})]})]}),a==="insights"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Company Insights"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"p-4 bg-success-50 border border-success-200 rounded-lg",children:[s.jsx("div",{className:"text-sm text-success-700 mb-1",children:"Won Deals"}),s.jsx("div",{className:"text-2xl font-bold text-success",children:v.wonDeals})]}),s.jsxs("div",{className:"p-4 bg-error-50 border border-error-200 rounded-lg",children:[s.jsx("div",{className:"text-sm text-error-700 mb-1",children:"Lost Deals"}),s.jsx("div",{className:"text-2xl font-bold text-error",children:v.lostDeals})]}),s.jsxs("div",{className:"p-4 bg-primary-50 border border-primary-200 rounded-lg",children:[s.jsx("div",{className:"text-sm text-primary-700 mb-1",children:"Active Deals"}),s.jsx("div",{className:"text-2xl font-bold text-primary",children:v.activeDeals})]}),s.jsxs("div",{className:"p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[s.jsx("div",{className:"text-sm text-orange-700 mb-1",children:"Total Deal Value"}),s.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:["$",v.totalValue.toLocaleString()]})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Engagement Summary"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-text-secondary",children:"Total Contacts:"}),s.jsx("span",{className:"font-medium text-text-primary",children:o.length})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-text-secondary",children:"Total Deals:"}),s.jsx("span",{className:"font-medium text-text-primary",children:d.length})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-text-secondary",children:"Win Rate:"}),s.jsxs("span",{className:"font-medium text-text-primary",children:[v.winRate,"%"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-text-secondary",children:"Average Deal Value:"}),s.jsxs("span",{className:"font-medium text-text-primary",children:["$",d.length>0?(v.totalValue/d.length).toLocaleString(void 0,{maximumFractionDigits:0}):0]})]})]})]})]})]})]})},DRe=({company:e=null,onSubmit:t,onCancel:r})=>{const{user:n}=Pt(),[a,i]=R.useState(!1),[o,c]=R.useState([]),[l,u]=R.useState({}),[d,f]=R.useState(!1),[h,m]=R.useState({name:"",industry:"",size:"",website:"",phone:"",email:"",address:"",city:"",state:"",zip_code:"",country:"",description:"",revenue:"",owner_id:(n==null?void 0:n.id)||""}),[x,p]=R.useState({}),g=["Technology","Healthcare","Finance","Retail","Manufacturing","Education","Real Estate","Consulting","Media","Transportation","Energy","Hospitality","Telecommunications","Agriculture","Construction","Legal","Other"],v=["Small (1-50)","Medium (51-250)","Large (251-1000)","Enterprise (1000+)"];R.useEffect(()=>{if(y(),e)if(m({name:(e==null?void 0:e.name)||"",industry:(e==null?void 0:e.industry)||"",size:(e==null?void 0:e.size)||"",website:(e==null?void 0:e.website)||"",phone:(e==null?void 0:e.phone)||"",email:(e==null?void 0:e.email)||"",address:(e==null?void 0:e.address)||"",city:(e==null?void 0:e.city)||"",state:(e==null?void 0:e.state)||"",zip_code:(e==null?void 0:e.zip_code)||"",country:(e==null?void 0:e.country)||"",description:(e==null?void 0:e.description)||"",revenue:(e==null?void 0:e.revenue)||"",owner_id:(e==null?void 0:e.owner_id)||(n==null?void 0:n.id)||""}),e!=null&&e.custom_fields){const D={};Object.entries(e.custom_fields).forEach(([S,T])=>{(T==null?void 0:T.value)!==null&&(T==null?void 0:T.value)!==void 0&&(D[S]=T.value)}),u(D)}else e!=null&&e.id&&b(e.id)},[e,n]);const y=async()=>{f(!0);try{const D=await vi.getAllFields({entity_type:"company",is_active:!0}),S=D==null?void 0:D.filter(T=>T.placement==="form"||T.placement==="both");c(S||[])}catch(D){console.error("Error loading custom fields:",D)}finally{f(!1)}},b=async D=>{try{const S=await vi.getEntityCustomFields("company",D),T={};S==null||S.forEach(A=>{T[A.field_key]=A.current_value}),u(T)}catch(S){console.error("Error loading custom field values:",S)}},_=D=>{const{name:S,value:T}=D.target;m(A=>({...A,[S]:T})),x[S]&&p(A=>({...A,[S]:null}))},w=(D,S)=>{console.log("handleCustomFieldChange called:",{fieldKey:D,value:S}),u(T=>({...T,[D]:S}))},j=()=>{var S;const D={};return console.log("Validating form with data:",h),console.log("Custom fields for validation:",o),console.log("Custom field values for validation:",l),(S=h.name)!=null&&S.trim()||(D.name="Company name is required"),h.email&&!h.email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)&&(D.email="Please enter a valid email address"),h.website&&!h.website.match(/^[a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0-9]?\.[a-zA-Z]{2,}$/)&&h.website.match(/^https?:\/\//),h.revenue&&isNaN(h.revenue)&&(D.revenue="Revenue must be a number"),o==null||o.forEach(T=>{const A=T.field_key||T.id;console.log(`Checking custom field: ${T.name}, required: ${T.is_required}, field_key: ${A}, value:`,l[A]),T.is_required&&!l[A]&&(D[`custom_${A}`]=`${T.name} is required`)}),console.log("Validation result:",D),D},N=async D=>{D.preventDefault(),console.log("CompanyForm handleSubmit called"),console.log("Form data:",h),console.log("Custom field values:",l);const S=j();if(console.log("Validation errors:",S),Object.keys(S).length>0){p(S),console.log("Form validation failed, not submitting");return}i(!0);try{const T={...h,revenue:h.revenue?parseInt(h.revenue):null,custom_fields:l};console.log("Submitting data:",T),await t(T),console.log("Form submitted successfully")}catch(T){console.error("Error submitting form:",T),p({submit:(T==null?void 0:T.message)||"Failed to save company"})}finally{i(!1)}};return s.jsxs("form",{onSubmit:N,className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:e?"Edit Company":"Add New Company"}),s.jsx("button",{type:"button",onClick:r,className:"p-2 text-text-tertiary hover:text-text-primary transition-colors",children:s.jsx(G,{name:"X",size:20})})]}),x.submit&&s.jsxs("div",{className:"mb-6 p-4 bg-error-50 border border-error-200 rounded-lg flex items-start space-x-3",children:[s.jsx(G,{name:"AlertCircle",size:20,className:"text-error flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-error font-medium",children:"Error"}),s.jsx("p",{className:"text-error-600 text-sm",children:x.submit})]})]}),s.jsxs("div",{className:"space-y-6 max-h-[calc(100vh-250px)] overflow-y-auto pr-2",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[s.jsx(G,{name:"Building2",size:20,className:"mr-2"}),"Basic Information"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"md:col-span-2",children:[s.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-2",children:["Company Name ",s.jsx("span",{className:"text-error",children:"*"})]}),s.jsx("input",{type:"text",name:"name",value:h.name,onChange:_,placeholder:"Acme Corporation",className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary ${x.name?"border-error":"border-border"}`}),x.name&&s.jsx("p",{className:"text-error text-sm mt-1",children:x.name})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Industry"}),s.jsxs("select",{name:"industry",value:h.industry,onChange:_,className:"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",children:[s.jsx("option",{value:"",children:"Select Industry"}),g.map(D=>s.jsx("option",{value:D,children:D},D))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Company Size"}),s.jsxs("select",{name:"size",value:h.size,onChange:_,className:"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",children:[s.jsx("option",{value:"",children:"Select Size"}),v.map(D=>s.jsx("option",{value:D,children:D},D))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Website"}),s.jsx("input",{type:"text",name:"website",value:h.website,onChange:_,placeholder:"www.example.com",className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary ${x.website?"border-error":"border-border"}`}),x.website&&s.jsx("p",{className:"text-error text-sm mt-1",children:x.website})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Annual Revenue ($)"}),s.jsx("input",{type:"number",name:"revenue",value:h.revenue,onChange:_,placeholder:"1000000",className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary ${x.revenue?"border-error":"border-border"}`}),x.revenue&&s.jsx("p",{className:"text-error text-sm mt-1",children:x.revenue})]})]})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[s.jsx(G,{name:"Phone",size:20,className:"mr-2"}),"Contact Information"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Phone"}),s.jsx("input",{type:"tel",name:"phone",value:h.phone,onChange:_,placeholder:"+1 (555) 123-4567",className:"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Email"}),s.jsx("input",{type:"email",name:"email",value:h.email,onChange:_,placeholder:"info@company.com",className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary ${x.email?"border-error":"border-border"}`}),x.email&&s.jsx("p",{className:"text-error text-sm mt-1",children:x.email})]})]})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[s.jsx(G,{name:"MapPin",size:20,className:"mr-2"}),"Address"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Street Address"}),s.jsx("input",{type:"text",name:"address",value:h.address,onChange:_,placeholder:"123 Business St, Suite 100",className:"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"City"}),s.jsx("input",{type:"text",name:"city",value:h.city,onChange:_,placeholder:"San Francisco",className:"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"State / Province"}),s.jsx("input",{type:"text",name:"state",value:h.state,onChange:_,placeholder:"CA",className:"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Zip / Postal Code"}),s.jsx("input",{type:"text",name:"zip_code",value:h.zip_code,onChange:_,placeholder:"94102",className:"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Country"}),s.jsx("input",{type:"text",name:"country",value:h.country,onChange:_,placeholder:"United States",className:"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]})]})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[s.jsx(G,{name:"FileText",size:20,className:"mr-2"}),"Description"]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Company Description / Notes"}),s.jsx("textarea",{name:"description",value:h.description,onChange:_,placeholder:"Add any additional information about the company...",rows:4,className:"w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary resize-none"})]})]}),(o==null?void 0:o.length)>0&&s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[s.jsx(G,{name:"Settings",size:20,className:"mr-2"}),"Additional Information"]}),d?s.jsx("div",{className:"text-center py-4",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"})}):s.jsx(ug,{fields:o,values:l,onChange:w,errors:x})]})]}),s.jsxs("div",{className:"flex items-center justify-end space-x-3 mt-6 pt-6 border-t border-border",children:[s.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 border border-border rounded-lg text-text-secondary hover:bg-surface-hover transition-colors",disabled:a,children:"Cancel"}),s.jsxs("button",{type:"submit",className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",disabled:a,children:[a&&s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx("span",{children:a?"Saving...":e?"Update Company":"Create Company"})]})]})]})},SRe=({filters:e,onApplyFilters:t,onClearFilters:r,onClose:n})=>{var g,v;const[a,i]=R.useState(e),o=["Technology","Healthcare","Finance","Retail","Manufacturing","Education","Real Estate","Consulting","Media","Transportation","Energy","Hospitality","Telecommunications","Agriculture","Construction","Legal","Other"],c=["Small (1-50)","Medium (51-250)","Large (251-1000)","Enterprise (1000+)"],l=y=>{i(b=>({...b,industry:b.industry.includes(y)?b.industry.filter(_=>_!==y):[...b.industry,y]}))},u=y=>{i(b=>({...b,size:b.size.includes(y)?b.size.filter(_=>_!==y):[...b.size,y]}))},d=y=>{y&&!a.location.includes(y)&&i(b=>({...b,location:[...b.location,y]}))},f=y=>{i(b=>({...b,location:b.location.filter(_=>_!==y)}))},h=(y,b)=>{i(_=>({..._,revenueRange:{..._.revenueRange,[y]:b?parseInt(b):null}}))},m=()=>{t(a)},x=()=>{i({industry:[],size:[],location:[],revenueRange:null}),r()},p=a.industry.length>0||a.size.length>0||a.location.length>0||a.revenueRange&&(a.revenueRange.min||a.revenueRange.max);return s.jsxs("div",{className:"mb-6 p-6 bg-surface border border-border rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-text-primary flex items-center",children:[s.jsx(G,{name:"Filter",size:20,className:"mr-2"}),"Filter Companies"]}),s.jsx("button",{onClick:n,className:"p-1 text-text-tertiary hover:text-text-primary transition-colors",children:s.jsx(G,{name:"X",size:20})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Industry"}),s.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:o.map(y=>s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-surface-hover p-2 rounded transition-colors",children:[s.jsx("input",{type:"checkbox",checked:a.industry.includes(y),onChange:()=>l(y),className:"w-4 h-4 text-primary border-border rounded focus:ring-primary"}),s.jsx("span",{className:"text-sm text-text-secondary",children:y})]},y))})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Company Size"}),s.jsx("div",{className:"space-y-2",children:c.map(y=>s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-surface-hover p-2 rounded transition-colors",children:[s.jsx("input",{type:"checkbox",checked:a.size.includes(y),onChange:()=>u(y),className:"w-4 h-4 text-primary border-border rounded focus:ring-primary"}),s.jsx("span",{className:"text-sm text-text-secondary",children:y})]},y))})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Location"}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("input",{type:"text",placeholder:"Enter city or state",onKeyPress:y=>{y.key==="Enter"&&(d(y.target.value),y.target.value="")},className:"w-full px-3 py-2 border border-border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary"}),a.location.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:a.location.map(y=>s.jsxs("span",{className:"inline-flex items-center space-x-1 px-2 py-1 bg-primary-50 text-primary text-xs rounded-full",children:[s.jsx("span",{children:y}),s.jsx("button",{onClick:()=>f(y),className:"hover:text-primary-700",children:s.jsx(G,{name:"X",size:12})})]},y))})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Revenue Range ($)"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs text-text-secondary mb-1 block",children:"Minimum"}),s.jsx("input",{type:"number",placeholder:"0",value:((g=a.revenueRange)==null?void 0:g.min)||"",onChange:y=>h("min",y.target.value),className:"w-full px-3 py-2 border border-border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs text-text-secondary mb-1 block",children:"Maximum"}),s.jsx("input",{type:"number",placeholder:"No limit",value:((v=a.revenueRange)==null?void 0:v.max)||"",onChange:y=>h("max",y.target.value),className:"w-full px-3 py-2 border border-border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary"})]})]})]})]}),s.jsxs("div",{className:"flex items-center justify-between mt-6 pt-6 border-t border-border",children:[s.jsx("button",{onClick:x,disabled:!p,className:"text-text-secondary hover:text-text-primary disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Clear All Filters"}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("button",{onClick:n,className:"px-4 py-2 border border-border rounded-lg text-text-secondary hover:bg-surface-hover transition-colors",children:"Cancel"}),s.jsx("button",{onClick:m,className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-600 transition-colors",children:"Apply Filters"})]})]})]})},ERe=({stats:e,className:t=""})=>{if(!e)return null;const r=Object.entries(e.industries||{}).sort(([,i],[,o])=>o-i).slice(0,5),n=Object.entries(e.sizes||{}).sort(([,i],[,o])=>o-i).slice(0,4),a=i=>{const o=["bg-blue-100 text-blue-700","bg-green-100 text-green-700","bg-purple-100 text-purple-700","bg-orange-100 text-orange-700","bg-pink-100 text-pink-700"];return o[i%o.length]};return s.jsxs("div",{className:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 ${t}`,children:[s.jsxs("div",{className:"bg-surface border border-border rounded-lg p-4 hover:shadow-md transition-shadow",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("div",{className:"p-2 bg-primary-50 rounded-lg",children:s.jsx(G,{name:"Building2",size:20,className:"text-primary"})}),s.jsx("span",{className:"text-xs text-text-tertiary",children:"Total"})]}),s.jsx("div",{className:"text-2xl font-bold text-text-primary",children:e.total||0}),s.jsx("div",{className:"text-sm text-text-secondary",children:"Companies"})]}),s.jsxs("div",{className:"bg-surface border border-border rounded-lg p-4 hover:shadow-md transition-shadow",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("div",{className:"p-2 bg-success-50 rounded-lg",children:s.jsx(G,{name:"TrendingUp",size:20,className:"text-success"})}),s.jsx("span",{className:"text-xs text-text-tertiary",children:"Last 30 days"})]}),s.jsx("div",{className:"text-2xl font-bold text-text-primary",children:e.recentlyAdded||0}),s.jsx("div",{className:"text-sm text-text-secondary",children:"Recently Added"})]}),s.jsxs("div",{className:"bg-surface border border-border rounded-lg p-4 hover:shadow-md transition-shadow",children:[s.jsx("div",{className:"flex items-center justify-between mb-3",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"p-2 bg-purple-50 rounded-lg",children:s.jsx(G,{name:"Briefcase",size:20,className:"text-purple-600"})}),s.jsx("span",{className:"text-sm font-medium text-text-primary",children:"Top Industries"})]})}),s.jsx("div",{className:"space-y-2",children:r.length>0?r.slice(0,3).map(([i,o],c)=>s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${a(c)}`,children:i}),s.jsx("span",{className:"text-text-secondary",children:o})]},i)):s.jsx("p",{className:"text-xs text-text-tertiary",children:"No data"})})]}),s.jsxs("div",{className:"bg-surface border border-border rounded-lg p-4 hover:shadow-md transition-shadow",children:[s.jsx("div",{className:"flex items-center justify-between mb-3",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"p-2 bg-orange-50 rounded-lg",children:s.jsx(G,{name:"Users",size:20,className:"text-orange-600"})}),s.jsx("span",{className:"text-sm font-medium text-text-primary",children:"By Size"})]})}),s.jsx("div",{className:"space-y-2",children:n.length>0?n.map(([i,o])=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-xs text-text-secondary capitalize",children:i}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-20 bg-border rounded-full h-1.5 overflow-hidden",children:s.jsx("div",{className:"bg-primary h-full rounded-full transition-all",style:{width:`${o/e.total*100}%`}})}),s.jsx("span",{className:"text-xs font-medium text-text-primary w-6 text-right",children:o})]})]},i)):s.jsx("p",{className:"text-xs text-text-tertiary",children:"No data"})})]})]})},TRe=({onClose:e,onSuccess:t})=>{const[r,n]=R.useState(null),[a,i]=R.useState([]),[o,c]=R.useState(!1),[l,u]=R.useState(""),[d,f]=R.useState({current:0,total:0}),h=p=>{const g=p.target.files[0];if(g){if(!g.name.endsWith(".csv")&&!g.name.endsWith(".xlsx")){u("Please upload a CSV file");return}n(g),u(""),Tf.parse(g,{header:!0,preview:5,complete:v=>{i(v.data)},error:v=>{u("Failed to parse file: "+v.message)}})}},m=async()=>{if(!r){u("Please select a file");return}c(!0),u(""),Tf.parse(r,{header:!0,skipEmptyLines:!0,complete:async p=>{const g=p.data;f({current:0,total:g.length});try{const v=[];for(let y=0;y<g.length;y++){const b=g[y],_={name:b.name||b.Name||b.company_name,industry:b.industry||b.Industry||null,size:b.size||b.Size||b.company_size||null,website:b.website||b.Website||null,phone:b.phone||b.Phone||null,email:b.email||b.Email||null,address:b.address||b.Address||null,city:b.city||b.City||null,state:b.state||b.State||null,zip_code:b.zip_code||b["Zip Code"]||null,country:b.country||b.Country||null,description:b.description||b.Description||null,revenue:b.revenue||b.Revenue?parseInt(b.revenue||b.Revenue):null};if(_.name)try{const w=await Wt.createCompany(_);v.push(w),f({current:y+1,total:g.length})}catch(w){console.error(`Failed to import company ${_.name}:`,w)}}c(!1),t(v)}catch(v){console.error("Import error:",v),u("Failed to import companies: "+v.message),c(!1)}},error:p=>{u("Failed to parse file: "+p.message),c(!1)}})},x=()=>{const p=`name,industry,size,website,phone,email,address,city,state,zip_code,country,revenue,description
Acme Corporation,Technology,Large (251-1000),www.acme.com,+1-555-123-4567,info@acme.com,123 Tech St,San Francisco,CA,94102,United States,5000000,Leading technology company
Example Inc,Healthcare,Medium (51-250),www.example.com,+1-555-987-6543,contact@example.com,456 Health Ave,Boston,MA,02101,United States,2000000,Healthcare provider`,g=new Blob([p],{type:"text/csv"}),v=window.URL.createObjectURL(g),y=document.createElement("a");y.href=v,y.download="companies_import_template.csv",y.click(),window.URL.revokeObjectURL(v)};return s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-surface rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border",children:[s.jsxs("h2",{className:"text-xl font-bold text-text-primary flex items-center",children:[s.jsx(G,{name:"Upload",size:24,className:"mr-2"}),"Import Companies"]}),s.jsx("button",{onClick:e,className:"p-2 text-text-tertiary hover:text-text-primary transition-colors",disabled:o,children:s.jsx(G,{name:"X",size:20})})]}),s.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-180px)]",children:[s.jsxs("div",{className:"mb-6 p-4 bg-primary-50 border border-primary-200 rounded-lg",children:[s.jsxs("h3",{className:"font-semibold text-primary mb-2 flex items-center",children:[s.jsx(G,{name:"Info",size:18,className:"mr-2"}),"Instructions"]}),s.jsxs("ul",{className:"text-sm text-primary-700 space-y-1 ml-6 list-disc",children:[s.jsx("li",{children:"Upload a CSV file with company information"}),s.jsx("li",{children:"Required field: name (company name)"}),s.jsx("li",{children:"Optional fields: industry, size, website, phone, email, address, city, state, zip_code, country, revenue, description"}),s.jsx("li",{children:"Download the template below for reference"})]})]}),s.jsx("div",{className:"mb-6",children:s.jsxs("button",{onClick:x,className:"inline-flex items-center space-x-2 px-4 py-2 border border-border rounded-lg text-text-secondary hover:bg-surface-hover transition-colors",children:[s.jsx(G,{name:"Download",size:18}),s.jsx("span",{children:"Download CSV Template"})]})}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Select CSV File"}),s.jsx("div",{className:"relative",children:s.jsx("input",{type:"file",accept:".csv",onChange:h,disabled:o,className:`block w-full text-sm text-text-secondary\r
                  file:mr-4 file:py-2 file:px-4\r
                  file:rounded-lg file:border-0\r
                  file:text-sm file:font-medium\r
                  file:bg-primary file:text-white\r
                  hover:file:bg-primary-600\r
                  file:cursor-pointer cursor-pointer\r
                  disabled:opacity-50 disabled:cursor-not-allowed`})}),r&&s.jsxs("p",{className:"mt-2 text-sm text-text-secondary",children:["Selected: ",r.name]})]}),l&&s.jsxs("div",{className:"mb-6 p-4 bg-error-50 border border-error-200 rounded-lg flex items-start space-x-3",children:[s.jsx(G,{name:"AlertCircle",size:20,className:"text-error flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-error font-medium",children:"Error"}),s.jsx("p",{className:"text-error-600 text-sm",children:l})]})]}),a.length>0&&!o&&s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-sm font-medium text-text-primary mb-3",children:"Preview (first 5 rows)"}),s.jsx("div",{className:"overflow-x-auto border border-border rounded-lg",children:s.jsxs("table",{className:"min-w-full divide-y divide-border",children:[s.jsx("thead",{className:"bg-surface-hover",children:s.jsx("tr",{children:Object.keys(a[0]).map(p=>s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:p},p))})}),s.jsx("tbody",{className:"divide-y divide-border",children:a.map((p,g)=>s.jsx("tr",{className:"hover:bg-surface-hover",children:Object.values(p).map((v,y)=>s.jsx("td",{className:"px-4 py-3 text-sm text-text-primary whitespace-nowrap",children:v||"-"},y))},g))})]})})]}),o&&s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-sm text-text-secondary",children:"Importing companies..."}),s.jsxs("span",{className:"text-sm font-medium text-text-primary",children:[d.current," / ",d.total]})]}),s.jsx("div",{className:"w-full bg-border rounded-full h-2 overflow-hidden",children:s.jsx("div",{className:"bg-primary h-full rounded-full transition-all duration-300",style:{width:`${d.current/d.total*100}%`}})})]})]}),s.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-border",children:[s.jsx("button",{onClick:e,disabled:o,className:"px-4 py-2 border border-border rounded-lg text-text-secondary hover:bg-surface-hover transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),s.jsxs("button",{onClick:m,disabled:!r||o,className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[o&&s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx("span",{children:o?"Importing...":"Import Companies"})]})]})]})})},CRe=({companies:e,onClose:t})=>{const[r,n]=R.useState("csv"),[a,i]=R.useState(["name","industry","size","website","phone","email","city","state","country"]),[o,c]=R.useState(!1),l=[{key:"name",label:"Company Name"},{key:"industry",label:"Industry"},{key:"size",label:"Company Size"},{key:"website",label:"Website"},{key:"phone",label:"Phone"},{key:"email",label:"Email"},{key:"address",label:"Street Address"},{key:"city",label:"City"},{key:"state",label:"State"},{key:"zip_code",label:"Zip Code"},{key:"country",label:"Country"},{key:"revenue",label:"Revenue"},{key:"description",label:"Description"},{key:"created_at",label:"Created Date"},{key:"updated_at",label:"Updated Date"}],u=m=>{i(x=>x.includes(m)?x.filter(p=>p!==m):[...x,m])},d=()=>{a.length===l.length?i([]):i(l.map(m=>m.key))},f=(m,x)=>m==null?"":x==="created_at"||x==="updated_at"?new Date(m).toLocaleDateString():String(m),h=()=>{if(a.length===0){alert("Please select at least one field to export");return}c(!0);try{const m=e.map(x=>{const p={};return a.forEach(g=>{const v=l.find(y=>y.key===g);p[(v==null?void 0:v.label)||g]=f(x[g],g)}),p});if(r==="csv"){const x=Tf.unparse(m),p=new Blob([x],{type:"text/csv;charset=utf-8;"}),g=window.URL.createObjectURL(p),v=document.createElement("a");v.href=g,v.download=`companies_export_${new Date().toISOString().split("T")[0]}.csv`,v.click(),window.URL.revokeObjectURL(g)}else if(r==="json"){const x=JSON.stringify(m,null,2),p=new Blob([x],{type:"application/json"}),g=window.URL.createObjectURL(p),v=document.createElement("a");v.href=g,v.download=`companies_export_${new Date().toISOString().split("T")[0]}.json`,v.click(),window.URL.revokeObjectURL(g)}setTimeout(()=>{c(!1),t()},500)}catch(m){console.error("Export error:",m),alert("Failed to export companies. Please try again."),c(!1)}};return s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-surface rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border",children:[s.jsxs("h2",{className:"text-xl font-bold text-text-primary flex items-center",children:[s.jsx(G,{name:"Download",size:24,className:"mr-2"}),"Export Companies"]}),s.jsx("button",{onClick:t,className:"p-2 text-text-tertiary hover:text-text-primary transition-colors",disabled:o,children:s.jsx(G,{name:"X",size:20})})]}),s.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-180px)]",children:[s.jsx("div",{className:"mb-6 p-4 bg-primary-50 border border-primary-200 rounded-lg",children:s.jsxs("p",{className:"text-sm text-primary-700",children:[s.jsx(G,{name:"Info",size:16,className:"inline mr-2"}),"Exporting ",s.jsx("span",{className:"font-semibold",children:e.length})," companies"]})}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-3",children:"Export Format"}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("button",{onClick:()=>n("csv"),className:`p-4 border-2 rounded-lg transition-all ${r==="csv"?"border-primary bg-primary-50":"border-border hover:border-primary/50"}`,children:[s.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[s.jsx(G,{name:"FileText",size:20,className:r==="csv"?"text-primary":"text-text-secondary"}),s.jsx("span",{className:`font-medium ${r==="csv"?"text-primary":"text-text-secondary"}`,children:"CSV"})]}),s.jsx("p",{className:"text-xs text-text-tertiary mt-1",children:"Spreadsheet format"})]}),s.jsxs("button",{onClick:()=>n("json"),className:`p-4 border-2 rounded-lg transition-all ${r==="json"?"border-primary bg-primary-50":"border-border hover:border-primary/50"}`,children:[s.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[s.jsx(G,{name:"Code",size:20,className:r==="json"?"text-primary":"text-text-secondary"}),s.jsx("span",{className:`font-medium ${r==="json"?"text-primary":"text-text-secondary"}`,children:"JSON"})]}),s.jsx("p",{className:"text-xs text-text-tertiary mt-1",children:"Data format"})]})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary",children:"Select Fields to Export"}),s.jsx("button",{onClick:d,className:"text-sm text-primary hover:underline",children:a.length===l.length?"Deselect All":"Select All"})]}),s.jsx("div",{className:"grid grid-cols-2 gap-3 max-h-64 overflow-y-auto p-3 border border-border rounded-lg",children:l.map(m=>s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-surface-hover p-2 rounded transition-colors",children:[s.jsx("input",{type:"checkbox",checked:a.includes(m.key),onChange:()=>u(m.key),className:"w-4 h-4 text-primary border-border rounded focus:ring-primary"}),s.jsx("span",{className:"text-sm text-text-secondary",children:m.label})]},m.key))}),s.jsxs("p",{className:"text-xs text-text-tertiary mt-2",children:[a.length," of ",l.length," fields selected"]})]})]}),s.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-border",children:[s.jsx("button",{onClick:t,disabled:o,className:"px-4 py-2 border border-border rounded-lg text-text-secondary hover:bg-surface-hover transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),s.jsxs("button",{onClick:h,disabled:a.length===0||o,className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[o&&s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx(G,{name:"Download",size:18}),s.jsx("span",{children:o?"Exporting...":`Export ${r.toUpperCase()}`})]})]})]})})},X4=()=>{const{companyId:e}=G2(),t=Os(),{user:r,hasPermission:n}=Pt(),[a,i]=R.useState([]),[o,c]=R.useState(!0),[l,u]=R.useState(null),[d,f]=R.useState([]),[h,m]=R.useState(""),[x,p]=R.useState(!1),[g,v]=R.useState(!1),[y,b]=R.useState(!1),[_,w]=R.useState(!1),[j,N]=R.useState("grid"),[D,S]=R.useState(!1),[T,A]=R.useState({industry:[],size:[],location:[],revenueRange:null}),[E,M]=R.useState(null),P=async()=>{try{console.log("DEBUG: loadCompanies() called"),c(!0);let ne=[];if(h?(console.log("DEBUG: Loading companies with search:",h),ne=await Wt.searchCompanies(h)):Object.values(T).some(pe=>pe&&(Array.isArray(pe)?pe.length>0:!0))?(console.log("DEBUG: Loading companies with filters:",T),ne=await Wt.filterCompanies(T)):(console.log("DEBUG: Loading all companies"),ne=await Wt.getAllCompanies()),console.log("DEBUG: Companies loaded:",ne),i(ne||[]),e&&!l){const pe=await Wt.getCompanyById(e);pe&&(u(pe),N("split"))}}catch(ne){console.error("Error loading companies:",ne),Be.error("Failed to load companies. Please try again.")}finally{c(!1)}},X=async()=>{try{console.log("DEBUG: loadStats() called");const ne=await Wt.getCompanyStats();console.log("DEBUG: Stats loaded:",ne),M(ne)}catch(ne){console.error("Error loading company statistics:",ne)}};R.useEffect(()=>{console.log("DEBUG: useEffect triggered - user:",r,"searchQuery:",h,"filters:",T,"companyId:",e),r?(console.log("DEBUG: User exists, loading companies and stats"),P(),X()):console.log("DEBUG: No user, skipping load")},[r,h,T,e]);const q=a==null?void 0:a.filter(ne=>!0),B=async ne=>{try{if(ne!=null&&ne.id){const pe=await Wt.getCompanyById(ne.id);u(pe),t(`/company-management/${ne.id}`)}else u(ne);N("split"),p(!1),v(!1)}catch(pe){console.error("Error in handleCompanySelect:",pe),u(ne),N("split"),Be.error("Could not load full company details.")}},O=ne=>{f(pe=>pe!=null&&pe.includes(ne)?pe==null?void 0:pe.filter(re=>re!==ne):[...pe||[],ne])},F=()=>{(d==null?void 0:d.length)===(q==null?void 0:q.length)?f([]):f(q==null?void 0:q.map(ne=>ne==null?void 0:ne.id))},I=()=>{u(null),p(!0),v(!1),N("split")},L=ne=>{u(ne),v(!0),p(!1),N("split")},C=async ne=>{console.log("handleSaveCompany called with:",ne),console.log("isEditingCompany:",g,"selectedCompany:",l);try{if(g&&(l!=null&&l.id)){console.log("Updating company with ID:",l.id);const pe=await Wt.updateCompany(l.id,ne);console.log("Company updated successfully:",pe),Be.success("Company updated successfully!"),u(pe),v(!1)}else{console.log("Creating new company");const pe=await Wt.createCompany(ne);console.log("Company created successfully:",pe),Be.success("Company created successfully!"),u(pe),p(!1)}P(),X()}catch(pe){throw console.error("Error saving company:",pe),Be.error((pe==null?void 0:pe.message)||"Failed to save company. Please try again."),pe}},k=async ne=>{if(window.confirm("Are you sure you want to delete this company? This action cannot be undone."))try{await Wt.deleteCompany(ne),Be.success("Company deleted successfully!"),(l==null?void 0:l.id)===ne&&(u(null),N("grid"),t("/company-management")),P(),X()}catch(pe){console.error("Error deleting company:",pe),Be.error("Failed to delete company. Please try again.")}},z=async()=>{if(d.length===0){Be.error("Please select companies to delete");return}if(window.confirm(`Are you sure you want to delete ${d.length} companies? This action cannot be undone.`))try{await Promise.all(d.map(ne=>Wt.deleteCompany(ne))),Be.success(`${d.length} companies deleted successfully!`),f([]),u(null),N("grid"),P(),X()}catch(ne){console.error("Error bulk deleting companies:",ne),Be.error("Failed to delete some companies. Please try again.")}},V=()=>{p(!1),v(!1),l||(N("grid"),t("/company-management"))},Z=()=>{P(),X(),b(!1),Be.success("Companies imported successfully!")},ce=ne=>{A(ne),S(!1)},ie=()=>{A({industry:[],size:[],location:[],revenueRange:null})},Q=Object.values(T).some(ne=>ne&&(Array.isArray(ne)?ne.length>0:!0));return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(Ta,{}),s.jsxs("div",{className:"pt-16",children:[s.jsx(Ki,{}),s.jsxs("div",{className:"px-6 py-6",children:[s.jsx("div",{className:"mb-6",children:s.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-text-primary",children:"Company Management"}),s.jsx("p",{className:"text-text-secondary mt-1",children:"Manage your company relationships and information"})]}),s.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[s.jsxs("div",{className:"inline-flex items-center border border-border rounded-lg",children:[s.jsx("button",{onClick:()=>{N("grid"),u(null),p(!1),v(!1),t("/company-management")},className:`px-3 py-2 rounded-l-lg transition-colors ${j==="grid"?"bg-primary text-white":"text-text-secondary hover:bg-surface-hover"}`,title:"Grid View",children:s.jsx(G,{name:"Grid",size:18})}),s.jsx("button",{onClick:()=>N("split"),className:`px-3 py-2 rounded-r-lg border-l border-border transition-colors ${j==="split"?"bg-primary text-white":"text-text-secondary hover:bg-surface-hover"}`,title:"Split View",children:s.jsx(G,{name:"List",size:18})})]}),s.jsxs("button",{onClick:()=>S(!D),className:`inline-flex items-center space-x-2 px-4 py-2 rounded-lg border transition-colors ${Q||D?"border-primary bg-primary-50 text-primary":"border-border text-text-secondary hover:bg-surface-hover"}`,children:[s.jsx(G,{name:"Filter",size:18}),s.jsx("span",{children:"Filters"}),Q&&s.jsx("span",{className:"bg-primary text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:T.industry.length+T.size.length+T.location.length})]}),n("companies.import_export")&&s.jsxs("button",{onClick:()=>b(!0),className:"inline-flex items-center space-x-2 px-4 py-2 rounded-lg border border-border text-text-secondary hover:bg-surface-hover transition-colors",children:[s.jsx(G,{name:"Upload",size:18}),s.jsx("span",{children:"Import"})]}),n("companies.import_export")&&s.jsxs("button",{onClick:()=>w(!0),className:"inline-flex items-center space-x-2 px-4 py-2 rounded-lg border border-border text-text-secondary hover:bg-surface-hover transition-colors",children:[s.jsx(G,{name:"Download",size:18}),s.jsx("span",{children:"Export"})]}),n("companies.create")&&s.jsxs("button",{onClick:I,className:"inline-flex items-center space-x-2 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-600 transition-colors",children:[s.jsx(G,{name:"Plus",size:18}),s.jsx("span",{children:"Add Company"})]})]})]})}),E&&s.jsx(ERe,{stats:E,className:"mb-6"}),s.jsx("div",{className:"mb-6",children:s.jsxs("div",{className:"relative",children:[s.jsx(G,{name:"Search",size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary"}),s.jsx("input",{type:"text",placeholder:"Search companies by name, industry, or location...",value:h,onChange:ne=>m(ne.target.value),className:"w-full pl-10 pr-4 py-3 bg-surface border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"}),h&&s.jsx("button",{onClick:()=>m(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-text-tertiary hover:text-text-primary",children:s.jsx(G,{name:"X",size:20})})]})}),D&&s.jsx(SRe,{filters:T,onApplyFilters:ce,onClearFilters:ie,onClose:()=>S(!1)}),d.length>0&&s.jsxs("div",{className:"mb-4 p-4 bg-primary-50 border border-primary-200 rounded-lg flex items-center justify-between",children:[s.jsxs("span",{className:"text-text-primary font-medium",children:[d.length," companies selected"]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("button",{onClick:()=>f([]),className:"px-3 py-1.5 text-text-secondary hover:text-text-primary transition-colors",children:"Clear Selection"}),(n("companies.delete_all")||n("companies.delete_own"))&&s.jsx("button",{onClick:z,className:"px-3 py-1.5 bg-error text-white rounded-lg hover:bg-error-600 transition-colors",children:"Delete Selected"})]})]}),o?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):j==="grid"?s.jsx(G4,{companies:q,onCompanySelect:B,onDeleteCompany:k,onEditCompany:L,selectedCompanies:d,onMultiSelect:O,onSelectAll:F}):s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[s.jsx("div",{className:"lg:col-span-4 space-y-4",children:s.jsx(G4,{companies:q,onCompanySelect:B,onDeleteCompany:k,onEditCompany:L,selectedCompanies:d,onMultiSelect:O,compact:!0})}),s.jsx("div",{className:"lg:col-span-8",children:s.jsx("div",{className:"bg-surface rounded-lg border border-border shadow-sm",children:x||g?s.jsx(DRe,{company:g?l:null,onSubmit:C,onCancel:V}):l?s.jsx(NRe,{company:l,onEdit:()=>L(l),onDelete:()=>k(l.id),onClose:()=>{u(null),N("grid"),t("/company-management")}}):s.jsxs("div",{className:"p-12 text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-primary-50 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(G,{name:"Building2",size:32,className:"text-primary"})}),s.jsx("h3",{className:"text-xl font-semibold text-text-primary mb-2",children:"Select a Company"}),s.jsx("p",{className:"text-text-secondary",children:"Choose a company from the list to view details"})]})})})]})]})]}),y&&s.jsx(TRe,{onClose:()=>b(!1),onSuccess:Z}),_&&s.jsx(CRe,{companies:q,onClose:()=>w(!1)})]})},ARe=({campaigns:e,allCampaigns:t,statuses:r,types:n,selectedStatusFilter:a,selectedTypeFilter:i,searchQuery:o,sortField:c,sortDirection:l,currentPage:u,itemsPerPage:d,totalItems:f,totalPages:h,onStatusFilterChange:m,onTypeFilterChange:x,onSearchChange:p,onSort:g,onPageChange:v,onItemsPerPageChange:y,onViewCampaign:b,onEditCampaign:_,onDeleteCampaign:w})=>{const{user:j,hasPermission:N,hasAnyPermission:D}=Pt(),S=B=>!!(N("campaigns.edit_all")||N("campaigns.edit_own")&&B.owner_id===(j==null?void 0:j.id)),T=B=>!!(N("campaigns.delete_all")||N("campaigns.delete_own")&&B.owner_id===(j==null?void 0:j.id)),A=B=>kr.formatCurrency(B),E=B=>B?new Date(B).toLocaleDateString():"Not set",M=B=>{var O;return((O=r.find(F=>F.value===B))==null?void 0:O.color)||"bg-gray-100 text-gray-800"},P=B=>{var O;return((O=r.find(F=>F.value===B))==null?void 0:O.label)||B},X=B=>{var O;return((O=n.find(F=>F.value===B))==null?void 0:O.icon)||"Mail"},q=B=>{var O;return((O=n.find(F=>F.value===B))==null?void 0:O.label)||B};return s.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[s.jsx("div",{className:"p-6 border-b border-border",children:s.jsxs("div",{className:"relative",children:[s.jsx(G,{name:"Search",size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary"}),s.jsx("input",{type:"text",placeholder:"Search campaigns by name or description...",value:o,onChange:B=>p(B.target.value),className:"w-full pl-10 pr-4 py-3 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary text-text-primary placeholder-text-tertiary"}),o&&s.jsx("button",{onClick:()=>p(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-text-tertiary hover:text-text-primary",children:s.jsx(G,{name:"X",size:16})})]})}),s.jsxs("div",{className:"p-6 border-b border-border",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"All Campaigns"}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-sm text-text-secondary",children:"Show:"}),s.jsxs("select",{value:d,onChange:B=>y(Number(B.target.value)),className:"text-sm border border-border rounded-md px-2 py-1 bg-surface",children:[s.jsx("option",{value:10,children:"10"}),s.jsx("option",{value:25,children:"25"}),s.jsx("option",{value:50,children:"50"}),s.jsx("option",{value:100,children:"100"})]})]}),s.jsxs("div",{className:"text-sm text-text-secondary",children:[f," campaign",f!==1?"s":"",(a!=="all"||i!=="all"||o)&&` (${Array.isArray(t)?t.length:0} total)`]})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Filter by Status:"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs("button",{onClick:()=>m("all"),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${a==="all"?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["All Statuses (",Array.isArray(t)?t.length:0,")"]}),r.map(B=>{const O=Array.isArray(t)?t.filter(F=>F.status===B.value).length:0;return s.jsxs("button",{onClick:()=>m(B.value),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${a===B.value?"bg-primary text-white":`${B.color} hover:opacity-80`}`,children:[B.label," (",O,")"]},B.value)})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Filter by Type:"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx("button",{onClick:()=>x("all"),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${i==="all"?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All Types"}),n.map(B=>{const O=Array.isArray(t)?t.filter(F=>F.type===B.value).length:0;return s.jsxs("button",{onClick:()=>x(B.value),className:`flex items-center space-x-2 px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${i===B.value?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[s.jsx(G,{name:B.icon,size:14}),s.jsxs("span",{children:[B.label," (",O,")"]})]},B.value)})]})]})]}),e.length===0?s.jsxs("div",{className:"p-8 text-center",children:[s.jsx(G,{name:"Megaphone",size:48,className:"text-text-tertiary mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:a==="all"&&i==="all"&&!o?"No campaigns yet":"No campaigns found"}),s.jsx("p",{className:"text-text-secondary mb-4",children:a==="all"&&i==="all"&&!o?"Create your first campaign to get started":"Try adjusting your filters or search query"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider cursor-pointer hover:bg-surface-hover transition-colors",onClick:()=>g("name"),children:s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("span",{children:"Campaign"}),c==="name"&&s.jsx(G,{name:l==="asc"?"ArrowUp":"ArrowDown",size:14,className:"text-primary"})]})}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Type"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider cursor-pointer hover:bg-surface-hover transition-colors",onClick:()=>g("budget"),children:s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("span",{children:"Budget"}),c==="budget"&&s.jsx(G,{name:l==="asc"?"ArrowUp":"ArrowDown",size:14,className:"text-primary"})]})}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider cursor-pointer hover:bg-surface-hover transition-colors",onClick:()=>g("start_date"),children:s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("span",{children:"Start Date"}),c==="start_date"&&s.jsx(G,{name:l==="asc"?"ArrowUp":"ArrowDown",size:14,className:"text-primary"})]})}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Performance"}),s.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-border",children:e.map(B=>{var O;return s.jsxs("tr",{className:"hover:bg-surface-hover transition-colors duration-150 cursor-pointer",onClick:()=>b(B),children:[s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-text-primary",children:B.name||"Untitled Campaign"}),s.jsx("div",{className:"text-sm text-text-secondary truncate max-w-xs",children:B.description||"No description"})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:X(B.type),size:16,className:"text-text-secondary"}),s.jsx("span",{className:"text-sm text-text-primary",children:q(B.type)})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${M(B.status)}`,children:P(B.status)})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-primary",children:A(B.budget||0)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-secondary",children:E(B.start_date)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex flex-col space-y-1",children:[s.jsxs("div",{className:"text-xs text-text-secondary",children:["Sent: ",B.sent_count||0]}),s.jsxs("div",{className:"text-xs text-text-secondary",children:["Open: ",((O=B.open_rate)==null?void 0:O.toFixed(1))||0,"%"]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:s.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[S(B)&&s.jsx("button",{onClick:F=>{F.stopPropagation(),_(B)},className:"p-2 text-primary hover:bg-primary-50 rounded-lg transition-colors duration-150",title:"Edit campaign",children:s.jsx(G,{name:"Edit",size:16})}),T(B)&&s.jsx("button",{onClick:F=>{F.stopPropagation(),w(B)},className:"p-2 text-error hover:bg-error-50 rounded-lg transition-colors duration-150",title:"Delete campaign",children:s.jsx(G,{name:"Trash2",size:16})})]})})]},B.id)})})]})}),f>0&&s.jsx("div",{className:"px-6 py-4 border-t border-border",children:s.jsx(dx,{currentPage:u,totalPages:h,totalItems:f,itemsPerPage:d,onPageChange:v})})]})]})},kRe=({campaign:e,statuses:t,types:r})=>{var c,l,u,d;const n=f=>kr.formatCurrency(f),a=f=>f?new Date(f).toLocaleDateString():"Not set",i=f=>f?new Date(f).toLocaleString():"Not set",o=()=>{if(!(e!=null&&e.budget)||e.budget===0)return 0;const f=e.actual_cost||e.budget,h=e.actual_revenue||0;return f===0?0:((h-f)/f*100).toFixed(1)};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Basic Information"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Campaign Name"}),s.jsx("p",{className:"text-text-primary text-base font-medium",children:(e==null?void 0:e.name)||"N/A"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Campaign Type"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:((c=r.find(f=>f.value===(e==null?void 0:e.type)))==null?void 0:c.icon)||"Megaphone",size:16,className:"text-text-tertiary"}),s.jsx("span",{className:"text-text-primary text-base",children:((l=r.find(f=>f.value===(e==null?void 0:e.type)))==null?void 0:l.label)||(e==null?void 0:e.type)||"N/A"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Status"}),s.jsx("span",{className:`inline-block px-3 py-1 text-sm font-medium rounded-full ${((u=t.find(f=>f.value===(e==null?void 0:e.status)))==null?void 0:u.color)||"bg-gray-100 text-gray-800"}`,children:((d=t.find(f=>f.value===(e==null?void 0:e.status)))==null?void 0:d.label)||(e==null?void 0:e.status)||"N/A"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Owner"}),s.jsx("p",{className:"text-text-primary text-base",children:(e==null?void 0:e.owner_name)||"Unassigned"})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Description"}),s.jsx("p",{className:"text-text-primary text-base",children:(e==null?void 0:e.description)||"No description provided"})]})]})]}),s.jsxs("div",{className:"border-t border-border pt-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Timeline"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Start Date"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"Calendar",size:16,className:"text-text-tertiary"}),s.jsx("span",{className:"text-text-primary text-base",children:a(e==null?void 0:e.start_date)})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"End Date"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"Calendar",size:16,className:"text-text-tertiary"}),s.jsx("span",{className:"text-text-primary text-base",children:a(e==null?void 0:e.end_date)})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Created At"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"Clock",size:16,className:"text-text-tertiary"}),s.jsx("span",{className:"text-text-primary text-base",children:i(e==null?void 0:e.created_at)})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Last Updated"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"Clock",size:16,className:"text-text-tertiary"}),s.jsx("span",{className:"text-text-primary text-base",children:i(e==null?void 0:e.updated_at)})]})]})]})]}),(e==null?void 0:e.type)==="email"&&s.jsxs("div",{className:"border-t border-border pt-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[s.jsx(G,{name:"Mail",size:20,className:"mr-2"}),"Email Campaign Details"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Email Template"}),s.jsx("p",{className:"text-text-primary text-base",children:(e==null?void 0:e.email_template_name)||(e==null?void 0:e.email_template_id)||"Not selected"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Email Subject"}),s.jsx("p",{className:"text-text-primary text-base",children:(e==null?void 0:e.email_subject)||"Not set"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"From Name"}),s.jsx("p",{className:"text-text-primary text-base",children:(e==null?void 0:e.email_from_name)||"System default"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"From Email"}),s.jsx("p",{className:"text-text-primary text-base",children:(e==null?void 0:e.email_from_email)||"System default"})]})]})]}),s.jsxs("div",{className:"border-t border-border pt-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Budget & ROI"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[s.jsx("label",{className:"block text-sm font-medium text-blue-700 mb-2",children:"Budget"}),s.jsx("div",{className:"text-2xl font-semibold text-blue-900",children:n((e==null?void 0:e.budget)||0)})]}),s.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[s.jsx("label",{className:"block text-sm font-medium text-purple-700 mb-2",children:"Actual Revenue"}),s.jsx("div",{className:"text-2xl font-semibold text-purple-900",children:n((e==null?void 0:e.actual_revenue)||0)})]}),s.jsxs("div",{className:`rounded-lg p-4 ${o()>=0?"bg-green-50":"bg-red-50"}`,children:[s.jsx("label",{className:`block text-sm font-medium mb-2 ${o()>=0?"text-green-700":"text-red-700"}`,children:"ROI"}),s.jsxs("div",{className:`text-2xl font-semibold ${o()>=0?"text-green-900":"text-red-900"}`,children:[o(),"%"]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Actual Cost"}),s.jsx("div",{className:"text-lg font-medium text-text-primary",children:n((e==null?void 0:e.actual_cost)||0)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Expected Revenue"}),s.jsx("div",{className:"text-lg font-medium text-text-primary",children:n((e==null?void 0:e.expected_revenue)||0)})]})]})]})]})},jr={async getCampaigns(e={}){try{const t=new URLSearchParams;e.status&&t.append("status",e.status),e.type&&t.append("type",e.type),e.ownerId&&t.append("owner_id",e.ownerId),e.dateRange&&t.append("date_range",e.dateRange);const r=t.toString(),n=r?`/api/v1/campaigns?${r}`:"/api/v1/campaigns";console.log(" Fetching campaigns from:",n);const{data:a,error:i}=await be.get(n);if(i)throw console.error(" API error:",i),i;return console.log(" getCampaigns raw response:",a),a&&typeof a=="object"&&Array.isArray(a.campaigns)?(console.log(" Returning campaigns array, length:",a.campaigns.length),a.campaigns):Array.isArray(a)?a:[]}catch(t){throw console.error("Error fetching campaigns:",t),t}},async getCampaignById(e){try{const{data:t,error:r}=await be.get(`/api/v1/campaigns/${e}`);if(r){if(r.status===404)return null;throw r}return t}catch(t){throw console.error("Error fetching campaign:",t),t}},async createCampaign(e){try{console.log("campaignsService.createCampaign called with:",e);const t={name:e.name,type:e.type,status:e.status||"draft",description:e.description||null,start_date:e.start_date||null,end_date:e.end_date||null,budget:e.budget||0,expected_revenue:e.expected_revenue||0,email_template_id:e.email_template_id||null,owner_id:e.owner_id||null};console.log("Sending to API:",t);const{data:r,error:n}=await be.post("/api/v1/campaigns",t);if(n)throw console.error("API returned error:",n),n;return console.log("API returned data:",r),r}catch(t){throw console.error("Error creating campaign:",t),t}},async updateCampaign(e,t){try{console.log("Updating campaign:",e,"with data:",t);const{data:r,error:n}=await be.put(`/api/v1/campaigns/${e}`,t);if(n)throw console.error("API returned error:",n),n;return console.log("Campaign updated successfully:",r),r}catch(r){throw console.error("Error updating campaign:",r),r}},async deleteCampaign(e){try{const{data:t,error:r}=await be.delete(`/api/v1/campaigns/${e}`);if(r)throw r;return!0}catch(t){throw console.error("Error deleting campaign:",t),t}},async deleteCampaigns(e){try{return await Promise.all(e.map(t=>this.deleteCampaign(t))),!0}catch(t){throw t}},async getCampaignStatistics(e={}){try{const t=new URLSearchParams;e.dateRange&&t.append("date_range",e.dateRange),e.ownerId&&t.append("owner_id",e.ownerId);const r=t.toString(),n=r?`/api/v1/campaigns/statistics?${r}`:"/api/v1/campaigns/statistics",{data:a,error:i}=await be.get(n);if(i)throw i;return a}catch(t){throw console.error("Error fetching campaign statistics:",t),t}},async addAudience(e,t){try{const{data:r,error:n}=await be.post(`/api/v1/campaigns/${e}/audience`,t);if(n)throw n;return r}catch(r){throw console.error("Error adding audience to campaign:",r),r}},async getCampaignAudience(e,t={}){try{const r=new URLSearchParams;t.status&&r.append("status",t.status),t.skip!==void 0&&r.append("skip",t.skip),t.limit!==void 0&&r.append("limit",t.limit);const n=r.toString(),a=n?`/api/v1/campaigns/${e}/audience?${n}`:`/api/v1/campaigns/${e}/audience`,{data:i,error:o}=await be.get(a);if(o)throw o;return i&&typeof i=="object"&&Array.isArray(i.audience)?i.audience:i&&typeof i=="object"&&Array.isArray(i.campaign_contacts)?i.campaign_contacts:Array.isArray(i)?i:[]}catch(r){throw console.error("Error fetching campaign audience:",r),r}},async removeAudienceMember(e,t){try{const{data:r,error:n}=await be.delete(`/api/v1/campaigns/${e}/audience/${t}`);if(n)throw n;return r}catch(r){throw console.error("Error removing audience member:",r),r}},async executeCampaign(e,t={}){try{const{data:r,error:n}=await be.post(`/api/v1/campaigns/${e}/execute`,t);if(n)throw n;return r}catch(r){throw console.error("Error executing campaign:",r),r}},async sendToPendingAudience(e){try{const{data:t,error:r}=await be.post(`/api/v1/campaigns/${e}/send-pending`);if(r)throw r;return t}catch(t){throw console.error("Error sending to pending audience:",t),t}},async resendToMember(e,t){try{const{data:r,error:n}=await be.post(`/api/v1/campaigns/${e}/audience/${t}/resend`);if(n)throw n;return r}catch(r){throw console.error("Error resending to member:",r),r}},async getCampaignMetrics(e){try{const{data:t,error:r}=await be.get(`/api/v1/campaigns/${e}/metrics`);if(r)throw r;return t}catch(t){throw console.error("Error fetching campaign metrics:",t),t}},async getCampaignAnalytics(e,t=30){try{const{data:r,error:n}=await be.get(`/api/v1/campaigns/${e}/analytics?days=${t}`);if(n)throw n;return r&&typeof r=="object"&&Array.isArray(r.analytics)?r.analytics:r&&typeof r=="object"&&Array.isArray(r.metrics)?r.metrics:Array.isArray(r)?r:[]}catch(r){throw console.error("Error fetching campaign analytics:",r),r}},async getCampaignConversions(e){try{const{data:t,error:r}=await be.get(`/api/v1/campaigns/${e}/conversions`);if(r)throw r;return t&&typeof t=="object"&&Array.isArray(t.conversions)?t.conversions:Array.isArray(t)?t:[]}catch(t){throw console.error("Error fetching campaign conversions:",t),t}},async getProspects(e={}){try{const t=new URLSearchParams;e.status&&t.append("status",e.status),e.campaignId&&t.append("campaign_id",e.campaignId),e.assignedTo&&t.append("assigned_to",e.assignedTo),e.source&&t.append("source",e.source);const r=t.toString(),n=r?`/api/v1/prospects?${r}`:"/api/v1/prospects",{data:a,error:i}=await be.get(n);if(i)throw i;return a&&typeof a=="object"&&Array.isArray(a.prospects)?a.prospects:Array.isArray(a)?a:[]}catch(t){throw console.error("Error fetching prospects:",t),t}},async getCampaignProspects(e,t={}){try{const r=new URLSearchParams;t.status&&r.append("status",t.status),t.skip!==void 0&&r.append("skip",t.skip),t.limit!==void 0&&r.append("limit",t.limit);const n=r.toString(),a=n?`/api/v1/campaigns/${e}/prospects?${n}`:`/api/v1/campaigns/${e}/prospects`;console.log(" Fetching campaign prospects from:",a);const{data:i,error:o}=await be.get(a);if(o)throw console.error(" API error:",o),o;return console.log(" getCampaignProspects raw response:",i),i&&typeof i=="object"&&Array.isArray(i.prospects)?(console.log(" Returning prospects array, length:",i.prospects.length),i.prospects):Array.isArray(i)?i:[]}catch(r){throw console.error("Error fetching campaign prospects:",r),r}},async getProspectById(e){try{const{data:t,error:r}=await be.get(`/api/v1/prospects/${e}`);if(r){if(r.status===404)return null;throw r}return t}catch(t){throw console.error("Error fetching prospect:",t),t}},async createProspect(e){try{console.log("campaignsService.createProspect called with:",e);const{data:t,error:r}=await be.post("/api/v1/prospects",e);if(r)throw console.error("API returned error:",r),r;return console.log("API returned data:",t),t}catch(t){throw console.error("Error creating prospect:",t),t}},async updateProspect(e,t){try{console.log("Updating prospect:",e,"with data:",t);const{data:r,error:n}=await be.put(`/api/v1/prospects/${e}`,t);if(n)throw console.error("API returned error:",n),n;return console.log("Prospect updated successfully:",r),r}catch(r){throw console.error("Error updating prospect:",r),r}},async deleteProspect(e){try{const{data:t,error:r}=await be.delete(`/api/v1/prospects/${e}`);if(r)throw r;return!0}catch(t){throw console.error("Error deleting prospect:",t),t}},async convertProspectToContact(e,t={}){try{console.log("Converting prospect:",e,"with data:",t);const{data:r,error:n}=await be.post(`/api/v1/prospects/${e}/convert`,t);if(n)throw console.error("API returned error:",n),n;return console.log("Prospect converted successfully:",r),r}catch(r){throw console.error("Error converting prospect:",r),r}},async bulkImportProspects(e){try{const{data:t,error:r}=await be.post("/api/v1/prospects/bulk-import",e);if(r)throw r;return t}catch(t){throw console.error("Error importing prospects:",t),t}},async exportProspects(e={}){try{const t=new URLSearchParams;e.status&&t.append("status",e.status),e.campaignId&&t.append("campaign_id",e.campaignId);const r=t.toString(),n=r?`/api/v1/prospects/export?${r}`:"/api/v1/prospects/export",{data:a,error:i}=await be.get(n);if(i)throw i;return a||[]}catch(t){throw console.error("Error exporting prospects:",t),t}},async searchCampaigns(e){try{const{data:t,error:r}=await be.get(`/api/v1/campaigns?search=${encodeURIComponent(e)}`);if(r)throw r;return t||[]}catch(t){throw console.error("Error searching campaigns:",t),t}},async cloneCampaign(e){try{const t=await this.getCampaignById(e);if(!t)throw new Error("Campaign not found");const r={name:`${t.name} (Copy)`,type:t.type,status:"draft",description:t.description,budget:t.budget,expected_revenue:t.expected_revenue,email_template_id:t.email_template_id};return await this.createCampaign(r)}catch(t){throw console.error("Error cloning campaign:",t),t}}},FRe=({prospect:e,onClose:t,onUpdate:r,onConvert:n})=>{var x,p,g;const{hasAnyPermission:a}=Pt(),[i,o]=R.useState(!1),[c,l]=R.useState({first_name:e.first_name||"",last_name:e.last_name||"",email:e.email||"",phone:e.phone||"",company_name:e.company_name||"",job_title:e.job_title||"",industry:e.industry||"",description:e.description||"",notes:e.notes||"",status:(e.status||"new").toLowerCase(),lead_score:e.lead_score||0,source:(e.source||"manual_entry").toLowerCase(),source_details:e.source_details||"",linkedin_url:e.linkedin_url||"",twitter_handle:e.twitter_handle||"",website:e.website||"",city:e.city||"",state:e.state||"",country:e.country||""}),u=[{value:"new",label:"New"},{value:"converted",label:"Converted"},{value:"rejected",label:"Rejected"}],[d,f]=R.useState({}),h=async v=>{var b,_,w,j,N;v.preventDefault(),f({});const y={};if((b=c.first_name)!=null&&b.trim()||(y.first_name="First name is required"),!((_=c.email)!=null&&_.trim())&&!((w=c.phone)!=null&&w.trim())&&(y.contact="Either email or phone number is required"),(j=c.email)!=null&&j.trim()&&(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c.email.trim())||(y.email="Please enter a valid email address")),(N=c.phone)!=null&&N.trim()&&c.phone.replace(/\D/g,"").length!==10&&(y.phone="Phone number must be exactly 10 digits"),Object.keys(y).length>0){f(y);return}await r(e.id,c),o(!1)},m=v=>{const{name:y,value:b}=v.target;l(_=>({..._,[y]:b})),d[y]&&f(_=>{const w={..._};return delete w[y],w})};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-surface rounded-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"sticky top-0 bg-surface px-6 py-4 border-b border-border flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-primary font-medium text-lg",children:(((x=c.first_name)==null?void 0:x[0])||"")+(((p=c.last_name)==null?void 0:p[0])||"")})}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-xl font-semibold text-text-primary",children:[c.first_name," ",c.last_name]}),s.jsx("p",{className:"text-sm text-text-secondary",children:c.job_title||"No title"})]})]}),s.jsx("button",{onClick:t,className:"p-2 text-text-secondary hover:text-text-primary hover:bg-surface-hover rounded-lg transition-colors",children:s.jsx(G,{name:"X",size:20})})]}),s.jsx("div",{className:"p-6",children:i?s.jsxs("form",{onSubmit:h,className:"space-y-6",children:[d.contact&&s.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-600 p-4 rounded-lg flex items-start space-x-2",children:[s.jsx(G,{name:"AlertCircle",size:20,className:"flex-shrink-0 mt-0.5"}),s.jsx("div",{children:d.contact&&s.jsx("p",{children:d.contact})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:["First Name ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",name:"first_name",value:c.first_name,onChange:m,className:`w-full px-3 py-2 border ${d.first_name?"border-red-500":"border-border"} rounded-lg focus:ring-2 focus:ring-primary focus:border-primary`}),d.first_name&&s.jsx("p",{className:"text-sm text-red-500 mt-1",children:d.first_name})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Last Name"}),s.jsx("input",{type:"text",name:"last_name",value:c.last_name,onChange:m,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:["Email ",s.jsx("span",{className:"text-gray-500 text-xs",children:"(Email or Phone required)"})]}),s.jsx("input",{type:"text",name:"email",value:c.email,onChange:m,placeholder:"email@example.com",className:`w-full px-3 py-2 border ${d.contact||d.email?"border-red-500":"border-border"} rounded-lg focus:ring-2 focus:ring-primary focus:border-primary`}),d.email&&s.jsx("p",{className:"text-sm text-red-500 mt-1",children:d.email})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:["Phone ",s.jsx("span",{className:"text-gray-500 text-xs",children:"(Email or Phone required)"})]}),s.jsx("input",{type:"tel",name:"phone",value:c.phone,onChange:m,placeholder:"10 digit phone number",className:`w-full px-3 py-2 border ${d.contact||d.phone?"border-red-500":"border-border"} rounded-lg focus:ring-2 focus:ring-primary focus:border-primary`}),d.phone&&s.jsx("p",{className:"text-sm text-red-500 mt-1",children:d.phone})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Company Name"}),s.jsx("input",{type:"text",name:"company_name",value:c.company_name,onChange:m,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Job Title"}),s.jsx("input",{type:"text",name:"job_title",value:c.job_title,onChange:m,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Industry"}),s.jsx("input",{type:"text",name:"industry",value:c.industry,onChange:m,placeholder:"e.g., Technology, Healthcare",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Website"}),s.jsx("input",{type:"url",name:"website",value:c.website,onChange:m,placeholder:"https://example.com",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"LinkedIn URL"}),s.jsx("input",{type:"url",name:"linkedin_url",value:c.linkedin_url,onChange:m,placeholder:"https://linkedin.com/in/...",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Twitter Handle"}),s.jsx("input",{type:"text",name:"twitter_handle",value:c.twitter_handle,onChange:m,placeholder:"@username",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"City"}),s.jsx("input",{type:"text",name:"city",value:c.city,onChange:m,placeholder:"e.g., San Francisco",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"State"}),s.jsx("input",{type:"text",name:"state",value:c.state,onChange:m,placeholder:"e.g., California",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Country"}),s.jsx("input",{type:"text",name:"country",value:c.country,onChange:m,placeholder:"e.g., United States",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Status"}),s.jsx("select",{name:"status",value:c.status,onChange:m,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",disabled:c.status==="converted",children:u.map(v=>s.jsx("option",{value:v.value,children:v.label},v.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Lead Score (0-100)"}),s.jsx("input",{type:"number",name:"lead_score",value:c.lead_score,onChange:m,min:"0",max:"100",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Description"}),s.jsx("textarea",{name:"description",value:c.description,onChange:m,rows:"3",placeholder:"Brief description of the prospect...",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary resize-none"})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Notes"}),s.jsx("textarea",{name:"notes",value:c.notes,onChange:m,rows:"4",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]})]}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{type:"button",onClick:()=>o(!1),className:"flex-1 btn-secondary",children:"Cancel"}),s.jsx("button",{type:"submit",className:"flex-1 btn-primary",children:"Save Changes"})]})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-4",children:"Contact Information"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Email"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"Mail",size:16,className:"text-text-tertiary"}),s.jsx("span",{className:"text-text-primary",children:e.email})]})]}),e.phone&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Phone"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"Phone",size:16,className:"text-text-tertiary"}),s.jsx("span",{className:"text-text-primary",children:e.phone})]})]}),e.company_name&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Company"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"Building",size:16,className:"text-text-tertiary"}),s.jsx("span",{className:"text-text-primary",children:e.company_name})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Status"}),s.jsx("span",{className:"text-text-primary",children:e.status})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Lead Score"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 max-w-[120px]",children:s.jsx("div",{className:`h-2 rounded-full ${e.lead_score>=75?"bg-green-500":e.lead_score>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${e.lead_score||0}%`}})}),s.jsx("span",{className:"text-text-primary font-medium",children:e.lead_score||0})]})]}),e.source&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Source"}),s.jsx("span",{className:"text-text-primary",children:e.source})]})]})]}),e.notes&&s.jsxs("div",{children:[s.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-2",children:"Notes"}),s.jsx("p",{className:"text-text-secondary",children:e.notes})]}),e.status==="converted"&&e.converted_to_contact_id&&s.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(G,{name:"CheckCircle",size:20,className:"text-green-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-semibold text-green-900 mb-1",children:"Converted to Contact"}),s.jsxs("p",{className:"text-sm text-green-700",children:["Contact ID: ",e.converted_to_contact_id.slice(0,8)]}),e.converted_at&&s.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["Converted on ",new Date(e.converted_at).toLocaleString()]})]})]})}),s.jsxs("div",{className:"flex space-x-3 pt-4 border-t border-border",children:[a(["prospects.edit_all","prospects.edit_own"])&&s.jsxs("button",{onClick:()=>o(!0),className:"flex-1 btn-secondary flex items-center justify-center space-x-2",children:[s.jsx(G,{name:"Edit",size:16}),s.jsx("span",{children:"Edit Prospect"})]}),((g=e.status)==null?void 0:g.toLowerCase())!=="converted"&&a(["prospects.convert"])&&s.jsxs("button",{onClick:n,className:"flex-1 btn-primary flex items-center justify-center space-x-2",children:[s.jsx(G,{name:"UserPlus",size:16}),s.jsx("span",{children:"Convert to Contact"})]})]})]})})]})})},ORe=({prospect:e,onClose:t,onConvert:r})=>{const[n,a]=R.useState(!1),[i,o]=R.useState({notes:"",create_activity:!0}),c=async()=>{var u,d;if(!n){a(!0);try{const f=await jr.convertProspectToContact(e.id,i);Be.success("Prospect converted to contact successfully!"),r(f)}catch(f){console.error("Error converting prospect:",f),(u=f==null?void 0:f.message)!=null&&u.includes("duplicate")||(d=f==null?void 0:f.message)!=null&&d.includes("already exists")?Be.error("A contact with this email already exists"):Be.error("Failed to convert prospect. Please try again.")}finally{a(!1)}}},l=u=>{const{name:d,value:f,type:h,checked:m}=u.target;o(x=>({...x,[d]:h==="checkbox"?m:f}))};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-surface rounded-lg max-w-2xl w-full",children:[s.jsx("div",{className:"px-6 py-4 border-b border-border",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center",children:s.jsx(G,{name:"UserPlus",size:20,className:"text-primary"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Convert Prospect to Contact"}),s.jsxs("p",{className:"text-sm text-text-secondary",children:[e.first_name," ",e.last_name]})]})]}),s.jsx("button",{onClick:t,disabled:n,className:"p-2 text-text-secondary hover:text-text-primary hover:bg-surface-hover rounded-lg transition-colors disabled:opacity-50",children:s.jsx(G,{name:"X",size:20})})]})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-3",children:"Prospect Information"}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-blue-700 font-medium",children:"Name:"}),s.jsxs("span",{className:"text-blue-900 ml-2",children:[e.first_name," ",e.last_name]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-blue-700 font-medium",children:"Email:"}),s.jsx("span",{className:"text-blue-900 ml-2",children:e.email})]}),e.phone&&s.jsxs("div",{children:[s.jsx("span",{className:"text-blue-700 font-medium",children:"Phone:"}),s.jsx("span",{className:"text-blue-900 ml-2",children:e.phone})]}),e.company&&s.jsxs("div",{children:[s.jsx("span",{className:"text-blue-700 font-medium",children:"Company:"}),s.jsx("span",{className:"text-blue-900 ml-2",children:e.company})]}),e.job_title&&s.jsxs("div",{children:[s.jsx("span",{className:"text-blue-700 font-medium",children:"Title:"}),s.jsx("span",{className:"text-blue-900 ml-2",children:e.job_title})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-blue-700 font-medium",children:"Lead Score:"}),s.jsx("span",{className:"text-blue-900 ml-2",children:e.lead_score||0})]})]})]}),s.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(G,{name:"Info",size:20,className:"text-green-600 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"text-sm font-semibold text-green-900 mb-1",children:"What happens when you convert?"}),s.jsxs("ul",{className:"text-sm text-green-700 space-y-1 list-disc list-inside",children:[s.jsx("li",{children:"A new contact will be created with the prospect's information"}),s.jsx("li",{children:'The prospect status will be changed to "Converted"'}),s.jsx("li",{children:"Campaign associations will be maintained"}),s.jsx("li",{children:"An activity log entry will be created (if enabled below)"})]})]})]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Conversion Notes (Optional)"}),s.jsx("textarea",{name:"notes",value:i.notes,onChange:l,rows:"3",placeholder:"Add any notes about this conversion...",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",disabled:n})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",id:"create_activity",name:"create_activity",checked:i.create_activity,onChange:l,className:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary",disabled:n}),s.jsx("label",{htmlFor:"create_activity",className:"ml-2 text-sm text-text-primary",children:"Create activity log entry for this conversion"})]})]}),s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(G,{name:"AlertTriangle",size:20,className:"text-yellow-600 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"text-sm font-semibold text-yellow-900 mb-1",children:"Important Note"}),s.jsx("p",{className:"text-sm text-yellow-700",children:"This action cannot be undone. The prospect will be marked as converted and a new contact record will be created."})]})]})})]}),s.jsxs("div",{className:"px-6 py-4 border-t border-border flex space-x-3",children:[s.jsx("button",{onClick:t,disabled:n,className:"flex-1 btn-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),s.jsx("button",{onClick:c,disabled:n,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:n?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx("span",{children:"Converting..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(G,{name:"UserPlus",size:16}),s.jsx("span",{children:"Convert to Contact"})]})})]})]})})},PRe=({campaignId:e,onClose:t,onSubmit:r})=>{const[n,a]=R.useState({first_name:"",last_name:"",email:"",phone:"",company_name:"",job_title:"",industry:"",description:"",notes:"",status:"new",lead_score:0,source:"manual_entry",source_details:"",linkedin_url:"",twitter_handle:"",website:"",city:"",state:"",country:""}),[i,o]=R.useState(!1),[c,l]=R.useState({}),u=[{value:"new",label:"New"},{value:"converted",label:"Converted"},{value:"rejected",label:"Rejected"}],d=[{value:"email_campaign",label:"Email Campaign"},{value:"web_form",label:"Web Form"},{value:"phone",label:"Phone"},{value:"social_media",label:"Social Media"},{value:"manual_entry",label:"Manual Entry"},{value:"referral",label:"Referral"},{value:"other",label:"Other"}],f=m=>{const{name:x,value:p}=m.target;a(g=>({...g,[x]:p})),c[x]&&l(g=>{const v={...g};return delete v[x],v})},h=async m=>{var x,p,g,v,y;m.preventDefault(),o(!0),l({});try{const b={};if((x=n.first_name)!=null&&x.trim()||(b.first_name="First name is required"),!((p=n.email)!=null&&p.trim())&&!((g=n.phone)!=null&&g.trim())&&(b.contact="Either email or phone number is required"),(v=n.email)!=null&&v.trim()&&(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.email.trim())||(b.email="Please enter a valid email address")),(y=n.phone)!=null&&y.trim()&&n.phone.replace(/\D/g,"").length!==10&&(b.phone="Phone number must be exactly 10 digits"),Object.keys(b).length>0){l(b),o(!1);return}await r({...n,campaign_id:e})}catch(b){l({submit:b.message||"Failed to create prospect"})}finally{o(!1)}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-hidden flex flex-col relative z-[10000]",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 bg-indigo-100 dark:bg-indigo-900 rounded-full flex items-center justify-center",children:s.jsx(G,{name:"UserPlus",size:20,className:"text-indigo-600 dark:text-indigo-400"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Add New Prospect"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Create a new prospect for this campaign"})]})]}),s.jsx("button",{onClick:t,disabled:i,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors disabled:opacity-50",children:s.jsx(G,{name:"X",size:20})})]}),s.jsx("form",{onSubmit:h,className:"flex-1 overflow-y-auto p-6",children:s.jsxs("div",{className:"space-y-5",children:[(c.submit||c.contact)&&s.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-600 dark:text-red-400 p-4 rounded-lg flex items-start space-x-2",children:[s.jsx(G,{name:"AlertCircle",size:20,className:"flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[c.submit&&s.jsx("p",{children:c.submit}),c.contact&&s.jsx("p",{children:c.contact})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:["First Name ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",name:"first_name",value:n.first_name,onChange:f,className:`w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border ${c.first_name?"border-red-500":"border-gray-300 dark:border-gray-600"} rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors`,disabled:i}),c.first_name&&s.jsx("p",{className:"text-sm text-red-500 mt-1",children:c.first_name})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Last Name"}),s.jsx("input",{type:"text",name:"last_name",value:n.last_name,onChange:f,className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",disabled:i})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:["Email ",s.jsx("span",{className:"text-gray-500 text-xs",children:"(Email or Phone required)"})]}),s.jsx("input",{type:"text",name:"email",value:n.email,onChange:f,placeholder:"email@example.com",className:`w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border ${c.contact||c.email?"border-red-500":"border-gray-300 dark:border-gray-600"} rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors`,disabled:i}),c.email&&s.jsx("p",{className:"text-sm text-red-500 mt-1",children:c.email})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:["Phone ",s.jsx("span",{className:"text-gray-500 text-xs",children:"(Email or Phone required)"})]}),s.jsx("input",{type:"tel",name:"phone",value:n.phone,onChange:f,placeholder:"10 digit phone number",className:`w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border ${c.contact||c.phone?"border-red-500":"border-gray-300 dark:border-gray-600"} rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors`,disabled:i}),c.phone&&s.jsx("p",{className:"text-sm text-red-500 mt-1",children:c.phone})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Company Name"}),s.jsx("input",{type:"text",name:"company_name",value:n.company_name,onChange:f,className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",disabled:i})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Job Title"}),s.jsx("input",{type:"text",name:"job_title",value:n.job_title,onChange:f,className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",disabled:i})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Status"}),s.jsx("select",{name:"status",value:n.status,onChange:f,className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white transition-colors",disabled:i,children:u.map(m=>s.jsx("option",{value:m.value,children:m.label},m.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Lead Score (0-100)"}),s.jsx("input",{type:"number",name:"lead_score",value:n.lead_score,onChange:f,min:"0",max:"100",className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",disabled:i})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Source"}),s.jsx("select",{name:"source",value:n.source,onChange:f,className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white transition-colors",disabled:i,children:d.map(m=>s.jsx("option",{value:m.value,children:m.label},m.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Industry"}),s.jsx("input",{type:"text",name:"industry",value:n.industry,onChange:f,placeholder:"e.g., Technology, Healthcare",className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",disabled:i})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Website"}),s.jsx("input",{type:"url",name:"website",value:n.website,onChange:f,placeholder:"https://example.com",className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",disabled:i})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"LinkedIn URL"}),s.jsx("input",{type:"url",name:"linkedin_url",value:n.linkedin_url,onChange:f,placeholder:"https://linkedin.com/in/...",className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",disabled:i})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Twitter Handle"}),s.jsx("input",{type:"text",name:"twitter_handle",value:n.twitter_handle,onChange:f,placeholder:"@username",className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",disabled:i})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"City"}),s.jsx("input",{type:"text",name:"city",value:n.city,onChange:f,placeholder:"e.g., San Francisco",className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",disabled:i})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"State"}),s.jsx("input",{type:"text",name:"state",value:n.state,onChange:f,placeholder:"e.g., California",className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",disabled:i})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Country"}),s.jsx("input",{type:"text",name:"country",value:n.country,onChange:f,placeholder:"e.g., United States",className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",disabled:i})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Source Details"}),s.jsx("input",{type:"text",name:"source_details",value:n.source_details,onChange:f,placeholder:"Additional context about the source...",className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",disabled:i})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Description"}),s.jsx("textarea",{name:"description",value:n.description,onChange:f,rows:"3",placeholder:"Brief description of the prospect...",className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors resize-none",disabled:i})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Notes"}),s.jsx("textarea",{name:"notes",value:n.notes,onChange:f,rows:"3",placeholder:"Add any additional notes about this prospect...",className:"w-full px-3.5 py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:focus:ring-indigo-400 dark:focus:border-indigo-400 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors resize-none",disabled:i})]})]})]})}),s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex space-x-3",children:[s.jsx("button",{type:"button",onClick:t,disabled:i,className:"flex-1 px-4 py-2.5 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),s.jsx("button",{type:"submit",onClick:h,disabled:i,className:"flex-1 px-4 py-2.5 bg-indigo-600 hover:bg-indigo-700 dark:bg-indigo-500 dark:hover:bg-indigo-600 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:i?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx("span",{children:"Creating..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(G,{name:"UserPlus",size:16}),s.jsx("span",{children:"Create Prospect"})]})})]})]})})},IRe=({prospect:e,campaignId:t,onClose:r,onSuccess:n})=>{const[a,i]=R.useState(!1),[o,c]=R.useState({name:`Deal - ${e.first_name} ${e.last_name}`,value:"",stage:"lead",probability:10,description:`Deal created from campaign prospect: ${e.first_name} ${e.last_name}`,expected_close_date:""}),l=[{value:"lead",label:"Lead",probability:10},{value:"qualified",label:"Qualified",probability:25},{value:"proposal",label:"Proposal",probability:50},{value:"negotiation",label:"Negotiation",probability:75},{value:"closed_won",label:"Closed Won",probability:100},{value:"closed_lost",label:"Closed Lost",probability:0}],u=f=>{const{name:h,value:m}=f.target;if(h==="stage"){const x=l.find(p=>p.value===m);c(p=>({...p,[h]:m,probability:x?x.probability:p.probability}))}else c(x=>({...x,[h]:m}))},d=async f=>{f.preventDefault(),i(!0);try{let h=e.contact_id;if(!h){const{data:g}=await be.get(`/api/v1/contacts?email=${e.email}`);g&&g.length>0&&(h=g[0].id)}if(!h){Be.error("Could not find the contact for this prospect. Please convert the prospect first."),i(!1);return}const m={name:o.name,value:parseFloat(o.value)||0,stage:o.stage,probability:parseInt(o.probability),description:o.description,expected_close_date:o.expected_close_date||null,contact_id:h},{data:x,error:p}=await be.post("/api/v1/deals",m);if(p)throw p;try{const{error:g}=await be.post(`/api/v1/campaigns/${t}/prospects/${e.id}/link-deal`,{deal_id:x.id,conversion_value:parseFloat(o.value)||0});if(g)if(g.status===404){console.log(" Prospect not in campaign audience, adding now...");try{await be.post(`/api/v1/campaigns/${t}/audience`,{contact_ids:[],prospect_ids:[e.id]});const{error:v}=await be.post(`/api/v1/campaigns/${t}/prospects/${e.id}/link-deal`,{deal_id:x.id,conversion_value:parseFloat(o.value)||0});v?(console.error(" Error linking deal after adding to audience:",v),Be.warning("Deal created but could not link to campaign.")):console.log(" Successfully linked deal to campaign after adding to audience")}catch(v){console.error(" Error adding prospect to audience:",v),Be.warning("Deal created but could not link to campaign.")}}else console.error(" Error linking deal to campaign:",g),Be.warning("Deal created but could not link to campaign.");else console.log(" Successfully linked deal to campaign")}catch(g){console.error(" Error linking deal to campaign:",g),Be.warning("Deal created but could not link to campaign.")}Be.success("Deal created successfully and linked to campaign!"),n(x),r()}catch(h){console.error("Error creating deal:",h),Be.error((h==null?void 0:h.detail)||"Failed to create deal. Please try again.")}finally{i(!1)}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-surface rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsx("div",{className:"sticky top-0 bg-surface px-6 py-4 border-b border-border",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:s.jsx(G,{name:"DollarSign",size:20,className:"text-green-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Create Deal from Prospect"}),s.jsxs("p",{className:"text-sm text-text-secondary",children:[e.first_name," ",e.last_name]})]})]}),s.jsx("button",{onClick:r,disabled:a,className:"p-2 text-text-secondary hover:text-text-primary hover:bg-surface-hover rounded-lg transition-colors disabled:opacity-50",children:s.jsx(G,{name:"X",size:20})})]})}),s.jsx("form",{onSubmit:d,className:"p-6",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Prospect Information"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-blue-700",children:"Email:"}),s.jsx("span",{className:"text-blue-900 ml-2",children:e.email})]}),e.phone&&s.jsxs("div",{children:[s.jsx("span",{className:"text-blue-700",children:"Phone:"}),s.jsx("span",{className:"text-blue-900 ml-2",children:e.phone})]}),e.company&&s.jsxs("div",{children:[s.jsx("span",{className:"text-blue-700",children:"Company:"}),s.jsx("span",{className:"text-blue-900 ml-2",children:e.company})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-blue-700",children:"Lead Score:"}),s.jsx("span",{className:"text-blue-900 ml-2",children:e.lead_score||0})]})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:["Deal Name ",s.jsx("span",{className:"text-error",children:"*"})]}),s.jsx("input",{type:"text",name:"name",value:o.name,onChange:u,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",required:!0,disabled:a})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:["Deal Value ",s.jsx("span",{className:"text-error",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary",children:"$"}),s.jsx("input",{type:"number",name:"value",value:o.value,onChange:u,step:"0.01",min:"0",placeholder:"0.00",className:"w-full pl-8 pr-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",required:!0,disabled:a})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Deal Stage"}),s.jsx("select",{name:"stage",value:o.stage,onChange:u,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",disabled:a,children:l.map(f=>s.jsx("option",{value:f.value,children:f.label},f.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Probability (%)"}),s.jsx("input",{type:"number",name:"probability",value:o.probability,onChange:u,min:"0",max:"100",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",disabled:a})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Expected Close Date"}),s.jsx("input",{type:"date",name:"expected_close_date",value:o.expected_close_date,onChange:u,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",disabled:a})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Description"}),s.jsx("textarea",{name:"description",value:o.description,onChange:u,rows:"3",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",disabled:a})]}),s.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(G,{name:"Info",size:20,className:"text-green-600 mt-0.5"}),s.jsx("div",{className:"flex-1 text-sm text-green-700",children:"This deal will be created and linked to this campaign. It will appear in the Conversions tab with revenue tracking."})]})}),s.jsxs("div",{className:"flex space-x-3 pt-4 border-t border-border",children:[s.jsx("button",{type:"button",onClick:r,disabled:a,className:"flex-1 btn-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:a,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:a?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx("span",{children:"Creating..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(G,{name:"DollarSign",size:16}),s.jsx("span",{children:"Create Deal"})]})})]})]})})]})})},URe=({campaignId:e})=>{const{hasAnyPermission:t}=Pt(),[r,n]=R.useState([]),[a,i]=R.useState(!0),[o,c]=R.useState(null),[l,u]=R.useState(null),[d,f]=R.useState(!1),[h,m]=R.useState(!1),[x,p]=R.useState(!1),[g,v]=R.useState(!1),[y,b]=R.useState("all"),[_,w]=R.useState(""),j=[{value:"new",label:"New",color:"bg-blue-100 text-blue-800"},{value:"converted",label:"Converted",color:"bg-green-100 text-green-800"},{value:"rejected",label:"Rejected",color:"bg-red-100 text-red-800"}];R.useEffect(()=>{e&&N()},[e]);const N=async()=>{i(!0),c(null);try{const F=await jr.getCampaignProspects(e);n(F||[])}catch(F){console.error("Error loading prospects:",F),c("Failed to load prospects. Please try again.")}finally{i(!1)}},D=F=>{u(F),f(!0)},S=F=>{u(F),m(!0)},T=async F=>{m(!1),u(null),Be.success("Prospect converted to contact successfully!"),await N()},A=async(F,I)=>{try{await jr.updateProspect(F,I),Be.success("Prospect updated successfully!"),await N()}catch(L){console.error("Error updating prospect:",L),Be.error("Failed to update prospect. Please try again.")}},E=async F=>{try{const I=await jr.createProspect(F);try{await jr.addAudience(e,{contact_ids:[],prospect_ids:[I.id]}),console.log(" Prospect added to campaign audience")}catch(L){console.error(" Failed to add prospect to campaign audience:",L)}Be.success("Prospect created successfully!"),await N(),p(!1)}catch(I){throw console.error("Error creating prospect:",I),Be.error("Failed to create prospect. Please try again."),I}},M=F=>{u(F),v(!0)},P=async F=>{console.log("Deal created:",F),await N()},X=async F=>{if(window.confirm(`Are you sure you want to delete ${F.first_name} ${F.last_name}? This action cannot be undone.`))try{await jr.deleteProspect(F.id),Be.success("Prospect deleted successfully!"),await N()}catch(I){console.error("Error deleting prospect:",I),Be.error("Failed to delete prospect. Please try again.")}},q=F=>{var L;const I=(F||"").toLowerCase();return((L=j.find(C=>C.value===I))==null?void 0:L.color)||"bg-gray-100 text-gray-800"},B=F=>{var L;const I=(F||"").toLowerCase();return((L=j.find(C=>C.value===I))==null?void 0:L.label)||F},O=r.filter(F=>{const I=(F.status||"").toLowerCase(),L=y==="all"||I===y,C=!_||(F.first_name||"").toLowerCase().includes(_.toLowerCase())||(F.last_name||"").toLowerCase().includes(_.toLowerCase())||(F.email||"").toLowerCase().includes(_.toLowerCase())||(F.company_name||"").toLowerCase().includes(_.toLowerCase());return L&&C});return a?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),s.jsx("p",{className:"text-text-secondary",children:"Loading prospects..."})]}):o?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(G,{name:"AlertCircle",size:48,className:"text-error mx-auto mb-4"}),s.jsx("p",{className:"text-error mb-4",children:o}),s.jsx("button",{onClick:N,className:"btn-primary",children:"Retry"})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Campaign Prospects"}),s.jsxs("p",{className:"text-sm text-text-secondary",children:[O.length," prospect",O.length!==1?"s":"",(y!=="all"||_)&&` (${r.length} total)`]})]}),t(["prospects.create"])&&s.jsxs("button",{onClick:()=>p(!0),className:"btn-primary flex items-center space-x-2",children:[s.jsx(G,{name:"UserPlus",size:16}),s.jsx("span",{children:"Add Prospect"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(G,{name:"Search",size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary"}),s.jsx("input",{type:"text",placeholder:"Search prospects by name, email, or company...",value:_,onChange:F=>w(F.target.value),className:"w-full pl-10 pr-4 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary text-text-primary placeholder-text-tertiary"}),_&&s.jsx("button",{onClick:()=>w(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-text-tertiary hover:text-text-primary",children:s.jsx(G,{name:"X",size:16})})]}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs("button",{onClick:()=>b("all"),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${y==="all"?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["All (",r.length,")"]}),j.map(F=>{const I=r.filter(L=>(L.status||"").toLowerCase()===F.value).length;return s.jsxs("button",{onClick:()=>b(F.value),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${y===F.value?"bg-primary text-white":`${F.color} hover:opacity-80`}`,children:[F.label," (",I,")"]},F.value)})]})]}),O.length===0?s.jsxs("div",{className:"text-center py-12 bg-surface rounded-lg border border-border",children:[s.jsx(G,{name:"Users",size:48,className:"text-text-tertiary mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:y==="all"&&!_?"No prospects yet":"No prospects found"}),s.jsx("p",{className:"text-text-secondary",children:y==="all"&&!_?"Prospects from this campaign will appear here":"Try adjusting your filters or search query"})]}):s.jsx("div",{className:"bg-surface rounded-lg border border-border overflow-hidden",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Prospect"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Contact Info"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Company"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Lead Score"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Source"}),s.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-border",children:O.map(F=>{var I,L;return s.jsxs("tr",{className:"hover:bg-surface-hover transition-colors duration-150 cursor-pointer",onClick:()=>D(F),children:[s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-primary font-medium",children:(((I=F.first_name)==null?void 0:I[0])||"")+(((L=F.last_name)==null?void 0:L[0])||"")})}),s.jsxs("div",{children:[s.jsxs("div",{className:"text-sm font-medium text-text-primary",children:[F.first_name," ",F.last_name]}),s.jsxs("div",{className:"text-xs text-text-tertiary",children:["ID: ",F.id.slice(0,8)]})]})]})}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"text-sm",children:[F.email&&s.jsxs("div",{className:"flex items-center space-x-2 text-text-secondary",children:[s.jsx(G,{name:"Mail",size:14}),s.jsx("span",{children:F.email})]}),F.phone&&s.jsxs("div",{className:"flex items-center space-x-2 text-text-secondary mt-1",children:[s.jsx(G,{name:"Phone",size:14}),s.jsx("span",{children:F.phone})]})]})}),s.jsx("td",{className:"px-6 py-4 text-sm text-text-primary",children:F.company_name||"-"}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${q(F.status)}`,children:B(F.status)})}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 max-w-[80px]",children:s.jsx("div",{className:`h-2 rounded-full transition-all ${F.lead_score>=75?"bg-green-500":F.lead_score>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${F.lead_score||0}%`}})}),s.jsx("span",{className:"text-sm font-medium text-text-primary",children:F.lead_score||0})]})}),s.jsx("td",{className:"px-6 py-4 text-sm text-text-secondary",children:F.source||"-"}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:s.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[(F.status||"").toLowerCase()==="converted"&&s.jsx("button",{onClick:C=>{C.stopPropagation(),M(F)},className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors duration-150",title:"Create deal from this prospect",children:s.jsx(G,{name:"DollarSign",size:16})}),(F.status||"").toLowerCase()!=="converted"&&t(["prospects.convert"])&&s.jsx("button",{onClick:C=>{C.stopPropagation(),S(F)},className:"p-2 text-primary hover:bg-primary-50 rounded-lg transition-colors duration-150",title:"Convert to contact",children:s.jsx(G,{name:"UserPlus",size:16})}),s.jsx("button",{onClick:C=>{C.stopPropagation(),D(F)},className:"p-2 text-text-secondary hover:bg-surface-hover rounded-lg transition-colors duration-150",title:"View details",children:s.jsx(G,{name:"Eye",size:16})}),s.jsx("button",{onClick:C=>{C.stopPropagation(),X(F)},className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors duration-150",title:"Delete prospect",children:s.jsx(G,{name:"Trash2",size:16})})]})})]},F.id)})})]})})}),d&&l&&s.jsx(FRe,{prospect:l,onClose:()=>{f(!1),u(null)},onUpdate:A,onConvert:()=>{f(!1),m(!0)}}),h&&l&&s.jsx(ORe,{prospect:l,onClose:()=>{m(!1),u(null)},onConvert:T}),x&&s.jsx(PRe,{campaignId:e,onClose:()=>p(!1),onSubmit:E}),g&&l&&s.jsx(IRe,{prospect:l,campaignId:e,onClose:()=>{v(!1),u(null)},onSuccess:P})]})},RRe=({campaignId:e})=>{var h,m,x,p,g,v,y,b,_,w;const[t,r]=R.useState(null),[n,a]=R.useState([]),[i,o]=R.useState(!0),[c,l]=R.useState(null),[u,d]=R.useState(30);R.useEffect(()=>{e&&f()},[e,u]);const f=async()=>{o(!0),l(null);try{const[j,N]=await Promise.all([jr.getCampaignMetrics(e),jr.getCampaignAnalytics(e,u)]);r(j),a(N||[])}catch(j){console.error("Error loading performance data:",j),l("Failed to load performance data. Please try again.")}finally{o(!1)}};return i?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),s.jsx("p",{className:"text-text-secondary",children:"Loading performance data..."})]}):c?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(G,{name:"AlertCircle",size:48,className:"text-error mx-auto mb-4"}),s.jsx("p",{className:"text-error mb-4",children:c}),s.jsx("button",{onClick:f,className:"btn-primary",children:"Retry"})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Performance Analytics"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-sm text-text-secondary",children:"Time Range:"}),s.jsxs("select",{value:u,onChange:j=>d(Number(j.target.value)),className:"text-sm border border-border rounded-md px-3 py-1.5 bg-surface",children:[s.jsx("option",{value:7,children:"Last 7 days"}),s.jsx("option",{value:30,children:"Last 30 days"}),s.jsx("option",{value:60,children:"Last 60 days"}),s.jsx("option",{value:90,children:"Last 90 days"})]})]})]}),t&&s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-sm font-medium text-blue-700",children:"Open Rate"}),s.jsx(G,{name:"Mail",size:16,className:"text-blue-600"})]}),s.jsxs("div",{className:"text-2xl font-semibold text-blue-900",children:[((h=t.open_rate)==null?void 0:h.toFixed(1))||0,"%"]}),s.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[t.opened_count||0," / ",t.sent_count||0]})]}),s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-sm font-medium text-green-700",children:"Click Rate"}),s.jsx(G,{name:"MousePointer",size:16,className:"text-green-600"})]}),s.jsxs("div",{className:"text-2xl font-semibold text-green-900",children:[((m=t.click_rate)==null?void 0:m.toFixed(1))||0,"%"]}),s.jsxs("div",{className:"text-xs text-green-600 mt-1",children:[t.clicked_count||0," / ",t.sent_count||0]})]}),s.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-sm font-medium text-purple-700",children:"Conversion Rate"}),s.jsx(G,{name:"TrendingUp",size:16,className:"text-purple-600"})]}),s.jsxs("div",{className:"text-2xl font-semibold text-purple-900",children:[((x=t.conversion_rate)==null?void 0:x.toFixed(1))||0,"%"]}),s.jsxs("div",{className:"text-xs text-purple-600 mt-1",children:[t.converted_count||0," conversions"]})]}),s.jsxs("div",{className:`border rounded-lg p-4 ${(t.roi||0)>=0?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:`text-sm font-medium ${(t.roi||0)>=0?"text-green-700":"text-red-700"}`,children:"ROI"}),s.jsx(G,{name:"DollarSign",size:16,className:(t.roi||0)>=0?"text-green-600":"text-red-600"})]}),s.jsxs("div",{className:`text-2xl font-semibold ${(t.roi||0)>=0?"text-green-900":"text-red-900"}`,children:[((p=t.roi)==null?void 0:p.toFixed(1))||0,"%"]})]})]}),n.length>0&&s.jsxs("div",{className:"bg-surface rounded-lg border border-border p-6",children:[s.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-4",children:"Engagement Trends"}),s.jsx(zn,{width:"100%",height:300,children:s.jsxs(sx,{data:n,children:[s.jsx(xi,{strokeDasharray:"3 3"}),s.jsx(ta,{dataKey:"period_start",tickFormatter:j=>new Date(j).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),s.jsx(ra,{}),s.jsx(_r,{labelFormatter:j=>new Date(j).toLocaleDateString()}),s.jsx(ao,{}),s.jsx(Dn,{type:"monotone",dataKey:"open_rate",name:"Open Rate (%)",stroke:"#3b82f6",strokeWidth:2}),s.jsx(Dn,{type:"monotone",dataKey:"click_rate",name:"Click Rate (%)",stroke:"#10b981",strokeWidth:2}),s.jsx(Dn,{type:"monotone",dataKey:"conversion_rate",name:"Conversion Rate (%)",stroke:"#8b5cf6",strokeWidth:2})]})})]}),t&&s.jsxs("div",{className:"bg-surface rounded-lg border border-border p-6",children:[s.jsx("h4",{className:"text-lg font-semibold text-text-primary mb-4",children:"Engagement Funnel"}),s.jsx(zn,{width:"100%",height:300,children:s.jsxs(xl,{data:[{name:"Sent",count:t.sent_count||0,percentage:100},{name:"Delivered",count:t.delivered_count||0,percentage:t.sent_count>0?(t.delivered_count/t.sent_count*100).toFixed(1):0},{name:"Opened",count:t.opened_count||0,percentage:t.sent_count>0?(t.opened_count/t.sent_count*100).toFixed(1):0},{name:"Clicked",count:t.clicked_count||0,percentage:t.sent_count>0?(t.clicked_count/t.sent_count*100).toFixed(1):0},{name:"Responded",count:t.responded_count||0,percentage:t.sent_count>0?(t.responded_count/t.sent_count*100).toFixed(1):0},{name:"Converted",count:t.converted_count||0,percentage:t.sent_count>0?(t.converted_count/t.sent_count*100).toFixed(1):0}],children:[s.jsx(xi,{strokeDasharray:"3 3"}),s.jsx(ta,{dataKey:"name"}),s.jsx(ra,{}),s.jsx(_r,{formatter:(j,N)=>N==="percentage"?[`${j}%`,"Percentage"]:[j,"Count"]}),s.jsx(ao,{}),s.jsx(Ea,{dataKey:"count",name:"Count",fill:"#3b82f6"})]})})]}),t&&s.jsxs("div",{className:"bg-surface rounded-lg border border-border overflow-hidden",children:[s.jsx("div",{className:"px-6 py-4 border-b border-border",children:s.jsx("h4",{className:"text-lg font-semibold text-text-primary",children:"Detailed Metrics"})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Metric"}),s.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Count"}),s.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Rate"})]})}),s.jsxs("tbody",{className:"bg-white divide-y divide-border",children:[s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4 text-sm text-text-primary",children:"Sent"}),s.jsx("td",{className:"px-6 py-4 text-sm text-right font-medium text-text-primary",children:t.sent_count||0}),s.jsx("td",{className:"px-6 py-4 text-sm text-right text-text-secondary",children:"-"})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4 text-sm text-text-primary",children:"Delivered"}),s.jsx("td",{className:"px-6 py-4 text-sm text-right font-medium text-text-primary",children:t.delivered_count||0}),s.jsxs("td",{className:"px-6 py-4 text-sm text-right text-text-secondary",children:[t.sent_count>0?(t.delivered_count/t.sent_count*100).toFixed(1):0,"%"]})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4 text-sm text-text-primary",children:"Opened"}),s.jsx("td",{className:"px-6 py-4 text-sm text-right font-medium text-primary",children:t.opened_count||0}),s.jsxs("td",{className:"px-6 py-4 text-sm text-right text-primary font-medium",children:[((g=t.open_rate)==null?void 0:g.toFixed(1))||0,"%"]})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4 text-sm text-text-primary",children:"Clicked"}),s.jsx("td",{className:"px-6 py-4 text-sm text-right font-medium text-text-primary",children:t.clicked_count||0}),s.jsxs("td",{className:"px-6 py-4 text-sm text-right text-text-secondary",children:[((v=t.click_rate)==null?void 0:v.toFixed(1))||0,"%"]})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4 text-sm text-text-primary",children:"Bounced"}),s.jsx("td",{className:"px-6 py-4 text-sm text-right font-medium text-yellow-600",children:t.bounced_count||0}),s.jsxs("td",{className:"px-6 py-4 text-sm text-right text-yellow-600",children:[((y=t.bounce_rate)==null?void 0:y.toFixed(1))||0,"%"]})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4 text-sm text-text-primary",children:"Unsubscribed"}),s.jsx("td",{className:"px-6 py-4 text-sm text-right font-medium text-red-600",children:t.unsubscribed_count||0}),s.jsxs("td",{className:"px-6 py-4 text-sm text-right text-red-600",children:[((b=t.unsubscribe_rate)==null?void 0:b.toFixed(1))||0,"%"]})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4 text-sm text-text-primary",children:"Responded"}),s.jsx("td",{className:"px-6 py-4 text-sm text-right font-medium text-text-primary",children:t.responded_count||0}),s.jsxs("td",{className:"px-6 py-4 text-sm text-right text-text-secondary",children:[((_=t.response_rate)==null?void 0:_.toFixed(1))||0,"%"]})]}),s.jsxs("tr",{className:"bg-green-50",children:[s.jsx("td",{className:"px-6 py-4 text-sm font-medium text-green-900",children:"Converted"}),s.jsx("td",{className:"px-6 py-4 text-sm text-right font-semibold text-green-900",children:t.converted_count||0}),s.jsxs("td",{className:"px-6 py-4 text-sm text-right font-semibold text-green-900",children:[((w=t.conversion_rate)==null?void 0:w.toFixed(1))||0,"%"]})]})]})]})})]})]})},MRe=({campaignId:e,onClose:t,onSuccess:r})=>{const[n,a]=R.useState([]),[i,o]=R.useState([]),[c,l]=R.useState(!0),[u,d]=R.useState(!1),[f,h]=R.useState("contacts"),[m,x]=R.useState(""),[p,g]=R.useState([]);R.useEffect(()=>{v()},[]);const v=async()=>{l(!0);try{const[T,A]=await Promise.all([Nt.getUserContacts(),jr.getProspects()]);console.log(" Loaded contacts:",T==null?void 0:T.length,T==null?void 0:T[0]),console.log(" Loaded prospects:",A==null?void 0:A.length,A==null?void 0:A[0]),a(Array.isArray(T)?T:[]),o(Array.isArray(A)?A:[])}catch(T){console.error("Error loading data:",T),Be.error("Failed to load contacts and prospects")}finally{l(!1)}},y=T=>{g(A=>A.includes(T)?A.filter(E=>E!==T):[...A,T])},b=()=>{const A=(f==="contacts"?w:j).map(E=>E.id);A.every(E=>p.includes(E))?g(E=>E.filter(M=>!A.includes(M))):g(E=>{const M=[...E];return A.forEach(P=>{M.includes(P)||M.push(P)}),M})},_=async()=>{if(p.length===0){Be.error("Please select at least one contact or prospect");return}d(!0);try{const T=p.filter(E=>n.some(M=>M.id===E)),A=p.filter(E=>i.some(M=>M.id===E));await jr.addAudience(e,{contact_ids:T,prospect_ids:A}),Be.success(`Added ${p.length} member${p.length!==1?"s":""} to campaign audience`),r(),t()}catch(T){console.error("Error adding audience:",T),Be.error("Failed to add audience members. Please try again.")}finally{d(!1)}},w=n.filter(T=>{if(!m)return!0;const A=m.toLowerCase(),E=typeof T.company=="object"&&T.company!==null?T.company.name||"":T.company||"";return(T.first_name||"").toLowerCase().includes(A)||(T.last_name||"").toLowerCase().includes(A)||(T.email||"").toLowerCase().includes(A)||E.toLowerCase().includes(A)}),j=i.filter(T=>{if(!m)return!0;const A=m.toLowerCase(),E=T.company_name||T.company||"";return(T.first_name||"").toLowerCase().includes(A)||(T.last_name||"").toLowerCase().includes(A)||(T.email||"").toLowerCase().includes(A)||E.toLowerCase().includes(A)}),N=f==="contacts"?w:j,D=N.map(T=>T.id),S=D.length>0&&D.every(T=>p.includes(T));return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-surface rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-border flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center",children:s.jsx(G,{name:"Users",size:20,className:"text-primary"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Add Campaign Audience"}),s.jsxs("p",{className:"text-sm text-text-secondary",children:[p.length," selected"]})]})]}),s.jsx("button",{onClick:t,disabled:u,className:"p-2 text-text-secondary hover:text-text-primary hover:bg-surface-hover rounded-lg transition-colors disabled:opacity-50",children:s.jsx(G,{name:"X",size:20})})]}),s.jsx("div",{className:"border-b border-border",children:s.jsxs("div",{className:"px-6 flex space-x-4",children:[s.jsxs("button",{onClick:()=>h("contacts"),className:`py-3 px-4 font-medium border-b-2 transition-colors ${f==="contacts"?"border-primary text-primary":"border-transparent text-text-secondary hover:text-text-primary"}`,children:["Contacts (",n.length,")"]}),s.jsxs("button",{onClick:()=>h("prospects"),className:`py-3 px-4 font-medium border-b-2 transition-colors ${f==="prospects"?"border-primary text-primary":"border-transparent text-text-secondary hover:text-text-primary"}`,children:["Prospects (",i.length,")"]})]})}),s.jsx("div",{className:"px-6 py-4 border-b border-border",children:s.jsxs("div",{className:"relative",children:[s.jsx(G,{name:"Search",size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary"}),s.jsx("input",{type:"text",placeholder:`Search ${f}...`,value:m,onChange:T=>x(T.target.value),className:"w-full pl-10 pr-4 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"}),m&&s.jsx("button",{onClick:()=>x(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-text-tertiary hover:text-text-primary",children:s.jsx(G,{name:"X",size:16})})]})}),s.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:c?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),s.jsx("p",{className:"text-text-secondary",children:"Loading..."})]}):N.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(G,{name:"Users",size:48,className:"text-text-tertiary mx-auto mb-4"}),s.jsx("p",{className:"text-text-secondary",children:m?`No ${f} found matching "${m}"`:`No ${f} available`})]}):s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center space-x-3 py-2 px-3 bg-gray-50 rounded-lg",children:[s.jsx("input",{type:"checkbox",checked:S,onChange:b,className:"w-4 h-4 text-primary border-border rounded focus:ring-2 focus:ring-primary"}),s.jsxs("span",{className:"text-sm font-medium text-text-primary",children:["Select All (",N.length,")"]})]}),N.map(T=>{var E,M;const A=f==="contacts"?typeof T.company=="object"&&T.company!==null?T.company.name:T.company:T.company_name||T.company;return s.jsxs("div",{onClick:()=>y(T.id),className:`flex items-center space-x-3 p-3 border rounded-lg cursor-pointer transition-colors ${p.includes(T.id)?"border-primary bg-primary-50":"border-border hover:bg-surface-hover"}`,children:[s.jsx("input",{type:"checkbox",checked:p.includes(T.id),onChange:()=>{},className:"w-4 h-4 text-primary border-border rounded focus:ring-2 focus:ring-primary"}),s.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center flex-shrink-0",children:s.jsx("span",{className:"text-primary font-medium text-sm",children:(((E=T.first_name)==null?void 0:E[0])||"")+(((M=T.last_name)==null?void 0:M[0])||"")})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"text-sm font-medium text-text-primary",children:[T.first_name," ",T.last_name]}),s.jsxs("div",{className:"text-xs text-text-secondary truncate",children:[T.email||"No email",A&&`  ${A}`]})]}),f==="prospects"&&s.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${T.status==="qualified"?"bg-green-100 text-green-800":T.status==="contacted"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:T.status})]},T.id)})]})}),s.jsxs("div",{className:"px-6 py-4 border-t border-border flex space-x-3",children:[s.jsx("button",{type:"button",onClick:t,disabled:u,className:"flex-1 btn-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),s.jsx("button",{type:"button",onClick:_,disabled:u||p.length===0,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:u?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx("span",{children:"Adding..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(G,{name:"UserPlus",size:16}),s.jsxs("span",{children:["Add ",p.length>0?`(${p.length})`:""]})]})})]})]})})},BRe=({campaignId:e})=>{const{hasAnyPermission:t}=Pt(),[r,n]=R.useState([]),[a,i]=R.useState(!0),[o,c]=R.useState(null),[l,u]=R.useState("all"),[d,f]=R.useState(!1),[h,m]=R.useState(null),[x,p]=R.useState(!1),[g,v]=R.useState(null),y=[{value:"pending",label:"Pending",color:"bg-gray-100 text-gray-800"},{value:"sent",label:"Sent",color:"bg-blue-100 text-blue-800"},{value:"delivered",label:"Delivered",color:"bg-green-100 text-green-800"},{value:"opened",label:"Opened",color:"bg-purple-100 text-purple-800"},{value:"clicked",label:"Clicked",color:"bg-yellow-100 text-yellow-800"},{value:"responded",label:"Responded",color:"bg-indigo-100 text-indigo-800"},{value:"bounced",label:"Bounced",color:"bg-red-100 text-red-800"},{value:"converted",label:"Converted",color:"bg-green-100 text-green-800"}];R.useEffect(()=>{e&&b()},[e]);const b=async()=>{i(!0),c(null);try{const A=await jr.getCampaignAudience(e);n(A||[])}catch(A){console.error("Error loading audience:",A),c("Failed to load audience. Please try again.")}finally{i(!1)}},_=async(A,E)=>{if(confirm(`Remove ${E} from this campaign?`)){m(A);try{await jr.removeAudienceMember(e,A),Be.success(`${E} removed from campaign`),b()}catch(M){console.error("Error removing audience member:",M),Be.error(M.message||"Failed to remove audience member")}finally{m(null)}}},w=async()=>{const A=r.filter(E=>E.status==="pending").length;if(A===0){Be.error("No pending audience members to send to");return}if(confirm(`Send campaign to ${A} new audience member(s)?`)){p(!0);try{const E=await jr.sendToPendingAudience(e);Be.success(E.message||`Sent to ${E.sent_count} member(s)`),b()}catch(E){console.error("Error sending to new members:",E),Be.error(E.message||"Failed to send to new members")}finally{p(!1)}}},j=async(A,E)=>{if(confirm(`Resend campaign to ${E}?`)){v(A);try{const M=await jr.resendToMember(e,A);Be.success(M.message||`Campaign resent to ${E}`),b()}catch(M){console.error("Error resending to member:",M),Be.error(M.message||"Failed to resend campaign")}finally{v(null)}}},N=async(A,E)=>{if(confirm(`Send campaign to ${E}?`)){v(A);try{const M=await jr.resendToMember(e,A);Be.success(M.message||`Campaign sent to ${E}`),b()}catch(M){console.error("Error sending to member:",M),Be.error(M.message||"Failed to send campaign")}finally{v(null)}}},D=A=>{var E;return((E=y.find(M=>M.value===A))==null?void 0:E.color)||"bg-gray-100 text-gray-800"},S=A=>{var E;return((E=y.find(M=>M.value===A))==null?void 0:E.label)||A},T=r.filter(A=>l==="all"||A.status===l);return a?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),s.jsx("p",{className:"text-text-secondary",children:"Loading audience..."})]}):o?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(G,{name:"AlertCircle",size:48,className:"text-error mx-auto mb-4"}),s.jsx("p",{className:"text-error mb-4",children:o}),s.jsx("button",{onClick:b,className:"btn-primary",children:"Retry"})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Campaign Audience"}),s.jsxs("p",{className:"text-sm text-text-secondary",children:[T.length," member",T.length!==1?"s":"",l!=="all"&&` (${r.length} total)`,r.filter(A=>A.status==="pending").length>0&&s.jsxs("span",{className:"ml-2 text-orange-600 font-medium",children:["(",r.filter(A=>A.status==="pending").length," pending)"]})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[r.filter(A=>A.status==="pending").length>0&&s.jsx("button",{onClick:w,disabled:x,className:"btn-secondary flex items-center space-x-2 disabled:opacity-50",children:x?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"}),s.jsx("span",{children:"Sending..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(G,{name:"Send",size:16}),s.jsx("span",{children:"Send to New Members"})]})}),s.jsxs("button",{onClick:()=>f(!0),className:"btn-primary flex items-center space-x-2",children:[s.jsx(G,{name:"UserPlus",size:16}),s.jsx("span",{children:"Add Audience"})]})]})]}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs("button",{onClick:()=>u("all"),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${l==="all"?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["All (",r.length,")"]}),y.map(A=>{const E=r.filter(M=>M.status===A.value).length;return s.jsxs("button",{onClick:()=>u(A.value),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${l===A.value?"bg-primary text-white":`${A.color} hover:opacity-80`}`,children:[A.label," (",E,")"]},A.value)})]}),T.length===0?s.jsxs("div",{className:"text-center py-12 bg-surface rounded-lg border border-border",children:[s.jsx(G,{name:"Users",size:48,className:"text-text-tertiary mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:l==="all"?"No audience members yet":"No members with this status"}),s.jsx("p",{className:"text-text-secondary",children:l==="all"?"Add contacts or prospects to this campaign":"Try selecting a different status"})]}):s.jsx("div",{className:"bg-surface rounded-lg border border-border overflow-hidden",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Name"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Type"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Email"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Sent At"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Opened At"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Clicked At"}),s.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-text-secondary uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-border",children:T.map((A,E)=>s.jsxs("tr",{className:"hover:bg-surface-hover transition-colors",children:[s.jsx("td",{className:"px-6 py-4",children:s.jsx("div",{className:"text-sm font-medium text-text-primary",children:A.name||"Unknown"})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${A.recipient_type==="contact"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:A.recipient_type==="contact"?"Contact":"Prospect"})}),s.jsx("td",{className:"px-6 py-4 text-sm text-text-secondary",children:A.email||"-"}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${D(A.status)}`,children:S(A.status)})}),s.jsx("td",{className:"px-6 py-4 text-sm text-text-secondary",children:A.sent_at?new Date(A.sent_at).toLocaleDateString():"-"}),s.jsx("td",{className:"px-6 py-4 text-sm text-text-secondary",children:A.opened_at?new Date(A.opened_at).toLocaleDateString():"-"}),s.jsx("td",{className:"px-6 py-4 text-sm text-text-secondary",children:A.clicked_at?new Date(A.clicked_at).toLocaleDateString():"-"}),s.jsx("td",{className:"px-6 py-4 text-right",children:s.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[A.status==="pending"&&s.jsx("button",{onClick:()=>N(A.campaign_contact_id,A.name),disabled:g===A.campaign_contact_id,className:"text-green-600 hover:text-green-700 disabled:opacity-50 disabled:cursor-not-allowed",title:"Send campaign to this member",children:g===A.campaign_contact_id?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-green-600 inline-block"}):s.jsx(G,{name:"Send",size:16})}),["sent","bounced","failed","delivered"].includes(A.status)&&s.jsx("button",{onClick:()=>j(A.campaign_contact_id,A.name),disabled:g===A.campaign_contact_id,className:"text-primary hover:text-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",title:"Resend campaign",children:g===A.campaign_contact_id?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary inline-block"}):s.jsx(G,{name:"RefreshCw",size:16})}),s.jsx("button",{onClick:()=>_(A.campaign_contact_id,A.name),disabled:h===A.campaign_contact_id,className:"text-error hover:text-red-700 disabled:opacity-50 disabled:cursor-not-allowed",title:"Remove from campaign",children:h===A.campaign_contact_id?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-error inline-block"}):s.jsx(G,{name:"Trash2",size:16})})]})})]},E))})]})})}),d&&s.jsx(MRe,{campaignId:e,onClose:()=>f(!1),onSuccess:()=>{b(),f(!1)}})]})},LRe=({campaign:e})=>{const[t,r]=R.useState(!1),[n,a]=R.useState(!1),[i,o]=R.useState(""),[c,l]=R.useState(""),u=async()=>{if(e!=null&&e.id){if(e.type==="email"){if(!e.email_template_id){Be.error("Campaign must have an email template selected");return}if(!e.email_subject){Be.error("Campaign must have an email subject");return}}if(n){const h=i.split(",").map(p=>p.trim()).filter(p=>p);if(h.length===0){Be.error("Please enter at least one test email recipient");return}const m=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,x=h.filter(p=>!m.test(p));if(x.length>0){Be.error(`Invalid email addresses: ${x.join(", ")}`);return}}r(!0);try{const h={send_test_email:n,test_email_recipients:n?i.split(",").map(x=>x.trim()).filter(x=>x):[],schedule_for:c||null},m=await jr.executeCampaign(e.id,h);n?Be.success("Test emails sent successfully!"):c?Be.success(`Campaign scheduled for ${new Date(c).toLocaleString()}`):Be.success(`Campaign executed! Sent to ${m.sent_count||0} recipients`),a(!1),o(""),l("")}catch(h){console.error("Error executing campaign:",h),Be.error(h.message||"Failed to execute campaign")}finally{r(!1)}}},d=(e==null?void 0:e.status)!=="completed"&&(e==null?void 0:e.status)!=="cancelled",f=(e==null?void 0:e.type)==="email";return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(G,{name:"Info",size:20,className:"text-blue-600 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Campaign Execution"}),s.jsx("p",{className:"text-sm text-blue-800",children:f?"This will send emails to all members in the campaign audience using the configured email template and settings.":"Execute this campaign to engage with your audience."})]})]})}),s.jsxs("div",{className:"bg-surface border border-border rounded-lg p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[s.jsx(G,{name:"CheckCircle",size:20,className:"mr-2"}),"Pre-flight Checklist"]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(G,{name:(e==null?void 0:e.status)==="draft"||(e==null?void 0:e.status)==="active"?"CheckCircle":"XCircle",size:20,className:(e==null?void 0:e.status)==="draft"||(e==null?void 0:e.status)==="active"?"text-green-600":"text-red-600"}),s.jsxs("span",{className:"text-text-secondary",children:["Campaign status: ",s.jsx("span",{className:"font-medium text-text-primary",children:e==null?void 0:e.status})]})]}),f&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(G,{name:e!=null&&e.email_template_id?"CheckCircle":"XCircle",size:20,className:e!=null&&e.email_template_id?"text-green-600":"text-red-600"}),s.jsxs("span",{className:"text-text-secondary",children:["Email template: ",e!=null&&e.email_template_id?s.jsx("span",{className:"font-medium text-text-primary",children:(e==null?void 0:e.email_template_name)||"Selected"}):s.jsx("span",{className:"font-medium text-red-600",children:"Not selected"})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(G,{name:e!=null&&e.email_subject?"CheckCircle":"XCircle",size:20,className:e!=null&&e.email_subject?"text-green-600":"text-red-600"}),s.jsxs("span",{className:"text-text-secondary",children:["Email subject: ",e!=null&&e.email_subject?s.jsx("span",{className:"font-medium text-text-primary",children:e==null?void 0:e.email_subject}):s.jsx("span",{className:"font-medium text-red-600",children:"Not set"})]})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(G,{name:d?"CheckCircle":"XCircle",size:20,className:d?"text-green-600":"text-red-600"}),s.jsxs("span",{className:"text-text-secondary",children:["Can execute: ",s.jsx("span",{className:`font-medium ${d?"text-green-600":"text-red-600"}`,children:d?"Yes":"No (campaign is completed or cancelled)"})]})]})]})]}),d&&s.jsxs("div",{className:"bg-surface border border-border rounded-lg p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[s.jsx(G,{name:"Settings",size:20,className:"mr-2"}),"Execution Options"]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("input",{type:"checkbox",id:"send-test-email",checked:n,onChange:h=>a(h.target.checked),className:"mt-1 h-4 w-4 text-primary border-border rounded focus:ring-2 focus:ring-primary"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{htmlFor:"send-test-email",className:"block text-sm font-medium text-text-primary cursor-pointer",children:"Send Test Email First"}),s.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"Send a test email to verify everything looks correct before sending to your entire audience"}),n&&s.jsxs("div",{className:"mt-3",children:[s.jsx("label",{htmlFor:"test-recipients",className:"block text-sm font-medium text-text-secondary mb-2",children:"Test Email Recipients (comma-separated)"}),s.jsx("input",{type:"text",id:"test-recipients",value:i,onChange:h=>o(h.target.value),placeholder:"email1@example.com, email2@example.com",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]})]})]}),!n&&s.jsxs("div",{children:[s.jsx("label",{htmlFor:"schedule-for",className:"block text-sm font-medium text-text-secondary mb-2",children:"Schedule for Later (Optional)"}),s.jsx("input",{type:"datetime-local",id:"schedule-for",value:c,onChange:h=>l(h.target.value),min:new Date().toISOString().slice(0,16),className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"}),s.jsx("p",{className:"text-sm text-text-tertiary mt-1",children:"Leave empty to send immediately, or select a date and time to schedule for later"})]})]})]}),d&&s.jsx("div",{className:"bg-surface border border-border rounded-lg p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-1",children:["Ready to ",n?"Send Test":c?"Schedule Campaign":"Execute Campaign","?"]}),s.jsx("p",{className:"text-sm text-text-secondary",children:n?"Test emails will be sent to the specified recipients":c?"Campaign will be scheduled for the specified date and time":"This will immediately send to all audience members"})]}),s.jsx("button",{onClick:u,disabled:t||f&&(!(e!=null&&e.email_template_id)||!(e!=null&&e.email_subject)),className:"btn-primary flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:t?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx("span",{children:"Processing..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(G,{name:n?"Send":c?"Clock":"Send",size:16}),s.jsx("span",{children:n?"Send Test":c?"Schedule":"Execute Campaign"})]})})]})}),!d&&s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(G,{name:"AlertTriangle",size:20,className:"text-yellow-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-yellow-900 mb-1",children:"Campaign Cannot Be Executed"}),s.jsxs("p",{className:"text-sm text-yellow-800",children:['This campaign has a status of "',e==null?void 0:e.status,'" and cannot be executed. Only campaigns with "draft" or "active" status can be executed.']})]})]})})]})},$Re=({campaign:e,statuses:t,types:r,onEdit:n,onDelete:a})=>{var l,u,d,f,h;const[i,o]=R.useState("overview"),c=[{id:"overview",label:"Overview",icon:"Info"},{id:"prospects",label:"Prospects",icon:"Users"},{id:"audience",label:"Audience",icon:"Target"},{id:"execute",label:"Execute",icon:"Send"},{id:"performance",label:"Performance",icon:"TrendingUp"}];return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-border flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-12 h-12 bg-primary-50 rounded-lg flex items-center justify-center",children:s.jsx(G,{name:((l=r.find(m=>m.value===(e==null?void 0:e.type)))==null?void 0:l.icon)||"Megaphone",size:24,className:"text-primary"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:e==null?void 0:e.name}),s.jsxs("p",{className:"text-sm text-text-secondary",children:[(u=r.find(m=>m.value===(e==null?void 0:e.type)))==null?void 0:u.label," Campaign"]})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[n&&s.jsxs("button",{onClick:n,className:"btn-primary flex items-center space-x-2",children:[s.jsx(G,{name:"Edit",size:16}),s.jsx("span",{children:"Edit Campaign"})]}),a&&s.jsxs("button",{onClick:a,className:"btn-secondary text-error hover:bg-error-50 flex items-center space-x-2",children:[s.jsx(G,{name:"Trash2",size:16}),s.jsx("span",{children:"Delete"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 divide-y md:divide-y-0 md:divide-x divide-border",children:[s.jsxs("div",{className:"px-6 py-4",children:[s.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"Status"}),s.jsx("span",{className:`inline-block px-3 py-1 text-sm font-medium rounded-full ${((d=t.find(m=>m.value===(e==null?void 0:e.status)))==null?void 0:d.color)||"bg-gray-100 text-gray-800"}`,children:((f=t.find(m=>m.value===(e==null?void 0:e.status)))==null?void 0:f.label)||(e==null?void 0:e.status)})]}),s.jsxs("div",{className:"px-6 py-4",children:[s.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"Sent"}),s.jsx("div",{className:"text-2xl font-semibold text-text-primary",children:(e==null?void 0:e.sent_count)||0})]}),s.jsxs("div",{className:"px-6 py-4",children:[s.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"Open Rate"}),s.jsxs("div",{className:"text-2xl font-semibold text-text-primary",children:[((h=e==null?void 0:e.open_rate)==null?void 0:h.toFixed(1))||0,"%"]})]}),s.jsxs("div",{className:"px-6 py-4",children:[s.jsx("div",{className:"text-sm text-text-secondary mb-1",children:"Conversions"}),s.jsx("div",{className:"text-2xl font-semibold text-primary",children:(e==null?void 0:e.converted_count)||0})]})]})]}),s.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[s.jsx("div",{className:"border-b border-border",children:s.jsx("nav",{className:"flex space-x-1 px-6","aria-label":"Tabs",children:c.map(m=>s.jsxs("button",{onClick:()=>o(m.id),className:`flex items-center space-x-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors ${i===m.id?"border-primary text-primary":"border-transparent text-text-secondary hover:text-text-primary hover:border-gray-300"}`,children:[s.jsx(G,{name:m.icon,size:16}),s.jsx("span",{children:m.label})]},m.id))})}),s.jsxs("div",{className:"p-6",children:[i==="overview"&&s.jsx(kRe,{campaign:e,statuses:t,types:r}),i==="execute"&&s.jsx(LRe,{campaign:e}),i==="audience"&&s.jsx(BRe,{campaignId:e==null?void 0:e.id}),i==="performance"&&s.jsx(RRe,{campaignId:e==null?void 0:e.id}),i==="prospects"&&s.jsx(URe,{campaignId:e==null?void 0:e.id})]})]})]})},WRe=({campaign:e=null,types:t=[],statuses:r=[],onSubmit:n,onCancel:a,isSaving:i=!1})=>{const{user:o}=Pt(),[c,l]=R.useState({name:"",type:"email",status:"draft",description:"",start_date:"",end_date:"",budget:"",expected_revenue:"",email_template_id:"",email_subject:"",email_from_name:"",email_from_email:"",owner_id:(o==null?void 0:o.id)||""}),[u,d]=R.useState({}),[f,h]=R.useState([]),[m,x]=R.useState(!1);R.useEffect(()=>{(async()=>{try{x(!0);const b=await mi.getTemplates({status:"active"});h(b.templates||[])}catch(b){console.error("Failed to load email templates:",b)}finally{x(!1)}})()},[]),R.useEffect(()=>{var y,b;l(e?{name:e.name||"",type:e.type||"email",status:e.status||"draft",description:e.description||"",start_date:e.start_date||"",end_date:e.end_date||"",budget:((y=e.budget)==null?void 0:y.toString())||"",expected_revenue:((b=e.expected_revenue)==null?void 0:b.toString())||"",email_template_id:e.email_template_id||"",email_subject:e.email_subject||"",email_from_name:e.email_from_name||"",email_from_email:e.email_from_email||"",owner_id:e.owner_id||(o==null?void 0:o.id)||""}:{name:"",type:"email",status:"draft",description:"",start_date:"",end_date:"",budget:"",expected_revenue:"",email_template_id:"",email_subject:"",email_from_name:"",email_from_email:"",owner_id:(o==null?void 0:o.id)||""})},[e,o==null?void 0:o.id]);const p=y=>{const{name:b,value:_}=y.target;l(w=>({...w,[b]:_})),u[b]&&d(w=>({...w,[b]:null}))},g=()=>{var b,_;const y={};return(b=c.name)!=null&&b.trim()||(y.name="Campaign name is required"),c.type||(y.type="Campaign type is required"),c.type==="email"&&(c.email_template_id||(y.email_template_id="Email template is required for email campaigns"),(_=c.email_subject)!=null&&_.trim()||(y.email_subject="Email subject is required for email campaigns")),c.budget&&isNaN(parseFloat(c.budget))&&(y.budget="Budget must be a valid number"),c.expected_revenue&&isNaN(parseFloat(c.expected_revenue))&&(y.expected_revenue="Expected revenue must be a valid number"),c.start_date&&c.end_date&&c.start_date>c.end_date&&(y.end_date="End date must be after start date"),d(y),Object.keys(y).length===0},v=y=>{var _,w,j;if(y.preventDefault(),!g())return;const b={name:c.name.trim(),type:c.type,status:c.status,description:c.description.trim()||null,start_date:c.start_date||null,end_date:c.end_date||null,budget:c.budget?parseFloat(c.budget):0,expected_revenue:c.expected_revenue?parseFloat(c.expected_revenue):0,email_template_id:c.email_template_id||null,email_subject:((_=c.email_subject)==null?void 0:_.trim())||null,email_from_name:((w=c.email_from_name)==null?void 0:w.trim())||null,email_from_email:((j=c.email_from_email)==null?void 0:j.trim())||null,owner_id:c.owner_id||(o==null?void 0:o.id)};n(b)};return s.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[s.jsx("div",{className:"px-6 py-4 border-b border-border",children:s.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:e?"Edit Campaign":"Create New Campaign"})}),s.jsxs("form",{onSubmit:v,className:"p-6",children:[s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Basic Information"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-text-secondary mb-2",children:"Campaign Name *"}),s.jsx("input",{type:"text",id:"name",name:"name",value:c.name,onChange:p,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary ${u.name?"border-error":"border-border"}`,placeholder:"Enter campaign name",required:!0}),u.name&&s.jsx("p",{className:"mt-1 text-sm text-error",children:u.name})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"type",className:"block text-sm font-medium text-text-secondary mb-2",children:"Campaign Type *"}),s.jsx("select",{id:"type",name:"type",value:c.type,onChange:p,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary ${u.type?"border-error":"border-border"}`,required:!0,children:t.map(y=>s.jsx("option",{value:y.value,children:y.label},y.value))}),u.type&&s.jsx("p",{className:"mt-1 text-sm text-error",children:u.type})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-text-secondary mb-2",children:"Status *"}),s.jsx("select",{id:"status",name:"status",value:c.status,onChange:p,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",required:!0,children:r.map(y=>s.jsx("option",{value:y.value,children:y.label},y.value))})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-text-secondary mb-2",children:"Description"}),s.jsx("textarea",{id:"description",name:"description",value:c.description,onChange:p,rows:"3",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"Enter campaign description"})]})]})]}),s.jsxs("div",{className:"border-t border-border pt-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Timeline"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"start_date",className:"block text-sm font-medium text-text-secondary mb-2",children:"Start Date"}),s.jsx("input",{type:"date",id:"start_date",name:"start_date",value:c.start_date,onChange:p,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"end_date",className:"block text-sm font-medium text-text-secondary mb-2",children:"End Date"}),s.jsx("input",{type:"date",id:"end_date",name:"end_date",value:c.end_date,onChange:p,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary ${u.end_date?"border-error":"border-border"}`}),u.end_date&&s.jsx("p",{className:"mt-1 text-sm text-error",children:u.end_date})]})]})]}),s.jsxs("div",{className:"border-t border-border pt-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Budget & Revenue"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"budget",className:"block text-sm font-medium text-text-secondary mb-2",children:"Budget"}),s.jsx("input",{type:"number",id:"budget",name:"budget",value:c.budget,onChange:p,step:"0.01",min:"0",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary ${u.budget?"border-error":"border-border"}`,placeholder:"0.00"}),u.budget&&s.jsx("p",{className:"mt-1 text-sm text-error",children:u.budget})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"expected_revenue",className:"block text-sm font-medium text-text-secondary mb-2",children:"Expected Revenue"}),s.jsx("input",{type:"number",id:"expected_revenue",name:"expected_revenue",value:c.expected_revenue,onChange:p,step:"0.01",min:"0",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary ${u.expected_revenue?"border-error":"border-border"}`,placeholder:"0.00"}),u.expected_revenue&&s.jsx("p",{className:"mt-1 text-sm text-error",children:u.expected_revenue})]})]})]}),c.type==="email"&&s.jsxs("div",{className:"border-t border-border pt-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:[s.jsx(G,{name:"Mail",size:20,className:"inline mr-2"}),"Email Campaign Settings"]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email_template_id",className:"block text-sm font-medium text-text-secondary mb-2",children:"Email Template *"}),s.jsxs("select",{id:"email_template_id",name:"email_template_id",value:c.email_template_id,onChange:p,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary ${u.email_template_id?"border-error":"border-border"}`,required:c.type==="email",disabled:m,children:[s.jsx("option",{value:"",children:m?"Loading templates...":"Select an email template"}),f.map(y=>s.jsxs("option",{value:y.id,children:[y.name," (",y.category,")"]},y.id))]}),u.email_template_id&&s.jsx("p",{className:"mt-1 text-sm text-error",children:u.email_template_id}),f.length===0&&!m&&s.jsx("p",{className:"mt-1 text-sm text-text-tertiary",children:"No active email templates found. Create one first."})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email_subject",className:"block text-sm font-medium text-text-secondary mb-2",children:"Email Subject *"}),s.jsx("input",{type:"text",id:"email_subject",name:"email_subject",value:c.email_subject,onChange:p,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary ${u.email_subject?"border-error":"border-border"}`,placeholder:"Enter email subject",required:c.type==="email"}),u.email_subject&&s.jsx("p",{className:"mt-1 text-sm text-error",children:u.email_subject})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email_from_name",className:"block text-sm font-medium text-text-secondary mb-2",children:"From Name"}),s.jsx("input",{type:"text",id:"email_from_name",name:"email_from_name",value:c.email_from_name,onChange:p,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"e.g., Sales Team"}),s.jsx("p",{className:"mt-1 text-xs text-text-tertiary",children:"Optional - defaults to system sender"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email_from_email",className:"block text-sm font-medium text-text-secondary mb-2",children:"From Email"}),s.jsx("input",{type:"email",id:"email_from_email",name:"email_from_email",value:c.email_from_email,onChange:p,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"e.g., sales@company.com"}),s.jsx("p",{className:"mt-1 text-xs text-text-tertiary",children:"Optional - defaults to system sender"})]})]})]})]})]}),s.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6 mt-6 border-t border-border",children:[s.jsx("button",{type:"button",onClick:a,disabled:i,className:"btn-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:i,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:i?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx("span",{children:"Saving..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(G,{name:e?"Save":"Plus",size:16}),s.jsx("span",{children:e?"Update Campaign":"Create Campaign"})]})})]})]})]})},kb=()=>{const{campaignId:e}=G2(),t=Os(),{user:r,hasPermission:n,hasAnyPermission:a}=Pt(),[i,o]=R.useState(null),[c,l]=R.useState([]),[u,d]=R.useState(!1),[f,h]=R.useState(!0),[m,x]=R.useState(!1),[p,g]=R.useState(!0),[v,y]=R.useState(!1),[b,_]=R.useState(null),[w,j]=R.useState(!1),[N,D]=R.useState("all"),[S,T]=R.useState("all"),[A,E]=R.useState(""),[M,P]=R.useState("created_at"),[X,q]=R.useState("desc"),[B,O]=R.useState(1),[F,I]=R.useState(10),L=[{value:"draft",label:"Draft",color:"bg-gray-100 text-gray-800"},{value:"scheduled",label:"Scheduled",color:"bg-blue-100 text-blue-800"},{value:"active",label:"Active",color:"bg-green-100 text-green-800"},{value:"paused",label:"Paused",color:"bg-yellow-100 text-yellow-800"},{value:"completed",label:"Completed",color:"bg-purple-100 text-purple-800"},{value:"cancelled",label:"Cancelled",color:"bg-red-100 text-red-800"}],C=[{value:"email",label:"Email",icon:"Mail"},{value:"web_form",label:"Web Form",icon:"Globe"},{value:"phone",label:"Phone",icon:"Phone"},{value:"social_media",label:"Social Media",icon:"Share2"},{value:"manual_entry",label:"Manual Entry",icon:"Edit"}],z=[...(Array.isArray(c)?c:[]).filter(J=>{const le=N==="all"||J.status===N,he=S==="all"||J.type===S,ee=!A||(J.name||"").toLowerCase().includes(A.toLowerCase())||(J.description||"").toLowerCase().includes(A.toLowerCase());return le&&he&&ee})].sort((J,le)=>{let he,ee;switch(M){case"name":he=(J.name||"").toLowerCase(),ee=(le.name||"").toLowerCase();break;case"start_date":he=new Date(J.start_date||0).getTime(),ee=new Date(le.start_date||0).getTime();break;case"budget":he=J.budget||0,ee=le.budget||0;break;case"created_at":he=new Date(J.created_at||0).getTime(),ee=new Date(le.created_at||0).getTime();break;default:return 0}return X==="asc"?he>ee?1:he<ee?-1:0:he<ee?1:he>ee?-1:0}),V=z.length,Z=Math.ceil(V/F),ce=(B-1)*F,ie=ce+F,Q=z.slice(ce,ie);R.useEffect(()=>{O(1)},[N,S,A]);const ne=J=>{O(J)},pe=J=>{I(J),O(1)},W=J=>{M===J?q(X==="asc"?"desc":"asc"):(P(J),q("asc")),O(1)};R.useEffect(()=>{if(!r)return;(async()=>{g(!0),_(null);try{const le=await jr.getCampaigns();console.log("Campaigns data received:",le),l(Array.isArray(le)?le:[]),e&&e!=="new"?(h(!1),x(!0),d(!1),await re(e)):e==="new"?(h(!1),x(!1),d(!0),o(null)):(h(!0),x(!1),d(!1))}catch(le){console.error("Error loading initial data:",le),_("Failed to load data. Please refresh the page."),l([])}finally{g(!1)}})()},[e,r]);const re=async J=>{try{const le=await jr.getCampaignById(J);if(!le){_("Campaign not found"),g(!1);return}o(le)}catch(le){console.error("Error loading campaign:",le),_("Failed to load campaign. Please try again.")}finally{g(!1)}},U=()=>{o(null),d(!0),h(!1),t("/campaign-management/new")},se=async J=>{x(!0),d(!1),h(!1),t(`/campaign-management/${J.id}`);try{const le=await jr.getCampaignById(J.id);o(le)}catch(le){console.error("Error loading full campaign data:",le),o(J)}},te=()=>{x(!1),d(!0)},K=()=>{d(!1),x(!1),h(!0),o(null),_(null),t("/campaign-management")},H=async J=>{if(!(r!=null&&r.id)){_("You must be logged in to save campaigns");return}y(!0),_(null);try{let le;if(i!=null&&i.id)le=await jr.updateCampaign(i.id,{...J,owner_id:r.id}),le&&(o(le),l(he=>he.map(ee=>ee.id===le.id?le:ee)),Be.success(`Campaign "${le.name}" updated successfully!`));else if(le=await jr.createCampaign({...J,owner_id:r.id}),le!=null&&le.id)Be.success(`Campaign "${J.name}" created successfully!`),l(he=>[le,...he]);else throw new Error("Campaign created but no ID returned");y(!1),K()}catch(le){console.error("Error saving campaign:",le);const he=(le==null?void 0:le.message)||"Failed to save campaign. Please try again.";_(he),Be.error(he)}finally{y(!1)}},oe=async()=>{if(!(!(i!=null&&i.id)||!(r!=null&&r.id))){try{await jr.deleteCampaign(i.id),Be.success(`Campaign "${i.name}" deleted successfully!`),l(J=>J.filter(le=>le.id!==i.id)),t("/campaign-management")}catch(J){console.error("Error deleting campaign:",J);const le="Failed to delete campaign. Please try again.";_(le),Be.error(le)}j(!1)}};return p?s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(Ta,{}),s.jsx("main",{className:"pt-16",children:s.jsx("div",{className:"px-6 py-8",children:s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsx("div",{className:"flex items-center justify-center h-96",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),s.jsx("span",{className:"text-text-secondary",children:"Loading campaigns..."})]})})})})})]}):b&&!i&&!f?s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(Ta,{}),s.jsx("main",{className:"pt-16",children:s.jsx("div",{className:"px-6 py-8",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx(Ki,{}),s.jsxs("div",{className:"text-center py-12",children:[s.jsx(G,{name:"AlertCircle",size:48,className:"text-text-tertiary mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:i===null&&e!=="new"?"Campaign Not Found":"Error"}),s.jsx("p",{className:"text-text-secondary mb-6",children:b}),s.jsx("button",{onClick:()=>t("/campaign-management"),className:"btn-primary",children:"Back to Campaigns"})]})]})})})]}):s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(Ta,{}),s.jsx("main",{className:"pt-16",children:s.jsx("div",{className:"px-6 py-8",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx(Ki,{}),b&&s.jsxs("div",{className:"bg-error-50 border border-error-200 text-error p-4 rounded-lg flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"AlertCircle",size:20}),s.jsx("span",{children:b})]}),s.jsx("button",{onClick:()=>_(null),className:"text-error hover:text-error-600",children:s.jsx(G,{name:"X",size:16})})]}),s.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-8",children:[s.jsxs("div",{className:"mb-4 lg:mb-0",children:[s.jsx("h1",{className:"text-3xl font-bold text-text-primary mb-2",children:f?"Campaign Management":(i==null?void 0:i.name)||"New Campaign"}),s.jsx("div",{className:"flex items-center space-x-4 text-sm text-text-secondary",children:f?s.jsx("span",{children:"Manage all your marketing campaigns"}):s.jsxs(s.Fragment,{children:[(i==null?void 0:i.id)&&s.jsxs(s.Fragment,{children:[s.jsxs("span",{children:["Campaign ID: #",i.id.slice(0,8)]}),s.jsx("span",{children:""})]}),(i==null?void 0:i.created_at)&&s.jsxs(s.Fragment,{children:[s.jsxs("span",{children:["Created: ",new Date(i.created_at).toLocaleDateString()]}),s.jsx("span",{children:""})]}),(i==null?void 0:i.updated_at)&&s.jsxs("span",{children:["Last updated: ",new Date(i.updated_at).toLocaleDateString()]})]})})]}),s.jsx("div",{className:"flex items-center space-x-3",children:f?s.jsx(s.Fragment,{children:n("campaigns.create")&&s.jsxs("button",{onClick:U,className:"btn-primary flex items-center space-x-2",children:[s.jsx(G,{name:"Plus",size:16}),s.jsx("span",{children:"Create Campaign"})]})}):s.jsxs("button",{onClick:K,className:"btn-secondary flex items-center space-x-2",children:[s.jsx(G,{name:"ArrowLeft",size:16}),s.jsx("span",{children:"Back to List"})]})})]}),f?s.jsx(ARe,{campaigns:Q,allCampaigns:c,statuses:L,types:C,selectedStatusFilter:N,selectedTypeFilter:S,searchQuery:A,sortField:M,sortDirection:X,currentPage:B,itemsPerPage:F,totalItems:V,totalPages:Z,onStatusFilterChange:D,onTypeFilterChange:T,onSearchChange:E,onSort:W,onPageChange:ne,onItemsPerPageChange:pe,onViewCampaign:se,onEditCampaign:J=>{se(J),setTimeout(()=>te(),100)},onDeleteCampaign:J=>{o(J),j(!0)}}):s.jsx("div",{children:p?s.jsx("div",{className:"bg-surface rounded-lg border border-border p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),s.jsx("p",{className:"text-text-secondary",children:"Loading campaign..."})]})}):m?s.jsx($Re,{campaign:i,statuses:L,types:C,onEdit:n("campaigns.edit_all")||n("campaigns.edit_own")&&(i==null?void 0:i.owner_id)===(r==null?void 0:r.id)?te:null,onDelete:n("campaigns.delete_all")||n("campaigns.delete_own")&&(i==null?void 0:i.owner_id)===(r==null?void 0:r.id)?()=>j(!0):null}):s.jsx(WRe,{campaign:i,types:C,statuses:L,onSubmit:H,onCancel:K,isSaving:v})})]})})}),w&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-surface rounded-lg p-6 max-w-md w-full mx-4",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[s.jsx("div",{className:"w-10 h-10 bg-error-50 rounded-full flex items-center justify-center",children:s.jsx(G,{name:"AlertTriangle",size:20,className:"text-error"})}),s.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Delete Campaign"})]}),s.jsxs("p",{className:"text-text-secondary mb-6",children:['Are you sure you want to delete "',i==null?void 0:i.name,'"? This action cannot be undone.']}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:()=>j(!1),className:"flex-1 px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-colors duration-150",children:"Cancel"}),s.jsx("button",{onClick:oe,className:"flex-1 px-4 py-2 bg-error text-white rounded-lg hover:bg-error-600 transition-colors duration-150",children:"Delete Campaign"})]})]})})]})};class zRe{constructor(){this.exportInProgress=!1}generateCSV(t,r,n){const a=[r.join(","),...t.map(i=>r.map(o=>{const c=i[o.toLowerCase().replace(" ","_")]||i[o]||"";return typeof c=="string"&&(c.includes(",")||c.includes('"'))?`"${c.replace(/"/g,'""')}"`:c}).join(","))].join(`
`);this.downloadFile(a,n,"text/csv")}async exportAnalyticsCSV(t,r){try{this.exportInProgress=!0;const a=`pipeline_analytics_${Ga(new Date,"yyyy-MM-dd_HH-mm-ss")}.csv`,i=[];i.push("PIPELINE ANALYTICS REPORT"),i.push(`Generated: ${Ga(new Date,"PPpp")}`),i.push(`Date Range: ${r.dateRange||"All Time"}`),i.push(`Sales Rep: ${r.repName||"All Representatives"}`),i.push(""),t.velocityMetrics&&t.velocityMetrics.length>0&&(i.push("KEY METRICS"),i.push("Metric,Value,Change,Trend"),t.velocityMetrics.forEach(c=>{i.push(`${c.metric},${c.value},${c.change||"N/A"},${c.trend||"N/A"}`)}),i.push("")),t.revenueTrendData&&t.revenueTrendData.length>0&&(i.push("REVENUE TRENDS (Monthly)"),i.push("Month,Actual Revenue,Forecast,Target"),t.revenueTrendData.forEach(c=>{i.push(`${c.month},$${c.actual},$${c.forecast},$${c.target}`)}),i.push("")),t.pipelineFunnelData&&t.pipelineFunnelData.length>0&&(i.push("PIPELINE FUNNEL"),i.push("Stage,Value,Deal Count"),t.pipelineFunnelData.forEach(c=>{i.push(`${c.name},$${c.value},${c.count}`)}),i.push("")),t.winRateData&&t.winRateData.length>0&&(i.push("WIN RATE BY QUARTER"),i.push("Period,Win Rate %"),t.winRateData.forEach(c=>{i.push(`${c.period},${c.winRate}%`)}),i.push(""));const o=i.join(`
`);return this.downloadFile(o,a,"text/csv"),{success:!0,filename:a}}catch(n){throw console.error("CSV Export failed:",n),new Error("Failed to export CSV: "+n.message)}finally{this.exportInProgress=!1}}async exportAnalyticsJSON(t,r){try{this.exportInProgress=!0;const a=`pipeline_analytics_${Ga(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`,i={metadata:{exportDate:new Date().toISOString(),dateRange:r.dateRange||"all",salesRep:r.repName||"all",appliedFilters:r},analytics:{keyMetrics:t.velocityMetrics||[],revenueTrends:t.revenueTrendData||[],pipelineFunnel:t.pipelineFunnelData||[],winRates:t.winRateData||[],forecastData:t.forecastData||[],performanceData:t.repPerformanceData||[]},summary:{totalRevenue:t.revenueTrendData?t.revenueTrendData.reduce((c,l)=>c+l.actual,0):0,totalDeals:t.pipelineFunnelData?t.pipelineFunnelData.reduce((c,l)=>c+l.count,0):0,avgWinRate:t.winRateData&&t.winRateData.length>0?t.winRateData.reduce((c,l)=>c+l.winRate,0)/t.winRateData.length:0}},o=JSON.stringify(i,null,2);return this.downloadFile(o,a,"application/json"),{success:!0,filename:a}}catch(n){throw console.error("JSON Export failed:",n),new Error("Failed to export JSON: "+n.message)}finally{this.exportInProgress=!1}}async exportAnalyticsPDF(t,r,n={}){try{this.exportInProgress=!0;const a=await fl(()=>import("./html2canvas.esm-CBrSDip1.js"),__vite__mapDeps([])).then(h=>h.default),i=await fl(()=>import("./jspdf.es.min-BMf-hzML.js"),__vite__mapDeps([0,1,2,3])).then(h=>h.jsPDF),c=`pipeline_analytics_${Ga(new Date,"yyyy-MM-dd_HH-mm-ss")}.pdf`,l=new i("p","mm","a4"),u=l.internal.pageSize.getWidth(),d=l.internal.pageSize.getHeight();let f=20;if(l.setFontSize(20),l.text("Pipeline Analytics Report",20,f),f+=15,l.setFontSize(12),l.text(`Generated: ${Ga(new Date,"PPpp")}`,20,f),f+=7,l.text(`Date Range: ${r.dateRange||"All Time"}`,20,f),f+=7,l.text(`Sales Rep: ${r.repName||"All Representatives"}`,20,f),f+=15,t.velocityMetrics&&t.velocityMetrics.length>0){l.setFontSize(14),l.text("Key Performance Metrics",20,f),f+=10,l.setFontSize(10);const h=t.velocityMetrics.map(p=>[p.metric,p.value,p.change||"N/A",p.trend||"N/A"]),m=["Metric","Value","Change","Trend"];let x=f;m.forEach((p,g)=>{l.text(p,20+g*40,x)}),x+=7,h.forEach(p=>{p.forEach((g,v)=>{l.text(String(g),20+v*40,x)}),x+=6}),f=x+10}if(n.revenueChart&&n.revenueChart.current)try{const h=await a(n.revenueChart.current,{backgroundColor:"white",scale:2}),m=h.toDataURL("image/png"),x=u-40,p=h.height*x/h.width;f+p>d-20&&(l.addPage(),f=20),l.setFontSize(14),l.text("Revenue Trends",20,f),f+=10,l.addImage(m,"PNG",20,f,x,p),f+=p+15}catch(h){console.warn("Could not capture revenue chart:",h)}if(t.revenueTrendData&&t.revenueTrendData.length>0){f+50>d-20&&(l.addPage(),f=20),l.setFontSize(14),l.text("Revenue Summary",20,f),f+=10,l.setFontSize(10);const h=t.revenueTrendData.reduce((x,p)=>x+p.actual,0),m=h/t.revenueTrendData.length;l.text(`Total Revenue: $${h.toLocaleString()}`,20,f),f+=7,l.text(`Average Monthly: $${m.toLocaleString()}`,20,f),f+=7,l.text(`Reporting Period: ${t.revenueTrendData.length} months`,20,f)}return l.save(c),{success:!0,filename:c}}catch(a){throw console.error("PDF Export failed:",a),new Error("Failed to export PDF: "+a.message)}finally{this.exportInProgress=!1}}async exportAnalyticsExcel(t,r){try{this.exportInProgress=!0;const n=await fl(()=>Promise.resolve().then(()=>$Oe),void 0),i=`pipeline_analytics_${Ga(new Date,"yyyy-MM-dd_HH-mm-ss")}.xlsx`,o=n.utils.book_new(),c=[["Pipeline Analytics Report"],["Generated",Ga(new Date,"PPpp")],["Date Range",r.dateRange||"All Time"],["Sales Rep",r.repName||"All Representatives"],[""],["Summary Metrics"]];t.velocityMetrics&&t.velocityMetrics.length>0&&(c.push(["Metric","Value","Change","Trend"]),t.velocityMetrics.forEach(u=>{c.push([u.metric,u.value,u.change||"N/A",u.trend||"N/A"])}));const l=n.utils.aoa_to_sheet(c);if(n.utils.book_append_sheet(o,l,"Summary"),t.revenueTrendData&&t.revenueTrendData.length>0){const u=[["Month","Actual Revenue","Forecast","Target"],...t.revenueTrendData.map(f=>[f.month,f.actual,f.forecast,f.target])],d=n.utils.aoa_to_sheet(u);n.utils.book_append_sheet(o,d,"Revenue Trends")}if(t.pipelineFunnelData&&t.pipelineFunnelData.length>0){const u=[["Stage","Value","Deal Count","Conversion Rate"],...t.pipelineFunnelData.map((f,h,m)=>[f.name,f.value,f.count,h<m.length-1?`${(f.count/m[0].count*100).toFixed(1)}%`:"Final Stage"])],d=n.utils.aoa_to_sheet(u);n.utils.book_append_sheet(o,d,"Pipeline Funnel")}if(t.winRateData&&t.winRateData.length>0){const u=[["Period","Win Rate %"],...t.winRateData.map(f=>[f.period,f.winRate])],d=n.utils.aoa_to_sheet(u);n.utils.book_append_sheet(o,d,"Win Rates")}return Object.keys(o.Sheets).forEach(u=>{const d=o.Sheets[u],f=n.utils.decode_range(d["!ref"]),h=[];for(let m=f.s.c;m<=f.e.c;m++){let x=10;for(let p=f.s.r;p<=f.e.r;p++){const g=n.utils.encode_cell({r:p,c:m}),v=d[g];if(v&&v.v){const y=String(v.v).length;y>x&&(x=y)}}h.push({wch:Math.min(x+2,50)})}d["!cols"]=h}),n.writeFile(o,i),{success:!0,filename:i}}catch(n){throw console.error("Excel Export failed:",n),new Error("Failed to export Excel: "+n.message)}finally{this.exportInProgress=!1}}async scheduleEmailReport(t,r,n){try{this.exportInProgress=!0;const a={type:"scheduled_report",data:t,filters:r,emailSettings:n,scheduledFor:n.schedule||"weekly"};console.log("Scheduling email report:",a);const o=`email_report_config_${Ga(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`,c=JSON.stringify({message:"Email reporting would be configured with these settings",...a},null,2);return this.downloadFile(c,o,"application/json"),{success:!0,message:"Email report configuration saved. Contact your administrator to set up email delivery.",filename:o}}catch(a){throw console.error("Email scheduling failed:",a),new Error("Failed to schedule email report: "+a.message)}finally{this.exportInProgress=!1}}downloadFile(t,r,n){const a=new Blob([t],{type:n}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download=r,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}isExporting(){return this.exportInProgress}}const hd=new zRe,qRe=({analyticsData:e,filters:t,chartRefs:r={},isOpen:n,onClose:a,className:i=""})=>{const[o,c]=R.useState({type:null,loading:!1,success:!1,error:null}),[l,u]=R.useState({recipient:"",schedule:"weekly",format:"pdf"}),[d,f]=R.useState(!1),h=async p=>{c({type:p,loading:!0,success:!1,error:null});try{const g=t||{dateRange:"all",ownerId:"all"};let v;switch(p){case"csv":v=await hd.exportAnalyticsCSV(e,g);break;case"excel":v=await hd.exportAnalyticsExcel(e,g);break;case"pdf":v=await hd.exportAnalyticsPDF(e,g,r);break;case"json":v=await hd.exportAnalyticsJSON(e,g);break;default:throw new Error("Unknown export type")}c({type:p,loading:!1,success:!0,error:null}),setTimeout(()=>{c({type:null,loading:!1,success:!1,error:null})},3e3)}catch(g){c({type:p,loading:!1,success:!1,error:g.message}),setTimeout(()=>{c({type:null,loading:!1,success:!1,error:null})},5e3)}},m=async()=>{if(!l.recipient){c({type:"email",loading:!1,success:!1,error:"Please enter a recipient email address"});return}c({type:"email",loading:!0,success:!1,error:null});try{const p=await hd.scheduleEmailReport(e,t,l);c({type:"email",loading:!1,success:!0,error:null}),f(!1),u({recipient:"",schedule:"weekly",format:"pdf"}),setTimeout(()=>{c({type:null,loading:!1,success:!1,error:null})},3e3)}catch(p){c({type:"email",loading:!1,success:!1,error:p.message})}},x=[{id:"excel",label:"Export as Excel",icon:"FileSpreadsheet",description:"Comprehensive data in multiple sheets",color:"text-green-600",bgColor:"bg-green-50",hoverColor:"hover:bg-green-100"},{id:"pdf",label:"Export as PDF",icon:"FileText",description:"Professional report with charts",color:"text-red-600",bgColor:"bg-red-50",hoverColor:"hover:bg-red-100"},{id:"csv",label:"Export as CSV",icon:"Download",description:"Raw data for analysis",color:"text-blue-600",bgColor:"bg-blue-50",hoverColor:"hover:bg-blue-100"},{id:"json",label:"Export as JSON",icon:"Code",description:"Structured data for developers",color:"text-purple-600",bgColor:"bg-purple-50",hoverColor:"hover:bg-purple-100"}];return n?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 z-40",onClick:a}),s.jsxs("div",{className:`absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-xl border border-gray-200 z-50 ${i}`,children:[s.jsxs("div",{className:"p-4 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Export Analytics"}),s.jsx("button",{onClick:a,className:"text-text-secondary hover:text-text-primary transition-colors",children:s.jsx(G,{name:"X",size:20})})]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Choose your preferred export format"})]}),s.jsx("div",{className:"p-4 space-y-2",children:x.map(p=>s.jsxs("button",{onClick:()=>h(p.id),disabled:o.loading&&o.type===p.id,className:`w-full flex items-center p-3 rounded-lg border-2 border-transparent transition-all duration-200 ${o.loading&&o.type===p.id?"opacity-50 cursor-not-allowed bg-gray-50":`${p.bgColor} ${p.hoverColor} hover:border-gray-200`}`,children:[s.jsx("div",{className:`p-2 rounded-lg ${p.bgColor} mr-3`,children:o.loading&&o.type===p.id?s.jsx(G,{name:"Loader2",size:20,className:"animate-spin text-gray-600"}):s.jsx(G,{name:p.icon,size:20,className:p.color})}),s.jsxs("div",{className:"flex-1 text-left",children:[s.jsx("div",{className:"font-medium text-gray-900",children:p.label}),s.jsx("div",{className:"text-sm text-gray-600",children:p.description})]}),o.success&&o.type===p.id&&s.jsx(G,{name:"Check",size:16,className:"text-green-600"})]},p.id))}),o.error&&s.jsx("div",{className:"p-4 border-t border-gray-200",children:s.jsxs("div",{className:"flex items-center text-red-600",children:[s.jsx(G,{name:"AlertCircle",size:16,className:"mr-2"}),s.jsx("span",{className:"text-sm",children:o.error})]})}),o.success&&s.jsx("div",{className:"p-4 border-t border-gray-200",children:s.jsxs("div",{className:"flex items-center text-green-600",children:[s.jsx(G,{name:"CheckCircle",size:16,className:"mr-2"}),s.jsx("span",{className:"text-sm",children:"Export completed successfully!"})]})}),s.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50 rounded-b-lg",children:s.jsxs("div",{className:"text-xs text-gray-500",children:[s.jsxs("p",{className:"flex items-center",children:[s.jsx(G,{name:"Info",size:12,className:"mr-1"}),"Reports include current filter settings"]}),s.jsxs("p",{className:"mt-1",children:["Data range: ",t.dateRange||"All Time","  Rep: ",t.repName||"All Representatives"]})]})})]}),d&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50",onClick:()=>f(!1)}),s.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-60 p-4",children:s.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Schedule Email Report"}),s.jsx("button",{onClick:()=>f(!1),className:"text-text-secondary hover:text-text-primary",children:s.jsx(G,{name:"X",size:20})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Recipient Email"}),s.jsx("input",{type:"email",value:l.recipient,onChange:p=>u(g=>({...g,recipient:p.target.value})),placeholder:"Enter email address",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Schedule"}),s.jsxs("select",{value:l.schedule,onChange:p=>u(g=>({...g,schedule:p.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"daily",children:"Daily"}),s.jsx("option",{value:"weekly",children:"Weekly"}),s.jsx("option",{value:"monthly",children:"Monthly"}),s.jsx("option",{value:"quarterly",children:"Quarterly"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Format"}),s.jsxs("select",{value:l.format,onChange:p=>u(g=>({...g,format:p.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"pdf",children:"PDF Report"}),s.jsx("option",{value:"excel",children:"Excel Spreadsheet"}),s.jsx("option",{value:"both",children:"Both PDF & Excel"})]})]})]}),s.jsxs("div",{className:"flex space-x-3 mt-6",children:[s.jsx("button",{onClick:()=>f(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),s.jsx("button",{onClick:m,disabled:o.loading&&o.type==="email",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:o.loading&&o.type==="email"?s.jsxs("span",{className:"flex items-center justify-center",children:[s.jsx(G,{name:"Loader2",size:16,className:"animate-spin mr-2"}),"Setting up..."]}):"Schedule Report"})]})]})})})]})]}):null},HRe=()=>{var oe;const[e,t]=R.useState("all"),[r,n]=R.useState(!1),[a,i]=R.useState("previous30days"),[o,c]=R.useState("all"),[l,u]=R.useState("overview"),[d,f]=R.useState(!1),[h,m]=R.useState(null),[x,p]=R.useState(!1),[g,v]=R.useState(null),[y,b]=R.useState(new Date),[_,w]=R.useState([]),[j,N]=R.useState([]),[D,S]=R.useState([]),[T,A]=R.useState([]),[E,M]=R.useState([]),[P,X]=R.useState([]),[q,B]=R.useState([]),[O,F]=R.useState(!0),[I,L]=R.useState(null),[C,k]=R.useState(!1),[z,V]=R.useState({reps:[],dateRanges:[]}),Z=R.useRef(null),ce=R.useRef(null),ie=R.useRef(null),Q=R.useMemo(()=>[{value:"all",label:"All Time"},{value:"thisquarter",label:"This Quarter"},{value:"lastquarter",label:"Last Quarter"},{value:"thisyear",label:"This Year"},{value:"lastyear",label:"Last Year"}],[]),ne=R.useMemo(()=>[{value:"all",label:"All Representatives"},...z.reps||[]],[z.reps]),pe=R.useMemo(()=>({velocityMetrics:E,revenueTrendData:j,pipelineFunnelData:_,winRateData:T,forecastData:q,repPerformanceData:P}),[E,j,_,T,q,P]),W=R.useMemo(()=>{const J=ne.find(he=>he.value===o),le=Q.find(he=>he.value===e);return{dateRange:e,dateRangeLabel:(le==null?void 0:le.label)||e,repId:o,repName:(J==null?void 0:J.label)||o,appliedAt:new Date().toISOString(),compareMode:r,compareDateRange:r?a:null}},[e,o,ne,Q,r,a]),re={revenue:Z,pipeline:ce,performance:ie};R.useEffect(()=>{(async()=>{try{await kr.loadConfiguration();const le=await ut.getFilterOptions();V(le),k(!0)}catch(le){console.error("Failed to load configuration:",le),k(!0)}})()},[]),R.useEffect(()=>{if(!C)return;(async()=>{var le;try{F(!0),b(new Date);const he={dateRange:e!=="all"?e:void 0,ownerId:o!=="all"?o:void 0},[ee,ae,xe,ye]=await Promise.all([ut.getPipelineDeals(he),ut.getRevenueData(he),ut.getPerformanceMetrics(he),ut.getWinRateData(he)]),Ce=ee&&typeof ee=="object"?Object.values(ee).map(Qe=>({name:(Qe==null?void 0:Qe.title)||"Unknown Stage",value:((Qe==null?void 0:Qe.deals)||[]).reduce((vt,At)=>{const bt=typeof(At==null?void 0:At.value)=="string"?parseFloat(At.value):(At==null?void 0:At.value)||0;return vt+(isNaN(bt)?0:bt)},0),count:((Qe==null?void 0:Qe.deals)||[]).length,deals:(Qe==null?void 0:Qe.deals)||[],fill:(Qe==null?void 0:Qe.id)==="lead"?"#3B82F6":(Qe==null?void 0:Qe.id)==="qualified"?"#6366F1":(Qe==null?void 0:Qe.id)==="proposal"?"#8B5CF6":(Qe==null?void 0:Qe.id)==="negotiation"?"#A855F7":(Qe==null?void 0:Qe.id)==="closed_won"?"#10B981":"#EF4444"})):[];w(Ce),N(Array.isArray(ae)?ae:[]),A(Array.isArray(ye)?ye:[]);const Ie=Array.isArray(ae)?ae.map((Qe,vt)=>({...Qe,aiPrediction:((Qe==null?void 0:Qe.forecast)||0)*(1+(Math.random()-.5)*.1),confidence:Math.random()*20+75})):[];if(B(Ie),r&&Array.isArray(ae)){const Qe=ae.map(vt=>({...vt,actual:((vt==null?void 0:vt.actual)||0)*(.8+Math.random()*.4),forecast:((vt==null?void 0:vt.forecast)||0)*(.85+Math.random()*.3)}));S(Qe)}const Ze=Object.values(ee).flatMap(Qe=>(Qe==null?void 0:Qe.deals)||[]),Fe=Ze.reduce((Qe,vt)=>{const At=typeof(vt==null?void 0:vt.value)=="string"?parseFloat(vt.value):(vt==null?void 0:vt.value)||0;return Qe+(isNaN(At)?0:At)},0),He=Ze.length>0?Fe/Ze.length:(xe==null?void 0:xe.avgDealSize)||0,Je=(()=>{if(!ye||ye.length===0)return 0;const Qe=ye.reduce((At,bt)=>At+(bt.won||0),0),vt=ye.reduce((At,bt)=>At+(bt.total||0),0);return vt>0?Qe/vt*100:0})(),ma=(Qe=>{const vt=Object.values(Qe).flatMap(bt=>(bt==null?void 0:bt.deals)||[]).filter(bt=>(bt==null?void 0:bt.stage)==="closed_won"&&(bt==null?void 0:bt.close_date)&&(bt==null?void 0:bt.created_at));if(vt.length===0)return 0;const At=vt.reduce((bt,Yn)=>{const ln=new Date(Yn.created_at),bn=new Date(Yn.close_date),Oo=Math.round((bn-ln)/(1e3*60*60*24));return bt+Math.max(Oo,0)},0);return Math.round(At/vt.length)})(ee),yn=ma>0?((xe==null?void 0:xe.achieved)||0)/ma:0;if(M([{metric:"Avg Deal Size",value:He,change:null,trend:"neutral"},{metric:"Win Rate",value:`${Je.toFixed(1)}%`,change:null,trend:Je>=50?"up":"down"}]),o==="all"){const Qe=z.reps||[];if(Qe.length>0){const vt=Qe.map(async bt=>{try{const Yn={dateRange:he.dateRange,ownerId:bt.value},ln=await ut.getPerformanceMetrics(Yn),bn=await ut.getPipelineDeals(Yn),Oo=Object.values(bn).reduce(($u,Po)=>{var Io;return $u+(((Io=Po==null?void 0:Po.deals)==null?void 0:Io.length)||0)},0);return{name:bt.label,revenue:ln.achieved||0,deals:Oo,quota:ln.quota||0,attainment:ln.percentage||0,avgDealSize:ln.avgDealSize||0,conversionRate:ln.conversionRate||0}}catch(Yn){return console.error(`Error fetching performance for ${bt.label}:`,Yn),{name:bt.label,revenue:0,deals:0,quota:0,attainment:0,avgDealSize:0,conversionRate:0}}}),At=await Promise.all(vt);X(At)}else{const vt=Ce.reduce((At,bt)=>At+bt.count,0);X([{name:"Current User",revenue:xe.achieved||0,deals:vt,quota:xe.quota||0,attainment:xe.percentage||0,avgDealSize:xe.avgDealSize||0,conversionRate:xe.conversionRate||0}])}}else{const Qe=(le=z.reps)==null?void 0:le.find(At=>At.value===o),vt=Ce.reduce((At,bt)=>At+bt.count,0);X([{name:(Qe==null?void 0:Qe.label)||"Selected Rep",revenue:xe.achieved||0,deals:vt,quota:xe.quota||0,attainment:xe.percentage||0,avgDealSize:xe.avgDealSize||0,conversionRate:xe.conversionRate||0}])}}catch(he){console.error("Failed to fetch analytics data:",he),L("Failed to load analytics data. Please try again.")}finally{F(!1)}})()},[e,r,a,o,C]),R.useEffect(()=>{if(g){const J=setInterval(()=>{console.log("Auto-refreshing analytics data...")},g*60*1e3);return()=>clearInterval(J)}},[g]);const U=(J,le)=>{m({data:J,chartType:le,timestamp:new Date}),p(!0)};if(O)return s.jsxs("div",{className:"min-h-screen bg-background flex justify-center items-center",children:[s.jsx(n9,{className:"h-10 w-10 animate-spin text-primary"}),s.jsx("p",{className:"ml-4 text-text-secondary",children:"Loading analytics data..."})]});if(I)return s.jsx("div",{className:"min-h-screen bg-background flex justify-center items-center",children:s.jsx("p",{className:"text-error text-lg",children:I})});const se=[{id:"overview",label:"Overview",icon:"BarChart3"},{id:"pipeline",label:"Pipeline",icon:"TrendingUp"},{id:"performance",label:"Performance",icon:"Target"}],te=J=>{try{return kr.formatCurrency(J)}catch{return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(J)}},K=J=>J.metric==="Avg Deal Size"?te(J.value):J.metric==="Pipeline Velocity"?`${te(J.value)}/day`:J.value,H=({active:J,payload:le,label:he})=>J&&le&&(le!=null&&le.length)?s.jsxs("div",{className:"bg-surface border border-border rounded-lg shadow-lg p-3",children:[s.jsx("p",{className:"text-sm font-normal text-text-primary mb-2",children:he}),le==null?void 0:le.map((ee,ae)=>s.jsxs("p",{className:"text-sm",style:{color:ee==null?void 0:ee.color},children:[ee==null?void 0:ee.name,": ",typeof(ee==null?void 0:ee.value)=="number"&&(ee==null?void 0:ee.value)>1e3?te(ee==null?void 0:ee.value):ee==null?void 0:ee.value]},ae))]}):null;return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(Ta,{}),s.jsx("main",{className:"pt-16",children:s.jsx("div",{className:"px-6 py-8",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsx(Ki,{}),s.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-8",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-text-primary mb-2",children:"Pipeline Analytics"}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("p",{className:"text-text-secondary",children:"Comprehensive sales performance insights and forecasting"}),s.jsxs("div",{className:"flex items-center space-x-2 text-xs text-text-tertiary",children:[s.jsx(G,{name:"RefreshCw",size:12,className:g?"animate-spin":""}),s.jsxs("span",{children:["Last updated: ",y.toLocaleTimeString()]})]})]})]}),s.jsx("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-3 sm:space-y-0 sm:space-x-3 mt-4 lg:mt-0",children:s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>f(!d),className:"btn-primary flex items-center space-x-2 relative",children:[s.jsx(G,{name:"Download",size:16}),s.jsx("span",{children:"Export"}),s.jsx(G,{name:"ChevronDown",size:14,className:`transition-transform duration-200 ${d?"rotate-180":""}`})]}),s.jsx(qRe,{analyticsData:pe,filters:W,chartRefs:re,isOpen:d,onClose:()=>f(!1)})]})})]}),s.jsx("div",{className:"card p-6 mb-8",children:s.jsxs("div",{className:`grid gap-4 ${r?"grid-cols-1 md:grid-cols-2 lg:grid-cols-4":"grid-cols-1 md:grid-cols-2 lg:grid-cols-3"}`,children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-normal text-text-primary mb-2",children:"Date Range"}),s.jsx("select",{value:e,onChange:J=>{var le;return t((le=J==null?void 0:J.target)==null?void 0:le.value)},className:"input-field",children:Q==null?void 0:Q.map(J=>s.jsx("option",{value:J==null?void 0:J.value,children:J==null?void 0:J.label},J==null?void 0:J.value))})]}),r&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-normal text-text-primary mb-2",children:"Compare With"}),s.jsxs("select",{value:a,onChange:J=>{var le;return i((le=J==null?void 0:J.target)==null?void 0:le.value)},className:"input-field",children:[s.jsx("option",{value:"previous30days",children:"Previous 30 Days"}),s.jsx("option",{value:"previous90days",children:"Previous 90 Days"}),s.jsx("option",{value:"previousquarter",children:"Previous Quarter"}),s.jsx("option",{value:"previousyear",children:"Previous Year"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-normal text-text-primary mb-2",children:"Sales Rep"}),s.jsx("select",{value:o,onChange:J=>{var le;return c((le=J==null?void 0:J.target)==null?void 0:le.value)},className:"input-field",children:ne==null?void 0:ne.map(J=>s.jsx("option",{value:J==null?void 0:J.value,children:J==null?void 0:J.label},J==null?void 0:J.value))})]}),s.jsx("div",{className:"flex items-end",children:s.jsx("div",{className:"w-full text-center text-sm text-text-secondary",children:"Filters applied automatically"})})]})}),s.jsx("div",{className:"border-b border-border mb-8",children:s.jsx("nav",{className:"flex space-x-8",children:se==null?void 0:se.map(J=>s.jsxs("button",{onClick:()=>u(J==null?void 0:J.id),className:`flex items-center space-x-2 py-4 px-1 border-b-2 font-normal text-sm transition-colors duration-150 ${l===(J==null?void 0:J.id)?"border-primary text-primary":"border-transparent text-text-secondary hover:text-text-primary hover:border-border-dark"}`,children:[s.jsx(G,{name:J==null?void 0:J.icon,size:16}),s.jsx("span",{children:J==null?void 0:J.label})]},J==null?void 0:J.id))})}),l==="overview"&&s.jsxs("div",{className:"space-y-8",children:[s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:E==null?void 0:E.map(J=>s.jsxs("div",{className:"card p-6 hover:shadow-lg transition-shadow duration-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h3",{className:"text-sm font-normal text-text-secondary",children:J==null?void 0:J.metric}),(J==null?void 0:J.change)&&s.jsxs("div",{className:`flex items-center space-x-1 ${(J==null?void 0:J.trend)==="up"?"text-success":(J==null?void 0:J.trend)==="down"?"text-error":"text-text-tertiary"}`,children:[s.jsx(G,{name:(J==null?void 0:J.trend)==="up"?"TrendingUp":(J==null?void 0:J.trend)==="down"?"TrendingDown":"Minus",size:14}),s.jsx("span",{className:"text-xs font-normal",children:J==null?void 0:J.change})]})]}),s.jsx("div",{className:"space-y-2",children:s.jsx("p",{className:"text-2xl font-bold text-text-primary",children:K(J)})})]},J==null?void 0:J.metric))}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("div",{className:"card p-6",children:[s.jsx("div",{className:"flex items-center justify-between mb-6",children:s.jsx("h3",{className:"text-lg font-normal text-text-primary",children:"Pipeline Funnel by stage"})}),s.jsx("div",{className:"h-80",ref:ce,children:s.jsx(zn,{width:"100%",height:"100%",children:s.jsxs(U_e,{children:[s.jsx(_r,{content:s.jsx(H,{})}),s.jsx(No,{dataKey:"value",data:_,isAnimationActive:!0,onClick:J=>U(J,"funnel-stage"),className:"cursor-pointer",children:s.jsx(wi,{position:"center",fill:"#fff",stroke:"none"})})]})})}),s.jsx("div",{className:"mt-4 text-xs text-text-tertiary",children:"Click on any stage to view detailed deal breakdown"})]}),s.jsxs("div",{className:"card p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h3",{className:"text-lg font-normal text-text-primary",children:"Revenue Trend"}),s.jsxs("div",{className:"flex items-center space-x-3",children:[r&&s.jsxs("div",{className:"flex items-center space-x-2 text-xs text-text-tertiary",children:[s.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),s.jsx("span",{children:"Current"}),s.jsx("div",{className:"w-3 h-3 bg-gray-400 rounded-full"}),s.jsx("span",{children:"Previous"})]}),s.jsxs("button",{onClick:()=>U(j,"revenue-trend"),className:"text-sm text-primary hover:text-primary-700 flex items-center space-x-1",children:[s.jsx(G,{name:"Maximize2",size:14}),s.jsx("span",{children:"Expand"})]})]})]}),s.jsx("div",{className:"h-80",ref:Z,children:s.jsx(zn,{width:"100%",height:"100%",children:s.jsxs(sx,{data:j,children:[s.jsx(xi,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),s.jsx(ta,{dataKey:"month",stroke:"#6B7280"}),s.jsx(ra,{stroke:"#6B7280",tickFormatter:J=>`$${J/1e3}k`}),s.jsx(_r,{content:s.jsx(H,{})}),s.jsx(Dn,{type:"monotone",dataKey:"actual",stroke:"#3B82F6",strokeWidth:3,name:"Actual"}),s.jsx(Dn,{type:"monotone",dataKey:"forecast",stroke:"#6366F1",strokeWidth:2,strokeDasharray:"5 5",name:"Forecast"}),s.jsx(Dn,{type:"monotone",dataKey:"target",stroke:"#10B981",strokeWidth:2,name:"Target"}),r&&D.length>0&&s.jsx(Dn,{type:"monotone",dataKey:"actual",data:D,stroke:"#9CA3AF",strokeWidth:2,name:"Previous Period",strokeDasharray:"3 3"})]})})})]})]}),s.jsxs("div",{className:"card p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h3",{className:"text-lg font-normal text-text-primary",children:"Win Rate Analysis"}),s.jsx("div",{className:"text-sm text-text-secondary",children:"Quarterly Performance"})]}),s.jsx("div",{className:"h-80",children:s.jsx(zn,{width:"100%",height:"100%",children:s.jsxs(xl,{data:T,children:[s.jsx(xi,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),s.jsx(ta,{dataKey:"period",stroke:"#6B7280",tick:{fontSize:12}}),s.jsx(ra,{stroke:"#6B7280",tickFormatter:J=>`${J}%`,domain:[0,100],ticks:[0,25,50,75,100],tick:{fontSize:12}}),s.jsx(_r,{content:({active:J,payload:le})=>{var he;if(J&&le&&le[0]){const ee=le[0].payload,ae=ee.total&&ee.total>0;return s.jsxs("div",{className:"bg-white p-3 border border-border rounded-lg shadow-lg",children:[s.jsx("p",{className:"font-semibold text-text-primary mb-1",children:ee.period}),ae?s.jsxs(s.Fragment,{children:[s.jsxs("p",{className:"text-xl font-bold text-primary",children:[(he=ee.winRate)==null?void 0:he.toFixed(1),"%"]}),s.jsxs("p",{className:"text-sm text-text-secondary mt-1",children:[ee.won," won, ",ee.lost," lost"]}),s.jsxs("p",{className:"text-xs text-text-tertiary",children:[ee.total," total deals"]})]}):s.jsx("p",{className:"text-sm text-text-tertiary",children:"No closed deals"})]})}return null}}),s.jsx(Ea,{dataKey:"winRate",name:"Win Rate %",radius:[8,8,0,0],children:T==null?void 0:T.map((J,le)=>{const he=J.total&&J.total>0;let ee="#e5e7eb";return he&&(J.winRate>=70?ee="#10b981":J.winRate>=50?ee="#3b82f6":J.winRate>=30?ee="#f59e0b":ee="#ef4444"),s.jsx(Ns,{fill:ee},`cell-${le}`)})})]})})}),s.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[s.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-text-secondary mb-1",children:"Overall Win Rate"}),s.jsx("p",{className:"text-2xl font-bold text-primary",children:(()=>{const J=(T==null?void 0:T.reduce((he,ee)=>he+(ee.won||0),0))||0,le=(T==null?void 0:T.reduce((he,ee)=>he+(ee.total||0),0))||0;return le>0?`${(J/le*100).toFixed(1)}%`:"0%"})()}),s.jsxs("p",{className:"text-xs text-text-tertiary mt-1",children:[T==null?void 0:T.reduce((J,le)=>J+(le.won||0),0)," won / ",T==null?void 0:T.reduce((J,le)=>J+(le.total||0),0)," closed"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-text-secondary mb-1",children:"Best Quarter"}),s.jsx("p",{className:"text-2xl font-bold text-success",children:(()=>{const J=(T==null?void 0:T.filter(he=>he.total>0))||[];return J.length===0?"N/A":J.reduce((he,ee)=>ee.winRate>he.winRate?ee:he).period})()}),s.jsx("p",{className:"text-xs text-text-tertiary mt-1",children:(()=>{var he;const J=(T==null?void 0:T.filter(ee=>ee.total>0))||[];return J.length===0?"No data":`${(he=J.reduce((ee,ae)=>ae.winRate>ee.winRate?ae:ee).winRate)==null?void 0:he.toFixed(1)}% win rate`})()})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-text-secondary mb-1",children:"Active Quarters"}),s.jsxs("p",{className:"text-2xl font-bold text-text-primary",children:[(T==null?void 0:T.filter(J=>J.total>0).length)||0,"/4"]}),s.jsx("p",{className:"text-xs text-text-tertiary mt-1",children:"with closed deals"})]})]}),s.jsx("div",{className:"mt-3 pt-3 border-t border-blue-300",children:s.jsxs("div",{className:"flex items-center space-x-4 text-xs",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("div",{className:"w-3 h-3 bg-green-500 rounded"}),s.jsx("span",{className:"text-text-tertiary",children:"70% Great"})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded"}),s.jsx("span",{className:"text-text-tertiary",children:"50-70% Good"})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded"}),s.jsx("span",{className:"text-text-tertiary",children:"30-50% Fair"})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("div",{className:"w-3 h-3 bg-red-500 rounded"}),s.jsx("span",{className:"text-text-tertiary",children:"<30% Poor"})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("div",{className:"w-3 h-3 bg-gray-300 rounded"}),s.jsx("span",{className:"text-text-tertiary",children:"No data"})]})]})})]})]})]}),l==="pipeline"&&s.jsx("div",{className:"space-y-8",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsxs("div",{className:"lg:col-span-2 card p-6",children:[s.jsx("h3",{className:"text-lg font-normal text-text-primary mb-6",children:"Pipeline Value by Stage"}),s.jsx("div",{className:"h-80",ref:ie,children:s.jsx(zn,{width:"100%",height:"100%",children:s.jsxs(xl,{data:_,children:[s.jsx(xi,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),s.jsx(ta,{dataKey:"name",stroke:"#6B7280"}),s.jsx(ra,{stroke:"#6B7280"}),s.jsx(_r,{content:s.jsx(H,{})}),s.jsx(Ea,{dataKey:"value",fill:"#3B82F6"})]})})})]}),s.jsxs("div",{className:"card p-6",children:[s.jsx("h3",{className:"text-lg font-normal text-text-primary mb-6",children:"Pipeline Health"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-text-secondary",children:"Total Pipeline"}),s.jsx("span",{className:"text-lg font-normal text-text-primary",children:te((_||[]).reduce((J,le)=>J+((le==null?void 0:le.value)||0),0))})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-text-secondary",children:"Weighted Pipeline"}),s.jsx("span",{className:"text-lg font-normal text-text-primary",children:te((_||[]).reduce((J,le)=>{const he=((le==null?void 0:le.deals)||[]).reduce((ee,ae)=>ee+((ae==null?void 0:ae.value)||0)*(((ae==null?void 0:ae.probability)||0)/100),0);return J+he},0))})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-text-secondary",children:"Best Case"}),s.jsx("span",{className:"text-lg font-normal text-success",children:te((_||[]).reduce((J,le)=>{const he=((le==null?void 0:le.deals)||[]).reduce((ee,ae)=>ee+(((ae==null?void 0:ae.probability)||0)>=70&&(ae==null?void 0:ae.value)||0),0);return J+he},0))})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-text-secondary",children:"Worst Case"}),s.jsx("span",{className:"text-lg font-normal text-error",children:te((_||[]).reduce((J,le)=>{const he=((le==null?void 0:le.deals)||[]).reduce((ee,ae)=>ee+(((ae==null?void 0:ae.probability)||0)<=30&&(ae==null?void 0:ae.value)||0),0);return J+he},0))})]}),s.jsx("div",{className:"pt-4 border-t border-border",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-text-secondary",children:"Coverage Ratio"}),s.jsxs("span",{className:"text-lg font-normal text-primary",children:[(()=>{const J=(_||[]).reduce((ee,ae)=>ee+((ae==null?void 0:ae.value)||0),0),le=(j||[]).reduce((ee,ae)=>ee+((ae==null?void 0:ae.target)||0),0),he=le>0?le:25e5;return(J/he).toFixed(1)})(),"x"]})]})})]})]})]})}),l==="performance"&&s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"card p-6",children:[s.jsx("h3",{className:"text-lg font-normal text-text-primary mb-6",children:"Sales Representative Performance"}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-border",children:[s.jsx("th",{className:"text-left py-3 px-4 text-sm font-normal text-text-secondary",children:"Representative"}),s.jsx("th",{className:"text-right py-3 px-4 text-sm font-normal text-text-secondary",children:"Revenue"}),s.jsx("th",{className:"text-right py-3 px-4 text-sm font-normal text-text-secondary",children:"Deals"}),s.jsx("th",{className:"text-right py-3 px-4 text-sm font-normal text-text-secondary",children:"Quota"}),s.jsx("th",{className:"text-right py-3 px-4 text-sm font-normal text-text-secondary",children:"Attainment"}),s.jsx("th",{className:"text-right py-3 px-4 text-sm font-normal text-text-secondary",children:"Progress"})]})}),s.jsx("tbody",{children:P==null?void 0:P.map(J=>s.jsxs("tr",{className:"border-b border-border-light hover:bg-surface-hover",children:[s.jsx("td",{className:"py-3 px-4 text-sm font-normal text-text-primary",children:J==null?void 0:J.name}),s.jsx("td",{className:"py-3 px-4 text-sm text-text-primary text-right",children:te(J==null?void 0:J.revenue)}),s.jsx("td",{className:"py-3 px-4 text-sm text-text-primary text-right",children:J==null?void 0:J.deals}),s.jsx("td",{className:"py-3 px-4 text-sm text-text-primary text-right",children:te(J==null?void 0:J.quota)}),s.jsxs("td",{className:"py-3 px-4 text-sm text-text-primary text-right",children:[J==null?void 0:J.attainment,"%"]}),s.jsx("td",{className:"py-3 px-4 text-right",children:s.jsx("div",{className:"w-20 bg-border-light rounded-full h-2",children:s.jsx("div",{className:`h-2 rounded-full ${(J==null?void 0:J.attainment)>=100?"bg-success":(J==null?void 0:J.attainment)>=80?"bg-warning":"bg-primary"}`,style:{width:`${Math.min(J==null?void 0:J.attainment,100)}%`}})})})]},J==null?void 0:J.name))})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("div",{className:"card p-6",children:[s.jsx("h3",{className:"text-lg font-normal text-text-primary mb-6",children:"Quota Attainment"}),s.jsx("div",{className:"h-80",children:s.jsx(zn,{width:"100%",height:"100%",children:s.jsxs(xl,{data:P,children:[s.jsx(xi,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),s.jsx(ta,{dataKey:"name",stroke:"#6B7280",angle:-45,textAnchor:"end",height:80}),s.jsx(ra,{stroke:"#6B7280",tickFormatter:J=>`${J}%`}),s.jsx(_r,{content:s.jsx(H,{})}),s.jsx(Ea,{dataKey:"attainment",fill:"#3B82F6",name:"Attainment %"})]})})})]}),s.jsxs("div",{className:"card p-6",children:[s.jsx("h3",{className:"text-lg font-normal text-text-primary mb-6",children:"Revenue by Rep"}),s.jsx("div",{className:"h-80",children:s.jsx(zn,{width:"100%",height:"100%",children:s.jsxs(ox,{children:[s.jsx(si,{data:P,cx:"50%",cy:"50%",outerRadius:100,fill:"#3B82F6",dataKey:"revenue",label:({cx:J,cy:le,midAngle:he,innerRadius:ee,outerRadius:ae,percent:xe,name:ye})=>{if(xe<.05)return null;const Ce=Math.PI/180,Ie=ae+25,Ze=J+Ie*Math.cos(-he*Ce),Fe=le+Ie*Math.sin(-he*Ce);return s.jsx("text",{x:Ze,y:Fe,fill:"#64748b",textAnchor:Ze>J?"start":"end",dominantBaseline:"central",fontSize:"12",children:`${ye}: ${(xe*100).toFixed(0)}%`})},labelLine:{stroke:"#cbd5e1",strokeWidth:1},children:P==null?void 0:P.map((J,le)=>s.jsx(Ns,{fill:`hsl(${220+le*30}, 70%, ${50+le*10}%)`},`cell-${le}`))}),s.jsx(_r,{content:s.jsx(H,{})})]})})})]})]})]}),l==="forecasting"&&s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"card p-6 text-center",children:[s.jsx("h3",{className:"text-sm font-normal text-text-secondary mb-2",children:"Total Forecast"}),s.jsx("p",{className:"text-3xl font-normal text-primary mb-1",children:te((j||[]).reduce((J,le)=>J+((le==null?void 0:le.forecast)||0),0))}),s.jsxs("p",{className:"text-sm text-success flex items-center justify-center space-x-1",children:[s.jsx(G,{name:"TrendingUp",size:14}),s.jsx("span",{children:"Based on expected close dates"})]})]}),s.jsxs("div",{className:"card p-6 text-center",children:[s.jsx("h3",{className:"text-sm font-normal text-text-secondary mb-2",children:"Total Actual Revenue"}),s.jsx("p",{className:"text-3xl font-normal text-secondary mb-1",children:te((j||[]).reduce((J,le)=>J+((le==null?void 0:le.actual)||0),0))}),s.jsx("p",{className:"text-sm text-text-secondary",children:"From closed won deals"})]}),s.jsxs("div",{className:"card p-6 text-center",children:[s.jsx("h3",{className:"text-sm font-normal text-text-secondary mb-2",children:"Overall Win Rate"}),s.jsx("p",{className:"text-3xl font-normal text-accent mb-1",children:((oe=E==null?void 0:E.find(J=>J.metric==="Win Rate"))==null?void 0:oe.value)||"0%"}),s.jsx("p",{className:"text-sm text-text-secondary",children:"Of all deals"})]})]}),s.jsxs("div",{className:"card p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h3",{className:"text-lg font-normal text-text-primary",children:"AI-Enhanced Revenue Forecast"}),s.jsxs("div",{className:"flex items-center space-x-2 text-xs text-text-tertiary",children:[s.jsx(G,{name:"Zap",size:12,className:"text-blue-500"}),s.jsx("span",{children:"AI Predictions"})]})]}),s.jsx("div",{className:"h-80",children:s.jsx(zn,{width:"100%",height:"100%",children:s.jsxs(sx,{data:q,children:[s.jsx(xi,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),s.jsx(ta,{dataKey:"month",stroke:"#6B7280"}),s.jsx(ra,{stroke:"#6B7280",tickFormatter:J=>`$${J/1e3}k`}),s.jsx(_r,{content:s.jsx(H,{})}),s.jsx(Dn,{type:"monotone",dataKey:"actual",stroke:"#3B82F6",strokeWidth:3,name:"Actual Revenue"}),s.jsx(Dn,{type:"monotone",dataKey:"forecast",stroke:"#6366F1",strokeWidth:2,strokeDasharray:"5 5",name:"Traditional Forecast"}),s.jsx(Dn,{type:"monotone",dataKey:"aiPrediction",stroke:"#8B5CF6",strokeWidth:2,name:"AI Prediction"}),s.jsx(Dn,{type:"monotone",dataKey:"target",stroke:"#10B981",strokeWidth:2,name:"Target"})]})})}),s.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg text-sm",children:s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(G,{name:"Info",size:16,className:"text-blue-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-blue-800 font-medium",children:"AI Forecast Insights"}),s.jsxs("p",{className:"text-blue-700 mt-1",children:["Our AI model suggests a ",Math.round(Math.random()*10+5),"% increase in closing probability based on recent activity patterns and market conditions."]})]})]})})]}),s.jsx("div",{className:"card p-6 bg-gradient-to-r from-purple-50 to-indigo-50 border-purple-200",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center flex-shrink-0 mt-1",children:s.jsx(G,{name:"Sparkles",size:16,className:"text-purple-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-3",children:"AI-Powered Recommendations"}),s.jsxs("div",{className:"space-y-3 text-sm text-text-secondary",children:[s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(G,{name:"Target",size:14,className:"text-green-600 mt-0.5"}),s.jsxs("p",{children:[s.jsx("strong",{children:"Focus Area:"})," Deals in negotiation stage are 23% more likely to close with increased follow-up frequency."]})]}),s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(G,{name:"TrendingUp",size:14,className:"text-blue-600 mt-0.5"}),s.jsxs("p",{children:[s.jsx("strong",{children:"Opportunity:"})," Enterprise segment shows 40% higher conversion rates. Consider reallocating resources."]})]}),s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(G,{name:"Clock",size:14,className:"text-orange-600 mt-0.5"}),s.jsxs("p",{children:[s.jsx("strong",{children:"Timing:"})," Optimal contact time for your prospects is Tuesday-Thursday, 10-11 AM based on response patterns."]})]}),s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(G,{name:"AlertTriangle",size:14,className:"text-red-600 mt-0.5"}),s.jsxs("p",{children:[s.jsx("strong",{children:"Risk Alert:"})," 3 high-value deals have been in negotiation for over 30 days. Consider intervention strategies."]})]})]})]})]})})]})]})})}),x&&h&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4 overflow-y-auto",children:s.jsxs("div",{className:"bg-white dark:bg-surface rounded-lg shadow-xl w-full max-w-4xl my-8 flex flex-col max-h-[calc(100vh-4rem)]",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border flex-shrink-0",children:[s.jsxs("h2",{className:"text-xl font-semibold text-text-primary",children:["Detailed Analysis - ",h.chartType.replace("-"," ").toUpperCase()]}),s.jsx("button",{onClick:()=>p(!1),className:"p-2 text-text-secondary hover:text-text-primary hover:bg-surface-hover rounded-lg transition-colors duration-150",children:s.jsx(G,{name:"X",size:20})})]}),s.jsxs("div",{className:"p-6 overflow-y-auto flex-1",children:[h.chartType==="funnel-stage"&&s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold mb-4",children:[h.data.name," Stage Details"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[s.jsxs("div",{className:"card p-4",children:[s.jsx("p",{className:"text-sm text-text-secondary",children:"Total Value"}),s.jsx("p",{className:"text-xl font-bold text-text-primary",children:te(h.data.value)})]}),s.jsxs("div",{className:"card p-4",children:[s.jsx("p",{className:"text-sm text-text-secondary",children:"Deal Count"}),s.jsx("p",{className:"text-xl font-bold text-text-primary",children:h.data.count})]}),s.jsxs("div",{className:"card p-4",children:[s.jsx("p",{className:"text-sm text-text-secondary",children:"Avg Deal Size"}),s.jsx("p",{className:"text-xl font-bold text-text-primary",children:te(h.data.value/h.data.count)})]})]}),h.data.deals&&s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium mb-3",children:"Deals in this stage:"}),s.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:h.data.deals.slice(0,10).map((J,le)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-surface rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-text-primary",children:J.title||`Deal ${le+1}`}),s.jsx("p",{className:"text-sm text-text-secondary",children:J.company||"Company Name"})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-medium text-text-primary",children:te(J.value)}),s.jsxs("p",{className:"text-xs text-text-tertiary",children:[Math.floor(Math.random()*30+1)," days in stage"]})]})]},le))})]})]}),h.chartType==="revenue-trend"&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Revenue Trend Analysis"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"card p-4",children:[s.jsx("p",{className:"text-sm text-text-secondary",children:"Total Revenue"}),s.jsx("p",{className:"text-xl font-bold text-text-primary",children:te(h.data.reduce((J,le)=>J+(le.actual||0),0))})]}),s.jsxs("div",{className:"card p-4",children:[s.jsx("p",{className:"text-sm text-text-secondary",children:"Growth Rate"}),s.jsxs("p",{className:"text-xl font-bold text-success",children:["+",Math.floor(Math.random()*20+5),"%"]})]})]}),s.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[s.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Key Insights"}),s.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[s.jsx("li",{children:" Strongest performance in Q2 with 32% growth"}),s.jsx("li",{children:" Seasonal patterns show peak sales in March and November"}),s.jsx("li",{children:" Enterprise deals drive 68% of total revenue"}),s.jsx("li",{children:" Forecast accuracy has improved by 15% this quarter"})]})]})]})]})]}),s.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-border bg-surface flex-shrink-0",children:[s.jsx("button",{onClick:()=>p(!1),className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors duration-150",children:"Close"}),s.jsx("button",{className:"btn-primary",children:"Export Details"})]})]})}),d&&s.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>f(!1)})]})},VRe=({activity:e,isLast:t,isSelected:r,onSelectionChange:n,showCheckbox:a=!1,onEdit:i,onDelete:o})=>{var b,_,w,j,N,D,S;const[c,l]=R.useState(!1),{hasAnyPermission:u}=Pt();R.useEffect(()=>{kr.loadConfiguration()},[]);const d=T=>kr.formatCurrency(T),f=T=>{T.stopPropagation(),n(T.target.checked)},h=()=>(e==null?void 0:e.contact)||"N/A",m=()=>(e==null?void 0:e.company)||"N/A",x=()=>(e==null?void 0:e.user)||"System",p=T=>{switch(T){case"email":return"Mail";case"call":return"Phone";case"meeting":return"Calendar";case"deal_update":return"TrendingUp";case"task":return"CheckSquare";default:return"Activity"}},g=T=>{switch(T){case"email":return"text-blue-700 bg-blue-100 border border-blue-200";case"call":return"text-green-700 bg-green-100 border border-green-200";case"meeting":return"text-purple-700 bg-purple-100 border border-purple-200";case"deal_update":return"text-orange-700 bg-orange-100 border border-orange-200";case"task":return"text-indigo-700 bg-indigo-100 border border-indigo-200";default:return"text-gray-700 bg-gray-100 border border-gray-200"}},v=T=>{switch(T){case"high":return"text-error bg-error-50";case"medium":return"text-warning bg-warning-50";case"low":return"text-success bg-success-50";default:return"text-text-secondary bg-gray-50"}},y=T=>{const E=new Date-T,M=Math.floor(E/(1e3*60*60)),P=Math.floor(M/24);return M<1?"Just now":M<24?`${M}h ago`:P<7?`${P}d ago`:T==null?void 0:T.toLocaleDateString()};return s.jsxs("div",{className:"relative",children:[!t&&s.jsx("div",{className:"absolute left-6 top-16 w-0.5 h-full bg-border"}),s.jsxs("div",{className:"flex space-x-4",children:[s.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${g(e==null?void 0:e.type)} flex-shrink-0 shadow-sm`,children:s.jsx(G,{name:p(e==null?void 0:e.type),size:20})}),s.jsxs("div",{className:"flex-1 bg-white rounded-lg border border-border shadow-sm hover:shadow-md transition-shadow duration-200",children:[s.jsx("div",{className:"p-6 border-b border-border",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[a&&s.jsx("input",{type:"checkbox",checked:r,onChange:f,className:"rounded border-border text-primary focus:ring-primary"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary line-clamp-1",children:(e==null?void 0:e.title)||"Untitled Activity"}),s.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium capitalize ${v(e==null?void 0:e.priority)} whitespace-nowrap`,children:(e==null?void 0:e.type)||"note"}),((b=e==null?void 0:e.deal)==null?void 0:b.value)&&s.jsx("span",{className:"px-3 py-1 bg-success-50 text-success rounded-full text-xs font-medium whitespace-nowrap",children:d(e.deal.value)})]}),s.jsxs("div",{className:"flex items-center space-x-4 text-sm text-text-tertiary",children:[s.jsxs("span",{className:"flex items-center space-x-1",children:[s.jsx(G,{name:"Clock",size:14}),s.jsx("span",{children:y(e==null?void 0:e.timestamp)})]}),(e==null?void 0:e.duration)&&s.jsxs("span",{className:"flex items-center space-x-1",children:[s.jsx(G,{name:"Timer",size:14}),s.jsx("span",{children:e.duration})]}),x()!=="System"&&s.jsxs("span",{className:"flex items-center space-x-1",children:[s.jsx(G,{name:"User",size:14}),s.jsx("span",{children:x()})]})]})]})]}),s.jsxs("div",{className:"flex items-center space-x-1 flex-shrink-0",children:[u(["activities.edit_all","activities.edit_own"])&&s.jsx("button",{onClick:()=>i&&i(e),className:"p-2 text-text-tertiary hover:text-primary hover:bg-primary-50 rounded transition-colors duration-150",title:"Edit activity",children:s.jsx(G,{name:"Edit2",size:16})}),u(["activities.delete_all","activities.delete_own"])&&s.jsx("button",{onClick:()=>o&&o(e.id),className:"p-2 text-text-tertiary hover:text-error hover:bg-error-50 rounded transition-colors duration-150",title:"Delete activity",children:s.jsx(G,{name:"Trash2",size:16})})]})]})}),s.jsx("div",{className:"px-6 py-4 bg-surface-50",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center shadow-sm",children:s.jsx("span",{className:"text-sm font-bold text-black",children:h().split(" ").map(T=>T[0]).join("").substr(0,2)})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-text-primary",children:h()}),s.jsxs("div",{className:"text-sm text-text-secondary flex items-center space-x-1",children:[s.jsx(G,{name:"Building",size:12}),s.jsx("span",{children:m()})]})]})]}),s.jsx("div",{className:"flex items-center space-x-2",children:s.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${g(e==null?void 0:e.type)}`,children:[s.jsx(G,{name:p(e==null?void 0:e.type),size:12,className:"mr-1"}),((_=e==null?void 0:e.type)==null?void 0:_.replace("_"," "))||"note"]})})]})}),(e==null?void 0:e.description)&&s.jsxs("div",{className:"px-6 py-4",children:[s.jsx("p",{className:"text-text-primary text-sm leading-relaxed",children:c?e==null?void 0:e.description:`${(w=e==null?void 0:e.description)==null?void 0:w.substring(0,200)}${((j=e==null?void 0:e.description)==null?void 0:j.length)>200?"...":""}`}),((N=e==null?void 0:e.description)==null?void 0:N.length)>200&&s.jsxs("button",{onClick:()=>l(!c),className:"text-primary text-sm font-medium hover:text-primary-600 mt-2 transition-colors flex items-center space-x-1",children:[s.jsx("span",{children:c?"Show less":"Read more"}),s.jsx(G,{name:c?"ChevronUp":"ChevronDown",size:14})]})]}),c&&s.jsxs("div",{className:"space-y-4 border-t border-border pt-4",children:[(e==null?void 0:e.attachments)&&((D=e==null?void 0:e.attachments)==null?void 0:D.length)>0&&s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-text-primary mb-2",children:"Attachments"}),s.jsx("div",{className:"space-y-2",children:(S=e==null?void 0:e.attachments)==null?void 0:S.map((T,A)=>s.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[s.jsx(G,{name:"Paperclip",size:14,className:"text-text-tertiary"}),s.jsx("span",{className:"text-primary hover:text-primary-700 cursor-pointer",children:T})]},A))})]}),(e==null?void 0:e.type)==="deal_update"&&(e==null?void 0:e.previousStage)&&s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-text-primary mb-2",children:"Stage Progression"}),s.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[s.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded",children:e==null?void 0:e.previousStage}),s.jsx(G,{name:"ArrowRight",size:14,className:"text-text-tertiary"}),s.jsx("span",{className:"px-2 py-1 bg-primary-50 text-primary rounded",children:e==null?void 0:e.currentStage}),s.jsxs("span",{className:"text-text-secondary ml-2",children:["(",e==null?void 0:e.probability,"% probability)"]})]})]}),(e==null?void 0:e.type)==="meeting"&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(e==null?void 0:e.location)&&s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-text-primary",children:"Location:"}),s.jsx("span",{className:"text-text-secondary ml-2",children:e==null?void 0:e.location})]}),(e==null?void 0:e.attendees)&&s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-text-primary",children:"Attendees:"}),s.jsxs("span",{className:"text-text-secondary ml-2",children:[e==null?void 0:e.attendees," people"]})]})]}),(e==null?void 0:e.type)==="call"&&s.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-text-primary",children:"Type:"}),s.jsx("span",{className:"text-text-secondary ml-2 capitalize",children:e==null?void 0:e.callType})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-text-primary",children:"Status:"}),s.jsx("span",{className:"text-text-secondary ml-2 capitalize",children:e==null?void 0:e.status})]})]})]})]})]})]})},GRe=({selectedFilters:e,onFiltersChange:t})=>{const[r,n]=R.useState([{value:"all",label:"All Contacts"}]),[a,i]=R.useState(!1);R.useEffect(()=>{(async()=>{try{i(!0),console.log("Loading contacts for activity filters...");const f=await Nt.getContactsForActivityFilters();console.log("Loaded contacts with activity counts:",f);const h=[{value:"all",label:"All Contacts"},...f.map(m=>({value:m.id,label:`${m.first_name} ${m.last_name}`,activityCount:m.activity_count||0}))];console.log("Contact options:",h),n(h)}catch(f){console.error("Error loading contacts:",f),n([{value:"all",label:"All Contacts"}])}finally{i(!1)}})()},[]);const o=[{value:"all",label:"All Activities",icon:"Activity"},{value:"email",label:"Emails",icon:"Mail"},{value:"call",label:"Calls",icon:"Phone"},{value:"meeting",label:"Meetings",icon:"Calendar"},{value:"deal_update",label:"Deal Updates",icon:"TrendingUp"},{value:"task",label:"Tasks",icon:"CheckSquare"}],c=[{value:"all",label:"All Time"},{value:"today",label:"Today"},{value:"week",label:"This Week"},{value:"month",label:"This Month"}],l=[{value:"all",label:"All Channels",icon:"Globe"},{value:"gmail",label:"Gmail",icon:"Mail"},{value:"twilio",label:"Phone",icon:"Phone"},{value:"calendar",label:"Calendar",icon:"Calendar"},{value:"system",label:"System",icon:"Settings"}],u=(d,f)=>{t({...e,[d]:f})};return s.jsxs("div",{className:"space-y-6 pb-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Contact"}),s.jsx("div",{className:"space-y-2",children:a?s.jsxs("div",{className:"flex items-center space-x-2 text-sm text-text-secondary",children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"}),s.jsx("span",{children:"Loading contacts..."})]}):r==null?void 0:r.map(d=>s.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[s.jsx("input",{type:"radio",name:"teamMember",value:d==null?void 0:d.value,checked:(e==null?void 0:e.teamMember)===(d==null?void 0:d.value),onChange:f=>{var h;return u("teamMember",(h=f==null?void 0:f.target)==null?void 0:h.value)},className:"w-4 h-4 text-primary border-border focus:ring-primary-500"}),s.jsxs("div",{className:"flex items-center justify-between w-full",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm text-text-secondary",children:d==null?void 0:d.label}),(d==null?void 0:d.value)!=="all"&&(d==null?void 0:d.activityCount)!==void 0&&s.jsx("div",{className:"text-xs text-text-tertiary",children:s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(G,{name:"Activity",size:10}),s.jsxs("span",{children:[d.activityCount," activities"]})]})})]}),(d==null?void 0:d.value)!=="all"&&(d==null?void 0:d.activityCount)!==void 0&&s.jsx("div",{className:"text-xs bg-primary-100 text-primary-700 px-2 py-1 rounded-full",children:d.activityCount})]})]},d==null?void 0:d.value))})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Activity Type"}),s.jsx("div",{className:"space-y-2",children:o==null?void 0:o.map(d=>s.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[s.jsx("input",{type:"radio",name:"activityType",value:d==null?void 0:d.value,checked:(e==null?void 0:e.activityType)===(d==null?void 0:d.value),onChange:f=>{var h;return u("activityType",(h=f==null?void 0:f.target)==null?void 0:h.value)},className:"w-4 h-4 text-primary border-border focus:ring-primary-500"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:d==null?void 0:d.icon,size:16,className:"text-text-secondary"}),s.jsx("span",{className:"text-sm text-text-secondary",children:d==null?void 0:d.label})]})]},d==null?void 0:d.value))})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Date Range"}),s.jsx("div",{className:"space-y-2",children:c==null?void 0:c.map(d=>s.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[s.jsx("input",{type:"radio",name:"dateRange",value:d==null?void 0:d.value,checked:(e==null?void 0:e.dateRange)===(d==null?void 0:d.value),onChange:f=>{var h;return u("dateRange",(h=f==null?void 0:f.target)==null?void 0:h.value)},className:"w-4 h-4 text-primary border-border focus:ring-primary-500"}),s.jsx("span",{className:"text-sm text-text-secondary",children:d==null?void 0:d.label})]},d==null?void 0:d.value))})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Communication Channel"}),s.jsx("div",{className:"space-y-2",children:l==null?void 0:l.map(d=>s.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[s.jsx("input",{type:"radio",name:"channel",value:d==null?void 0:d.value,checked:(e==null?void 0:e.channel)===(d==null?void 0:d.value),onChange:f=>{var h;return u("channel",(h=f==null?void 0:f.target)==null?void 0:h.value)},className:"w-4 h-4 text-primary border-border focus:ring-primary-500"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:d==null?void 0:d.icon,size:16,className:"text-text-secondary"}),s.jsx("span",{className:"text-sm text-text-secondary",children:d==null?void 0:d.label})]})]},d==null?void 0:d.value))})]}),s.jsxs("div",{className:"pt-4 border-t border-border",children:[s.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Quick Actions"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("button",{className:"w-full flex items-center space-x-2 px-3 py-2 text-sm text-text-secondary hover:text-primary hover:bg-primary-50 rounded-lg transition-all duration-150 ease-out",children:[s.jsx(G,{name:"Filter",size:16}),s.jsx("span",{children:"Save Current Filter"})]}),s.jsxs("button",{className:"w-full flex items-center space-x-2 px-3 py-2 text-sm text-text-secondary hover:text-primary hover:bg-primary-50 rounded-lg transition-all duration-150 ease-out",children:[s.jsx(G,{name:"RefreshCw",size:16}),s.jsx("span",{children:"Refresh Timeline"})]}),s.jsxs("button",{className:"w-full flex items-center space-x-2 px-3 py-2 text-sm text-text-secondary hover:text-primary hover:bg-primary-50 rounded-lg transition-all duration-150 ease-out",children:[s.jsx(G,{name:"Settings",size:16}),s.jsx("span",{children:"Timeline Settings"})]})]})]})]})},XRe=({activities:e})=>{var n;const t=R.useMemo(()=>{if(!e.length)return null;const a=e.reduce((x,p)=>(x[p.type]=(x[p.type]||0)+1,x),{}),i=Object.entries(a).map(([x,p])=>({type:x.charAt(0).toUpperCase()+x.slice(1).replace("_"," "),count:p})),c=Array.from({length:30},(x,p)=>{const g=new Date;return g.setDate(g.getDate()-p),g.toISOString().split("T")[0]}).reverse().map(x=>{const p=e.filter(g=>g.timestamp.toISOString().split("T")[0]===x).length;return{date:new Date(x).toLocaleDateString("en-US",{month:"short",day:"numeric"}),activities:p}}),l=e.reduce((x,p)=>(x[p.channel]=(x[p.channel]||0)+1,x),{}),u=Object.entries(l).map(([x,p])=>({channel:x.charAt(0).toUpperCase()+x.slice(1),count:p,fill:r(x)})),d=Math.floor(Math.random()*4)+1,f=Math.floor(Math.random()*20)+5,h=e.filter(x=>x.status==="completed").length,m=e.length>0?Math.round(h/e.length*100):0;return{typeChartData:i,trendData:c,channelChartData:u,avgResponseTime:d,responseTimeImprovement:f,completionRate:m,totalActivities:e.length,todayActivities:e.filter(x=>x.timestamp.toDateString()===new Date().toDateString()).length}},[e]),r=a=>({gmail:"#4285F4",twilio:"#F22F46",calendar:"#34A853",system:"#9AA0A6"})[a]||"#9AA0A6";return t?s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[s.jsx("div",{className:"card p-6",children:s.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-50 rounded-lg flex items-center justify-center",children:s.jsx(G,{name:"Activity",size:20,className:"text-blue-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-text-secondary",children:"Total Activities"}),s.jsx("p",{className:"text-2xl font-bold text-text-primary",children:t.totalActivities})]})]})}),s.jsx("div",{className:"card p-6",children:s.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[s.jsx("div",{className:"w-10 h-10 bg-green-50 rounded-lg flex items-center justify-center",children:s.jsx(G,{name:"TrendingUp",size:20,className:"text-green-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-text-secondary",children:"Today's Activities"}),s.jsx("p",{className:"text-2xl font-bold text-text-primary",children:t.todayActivities})]})]})}),s.jsx("div",{className:"card p-6",children:s.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[s.jsx("div",{className:"w-10 h-10 bg-purple-50 rounded-lg flex items-center justify-center",children:s.jsx(G,{name:"Clock",size:20,className:"text-purple-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-text-secondary",children:"Avg Response Time"}),s.jsxs("p",{className:"text-2xl font-bold text-text-primary",children:[t.avgResponseTime,"h"]}),s.jsxs("p",{className:"text-xs text-green-600",children:[" ",t.responseTimeImprovement,"% this month"]})]})]})}),s.jsx("div",{className:"card p-6",children:s.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[s.jsx("div",{className:"w-10 h-10 bg-orange-50 rounded-lg flex items-center justify-center",children:s.jsx(G,{name:"CheckCircle",size:20,className:"text-orange-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-text-secondary",children:"Completion Rate"}),s.jsxs("p",{className:"text-2xl font-bold text-text-primary",children:[t.completionRate,"%"]})]})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("div",{className:"card p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-6",children:"Activity Volume by Type"}),s.jsx("div",{className:"h-80",children:s.jsx(zn,{width:"100%",height:"100%",children:s.jsxs(xl,{data:t.typeChartData,children:[s.jsx(xi,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),s.jsx(ta,{dataKey:"type",stroke:"#6B7280",fontSize:12}),s.jsx(ra,{stroke:"#6B7280",fontSize:12}),s.jsx(_r,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #E5E7EB",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),s.jsx(Ea,{dataKey:"count",fill:"#3B82F6",radius:[4,4,0,0]})]})})})]}),s.jsxs("div",{className:"card p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-6",children:"Channel Distribution"}),s.jsx("div",{className:"h-80",children:s.jsx(zn,{width:"100%",height:"100%",children:s.jsxs(ox,{children:[s.jsx(si,{data:t.channelChartData,cx:"50%",cy:"50%",labelLine:!1,label:({channel:a,percent:i})=>`${a} (${(i*100).toFixed(0)}%)`,outerRadius:80,fill:"#8884d8",dataKey:"count",children:t.channelChartData.map((a,i)=>s.jsx(Ns,{fill:a.fill},`cell-${i}`))}),s.jsx(_r,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #E5E7EB",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}})]})})})]})]}),s.jsxs("div",{className:"card p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-6",children:"Activity Trend (Last 30 Days)"}),s.jsx("div",{className:"h-80",children:s.jsx(zn,{width:"100%",height:"100%",children:s.jsxs(sx,{data:t.trendData,children:[s.jsx(xi,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),s.jsx(ta,{dataKey:"date",stroke:"#6B7280",fontSize:12}),s.jsx(ra,{stroke:"#6B7280",fontSize:12}),s.jsx(_r,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #E5E7EB",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),s.jsx(Dn,{type:"monotone",dataKey:"activities",stroke:"#3B82F6",strokeWidth:3,dot:{fill:"#3B82F6",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#3B82F6",strokeWidth:2}})]})})})]}),s.jsx("div",{className:"card p-6 bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-1",children:s.jsx(G,{name:"Zap",size:16,className:"text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"AI Insights"}),s.jsxs("div",{className:"space-y-3 text-sm text-text-secondary",children:[s.jsxs("p",{children:[" Your email response time has improved by ",t.responseTimeImprovement,"% this month. Keep up the great work!"]}),s.jsx("p",{children:" Peak activity hours are between 9-11 AM. Consider scheduling important calls during this time."}),s.jsxs("p",{children:[" ",((n=t.typeChartData[0])==null?void 0:n.type)||"Emails"," make up the majority of your activities. Consider automating routine tasks."]}),s.jsxs("p",{children:[" Your completion rate is ",t.completionRate,"%. ",t.completionRate>80?"Excellent!":"Consider setting reminders for follow-ups."]})]})]})]})})]}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"w-16 h-16 bg-primary-50 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(G,{name:"BarChart3",size:32,className:"text-primary"})}),s.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"No data available"}),s.jsx("p",{className:"text-text-secondary",children:"Add some activities to see insights and analytics."})]})},KRe=({selectedCount:e,selectedIds:t,onBulkAction:r,onClearSelection:n})=>{const a=i=>{r(i,t)};return s.jsxs("div",{className:"bg-primary-50 border border-primary-200 rounded-lg p-4 mb-6 flex items-center justify-between",children:[s.jsx("div",{className:"flex items-center space-x-3",children:s.jsxs("div",{className:"flex items-center space-x-2 text-primary",children:[s.jsx(G,{name:"CheckSquare",size:20}),s.jsxs("span",{className:"font-medium",children:[e," activities selected"]})]})}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("button",{onClick:()=>a("export"),className:"flex items-center space-x-2 px-3 py-1.5 bg-white border border-primary-300 rounded-md text-primary hover:bg-primary-50 transition-colors duration-150",children:[s.jsx(G,{name:"Download",size:16}),s.jsx("span",{children:"Export"})]}),s.jsxs("button",{onClick:()=>a("delete"),className:"flex items-center space-x-2 px-3 py-1.5 bg-red-50 border border-red-300 rounded-md text-red-600 hover:bg-red-100 transition-colors duration-150",children:[s.jsx(G,{name:"Trash2",size:16}),s.jsx("span",{children:"Delete"})]}),s.jsxs("button",{onClick:n,className:"flex items-center space-x-2 px-3 py-1.5 text-text-secondary hover:text-text-primary transition-colors duration-150",children:[s.jsx(G,{name:"X",size:16}),s.jsx("span",{children:"Clear"})]})]})]})},YRe={getBuiltInTemplates(){return[{id:"follow-up-email",name:"Follow-up Email",description:"Standard follow-up email template",type:"email",icon:"Mail",category:"communication",template:{subject:"Follow up on our conversation",description:`Hi {contact_name},

I wanted to follow up on our conversation about {topic}. Do you have any questions or would you like to schedule a call to discuss next steps?

Best regards,
{user_name}`,priority:"medium",duration_minutes:15}},{id:"discovery-call",name:"Discovery Call",description:"Initial discovery call template",type:"call",icon:"Phone",category:"sales",template:{subject:"Discovery call with {contact_name}",description:`Discovery call to understand {company_name}'s needs and challenges.

Topics to cover:
- Current situation
- Pain points
- Goals and objectives
- Timeline
- Budget considerations`,priority:"high",duration_minutes:30}},{id:"demo-meeting",name:"Product Demo",description:"Product demonstration meeting",type:"meeting",icon:"Monitor",category:"sales",template:{subject:"Product demo for {company_name}",description:`Product demonstration meeting with {contact_name} from {company_name}.

Demo agenda:
- Overview of our solution
- Key features relevant to their needs
- Q&A session
- Next steps discussion`,priority:"high",duration_minutes:45}},{id:"proposal-review",name:"Proposal Review",description:"Review proposal with client",type:"meeting",icon:"FileText",category:"sales",template:{subject:"Proposal review meeting",description:`Review and discuss the proposal with {contact_name}.

Agenda:
- Walk through proposal details
- Address questions and concerns
- Discuss terms and conditions
- Timeline for decision`,priority:"high",duration_minutes:60}},{id:"check-in-call",name:"Check-in Call",description:"Regular customer check-in",type:"call",icon:"Phone",category:"support",template:{subject:"Regular check-in with {contact_name}",description:`Scheduled check-in call to ensure customer satisfaction and identify any issues or opportunities.

Discussion points:
- How things are going
- Any challenges or concerns
- Feedback on our service
- Upcoming needs or projects`,priority:"medium",duration_minutes:20}},{id:"thank-you-email",name:"Thank You Email",description:"Post-meeting thank you",type:"email",icon:"Heart",category:"communication",template:{subject:"Thank you for your time",description:`Hi {contact_name},

Thank you for taking the time to meet with me today. I appreciate your insights about {company_name}'s needs.

As discussed, I'll {next_action} and get back to you by {follow_up_date}.

Please don't hesitate to reach out if you have any questions.

Best regards,
{user_name}`,priority:"low",duration_minutes:10}},{id:"contract-negotiation",name:"Contract Negotiation",description:"Contract terms discussion meeting",type:"meeting",icon:"FileCheck",category:"sales",template:{subject:"Contract negotiation with {company_name}",description:`Meeting to discuss and negotiate contract terms with {contact_name}.

Agenda:
- Review contract terms
- Discuss pricing and payment terms
- Address legal requirements
- Finalize implementation timeline
- Next steps for signing`,priority:"high",duration_minutes:90}},{id:"onboarding-kickoff",name:"Onboarding Kickoff",description:"Customer onboarding initialization",type:"meeting",icon:"Users",category:"support",template:{subject:"Welcome to {company_name} - Onboarding kickoff",description:`Onboarding kickoff meeting with {contact_name} to begin implementation.

Agenda:
- Welcome and introductions
- Project timeline overview
- Resource requirements
- Communication protocols
- Initial setup steps`,priority:"high",duration_minutes:60}}]},getTemplatesByCategory(e){return this.getBuiltInTemplates().filter(t=>t.category===e)},getTemplatesByType(e){return this.getBuiltInTemplates().filter(t=>t.type===e)},getTemplateById(e){return this.getBuiltInTemplates().find(t=>t.id===e)},getAvailableVariables(){return{contact_name:"Contact's full name",company_name:"Company name",user_name:"Current user's name",deal_title:"Deal title",deal_value:"Deal value (formatted)",today:"Today's date",follow_up_date:"One week from today",topic:"Discussion topic (placeholder)",next_action:"Next action item (placeholder)"}},substituteVariables(e,t={}){var i;if(!e)return e;let r=e;if(t.user){const o=t.user.first_name&&t.user.last_name?`${t.user.first_name} ${t.user.last_name}`:t.user.email||"User";r=r.replace(/{user_name}/g,o)}t.contact&&(r=r.replace(/{contact_name}/g,`${t.contact.first_name} ${t.contact.last_name}`),r=r.replace(/{company_name}/g,((i=t.contact.company)==null?void 0:i.name)||"[Company Name]")),t.deal&&(r=r.replace(/{deal_title}/g,t.deal.title||"[Deal Title]"),r=r.replace(/{deal_value}/g,t.deal.value?`$${t.deal.value.toLocaleString()}`:"[Deal Value]"));const n=new Date,a=new Date(n.getTime()+7*24*60*60*1e3);return r=r.replace(/{today}/g,n.toLocaleDateString()),r=r.replace(/{follow_up_date}/g,a.toLocaleDateString()),r=r.replace(/{contact_name}/g,"[Contact Name]"),r=r.replace(/{company_name}/g,"[Company Name]"),r=r.replace(/{user_name}/g,"[User Name]"),r=r.replace(/{topic}/g,"[Discussion Topic]"),r=r.replace(/{next_action}/g,"[Next Action]"),r}},ZRe=({isOpen:e,onClose:t,onTemplateSelected:r})=>{const[n,a]=R.useState(null),[i,o]=R.useState("all"),c=YRe.getBuiltInTemplates(),l=["all","communication","sales","support"],u=i==="all"?c:c.filter(h=>h.category===i),d=h=>{switch(h){case"email":return"text-blue-600 bg-blue-50";case"call":return"text-green-600 bg-green-50";case"meeting":return"text-purple-600 bg-purple-50";default:return"text-gray-600 bg-gray-50"}},f=h=>{r(h)};return e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border",children:[s.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Activity Templates"}),s.jsx("button",{onClick:t,className:"p-2 text-text-secondary hover:text-text-primary hover:bg-surface-hover rounded-lg transition-colors duration-150",children:s.jsx(G,{name:"X",size:20})})]}),s.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-200px)]",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("p",{className:"text-text-secondary text-sm mb-4",children:"Select a template to quickly create an activity with pre-filled content. Template variables will be automatically substituted with actual data."}),s.jsx("div",{className:"flex flex-wrap gap-2",children:l.map(h=>s.jsx("button",{onClick:()=>o(h),className:`px-3 py-1 text-sm rounded-full transition-colors duration-150 ${i===h?"bg-primary text-white":"bg-surface text-text-secondary hover:bg-surface-hover"}`,children:h.charAt(0).toUpperCase()+h.slice(1)},h))})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:u.map(h=>s.jsxs("div",{className:`border border-border rounded-lg p-4 cursor-pointer transition-all duration-150 hover:shadow-md ${(n==null?void 0:n.id)===h.id?"border-primary bg-primary-50":"hover:border-border-dark"}`,onClick:()=>a(h),children:[s.jsxs("div",{className:"flex items-start space-x-3 mb-3",children:[s.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${d(h.type)}`,children:s.jsx(G,{name:h.icon,size:20})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-medium text-text-primary mb-1",children:h.name}),s.jsx("p",{className:"text-sm text-text-secondary",children:h.description})]})]}),s.jsxs("div",{className:"flex items-center justify-between text-xs text-text-tertiary",children:[s.jsx("span",{className:"px-2 py-1 bg-surface rounded-full",children:h.type.charAt(0).toUpperCase()+h.type.slice(1)}),s.jsxs("span",{children:[h.template.duration_minutes," min"]})]})]},h.id))}),n&&s.jsxs("div",{className:"mt-6 space-y-4",children:[s.jsxs("div",{className:"p-4 border border-border rounded-lg bg-surface",children:[s.jsx("h4",{className:"font-medium text-text-primary mb-3",children:"Template Preview"}),s.jsxs("div",{className:"space-y-3 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-text-secondary",children:"Subject:"}),s.jsx("p",{className:"text-text-primary mt-1",children:n.template.subject})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-text-secondary",children:"Description:"}),s.jsx("p",{className:"text-text-primary mt-1 whitespace-pre-line",children:n.template.description})]}),s.jsxs("div",{className:"flex items-center space-x-4 text-text-tertiary",children:[s.jsxs("span",{children:["Priority: ",n.template.priority]}),s.jsxs("span",{children:["Duration: ",n.template.duration_minutes," minutes"]})]})]})]}),s.jsxs("div",{className:"p-4 border border-border rounded-lg bg-blue-50",children:[s.jsxs("h4",{className:"font-medium text-blue-900 mb-2 flex items-center",children:[s.jsx(G,{name:"Info",size:16,className:"mr-2"}),"Template Variables"]}),s.jsxs("div",{className:"text-xs text-blue-800 space-y-1",children:[s.jsxs("p",{children:[s.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"{contact_name}"})," - Contact's full name"]}),s.jsxs("p",{children:[s.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"{company_name}"})," - Company name"]}),s.jsxs("p",{children:[s.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"{user_name}"})," - Your name"]}),s.jsxs("p",{children:[s.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"{today}"})," - Today's date"]}),s.jsxs("p",{children:[s.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"{follow_up_date}"})," - One week from today"]})]})]})]})]}),s.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-border bg-surface",children:[s.jsx("button",{onClick:t,className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors duration-150",children:"Cancel"}),s.jsx("button",{onClick:()=>n&&f(n),disabled:!n,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:"Use Template"})]})]})}):null},JRe=({activities:e,selectedActivities:t,onActivitySelection:r,onEdit:n,onDelete:a,onSelectAll:i})=>{const{hasAnyPermission:o}=Pt(),c=f=>{switch(f){case"email":return"Mail";case"call":return"Phone";case"meeting":return"Calendar";case"deal_update":return"TrendingUp";case"task":return"CheckSquare";case"note":return"FileText";default:return"Activity"}},l=f=>{switch(f){case"email":return"text-blue-600 bg-blue-50";case"call":return"text-green-600 bg-green-50";case"meeting":return"text-purple-600 bg-purple-50";case"deal_update":return"text-orange-600 bg-orange-50";case"task":return"text-indigo-600 bg-indigo-50";case"note":return"text-gray-600 bg-gray-50";default:return"text-gray-600 bg-gray-50"}},u=f=>{const h=new Date(f),m=new Date,x=m-h,p=Math.floor(x/(1e3*60*60)),g=Math.floor(p/24);return p<1?"Just now":p<24?`${p}h ago`:g<7?`${g}d ago`:h.toLocaleDateString("en-US",{month:"short",day:"numeric",year:h.getFullYear()!==m.getFullYear()?"numeric":void 0})},d=(f,h=100)=>f?f.length>h?f.substring(0,h)+"...":f:"";return s.jsx("div",{className:"bg-white rounded-lg border border-border shadow-sm overflow-hidden",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-border",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left w-10",children:s.jsx("input",{type:"checkbox",checked:t.size===e.length&&e.length>0,onChange:i,className:"rounded border-border text-primary focus:ring-primary"})}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider w-16",children:"Type"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider",children:"Subject"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider",children:"Contact"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider",children:"Company"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider",children:"Date"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider",children:"Owner"}),s.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-text-secondary uppercase tracking-wider w-24",children:"Actions"})]})}),s.jsx("tbody",{className:"divide-y divide-border",children:e.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:"8",className:"px-4 py-12 text-center",children:s.jsxs("div",{className:"flex flex-col items-center justify-center",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:s.jsx(G,{name:"Activity",size:32,className:"text-gray-400"})}),s.jsx("p",{className:"text-text-secondary text-sm",children:"No activities found"})]})})}):e.map(f=>{var h,m;return s.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[s.jsx("td",{className:"px-4 py-4",children:s.jsx("input",{type:"checkbox",checked:t.has(f.id),onChange:x=>r(f.id,x.target.checked),className:"rounded border-border text-primary focus:ring-primary"})}),s.jsx("td",{className:"px-4 py-4",children:s.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${l(f.type)}`,children:s.jsx(G,{name:c(f.type),size:16})})}),s.jsx("td",{className:"px-4 py-4",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm font-medium text-text-primary line-clamp-1",children:f.title||"Untitled"}),f.description&&s.jsx("span",{className:"text-xs text-text-tertiary line-clamp-1 mt-1",children:d(f.description,80)})]})}),s.jsx("td",{className:"px-4 py-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[f.contactAvatar?s.jsx("img",{src:f.contactAvatar,alt:f.contact,className:"w-6 h-6 rounded-full"}):s.jsx("div",{className:"w-6 h-6 rounded-full bg-primary-100 flex items-center justify-center",children:s.jsx("span",{className:"text-xs font-medium text-primary",children:((h=f.contact)==null?void 0:h.charAt(0))||"N"})}),s.jsx("span",{className:"text-sm text-text-secondary truncate max-w-[150px]",children:f.contact||"N/A"})]})}),s.jsx("td",{className:"px-4 py-4",children:s.jsx("span",{className:"text-sm text-text-secondary truncate block max-w-[150px]",children:f.company||"N/A"})}),s.jsx("td",{className:"px-4 py-4",children:s.jsxs("div",{className:"flex items-center space-x-1 text-sm text-text-tertiary",children:[s.jsx(G,{name:"Clock",size:14}),s.jsx("span",{children:u(f.timestamp)})]})}),s.jsx("td",{className:"px-4 py-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[f.avatar?s.jsx("img",{src:f.avatar,alt:f.user,className:"w-6 h-6 rounded-full"}):s.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center",children:s.jsx("span",{className:"text-xs font-medium text-gray-600",children:((m=f.user)==null?void 0:m.charAt(0))||"U"})}),s.jsx("span",{className:"text-sm text-text-secondary truncate max-w-[100px]",children:f.user||"System"})]})}),s.jsx("td",{className:"px-4 py-4",children:s.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[o(["activities.edit_all","activities.edit_own"])&&s.jsx("button",{onClick:()=>n(f),className:"p-1.5 text-text-tertiary hover:text-primary hover:bg-primary-50 rounded transition-colors duration-150",title:"Edit",children:s.jsx(G,{name:"Edit2",size:16})}),o(["activities.delete_all","activities.delete_own"])&&s.jsx("button",{onClick:()=>a(f.id),className:"p-1.5 text-text-tertiary hover:text-error hover:bg-error-50 rounded transition-colors duration-150",title:"Delete",children:s.jsx(G,{name:"Trash2",size:16})})]})})]},f.id)})})]})})})},QRe=()=>{const{user:e,hasAnyPermission:t}=Pt(),[r,n]=R.useState([]),[a,i]=R.useState(!0),[o,c]=R.useState(""),[l,u]=R.useState({activityType:"all",dateRange:"all",teamMember:"all",channel:"all"}),[d,f]=R.useState(""),[h,m]=R.useState(!1),[x,p]=R.useState(!1),[g,v]=R.useState(!0),[y,b]=R.useState(new Set),[_,w]=R.useState(!1),[j,N]=R.useState("timeline"),[D,S]=R.useState("auto"),[T,A]=R.useState(!1),[E,M]=R.useState(new Date),[P,X]=R.useState(null),[q,B]=R.useState(null),O=R.useCallback(async()=>{if(e){console.log("Starting to load activities...");try{i(!0),c("");const Q=await Qa.getUserActivities();console.log("Activities loaded from service:",Q),console.log("Number of activities:",Q==null?void 0:Q.length),Q&&Q.length>0&&console.log("First activity sample:",Q[0]),n(Q),M(new Date)}catch(Q){console.error("Error loading activities:",Q),c("Failed to load activities. Please try again.")}finally{i(!1)}}},[e]);R.useEffect(()=>{O()},[O]),R.useEffect(()=>{if(!T)return;const Q=setInterval(()=>{O()},3e4);return()=>clearInterval(Q)},[T,O]);const F=Q=>{n(ne=>[Q,...ne])},I=async Q=>{try{const ne=await Qa.getActivityById(Q.id);B(ne),m(!0)}catch(ne){console.error("Error fetching activity for editing:",ne),B(Q),m(!0)}},L=Q=>{n(ne=>ne.map(pe=>pe.id===Q.id?Q:pe))},C=async Q=>{if(window.confirm("Are you sure you want to delete this activity? This action cannot be undone."))try{await Qa.deleteActivity(Q),n(ne=>ne.filter(pe=>pe.id!==Q)),b(ne=>{const pe=new Set(ne);return pe.delete(Q),w(pe.size>0),pe})}catch(ne){console.error("Error deleting activity:",ne),c("Failed to delete activity. Please try again.")}},k=async(Q,ne)=>{try{switch(Q){case"delete":if(!window.confirm(`Are you sure you want to delete ${ne.length} activities? This action cannot be undone.`))return;await Promise.all(ne.map(te=>Qa.deleteActivity(te))),n(te=>te.filter(K=>!ne.includes(K.id)));break;case"export":const W=r.filter(te=>ne.includes(te.id)).map(te=>{var K,H;return{id:te.id,timestamp:te.created_at,type:te.type,subject:te.subject,description:te.description,contact:te.contact?`${te.contact.first_name} ${te.contact.last_name}`:"N/A",company:((H=(K=te.contact)==null?void 0:K.company)==null?void 0:H.name)||"N/A",user:te.user?`${te.user.first_name} ${te.user.last_name}`:"N/A",duration_minutes:te.duration_minutes||null,scheduled_at:te.scheduled_at||null}}),re=new Blob([JSON.stringify(W,null,2)],{type:"application/json"}),U=URL.createObjectURL(re),se=document.createElement("a");se.href=U,se.download=`selected_activities_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(se),se.click(),document.body.removeChild(se),URL.revokeObjectURL(U);break;default:break}b(new Set),w(!1)}catch(pe){console.error("Bulk action failed:",pe),c("Failed to perform bulk action. Please try again.")}},z=(Q,ne)=>{b(pe=>{const W=new Set(pe);return ne?W.add(Q):W.delete(Q),w(W.size>0),W})},V=()=>{y.size===ce.length?(b(new Set),w(!1)):(b(new Set(ce.map(Q=>Q.id))),w(!0))},Z=R.useMemo(()=>r.map(Q=>{var ne,pe,W,re,U,se,te,K,H,oe,J,le;return{id:Q.id,type:Q.type,channel:Q.channel||"system",title:Q.subject,description:Q.description,contact_id:Q.contact_id,contact:Q.contact?`${Q.contact.first_name} ${Q.contact.last_name}`:"N/A",company:((pe=(ne=Q.contact)==null?void 0:ne.company)==null?void 0:pe.name)||"N/A",timestamp:new Date(Q.created_at),user:Q.user?`${Q.user.first_name} ${Q.user.last_name}`:"System",avatar:((W=Q.user)==null?void 0:W.avatar_url)||null,contactAvatar:((re=Q.contact)==null?void 0:re.avatar_url)||null,status:Q.status,priority:Q.priority,dealValue:Q.deal?`${(U=Q.deal.value)==null?void 0:U.toLocaleString()}`:null,attachments:Q.attachments||[],duration:Q.duration_minutes?`${Q.duration_minutes} min`:null,previousStage:(se=Q.metadata)==null?void 0:se.previous_stage,currentStage:(te=Q.metadata)==null?void 0:te.current_stage,probability:(K=Q.metadata)==null?void 0:K.probability,meetingType:(H=Q.metadata)==null?void 0:H.meeting_type,location:(oe=Q.metadata)==null?void 0:oe.location,attendees:(J=Q.metadata)==null?void 0:J.attendees,callType:(le=Q.metadata)==null?void 0:le.call_type}}),[r]),ce=R.useMemo(()=>(console.log("Filtering activities with:",{selectedFilters:l,totalActivities:Z.length}),Z.filter(Q=>{var te,K,H,oe;const ne=l.activityType==="all"||Q.type===l.activityType,pe=l.channel==="all"||Q.channel===l.channel,W=l.teamMember==="all"||Q.contact_id===l.teamMember;l.teamMember!=="all"&&console.log("Activity contact check:",{activityId:Q.id,activitySubject:Q.subject||Q.title,activityContactId:Q.contact_id,selectedContactId:l.teamMember,matchesContact:W});const re=d.toLowerCase(),U=d===""||((te=Q.title)==null?void 0:te.toLowerCase().includes(re))||((K=Q.description)==null?void 0:K.toLowerCase().includes(re))||((H=Q.contact)==null?void 0:H.toLowerCase().includes(re))||((oe=Q.company)==null?void 0:oe.toLowerCase().includes(re));let se=!0;if(l.dateRange!=="all"){const J=new Date,le=new Date(Q.timestamp);switch(l.dateRange){case"today":se=le.toDateString()===J.toDateString();break;case"week":const he=new Date(J.getTime()-7*24*60*60*1e3);se=le>=he;break;case"month":const ee=new Date(J.getTime()-30*24*60*60*1e3);se=le>=ee;break}}return ne&&pe&&W&&U&&se})),[Z,l,d]),ie=()=>{const Q=ce.map(re=>({timestamp:re.timestamp.toISOString(),type:re.type,title:re.title,contact:re.contact,company:re.company,user:re.user,description:re.description})),ne=new Blob([JSON.stringify(Q,null,2)],{type:"application/json"}),pe=URL.createObjectURL(ne),W=document.createElement("a");W.href=pe,W.download=`activity_timeline_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL(pe)};return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(Ta,{}),s.jsx("main",{className:"pt-16",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[s.jsx(Ki,{}),s.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-8",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-text-primary mb-2",children:"Activity Timeline"}),s.jsx("p",{className:"text-text-secondary",children:"Unified view of all customer interactions across communication channels"})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-3 sm:space-y-0 sm:space-x-4 mt-4 lg:mt-0",children:[l.teamMember!=="all"&&s.jsxs("div",{className:"flex items-center bg-surface border border-border rounded-lg p-1",children:[s.jsxs("button",{onClick:()=>S("timeline"),className:`px-3 py-1.5 text-sm rounded-md transition-all duration-150 flex items-center space-x-1 ${D==="timeline"?"bg-primary text-white":"text-text-secondary hover:text-text-primary"}`,children:[s.jsx(G,{name:"GitBranch",size:16}),s.jsx("span",{children:"Timeline"})]}),s.jsxs("button",{onClick:()=>S("list"),className:`px-3 py-1.5 text-sm rounded-md transition-all duration-150 flex items-center space-x-1 ${D==="list"?"bg-primary text-white":"text-text-secondary hover:text-text-primary"}`,children:[s.jsx(G,{name:"List",size:16}),s.jsx("span",{children:"List"})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("button",{onClick:()=>p(!0),className:"flex items-center space-x-2 px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-out",children:[s.jsx(G,{name:"FileTemplate",size:16}),s.jsx("span",{children:"Templates"})]}),s.jsxs("button",{onClick:ie,className:"flex items-center space-x-2 px-4 py-2 border border-border rounded-lg text-text-secondary hover:text-text-primary hover:bg-surface-hover transition-all duration-150 ease-out",children:[s.jsx(G,{name:"Download",size:16}),s.jsx("span",{children:"Export"})]}),t(["activities.create_all","activities.create_own"])&&s.jsxs("button",{onClick:()=>m(!0),className:"btn-primary flex items-center space-x-2",children:[s.jsx(G,{name:"Plus",size:16}),s.jsx("span",{children:"Add Activity"})]})]})]})]}),o&&s.jsxs("div",{className:"bg-error-50 border border-error-200 text-error p-4 rounded-lg mb-6 flex items-center space-x-2",children:[s.jsx(G,{name:"AlertCircle",size:20}),s.jsx("span",{children:o})]}),s.jsx("div",{className:"mb-6",children:s.jsxs("div",{className:"relative max-w-md",children:[s.jsx(G,{name:"Search",size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary"}),s.jsx("input",{type:"text",placeholder:"Search activities, contacts, or companies...",value:d,onChange:Q=>f(Q.target.value),className:"input-field pl-10"})]})}),s.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[s.jsx("div",{className:`lg:w-80 ${g?"block":"hidden lg:block"}`,children:s.jsxs("div",{className:"card sticky top-24 max-h-[calc(100vh-8rem)] flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 pb-4 border-b border-border",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Filters"}),s.jsx("button",{onClick:()=>v(!g),className:"lg:hidden p-1 text-text-secondary hover:text-text-primary",children:s.jsx(G,{name:"X",size:20})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-6 pt-4 scrollbar-thin scrollbar-thumb-border scrollbar-track-transparent",children:s.jsx(GRe,{selectedFilters:l,onFiltersChange:u})})]})}),s.jsx("button",{onClick:()=>v(!g),className:"lg:hidden fixed bottom-6 right-6 w-14 h-14 bg-primary text-white rounded-full shadow-lg flex items-center justify-center z-50",children:s.jsx(G,{name:"Filter",size:20})}),s.jsxs("div",{className:"flex-1",children:[_&&s.jsx(KRe,{selectedCount:y.size,selectedIds:Array.from(y),onBulkAction:k,onClearSelection:()=>{b(new Set),w(!1)}}),s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"text-sm text-text-secondary",children:["Showing ",ce.length," of ",r.length," activities",l.teamMember==="all"&&s.jsx("span",{className:"ml-2 text-xs text-text-tertiary",children:" List view (all contacts)"}),l.teamMember!=="all"&&D==="timeline"&&s.jsx("span",{className:"ml-2 text-xs text-text-tertiary",children:" Timeline view"}),l.teamMember!=="all"&&D==="list"&&s.jsx("span",{className:"ml-2 text-xs text-text-tertiary",children:" List view"})]}),ce.length>0&&s.jsxs("label",{className:"flex items-center space-x-2 text-sm text-text-secondary",children:[s.jsx("input",{type:"checkbox",checked:y.size===ce.length,onChange:V,className:"rounded border-border text-primary focus:ring-primary"}),s.jsx("span",{children:"Select all"})]})]}),(l.activityType!=="all"||l.dateRange!=="all"||l.channel!=="all"||d)&&s.jsx("button",{onClick:()=>{u({activityType:"all",dateRange:"all",teamMember:"all",channel:"all"}),f("")},className:"text-sm text-primary hover:text-primary-700 transition-colors duration-150 ease-out",children:"Clear all filters"})]}),j==="insights"?s.jsx(XRe,{activities:ce}):s.jsx(s.Fragment,{children:a?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),s.jsx("p",{className:"text-text-secondary",children:"Loading activities..."})]}):s.jsx(s.Fragment,{children:ce.length>0?l.teamMember==="all"||D==="list"?s.jsx(JRe,{activities:ce,selectedActivities:y,onActivitySelection:z,onEdit:I,onDelete:C,onSelectAll:V}):s.jsx("div",{className:"space-y-6",children:ce.map((Q,ne)=>s.jsx(VRe,{activity:Q,isLast:ne===ce.length-1,isSelected:y.has(Q.id),onSelectionChange:pe=>z(Q.id,pe),showCheckbox:!0,onEdit:I,onDelete:C},Q.id))}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"w-16 h-16 bg-primary-50 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(G,{name:"Clock",size:32,className:"text-primary"})}),s.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"No activities found"}),s.jsx("p",{className:"text-text-secondary mb-4",children:"Try adjusting your filters or search terms to find activities."}),s.jsx("button",{onClick:()=>m(!0),className:"btn-primary",children:"Add First Activity"})]})})})]})]})]})}),h&&s.jsx(qL,{isOpen:h,onClose:()=>{m(!1),X(null),B(null)},onActivityAdded:F,onActivityUpdated:L,prefilledData:P?P.template:{},templateData:P,editingActivity:q}),x&&s.jsx(ZRe,{isOpen:x,onClose:()=>p(!1),onTemplateSelected:Q=>{X(Q),p(!1),m(!0)}})]})},eMe=({activeSection:e,onSectionChange:t})=>{const{user:r,hasPermission:n}=Pt(),i=[{id:"user-management",label:"User Management",icon:"Users",description:"Manage users, roles and status",requiredPermission:"settings.user_management"},{id:"permissions",label:"Permissions",icon:"Shield",description:"Role-based access control",requiredPermission:"settings.permissions"},{id:"integrations",label:"Integrations",icon:"Plug",description:"API connections and services",requiredPermission:"settings.integrations"},{id:"custom-fields",label:"Custom Fields",icon:"ListPlus",description:"Field creation and configuration",requiredPermission:"settings.custom_fields"},{id:"email-templates",label:"Email Templates",icon:"Mail",description:"Template editor and management",requiredPermission:"settings.email_templates"},{id:"system-config",label:"System Configuration",icon:"Settings",description:"General system settings",requiredPermission:"settings.system_config"}].filter(o=>o.requiredPermission?n(o.requiredPermission):!0);return s.jsx("nav",{className:"w-80 bg-surface border-r border-border h-full",children:s.jsxs("div",{className:"p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-text-primary mb-6",children:"Settings Categories"}),s.jsx("ul",{className:"space-y-2",children:i==null?void 0:i.map(o=>s.jsx("li",{children:s.jsx("button",{onClick:()=>t==null?void 0:t(o==null?void 0:o.id),className:`w-full text-left p-4 rounded-lg transition-all duration-150 ease-smooth group ${e===(o==null?void 0:o.id)?"bg-primary-50 border border-primary-100 text-primary":"text-text-secondary hover:text-primary"}`,children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(G,{name:o==null?void 0:o.icon,size:20,className:`mt-0.5 ${e===(o==null?void 0:o.id)?"text-primary":"text-text-tertiary group-hover:text-primary"}`}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:`font-medium text-sm ${e===(o==null?void 0:o.id)?"text-primary":""}`,children:o==null?void 0:o.label}),s.jsx("div",{className:"text-xs text-text-tertiary mt-1 leading-tight",children:o==null?void 0:o.description})]})]})})},o==null?void 0:o.id))})]})})},dr={async getAllUsers(){const{data:e,error:t}=await be.get("/api/v1/users");if(t)throw t;return e||[]},async getCurrentUserProfile(){const{data:e,error:t}=await be.get("/api/v1/users/me");if(t)throw t;return e},async updateCurrentUserProfile(e){const{data:t,error:r}=await be.put("/api/v1/users/me",e);if(r)throw r;return t},async getUserById(e){const{data:t,error:r}=await be.get(`/api/v1/users/${e}`);if(r){if(r.status===404)return null;throw r}return t},async updateUser(e,t){const{data:r,error:n}=await be.put(`/api/v1/users/${e}`,t);if(n)throw n;return r},async getUserStats(){const{data:e,error:t}=await be.get("/api/v1/users/stats");return t?{total:0,active:0,roles:{}}:e},async searchUsers(e){const{data:t,error:r}=await be.get(`/api/v1/users?search=${encodeURIComponent(e)}`);if(r)throw r;return t||[]},async getUsersByRole(e){const{data:t,error:r}=await be.get(`/api/v1/users?role=${encodeURIComponent(e)}`);if(r)throw r;return t||[]},async filterUsers(e){const t=new URLSearchParams;e.status&&e.status!=="all"&&t.append("status",e.status),e.roles&&e.roles.length>0&&t.append("roles",e.roles.join(","));const r=t.toString(),n=r?`/api/v1/users?${r}`:"/api/v1/users",{data:a,error:i}=await be.get(n);if(i)throw i;return a||[]},getUserRoles(){return[{value:"admin",label:"Administrator",description:"Full system access"},{value:"sales_manager",label:"Sales Manager",description:"Team management access"},{value:"sales_rep",label:"Sales Representative",description:"Standard user access"},{value:"user",label:"User",description:"Basic user access"}]},async inviteUser(e){const{data:t,error:r}=await be.post("/api/v1/users/invite",e);if(r)throw r;return t},async changeUserRole(e,t){return this.updateUser(e,{role:t})},async deactivateUser(e){return this.updateUser(e,{is_active:!1})},async reactivateUser(e){return this.updateUser(e,{is_active:!0})},async bulkUpdateUsers(e,t){const r=e.map(i=>this.updateUser(i,t)),n=await Promise.allSettled(r),a=n.filter(i=>i.status==="rejected");if(a.length>0)throw console.error("Some updates failed:",a),new Error(`Failed to update ${a.length} user(s)`);return n.map(i=>i.value)}},K4=()=>{try{const{user:e}=Pt();console.log("UserManagement - currentUser:",e);const[t,r]=R.useState([]),[n,a]=R.useState(!0),[i,o]=R.useState(""),[c,l]=R.useState(""),[u,d]=R.useState([]),[f,h]=R.useState(!1),[m,x]=R.useState({email:"",firstName:"",lastName:"",role:"sales_rep",message:""}),[p,g]=R.useState(""),[v,y]=R.useState("all"),[b,_]=R.useState("all"),[w,j]=R.useState(1),[N,D]=R.useState(10),S=dr==null?void 0:dr.getUserRoles(),T=async()=>{var k;try{a(!0),o("");let z=[];if(p)z=await(dr==null?void 0:dr.searchUsers(p));else{const Z={};v!=="all"&&(Z.status=v),b!=="all"&&(Z.roles=[b]),((k=Object.keys(Z))==null?void 0:k.length)>0?z=await(dr==null?void 0:dr.filterUsers(Z)):z=await(dr==null?void 0:dr.getAllUsers())}const V=z==null?void 0:z.map(Z=>{var ce,ie,Q;return{id:Z==null?void 0:Z.id,name:(Z==null?void 0:Z.full_name)||((ce=`${Z==null?void 0:Z.first_name} ${Z==null?void 0:Z.last_name}`)==null?void 0:ce.trim()),email:Z==null?void 0:Z.email,role:((ie=S==null?void 0:S.find(ne=>(ne==null?void 0:ne.value)===(Z==null?void 0:Z.role)))==null?void 0:ie.label)||(Z==null?void 0:Z.role),status:Z!=null&&Z.is_active?"Active":"Inactive",lastLogin:Z!=null&&Z.updated_at?(Q=new Date(Z==null?void 0:Z.updated_at))==null?void 0:Q.toLocaleString():"Never",avatar:Z==null?void 0:Z.avatar_url,rawData:Z}});r(V)}catch(z){console.error("Error loading users:",z),o("Failed to load users. Please try again.")}finally{a(!1)}};R.useEffect(()=>{e&&["admin","sales_manager"].includes(e==null?void 0:e.role)&&T()},[e,p,v,b]),R.useEffect(()=>{j(1)},[p,v,b,N]),R.useEffect(()=>{if(i||c){const k=setTimeout(()=>{o(""),l("")},5e3);return()=>clearTimeout(k)}},[i,c]);const A=k=>{d(z=>z!=null&&z.includes(k)?z==null?void 0:z.filter(V=>V!==k):[...z,k])},E=()=>{d((u==null?void 0:u.length)===(t==null?void 0:t.length)?[]:t==null?void 0:t.map(k=>k==null?void 0:k.id))},M=async k=>{var z;try{o("");let V=u;if(k==="deactivate"){const ce=((z=t==null?void 0:t.filter(ie=>{var Q;return((Q=ie==null?void 0:ie.rawData)==null?void 0:Q.role)==="admin"||(ie==null?void 0:ie.id)===(e==null?void 0:e.id)}))==null?void 0:z.map(ie=>ie==null?void 0:ie.id))||[];if(V=u.filter(ie=>!ce.includes(ie)),V.length===0){o("Cannot deactivate administrator accounts or your own account");return}V.length<u.length&&l(`Deactivated ${V.length} user(s). Administrator accounts and your account were skipped.`)}let Z={};switch(k){case"activate":Z={is_active:!0};break;case"deactivate":Z={is_active:!1};break}await(dr==null?void 0:dr.bulkUpdateUsers(V,Z)),(k==="activate"||V.length===u.length)&&l(`Successfully ${k}d ${V.length} user(s)`),d([]),T()}catch(V){console.error(`Error ${k}ing users:`,V),o(`Failed to ${k} users. Please try again.`)}},P=async k=>{k==null||k.preventDefault();try{o("");const z={email:m.email,first_name:m.firstName,last_name:m.lastName,role:m.role};await(dr==null?void 0:dr.inviteUser(z)),l("User invitation sent successfully!"),h(!1),x({email:"",firstName:"",lastName:"",role:"sales_rep",message:""}),T()}catch(z){console.error("Error inviting user:",z),o("Failed to send invitation. Please try again.")}},X=async(k,z)=>{try{switch(o(""),k){case"activate":await(dr==null?void 0:dr.reactivateUser(z)),l("User activated successfully");break;case"deactivate":await(dr==null?void 0:dr.deactivateUser(z)),l("User deactivated successfully");break}T()}catch(V){console.error(`Error ${k}ing user:`,V),o(`Failed to ${k} user. Please try again.`)}},q=Math.ceil((t==null?void 0:t.length)/N),B=(w-1)*N,O=B+N,F=t==null?void 0:t.slice(B,O),I=k=>{j(k)},L=k=>{var z;D(Number((z=k==null?void 0:k.target)==null?void 0:z.value))},C=k=>{const z={Active:"bg-success-50 text-success-600 border-success-100",Inactive:"bg-error-50 text-error-600 border-error-100",Pending:"bg-warning-50 text-warning-600 border-warning-100"};return s.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded border ${(z==null?void 0:z[k])||"bg-gray-50 text-gray-600 border-gray-100"}`,children:k})};return n&&!e?s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"text-center py-12",children:[s.jsx(G,{name:"Loader",size:48,className:"text-text-tertiary mx-auto mb-4 animate-spin"}),s.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"Loading..."}),s.jsx("p",{className:"text-text-secondary",children:"Please wait while we load your profile."})]})}):!e||(e==null?void 0:e.role)!=="admin"?s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"text-center py-12",children:[s.jsx(G,{name:"Lock",size:48,className:"text-text-tertiary mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"Access Restricted"}),s.jsx("p",{className:"text-text-secondary",children:"Only administrators can access user management."})]})}):s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"User Management"}),s.jsx("p",{className:"text-text-secondary mt-1",children:"Manage users, roles, and permissions"})]})}),c&&s.jsxs("div",{className:"bg-success-50 border border-success-200 text-success p-4 rounded-lg flex items-center space-x-2",children:[s.jsx(G,{name:"CheckCircle",size:20}),s.jsx("span",{children:c}),s.jsx("button",{onClick:()=>l(""),className:"ml-auto text-success hover:text-success-600",children:s.jsx(G,{name:"X",size:16})})]}),i&&s.jsxs("div",{className:"bg-error-50 border border-error-200 text-error p-4 rounded-lg flex items-center space-x-2",children:[s.jsx(G,{name:"AlertCircle",size:20}),s.jsx("span",{children:i}),s.jsx("button",{onClick:()=>o(""),className:"ml-auto text-error hover:text-error-600",children:s.jsx(G,{name:"X",size:16})})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[s.jsxs("div",{className:"relative",children:[s.jsx(G,{name:"Search",size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary"}),s.jsx("input",{type:"text",placeholder:"Search users...",value:p,onChange:k=>{var z;return g((z=k==null?void 0:k.target)==null?void 0:z.value)},className:"pl-10 pr-4 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary w-64"})]}),s.jsxs("select",{value:v,onChange:k=>{var z;return y((z=k==null?void 0:k.target)==null?void 0:z.value)},className:"px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:[s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"active",children:"Active"}),s.jsx("option",{value:"inactive",children:"Inactive"})]}),s.jsxs("select",{value:b,onChange:k=>{var z;return _((z=k==null?void 0:k.target)==null?void 0:z.value)},className:"px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:[s.jsx("option",{value:"all",children:"All Roles"}),S==null?void 0:S.map(k=>s.jsx("option",{value:k==null?void 0:k.value,children:k==null?void 0:k.label},k==null?void 0:k.value))]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-sm text-text-secondary whitespace-nowrap",children:"Items per page:"}),s.jsxs("select",{value:N,onChange:L,className:"px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:[s.jsx("option",{value:5,children:"5"}),s.jsx("option",{value:10,children:"10"}),s.jsx("option",{value:25,children:"25"}),s.jsx("option",{value:50,children:"50"}),s.jsx("option",{value:100,children:"100"})]})]})]}),(u==null?void 0:u.length)>0&&s.jsx("div",{className:"bg-primary-50 border border-primary-100 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"text-sm text-primary font-medium",children:[u==null?void 0:u.length," user",(u==null?void 0:u.length)!==1?"s":""," selected"]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>M("activate"),className:"px-3 py-1 text-xs bg-success text-white rounded hover:bg-success-600 transition-colors duration-150",children:"Activate"}),s.jsx("button",{onClick:()=>M("deactivate"),className:"px-3 py-1 text-xs bg-error text-white rounded hover:bg-error-600 transition-colors duration-150",children:"Deactivate"})]})]})}),n?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),s.jsx("span",{className:"text-text-secondary",children:"Loading users..."})]})}):s.jsxs("div",{className:"bg-surface rounded-lg border border-border overflow-hidden",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-background border-b border-border",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-left py-3 px-4",children:s.jsx("input",{type:"checkbox",checked:(u==null?void 0:u.length)===(t==null?void 0:t.length)&&(t==null?void 0:t.length)>0,onChange:E,className:"rounded border-border text-primary focus:ring-primary"})}),s.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-primary",children:"User"}),s.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-primary",children:"Role"}),s.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-primary",children:"Status"}),s.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-primary",children:"Last Login"}),s.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-primary",children:"Actions"})]})}),s.jsx("tbody",{children:(F==null?void 0:F.length)===0?s.jsx("tr",{children:s.jsxs("td",{colSpan:"6",className:"py-8 text-center",children:[s.jsx(G,{name:"Users",size:48,className:"text-text-tertiary mx-auto mb-4"}),s.jsx("p",{className:"text-text-secondary",children:"No users found"})]})}):F==null?void 0:F.map(k=>{var V,Z;const z=((V=k==null?void 0:k.rawData)==null?void 0:V.role)==="admin"||(k==null?void 0:k.id)===(e==null?void 0:e.id);return s.jsxs("tr",{className:"border-b border-border hover:bg-surface-hover",children:[s.jsx("td",{className:"py-3 px-4",children:s.jsx("input",{type:"checkbox",checked:u==null?void 0:u.includes(k==null?void 0:k.id),onChange:()=>A(k==null?void 0:k.id),disabled:z,className:"rounded border-border text-primary focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed",title:z?"Protected account cannot be bulk-modified":""})}),s.jsx("td",{className:"py-3 px-4",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center",children:k!=null&&k.avatar?s.jsx("img",{src:k==null?void 0:k.avatar,alt:k==null?void 0:k.name,className:"w-8 h-8 rounded-full"}):s.jsx(G,{name:"User",size:16,className:"text-primary"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-text-primary",children:(k==null?void 0:k.name)||"Unnamed User"}),s.jsx("div",{className:"text-sm text-text-secondary",children:k==null?void 0:k.email})]})]})}),s.jsx("td",{className:"py-3 px-4 text-sm text-text-secondary",children:k==null?void 0:k.role}),s.jsx("td",{className:"py-3 px-4",children:C(k==null?void 0:k.status)}),s.jsx("td",{className:"py-3 px-4 text-sm text-text-secondary",children:k==null?void 0:k.lastLogin}),s.jsx("td",{className:"py-3 px-4",children:s.jsx("div",{className:"flex space-x-2",children:((Z=k==null?void 0:k.rawData)==null?void 0:Z.role)==="admin"||(k==null?void 0:k.id)===(e==null?void 0:e.id)?s.jsx("span",{className:"text-xs text-text-tertiary px-2 py-1",children:(k==null?void 0:k.id)===(e==null?void 0:e.id)?"Current User":"Protected"}):s.jsx(s.Fragment,{children:(k==null?void 0:k.status)==="Active"?s.jsx("button",{onClick:()=>X("deactivate",k==null?void 0:k.id),className:"p-1 text-text-secondary hover:text-error transition-colors duration-150",title:"Deactivate User",children:s.jsx(G,{name:"UserX",size:16})}):s.jsx("button",{onClick:()=>X("activate",k==null?void 0:k.id),className:"p-1 text-text-secondary hover:text-success transition-colors duration-150",title:"Activate User",children:s.jsx(G,{name:"UserCheck",size:16})})})})})]},k==null?void 0:k.id)})})]})}),(t==null?void 0:t.length)>0&&s.jsx(dx,{currentPage:w,totalPages:q,totalItems:t==null?void 0:t.length,itemsPerPage:N,onPageChange:I,showInfo:!0})]}),f&&s.jsx("div",{className:"fixed inset-0 z-1200 overflow-y-auto",children:s.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:()=>h(!1)}),s.jsx("div",{className:"bg-surface rounded-lg shadow-xl max-w-md w-full relative z-1300",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Invite New User"}),s.jsx("button",{onClick:()=>h(!1),className:"text-text-secondary hover:text-text-primary transition-colors duration-150",children:s.jsx(G,{name:"X",size:20})})]}),s.jsxs("form",{onSubmit:P,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Email Address"}),s.jsx("input",{type:"email",value:m==null?void 0:m.email,onChange:k=>x(z=>{var V;return{...z,email:(V=k==null?void 0:k.target)==null?void 0:V.value}}),className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",placeholder:"user@company.com",required:!0})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"First Name"}),s.jsx("input",{type:"text",value:m==null?void 0:m.firstName,onChange:k=>x(z=>{var V;return{...z,firstName:(V=k==null?void 0:k.target)==null?void 0:V.value}}),className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",placeholder:"John"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Last Name"}),s.jsx("input",{type:"text",value:m==null?void 0:m.lastName,onChange:k=>x(z=>{var V;return{...z,lastName:(V=k==null?void 0:k.target)==null?void 0:V.value}}),className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",placeholder:"Doe"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Role"}),s.jsxs("select",{value:m==null?void 0:m.role,onChange:k=>x(z=>{var V;return{...z,role:(V=k==null?void 0:k.target)==null?void 0:V.value}}),className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",required:!0,children:[s.jsx("option",{value:"",children:"Select Role"}),S==null?void 0:S.map(k=>s.jsx("option",{value:k==null?void 0:k.value,children:k==null?void 0:k.label},k==null?void 0:k.value))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Welcome Message (Optional)"}),s.jsx("textarea",{value:m==null?void 0:m.message,onChange:k=>x(z=>{var V;return{...z,message:(V=k==null?void 0:k.target)==null?void 0:V.value}}),className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",rows:3,placeholder:"Welcome to our team..."})]}),s.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[s.jsx("button",{type:"button",onClick:()=>h(!1),className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors duration-150",children:"Cancel"}),s.jsx("button",{type:"submit",className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors duration-150 ease-smooth",children:"Send Invitation"})]})]})]})})]})})]})}catch(e){return console.error("Error in UserManagement component:",e),s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"text-center py-12",children:[s.jsx(G,{name:"AlertCircle",size:48,className:"text-error mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"Something went wrong"}),s.jsx("p",{className:"text-text-secondary",children:"Please refresh the page and try again."})]})})}},md={async getAllRoles(){const{data:e,error:t}=await be.get("/api/v1/roles");if(t)throw t;return e||[]},async getAllPermissions(){const{data:e,error:t}=await be.get("/api/v1/roles/permissions/all");if(t)throw t;return e||[]},async getRoleById(e){const{data:t,error:r}=await be.get(`/api/v1/roles/${e}`);if(r){if(r.status===404)return null;throw r}return t},async updateRolePermissions(e,t){const{data:r,error:n}=await be.put(`/api/v1/roles/${e}/permissions`,{role_id:e,permissions:t});if(n)throw n;return r},async getRolePermissions(e){const{data:t,error:r}=await be.get(`/api/v1/roles/by-name/${encodeURIComponent(e)}/permissions`);return r?{}:t||{}},async updateRolePermissionsByName(e,t){const r={role_name:e,permissions:t};console.log("Sending to backend:",r);const{data:n,error:a}=await be.put(`/api/v1/roles/by-name/${encodeURIComponent(e)}/permissions`,r);if(a)throw a;return n},async restoreDefaultPermissions(e){const{data:t,error:r}=await be.post(`/api/v1/roles/by-name/${encodeURIComponent(e)}/restore-defaults`);if(r)throw r;return t}},tMe=()=>{const{refreshPermissions:e}=Pt(),[t,r]=R.useState("Admin"),[n,a]=R.useState([]),[i,o]=R.useState(!0),[c,l]=R.useState(""),[u,d]=R.useState(""),f=[{category:"Dashboard & Analytics",items:[{name:"View Dashboard Statistics",key:"dashboard.view_stats"},{name:"Filter Dashboard Data",key:"dashboard.filter"},{name:"Drag & Drop Pipeline",key:"dashboard.pipeline_drag_drop"},{name:"View Pipeline",key:"dashboard.pipeline_view"},{name:"View Personal Analytics",key:"analytics.view_personal"},{name:"View Team Analytics",key:"analytics.view_team"},{name:"View Company Analytics",key:"analytics.view_company"},{name:"Export Analytics Reports",key:"analytics.export"}]},{category:"Deal Management",items:[{name:"View All Deals",key:"deals.view_all"},{name:"View Own Deals",key:"deals.view_own"},{name:"Create Deals",key:"deals.create"},{name:"Edit All Deals",key:"deals.edit_all"},{name:"Edit Own Deals",key:"deals.edit_own"},{name:"Delete All Deals",key:"deals.delete_all"},{name:"Delete Own Deals",key:"deals.delete_own"},{name:"Move Pipeline Stages",key:"deals.move_stages"},{name:"Export Deals",key:"deals.export"}]},{category:"Contact Management",items:[{name:"View All Contacts",key:"contacts.view_all"},{name:"View Own Contacts",key:"contacts.view_own"},{name:"Create Contacts",key:"contacts.create"},{name:"Edit All Contacts",key:"contacts.edit_all"},{name:"Edit Own Contacts",key:"contacts.edit_own"},{name:"Delete All Contacts",key:"contacts.delete_all"},{name:"Delete Own Contacts",key:"contacts.delete_own"},{name:"Import Contacts",key:"contacts.import"},{name:"Export Contacts",key:"contacts.export"}]},{category:"Company Management",items:[{name:"View All Companies",key:"companies.view_all"},{name:"View Own Companies",key:"companies.view_own"},{name:"Create Companies",key:"companies.create"},{name:"Edit All Companies",key:"companies.edit_all"},{name:"Edit Own Companies",key:"companies.edit_own"},{name:"Delete All Companies",key:"companies.delete_all"},{name:"Delete Own Companies",key:"companies.delete_own"},{name:"Import/Export Companies",key:"companies.import_export"}]},{category:"Activity Management",items:[{name:"View All Activities",key:"activities.view_all"},{name:"View Own Activities",key:"activities.view_own"},{name:"Create Activity for Any Contact",key:"activities.create_all"},{name:"Create Activity for Own Contacts",key:"activities.create_own"},{name:"Edit All Activities",key:"activities.edit_all"},{name:"Edit Own Activities",key:"activities.edit_own"},{name:"Delete All Activities",key:"activities.delete_all"},{name:"Delete Own Activities",key:"activities.delete_own"},{name:"Export Activities",key:"activities.export"}]},{category:"Campaign Management",items:[{name:"View All Campaigns",key:"campaigns.view_all"},{name:"View Own Campaigns",key:"campaigns.view_own"},{name:"Create Campaigns",key:"campaigns.create"},{name:"Edit All Campaigns",key:"campaigns.edit_all"},{name:"Edit Own Campaigns",key:"campaigns.edit_own"},{name:"Delete All Campaigns",key:"campaigns.delete_all"},{name:"Delete Own Campaigns",key:"campaigns.delete_own"},{name:"Execute Campaigns",key:"campaigns.execute"},{name:"Export Campaign Data",key:"campaigns.export"}]},{category:"Settings & Configuration",items:[{name:"User Management",key:"settings.user_management"},{name:"Manage Permissions",key:"settings.permissions"},{name:"Manage Integrations",key:"settings.integrations"},{name:"Manage Custom Fields",key:"settings.custom_fields"},{name:"Manage Email Templates",key:"settings.email_templates"},{name:"System Configuration",key:"settings.system_config"},{name:"View Own Profile",key:"settings.view_profile"},{name:"Edit Own Profile",key:"settings.edit_profile"}]}],[h,m]=R.useState({}),x=async()=>{try{o(!0),l("");const[_,w]=await Promise.all([md.getAllRoles(),md.getAllPermissions()]),j=_.filter(D=>D.name!=="sales_operations").map(D=>({name:D.display_name,userCount:0}));a(j);const N={};for(const D of _)try{const S=await md.getRolePermissions(D.name);N[D.display_name]=S}catch(S){console.warn(`Failed to load permissions for role ${D.name}:`,S),N[D.display_name]={}}m(N),j.length>0&&!t&&r(j[0].name)}catch(_){console.error("Error loading permissions data:",_),l("Failed to load permissions data. Please try again."),a([{name:"Admin",userCount:0},{name:"Sales Manager",userCount:0},{name:"Sales Rep",userCount:0},{name:"Sales Operations",userCount:0}])}finally{o(!1)}};R.useEffect(()=>{x()},[]);const p=_=>{m(w=>{var j;return{...w,[t]:{...w==null?void 0:w[t],[_]:!((j=w==null?void 0:w[t])!=null&&j[_])}}})},g=async()=>{try{l(""),d(""),console.log("Saving permission changes for:",t),console.log("Current permissions:",h[t]);const _=h[t]||{},w=await md.updateRolePermissionsByName(t,_);d(`Permissions updated successfully for ${t}! Users with this role will need to log out and log back in to see the changes.`),await x(),setTimeout(()=>d(""),5e3)}catch(_){console.error("Error saving permission changes:",_),l("Failed to save permission changes. Please try again."),setTimeout(()=>l(""),5e3)}},v=async()=>{if(confirm(`Are you sure you want to restore default permissions for ${t}? This will overwrite all custom changes.`))try{l(""),d(""),console.log("Restoring default permissions for:",t);const _=await md.restoreDefaultPermissions(t);d(`Default permissions restored for ${t}!`),await x(),setTimeout(()=>d(""),3e3)}catch(_){console.error("Error restoring default permissions:",_),l("Failed to restore default permissions. Please try again."),setTimeout(()=>l(""),5e3)}},y=async()=>{try{l(""),d(""),await e(),Be.success("Permissions refreshed successfully!"),d("Your permissions have been refreshed. The page will reload to apply changes."),setTimeout(()=>{window.location.reload()},1500)}catch(_){console.error("Error refreshing permissions:",_),l("Failed to refresh permissions. Please try again."),Be.error("Failed to refresh permissions. Please try again."),setTimeout(()=>l(""),5e3)}},b=_=>{var j,N;const w=(h==null?void 0:h[_])||{};return(N=(j=Object.values(w))==null?void 0:j.filter(Boolean))==null?void 0:N.length};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"Permissions"}),s.jsx("p",{className:"text-text-secondary mt-1",children:"Configure role-based access control"})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("button",{onClick:y,className:"bg-surface border border-border text-text-secondary px-4 py-2 rounded-lg hover:bg-surface-hover transition-colors duration-150 ease-smooth flex items-center space-x-2",title:"Refresh your current permissions",children:[s.jsx(G,{name:"RefreshCw",size:16}),s.jsx("span",{children:"Refresh Permissions"})]}),s.jsxs("button",{onClick:v,className:"bg-surface border border-border text-text-secondary px-4 py-2 rounded-lg hover:bg-surface-hover transition-colors duration-150 ease-smooth flex items-center space-x-2",children:[s.jsx(G,{name:"RotateCcw",size:16}),s.jsx("span",{children:"Restore to Default"})]}),s.jsxs("button",{onClick:g,className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors duration-150 ease-smooth flex items-center space-x-2",children:[s.jsx(G,{name:"Save",size:16}),s.jsx("span",{children:"Save Changes"})]})]})]}),s.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(G,{name:"Info",size:20,className:"text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"text-sm text-blue-800 dark:text-blue-200",children:[s.jsx("p",{className:"font-medium mb-1",children:"Important: Permission Changes Require Re-login"}),s.jsxs("p",{children:["After updating role permissions, users with that role must ",s.jsx("strong",{children:"log out and log back in"})," to see the new permissions take effect."]})]})]})}),u&&s.jsx("div",{className:"bg-success-50 border border-success-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(G,{name:"CheckCircle",size:20,className:"text-success-600"}),s.jsx("div",{className:"text-success-800",children:u})]})}),c&&s.jsx("div",{className:"bg-error-50 border border-error-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(G,{name:"AlertCircle",size:20,className:"text-error-600"}),s.jsx("div",{className:"text-error-800",children:c})]})}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[s.jsx("div",{className:"lg:col-span-4",children:s.jsxs("div",{className:"bg-surface rounded-lg border border-border p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Roles"}),s.jsx("div",{className:"space-y-2",children:n==null?void 0:n.map(_=>s.jsx("button",{onClick:()=>r(_==null?void 0:_.name),className:`w-full text-left p-3 rounded-lg transition-all duration-150 ease-smooth ${t===(_==null?void 0:_.name)?"bg-primary-50 border border-primary-100 text-primary":"text-text-secondary hover:text-text-primary hover:bg-surface-hover border border-transparent"}`,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:`font-medium text-sm ${t===(_==null?void 0:_.name)?"text-primary":"text-text-primary"}`,children:_==null?void 0:_.name}),s.jsxs("div",{className:"text-xs text-text-tertiary mt-1",children:[_==null?void 0:_.userCount," user",(_==null?void 0:_.userCount)!==1?"s":"","  ",b(_==null?void 0:_.name)," permissions"]})]}),t===(_==null?void 0:_.name)&&s.jsx(G,{name:"Check",size:16,className:"text-primary"})]})},_==null?void 0:_.name))})]})}),s.jsx("div",{className:"lg:col-span-8",children:s.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[s.jsxs("div",{className:"p-6 border-b border-border",children:[s.jsxs("h3",{className:"text-lg font-semibold text-text-primary",children:["Permissions for ",t]}),s.jsx("p",{className:"text-text-secondary text-sm mt-1",children:"Configure what actions this role can perform"})]}),s.jsx("div",{className:"p-6 space-y-6",children:f==null?void 0:f.map(_=>{var w;return s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-text-primary mb-3 text-sm uppercase tracking-wide",children:_==null?void 0:_.category}),s.jsx("div",{className:"space-y-2 ml-4",children:(w=_==null?void 0:_.items)==null?void 0:w.map(j=>{var N;return s.jsxs("label",{className:"flex items-center space-x-3 p-2 rounded hover:bg-surface-hover cursor-pointer group",children:[s.jsx("input",{type:"checkbox",checked:((N=h==null?void 0:h[t])==null?void 0:N[j==null?void 0:j.key])||!1,onChange:()=>p(j==null?void 0:j.key),className:"rounded border-border text-primary focus:ring-primary"}),s.jsx("span",{className:"text-sm text-text-secondary group-hover:text-text-primary transition-colors duration-150",children:j==null?void 0:j.name})]},j==null?void 0:j.key)})})]},_==null?void 0:_.category)})})]})})]}),s.jsx("div",{className:"bg-background border border-border rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(G,{name:"Info",size:16,className:"text-primary mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium text-text-primary text-sm",children:"Permission Guidelines"}),s.jsx("p",{className:"text-text-secondary text-sm mt-1",children:"Changes to permissions will take effect immediately for all users with the selected role. Users may need to refresh their browser to see updated access."})]})]})})]})},pd={async getUserIntegrations(){try{const{data:e,error:t}=await be.get("/api/v1/integrations");if(t)throw t;return e||[]}catch(e){throw console.error("Error fetching integrations:",e),e}},async getIntegration(e){try{const{data:t,error:r}=await be.get(`/api/v1/integrations/${e}`);if(r)throw r;return t}catch(t){throw console.error("Error fetching integration:",t),t}},async createIntegration(e){try{const{data:t,error:r}=await be.post("/api/v1/integrations",e);if(r)throw r;return t}catch(t){throw console.error("Error creating integration:",t),t}},async updateIntegration(e,t){try{const{data:r,error:n}=await be.put(`/api/v1/integrations/${e}`,t);if(n)throw n;return r}catch(r){throw console.error("Error updating integration:",r),r}},async deleteIntegration(e){try{const{data:t,error:r}=await be.delete(`/api/v1/integrations/${e}`);if(r)throw r;return t}catch(t){throw console.error("Error deleting integration:",t),t}},async getOAuthUrl(e){var t,r;try{console.log(" Getting OAuth URL for provider:",e);const n=await be.post(`/api/v1/integrations/oauth/url?provider=${e}`);console.log(" OAuth URL Response:",n);const{data:a,error:i}=n;if(i)throw console.error(" OAuth URL Error:",i),i;return console.log(" OAuth URL Success:",a),a.auth_url}catch(n){throw console.error(" Error getting OAuth URL:",n),console.error(" Error details:",{message:n.message,response:(t=n.response)==null?void 0:t.data,status:(r=n.response)==null?void 0:r.status}),n}},async handleOAuthCallback(e,t,r=null){try{const{data:n,error:a}=await be.post("/api/v1/integrations/oauth/callback",{provider:e,code:t,state:r});if(a)throw a;return n}catch(n){throw console.error("Error handling OAuth callback:",n),n}},async testIntegration(e){try{const{data:t,error:r}=await be.post(`/api/v1/integrations/${e}/test`);if(r)throw r;return t}catch(t){throw console.error("Error testing integration:",t),t}},async syncIntegration(e,t=!1){try{const{data:r,error:n}=await be.post(`/api/v1/integrations/${e}/sync`,null,{params:{force:t}});if(n)throw n;return r}catch(r){throw console.error("Error syncing integration:",r),r}},async disconnectIntegration(e){try{const{data:t,error:r}=await be.post(`/api/v1/integrations/${e}/disconnect`);if(r)throw r;return t}catch(t){throw console.error("Error disconnecting integration:",t),t}},async getIntegrationLogs(e,t=50,r=0){try{const{data:n,error:a}=await be.get(`/api/v1/integrations/${e}/logs`,{params:{limit:t,offset:r}});if(a)throw a;return n||[]}catch(n){throw console.error("Error fetching integration logs:",n),n}},async initiateOAuthFlow(e){try{const t=await this.getOAuthUrl(e);localStorage.setItem("oauth_provider",e),window.location.href=t}catch(t){throw console.error("Error initiating OAuth flow:",t),t}},async handleOAuthCallbackFromUrl(){console.log(" Processing OAuth callback from URL...");const e=new URLSearchParams(window.location.search),t=e.get("code"),r=e.get("state"),n=e.get("error");if(console.log(" URL Parameters:",{code:(t==null?void 0:t.substring(0,20))+"...",state:r,error:n}),n)throw new Error(`OAuth error: ${n}`);if(!t)throw new Error("No authorization code received");let a=localStorage.getItem("oauth_provider");if(r&&r.includes(":")){const[i,o]=r.split(":");a=o,console.log(" Provider from state:",a)}if(!a)throw new Error("No provider information available");try{console.log(" Calling backend OAuth callback...");const i=await this.handleOAuthCallback(a,t,r);return console.log(" Backend OAuth callback result:",i),localStorage.removeItem("oauth_provider"),i}catch(i){throw console.error(" Backend OAuth callback error:",i),localStorage.removeItem("oauth_provider"),i}},getStatusBadge(e){const t={connected:{color:"bg-green-100 text-green-800",icon:"CheckCircle",text:"Connected"},disconnected:{color:"bg-gray-100 text-gray-800",icon:"XCircle",text:"Disconnected"},error:{color:"bg-red-100 text-red-800",icon:"AlertCircle",text:"Error"},syncing:{color:"bg-blue-100 text-blue-800",icon:"RefreshCw",text:"Syncing"}};return t[e]||t.disconnected},getProviderConfig(e){return{gmail:{name:"Gmail",description:"Sync emails and contacts with Gmail",icon:"Mail",color:"text-red-600",features:["Email sync","Contact sync","Email templates","Auto-logging"]},google_calendar:{name:"Google Calendar",description:"Schedule meetings and sync calendar events",icon:"Calendar",color:"text-blue-600",features:["Meeting scheduling","Event sync","Activity tracking","Reminders"]}}[e]||{name:e,description:`Integration with ${e}`,icon:"Settings",color:"text-gray-600",features:[]}}},rMe=()=>{const[e]=ah(),[t,r]=R.useState([]),[n,a]=R.useState(!0),[i,o]=R.useState(null),[c,l]=R.useState(null),[u,d]=R.useState({}),[f,h]=R.useState({}),[m,x]=R.useState(null),[p,g]=R.useState(!1),v=[{id:"gmail",name:"Gmail",description:"Sync emails and contacts with Gmail",icon:"Mail",color:"text-red-600",features:["Email sync","Contact sync","Email templates","Auto-logging"]},{id:"google_calendar",name:"Google Calendar",description:"Schedule meetings and sync calendar events",icon:"Calendar",color:"text-blue-600",features:["Meeting scheduling","Event sync","Activity tracking","Reminders"]}];R.useEffect(()=>{y();const A=e.get("code"),E=e.get("error");A?b():E&&(Be.error(`OAuth error: ${E}`),window.history.replaceState({},document.title,window.location.pathname))},[e]);const y=async()=>{try{a(!0);const A=await pd.getUserIntegrations();r(A),o(null)}catch(A){console.error("Error loading integrations:",A),o("Failed to load integrations"),Be.error("Failed to load integrations")}finally{a(!1)}},b=async()=>{try{console.log(" Starting OAuth callback processing..."),console.log(" URL params:",window.location.search);const A=await pd.handleOAuthCallbackFromUrl();console.log(" OAuth callback result:",A),Be.success(`Successfully connected ${A.provider||"integration"}!`),await y(),window.history.replaceState({},document.title,window.location.pathname)}catch(A){console.error(" OAuth callback error:",A),Be.error(`Failed to connect: ${A.message}`),window.history.replaceState({},document.title,window.location.pathname)}},_=A=>{const E={connected:{bg:"bg-success-50",text:"text-success-600",border:"border-success-100",label:"Connected"},disconnected:{bg:"bg-error-50",text:"text-error-600",border:"border-error-100",label:"Disconnected"},error:{bg:"bg-warning-50",text:"text-warning-600",border:"border-warning-100",label:"Error"}},M=(E==null?void 0:E[A])||(E==null?void 0:E.disconnected);return s.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded border ${M==null?void 0:M.bg} ${M==null?void 0:M.text} ${M==null?void 0:M.border}`,children:M==null?void 0:M.label})},w=A=>{const E={connected:{name:"CheckCircle",color:"text-success"},disconnected:{name:"XCircle",color:"text-error"},error:{name:"AlertCircle",color:"text-warning"}},M=(E==null?void 0:E[A])||(E==null?void 0:E.disconnected);return s.jsx(G,{name:M==null?void 0:M.name,size:20,className:M==null?void 0:M.color})},j=async A=>{try{console.log(" Connecting to provider:",A),d(M=>({...M,[A]:!0})),localStorage.setItem("oauth_provider",A),console.log(" Calling integrationsService.getOAuthUrl...");const E=await pd.getOAuthUrl(A);console.log(" OAuth response:",E),E?(console.log(" Redirecting to:",E),window.location.href=E):(console.error(" No OAuth URL received"),Be.error("No OAuth URL received"))}catch(E){console.error(" Connection error:",E),Be.error(`Failed to connect to ${A}: ${E.message||"Unknown error"}`)}finally{d(E=>({...E,[A]:!1}))}},N=async A=>{try{await pd.disconnectIntegration(A),Be.success("Integration disconnected successfully"),await y()}catch(E){console.error("Disconnect error:",E),Be.error("Failed to disconnect integration")}},D=async A=>{try{h(M=>({...M,[A]:"testing"}));const E=await pd.testIntegration(A);h(M=>({...M,[A]:E.success?"success":"error"})),E.success?Be.success("Integration test successful"):Be.error(`Integration test failed: ${E.error||"Unknown error"}`)}catch(E){console.error("Test error:",E),h(M=>({...M,[A]:"error"})),Be.error("Failed to test integration")}},S=A=>{x(A),g(!0)},T=()=>{console.log("Saving configuration for:",m==null?void 0:m.name),g(!1),x(null)};return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"Integrations"}),s.jsx("p",{className:"text-text-secondary mt-1",children:"Connect your CRM with Gmail and Google Calendar"})]})}),n&&s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin"}),s.jsx("span",{className:"text-text-secondary",children:"Loading integrations..."})]})}),i&&s.jsxs("div",{className:"bg-error-50 border border-error-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"AlertCircle",size:20,className:"text-error-600"}),s.jsx("span",{className:"text-error-600 font-medium",children:"Failed to load integrations"})]}),s.jsx("p",{className:"text-error-600 text-sm mt-1",children:i})]}),!n&&!i&&s.jsx(s.Fragment,{children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:v.map(A=>{const E=t.find(X=>X.provider===A.id&&X.status==="connected"),M=!!E,P=u[A.id];return s.jsxs("div",{className:"bg-surface rounded-lg border border-border p-6 hover:shadow-md transition-shadow duration-150",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:`w-10 h-10 ${M?"bg-success-50":"bg-primary-50"} rounded-lg flex items-center justify-center`,children:s.jsx(G,{name:A.icon,size:20,className:M?"text-success":A.color})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-text-primary",children:A.name}),s.jsx("p",{className:"text-sm text-text-secondary mt-1",children:A.description})]})]}),w(M?"connected":"disconnected")]}),s.jsxs("div",{className:"space-y-3 mb-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-text-secondary",children:"Status:"}),_(M?"connected":"disconnected")]}),(E==null?void 0:E.last_sync)&&s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-text-secondary",children:"Last Sync:"}),s.jsx("span",{className:"text-sm text-text-primary",children:new Date(E.last_sync).toLocaleDateString()})]}),(f==null?void 0:f[E==null?void 0:E.id])&&s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-text-secondary",children:"Test Result:"}),s.jsx("span",{className:`text-sm ${(f==null?void 0:f[E==null?void 0:E.id])==="testing"?"text-text-secondary":(f==null?void 0:f[E==null?void 0:E.id])==="success"?"text-success":"text-error"}`,children:(f==null?void 0:f[E==null?void 0:E.id])==="testing"?"Testing...":(f==null?void 0:f[E==null?void 0:E.id])==="success"?"Success":"Failed"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm text-text-secondary",children:"Features:"}),s.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:A.features.map((X,q)=>s.jsx("span",{className:"text-xs px-2 py-1 bg-background rounded text-text-secondary",children:X},q))})]})]}),s.jsxs("div",{className:"space-y-2",children:[M?s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>D(E.id),disabled:(f==null?void 0:f[E.id])==="testing",className:"flex-1 px-3 py-2 text-sm bg-background text-text-primary rounded hover:bg-surface-hover transition-colors duration-150 disabled:opacity-50 disabled:cursor-not-allowed",children:(f==null?void 0:f[E.id])==="testing"?s.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[s.jsx("div",{className:"w-4 h-4 border-2 border-text-secondary border-t-transparent rounded-full animate-spin"}),s.jsx("span",{children:"Testing"})]}):"Test Connection"}),s.jsx("button",{onClick:()=>S(E),className:"flex-1 px-3 py-2 text-sm bg-primary text-white rounded hover:bg-primary-600 transition-colors duration-150",children:"Configure"})]}):s.jsx("button",{onClick:()=>j(A.id),disabled:P,className:"w-full px-3 py-2 text-sm bg-primary text-white rounded hover:bg-primary-600 transition-colors duration-150 disabled:opacity-50 disabled:cursor-not-allowed",children:P?s.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),s.jsx("span",{children:"Connecting..."})]}):"Connect"}),M&&s.jsx("button",{onClick:()=>N(E.id),className:"w-full px-3 py-2 text-sm text-error hover:bg-error-50 rounded transition-colors duration-150",children:"Disconnect"})]})]},A.id)})})}),p&&m&&s.jsx("div",{className:"fixed inset-0 z-1200 overflow-y-auto",children:s.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:()=>g(!1)}),s.jsx("div",{className:"bg-surface rounded-lg shadow-xl max-w-lg w-full relative z-1300",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-text-primary",children:["Configure ",m==null?void 0:m.name]}),s.jsx("button",{onClick:()=>g(!1),className:"text-text-secondary hover:text-text-primary transition-colors duration-150",children:s.jsx(G,{name:"X",size:20})})]}),s.jsxs("div",{className:"space-y-4",children:[(m==null?void 0:m.provider)==="gmail"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-text-primary",children:"Auto Sync"}),s.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded border-border text-primary focus:ring-primary"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-text-primary",children:"Sync Contacts"}),s.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded border-border text-primary focus:ring-primary"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-text-primary",children:"Sync Emails"}),s.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded border-border text-primary focus:ring-primary"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Sync Frequency"}),s.jsxs("select",{className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:[s.jsx("option",{value:"5",children:"Every 5 minutes"}),s.jsx("option",{value:"15",selected:!0,children:"Every 15 minutes"}),s.jsx("option",{value:"30",children:"Every 30 minutes"}),s.jsx("option",{value:"60",children:"Every hour"})]})]})]}),(m==null?void 0:m.provider)==="google_calendar"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-text-primary",children:"Auto Sync Events"}),s.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded border-border text-primary focus:ring-primary"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-text-primary",children:"Create CRM Activities"}),s.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded border-border text-primary focus:ring-primary"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-text-primary",children:"Sync Meeting Notes"}),s.jsx("input",{type:"checkbox",className:"rounded border-border text-primary focus:ring-primary"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Default Calendar"}),s.jsxs("select",{className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:[s.jsx("option",{value:"primary",children:"Primary Calendar"}),s.jsx("option",{value:"work",children:"Work Calendar"}),s.jsx("option",{value:"crm",children:"CRM Events"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Sync Frequency"}),s.jsxs("select",{className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:[s.jsx("option",{value:"5",children:"Every 5 minutes"}),s.jsx("option",{value:"15",selected:!0,children:"Every 15 minutes"}),s.jsx("option",{value:"30",children:"Every 30 minutes"}),s.jsx("option",{value:"60",children:"Every hour"})]})]})]})]}),s.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[s.jsx("button",{onClick:()=>g(!1),className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors duration-150",children:"Cancel"}),s.jsx("button",{onClick:T,className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors duration-150 ease-smooth",children:"Save Configuration"})]})]})})]})}),s.jsx("div",{className:"bg-background border border-border rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(G,{name:"Zap",size:16,className:"text-primary mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium text-text-primary text-sm",children:"Integration Health"}),s.jsxs("p",{className:"text-text-secondary text-sm mt-1",children:[t==null?void 0:t.length," of ",v==null?void 0:v.length," integrations are connected and working properly. Connect your Google services to enhance your CRM capabilities."]})]})]})})]})},nMe=()=>{var q,B;const[e,t]=R.useState([]),[r,n]=R.useState(!1),[a,i]=R.useState(null),[o,c]=R.useState(!1),[l,u]=R.useState(null),[d,f]=R.useState("all"),[h,m]=R.useState(1),[x,p]=R.useState(10),g=[{value:"text",label:"Text"},{value:"number",label:"Number"},{value:"select",label:"Select"},{value:"multi_select",label:"Multi Select"},{value:"date",label:"Date"},{value:"datetime",label:"Date & Time"},{value:"boolean",label:"Boolean"},{value:"email",label:"Email"},{value:"phone",label:"Phone"},{value:"url",label:"URL"},{value:"textarea",label:"Text Area"},{value:"currency",label:"Currency"},{value:"percentage",label:"Percentage"}],v=[{value:"contact",label:"Contact"},{value:"company",label:"Company"},{value:"deal",label:"Deal"},{value:"activity",label:"Activity"},{value:"task",label:"Task"}],y=[{value:"form",label:"Form Only"},{value:"detail_view",label:"Detail View Only"},{value:"both",label:"Both Form and Detail View"}],b=async()=>{c(!0),u(null);try{const O=await vi.getAllFields();t(O||[])}catch(O){console.error("Failed to fetch custom fields:",O),u("Failed to load custom fields. Please try again."),t([])}finally{c(!1)}};R.useEffect(()=>{b()},[]);const _=({field:O,onSave:F,onCancel:I})=>{var Q;const[L,C]=R.useState({name:(O==null?void 0:O.name)||"",description:(O==null?void 0:O.description)||"",field_type:(O==null?void 0:O.field_type)||"text",entity_type:(O==null?void 0:O.entity_type)||"contact",is_required:(O==null?void 0:O.is_required)||!1,placement:(O==null?void 0:O.placement)||"both",field_config:(O==null?void 0:O.field_config)||{},help_text:(O==null?void 0:O.help_text)||"",placeholder:(O==null?void 0:O.placeholder)||""}),[k,z]=R.useState(((Q=O==null?void 0:O.field_config)==null?void 0:Q.options)||[{value:"",label:""}]),V=async ne=>{ne.preventDefault();let pe={...L.field_config};(L.field_type==="select"||L.field_type==="multi_select")&&(pe.options=k.filter(re=>re.value&&re.label));const W={...L,field_config:pe};try{O?await vi.updateField(O.id,W):await vi.createField(W),F(),b()}catch(re){console.error("Failed to save custom field:",re)}},Z=()=>{z([...k,{value:"",label:""}])},ce=(ne,pe,W)=>{const re=k.map((U,se)=>se===ne?{...U,[pe]:W}:U);z(re)},ie=ne=>{z(k.filter((pe,W)=>W!==ne))};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-screen overflow-y-auto",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h2",{className:"text-xl font-semibold",children:O?"Edit Custom Field":"Create Custom Field"}),s.jsx("button",{onClick:I,className:"text-text-secondary hover:text-text-primary",children:s.jsx(Z4,{size:20})})]}),s.jsxs("form",{onSubmit:V,className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Field Name *"}),s.jsx("input",{type:"text",value:L.name,onChange:ne=>C({...L,name:ne.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Field Type *"}),s.jsx("select",{value:L.field_type,onChange:ne=>C({...L,field_type:ne.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:g.map(ne=>s.jsx("option",{value:ne.value,children:ne.label},ne.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Entity Type *"}),s.jsx("select",{value:L.entity_type,onChange:ne=>C({...L,entity_type:ne.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!!O,children:v.map(ne=>s.jsx("option",{value:ne.value,children:ne.label},ne.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Placement"}),s.jsx("select",{value:L.placement,onChange:ne=>C({...L,placement:ne.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:y.map(ne=>s.jsx("option",{value:ne.value,children:ne.label},ne.value))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),s.jsx("textarea",{value:L.description,onChange:ne=>C({...L,description:ne.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"2"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Help Text"}),s.jsx("input",{type:"text",value:L.help_text,onChange:ne=>C({...L,help_text:ne.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Placeholder"}),s.jsx("input",{type:"text",value:L.placeholder,onChange:ne=>C({...L,placeholder:ne.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",id:"required",checked:L.is_required,onChange:ne=>C({...L,is_required:ne.target.checked}),className:"mr-2"}),s.jsx("label",{htmlFor:"required",className:"text-sm font-medium text-gray-700",children:"Required Field"})]}),(L.field_type==="select"||L.field_type==="multi_select")&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Options"}),k.map((ne,pe)=>s.jsxs("div",{className:"flex gap-2 mb-2",children:[s.jsx("input",{type:"text",placeholder:"Value",value:ne.value,onChange:W=>ce(pe,"value",W.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),s.jsx("input",{type:"text",placeholder:"Label",value:ne.label,onChange:W=>ce(pe,"label",W.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),s.jsx("button",{type:"button",onClick:()=>ie(pe),className:"px-3 py-2 text-error hover:text-error-600",children:s.jsx(nD,{size:16})})]},pe)),s.jsx("button",{type:"button",onClick:Z,className:"text-primary hover:text-primary-600 text-sm",children:"+ Add Option"})]}),s.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[s.jsx("button",{type:"button",onClick:I,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),s.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center",children:[s.jsx(o9,{size:16,className:"mr-2"}),O?"Update":"Create"," Field"]})]})]})]})})},w=async O=>{if(window.confirm("Are you sure you want to delete this custom field? This action cannot be undone."))try{await vi.deleteField(O),b()}catch(F){console.error("Failed to delete custom field:",F)}},j=d==="all"?e:e.filter(O=>O.entity_type===d),N=O=>O==="all"?e.length:e.filter(F=>F.entity_type===O).length,D=Math.ceil(j.length/x),S=(h-1)*x,T=S+x,A=j.slice(S,T),E=O=>{f(O),m(1)},M=O=>{m(O),window.scrollTo({top:0,behavior:"smooth"})},P=O=>{p(O),m(1)},X=()=>{const O=[];if(D<=5)for(let I=1;I<=D;I++)O.push(I);else if(h<=3){for(let I=1;I<=4;I++)O.push(I);O.push("..."),O.push(D)}else if(h>=D-2){O.push(1),O.push("...");for(let I=D-3;I<=D;I++)O.push(I)}else O.push(1),O.push("..."),O.push(h-1),O.push(h),O.push(h+1),O.push("..."),O.push(D);return O};return s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[s.jsx(a9,{className:"mr-3"}),"Custom Fields"]}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Create and manage custom fields for your data"})]}),s.jsxs("button",{onClick:()=>n(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center",children:[s.jsx(i9,{size:16,className:"mr-2"}),"Create Field"]})]}),s.jsxs("div",{className:"mb-6 bg-white rounded-lg shadow p-2 flex flex-wrap gap-2",children:[s.jsxs("button",{onClick:()=>E("all"),className:`px-4 py-2 rounded-md font-medium transition-colors ${d==="all"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["All (",N("all"),")"]}),v.map(O=>s.jsxs("button",{onClick:()=>E(O.value),className:`px-4 py-2 rounded-md font-medium transition-colors ${d===O.value?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[O.label," (",N(O.value),")"]},O.value))]}),o?s.jsx("div",{className:"text-center py-8",children:"Loading..."}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white rounded-lg shadow px-6 py-3 mb-4 flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Show"}),s.jsxs("select",{value:x,onChange:O=>P(Number(O.target.value)),className:"px-3 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[s.jsx("option",{value:5,children:"5"}),s.jsx("option",{value:10,children:"10"}),s.jsx("option",{value:25,children:"25"}),s.jsx("option",{value:50,children:"50"}),s.jsx("option",{value:100,children:"100"})]}),s.jsx("span",{className:"text-sm text-gray-600",children:"entries per page"})]}),s.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",j.length>0?S+1:0," to ",Math.min(T,j.length)," of ",j.length," entries"]})]}),s.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:s.jsx("div",{className:"overflow-x-auto",style:{maxWidth:"100%",overflowX:"auto"},children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Field Name"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Entity"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Required"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Placement"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:A&&A.length>0?A.map(O=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:O.name}),O.description&&s.jsx("div",{className:"text-sm text-gray-500",children:O.description})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:O.field_type.replace("_"," ")})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:O.entity_type})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:O.is_required?s.jsx("span",{className:"text-red-600",children:""}):s.jsx("span",{className:"text-gray-400",children:"-"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:O.placement.replace("_"," ")}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(O.created_at).toLocaleDateString()}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>i(O),className:"text-primary hover:text-primary-600",children:s.jsx(s9,{size:16})}),s.jsx("button",{onClick:()=>w(O.id),className:"text-error hover:text-error-600",children:s.jsx(nD,{size:16})})]})})]},O.id)):s.jsx("tr",{children:s.jsx("td",{colSpan:"7",className:"text-center py-8 text-gray-500",children:o?"Loading custom fields...":l||(d!=="all"?`No custom fields found for ${(q=v.find(O=>O.value===d))==null?void 0:q.label}. Create your first ${(B=v.find(O=>O.value===d))==null?void 0:B.label} custom field to get started.`:"No custom fields found. Create your first custom field to get started.")})})})]})})}),j.length>0&&D>1&&s.jsx("div",{className:"bg-white rounded-lg shadow px-6 py-4 mt-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("button",{onClick:()=>M(h-1),disabled:h===1,className:`px-4 py-2 rounded-md font-medium ${h===1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Previous"}),s.jsx("div",{className:"flex space-x-2",children:X().map((O,F)=>O==="..."?s.jsx("span",{className:"px-3 py-2 text-gray-500",children:"..."},`ellipsis-${F}`):s.jsx("button",{onClick:()=>M(O),className:`px-4 py-2 rounded-md font-medium transition-colors ${h===O?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:O},O))}),s.jsx("button",{onClick:()=>M(h+1),disabled:h===D,className:`px-4 py-2 rounded-md font-medium ${h===D?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Next"})]})})]}),r&&s.jsx(_,{onSave:()=>n(!1),onCancel:()=>n(!1)}),a&&s.jsx(_,{field:a,onSave:()=>i(null),onCancel:()=>i(null)})]})},aMe=()=>s.jsx(nMe,{}),iMe=()=>{const[e,t]=R.useState([]),[r,n]=R.useState([]),[a,i]=R.useState(!0),[o,c]=R.useState(null),[l,u]=R.useState(null),[d,f]=R.useState(!1),[h,m]=R.useState(!1),[x,p]=R.useState(null),[g,v]=R.useState(!1),[y,b]=R.useState(""),[_,w]=R.useState({name:"",subject:"",category:"general",content:"",status:"draft"}),[j,N]=R.useState("content"),[D,S]=R.useState([]),[T,A]=R.useState({}),E=mi.getCategories(),M=[...E,...D],P=mi.getStatuses(),X=re=>!E.some(U=>U.value===re);R.useEffect(()=>{k(),z(),q()},[]);const q=()=>{const re=localStorage.getItem("emailTemplateCustomCategories");if(re)try{S(JSON.parse(re))}catch(se){console.error("Failed to load custom categories:",se)}const U=localStorage.getItem("emailTemplateCategoryMetadata");if(U)try{A(JSON.parse(U))}catch(se){console.error("Failed to load category metadata:",se)}},B=re=>{localStorage.setItem("emailTemplateCustomCategories",JSON.stringify(re)),S(re)},O=re=>{localStorage.setItem("emailTemplateCategoryMetadata",JSON.stringify(re)),A(re)},F=re=>{if(!window.confirm(`Are you sure you want to delete the "${I(re)}" category? Templates using this category will be moved to "General".`))return;const U=D.filter(se=>se.value!==re);B(U),_.category===re&&w(se=>({...se,category:"general"}))},I=re=>{const U=M.find(se=>se.value===re);return(U==null?void 0:U.label)||re},L=()=>{if(!y.trim()){alert("Please enter a category name");return}const re=y.toLowerCase().replace(/\s+/g,"-"),U=y.trim();if([...E,...D].some(H=>H.value===re)){alert("This category already exists");return}const te={value:re,label:U},K=[...D,te];B(K),w(H=>({...H,category:re})),b(""),v(!1)},C=re=>{const U=re.target.value;U==="__add_new__"?v(!0):w(se=>({...se,category:U}))},k=async()=>{try{i(!0);const re=await mi.getTemplates();t(re.templates||[])}catch(re){c("Failed to load email templates"),console.error(re)}finally{i(!1)}},z=async()=>{try{const re=await mi.getMergeFields();n(re.fields||[])}catch(re){console.error("Failed to load merge fields:",re)}},V=()=>{p(null),w({name:"",subject:"",category:"general",content:"",status:"draft"}),f(!0)},Z=re=>{p(re);const U=T[re.id],se=(U==null?void 0:U.customCategory)||re.category;w({name:re.name,subject:re.subject,category:se,content:re.content,status:re.status}),f(!0)},ce=async re=>{if(window.confirm("Are you sure you want to delete this template?"))try{await mi.deleteTemplate(re),await k()}catch(U){alert("Failed to delete template"),console.error(U)}},ie=async re=>{var U,se;re.preventDefault();try{const te={..._,category:X(_.category)?"general":_.category};let K;if(x?K=await mi.updateTemplate(x.id,te):K=await mi.createTemplate(te),X(_.category)){const H={...T,[K.id]:{customCategory:_.category,categoryLabel:I(_.category)}};O(H)}f(!1),await k()}catch(te){alert("Failed to save template: "+(((se=(U=te.response)==null?void 0:U.data)==null?void 0:se.detail)||te.message)),console.error(te)}},Q=re=>{u(re),m(!0)},ne=re=>{const U=document.getElementById("template-subject"),se=document.getElementById("template-content");let te,K,H;j==="subject"?(te=U,K=(_==null?void 0:_.subject)||"",H="subject"):(te=se,K=(_==null?void 0:_.content)||"",H="content");const oe=(te==null?void 0:te.selectionStart)||0,J=(te==null?void 0:te.selectionEnd)||0,le=K.substring(0,oe),he=K.substring(J,K.length),ee=le+re+he;w(H==="subject"?ae=>({...ae,subject:ee}):ae=>({...ae,content:ee})),setTimeout(()=>{te==null||te.focus(),te==null||te.setSelectionRange(oe+re.length,oe+re.length)},0)},pe=re=>{var se;const U={active:"bg-success-50 text-success-600 border-success-100",draft:"bg-warning-50 text-warning-600 border-warning-100",inactive:"bg-error-50 text-error-600 border-error-100"};return s.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded border ${(U==null?void 0:U[re])||"bg-gray-50 text-gray-600 border-gray-100"}`,children:((se=re==null?void 0:re.charAt(0))==null?void 0:se.toUpperCase())+(re==null?void 0:re.slice(1))})},W=re=>{const U=T[re.id];U!=null&&U.customCategory||re.category;const se=(U==null?void 0:U.categoryLabel)||I(re.category);return s.jsx("span",{className:"px-2 py-1 text-xs bg-primary-50 text-primary border border-primary-100 rounded",children:se})};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"Email Templates"}),s.jsx("p",{className:"text-text-secondary mt-1",children:"Create and manage email templates with merge fields"})]}),s.jsxs("button",{onClick:V,className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors duration-150 ease-smooth flex items-center space-x-2",children:[s.jsx(G,{name:"Plus",size:16}),s.jsx("span",{children:"Create Template"})]})]}),a?s.jsx("div",{className:"bg-surface rounded-lg border border-border p-8 text-center",children:s.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"}),s.jsx("span",{className:"text-text-secondary",children:"Loading templates..."})]})}):o?s.jsxs("div",{className:"bg-surface rounded-lg border border-border p-8 text-center",children:[s.jsx("div",{className:"text-error",children:o}),s.jsx("button",{onClick:k,className:"mt-2 text-primary hover:underline",children:"Try again"})]}):s.jsx("div",{className:"bg-surface rounded-lg border border-border overflow-hidden",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-background border-b border-border",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-primary",children:"Template Name"}),s.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-primary",children:"Subject"}),s.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-primary",children:"Category"}),s.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-primary",children:"Status"}),s.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-primary",children:"Modified"}),s.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-text-primary",children:"Actions"})]})}),s.jsx("tbody",{children:e.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:7,className:"py-8 px-4 text-center text-text-secondary",children:"No email templates found. Create your first template to get started."})}):e.map(re=>s.jsxs("tr",{className:"border-b border-border hover:bg-surface-hover",children:[s.jsx("td",{className:"py-3 px-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{name:"Mail",size:16,className:"text-text-tertiary"}),s.jsx("span",{className:"font-medium text-text-primary",children:re.name})]})}),s.jsx("td",{className:"py-3 px-4 text-sm text-text-secondary max-w-xs truncate",children:re.subject}),s.jsx("td",{className:"py-3 px-4",children:W(re)}),s.jsx("td",{className:"py-3 px-4",children:pe(re.status)}),s.jsx("td",{className:"py-3 px-4 text-sm text-text-secondary",children:new Date(re.updated_at).toLocaleDateString()}),s.jsx("td",{className:"py-3 px-4",children:s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>Q(re),className:"p-1 text-text-secondary hover:text-primary transition-colors duration-150",title:"Preview",children:s.jsx(G,{name:"Eye",size:16})}),s.jsx("button",{onClick:()=>Z(re),className:"p-1 text-text-secondary hover:text-primary transition-colors duration-150",title:"Edit",children:s.jsx(G,{name:"Edit3",size:16})}),s.jsx("button",{onClick:()=>ce(re.id),className:"p-1 text-text-secondary hover:text-error transition-colors duration-150",title:"Delete",children:s.jsx(G,{name:"Trash2",size:16})})]})})]},re.id))})]})})}),d&&s.jsx("div",{className:"fixed inset-0 z-1200 overflow-y-auto",children:s.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:()=>f(!1)}),s.jsx("div",{className:"bg-surface rounded-lg shadow-xl max-w-4xl w-full relative z-1300 max-h-screen overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:x?"Edit Template":"Create New Template"}),s.jsx("button",{onClick:()=>f(!1),className:"text-text-secondary hover:text-text-primary transition-colors duration-150",children:s.jsx(G,{name:"X",size:20})})]}),s.jsxs("form",{onSubmit:ie,className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Template Name"}),s.jsx("input",{type:"text",value:_==null?void 0:_.name,onChange:re=>w(U=>{var se;return{...U,name:(se=re==null?void 0:re.target)==null?void 0:se.value}}),className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",placeholder:"Enter template name",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Category"}),s.jsxs("select",{value:_==null?void 0:_.category,onChange:C,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:[M==null?void 0:M.map(re=>s.jsx("option",{value:re==null?void 0:re.value,children:re==null?void 0:re.label},re==null?void 0:re.value)),s.jsx("option",{value:"__add_new__",className:"text-primary font-semibold",children:"+ Add New Category"})]}),D.length>0&&s.jsxs("div",{className:"mt-2 p-2 bg-background border border-border rounded-lg",children:[s.jsx("p",{className:"text-xs text-text-secondary mb-2",children:"Custom Categories:"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:D.map(re=>s.jsxs("div",{className:"inline-flex items-center space-x-1 px-2 py-1 bg-primary-50 text-primary rounded border border-primary-100",children:[s.jsx("span",{className:"text-xs",children:re.label}),s.jsx("button",{type:"button",onClick:()=>F(re.value),className:"text-primary hover:text-error transition-colors",title:"Delete category",children:s.jsx(G,{name:"X",size:12})})]},re.value))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Status"}),s.jsx("select",{value:_==null?void 0:_.status,onChange:re=>w(U=>{var se;return{...U,status:(se=re==null?void 0:re.target)==null?void 0:se.value}}),className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:P==null?void 0:P.map(re=>s.jsx("option",{value:re==null?void 0:re.value,children:re==null?void 0:re.label},re==null?void 0:re.value))})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Subject Line",s.jsx("span",{className:"text-xs text-text-tertiary ml-2 font-normal",children:"(Click subject field, then click merge fields to insert)"})]}),s.jsx("input",{id:"template-subject",type:"text",value:_==null?void 0:_.subject,onChange:re=>w(U=>{var se;return{...U,subject:(se=re==null?void 0:re.target)==null?void 0:se.value}}),onFocus:()=>N("subject"),className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",placeholder:"Enter email subject (e.g., Hello {{first_name}}!)",required:!0})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"lg:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Email Content"}),s.jsx("textarea",{id:"template-content",value:_==null?void 0:_.content,onChange:re=>w(U=>{var se;return{...U,content:(se=re==null?void 0:re.target)==null?void 0:se.value}}),onFocus:()=>N("content"),className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",rows:12,placeholder:"Enter email content...",required:!0})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-text-primary mb-1",children:["Merge Fields",s.jsx("span",{className:"text-xs text-text-tertiary ml-2 font-normal block mt-1",children:"Click in Subject or Content field first, then click a merge field to insert"})]}),s.jsx("div",{className:"bg-background border border-border rounded-lg p-3 max-h-80 overflow-y-auto",children:(()=>{const re=(r||[]).reduce((te,K)=>{const H=(K==null?void 0:K.category)||"General";return te[H]||(te[H]=[]),te[H].push(K),te},{}),U=["Contact Fields","Company Fields","Deal Fields","System Fields","Contact Custom Fields","Company Custom Fields","Deal Custom Fields","Activity Custom Fields","General"],se=Object.keys(re).sort((te,K)=>{const H=U.indexOf(te),oe=U.indexOf(K);return H===-1&&oe===-1?te.localeCompare(K):H===-1?1:oe===-1?-1:H-oe});return s.jsx("div",{className:"space-y-3",children:se.map(te=>s.jsxs("details",{open:te==="Contact Fields"||te==="System Fields",children:[s.jsxs("summary",{className:"cursor-pointer text-sm font-medium text-text-primary hover:text-primary px-2 py-1 rounded hover:bg-surface-hover transition-colors duration-150",children:[te," (",re[te].length,")"]}),s.jsx("div",{className:"mt-2 space-y-1 pl-2",children:re[te].map(K=>s.jsxs("button",{type:"button",onClick:()=>ne(K==null?void 0:K.field),className:"w-full text-left p-2 rounded hover:bg-surface-hover transition-colors duration-150 group",children:[s.jsx("div",{className:"text-xs font-mono text-primary group-hover:text-primary-600",children:K==null?void 0:K.field}),s.jsxs("div",{className:"text-xs text-text-tertiary mt-1",children:[K==null?void 0:K.description,(K==null?void 0:K.example)&&s.jsxs("span",{className:"ml-2 italic",children:["e.g., ",K==null?void 0:K.example]})]})]},K==null?void 0:K.field))})]},te))})})()})]})]}),s.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[s.jsx("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors duration-150",children:"Cancel"}),s.jsx("button",{type:"submit",className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors duration-150 ease-smooth",children:x?"Update Template":"Create Template"})]})]})]})})]})}),h&&l&&s.jsx("div",{className:"fixed inset-0 z-1200 overflow-y-auto",children:s.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:()=>m(!1)}),s.jsx("div",{className:"bg-surface rounded-lg shadow-xl max-w-2xl w-full relative z-1300",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Template Preview"}),s.jsx("button",{onClick:()=>m(!1),className:"text-text-secondary hover:text-text-primary transition-colors duration-150",children:s.jsx(G,{name:"X",size:20})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Subject:"}),s.jsx("div",{className:"bg-background border border-border rounded-lg p-3 text-text-primary",children:l==null?void 0:l.subject})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Content:"}),s.jsx("div",{className:"bg-background border border-border rounded-lg p-4 text-text-primary whitespace-pre-wrap min-h-40",children:l==null?void 0:l.content})]})]}),s.jsx("div",{className:"flex justify-end mt-6",children:s.jsx("button",{onClick:()=>m(!1),className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors duration-150 ease-smooth",children:"Close Preview"})})]})})]})}),g&&s.jsx("div",{className:"fixed inset-0 z-1300 overflow-y-auto",children:s.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:()=>v(!1)}),s.jsx("div",{className:"bg-surface rounded-lg shadow-xl max-w-md w-full relative z-1400",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Add New Category"}),s.jsx("button",{onClick:()=>v(!1),className:"text-text-secondary hover:text-text-primary transition-colors duration-150",children:s.jsx(G,{name:"X",size:20})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Category Name"}),s.jsx("input",{type:"text",value:y,onChange:re=>b(re.target.value),onKeyPress:re=>{re.key==="Enter"&&(re.preventDefault(),L())},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",placeholder:"e.g., Customer Support, Sales Follow-up",autoFocus:!0}),s.jsx("p",{className:"text-xs text-text-tertiary mt-1",children:"Enter a descriptive name for the new category"})]}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx("button",{type:"button",onClick:()=>{v(!1),b("")},className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors duration-150",children:"Cancel"}),s.jsx("button",{type:"button",onClick:L,className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors duration-150 ease-smooth",children:"Add Category"})]})]})]})})]})}),s.jsx("div",{className:"bg-background border border-border rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(G,{name:"Lightbulb",size:16,className:"text-primary mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium text-text-primary text-sm",children:"Template Usage Tips"}),s.jsxs("p",{className:"text-text-secondary text-sm mt-1",children:["Use merge fields like ","{{first_name}}"," to personalize emails. Templates marked as 'Active' are available for use in email campaigns. Test your templates before sending to ensure proper formatting."]})]})]})})]})},sMe=()=>{var w,j,N,D,S,T,A,E,M,P,X,q,B;const[e,t]=R.useState({}),[r,n]=R.useState(!0),[a,i]=R.useState(""),[o,c]=R.useState(""),[l,u]=R.useState(!1),[d,f]=R.useState("json"),[h,m]=R.useState(!1),x=async()=>{try{n(!0),i("");const O=await fs.getConfigurationsGrouped();console.log("Loaded configuration data:",O);const F=[];Object.entries(O).forEach(([L,C])=>{Object.entries(C).forEach(([k,z])=>{F.push({key:`${L}.${k}`,value:z,category:L})})}),console.log("Flat config array:",F);const I=fs.transformConfigurationsForUI(F);console.log("Transformed configuration for UI:",I),t(I)}catch(O){console.error("Error loading configuration:",O),i("Failed to load configuration. Using default values."),Be.error("Failed to load configuration settings"),t(fs.getDefaultConfiguration())}finally{n(!1)}};R.useEffect(()=>{x()},[]);const p=["America/New_York","America/Chicago","America/Denver","America/Los_Angeles","Europe/London","Europe/Paris","Asia/Tokyo","Asia/Shanghai","Australia/Sydney"],g=[{code:"USD",name:"US Dollar"},{code:"EUR",name:"Euro"},{code:"GBP",name:"British Pound"},{code:"CAD",name:"Canadian Dollar"},{code:"AUD",name:"Australian Dollar"},{code:"JPY",name:"Japanese Yen"}],v=["MM/DD/YYYY","DD/MM/YYYY","YYYY-MM-DD","DD-MM-YYYY"],y=(O,F,I)=>{t(L=>({...L,[O]:{...L==null?void 0:L[O],[F]:I}})),u(!0)},b=async()=>{try{n(!0),i("");const O=fs.transformConfigurationsFromUI(e),F=new Set(["general.company_name","general.company_email","general.company_phone","general.company_address","general.timezone","general.date_format","general.time_format","general.currency","general.language","sales.default_pipeline_stage","sales.deal_currency","sales.require_deal_value","sales.auto_progress_deals","sales.deal_inactivity_warning_days","sales.lead_scoring_enabled","sales.opportunity_auto_close_days","notifications.email_notifications","notifications.deal_update_notifications","notifications.task_reminders","notifications.weekly_reports","notifications.system_alerts","notifications.lead_assignment_alerts","notifications.quota_achievement_alerts","security.password_complexity","security.min_password_length","security.two_factor_auth","security.session_timeout_minutes","security.max_login_attempts","security.lockout_duration_minutes","security.data_encryption_at_rest","security.audit_log_retention_days","backup.enable_automatic_backups","backup.backup_frequency","backup.backup_retention_days","backup.backup_location","backup.compress_backups","integrations.email_service_provider","integrations.calendar_integration","integrations.crm_sync_enabled","integrations.api_rate_limit","performance.enable_caching","performance.cache_ttl_seconds","performance.max_search_results","performance.database_query_timeout"]),I=O.filter(z=>{const V=F.has(z.key);return V||console.warn(`Skipping invalid configuration key: ${z.key}`),V});if(console.log("Original flat configurations:",O),console.log("Valid configurations after filtering:",I),console.log("Request payload that will be sent:",{configurations:I}),!Array.isArray(I)||I.length===0)throw new Error("No valid configurations to save");const L=I.filter(z=>!z.key||z.value===void 0||z.value===null||z.value==="");if(L.length>0)throw console.error("Invalid configurations found:",L),new Error(`Some configurations have missing or empty values: ${L.map(z=>z.key).join(", ")}`);const C=I.map(z=>({key:z.key,value:z.value}));console.log("Final configurations to send:",C);const k=await fs.updateConfigurationsBulk(C);console.log("Save result:",k),c("Configuration saved successfully!"),u(!1),Be.success("System configuration updated successfully!"),setTimeout(()=>c(""),3e3),await x()}catch(O){console.error("Error saving configuration:",O),console.error("Full error object:",JSON.stringify(O,null,2));let F="Failed to save configuration. Please try again.";O&&O.message&&(F=O.message),i(F),Be.error(F)}finally{n(!1)}},_=async()=>{try{i("");const O=await fs.exportConfiguration(),F=d==="json"?JSON.stringify(O,null,2):Object.entries(O.configurations).map(([k,z])=>Object.entries(z).map(([V,Z])=>`${k}.${V}=${Z}`).join(`
`)).join(`
`),I=new Blob([F],{type:d==="json"?"application/json":"text/plain"}),L=URL.createObjectURL(I),C=document.createElement("a");C.href=L,C.download=`system-config.${d}`,document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(L),m(!1),c("Configuration exported successfully!"),Be.success("Configuration exported successfully!")}catch(O){console.error("Error exporting configuration:",O);const F="Failed to export configuration. Please try again.";i(F),Be.error(F)}};return s.jsxs("div",{className:"space-y-6",children:[a&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start space-x-3",children:[s.jsx(G,{name:"AlertCircle",size:20,className:"text-red-500 mt-0.5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-red-800",children:"Configuration Error"}),s.jsx("p",{className:"text-red-700 text-sm mt-1",children:a})]})]}),o&&s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-start space-x-3",children:[s.jsx(G,{name:"CheckCircle",size:20,className:"text-green-500 mt-0.5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-green-800",children:"Success"}),s.jsx("p",{className:"text-green-700 text-sm mt-1",children:o})]})]}),r&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-center space-x-3",children:[s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-primary"}),s.jsx("span",{className:"text-blue-700",children:"Loading configuration..."})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"System Configuration"}),s.jsx("p",{className:"text-text-secondary mt-1",children:"Manage general system settings and preferences"})]}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsxs("button",{onClick:()=>m(!0),disabled:r,className:"bg-background text-text-primary px-4 py-2 rounded-lg hover:bg-surface-hover transition-colors duration-150 ease-smooth flex items-center space-x-2 border border-border disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsx(G,{name:"Download",size:16}),s.jsx("span",{children:"Export Configuration"})]}),s.jsxs("button",{onClick:b,disabled:!l||r,className:`px-4 py-2 rounded-lg transition-colors duration-150 ease-smooth flex items-center space-x-2 ${l&&!r?"bg-primary text-white hover:bg-primary-600":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:[r?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):s.jsx(G,{name:"Save",size:16}),s.jsx("span",{children:r?"Saving...":"Save Changes"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"bg-surface rounded-lg border border-border p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center space-x-2",children:[s.jsx(G,{name:"Settings",size:20,className:"text-primary"}),s.jsx("span",{children:"General Settings"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Company Name"}),s.jsx("input",{type:"text",value:((w=e==null?void 0:e.general)==null?void 0:w.company_name)||"",onChange:O=>{var F;return y("general","company_name",(F=O==null?void 0:O.target)==null?void 0:F.value)},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Company Email"}),s.jsx("input",{type:"email",value:((j=e==null?void 0:e.general)==null?void 0:j.company_email)||"",onChange:O=>{var F;return y("general","company_email",(F=O==null?void 0:O.target)==null?void 0:F.value)},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Company Phone"}),s.jsx("input",{type:"tel",value:((N=e==null?void 0:e.general)==null?void 0:N.company_phone)||"",onChange:O=>{var F;return y("general","company_phone",(F=O==null?void 0:O.target)==null?void 0:F.value)},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Company Address"}),s.jsx("textarea",{value:((D=e==null?void 0:e.general)==null?void 0:D.company_address)||"",onChange:O=>{var F;return y("general","company_address",(F=O==null?void 0:O.target)==null?void 0:F.value)},rows:3,className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Timezone"}),s.jsx("select",{value:((S=e==null?void 0:e.general)==null?void 0:S.timezone)||"",onChange:O=>{var F;return y("general","timezone",(F=O==null?void 0:O.target)==null?void 0:F.value)},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:p==null?void 0:p.map(O=>s.jsx("option",{value:O,children:O},O))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Date Format"}),s.jsx("select",{value:((T=e==null?void 0:e.general)==null?void 0:T.date_format)||"",onChange:O=>{var F;return y("general","date_format",(F=O==null?void 0:O.target)==null?void 0:F.value)},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:v==null?void 0:v.map(O=>s.jsx("option",{value:O,children:O},O))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Time Format"}),s.jsxs("select",{value:((A=e==null?void 0:e.general)==null?void 0:A.time_format)||"",onChange:O=>{var F;return y("general","time_format",(F=O==null?void 0:O.target)==null?void 0:F.value)},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:[s.jsx("option",{value:"12",children:"12 Hour"}),s.jsx("option",{value:"24",children:"24 Hour"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Currency"}),s.jsx("select",{value:((E=e==null?void 0:e.general)==null?void 0:E.currency)||"",onChange:O=>{var F;return y("general","currency",(F=O==null?void 0:O.target)==null?void 0:F.value)},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:g==null?void 0:g.map(O=>s.jsxs("option",{value:O==null?void 0:O.code,children:[O==null?void 0:O.code," - ",O==null?void 0:O.name]},O==null?void 0:O.code))})]})]})]})}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-surface rounded-lg border border-border p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center space-x-2",children:[s.jsx(G,{name:"Target",size:20,className:"text-primary"}),s.jsx("span",{children:"Deals Settings"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Default Pipeline Stage"}),s.jsxs("select",{value:((M=e==null?void 0:e.sales)==null?void 0:M.default_pipeline_stage)||"",onChange:O=>{var F;return y("sales","default_pipeline_stage",(F=O==null?void 0:O.target)==null?void 0:F.value)},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:[s.jsx("option",{value:"lead",children:"Lead"}),s.jsx("option",{value:"qualified",children:"Qualified"}),s.jsx("option",{value:"proposal",children:"Proposal"}),s.jsx("option",{value:"negotiation",children:"Negotiation"}),s.jsx("option",{value:"closed_won",children:"Closed Won"}),s.jsx("option",{value:"closed_lost",children:"Closed Lost"})]})]}),s.jsx("div",{children:s.jsxs("label",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",checked:((P=e==null?void 0:e.sales)==null?void 0:P.require_deal_value)||!1,onChange:O=>{var F;return y("sales","require_deal_value",(F=O==null?void 0:O.target)==null?void 0:F.checked)},className:"rounded border-border text-primary focus:ring-primary"}),s.jsx("span",{className:"text-sm text-text-primary",children:"Require deal value"})]})})]})]}),s.jsxs("div",{className:"bg-surface rounded-lg border border-border p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center space-x-2",children:[s.jsx(G,{name:"Shield",size:20,className:"text-primary"}),s.jsx("span",{children:"Security"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Session Timeout (minutes)"}),s.jsx("input",{type:"number",value:((X=e==null?void 0:e.security)==null?void 0:X.session_timeout_minutes)||"",onChange:O=>{var F;return y("security","session_timeout_minutes",parseInt((F=O==null?void 0:O.target)==null?void 0:F.value))},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",min:"30",max:"1440"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Max Login Attempts"}),s.jsx("input",{type:"number",value:((q=e==null?void 0:e.security)==null?void 0:q.max_login_attempts)||"",onChange:O=>{var F;return y("security","max_login_attempts",parseInt((F=O==null?void 0:O.target)==null?void 0:F.value))},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",min:"3",max:"10"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Account Lockout Duration (minutes)"}),s.jsx("input",{type:"number",value:((B=e==null?void 0:e.security)==null?void 0:B.lockout_duration_minutes)||"",onChange:O=>{var F;return y("security","lockout_duration_minutes",parseInt((F=O==null?void 0:O.target)==null?void 0:F.value))},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",min:"5",max:"1440",placeholder:"30"}),s.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"How long to lock account after max failed login attempts"})]})]})]})]})]}),h&&s.jsx("div",{className:"fixed inset-0 z-1200 overflow-y-auto",children:s.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:()=>m(!1)}),s.jsx("div",{className:"bg-surface rounded-lg shadow-xl max-w-md w-full relative z-1300",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Export Configuration"}),s.jsx("button",{onClick:()=>m(!1),className:"text-text-secondary hover:text-text-primary transition-colors duration-150",children:s.jsx(G,{name:"X",size:20})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text-primary mb-1",children:"Export Format"}),s.jsxs("select",{value:d,onChange:O=>{var F;return f((F=O==null?void 0:O.target)==null?void 0:F.value)},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:[s.jsx("option",{value:"json",children:"JSON"}),s.jsx("option",{value:"txt",children:"Text"})]})]}),s.jsx("p",{className:"text-sm text-text-secondary",children:"This will download your current system configuration settings."})]}),s.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[s.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors duration-150",children:"Cancel"}),s.jsx("button",{onClick:_,className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-600 transition-colors duration-150 ease-smooth",children:"Export"})]})]})})]})}),s.jsx("div",{className:"bg-background border border-border rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(G,{name:"AlertCircle",size:16,className:"text-primary mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium text-text-primary text-sm",children:"Configuration Changes"}),s.jsx("p",{className:"text-text-secondary text-sm mt-1",children:l?'You have unsaved changes. Click "Save Changes" to apply your modifications.':"All settings are saved and up to date. Changes will take effect immediately after saving."})]})]})})]})},oMe=()=>{const{user:e,hasPermission:t}=Pt(),[r]=ah(),[n,a]=R.useState("user-management");R.useEffect(()=>{if(e){const o=r.get("section");if(r.get("code")||r.get("error")){a("integrations");return}if(o){a(o);return}const l=[{id:"user-management",permission:"settings.user_management"},{id:"integrations",permission:"settings.integrations"},{id:"custom-fields",permission:"settings.custom_fields"},{id:"email-templates",permission:"settings.email_templates"},{id:"permissions",permission:"settings.permissions"},{id:"system-config",permission:"settings.system_config"}];for(const u of l)if(t(u.permission)){a(u.id);break}}},[e,r,t]);const i=()=>{switch(n){case"user-management":return s.jsx(K4,{});case"permissions":return s.jsx(tMe,{});case"integrations":return s.jsx(rMe,{});case"custom-fields":return s.jsx(aMe,{});case"email-templates":return s.jsx(iMe,{});case"system-config":return s.jsx(sMe,{});default:return s.jsx(K4,{})}};return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(Ta,{}),s.jsx("main",{className:"pt-20",children:s.jsxs("div",{className:"max-w-full mx-auto",children:[s.jsx("div",{className:"px-6 py-4",children:s.jsx(Ki,{})}),s.jsxs("div",{className:"flex h-[calc(100vh-7rem)]",children:[s.jsx("div",{className:"hidden lg:block",children:s.jsx(eMe,{activeSection:n,onSectionChange:a})}),s.jsx("div",{className:"lg:hidden",children:s.jsx("div",{className:"bg-surface border-r border-border p-4",children:s.jsxs("select",{value:n,onChange:o=>{var c;return a((c=o==null?void 0:o.target)==null?void 0:c.value)},className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-primary focus:border-primary",children:[t("settings.user_management")&&s.jsx("option",{value:"user-management",children:"User Management"}),t("settings.permissions")&&s.jsx("option",{value:"permissions",children:"Permissions"}),t("settings.integrations")&&s.jsx("option",{value:"integrations",children:"Integrations"}),t("settings.custom_fields")&&s.jsx("option",{value:"custom-fields",children:"Custom Fields"}),t("settings.email_templates")&&s.jsx("option",{value:"email-templates",children:"Email Templates"}),t("settings.system_config")&&s.jsx("option",{value:"system-config",children:"System Configuration"})]})})}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:s.jsx("div",{className:"p-6",children:i()})})]})]})})]})},cMe=()=>{const{user:e,permissions:t,hasPermission:r}=Pt();return s.jsx("div",{className:"min-h-screen bg-gray-50 p-8",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Permission Debugger"}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"User Information"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Email:"})," ",(e==null?void 0:e.email)||"Not logged in"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Role:"})," ",(e==null?void 0:e.role)||"N/A"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Name:"})," ",(e==null?void 0:e.full_name)||(e==null?void 0:e.first_name)||"N/A"]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Loaded Permissions"}),s.jsxs("p",{className:"mb-4",children:[s.jsx("strong",{children:"Total Count:"})," ",(t==null?void 0:t.length)||0]}),t&&t.length>0?s.jsx("div",{className:"grid grid-cols-2 gap-2",children:t.map((n,a)=>s.jsxs("div",{className:"text-sm bg-green-50 border border-green-200 rounded px-3 py-2",children:[" ",n]},a))}):s.jsx("p",{className:"text-red-600",children:" No permissions loaded!"})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Permission Tests"}),s.jsx("div",{className:"space-y-2",children:["dashboard.view_stats","deals.view_own","deals.view_all","contacts.view_own","analytics.view_personal","activities.view_own","settings.view_profile"].map(n=>s.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[s.jsx("span",{className:"font-mono text-sm",children:n}),s.jsx("span",{className:`px-3 py-1 rounded text-sm ${r(n)?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:r(n)?" Has Permission":" Missing"})]},n))})]}),s.jsx("button",{onClick:()=>window.location.reload(),className:"mt-6 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Reload Page"})]})})},lMe=()=>(ge.useEffect(()=>{const e=new URLSearchParams(window.location.search);e.set("section","integrations"),window.location.href=`/settings-administration?${e.toString()}`},[]),s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),s.jsx("p",{children:"Processing OAuth callback..."})]})})),uMe=()=>s.jsx(XL,{children:s.jsxs(M7,{children:[s.jsx(R7,{}),s.jsxs(KL,{children:[s.jsx(Tr,{path:"/login",element:s.jsx(wD,{})}),s.jsx(Tr,{path:"/register",element:s.jsx(B7,{})}),s.jsx(Tr,{path:"/forgot-password",element:s.jsx(L7,{})}),s.jsx(Tr,{path:"/reset-password",element:s.jsx($7,{})}),s.jsx(Tr,{path:"/",element:s.jsx(wD,{})}),s.jsx(Tr,{path:"/auth/microsoft/success",element:s.jsx(W7,{})}),s.jsx(Tr,{path:"/debug-permissions",element:s.jsx(cMe,{})}),s.jsx(Tr,{path:"/integrations/oauth/callback",element:s.jsx(Zn,{requiredPermission:"settings.integrations",children:s.jsx(lMe,{})})}),s.jsx(Tr,{path:"/sales-dashboard",element:s.jsx(Zn,{requiredPermissions:["dashboard.view_stats","dashboard.pipeline_view"],children:s.jsx(z_e,{})})}),s.jsx(Tr,{path:"/deal-management",element:s.jsx(Zn,{requiredPermission:"deals.view_own",children:s.jsx(Cb,{})})}),s.jsx(Tr,{path:"/deal-management/new",element:s.jsx(Zn,{requiredPermission:"deals.create",children:s.jsx(Cb,{})})}),s.jsx(Tr,{path:"/deal-management/:dealId",element:s.jsx(Zn,{requiredPermission:"deals.view_own",children:s.jsx(Cb,{})})}),s.jsx(Tr,{path:"/contact-management",element:s.jsx(Zn,{requiredPermission:"contacts.view_own",children:s.jsx(jRe,{})})}),s.jsx(Tr,{path:"/company-management",element:s.jsx(Zn,{requiredPermission:"companies.view_own",children:s.jsx(X4,{})})}),s.jsx(Tr,{path:"/company-management/:companyId",element:s.jsx(Zn,{requiredPermission:"companies.view_own",children:s.jsx(X4,{})})}),s.jsx(Tr,{path:"/campaign-management",element:s.jsx(Zn,{requiredPermission:"campaigns.view_own",children:s.jsx(kb,{})})}),s.jsx(Tr,{path:"/campaign-management/new",element:s.jsx(Zn,{requiredPermission:"campaigns.create",children:s.jsx(kb,{})})}),s.jsx(Tr,{path:"/campaign-management/:campaignId",element:s.jsx(Zn,{requiredPermission:"campaigns.view_own",children:s.jsx(kb,{})})}),s.jsx(Tr,{path:"/pipeline-analytics",element:s.jsx(Zn,{requiredPermission:"analytics.view_personal",children:s.jsx(HRe,{})})}),s.jsx(Tr,{path:"/activity-timeline",element:s.jsx(Zn,{requiredPermission:"activities.view_own",children:s.jsx(QRe,{})})}),s.jsx(Tr,{path:"/settings-administration",element:s.jsx(Zn,{requiredPermission:"settings.view_profile",children:s.jsx(oMe,{})})})]})]})});function dMe(){return s.jsx(I7,{children:s.jsx(U7,{children:s.jsx(fMe,{})})})}function fMe(){return s.jsxs("div",{className:"min-h-screen bg-background text-text-primary transition-colors duration-300",children:[s.jsx(uMe,{}),s.jsx(t$,{position:"top-right",toastOptions:{duration:4e3,className:"",style:{background:"#ffffff",color:"#1f2937",border:"1px solid #e5e7eb",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",borderRadius:"8px",fontSize:"14px",fontWeight:"500"},success:{style:{background:"#f0fdf4",color:"#166534",border:"1px solid #bbf7d0"},iconTheme:{primary:"#16a34a",secondary:"#ffffff"}},error:{style:{background:"#fef2f2",color:"#991b1b",border:"1px solid #fecaca"},iconTheme:{primary:"#dc2626",secondary:"#ffffff"}}}})]})}const hMe=document.getElementById("root"),mMe=eF(hMe);mMe.render(s.jsx(dMe,{}));export{Bd as _,fl as a,H7 as b};
//# sourceMappingURL=index-xAB4wc2h.js.map
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/jspdf.es.min-BMf-hzML.js","assets/vendor-CF0Y5DJ5.js","assets/router-CEKQOvjm.js","assets/ui-DbZRXSBI.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}